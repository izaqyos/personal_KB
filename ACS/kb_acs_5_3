.........................................Table Of Contents...............................................................
1. Centrify <URL:#tn=1. Centrify>
	1.1 Course <URL:#tn=	1.1 Course>
		1.1.1 DNS <URL:#tn=		1.1.1 DNS>
			1.1.1.1  Dig <URL:#tn=			1.1.1.1  Dig>
				1.1.1.1.1  Examples <URL:#tn=				1.1.1.1.1  Examples>
			1.1.1.2 <URL:#tn=			1.1.1.2>
		1.1.2 Troubleshoot <URL:#tn=		1.1.2 Troubleshoot>
		1.1.3 CLI <URL:#tn=		1.1.3 CLI>
			1.1.3.1 Kerberos <URL:#tn=			1.1.3.1 Kerberos>
				1.1.3.1.1 Klist <URL:#tn=				1.1.3.1.1 Klist>
				1.1.3.1.2 kinit <URL:#tn=				1.1.3.1.2 kinit>
				1.1.3.1.3 <URL:#tn=				1.1.3.1.3>
			1.1.3.2 <URL:#tn=			1.1.3.2>
		1.1.4 SDK, test programs <URL:#tn=		1.1.4 SDK, test programs>
			1.1.4.1 TestCapiInfo   <URL:#tn=			1.1.4.1 TestCapiInfo  >
			1.1.4.2 <URL:#tn=			1.1.4.2>
		1.1.5 <URL:#tn=		1.1.5>
	1.2 <URL:#tn=	1.2>
2.  Development <URL:#tn=2.  Development>
	2.1  5.3 dev plan - checklist <URL:#tn=	2.1  5.3 dev plan - checklist>
	2.2 get started guide <URL:#tn=	2.2 get started guide>
	2.3 Clearcase notable stream <URL:#tn=	2.3 Clearcase notable stream>
		2.3.1 main integration stream: int.acs5_0 <URL:#tn=		2.3.1 main integration stream: int.acs5_0>
		2.3.2 FCS streams <URL:#tn=		2.3.2 FCS streams>
		2.3.3 <URL:#tn=		2.3.3>
	2.4 Q&A <URL:#tn=	2.4 Q&A>
		2.4.1 Q: anyone know which attribute we put on the context before sending logs that represents the “response time” for each request? <URL:#tn=		2.4.1 Q: anyone know which attribute we put on the context before sending logs that represents the “response time” for each request?>
		2.4.2 What algorithm is used to encrypt passwords in ACS 5.x ? <URL:#tn=		2.4.2 What algorithm is used to encrypt passwords in ACS 5.x ?>
		2.4.3 <URL:#tn=		2.4.3>
	2.5 CARS <URL:#tn=	2.5 CARS>
		2.5.1 CLI <URL:#tn=		2.5.1 CLI>
			2.5.1.1 How to add a new CLI  <URL:#tn=			2.5.1.1 How to add a new CLI >
			2.5.1.2 Working with the rest of CARS project via SVN <URL:#tn=			2.5.1.2 Working with the rest of CARS project via SVN>
			2.5.1.3 Pull CARS project <URL:#tn=			2.5.1.3 Pull CARS project>
			2.5.1.4 CARS RPMs build issues <URL:#tn=			2.5.1.4 CARS RPMs build issues>
				2.5.1.4.1 error: File not found: /ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins/CARSOSGI-1.0-0-root/opt/OSGI/com.cisco.cars.SystemAdmin_1.0.0.jar <URL:#tn=				2.5.1.4.1 error: File not found: /ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins/CARSOSGI-1.0-0-root/opt/OSGI/com.cisco.cars.SystemAdmin_1.0.0.jar>
			2.5.1.5 <URL:#tn=			2.5.1.5>
		2.5.2  <URL:#tn=		2.5.2 >
	2.6 Adding copyrights <URL:#tn=	2.6 Adding copyrights>
		2.6.1 Example from 5.3 <URL:#tn=		2.6.1 Example from 5.3>
	2.7 <URL:#tn=	2.7>
3. Testing <URL:#tn=3. Testing>
	3.1 Automation <URL:#tn=	3.1 Automation>
		3.1.1 AoD <URL:#tn=		3.1.1 AoD>
			3.1.1.1 Dirty trick to open AD debug logs <URL:#tn=			3.1.1.1 Dirty trick to open AD debug logs>
			3.1.1.2 Deal with stuck AoD <URL:#tn=			3.1.1.2 Deal with stuck AoD>
			3.1.1.3 <URL:#tn=			3.1.1.3>
		3.1.2 <URL:#tn=		3.1.2>
	3.2 Pez <URL:#tn=	3.2 Pez>
		3.2.1 URL <URL:#tn=		3.2.1 URL>
		3.2.2 Usage <URL:#tn=		3.2.2 Usage>
			3.2.2.1 PEAP <URL:#tn=			3.2.2.1 PEAP>
				3.2.2.1.1 Configuration <URL:#tn=				3.2.2.1.1 Configuration>
				3.2.2.1.1  Logs <URL:#tn=				3.2.2.1.1  Logs>
			3.2.2.2 EAP, PEAP challenge response Configuration <URL:#tn=			3.2.2.2 EAP, PEAP challenge response Configuration>
			3.2.2.3 <URL:#tn=			3.2.2.3>
		3.2.3 <URL:#tn=		3.2.3>
	3.3 Real Device and switch  <URL:#tn=	3.3 Real Device and switch >
		3.3.1  PEAP <URL:#tn=		3.3.1  PEAP>
			3.3.1.1  Switch <URL:#tn=			3.3.1.1  Switch>
				3.3.1.1.1  Configure <URL:#tn=				3.3.1.1.1  Configure>
			3.3.1.2  Supplicant <URL:#tn=			3.3.1.2  Supplicant>
			3.3.1.3 ACS <URL:#tn=			3.3.1.3 ACS>
			3.3.1.4 Shlomi's setup <URL:#tn=			3.3.1.4 Shlomi's setup>
			3.3.1.5 <URL:#tn=			3.3.1.5>
		3.3.2 Odds and ends re. supplicants <URL:#tn=		3.3.2 Odds and ends re. supplicants>
			3.3.2.1 Change password <URL:#tn=			3.3.2.1 Change password>
			3.3.2.2 XP Supplicant <URL:#tn=			3.3.2.2 XP Supplicant>
			3.3.2.3 TLS L bit for single fragment message <URL:#tn=			3.3.2.3 TLS L bit for single fragment message>
			3.3.2.4 PEAP version negotiated  <URL:#tn=			3.3.2.4 PEAP version negotiated >
			3.3.2.5 Stripping user name in UPN and NETBIOS formats <URL:#tn=			3.3.2.5 Stripping user name in UPN and NETBIOS formats>
			3.3.2.6 PEAP Session resume/Fast reconnect <URL:#tn=			3.3.2.6 PEAP Session resume/Fast reconnect>
		3.3.3 Dot1x Setups Configuration, EDCS-798269  <URL:#tn=		3.3.3 Dot1x Setups Configuration, EDCS-798269 >
			3.3.3.1 Switch <URL:#tn=			3.3.3.1 Switch>
				3.3.3.1.1 Debugging the switch <URL:#tn=				3.3.3.1.1 Debugging the switch>
				3.3.3.1.2 Configuring the switch <URL:#tn=				3.3.3.1.2 Configuring the switch>
				3.3.3.1.3 Configure REV on switch: <URL:#tn=				3.3.3.1.3 Configure REV on switch:>
				3.3.3.1.4 Configuring clock on switch  <URL:#tn=				3.3.3.1.4 Configuring clock on switch >
				3.3.3.1.5 Loading image to switch <URL:#tn=				3.3.3.1.5 Loading image to switch>
				3.3.3.1.6 Configure Access Point <URL:#tn=				3.3.3.1.6 Configure Access Point>
				3.3.3.1.7 Configuring re-authentication on switch <URL:#tn=				3.3.3.1.7 Configuring re-authentication on switch>
			3.3.3.2 Supplicant GUI configuration <URL:#tn=			3.3.3.2 Supplicant GUI configuration>
				3.3.3.2.1 Vista <URL:#tn=				3.3.3.2.1 Vista>
				3.3.3.2.2 XP native <URL:#tn=				3.3.3.2.2 XP native>
				3.3.3.2.3 Funk Odyssey <URL:#tn=				3.3.3.2.3 Funk Odyssey>
				3.3.3.2.4 CSSC 5.1 <URL:#tn=				3.3.3.2.4 CSSC 5.1>
					3.3.3.2.4.1 Install user certificate <URL:#tn=					3.3.3.2.4.1 Install user certificate>
					3.3.3.2.4.2 CSSC dot1x rev configuration <URL:#tn=					3.3.3.2.4.2 CSSC dot1x rev configuration>
				3.3.3.2.5 Intel <URL:#tn=				3.3.3.2.5 Intel>
					3.3.3.2.5.1 2User authentication <URL:#tn=					3.3.3.2.5.1 2User authentication>
					3.3.3.2.5.2 Machine authentication <URL:#tn=					3.3.3.2.5.2 Machine authentication>
					3.3.3.2.5.3 Removing EAP-FAST PAC <URL:#tn=					3.3.3.2.5.3 Removing EAP-FAST PAC>
			3.3.3.3 Features chart <URL:#tn=			3.3.3.3 Features chart>
				3.3.3.3.1 EAP-FAST <URL:#tn=				3.3.3.3.1 EAP-FAST>
				3.3.3.3.2 Other protocols and features <URL:#tn=				3.3.3.3.2 Other protocols and features>
				3.3.3.3.3 ACS 4.2 Features <URL:#tn=				3.3.3.3.3 ACS 4.2 Features>
			3.3.3.4 Behavior, Troubleshooting and Known Issues <URL:#tn=			3.3.3.4 Behavior, Troubleshooting and Known Issues>
				3.3.3.4.1 Vista <URL:#tn=				3.3.3.4.1 Vista>
					3.3.3.4.1.1 Behavior and Troubleshooting <URL:#tn=					3.3.3.4.1.1 Behavior and Troubleshooting>
					3.3.3.4.1.2 Known Issues <URL:#tn=					3.3.3.4.1.2 Known Issues>
				3.3.3.4.2 XP native <URL:#tn=				3.3.3.4.2 XP native>
					3.3.3.4.2.1 Behavior and Troubleshooting <URL:#tn=					3.3.3.4.2.1 Behavior and Troubleshooting>
				3.3.3.4.3 Funk Odyssey 4.72 <URL:#tn=				3.3.3.4.3 Funk Odyssey 4.72>
				3.3.3.4.4 CSSC 5.1 <URL:#tn=				3.3.3.4.4 CSSC 5.1>
					3.3.3.4.4.1 Behavior and Troubleshooting <URL:#tn=					3.3.3.4.4.1 Behavior and Troubleshooting>
					3.3.3.4.4.2 Known Issues <URL:#tn=					3.3.3.4.4.2 Known Issues>
						3.3.3.4.4.2.1 EAP-FAST or PEAP with EAP-GTC against RSA <URL:#tn=						3.3.3.4.4.2.1 EAP-FAST or PEAP with EAP-GTC against RSA>
				3.3.3.4.5 Intel 12.4.0.0 <URL:#tn=				3.3.3.4.5 Intel 12.4.0.0>
					3.3.3.4.5.1 Behavior and Troubleshooting <URL:#tn=					3.3.3.4.5.1 Behavior and Troubleshooting>
					3.3.3.4.5.2 Known Issues <URL:#tn=					3.3.3.4.5.2 Known Issues>
				3.3.3.4.6 Other <URL:#tn=				3.3.3.4.6 Other>
		3.3.4 EAP-TLS <URL:#tn=		3.3.4 EAP-TLS>
			3.3.4.1 Test strategy, components <URL:#tn=			3.3.4.1 Test strategy, components>
				3.3.4.1.1  Client, supplicant <URL:#tn=				3.3.4.1.1  Client, supplicant>
				3.3.4.1.2 User, Machine <URL:#tn=				3.3.4.1.2 User, Machine>
				3.3.4.1.3 ID Store, CA <URL:#tn=				3.3.4.1.3 ID Store, CA>
				3.3.4.1.4 ACS Server <URL:#tn=				3.3.4.1.4 ACS Server>
					3.3.4.1.4.1 Define CA Certificate chain <URL:#tn=					3.3.4.1.4.1 Define CA Certificate chain>
					3.3.4.1.4.2 Extra configuration of CA Certificate  <URL:#tn=					3.3.4.1.4.2 Extra configuration of CA Certificate >
					3.3.4.1.4.3 <URL:#tn=					3.3.4.1.4.3>
				3.3.4.1.5 <URL:#tn=				3.3.4.1.5>
			3.3.4.2 <URL:#tn=			3.3.4.2>
		3.3.5 <URL:#tn=		3.3.5>
	3.4 Logging <URL:#tn=	3.4 Logging>
		3.4.1  Local store <URL:#tn=		3.4.1  Local store>
			3.4.1.1  Configure passed attmepts to be sent to local store <URL:#tn=			3.4.1.1  Configure passed attmepts to be sent to local store>
		3.4.2 <URL:#tn=		3.4.2>
	3.5 Stress employer <URL:#tn=	3.5 Stress employer>
		3.5.1  Configuration <URL:#tn=		3.5.1  Configuration>
		3.5.2 Nuts and Bolts <URL:#tn=		3.5.2 Nuts and Bolts>
		3.5.3 <URL:#tn=		3.5.3>
	3.6 <URL:#tn=	3.6>
4. CARS <URL:#tn=4. CARS>
	4.1 Material <URL:#tn=	4.1 Material>
	4.2 Architecture <URL:#tn=	4.2 Architecture>
		4.2.1 CARS Overview <URL:#tn=		4.2.1 CARS Overview>
		4.2.2 Block diagram <URL:#tn=		4.2.2 Block diagram>
		4.2.3 <URL:#tn=		4.2.3>
	4.3 CLI <URL:#tn=	4.3 CLI>
		4.3.1 Debug mode <URL:#tn=		4.3.1 Debug mode>
		4.3.2 <URL:#tn=		4.3.2>
	4.4 <URL:#tn=	4.4>
5. Linux Dev box  <URL:#tn=5. Linux Dev box >
	5.1 Open debug logs <URL:#tn=	5.1 Open debug logs>
		5.1.1 Open management debug logs <URL:#tn=		5.1.1 Open management debug logs>
		5.1.2 debug rt daemon <URL:#tn=		5.1.2 debug rt daemon>
		5.1.3 <URL:#tn=		5.1.3>
	5.2 <URL:#tn=	5.2>
6. Cryptography <URL:#tn=6. Cryptography>
	6.1 PKI <URL:#tn=	6.1 PKI>
		6.1.1 CRL <URL:#tn=		6.1.1 CRL>
			6.1.1.1 Issuing Distribution Point <URL:#tn=			6.1.1.1 Issuing Distribution Point>
				6.1.1.1.1 openssl docs <URL:#tn=				6.1.1.1.1 openssl docs>
				6.1.1.1.2 Description <URL:#tn=				6.1.1.1.2 Description>
				6.1.1.1.3 From Safari <URL:#tn=				6.1.1.1.3 From Safari>
				6.1.1.1.4 How to test ACS compatibility? <URL:#tn=				6.1.1.1.4 How to test ACS compatibility?>
					6.1.1.1.4.1 Certificate Enrollment <URL:#tn=					6.1.1.1.4.1 Certificate Enrollment>
					6.1.1.1.4.2 CRL, Certificate Revocation <URL:#tn=					6.1.1.1.4.2 CRL, Certificate Revocation>
					6.1.1.1.4.3 CA configuration files <URL:#tn=					6.1.1.1.4.3 CA configuration files>
					6.1.1.1.4.4 <URL:#tn=					6.1.1.1.4.4>
				6.1.1.1.5 <URL:#tn=				6.1.1.1.5>
		6.1.2 <URL:#tn=		6.1.2>
	6.2 Crypto module <URL:#tn=	6.2 Crypto module>
		6.2.1 Documentation <URL:#tn=		6.2.1 Documentation>
			6.2.1.1 ACS - PKI - Software Design Specification: EDCS-747115 <URL:#tn=			6.2.1.1 ACS - PKI - Software Design Specification: EDCS-747115>
				6.2.1.1.1	Introduction <URL:#tn=				6.2.1.1.1	Introduction>
					6.2.1.1.1.1	Certificates Authentications <URL:#tn=					6.2.1.1.1.1	Certificates Authentications>
						6.2.1.1.1.1.1	PKI authentication <URL:#tn=						6.2.1.1.1.1.1	PKI authentication>
					6.2.1.1.1.2 ACS Local Certificates <URL:#tn=					6.2.1.1.1.2 ACS Local Certificates>
						6.2.1.1.1.2.1 EAP Server Credentials <URL:#tn=						6.2.1.1.1.2.1 EAP Server Credentials>
						6.2.1.1.1.2.2 ACS Credentials used for External Policy Servers <URL:#tn=						6.2.1.1.1.2.2 ACS Credentials used for External Policy Servers>
						6.2.1.1.1.2.3 Management Credentials <URL:#tn=						6.2.1.1.1.2.3 Management Credentials>
					6.2.1.1.1.3 Session re-use <URL:#tn=					6.2.1.1.1.3 Session re-use>
						6.2.1.1.1.3.1 Fast PAC based sessions establishment <URL:#tn=						6.2.1.1.1.3.1 Fast PAC based sessions establishment>
					6.2.1.1.1.4 Anonymous Authentications (Diffie-Hellman) <URL:#tn=					6.2.1.1.1.4 Anonymous Authentications (Diffie-Hellman)>
				6.2.1.1.2 <URL:#tn=				6.2.1.1.2>
			6.2.1.2 <URL:#tn=			6.2.1.2>
		6.2.2 Crypto Module SDK <URL:#tn=		6.2.2 Crypto Module SDK>
			6.2.2.1 Important files <URL:#tn=			6.2.2.1 Important files>
			6.2.2.2 <URL:#tn=			6.2.2.2>
		6.2.3 <URL:#tn=		6.2.3>
	6.3 <URL:#tn=	6.3>
7. Setups <URL:#tn=7. Setups>
	7.1 Sustain <URL:#tn=	7.1 Sustain>
		7.1.1 ACS, my machines  <URL:#tn=		7.1.1 ACS, my machines >
		7.1.2 CA <URL:#tn=		7.1.2 CA>
			7.1.2.1 Machines <URL:#tn=			7.1.2.1 Machines>
			7.1.2.2 How to install a windows 2008 CA? <URL:#tn=			7.1.2.2 How to install a windows 2008 CA?>
			7.1.2.3 <URL:#tn=			7.1.2.3>
		7.1.3 "New" machines  <URL:#tn=		7.1.3 "New" machines >
		7.1.4 <URL:#tn=		7.1.4>
	7.2 <URL:#tn=	7.2>
8. Mgmt <URL:#tn=8. Mgmt>
	8.1  PKI <URL:#tn=	8.1  PKI>
		8.1.1  Certificate trust list <URL:#tn=		8.1.1  Certificate trust list>
			8.1.1.1  Add feature - prevent non utf-8 encoded certificate installation <URL:#tn=			8.1.1.1  Add feature - prevent non utf-8 encoded certificate installation>
				8.1.1.1.1  Example insert exception <URL:#tn=				8.1.1.1.1  Example insert exception>
				8.1.1.1.2 Example, load exception <URL:#tn=				8.1.1.1.2 Example, load exception>
				8.1.1.1.3 <URL:#tn=				8.1.1.1.3>
			8.1.1.2 <URL:#tn=			8.1.1.2>
		8.1.2 <URL:#tn=		8.1.2>
	8.2 <URL:#tn=	8.2>
9.  Clearcase ACS code, streams and operations <URL:#tn=9.  Clearcase ACS code, streams and operations>
	9.1  Open case to RE (Release Engineering) <URL:#tn=	9.1  Open case to RE (Release Engineering)>
10. Defects, Bugs <URL:#tn=10. Defects, Bugs>
	10.1 Usefull links <URL:#tn=	10.1 Usefull links>
5.3 + CFD opened bugs  <URL:#tn=5.3 + CFD opened bugs >
	10.2 <URL:#tn=	10.2>
11.  Protocols <URL:#tn=11.  Protocols>
	11.1  EAP-FAST <URL:#tn=	11.1  EAP-FAST>
		11.1.1  Ultimate wireless security guide: A primer on Cisco EAP-FAST authentication <URL:#tn=		11.1.1  Ultimate wireless security guide: A primer on Cisco EAP-FAST authentication>
		11.1.2 Wrong password <URL:#tn=		11.1.2 Wrong password>
		11.1.3 openSSL layer <URL:#tn=		11.1.3 openSSL layer>
			11.1.3.1 http://fixunix.com/openssl/152751-re-openssl-eap-fast-clienthello-ext-no-certificates.html  <URL:#tn=			11.1.3.1 http://fixunix.com/openssl/152751-re-openssl-eap-fast-clienthello-ext-no-certificates.html >
			11.1.3.2 OpenSSL and EAP-FAST (ClientHello ext and no certificates) <URL:#tn=			11.1.3.2 OpenSSL and EAP-FAST (ClientHello ext and no certificates)>
			11.1.3.3 <URL:#tn=			11.1.3.3>
		11.1.4 <URL:#tn=		11.1.4>
	11.2 PEAP <URL:#tn=	11.2 PEAP>
		11.2.1 wiki,http://en.wikipedia.org/wiki/Protected_Extensible_Authentication_Protocol  <URL:#tn=		11.2.1 wiki,http://en.wikipedia.org/wiki/Protected_Extensible_Authentication_Protocol >
	11.3 <URL:#tn=	11.3>
12. FAQS <URL:#tn=12. FAQS>
	12.1 What hostname formats are supported by ACS when working with AD? <URL:#tn=	12.1 What hostname formats are supported by ACS when working with AD?>
	12.2 What fields from user certificate can be used for Authorization policy? <URL:#tn=	12.2 What fields from user certificate can be used for Authorization policy?>
		12.2.1 email: <URL:#tn=		12.2.1 email:>
	12.3 Subject: ACS 5.2 CRL list verification - how to export latest downloaded CRL list ?  <URL:#tn=	12.3 Subject: ACS 5.2 CRL list verification - how to export latest downloaded CRL list ? >
	12.4  Customer asked if there is a way (thru logging / syslog) to verify whether ACS has a valid copy of the CRL and is actually using it <URL:#tn=	12.4  Customer asked if there is a way (thru logging / syslog) to verify whether ACS has a valid copy of the CRL and is actually using it>
	12.5 Do we have such a whitepaper or other type of doc. providing detailed info on configuring EAP-TLS and certs with LDAP as external DB? <URL:#tn=	12.5 Do we have such a whitepaper or other type of doc. providing detailed info on configuring EAP-TLS and certs with LDAP as external DB?>
	12.6 <URL:#tn=	12.6>
13. Educational Debug logs <URL:#tn=13. Educational Debug logs>
	13.1 Runtime <URL:#tn=	13.1 Runtime>
		13.1.1 Identity Stores <URL:#tn=		13.1.1 Identity Stores>
			13.1.1.1 ActiveDirectory <URL:#tn=			13.1.1.1 ActiveDirectory>
				13.1.1.1.1 Initialization <URL:#tn=				13.1.1.1.1 Initialization>
					13.1.1.1.1.1 When configured in DB <URL:#tn=					13.1.1.1.1.1 When configured in DB>
					13.1.1.1.1.2 <URL:#tn=					13.1.1.1.1.2>
				13.1.1.1.2 <URL:#tn=				13.1.1.1.2>
			13.1.1.2 <URL:#tn=			13.1.1.2>
		13.1.2 <URL:#tn=		13.1.2>
	13.2 <URL:#tn=	13.2>
14. Monitoring and reports <URL:#tn=14. Monitoring and reports>
	14.1 log forward <URL:#tn=	14.1 log forward>
		14.1.1 Source code  <URL:#tn=		14.1.1 Source code >
		14.1.2 Install setup <URL:#tn=		14.1.2 Install setup>
		14.1.3 author <URL:#tn=		14.1.3 author>
		14.1.4 <URL:#tn=		14.1.4>
	14.2 System Statistics <URL:#tn=	14.2 System Statistics>
		14.2.1 Sources <URL:#tn=		14.2.1 Sources>
		14.2.2 flow <URL:#tn=		14.2.2 flow>
		14.2.3 <URL:#tn=		14.2.3>
	14.3 <URL:#tn=	14.3>
15. RT Interfaces <URL:#tn=15. RT Interfaces>
	15.1 HTTP listener <URL:#tn=	15.1 HTTP listener>
		15.1.1 Check objects in DB  <URL:#tn=		15.1.1 Check objects in DB >
		15.1.2 RT CLI <URL:#tn=		15.1.2 RT CLI>
	15.2 <URL:#tn=	15.2>
16. <URL:#tn=16.>
.................................................END TOC..............................................

































Description: 	ACS, AAA server application of Cisco, NMTG versions 5.x related knowledge.
Author:		Yosi Izaq.

1. Centrify

	1.1 Course

		1.1.1 DNS

			1.1.1.1  Dig

				1.1.1.1.1  Examples
[yizaq@yizaq-lnx:Mon Oct 11:/usr/share/centrifydc/sdk/capi/samples]$ dig  canada.north.amer.acs.com  

; <<>> DiG 9.2.4 <<>> canada.north.amer.acs.com
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 60524
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;canada.north.amer.acs.com.     IN      A

;; ANSWER SECTION:
canada.north.amer.acs.com. 600  IN      A       10.56.60.46

;; Query time: 1 msec
;; SERVER: 10.56.60.150#53(10.56.60.150)
;; WHEN: Mon Oct 11 15:25:16 2010
;; MSG SIZE  rcvd: 59

[yizaq@yizaq-lnx:Mon Oct 11:/usr/share/centrifydc/sdk/capi/samples]$ dig  _gc._tcp.amer.acs.com  

; <<>> DiG 9.2.4 <<>> _gc._tcp.amer.acs.com
;; global options:  printcmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 18238
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0

;; QUESTION SECTION:
;_gc._tcp.amer.acs.com.         IN      A

;; AUTHORITY SECTION:
acs.com.                3600    IN      SOA     cd-acs-dns.cisco.com. hostmaster. 7650 900 600 86400 3600

;; Query time: 1 msec
;; SERVER: 10.56.60.150#53(10.56.60.150)
;; WHEN: Mon Oct 11 14:15:14 2010
;; MSG SIZE  rcvd: 102

[yizaq@yizaq-lnx:Mon Oct 11:/usr/share/centrifydc/sdk/capi/samples]$ nslookup 
> set type=SRV
> _ldap._tcp.canada.north.amer.acs.com
Server:         10.56.60.150
Address:        10.56.60.150#53

_ldap._tcp.canada.north.amer.acs.com    service = 0 100 389 a3-adf1-b-2.canada.north.amer.acs.com.
> _gc._tcp.amer.acs.com
Server:         10.56.60.150
Address:        10.56.60.150#53

_gc._tcp.amer.acs.com   service = 0 100 3268 a3-adf1.amer.acs.com.
> _gc._tcp.canada.north.amer.acs.com
Server:         10.56.60.150
Address:        10.56.60.150#53

** server can't find _gc._tcp.canada.north.amer.acs.com: NXDOMAIN
> _dc._tcp.canada.north.amer.acs.com
Server:         10.56.60.150
Address:        10.56.60.150#53

** server can't find _dc._tcp.canada.north.amer.acs.com: NXDOMAIN
> q
Server:         10.56.60.150
Address:        10.56.60.150#53

Non-authoritative answer:
q.cisco.com     canonical name = kcurrie-lnx.cisco.com.

Authoritative answers can be found from:
> quit
Server:         10.56.60.150
Address:        10.56.60.150#53



			1.1.1.2

		1.1.2 Troubleshoot

		1.1.3 CLI

			1.1.3.1 Kerberos

				1.1.3.1.1 Klist
$klist -e /etc/krb5.cache
list Kerberos tickets

user auth. tickects are "host" service host/domain@DOMAIN
ldap ticket is "ldap" service

TGT tickets are "krbtgt" service

$ klist -Kkte /etc/krb5.keytab
list all the ticket keys (secure hashed with adclient's key)

				1.1.3.1.2 kinit
authenticate a user

				1.1.3.1.3
			1.1.3.2

		1.1.4 SDK, test programs

			1.1.4.1 TestCapiInfo  
[yizaq@yizaq-lnx:Sun Oct 10:/usr/share/centrifydc/sdk/capi/samples]$ TestCapiInfo -f canada.north.amer.acs.com
Calling cdcSessionOpen
rc=0
Forest = amer.acs.com
TestCapiInfo: Success
[yizaq@yizaq-lnx:Sun Oct 10:/usr/share/centrifydc/sdk/capi/samples]$ TestCapiInfo -f canada.north.amer.acs.com -F
Calling cdcSessionOpen
rc=0
=======================================
africa.acs.com:
    _DomainName: 3 values
        africa.acs.com
        pretoria.sa.africa.acs.com
        sa.africa.acs.com
    _GCList: a3-adf3-a-2.pretoria.sa.africa.acs.com
    _GUID: <GUID=00000000000000000000000000000000>

=======================================
amer.acs.com:
    _DomainName: 6 values
        amer.acs.com
        brazil.south.amer.acs.com
        canada.north.amer.acs.com
        north.amer.acs.com
        rio.brazil.south.amer.acs.com
        south.amer.acs.com
    _GCList: a3-adf1.amer.acs.com
    _GUID: <GUID=00000000000000000000000000000000>

=======================================
asia.acs.com:
    _DomainName: 5 values
        asia.acs.com
        beijing.china.asia.acs.com
        china.asia.acs.com
        japan.asia.acs.com
        tokyo.japan.asia.acs.com

    _GCList: a3-adf5.asia.acs.com
    _GUID: <GUID=00000000000000000000000000000000>

=======================================
emea.acs.com:
    _DomainName: 4 values
        emea.acs.com
        israel.me.emea.acs.com
        jerusalem.israel.me.emea.acs.com
        me.emea.acs.com
    _GCList: a3-adf2.emea.acs.com
    _GUID: <GUID=00000000000000000000000000000000>

=======================================
oceania.acs.com:
    _DomainName: 3 values
        australia.oceania.acs.com
        canberra.australia.oceania.acs.com
        oceania.acs.com
    _GCList: a3-f4-greenway.canberra.australia.oceania.acs.com
    _GUID: <GUID=00000000000000000000000000000000>

TestCapiInfo: Success

			1.1.4.2
		1.1.5
	1.2

2.  Development

	2.1  5.3 dev plan - checklist
| 5.3 dev plan - checklist:
| 1. DFS
| 2. Design
| 3. Customer logs
| 4. Debug logs
| 5. Audit logs, import/export
| 6. UT, CR, SA
| 7. Test & delivery (incl. integrations, setups for testing, automation for delivery, RE (deliveries))
| 8. DTP review
| 9. IM changes -> Upgrade, PI changes?
| 10. Minimal stabilization (as fixing blocker bugs)
 
Other time consumers:
- Dev environment issues
- Working with testing (issues, explain functionality, review to DTP)
- Working with HCL
- GUI, new areas -> learning curve
- CARS issues
- IM environment
- Interrupting on other features / get help from other eng (even out of the team)
- Centrify drops dependency 
- CW integration
 
Thanks,
Yaniv.
 


	2.2 get started guide
| 1.	Make sub stream: mkstream –instream [rest stream]
| 2.	Make view: createview –stream [stream from #1]
| 3.	Enter view: ct setview [view from #2]
| 4.	cd /view/[view]/vob/nm_acs/acs
| 5.	build: mvn clean –Pacs ; mvn install -Dmaven.test.skip=true –Pacs
| 6.	setup eclipse:
| D/L eclipse-SDK-3.5.2-win32.zip
| Extract to /ws/ 
| copy then unzip eclipse-SDK-3.5.2-win32.zip  in /ws/yizaq/apps/eclipse
| execute eclipse (setup alias if you like)
| 
| clean and rebuild ACS view
| cd /acs/mgmt/ and run mvn eclipse:eclipse
| if it fails try to rerun, it sometimes help, known bug - copy jfrog artifact if still doesn’t work 
$ mvn org.apache.maven.plugins:maven-eclipse-plugin:2.8:eclipse
if not – open case to Vlasta
| Then in eclipse
| File-> import-> general-> Exisiting project...-> put path to CC proj, such as: /view/[view]/vob/nm_acs/acs/mgmt
| click browse, finish
| go to workbench
| 
| At this point Eclipse will try to compile the projects and fail since it's missing maven repository configuration. so:
| go to one of the projects, right click, properties, Java build path, libraries tab, Add Variable, configure variables,
| new, name: M2_REPO, value depends on maven configuration of repository.
| For me it's:
| $ grep localRepository ~/.m2/settings.xml
| <localRepository>/ws/${USER}/maven-repo/${CLEARCASE_ROOT}</localRepository>
| So: /ws/yizaq/maven-repo/view/[view]/
| 
| 7.	should be good to go :)

	2.3 Clearcase notable stream

		2.3.1 main integration stream: int.acs5_0

		2.3.2 FCS streams
fcs5_1.int.acs5_0
FCS_5_2.int.acs5_0

		2.3.3

	2.4 Q&A


		2.4.1 Q: anyone know which attribute we put on the context before sending logs that represents the “response time” for each request?
A: Here is a passed auth record

2011-03-27 09:41:26.856 +00:00 0000006427 5200 NOTICE Passed-Authentication: Authentication succeeded, ConfigVersionId=44, Device IP Address=64.103.114.177, DestinationIPAddress=10.56.13.63, DestinationPort=1812, UserName=jonny, Protocol=Radius, RequestLatency=12, NetworkDeviceName=DefaultNetworkDevice, AuthorizationPolicyMatchedRule=Default, User-Name=jonny, NAS-IP-Address=64.103.120.41, Service-Type=Login, Framed-IP-Netmask=0.0.0.32, Framed-MTU=1500, Calling-Station-ID=11-22-33-44-55-66, NAS-Port-Type=Ethernet, AcsSessionID=cd-acs5-13-63/90324582/3, AuthenticationIdentityStore=Internal Users, AuthenticationMethod=PAP_ASCII, SelectedAccessService=Default Network Access, SelectedAuthorizationProfiles=PermitAccess, Step=11001, Step=11017, Step=11049, Step=15008, Step=15006, Step=15041, Step=15006, Step=15013, Step=24210, Step=24212, Step=22037, Step=15036, Step=15004, Step=15016, Step=11002, SelectedAuthenticationIdentityStores=Internal Users, NetworkDeviceGroups=Device Type#All Device Types, NetworkDeviceGroups=Location#All Locations, ServiceSelectionMatchedRule=Default, IdentityPolicyMatchedRule=Default, UserType=User, CPMSessionID=0a380d3f000000024D8F0646, EndPointMACAddress=11-22-33-44-55-66, PostureAssessmentStatus=NotApplicable, Device Type=Device Type#All Device Types, Location=Location#All Locations, PostureStatus=Unknown, Response={User-Name=jonny; State=ReauthSession:0a380d3f000000024D8F0646; Class=CACS:0a380d3f000000024D8F0646:cd-acs5-13-63/90324582/3; Termination-Action=RADIUS-Request; },

There is the RequestLatency field. This then shows in Authentication trend report as 12ms.

		2.4.2 What algorithm is used to encrypt passwords in ACS 5.x ?
"c:\work\acs\5.1\FIPS\Copy of ACS 5 2 Keys.xls" 

		2.4.3
	2.5 CARS


		2.5.1 CLI

			2.5.1.1 How to add a new CLI 

<URL:/cygdrive/c/work/acs/5.1/FIPS/FIPS_KB#r=__ACS_CARS_CLI_SDK__>

			2.5.1.2 Working with the rest of CARS project via SVN

SVN: <URL:/cygdrive/c/work/KB/clear_case_KB.txt#r=__SVN_Basics__>

			2.5.1.3 Pull CARS project
/usr/cisco/bin/svn co https://wwwin-svn-sjc.cisco.com/pmbu/cars/branches/cars_1x/

			2.5.1.4 CARS RPMs build issues


				2.5.1.4.1 error: File not found: /ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins/CARSOSGI-1.0-0-root/opt/OSGI/com.cisco.cars.SystemAdmin_1.0.0.jar

Just a quick follow up to the compile problems.  I did a ‘make rpm’ with my JAVA_HOME defined and came across the same issue. I saved my make output to this file:
 
/users/eddiem/tmp/make.out.java_home_err
 
Then I removed the JAVA_HOME and did another make, it succeeded.  I save the make output to this file:
 
/users/eddiem/tmp/make.out
 
You can use these to compare where your problem is.
 
~eddie
 
From: Satheesh Kumar Murugan -X (satmurug - HCL at Cisco) 
Sent: Thursday, December 16, 2010 6:48 AM
To: Sergey Emantayev (semantay); Jim Gaw (jgaw)
Cc: Eddie Mendonca (eddiem); Yaniv Azoulay (yazoulay); Alon Barak (albarak); Sivaraja Krishnamoorthy -X (sikrishn - HCL at Cisco); Radha krishna Meduri -X (radmedur - HCL at Cisco); Aruna Koodipudi -X (akoodipu - HCL at Cisco); Yosi Izaq (yizaq); Nira Amit (nleibman)
Subject: RE: RE homework for next CARS TOI
 
Hi Sergey,
 
We are also getting the same error. ( sending it to make sure all are in same page though Eddie explained the reason for the error )
 
Processing files: CARSOSGI-1.0-0
error: File not found: /ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins/CARSOSGI-1.0-0-root/opt/OSGI/com.cisco.cars.SystemAdmin_1.0.0.jar
 

RPM build errors:
    File not found: /ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins/CARSOSGI-1.0-0-root/opt/OSGI/com.cisco.cars.SystemAdmin_1.0.0.jar
make[2]: *** [rpm] Error 1
make[2]: Leaving directory `/ws/satmurug-hcl/cars_1x/smos/apps/osgi/eclipse-equinox/bundles/plugins'
make[1]: *** [rpm] Error 2
make[1]: Leaving directory `/ws/satmurug-hcl/cars_1x/smos/apps/osgi'
make: *** [rpm] Error 2


			2.5.1.5
		2.5.2 

	2.6 Adding copyrights

id=__ACS_5_3_copyrights__
		2.6.1 Example from 5.3
      -> Subject: copyright for ACS 5.3

Apply only to our source code dirs.
See:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs]$ dir_tree   > ACS_5_3_DIR_STRUCTURE

   .
   |-db
   |---sql
   |---src
   |-----main
   |-------database
   |---target
   |-----db
   |-----dependency-maven-plugin-markers
   |-----generated
   |-------src
   |---------scripts
   |-----------META-INF
   |-devutil
   |-install
   |---cars
   |---openssh
   |-----libs
   |-----openssh-5.3p1
   |-------contrib
   |---------aix
   |---------caldera
   |---------cygwin
   |---------hpux
   |---------redhat
   |---------solaris
   |---------suse
   |-------openbsd-compat
   |---------regress
   |-------regress
   |-------scard
   |---target
   |-----dependency-maven-plugin-markers
   |-----rpm
   |-------BUILD
   |-------buildroot
   |---------etc
   |-----------logrotate.d
   |-----------rc.d
   |-------------init.d
   |---------opt
   |-----------CSCOacs
   |-------------bin
   |-------------config
   |-------------db
   |-------------jre1.6
   |-------------lib
   |-------------logs
   |-------------lsb
   |-------------mgmt
   |---------------apache-tomcat-6.0.18
   |-----------------bin
   |-----------------conf
   |-----------------lib
   |-----------------logs
   |-----------------temp
   |-----------------webapps
   |-------------------docs
   |---------------------api
   |---------------------appdev
   |-----------------------printer
   |-------------------------docs
   |---------------------------appdev
   |-----------------------sample
   |-------------------------docs
   |-------------------------src
   |---------------------------mypackage
   |-------------------------web
   |---------------------------images
   |---------------------------WEB-INF
   |---------------------architecture
   |-----------------------printer
   |-----------------------requestProcess
   |-----------------------startup
   |---------------------config
   |-----------------------printer
   |---------------------funcspecs
   |-----------------------printer
   |---------------------images
   |---------------------printer
   |---------------------tribes
   |---------------------WEB-INF
   |-------------------examples
   |---------------------jsp
   |-----------------------cal
   |-----------------------chat
   |-----------------------checkbox
   |-----------------------colors
   |-----------------------dates
   |-----------------------error
   |-----------------------forward
   |-----------------------images
   |-----------------------include
   |-----------------------jsp2
   |-------------------------el
   |-------------------------jspattribute
   |-------------------------jspx
   |-------------------------misc
   |-------------------------simpletag
   |-------------------------tagfiles
   |-----------------------jsptoserv
   |-----------------------num
   |-----------------------plugin
   |-------------------------applet
   |-----------------------security
   |-------------------------protected
   |-----------------------sessions
   |-----------------------simpletag
   |-----------------------snp
   |-----------------------tagplugin
   |-----------------------xml
   |---------------------servlets
   |-----------------------images
   |---------------------WEB-INF
   |-----------------------classes
   |-------------------------cal
   |-------------------------chat
   |-------------------------checkbox
   |-------------------------colors
   |-------------------------compressionFilters
   |-------------------------dates
   |-------------------------error
   |-------------------------examples
   |-------------------------filters
   |-------------------------jsp2
   |---------------------------examples
   |-----------------------------el
   |-----------------------------simpletag
   |-------------------------listeners
   |-------------------------num
   |-------------------------sessions
   |-------------------------util
   |-------------------------validators
   |-----------------------jsp
   |-------------------------applet
   |-----------------------jsp2
   |-----------------------lib
   |-----------------------tags
   |-------------------host-manager
   |---------------------images
   |---------------------META-INF
   |---------------------WEB-INF
   |-------------------manager
   |---------------------images
   |---------------------META-INF
   |---------------------WEB-INF
   |-------------------ROOT
   |---------------------WEB-INF
   |-----------------work
   |---------------cli
   |-----------------bin
   |-------------runtime
   |---------------adagent
   |-----------------bin
   |-----------------etc
   |-----------------lib
   |-------------------kerberos
   |---------------bin
   |---------------config
   |-----------------logforward
   |---------------lib
   |-----------system
   |-------------etc
   |---------------carscli
   |-------------lib
   |-------RPMS
   |---------i386
   |-------SOURCES
   |-------SPECS
   |-------SRPMS
   |-----stage
   |-------etc
   |---------logrotate.d
   |---------rc.d
   |-----------init.d
   |-------opt
   |---------CSCOacs
   |-----------bin
   |-----------config
   |-----------db
   |-----------jre1.6
   |-----------lib
   |-----------logs
   |-----------lsb
   |-----------mgmt
   |-------------apache-tomcat-6.0.18
   |---------------bin
   |---------------conf
   |---------------lib
   |---------------logs
   |---------------temp
   |---------------webapps
   |-----------------docs
   |-------------------api
   |-------------------appdev
   |---------------------printer
   |-----------------------docs
   |-------------------------appdev
   |---------------------sample
   |-----------------------docs
   |-----------------------src
   |-------------------------mypackage
   |-----------------------web
   |-------------------------images
   |-------------------------WEB-INF
   |-------------------architecture
   |---------------------printer
   |---------------------requestProcess
   |---------------------startup
   |-------------------config
   |---------------------printer
   |-------------------funcspecs
   |---------------------printer
   |-------------------images
   |-------------------printer
   |-------------------tribes
   |-------------------WEB-INF
   |-----------------examples
   |-------------------jsp
   |---------------------cal
   |---------------------chat
   |---------------------checkbox
   |---------------------colors
   |---------------------dates
   |---------------------error
   |---------------------forward
   |---------------------images
   |---------------------include
   |---------------------jsp2
   |-----------------------el
   |-----------------------jspattribute
   |-----------------------jspx
   |-----------------------misc
   |-----------------------simpletag
   |-----------------------tagfiles
   |---------------------jsptoserv
   |---------------------num
   |---------------------plugin
   |-----------------------applet
   |---------------------security
   |-----------------------protected
   |---------------------sessions
   |---------------------simpletag
   |---------------------snp
   |---------------------tagplugin
   |---------------------xml
   |-------------------servlets
   |---------------------images
   |-------------------WEB-INF
   |---------------------classes
   |-----------------------cal
   |-----------------------chat
   |-----------------------checkbox
   |-----------------------colors
   |-----------------------compressionFilters
   |-----------------------dates
   |-----------------------error
   |-----------------------examples
   |-----------------------filters
   |-----------------------jsp2
   |-------------------------examples
   |---------------------------el
   |---------------------------simpletag
   |-----------------------listeners
   |-----------------------num
   |-----------------------sessions
   |-----------------------util
   |-----------------------validators
   |---------------------jsp
   |-----------------------applet
   |---------------------jsp2
   |---------------------lib
   |---------------------tags
   |-----------------host-manager
   |-------------------images
   |-------------------META-INF
   |-------------------WEB-INF
   |-----------------manager
   |-------------------images
   |-------------------META-INF
   |-------------------WEB-INF
   |-----------------ROOT
   |-------------------WEB-INF
   |---------------work
   |-------------cli
   |---------------bin
   |-----------runtime
   |-------------adagent
   |---------------bin
   |---------------etc
   |---------------lib
   |-----------------kerberos
   |-------------bin
   |-------------config
   |---------------logforward
   |-------------lib
   |---------system
   |-----------etc
   |-------------carscli
   |-----------lib
   |-integration
   |---aac
   |-----src
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------aac
   |---------resources
   |---core
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------core
   |-----------------------util
   |---------------------servers
   |---------------------util
   |---------resources
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------core
   |-----------------------util
   |---------resources
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------integration
   |-------------------core
   |---------------------util
   |-------------------servers
   |-------------------util
   |-------test-classes
   |---dbJNI
   |-----src
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------dbJNI
   |---dbTools
   |-----src
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------dbtools
   |---logview
   |-----src
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------bl
   |-----------------------framework
   |-------------------------logview
   |---pi
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------pi
   |-----------------------client
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------pi
   |-----------------------client
   |-------------------------aaaclient
   |-------------------------aac
   |-------------------------accessservices
   |-------------------------associations
   |-------------------------authorization
   |-------------------------base
   |-------------------------certificates
   |---------------------------acscerts
   |-------------------------common
   |-------------------------distmgmt
   |-------------------------identity
   |-------------------------ldapidentitystore
   |-------------------------logging
   |-------------------------networkdevice
   |-------------------------policy
   |-------------------------validations
   |-----------------------examples
   |-------------------------authorization
   |-------------------------common
   |-------------------------identity
   |-------------------------networkdevice
   |---------------------ucp
   |-----------------------client
   |-----target
   |---pi-client
   |-----bin
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------pi
   |-----------------------client
   |-------------------------utils
   |---------------------------constants
   |---------------------------root
   |---------------------------templates
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------pi
   |-----------------------client
   |-------------------------components
   |---------------------------certificates
   |---------------------------distributedManagement
   |---------------------------policyElements
   |-----------------------------commandSet
   |-----------------------------dateAndTime
   |-----------------------------shellProfiles
   |-----test-output
   |-------pi-client
   |---postinteg
   |---runtime
   |-----src
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------integration
   |---------------------runtime
   |-messagecatalog
   |---src
   |-----main
   |-------resources
   |---target
   |-----classes
   |-----generated
   |-------src
   |---------catalog
   |-----------cpp
   |---------dictionary
   |-----------cpp
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------common
   |-----------------------attributedictionary
   |-----------------------logging
   |---------sql
   |---------upgrade
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------upgrade
   |-mgmt
   |---aac
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------aac
   |---------resources
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------aac
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------aac
   |---audit
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------audit
   |-----------------------changeconfig
   |-------------------------impl
   |-----------------------values
   |---------resources
   |-----------mgmt
   |-------------model
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------audit
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------audit
   |---------------------changeconfig
   |-----------------------impl
   |---------------------values
   |---------mgmt
   |-----------model
   |---bl
   |-----api
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------bl
   |-------------------------api
   |---------------------------exceptions
   |---------------------------validation
   |-------------------------ucp
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------bl
   |-----------------------api
   |-------------------------exceptions
   |-------------------------validation
   |-----------------------ucp
   |-----framework
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------bl
   |-------------------------framework
   |---------------------------accountdisablementpolicy
   |---------------------------ad
   |---------------------------audit
   |-----------------------------values
   |---------------------------certificate
   |---------------------------dateexceeds
   |---------------------------daysexceeds
   |---------------------------exceptions
   |---------------------------handlers
   |---------------------------hitcount
   |-----------------------------event
   |-----------------------------message
   |-----------------------------msgbus
   |---------------------------hooks
   |-----------------------------impl
   |---------------------------impl
   |---------------------------ldap
   |---------------------------logview
   |---------------------------maxsessions
   |-----------------------------event
   |-----------------------------message
   |-----------------------------msgbus
   |---------------------------oobPac
   |---------------------------rsa
   |---------------------------scheduler
   |---------------------------ssl
   |---------------------------ucp
   |-----------------------------exceptions
   |---------------------------userpassword
   |---------------------------utils
   |---------------------------validation
   |-----------------------------impl
   |-------------------------web
   |-----------resources
   |-------------mgmt
   |---------------model
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------bl
   |-------------------------framework
   |---------------------------activedirectory
   |---------------------------associations
   |-----------------------------aac
   |-----------------------------certificate
   |-----------------------------common
   |-----------------------------distributedmanagement
   |-----------------------------idstore
   |-----------------------------logging
   |-----------------------------policy
   |-----------------------------variables
   |---------------------------certificate
   |---------------------------changepassword
   |---------------------------crud
   |---------------------------dictionary
   |---------------------------distributedmanagement
   |---------------------------eapfast
   |---------------------------handlers
   |---------------------------hitcount
   |-----------------------------event
   |-----------------------------msgbus
   |---------------------------integration
   |-----------------------------aac
   |---------------------------ldap
   |---------------------------logging
   |---------------------------logview
   |---------------------------msgcat
   |---------------------------pagination
   |---------------------------performance
   |---------------------------query
   |---------------------------scheduler
   |---------------------------serialization
   |---------------------------ucp
   |---------------------------validation
   |-----------------------------impl
   |-----------------------im
   |-----------resources
   |-------------certificateFiles
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------bl
   |-----------------------framework
   |-------------------------accountdisablementpolicy
   |-------------------------ad
   |-------------------------certificate
   |-------------------------dateexceeds
   |-------------------------daysexceeds
   |-------------------------exceptions
   |-------------------------handlers
   |-------------------------hitcount
   |---------------------------event
   |---------------------------message
   |---------------------------msgbus
   |-------------------------hooks
   |---------------------------impl
   |-------------------------impl
   |-------------------------ldap
   |-------------------------logview
   |-------------------------maxsessions
   |---------------------------event
   |---------------------------message
   |---------------------------msgbus
   |-------------------------oobPac
   |-------------------------rsa
   |-------------------------scheduler
   |-------------------------ssl
   |-------------------------ucp
   |---------------------------exceptions
   |-------------------------userpassword
   |-------------------------utils
   |-------------------------validation
   |---------------------------impl
   |-----------------------web
   |---------test-classes
   |-----------certificateFiles
   |-----sec
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------bl
   |-------------------------sec
   |-------------org
   |---------------apache
   |-----------------tomcat
   |-------------------util
   |---------------------net
   |-----------------------jsse
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------bl
   |-----------------------sec
   |-----------org
   |-------------apache
   |---------------tomcat
   |-----------------util
   |-------------------net
   |---------------------jsse
   |---changepassword
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------changepassword
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------changepassword
   |---cli
   |-----app
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------cli
   |-------------------------app
   |---------------------------parser
   |---------------------------shell
   |---------------------------token
   |-----------resources
   |-----------webapp
   |-------------WEB-INF
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------cli
   |-------------------------app
   |---------------------------parser
   |---------------------------token
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------cli
   |-----------------------app
   |-------------------------parser
   |-------------------------shell
   |-------------------------token
   |---------cli-framework-5.3.0.32.100
   |-----------META-INF
   |-----------WEB-INF
   |-------------classes
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------cli
   |---------------------------app
   |-----------------------------parser
   |-----------------------------shell
   |-----------------------------token
   |-------------lib
   |-----cars
   |-------src
   |---------main
   |-----------acsmode
   |-----------ctrlcmd
   |-----------logscmd
   |-----------resources
   |-------------acspatch-p1
   |-------------acspatch-p2
   |-----------util
   |-------target
   |---------bin
   |---------cli-cars
   |---------dependency-maven-plugin-markers
   |---------overlay
   |-----------include
   |-------------include
   |---------------isan
   |-----------------syslog
   |---------------isanboot
   |---------------itasca
   |---------------tecla
   |-------------mts
   |---------------daemon
   |---------------export
   |---------------include
   |-----------------asm
   |-----------------linux
   |---------------jni
   |---------------mtscomp
   |---------------mts_filter
   |---------------test
   |-------------utils
   |---------------bmp
   |---------------cmi
   |---------------dlwrap
   |---------------glib
   |---------------indxobj
   |---------------queue
   |---------------tecla
   |-----------------readline
   |-----------------tecla
   |---------------timer
   |---------------uri
   |-----------------libfileutil
   |-----------------liburifs
   |-----------------liburiparse
   |-----------------liburiutil
   |-----------------uri_copy
   |-----------------uri_map
   |-------------vsh
   |---------------cdl
   |---------------export
   |-----------------libxml
   |---------------lib
   |---------------src
   |---------------stubs
   |-----------lib
   |-----------tools
   |---clients
   |-----app
   |-------src
   |---------main
   |-----------CTSLicense
   |-----------documents
   |-----------pythonUcp
   |-----------webapp
   |-------------WEB-INF
   |-------target
   |---------clients-app-5.3.0.32.100
   |-----------META-INF
   |-----------WEB-INF
   |-------------lib
   |---------dependency-maven-plugin-markers
   |---------overlay
   |---------tmp
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------rest
   |-----------------------common
   |-----------------------identity
   |-----------------------query
   |-----------META-INF
   |-------------maven
   |---------------com.cisco.nm.acs.mgmt.rest.schema
   |-----------------rest-schema
   |-----rest
   |-------src
   |---------assembly
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------restclient
   |-------target
   |---------archive-tmp
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------restclient
   |-----spml
   |-------src
   |---------assembly
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------piclient
   |-----------------------authorization
   |-----------------------common
   |-----------------------identity
   |-----------------------networkdevice
   |-----------perl
   |-------------authorization
   |-------------common
   |-------------identity
   |-------------networkdevice
   |-----------resources
   |-------target
   |---------archive-tmp
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------piclient
   |---------------------authorization
   |---------------------common
   |---------------------identity
   |---------------------networkdevice
   |-----ucp
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------clients
   |-------------------------ucp
   |---------------------------servlets
   |-----------webapp
   |-------------WEB-INF
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------clients
   |-----------------------ucp
   |-------------------------servlets
   |---------gui-sample-ucp-5.3.0.32.100
   |-----------META-INF
   |-----------WEB-INF
   |-------------classes
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------clients
   |---------------------------ucp
   |-----------------------------servlets
   |-------------lib
   |---common
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------common
   |-----------------------activedirectory
   |-----------------------attributedictionary
   |-----------------------audit
   |-----------------------certificate
   |-------------------------impl
   |-----------------------criteria
   |-----------------------dist
   |-----------------------exception
   |-------------------------util
   |---------------------------concurrent
   |-----------------------ldap
   |-----------------------licensing
   |-----------------------logging
   |-----------------------messagehandlers
   |-----------------------security
   |-----------------------util
   |-------------------------concurrent
   |-----------------------version
   |-----------------------wd
   |---------resources
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------gui
   |-----------------------app
   |-----------templateForCli
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------common
   |-----------------------activedirectory
   |-----------------------attributedictionary
   |-----------------------certificate
   |-----------------------criteria
   |-----------------------dist
   |-----------------------exception
   |-----------------------ldap
   |-----------------------licensing
   |-----------------------logging
   |-----------------------messagehandlers
   |-----------------------version
   |---------resources
   |-----------bin
   |-----------certificateFiles
   |-----------licenseFiles
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------common
   |---------------------activedirectory
   |---------------------attributedictionary
   |---------------------certificate
   |-----------------------impl
   |---------------------criteria
   |---------------------dist
   |---------------------exception
   |-----------------------util
   |-------------------------concurrent
   |---------------------ldap
   |---------------------licensing
   |---------------------logging
   |---------------------messagehandlers
   |---------------------security
   |---------------------util
   |-----------------------concurrent
   |---------------------version
   |---------------------wd
   |-------------------gui
   |---------------------app
   |---------templateForCli
   |-------generated
   |---------src
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------common
   |-------------------------attributedictionary
   |-------------------------logging
   |-------------META-INF
   |-------maven-dependency-plugin-markers
   |-------test-classes
   |---------bin
   |---------certificateFiles
   |---------licenseFiles
   |---configloader
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------configloader
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------configloader
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------configloader
   |---configrecovery
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------configrecovery
   |-----------------------web
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------configrecovery
   |---------resources
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------configrecovery
   |---------------------web
   |-------test-classes
   |---db
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------db
   |-----------------------hibernate
   |-------------------------usertypes
   |-----------------------pagination
   |-------------------------sybase
   |---------------------upgrade
   |---------resources
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------upgrade
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------db
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------db
   |---------------------hibernate
   |-----------------------usertypes
   |---------------------pagination
   |-----------------------sybase
   |-------------------upgrade
   |-------dependency-maven-plugin-markers
   |-------generated
   |---------src
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------upgrade
   |-----------META-INF
   |---dbpassword
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------dbpassword
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------dbpassword
   |---dbsupport
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------dbsupport
   |-------test
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------dbsupport
   |---dbtools
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------dbtools
   |-----------------------sybase
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------dbtools
   |-----------------------sybase
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------dbtools
   |---------------------sybase
   |---distributedmanagement
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------distributedmanagement
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------distributedmanagement
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------distributedmanagement
   |---dynamic-azn
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------dynamic_azn
   |-----------------------coa
   |-------------------------xml
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------dynamic_azn
   |---------------------coa
   |-----------------------xml
   |---eapfast
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------eapfast
   |-----------------------exception
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------eapfast
   |---------------------exception
   |---gui
   |-----app
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------app
   |---------------------------actions
   |---------------------------defaults
   |---------------------------entities
   |---------------------------exceptions
   |---------------------------forms
   |---------------------------navigation
   |---------------------------policy
   |---------------------------renderers
   |---------------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------app
   |-------------------------audit
   |-------------------------navigation
   |-------------------------policy
   |-----------webapp
   |-------------pages
   |---------------AccessServices
   |---------------ACSCertificateStore
   |---------------AcsDeployment
   |---------------AcsView
   |---------------ActiveDirectory
   |---------------ADAttributes
   |---------------ADGroups
   |---------------AdminAuthenticationSettings
   |---------------Administrator
   |---------------AdminSessionSettings
   |---------------AppUtils
   |---------------AttributeAlias
   |---------------Certificate
   |---------------CertificateAttribute
   |---------------CertificateAuthenticationProfile
   |---------------CertificateSigningRequest
   |---------------Command
   |---------------CommandSet
   |---------------CommonIdentity
   |---------------CstExample
   |---------------DefaultNetworkDevice
   |---------------DictionaryAcs
   |---------------DictionaryDevice
   |---------------DictionaryExternalIDStore
   |---------------DictionaryRadius
   |---------------DictionaryTACACS
   |---------------DownloadableAccessControlList
   |---------------EAPFASTSettings
   |---------------EAPTLSSettings
   |---------------EgressMatrixTable
   |---------------EgressPolicy
   |---------------EnumDefinition
   |---------------ExternalDBs
   |---------------ExternalIdentityStore
   |---------------framework
   |-----------------customAlert
   |-----------------images
   |-----------------import
   |-----------------policy
   |-----------------purgesessions
   |-----------------stylesheets
   |---------------GettingStarted
   |-----------------acs5-1-iov
   |-------------------data
   |---------------------swf
   |-------------------player
   |---------------IdentityGroups
   |---------------IdentitySequence
   |---------------IdentitySource
   |---------------InternalConfig
   |---------------InternalMab
   |---------------InternalMabDictionary
   |---------------InternalUser
   |---------------InternalUsersDictionary
   |---------------IPAddressFiltering
   |---------------LdapMssAttributes
   |---------------LdapMssGroups
   |---------------License
   |---------------LocalStore
   |---------------LoggingCategories
   |---------------LogMessages
   |---------------LogNodes
   |---------------LogViews
   |---------------MaxSessionGlobalSettings
   |---------------MaxSessionGroupSettings
   |---------------MaxUserSession
   |---------------MyAccount
   |---------------NARs
   |---------------NDACConfiguration
   |---------------NetworkAccess
   |---------------NetworkDeviceGroup
   |---------------NetworkDeviceGroups
   |---------------NetworkDevices
   |---------------OOBPACProvisioning
   |---------------PEAPSettings
   |---------------PolicyElements
   |-----------------DateAndTime
   |---------------PolicyExtentions
   |---------------PostureServer
   |---------------RadiusProxyServer
   |---------------RadiusToken
   |---------------RemoteLogTargets
   |---------------Repository
   |---------------Roles
   |---------------RSAGlobal
   |---------------RSARealm
   |---------------ScheduledBackup
   |---------------SecGroup
   |---------------SGAccessControlList
   |---------------SGMatrixCell
   |---------------ShellProfiles
   |---------------SoftwareUpdate
   |---------------StringEnumDefinition
   |---------------TacacsSettings
   |---------------TemplateServiceSelector
   |---------------TreeSelector
   |---------------UserAuthenticationOptions
   |---------------UsersAuthenSettings
   |---------------VendorSpecificAttribute
   |---------------VSAVendor
   |---------------Workspace
   |-------------WEB-INF
   |---------------tld
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------app
   |---------------------------entities
   |---------------------------forms
   |---------------------------stubs
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------navigation
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------gui
   |-----------------------app
   |-------------------------actions
   |-------------------------defaults
   |-------------------------entities
   |-------------------------exceptions
   |-------------------------forms
   |-------------------------navigation
   |-------------------------policy
   |-------------------------renderers
   |-------------------------utils
   |-----------------------audit
   |-----------------------navigation
   |-----------------------policy
   |---------dependency-maven-plugin-markers
   |---------gui-web-5.3.0.32.100
   |-----------cues_icons
   |-----------cues_images
   |-----------cues_utility
   |-----------help
   |-------------ACSHelp
   |---------------images
   |-----------mappingfiles
   |-----------META-INF
   |-------------maven
   |---------------com.cisco.nm.acs.mgmt.help.gui
   |-----------------gui-online-help
   |-----------pages
   |-------------AccessServices
   |-------------ACSCertificateStore
   |-------------AcsDeployment
   |-------------AcsView
   |-------------ActiveDirectory
   |-------------ADAttributes
   |-------------ADGroups
   |-------------AdminAuthenticationSettings
   |-------------Administrator
   |-------------AdminSessionSettings
   |-------------AppUtils
   |-------------AttributeAlias
   |-------------Certificate
   |-------------CertificateAttribute
   |-------------CertificateAuthenticationProfile
   |-------------CertificateSigningRequest
   |-------------Command
   |-------------CommandSet
   |-------------CommonIdentity
   |-------------CstExample
   |-------------DefaultNetworkDevice
   |-------------DictionaryAcs
   |-------------DictionaryDevice
   |-------------DictionaryExternalIDStore
   |-------------DictionaryRadius
   |-------------DictionaryTACACS
   |-------------DownloadableAccessControlList
   |-------------EAPFASTSettings
   |-------------EAPTLSSettings
   |-------------EgressMatrixTable
   |-------------EgressPolicy
   |-------------EnumDefinition
   |-------------ExternalDBs
   |-------------ExternalIdentityStore
   |-------------framework
   |---------------customAlert
   |---------------images
   |---------------import
   |---------------policy
   |---------------purgesessions
   |---------------stylesheets
   |-------------GettingStarted
   |---------------acs5-1-iov
   |-----------------data
   |-------------------swf
   |-----------------player
   |-------------IdentityGroups
   |-------------IdentitySequence
   |-------------IdentitySource
   |-------------InternalConfig
   |-------------InternalMab
   |-------------InternalMabDictionary
   |-------------InternalUser
   |-------------InternalUsersDictionary
   |-------------IPAddressFiltering
   |-------------LdapMssAttributes
   |-------------LdapMssGroups
   |-------------License
   |-------------LocalStore
   |-------------LoggingCategories
   |-------------LogMessages
   |-------------LogNodes
   |-------------LogViews
   |-------------MaxSessionGlobalSettings
   |-------------MaxSessionGroupSettings
   |-------------MaxUserSession
   |-------------MyAccount
   |-------------NARs
   |-------------NDACConfiguration
   |-------------NetworkAccess
   |-------------NetworkDeviceGroup
   |-------------NetworkDeviceGroups
   |-------------NetworkDevices
   |-------------OOBPACProvisioning
   |-------------PEAPSettings
   |-------------PolicyElements
   |---------------DateAndTime
   |-------------PolicyExtentions
   |-------------PostureServer
   |-------------RadiusProxyServer
   |-------------RadiusToken
   |-------------RemoteLogTargets
   |-------------Repository
   |-------------Roles
   |-------------RSAGlobal
   |-------------RSARealm
   |-------------ScheduledBackup
   |-------------SecGroup
   |-------------SGAccessControlList
   |-------------SGMatrixCell
   |-------------ShellProfiles
   |-------------SoftwareUpdate
   |-------------StringEnumDefinition
   |-------------TacacsSettings
   |-------------TemplateServiceSelector
   |-------------TreeSelector
   |-------------UserAuthenticationOptions
   |-------------UsersAuthenSettings
   |-------------VendorSpecificAttribute
   |-------------VSAVendor
   |-------------Workspace
   |-----------shared
   |-------------images
   |-----------tigra
   |-------------icons
   |---------------oldHeight
   |-----------udm-resources
   |-----------WEB-INF
   |-------------classes
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------gui
   |---------------------------app
   |-----------------------------actions
   |-----------------------------defaults
   |-----------------------------entities
   |-----------------------------exceptions
   |-----------------------------forms
   |-----------------------------navigation
   |-----------------------------policy
   |-----------------------------renderers
   |-----------------------------utils
   |---------------------------audit
   |---------------------------navigation
   |---------------------------policy
   |-------------lib
   |-------------tld
   |---------overlay
   |-----------cues_icons
   |-----------cues_images
   |-----------cues_utility
   |-----------help
   |-------------ACSHelp
   |---------------images
   |-----------mappingfiles
   |-----------META-INF
   |-------------maven
   |---------------com.cisco.nm.acs.mgmt.help.gui
   |-----------------gui-online-help
   |-----------shared
   |-------------images
   |-----------tigra
   |-------------icons
   |---------------oldHeight
   |-----------udm-resources
   |-----------WEB-INF
   |-------------lib
   |---------test-classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------gui
   |-----------------------navigation
   |-----examples
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------examples
   |---------------------------actions
   |---------------------------entities
   |---------------------------forms
   |---------------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------examples
   |-------------------------policy
   |-----------webapp
   |-------------pages
   |---------------ActiveDirectorySelector
   |---------------ActiveDirectorySelectorFlow
   |---------------AuditLogsView
   |---------------Dictionaries
   |---------------Dictionary
   |---------------DistributedManager
   |---------------framework
   |-----------------images
   |-----------------policy
   |---------------LdapMss
   |---------------LdapMssFlow
   |---------------LFlowExample
   |---------------LogsView
   |---------------LPFlowExample
   |---------------MCLB
   |---------------PFlowExample
   |---------------Selector
   |---------------SelectorTree
   |---------------TableBasic
   |---------------TablePaging
   |---------------TablePolicy
   |---------------TableRenderers
   |---------------TableTree
   |---------------TransferBox
   |-------------WEB-INF
   |---------------tld
   |-----framework
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------framework
   |---------------------------actions
   |---------------------------forms
   |---------------------------licensing
   |---------------------------mssUtils
   |---------------------------navigation
   |---------------------------policy
   |---------------------------purgesessions
   |---------------------------renderers
   |---------------------------taglibs
   |-----------------------------mclb
   |---------------------------utils
   |---------------------------web
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------framework
   |---------------------------xjb
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------app
   |---------------------------actions
   |---------------------------forms
   |---------------------------navigation
   |-------------------------framework
   |---------------------------actions
   |---------------------------forms
   |---------------------------navigation
   |---------------------------olh
   |---------------------------taglibs
   |---------------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------framework
   |---------------------------navigation
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------gui
   |-----------------------framework
   |-------------------------actions
   |-------------------------forms
   |-------------------------licensing
   |-------------------------mssUtils
   |-------------------------navigation
   |-------------------------policy
   |-------------------------purgesessions
   |-------------------------renderers
   |-------------------------taglibs
   |---------------------------mclb
   |-------------------------utils
   |-------------------------web
   |-------------------------xjb
   |---------generated-sources
   |-----------jaxb
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------gui
   |-------------------------framework
   |---------------------------navigation
   |---------test-classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------gui
   |-----------------------framework
   |-------------------------navigation
   |---help
   |-----gui
   |-------src
   |---------main
   |-----------resources
   |-------target
   |---------classes
   |-----------help
   |-------------ACSHelp
   |---------------images
   |-----------mappingfiles
   |-----------shared
   |-------------images
   |---------src
   |-----------resources
   |-------------help
   |---------------ACSHelp
   |-----------------images
   |-------------mappingfiles
   |-------------shared
   |---------------images
   |---im
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------im
   |---------------------distributedmanagement
   |---------------------jibx
   |---------------------licensing
   |---------------------metadata
   |---------------------test
   |-------------------mgmt
   |---------------------aac
   |---------resources
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------im
   |---------------------xjb
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------im
   |---------------------jibx
   |---------------------test
   |-------------------mgmt
   |---------------------im
   |-----------------------networkdevice
   |-----------------------test
   |-----target
   |-------classes
   |---------aac
   |---------authorization
   |---------certificate
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------im
   |-------------------aac
   |-------------------authorization
   |-------------------certificate
   |-------------------common
   |-------------------cts
   |-------------------dictionary
   |-------------------distributedmanagement
   |-------------------externalserver
   |-------------------identity
   |-------------------idstore
   |-------------------jibx
   |-------------------licensing
   |-------------------logging
   |-------------------metadata
   |-------------------networkdevice
   |-------------------policy
   |-------------------service
   |-------------------variables
   |-------------------xjb
   |-----------------mgmt
   |-------------------aac
   |---------common
   |---------cts
   |---------dictionary
   |---------distributedmanagement
   |---------externalserver
   |---------identity
   |---------idstore
   |---------logging
   |---------networkdevice
   |---------policy
   |---------service
   |---------variables
   |-------dependency-maven-plugin-markers
   |-------generated
   |---------src
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------im
   |-----------------------aac
   |-----------------------authorization
   |-----------------------certificate
   |-----------------------common
   |-----------------------cts
   |-----------------------dictionary
   |-----------------------distributedmanagement
   |-----------------------externalserver
   |-----------------------identity
   |-----------------------idstore
   |-----------------------logging
   |-----------------------networkdevice
   |-----------------------policy
   |-----------------------service
   |-----------------------variables
   |-----------META-INF
   |-----------resources
   |-------------aac
   |-------------authorization
   |-------------certificate
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------im
   |-------------common
   |-------------cts
   |-------------dictionary
   |-------------distributedmanagement
   |-------------externalserver
   |-------------identity
   |-------------idstore
   |-------------logging
   |-------------networkdevice
   |-------------policy
   |-------------service
   |-------------variables
   |-------generated-sources
   |---------jaxb
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------im
   |---------------------xjb
   |---internalcli
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------cli
   |-----------------------internal
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------cli
   |---------------------internal
   |---licensing
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------licensing
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------licensing
   |---logging
   |-----interface
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------logging
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------logging
   |-----logging
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------logging
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------logging
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------logging
   |---messagebus
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------msgbus
   |-----------------------bus
   |-----------------------data
   |-----------------------runtime
   |-----------------------security
   |-----------------------ssl
   |---------resources
   |-----------META-INF
   |-------------services
   |---------------org
   |-----------------apache
   |-------------------activemq
   |---------------------transport
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------buscomm
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------msgbus
   |---------------------bus
   |---------------------data
   |---------------------runtime
   |---------------------security
   |---------------------ssl
   |---------META-INF
   |-----------services
   |-------------org
   |---------------apache
   |-----------------activemq
   |-------------------transport
   |---migration
   |-----DbDriver
   |-----DbPassword
   |-------include
   |-----src
   |-------assembly
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------migration
   |-----------------------dacl
   |-----------------------mab
   |-----------------------masterKeys
   |-----------------------NDG
   |-----------------------networkdevice
   |-----------------------rac
   |-----------------------subject
   |-----------------------tacacs
   |-----------------------user
   |-----------------------userAttribute
   |-----------------------userAttributesValues
   |-----------------------userGroup
   |-----------------------utils
   |-----------------------vsa
   |---------resources
   |---------scripts
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------migration
   |-----------------------NDG
   |-----------------------tacacs
   |-----------------------userGroup
   |-----target
   |-------archive-tmp
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------migration
   |---------------------dacl
   |---------------------mab
   |---------------------masterKeys
   |---------------------NDG
   |---------------------networkdevice
   |---------------------rac
   |---------------------subject
   |---------------------tacacs
   |---------------------user
   |---------------------userAttribute
   |---------------------userAttributesValues
   |---------------------userGroup
   |---------------------utils
   |---------------------vsa
   |-----UtilsDll
   |---performancemonitoring
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------performancemonitoring
   |-----------------------filter
   |-----------------------jmx
   |-----------------------util
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------performancemonitoring
   |---------------------filter
   |---------------------jmx
   |---------------------util
   |---pi
   |-----app
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------app
   |---------------------------handler
   |-----------------------------certificate
   |-----------------------------distributedmanagement
   |---------------------------transformer
   |-----------------------------contained
   |---------------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------framework
   |---------------------------appapi
   |-----------------------------registration
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------im
   |-----------------------test
   |-------------------------util
   |---------------------mgmt
   |-----------------------pi
   |-------------------------app
   |---------------------------handler
   |-----------------------------referenceUtils
   |-----------------------------test
   |-----------------------------testcert
   |---------------------------transformer
   |-----------------------------mgmt
   |-------------------------------pi
   |---------------------------------schema
   |-----------------------------transformer
   |---------------------------utils
   |-------------------------schema
   |---------------------------im
   |---------------------------pi
   |-----------------------------app
   |-------------------------------transformer
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------im
   |---------------------aac
   |-----------------------transformer
   |---------------------authorization
   |-----------------------transformer
   |---------------------certificate
   |-----------------------transformer
   |---------------------common
   |-----------------------transformer
   |---------------------cts
   |-----------------------transformer
   |---------------------dictionary
   |-----------------------transformer
   |---------------------distributedmanagement
   |-----------------------transformer
   |---------------------externalserver
   |-----------------------transformer
   |---------------------identity
   |-----------------------transformer
   |---------------------idstore
   |-----------------------transformer
   |---------------------logging
   |-----------------------transformer
   |---------------------networkdevice
   |-----------------------transformer
   |---------------------policy
   |-----------------------transformer
   |---------------------service
   |-----------------------transformer
   |---------------------variables
   |-----------------------transformer
   |-------------------mgmt
   |---------------------pi
   |-----------------------app
   |-------------------------handler
   |---------------------------certificate
   |---------------------------distributedmanagement
   |-------------------------transformer
   |---------------------------contained
   |-------------------------utils
   |-----------------------framework
   |-------------------------appapi
   |---------------------------registration
   |-----------META-INF
   |---------dependency-maven-plugin-markers
   |---------generated
   |-----------src
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------im
   |-------------------------aac
   |---------------------------transformer
   |-------------------------authorization
   |---------------------------transformer
   |-------------------------certificate
   |---------------------------transformer
   |-------------------------common
   |---------------------------transformer
   |-------------------------cts
   |---------------------------transformer
   |-------------------------dictionary
   |---------------------------transformer
   |-------------------------distributedmanagement
   |---------------------------transformer
   |-------------------------externalserver
   |---------------------------transformer
   |-------------------------identity
   |---------------------------transformer
   |-------------------------idstore
   |---------------------------transformer
   |-------------------------logging
   |---------------------------transformer
   |-------------------------networkdevice
   |---------------------------transformer
   |-------------------------policy
   |---------------------------transformer
   |-------------------------service
   |---------------------------transformer
   |-------------------------variables
   |---------------------------transformer
   |---------------META-INF
   |-------------resources
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------pi
   |---------------------------framework
   |-----------------------------appapi
   |-------------------------------registration
   |---------------META-INF
   |-------------test
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------im
   |-------------------------aac
   |---------------------------pi
   |-----------------------------test
   |-------------------------authorization
   |---------------------------pi
   |-----------------------------test
   |-------------------------certificate
   |---------------------------pi
   |-----------------------------test
   |-------------------------common
   |---------------------------pi
   |-----------------------------test
   |-------------------------cts
   |---------------------------pi
   |-----------------------------test
   |-------------------------dictionary
   |---------------------------pi
   |-----------------------------test
   |-------------------------distributedmanagement
   |---------------------------pi
   |-----------------------------test
   |-------------------------externalserver
   |---------------------------pi
   |-----------------------------test
   |-------------------------identity
   |---------------------------pi
   |-----------------------------test
   |-------------------------idstore
   |---------------------------pi
   |-----------------------------test
   |-------------------------logging
   |---------------------------pi
   |-----------------------------test
   |-------------------------networkdevice
   |---------------------------pi
   |-----------------------------test
   |-------------------------policy
   |---------------------------pi
   |-----------------------------test
   |-------------------------service
   |---------------------------pi
   |-----------------------------test
   |---------------META-INF
   |-------testcert
   |-----axis
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------axis
   |---------------------------handlers
   |-----------------------------validation
   |-------------------------web
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------axis
   |---------------------------handlers
   |-----------------------------validation
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------pi
   |-----------------------axis
   |-------------------------handlers
   |---------------------------validation
   |-----------------------web
   |-----distmgmttest
   |-------src
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------distmgmttest
   |-------------------------distmgmt-test
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------framework
   |---------------------------appapi
   |-----------------------------registration
   |-------target
   |---------test-classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------pi
   |-----------------------framework
   |-------------------------appapi
   |---------------------------registration
   |-----framework
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------framework
   |---------------------------appapi
   |-----------------------------exceptions
   |-----------------------------requests
   |-----------------------------responses
   |-----------------------------types
   |---------------------------errorhandling
   |---------------------------spml
   |-----------------------------errorhandling
   |-----------------------------handlers
   |-----------------------------registration
   |-----------------------------translators
   |-------------------------------requests
   |-------------------------------responses
   |-----------------------------validators
   |-------------------------------add
   |-------------------------------delete
   |-------------------------------iterate
   |-------------------------------lookup
   |-------------------------------modify
   |-------------------------------search
   |---------------------------urn
   |---------------------------xpath
   |-------------------------service
   |-----------------------ucp
   |-------------------------service
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------framework
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------im
   |-------------------------networkdevice
   |-----------------------pi
   |-------------------------framework
   |---------------------------appapi
   |---------------------------spml
   |-----------------------------errorhandling
   |-----------------------------handlers
   |-----------------------------registration
   |-----------------------------translators
   |-------------------------------requests
   |-------------------------------responses
   |-----------------------------validators
   |---------------------------test
   |-----------------------------utils
   |---------------------------urn
   |---------------------------xpath
   |-------------------------schema
   |---------------------------im
   |-----------------------------networkdevice
   |-------------------------service
   |-----------resources
   |-------------bin
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------pi
   |-------------------------framework
   |---------------------------appapi
   |-----------------------------registration
   |---------------------------spml
   |-----------------------------registration
   |-----------------------------validators
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------pi
   |-----------------------framework
   |-------------------------appapi
   |---------------------------exceptions
   |---------------------------requests
   |---------------------------responses
   |---------------------------types
   |-------------------------errorhandling
   |-------------------------spml
   |---------------------------errorhandling
   |---------------------------handlers
   |---------------------------registration
   |---------------------------translators
   |-----------------------------requests
   |-----------------------------responses
   |---------------------------validators
   |-----------------------------add
   |-----------------------------delete
   |-----------------------------iterate
   |-----------------------------lookup
   |-----------------------------modify
   |-----------------------------search
   |-------------------------urn
   |-------------------------xpath
   |-----------------------service
   |---------------------ucp
   |-----------------------service
   |---------test-classes
   |-----------bin
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------pi
   |-----------------------framework
   |-------------------------appapi
   |---------------------------registration
   |-------------------------spml
   |---------------------------registration
   |-----schema
   |-------src
   |---------assembly
   |---------main
   |-----------java
   |-----------wsdl
   |-------------certificate
   |-------------distributed_mgmt
   |-------------pi
   |-------------spml
   |-------------spmlext
   |-------target
   |---------classes
   |-----------_0
   |-------------_2
   |---------------SPML
   |-----------------tc
   |-------------------names
   |---------------------oasis
   |-----------batch
   |-------------_0
   |---------------_2
   |-----------------SPML
   |-------------------tc
   |---------------------names
   |-----------------------oasis
   |-----------bulk
   |-------------_0
   |---------------_2
   |-----------------SPML
   |-------------------tc
   |---------------------names
   |-----------------------oasis
   |-----------certificate
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------pi
   |-----------------------certificatemanagement
   |-----------------------distmgmt
   |-----------------------schema
   |-------------------------im
   |---------------------------aac
   |---------------------------authorization
   |---------------------------certificate
   |---------------------------com_cisco_nm_acs_im
   |---------------------------common
   |---------------------------core
   |---------------------------cts
   |---------------------------dictionary
   |---------------------------distributedmanagement
   |---------------------------externalserver
   |---------------------------identity
   |---------------------------idstore
   |---------------------------logging
   |---------------------------networkdevice
   |---------------------------pi_enum
   |---------------------------policy
   |---------------------------service
   |---------------------------variables
   |-----------------------service
   |-----------------------spml
   |-------------------------ext
   |---------------------ucp
   |-----------------------service
   |---------------www
   |-----------------pi_service
   |-----------distributed_mgmt
   |-----------META-INF
   |-----------pi
   |-----------reference
   |-------------_0
   |---------------_2
   |-----------------SPML
   |-------------------tc
   |---------------------names
   |-----------------------oasis
   |-----------search
   |-------------_0
   |---------------_2
   |-----------------SPML
   |-------------------tc
   |---------------------names
   |-----------------------oasis
   |-----------spml
   |-----------spmlext
   |---------dependency-maven-plugin-markers
   |---------generated
   |-----------src
   |-------------wsdl
   |---------------certificate
   |---------------distributed_mgmt
   |---------------META-INF
   |---------------pi
   |---------------spml
   |---------------spmlext
   |---------generated-sources
   |-----------axistools
   |-------------wsdl2java
   |---------------_0
   |-----------------_2
   |-------------------SPML
   |---------------------tc
   |-----------------------names
   |-------------------------oasis
   |---------------batch
   |-----------------_0
   |-------------------_2
   |---------------------SPML
   |-----------------------tc
   |-------------------------names
   |---------------------------oasis
   |---------------bulk
   |-----------------_0
   |-------------------_2
   |---------------------SPML
   |-----------------------tc
   |-------------------------names
   |---------------------------oasis
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------pi
   |---------------------------certificatemanagement
   |---------------------------distmgmt
   |---------------------------schema
   |-----------------------------im
   |-------------------------------aac
   |-------------------------------authorization
   |-------------------------------certificate
   |-------------------------------com_cisco_nm_acs_im
   |-------------------------------common
   |-------------------------------core
   |-------------------------------cts
   |-------------------------------dictionary
   |-------------------------------distributedmanagement
   |-------------------------------externalserver
   |-------------------------------identity
   |-------------------------------idstore
   |-------------------------------logging
   |-------------------------------networkdevice
   |-------------------------------pi_enum
   |-------------------------------policy
   |-------------------------------service
   |-------------------------------variables
   |---------------------------service
   |---------------------------spml
   |-----------------------------ext
   |-------------------------ucp
   |---------------------------service
   |-------------------www
   |---------------------pi_service
   |---------------reference
   |-----------------_0
   |-------------------_2
   |---------------------SPML
   |-----------------------tc
   |-------------------------names
   |---------------------------oasis
   |---------------search
   |-----------------_0
   |-------------------_2
   |---------------------SPML
   |-----------------------tc
   |-------------------------names
   |---------------------------oasis
   |---------wsdd
   |-----ws
   |-------src
   |---------main
   |-----------resources
   |-----------webapp
   |-------------WEB-INF
   |-------target
   |---------classes
   |---------pi-web-5.3.0.32.100
   |-----------certificate
   |-----------distributed_mgmt
   |-----------META-INF
   |-----------pi
   |-----------spml
   |-----------spmlext
   |-----------WEB-INF
   |-------------classes
   |-------------lib
   |---protocoluserfailedattempt
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------userfailedattempt
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------userfailedattempt
   |---replication
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------replication
   |-----------------------command
   |-----------------------rmi
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------replication
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------replication
   |---------------------command
   |---------------------rmi
   |---rest
   |-----framework
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------acs
   |-------------------mgmt
   |---------------------rest
   |-----------------------framework
   |-------------------------api
   |---------------------------common
   |---------------------------identity
   |-------------------------errorhandling
   |-------------------------exceptions
   |-------------------------response
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------rest
   |-------------------------api
   |---------------------------identity
   |-----------------------------user
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------acs
   |-----------------mgmt
   |-------------------rest
   |---------------------framework
   |-----------------------api
   |-------------------------common
   |-------------------------identity
   |-----------------------errorhandling
   |-----------------------exceptions
   |-----schema
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------rest
   |-------------------------common
   |---------------------------env
   |-------------------------identity
   |-------------------------query
   |---------------------rest
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------rest
   |-----------------------common
   |-----------------------identity
   |-----------------------query
   |-----ws
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------mgmt
   |-----------------------rest
   |-------------------------web
   |-----------webapp
   |-------------WEB-INF
   |-------target
   |---------classes
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------rest
   |-----------------------web
   |---------rest-web-5.3.0.32.100
   |-----------META-INF
   |-----------WEB-INF
   |-------------classes
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------mgmt
   |-------------------------rest
   |---------------------------web
   |-------------lib
   |---server
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------server
   |---transferutils
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------transferutils
   |-----------------------importtask
   |-------------------------media
   |---------------------------csv
   |---------------------------validators
   |-------------------------parsers
   |-------------------------utils
   |-----------------------importutil
   |-------------------------exceptions
   |-------------------------impl
   |---------------------------crudhandlers
   |-----------------------------attrhandlers
   |-------------------------report
   |-----------------------operations
   |-----------------------supportutil
   |---------resources
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------transferutils
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------transferutils
   |-----------------------importtask
   |-------------------------media
   |---------------------------csv
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------transferutils
   |---------------------importtask
   |-----------------------media
   |-------------------------csv
   |-------------------------validators
   |-----------------------parsers
   |-----------------------utils
   |---------------------importutil
   |-----------------------exceptions
   |-----------------------impl
   |-------------------------crudhandlers
   |---------------------------attrhandlers
   |-----------------------report
   |---------------------operations
   |---------------------supportutil
   |-obsolete
   |---dbPassword
   |-----integration
   |-------src
   |---------main
   |-----------java
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------db
   |-----java
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------db
   |-----native
   |-------src
   |-------test
   |-----utility
   |-------src
   |---mgmt
   |-----audit
   |-----bl
   |-------framework
   |-----changepassword
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------changepassword
   |-----messageBus
   |---runtime
   |-----events
   |-------messageBusEvent
   |---------src
   |-----externalRes
   |-------idstores
   |---------idstore
   |-----------src
   |-----flow
   |-------changePassword
   |---------src
   |-------tacacs
   |---------authorization
   |-----------flowTestUtility
   |-------------src
   |---------tacacsCommandAuthorizationFlow
   |-----------src
   |-----------test
   |---------tacacsShellFlow
   |-----------src
   |-----------test
   |-----include
   |-----infrastructure
   |-------dictionary
   |---------src
   |-------dictionary_2
   |---------src
   |---------test
   |-------dictionaryLoader.phase2
   |---------config
   |---------src
   |---------test
   |-------dictionary.phase2
   |---------src
   |---------test
   |-------eventHandler
   |---------src
   |---------test
   |-------keyConverter.phase2
   |---------config
   |---------src
   |---------test
   |-------notification
   |---------src
   |---------test
   |-----messageBus
   |-------event
   |---------src
   |-----------Debug
   |-------flow
   |---------src
   |-----------Debug
   |-------protocol
   |---------src
   |-----------Debug
   |---------test
   |-----radius
   |-------flowTestUtility
   |---------src
   |---------test
   |---view
   |-----data
   |-openSSL
   |---libCrypto
   |---libSsl
   |-----src
   |---openssl
   |-----apps
   |-------demoCA
   |---------private
   |-------set
   |-----bugs
   |-----certs
   |-------demo
   |-------expired
   |-----crypto
   |-------aes
   |-------asn1
   |-------bf
   |---------asm
   |-------bio
   |-------bn
   |---------asm
   |-----------alpha
   |-----------alpha.works
   |-----------x86
   |-------buffer
   |-------cast
   |---------asm
   |-------comp
   |-------conf
   |-------des
   |---------asm
   |---------t
   |---------times
   |-------dh
   |-------dsa
   |-------dso
   |-------ec
   |-------engine
   |---------vendor_defns
   |-------err
   |-------evp
   |-------hmac
   |-------idea
   |-------krb5
   |-------lhash
   |-------md2
   |-------md4
   |-------md5
   |---------asm
   |-------mdc2
   |-------objects
   |-------ocsp
   |-------pem
   |-------perlasm
   |-------pkcs12
   |-------pkcs7
   |---------p7
   |---------t
   |-------rand
   |-------rc2
   |-------rc4
   |---------asm
   |-------rc5
   |---------asm
   |-------ripemd
   |---------asm
   |-------rsa
   |-------sha
   |---------asm
   |-------stack
   |-------threads
   |-------txt_db
   |-------ui
   |-------x509
   |-------x509v3
   |-----demos
   |-------asn1
   |-------bio
   |-------easy_tls
   |-------eay
   |-------engines
   |---------cluster_labs
   |---------ibmca
   |---------rsaref
   |---------zencod
   |-------maurice
   |-------pkcs12
   |-------prime
   |-------sign
   |-------ssl
   |-------state_machine
   |-------tunala
   |-------x509
   |-----doc
   |-------apps
   |-------crypto
   |-------HOWTO
   |-------ssl
   |-----fips-1.0
   |-------aes
   |---------asm
   |-------des
   |---------asm
   |-------dh
   |-------dsa
   |-------hmac
   |-------rand
   |-------rsa
   |-------sha
   |---------asm
   |-----MacOS
   |-------GetHTTPS.src
   |-----ms
   |-----obsolete
   |-----os2
   |-----shlib
   |-----ssl
   |-----test
   |-----times
   |-------090
   |-------091
   |-------x86
   |-----tools
   |-----util
   |-------pl
   |-----VMS
   |-patches_5_2
   |---5-2-0-21-1
   |-----files
   |-----readme
   |-postbuild
   |---src
   |-----main
   |-------xsl
   |-prebuild
   |---aac
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------prebuild
   |---------------------aac
   |---------resources
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------prebuild
   |-------------------aac
   |-------sql
   |-------upgrade
   |---acs-client
   |-----target
   |-------acsclient
   |---------AcsClient_install
   |-----------AcsClient
   |-------------psyco
   |-------------tempCrypto
   |-----------CoreFlowspecLibrary
   |-----------Dictionary_FreeRadius
   |-----------pyrad
   |-------------example
   |-------------pyrad-1.1
   |-------------pyrad.egg-info
   |-------------tests
   |---------------data
   |-----------userHomeDir.sample
   |---------obsolete
   |-----------sslAcsc.old
   |-------------src
   |-----------UserFlowspecLibrary
   |-------dependency-maven-plugin-markers
   |-------javaapi
   |---acs-testng
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------testng
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------mgmt
   |---------------------testng
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------mgmt
   |-------------------testng
   |---msgcat
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------codegen
   |---------------------attributedictionary
   |---------------------messagecatalog
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------codegen
   |-------------------attributedictionary
   |-------------------messagecatalog
   |---spring-config-validate
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------springconfigvalidate
   |---------resources
   |---------scripts
   |-----target
   |-------classes
   |---------com
   |-----------cisco
   |-------------nm
   |---------------acs
   |-----------------springconfigvalidate
   |---util
   |-----src
   |-------main
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------prebuild
   |---------------------util
   |-------test
   |---------java
   |-----------com
   |-------------cisco
   |---------------nm
   |-----------------acs
   |-------------------prebuild
   |---------------------util
   |-runtime
   |---3rdParty
   |-----otlv4_h
   |---build
   |-----lnx26
   |-------bin
   |-------examples
   |-------include
   |-------lib
   |-------scripts
   |-----makefiles
   |-----tools
   |-------lnx26
   |-------sh
   |-------win32
   |---businessLogic
   |-----authenticators
   |-------authenticator
   |---------src
   |-----------Debug
   |-------certificateAuthenticator
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------chapAuthenticator
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------enableAuthenticator
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------identityLookupAuthenticator
   |---------src
   |-----------Debug
   |-------mschapAuthenticator
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------papAuthenticator
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-----authorization
   |-------authorizeEvent
   |---------src
   |-----------Debug
   |-------ctsAuthorization
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------deviceCommandAuthorization
   |---------src
   |-----------Debug
   |---------test
   |-------deviceSessionAuthorization
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-------radiusAuthorization
   |---------src
   |-----------Debug
   |-------sessionAuthorization
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------sgAuthorization
   |---------src
   |-----------Debug
   |-----dACL
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----dynamicAuthorization
   |-------config
   |-------test
   |-----mar
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----sessionCache
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----workflows
   |-------composableWorkflow
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------groupMappingWorkflow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------identitySequenceWorkflow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-----workflowsData
   |-------workflowEventNames
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------workflowEvents
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------workflowKeys
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |---daemons
   |-----logForward
   |-------config
   |---------install-DebugLog
   |---------logforward
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----rt_daemon
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---dataAccess
   |-----managers
   |-------aaaClient
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-------commandSets
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------inboundProtocols
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------maxSessionsData
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------shellProfile
   |---------src
   |-----------Debug
   |---------test
   |-----service
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |---dbBackup
   |-----src
   |-------Debug
   |---events
   |-----chapEvent
   |-------src
   |---------Debug
   |-----dynamicAuthorizationEvent
   |-------src
   |---------Debug
   |-----eapEvent
   |-------src
   |---------Debug
   |-----getPasswordPromptEvent
   |-------src
   |---------Debug
   |-----mbSendEvent
   |-------src
   |---------Debug
   |-----messageBusConnectedEvent
   |-------src
   |---------Debug
   |-----messageBusEvent
   |-------src
   |---------Debug
   |-----mschapEvents
   |-------src
   |---------Debug
   |-----plainChangePasswordEvent
   |-------src
   |---------Debug
   |-----postureEvents
   |-------src
   |---------Debug
   |-------test
   |-----protocolUserFailedAttemptEvent
   |-------src
   |---------Debug
   |-----radiusPacketEvent
   |-------src
   |---------Debug
   |-----radiusRequestEvent
   |-------src
   |---------Debug
   |-----rawMessageBusEvent
   |-------src
   |---------Debug
   |-----rawPacketEvent
   |-------src
   |---------Debug
   |-----tacacsPacketEvent
   |-------src
   |---------Debug
   |---fips
   |-----keyZeroizationCLI
   |-------src
   |-------test
   |---flow
   |-----AAC
   |-------adminAuthenFlow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------adminAuthenRequestEvent
   |---------src
   |-----------Debug
   |-------adminPAPFlow
   |---------src
   |-----------Debug
   |---------test
   |-------flowTestUtility
   |---------src
   |---------test
   |-----changePassword
   |-------src
   |---------Debug
   |-------test
   |-----CoA
   |-------CTSConfigFlow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-------DynamicAuthorizationFlow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-----configNotification
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----eap
   |-------acsClientRepository
   |---------cts
   |-------clientRepository
   |---------contextDefaults
   |---------coreFlows
   |---------userCertificates
   |-------config
   |---------ctl
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----fakeAcctStop
   |-------src
   |---------Debug
   |-----loggingNotification
   |-------src
   |---------Debug
   |-------test
   |-----messageBus
   |-------src
   |---------Debug
   |-----pac
   |-------src
   |---------Debug
   |-----PKI
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----radius
   |-------dACLFlow
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------radiusAccountingFlow
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------radiusAuthenFlow
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------radiusCTSFlow
   |---------src
   |-----------Debug
   |-------radiusEapFlow
   |---------src
   |-----------Debug
   |-------radiusProxyFlow
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------radiusRequestFlow
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-----sessionCacheMgmt
   |-------src
   |---------Debug
   |-----statistics
   |-------src
   |---------Debug
   |-----tacacs
   |-------accounting
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------authentication
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------authorization
   |---------flowTestUtility
   |-----------src
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------main
   |---------src
   |-----------Debug
   |-------proxy
   |---------src
   |-----------Debug
   |---helpers
   |-----src
   |-------Debug
   |-----test
   |-------Debug
   |---idstores
   |-----activeDirectoryIDStore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----idstore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----idstoreManager
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----internalIDStore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----ldapIDStore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----ldapTest
   |-------src
   |-----radiusTokenIDStore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----rsaIDStore
   |-------config
   |-------src
   |---------Debug
   |-------test
   |-----samlStore
   |-------manual_tests
   |-------simulator
   |-------src
   |---------Debug
   |-------test
   |---------ccaxmls
   |---------Debug
   |-----sdFilesValidator
   |-------src
   |---------Debug
   |---infrastructure
   |-----aaaDebugLog
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----acsDebugLog
   |-------config
   |---------templatesForCLI
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----acsDebugLogConfig
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----attributeSet_old
   |-------src
   |-------test
   |-----avpairUtility
   |-------src
   |---------Debug
   |-------test
   |-----carsCryptoAgent
   |-------src
   |---------Debug
   |-----configManager
   |-------config
   |---------obsolete
   |---------temp1
   |-------src
   |---------Debug
   |---------obsolete
   |-------test
   |---------Debug
   |---------integration
   |---------obsolete
   |-----cppUnitSupport
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----cryptoLib
   |-------src
   |---------Debug
   |---------LabStub
   |---------TestCryptoLib
   |-------test
   |---------cert
   |-----------aatlas
   |-----------client
   |-----------crl
   |-----------CSCsr51040
   |-----------CSCsr97808
   |-----------CSCta73912
   |-----------ctl
   |-----------gen
   |-----------others
   |-----------pvk
   |-----------server
   |-----------serverCA
   |---------Debug
   |-----cryptoService
   |-------config
   |-------obsolete
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----dbPasswordLib
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----dbTools
   |-------src
   |---------Debug
   |-----dictionary3
   |-------config
   |-------src
   |---------Debug
   |-------target
   |---------generated
   |-----------src
   |-------------META-INF
   |-------test
   |---------Debug
   |-----eventHandler2
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----eventHandlerTester
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----exception
   |-------src
   |---------Debug
   |-----infoModel
   |-------src
   |---------Debug
   |-------target
   |---------generated
   |-----------META-INF
   |-----------src
   |-----------xsd
   |-------test
   |---------Debug
   |-----logging
   |-------config
   |-------obsolete
   |-------obsolete_test
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----messageCatalog
   |-------src
   |---------Debug
   |-------target
   |---------generated
   |-----------src
   |-------------META-INF
   |-------test
   |---------Debug
   |-----network
   |-------src
   |---------Debug
   |-----notificationCenter
   |-------src
   |---------Debug
   |-------test
   |-----pyut
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----ruleEngine5
   |-------config
   |-------src
   |---------Debug
   |-------test
   |-----sslAcsc
   |-------src
   |-----stateManager
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----stateSerialization
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----statistics
   |-------src
   |---------Debug
   |-------test
   |-----utility
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |-----xmlConfig
   |-------src
   |---------Debug
   |---install
   |-----target
   |-------runtime
   |---------adagent
   |-----------bin
   |-----------etc
   |-----------lib
   |-------------kerberos
   |---------bin
   |---------config
   |-----------logforward
   |---------lib
   |---prebuilt
   |-----3rdpartySources
   |-------curl
   |-----lnx24
   |-------include
   |---------ace
   |---------log4cxx
   |-----------config
   |-----------db
   |-----------helpers
   |-----------net
   |-----------nt
   |-----------spi
   |-----------varia
   |-----------xml
   |-------lib
   |-----lnx26
   |-------bin
   |-------etc
   |-------include
   |---------ace
   |-----------os_include
   |-------------arpa
   |-------------net
   |-------------netinet
   |-------------sys
   |-----------QoS
   |-----------SSL
   |---------activemq
   |-----------concurrent
   |-----------connector
   |-------------openwire
   |---------------commands
   |---------------marshal
   |-----------------v2
   |---------------utils
   |-----------core
   |-----------exceptions
   |-----------io
   |-----------logger
   |-----------network
   |-----------support
   |-----------transport
   |-------------filters
   |-----------util
   |-----------wireformat
   |---------activemq-cpp
   |-----------activemq
   |-------------concurrent
   |-------------connector
   |---------------openwire
   |-----------------commands
   |-----------------marshal
   |-------------------v2
   |-----------------utils
   |---------------stomp
   |-------------core
   |-------------exceptions
   |-------------io
   |-------------logger
   |-------------network
   |-------------support
   |-------------transport
   |-------------util
   |-------------wireformat
   |-----------cms
   |---------adagent
   |---------adagent_capi
   |---------cms
   |---------cppunit
   |-----------config
   |-----------extensions
   |-----------plugin
   |-----------portability
   |-----------tools
   |-----------ui
   |-------------mfc
   |-------------qt
   |-------------text
   |---------curl
   |---------ldap
   |---------libevent
   |---------log4cxx
   |-----------config
   |-----------db
   |-----------helpers
   |-----------net
   |-----------nt
   |-----------spi
   |-----------varia
   |-----------xml
   |---------openssl
   |-----------obsolete
   |---------otlv4_h
   |---------rsa
   |---------sqlanywhere10.old
   |---------sqlanywhere11
   |---------xalanc
   |-----------DOMSupport
   |-----------Harness
   |-----------Include
   |-----------PlatformSupport
   |-----------XalanDOM
   |-----------XalanEXSLT
   |-----------XalanExtensions
   |-----------XalanSourceTree
   |-----------XalanTransformer
   |-----------XercesParserLiaison
   |-------------Deprecated
   |-----------XMLSupport
   |-----------XPath
   |-----------XPathCAPI
   |-----------XSLT
   |---------xercesc
   |-----------dom
   |-------------deprecated
   |-------------impl
   |-----------framework
   |-------------psvi
   |-----------internal
   |-----------parsers
   |-----------sax
   |-----------sax2
   |-----------util
   |-------------Compilers
   |-------------MsgLoaders
   |---------------InMemory
   |-------------NetAccessors
   |---------------Socket
   |-------------Platforms
   |---------------Linux
   |-------------regx
   |-------------Transcoders
   |---------------Iconv
   |-----------validators
   |-------------common
   |-------------datatype
   |-------------DTD
   |-------------schema
   |---------------identity
   |-------lib
   |---------adagent
   |-----------kerberos
   |-----sol8
   |-------include
   |---------ace
   |-----sol9
   |-------include
   |---------ace
   |-----win32
   |-------include
   |---------log4cxx
   |-----------config
   |-----------db
   |-----------helpers
   |-----------net
   |-----------nt
   |-----------spi
   |-----------varia
   |-----------xml
   |-------lib
   |---protocol
   |-----gamev2
   |-------src
   |---------Debug
   |---------faham
   |-------test
   |---------Debug
   |-----messageBus
   |-------src
   |---------Debug
   |-------test
   |-----radius
   |-------client
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------common
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-------server
   |---------config
   |---------src
   |-----------Debug
   |---------test
   |-----------Debug
   |-----rtControl
   |-------src
   |---------Debug
   |-------test
   |-----tacacs
   |-------config
   |-------src
   |---------Debug
   |-------test
   |---------Debug
   |---secureCLI
   |-----src
   |-------Debug
   |---target
   |-----dependency-maven-plugin-markers
   |---tools
   |-----rtcli
   |-----xmltools
   |-------src
   |---------Debug
   |-src
   |---site
   |-view
   |---3rdparty_tools
   |-----activemq
   |-----axis2
   |-------config
   |-------webpages
   |-----cabextract
   |-----cues
   |-------portletsCuesTaglib
   |-----esper
   |-----iportal
   |-------jars
   |-----jars
   |-----jre
   |-----liferay
   |-----monit
   |-----openssl
   |-----quartz
   |-----sybase
   |-------sqlanywhere10.old
   |-------sqlanywhere11
   |-----taglibs
   |-----ui_images
   |-----xde
   |-------jars
   |-----xDE
   |-----yui
   |---build
   |-----installer
   |-------bld_scripts
   |-------resources
   |---------filterres
   |-----jtest
   |-----src
   |-------site
   |---conf
   |-----logging
   |---modules
   |-----aggregator
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------aggregator
   |-------------------------event
   |-------------------------syslog
   |---------------------------cache
   |-----------resources
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------aggregator
   |-----------resources
   |-----businessdelegate
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------businessdelegate
   |-------------------------afc
   |-------------------------collectionfilters
   |-------------------------dataupgrade
   |-------------------------dbpurge
   |-------------------------incrbackup
   |-------------------------jobmgr
   |-------------------------logclient
   |-------------------------logstatus
   |-------------------------proactive
   |-------------------------remotedatabase
   |-------------------------reports
   |-------------------------searchConfig
   |-------------------------session
   |-------------------------systemadministration
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------businessdelegate
   |-------------------------dbpurge
   |-------------------------jobmgr
   |-------------------------proactive
   |-------------------------systemadministration
   |-----collection
   |-------collector
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------collector
   |---------------------------netflow
   |---------------------------syslog
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------collector
   |---------------------------syslog
   |-------------resources
   |-------collector-jni
   |---------src
   |-----------main
   |-------------native
   |-------decap
   |---------conf
   |---------Decap_core
   |-----------src
   |-------------config
   |-------------db
   |-------------filter
   |-------------forwarder
   |-------------main
   |-------------map
   |-------------misc
   |-------------processor
   |-------------receiver
   |---------Decap_file
   |-----------src
   |-------------db
   |---------Decap_libs
   |---------Decap_main
   |-----------src
   |-------------AcsDecapForwarder
   |-------------config
   |-------------forwarder
   |-------------main
   |---------Decap_netflow
   |-----------src
   |-------------config
   |-------------map
   |-------------netflow
   |-------------processor
   |-------------util
   |---------Decap_syslog
   |-----------src
   |-------------config
   |-------------processor
   |-------decap-java
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------decap
   |-------------resources
   |-----------test
   |-------------java
   |-------------resources
   |-------decap-jni
   |---------src
   |-----------main
   |-------------native
   |-------SAM
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------collector
   |---------------------------syslog
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------collector
   |---------------------------syslog
   |-------------resources
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------collector
   |-------------------------syslog
   |-----------resources
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------collector
   |-------------------------syslog
   |-----------resources
   |-----collectionfilters
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------collectionfilters
   |-------------------------beans
   |-----------resources
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------test
   |-------------------------collectionfilters
   |-----collector
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------collector
   |-------------------------collectorjob
   |-------------------------syslog
   |---------------------------cache
   |-----------resources
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------collector
   |-----------resources
   |-----common
   |-------acsnodesmgr
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------acsnodesmgr
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------acsnodesmgr
   |-------afc
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-------------------------afc
   |-------dbpurge
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------dbpurge
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------dbpurge
   |-------events
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------events
   |-----------------------------parser
   |-----------------------------util
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------events
   |-------------resources
   |-------incrbackup
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------incrbackup
   |-------jobmgr
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-------------------------jobmgr
   |-----------test
   |-------------java
   |---------------com
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-------------------------jobmgr
   |-------------resources
   |-------logrecovery
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------logrecovery
   |-------logstatus
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------logstatus
   |-------mail
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------mail
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------mail
   |-------messaging
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------messaging
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------messaging
   |-------platform
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------platform
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------platform
   |-------remotedatabase
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------remotedatabase
   |-------reports
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-------------------------reports
   |-------searchConfig
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------searchConfig
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------common
   |---------------------------searchConfig
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-------------------------log
   |-------------------------util
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------common
   |-----database
   |-------afc
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------afc
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------afc
   |-------dbstart
   |-------dbstop
   |-------sql
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------dbms
   |-------------------------beans
   |---------------------------validate
   |-------------------------generic
   |-------------------------impl
   |-------------------------intf
   |-----------resources
   |-------------generic
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------dbms
   |-----dataupgrade
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------dataupgrade
   |-----inmemory
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------inmemory
   |-----logclient
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------logclient
   |-----logserver
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------logserver
   |-----------webapp
   |-------------WEB-INF
   |-----pi
   |-------client
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------pi
   |---------------------------client
   |-------schema
   |---------src
   |-----------main
   |-------------java
   |-------------wsdl
   |-------server
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------pi
   |-------------webapp
   |---------------WEB-INF
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------pi
   |---------------------------server
   |-------------resources
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------pi
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------pi
   |-----portal
   |-------classes
   |-------ext-impl
   |---------src
   |-----------com
   |-------------ext
   |---------------portlet
   |-----------------reports
   |-------------------action
   |-------------------model
   |---------------------impl
   |-------------------service
   |---------------------base
   |---------------------http
   |---------------------impl
   |---------------------persistence
   |-------------liferay
   |---------------portal
   |-----------------service
   |-------------------impl
   |-----------------servlet
   |-------------------filters
   |---------------------secure
   |---------------------servlet
   |-----------------spring
   |-------------------context
   |-----------content
   |-----------META-INF
   |-------ext-lib
   |---------development
   |---------global
   |---------portal
   |-------ext-service
   |---------src
   |-----------com
   |-------------ext
   |---------------portlet
   |-----------------reports
   |-------------------model
   |-------------------service
   |---------------------persistence
   |-------ext-web
   |---------docroot
   |-----------html
   |-------------common
   |---------------themes
   |-------------js
   |---------------liferay
   |-------------portal
   |-------------portlet
   |---------------ext
   |-----------------reports
   |-------------taglib
   |---------------portlet
   |-----------------icon_options
   |-----------WEB-INF
   |-------lib
   |---------development
   |---------global
   |---------portal
   |-------modules
   |-------sql
   |---------create
   |---------create-minimal
   |---------geronimo
   |-----------derby
   |---------indexes
   |---------lportal
   |-----------seg0
   |---------portal
   |---------portal-minimal
   |---------sequences
   |---------update-4.2.0-4.3.0
   |---------update-4.3.0-4.3.1
   |---------update-4.3.1-4.3.2
   |---------update-4.3.2-4.3.3
   |---------update-4.3.3-4.3.4
   |---------update-4.3.6-4.4.0
   |---------update-4.4.0-5.0.0
   |---------update-5.0.1-5.1.0
   |---------update-5.1.1-5.1.2
   |-------tools
   |-----proactive
   |-------alerts
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------alerts
   |-----------------------------queries
   |-----------------------------transform
   |-----------------------------validation
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------alerts
   |-----------------------------queries
   |-------common
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------common
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------common
   |-------poller
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------poller
   |-------------resources
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------poller
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------proactive
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------proactive
   |-------stream
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------stream
   |-----------------------------listener
   |-----------------------------statement
   |-----------------------------util
   |-----------test
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acs
   |-----------------------view
   |-------------------------proactive
   |---------------------------stream
   |-----reactive
   |-------resources
   |---------xDEConfig
   |---------xDEFlows
   |---------xDEJavaFns
   |-----------src
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------reactive
   |-------------------------xfn
   |---------xDEPALs
   |-----------DBPALs
   |-------------Failed-Auth-View
   |-------------NAD-Config-ACS
   |-----------DevicePALs
   |-------------sharedSecret
   |-----------LDAPPALs
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------reactive
   |-------------------------inventory
   |-------------------------reporting
   |-------------------------sessionMgmt
   |-------------------------xdeClient
   |-----------resources
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------reactive
   |-----reports
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------reports
   |-----------webapp
   |-------------ajaxanywhere
   |-------------help
   |---------------wwhelp
   |-----------------wwhimpl
   |-------------------common
   |---------------------html
   |-------------images
   |-------------includes
   |-------------iportal
   |---------------activePortal
   |-----------------private
   |-------------------newrequest
   |-------------------query
   |-------------------skins
   |-----------------viewer
   |---------------birt
   |-----------------ajax
   |-------------------lib
   |---------------bizRD
   |-----------------pages
   |-------------------control
   |-------------------dialog
   |-------------------layout
   |---------------iv
   |-----------------ajax
   |-------------------core
   |-----------------images
   |-------------------toolbar
   |-----------------pages
   |-------------------control
   |-------------------dialog
   |-------------------layout
   |-----------------styles
   |---------------portlets
   |-------------repository
   |---------------home
   |---------------public
   |-------------resources
   |---------------BizRDRptTemplates
   |-------------standardReports
   |---------------AAA_Protocol
   |---------------Access_Service
   |---------------ACS_Instance
   |---------------Endpoint
   |---------------Failure_Reason
   |---------------Network_Device
   |---------------Session_Directory
   |---------------TrustSec
   |---------------User
   |-------------tooltip
   |-------------WEB-INF
   |---------------classes
   |-----------------resources
   |---------------lib
   |---------------platform
   |-----------------plugins
   |-------------------org.eclipse.birt.report.data.oda.jdbc_2.2.2.r22x_v20071206
   |---------------------drivers
   |-------------yui
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----session
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------session
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------session
   |-----systemadministration
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------systemadministration
   |-------------------------beans
   |---------test
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------systemadministration
   |-----ui
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------ui
   |-------------------------actions
   |---------------------------afc
   |---------------------------collectionfilters
   |---------------------------connectivitytest
   |---------------------------dashboard
   |---------------------------datapurge
   |---------------------------dataupgrade
   |---------------------------incrbackup
   |---------------------------logrecovery
   |---------------------------logstatus
   |---------------------------proactive
   |---------------------------processstatus
   |---------------------------remotedatabase
   |---------------------------reports
   |---------------------------scheduler
   |---------------------------session
   |---------------------------supportbundle
   |---------------------------xde
   |-----------------------------validation
   |-----------------------------workflowhelper
   |-------------------------exceptions
   |-------------------------forms
   |---------------------------afc
   |---------------------------collectionfilters
   |---------------------------connectivitytest
   |---------------------------dashboard
   |---------------------------datapurge
   |---------------------------dataupgrade
   |---------------------------incrbackup
   |---------------------------logrecovery
   |---------------------------logstatus
   |---------------------------proactive
   |---------------------------processstatus
   |---------------------------remotedatabase
   |---------------------------reports
   |---------------------------scheduler
   |---------------------------session
   |---------------------------supportbundle
   |---------------------------xde
   |-------------------------servlets
   |---------------------------reports
   |-------------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------ui
   |-------------------------resources
   |-----------webapp
   |-------------jQuery
   |-------------pages
   |---------------afc
   |---------------alerts
   |---------------collectionfilters
   |---------------connectivitytest
   |---------------dashboard
   |---------------datapurge
   |---------------dataupgrade
   |---------------incrbackup
   |---------------logrecovery
   |---------------logstatus
   |---------------proactive
   |-----------------search
   |-----------------triggers
   |---------------processstatus
   |---------------reactive
   |---------------remotedatabase
   |---------------reports
   |---------------scheduler
   |---------------session
   |---------------supportbundle
   |---------------tooltips
   |---------------utilities
   |---------------xde
   |-----------------intermediate
   |-----------------start
   |-------------reportInbox
   |-------------WEB-INF
   |---------------conf
   |-----view-portlets
   |-------src
   |---------main
   |-----------conf
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------portlets
   |-----------------------utils
   |-----------resources
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------portlets
   |-------------------------resources
   |-----------webapp
   |-------------jsp
   |-------------META-INF
   |-------------WEB-INF
   |-----xde2
   |-------archive
   |-------ui
   |---------src
   |-----------main
   |-------------java
   |---------------com
   |-----------------cisco
   |-------------------nm
   |---------------------acsview
   |-----------------------xde
   |-------------------------utils
   |-------------resources
   |-------------webapp
   |---------------pages
   |-----------------utils
   |---------------WEB-INF
   |-------workflows
   |---------PAL
   |-----------CustomInventoryProvider
   |-------------src
   |---------------main
   |-----------------java
   |-------------------com
   |---------------------cisco
   |-----------------------nm
   |-------------------------pal
   |---------------------------inventory
   |---------queries
   |-----------src
   |-------------main
   |---------------java
   |-----------------com
   |-------------------cisco
   |---------------------nm
   |-----------------------acs
   |-------------------------view
   |---------------------------xde
   |-----------------------------queries
   |-------------------------------databeans
   |-------------------------------datahandlers
   |---------------resources
   |---------------test
   |---------WorkflowsJavaFunctionsProject
   |-----------src
   |-------------main
   |---------------java
   |-----------------com
   |-------------------cisco
   |---------------------nm
   |-----------------------acs
   |-------------------------view
   |---------------------------xde
   |-----------------------------workflow
   |-------------------------------functions
   |---------------------------------acl
   |---------------------------------acs
   |---------------------------------ad
   |---------------------------------auth
   |---------------------------------config
   |---------------------------------cts
   |-----------------------------------device
   |-----------------------------------rbacl
   |-----------------------------------sxpip
   |-----------------------------------user
   |---------------------------------eapcertificates
   |---------------------------------failurecode
   |---------------------------------ldap
   |---------------------------------service
   |---------------------------------system
   |---------------resources
   |-----------------META-INF
   |---------WorkflowsProject
   |-----------AccessService
   |-----------ACL
   |-----------ACS
   |-----------AD
   |-----------AuthFailed
   |-----------AuthPassed
   |-------------ACL
   |-------------VLAN
   |-----------Constants
   |-----------CTS
   |-----------Defunct
   |-----------EAPCertificates
   |-----------ErrorHandling
   |-----------FailureCodeWorkflows
   |-----------InternalIdStore
   |-----------LDAP
   |-----------NAD
   |-------------7K
   |-----------PAL.xpa
   |-------------checkIfAAAAuthorizationNetworkConfigured
   |-------------checkIfAccessGroupCmdConfiguredOnInterface
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------xde
   |-------------------------pal
   |---------------------------getRADIUSSecretKeyFromSwitch
   |---------------------------getTACACSSecretKeyFromSwitch
   |---------------------------SNMPv2-MIB
   |-------------getIOSVersion
   |-------------getLocalSGTFromRunningConfig
   |-------------getPhysicalInterfaces
   |-------------getRADIUSHostsFromNAD
   |-------------getRADIUSSecretKey
   |-------------getRADIUSSecretKeyByHost
   |-------------getRADIUSServerDeadCriteriaTime
   |-------------getRunningConfig
   |-------------getShowCTSAuthorizationEntriesResult
   |-------------getShowCTSEnvironmentDataResultFrom6k
   |-------------getShowCTSEnvironmentDataResultFrom7k
   |-------------getShowCTSRoleBasedPolicyResponse
   |-------------getShowCTSRoleBasedSGTMapAllResult
   |-------------getShowCTSRoleBasedSGTMapResult
   |-------------getShowCTSSXPConnectionResult
   |-------------getShowIPAccessListResult
   |-------------getShowVLANResult
   |-------------getStandardConfig
   |-------------IF-MIB
   |-------------runConfigTerminal
   |-------------runSpecifiedCommand
   |-------------sendEnd
   |-------------SNMPv2-MIB
   |-----------Portlets
   |-----------Properties
   |-----------RADIUS
   |-----------Reports
   |-----------Syslog
   |-----------UI
   |-----------Utils
   |---platform
   |-----cars_cli
   |-----scripts
   |---test
   |-----alarm_junit
   |-----collector-test
   |-----c-syslog-simulator
   |-------src
   |-----java-syslog-simulator
   |-------src
   |---------main
   |-----------java
   |-------------com
   |---------------cisco
   |-----------------nm
   |-------------------acs
   |---------------------view
   |-----------------------syslog
   |-------------------------simulator
   |-----netflow_simulator
   |-------src
   |-----SchemaDiff
   |-------src
   |---------main
   |-----------java
   |---------test
   |-----------java
   |-----syslog_simulator

   first level
:'<,'>g/|-\w/y A
   |-db
   |-devutil
   |-install
   |-integration
   |-messagecatalog
   |-mgmt
   |-obsolete
   |-openSSL
   |-patches_5_2
   |-postbuild
   |-prebuild
   |-runtime
   |-src
   |-view

   first + second level
'<,'>g/|-\{1,3}\w/y A
   |-db
   |---sql
   |---src
   |---target
   |-devutil
   |-install
   |---cars
   |---openssh
   |---target
   |-integration
   |---aac
   |---core
   |---dbJNI
   |---dbTools
   |---logview
   |---pi
   |---pi-client
   |---postinteg
   |---runtime
   |-messagecatalog
   |---src
   |---target
   |-mgmt
   |---aac
   |---audit
   |---bl
   |---changepassword
   |---cli
   |---clients
   |---common
   |---configloader
   |---configrecovery
   |---db
   |---dbpassword
   |---dbsupport
   |---dbtools
   |---distributedmanagement
   |---dynamic-azn
   |---eapfast
   |---gui
   |---help
   |---im
   |---internalcli
   |---licensing
   |---logging
   |---messagebus
   |---migration
   |---performancemonitoring
   |---pi
   |---protocoluserfailedattempt
   |---replication
   |---rest
   |---server
   |---transferutils
   |-obsolete
   |---dbPassword
   |---mgmt
   |---runtime
   |---view
   |-openSSL
   |---libCrypto
   |---libSsl
   |---openssl
   |-patches_5_2
   |---5-2-0-21-1
   |-postbuild
   |---src
   |-prebuild
   |---aac
   |---acs-client
   |---acs-testng
   |---msgcat
   |---spring-config-validate
   |---util
   |-runtime
   |---3rdParty
   |---build
   |---businessLogic
   |---daemons
   |---dataAccess
   |---dbBackup
   |---events
   |---fips
   |---flow
   |---helpers
   |---idstores
   |---infrastructure
   |---install
   |---prebuilt
   |---protocol
   |---secureCLI
   |---target
   |---tools
   |-src
   |---site
   |-view
   |---3rdparty_tools
   |---build
   |---conf
   |---modules
   |---platform
   |---test

	---> CPR generation report
First, clean view

   |-db
generate report
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r -log ~/temp/fixcopyrightreport_db . >  ~/temp/fixcopyrightreport_db_out

run 
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$  /auto/cwtools/perl/clearcase/fixcopyright -c -s -r -log ~/temp/fixcopyright_db . >  ~/temp/fixcopyright_db_out
ok. so checking doesn't work so -c flag is useless.
Let's try to CO manually and then run, so:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r  . | grep '^Out-of-Date' | awk '{print $2}'
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/pom.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/build.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/populate-version.sh
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/postcreate.sql
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/identityGroup_data.sql
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/networkDeviceGroups_data.sql
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/internalIDStoreProcedures_data.sql
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/AccountSettings_data.sql

and CO
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$ co `/auto/cwtools/perl/clearcase/fixcopyright -p -r  . | grep '^Out-of-Date' | awk '{print $2}' `

Now run:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$  /auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_db . >  ~/temp/fixcopyright_db_out

Verify:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r  .
Warning: fixcopyright did not recognize the file type for /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/odbc.ini
skipping ......
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/pom.xml
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/build.xml
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/populate-version.sh
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/tacacsSettings_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/ctl_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/idStore_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/serviceForAac_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/denyAccess_data.sql
Warning: fixcopyright did not recognize the file type for /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/postcreateAac.sql.old
skipping ......
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/defaultCommandSet_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/set_password.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/attributeAlias_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/postcreateIndexes.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/cts_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/eapGlobalSettings_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/passwdPolicySettings_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/postureServer_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/identityDictionary_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/oemdboption.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/defaultResults_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/DeviceAdminTemplateServices_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/NetworkAccessTemplateServices_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/certificateAuthProfile_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/DefaultService_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/RSARealmPrompts_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/perf_check_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/maxSessionGlobalSettings_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/postcreate.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/identityGroup_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/networkDeviceGroups_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/internalIDStoreProcedures_data.sql
OK              /view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db/sql/AccountSettings_data.sql

Summary:
-------
OK,     Out-of-Date,    Missing ,Unknown
31,     0,              0,      0

[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$ ct_diff_act_graph yizaq_5_3_copyrights

ci all:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/db]$ ct_diff_act_txt yizaq_5_3_copyrights
Usage: ct_diff_act_txt <act>, ex: Phase2Bugs2 will search on vob @/vob/nmtgre_proj
Diff of file /vob/nm_acs/acs/db/build.xml
3c3
< <!-- Copyright (c) 2009, 2010, 2011 Cisco Systems, Inc.-->
---
> <!-- Copyright (c) 2009, 2010 Cisco Systems, Inc.-->
Diff of file /vob/nm_acs/acs/db/pom.xml
3c3
< <!-- Copyright (c) 2008, 2009, 2011 Cisco Systems, Inc.-->
---
> <!-- Copyright (c) 2008, 2009 Cisco Systems, Inc.-->
Diff of file /vob/nm_acs/acs/db/populate-version.sh
3c3
< # Copyright (c) 2008, 2009, 2011 Cisco Systems, Inc.
---
> # Copyright (c) 2008, 2009 Cisco Systems, Inc.
Diff of file /vob/nm_acs/acs/db/sql/AccountSettings_data.sql
2c2
< --- Copyright (c) 2009, 2011 Cisco Systems, Inc.
---
> --- Copyright (c) 2009 Cisco Systems, Inc.
Diff of file /vob/nm_acs/acs/db/sql/identityGroup_data.sql
2c2
< --- Copyright (c) 2009, 2011 Cisco Systems, Inc.
---
> --- Copyright (c) 2009 Cisco Systems, Inc.
Diff of file /vob/nm_acs/acs/db/sql/internalIDStoreProcedures_data.sql
2c2
< --- Copyright (c) 2009, 2011 Cisco Systems, Inc.
---
> --- Copyright (c) 2009 Cisco Systems, Inc.
Diff of file /vob/nm_acs/acs/db/sql/networkDeviceGroups_data.sql
2c2
< --- Copyright (c) 2009, 2011 Cisco Systems, Inc.
---
> --- Copyright (c) 2009 Cisco Systems, Inc.
Diff of file /vob/nm_acs/acs/db/sql/postcreate.sql
2c2
< --- Copyright (c) 2009, 2011 Cisco Systems, Inc.
---
> --- Copyright (c) 2009 Cisco Systems, Inc.

   |---sql
   |---src
   |---target
   |-devutil
   |-install
   |---cars
   |---openssh
   |---target

Let's try to CO manually and filter out openSSH files, so:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/install]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r . | grep -v 'openssh-5.3p1' | grep '^Out-of-Date' | awk '{print $2}'
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/install]$ co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . | grep -v 'openssh-5.3p1' | grep '^Out-of-Date' | awk '{print $2}')

Now run:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/install]$  /auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_cars . >  ~/temp/fixcopyright_cars_out

Verify:
[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/install]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r . | grep -v 'openssh-5.3p1' | grep '^Out-of-Date' 

[yizaq@yizaq-lnx:Thu Aug 25:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/install]$ for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -graph $f; done

   |-integration
   |---aac
   |---core
   |---dbJNI
   |---dbTools
   |---logview
   |---pi
   |---pi-client
   |---postinteg
   |---runtime
   |-messagecatalog

generate report:
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/pom.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/msg_cat.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/AcsDictionary.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/AdminAuditDictionary.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/TacacsDictionary.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/MessageBusDictionary.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/CertificateDictionary.xml
/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog/src/main/resources/pydict.xsl

CO:
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog]$co  $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}')

Run:
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_messagecatalog . >  ~/temp/fixcopyright_messagecatalog_out

Verify:
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog]$  /auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/messagecatalog]$ for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -graph $f; done

   |---src
   |---target
   |-mgmt
generate report:
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/mgmt]$ /auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'

CO:
[yizaq@yizaq-lnx:Sun Aug 28:/view/yizaq__yizaq_5_3_cpr_fix.int.acs5_0.lx/vob/nm_acs/acs/mgmt]$ co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}')

Run:
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_mgmt . >  ~/temp/fixcopyright_mgmt_out

Verify:
$  /auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
$ for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -graph $f; done

   |---aac
   |---audit
   |---bl
   |---changepassword
   |---cli
   |---clients
   |---common
   |---configloader
   |---configrecovery
   |---db
   |---dbpassword
   |---dbsupport
   |---dbtools
   |---distributedmanagement
   |---dynamic-azn
   |---eapfast
   |---gui
   |---help
   |---im
   |---internalcli
   |---licensing
   |---logging
   |---messagebus
   |---migration
   |---performancemonitoring
   |---pi
   |---protocoluserfailedattempt
   |---replication
   |---rest
   |---server
   |---transferutils
   |-obsolete
   |---dbPassword
   |---mgmt
   |---runtime
   |---view
   |-openSSL
   |---libCrypto
   |---libSsl
   |---openssl
   |-patches_5_2
   |---5-2-0-21-1
   |-postbuild

/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}')
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_postbuild . >  ~/temp/fixcopyright_postbuild_out
/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -graph $f; done

   |---src
   |-prebuild

/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}')
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_prebuild . >  ~/temp/fixcopyright_prebuild_out
/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | awk '{print $2}'
for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -graph $f; done

   |---aac
   |---acs-client
   |---acs-testng
   |---msgcat
   |---spring-config-validate
   |---util
   |-runtime
Manually exclude prebuilt dir

/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v prebuilt | awk '{print $2}'
co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v prebuilt | awk '{print $2}')
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_runtime . >  ~/temp/fixcopyright_runtime_out
/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v prebuilt | awk '{print $2}'
for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -diff $f; done

   |---3rdParty
   |---build
   |---businessLogic
   |---daemons
   |---dataAccess
   |---dbBackup
   |---events
   |---fips
   |---flow
   |---helpers
   |---idstores
   |---infrastructure
   |---install
   |---prebuilt
   |---protocol
   |---secureCLI
   |---target
   |---tools
   |-src
   |---site
   |-view
   
Manually exclude 3rdparty_toolsdir

/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v 3rdparty_toolsdir | awk '{print $2}'
co $(/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v 3rdparty_toolsdir | awk '{print $2}')
/auto/cwtools/perl/clearcase/fixcopyright  -s -r -log ~/temp/fixcopyright_view . >  ~/temp/fixcopyright_view_out
/auto/cwtools/perl/clearcase/fixcopyright -p -r . |grep '^Out-of-Date' | grep -v 3rdparty_toolsdir | awk '{print $2}'
for f in  $(ct lsco -recurse -me | grep yizaq_5_3_cpr_fix.int.acs5_0 | awk '{print }' | sed -e 's_"__g'  | awk '{print  $5}') ; do cleartool diff -pred -diff $f; done

   |---3rdparty_tools
   |---build
   |---conf
   |---modules
   |---platform
   |---test


	---> BOR build error:
[INFO] mkdir -p RPM/SRPMS
[INFO] cp CARSOpenSSH-1.2cars.tar.gz RPM/BUILD
[INFO] cp CARSOpenSSH-1.2cars.tar.gz RPM/SOURCES
[INFO] rpmbuild -ba --clean CARSOpenSSH.spec
[INFO] error: line 9: Unknown tag: Copyright (c) 2007, 2011 Cisco Systems, Inc.
[INFO] make: *** [rpm] Error 1
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Result of /usr/bin/make rpm execution is: '2'.
[INFO] ------------------------------------------------------------------------

SRM case Incident Number is INC000019975433 (ARNOTE 700053)

	----> Solution
Thank you Vlasta!

Yaniv, I shall proceed to deliver.

Thanks,
Yosi

From: Vlasta Platonov -X (vplatono - mindU at Cisco) 
Sent: Monday, August 29, 2011 2:56 PM
To: Yaniv Azoulay (yazoulay); Yosi Izaq (yizaq)
Subject: RE: 5.3 copyrights

Hi Yosi, 

Seems CARSOpenSSH.spec missed a colon, I’ve added a colon and reran the build.


 <10259>ct diff -diff -pre CARSOpenSSH.spec
9c9
< Copyright (c) 2007, 2011 Cisco Systems, Inc.
---
> Copyright: (c) 2007, 2011 Cisco Systems, Inc.

Thanks, 
Vlasta.

From: Yaniv Azoulay (yazoulay) 
Sent: Monday, August 29, 2011 11:47 AM
To: Yosi Izaq (yizaq); Vlasta Platonov -X (vplatono - mindU at Cisco)
Subject: RE: 5.3 copyrights

Hi Vlasta,

Yosi is on PTO today, so I don’t know about the status of this case – do you have any update?

Thanks,
Yaniv.

From: Yosi Izaq (yizaq) 
Sent: Sunday, August 28, 2011 9:56 PM
To: Yaniv Azoulay (yazoulay)
Subject: 5.3 copyrights

Hi Yaniv,

I finished the copyrights on my stream and it compiles and builds well.
Alas, I double checked BoR (just to be safe) and it seems like BoR (& Hudson) fails to build 

I opened a case but I’m blocked from delivering until I fix the issue on BoR with Vlasta.

Thx,
Yosi


	2.7
3. Testing

	3.1 Automation

		3.1.1 AoD

			3.1.1.1 Dirty trick to open AD debug logs
a. Start run
b. After install is complete login to server:

| 10.56.61.33
root
acsFive0
c. open RT debug logs
d. make sure not to run many tests or the machine would crash

			3.1.1.2 Deal with stuck AoD
SSH 10.56.62.91 [administrator/acS100%]
ssh administrator@10.56.62.91

Then  cd  /usr/local/tomcat/bin

./shutdown.sh
./startup.sh

Please be careful in doing so  while they are other jobs 

			3.1.1.3
		3.1.2

	3.2 Pez

		3.2.1 URL
http://aaat-dev/trac/aaat

		3.2.2 Usage

			3.2.2.1 PEAP

				3.2.2.1.1 Configuration
{
    "eap_fast" :
    {
        "unauth_ciphers" :
        [
            'TLS_DH_anon_WITH_AES_128_CBC_SHA'
        ],
        "tunnel_pac_file_name" : '.\\run_env\\tunnel-tlsuser<ind 0 10000>.pac',
        "auth_ciphers" :
        [
            'TLS_DHE_RSA_WITH_AES_128_CBC_SHA',
            'TLS_RSA_WITH_RC4_128_SHA'
        ],
        "use_tunnel_pac" : True,
        "request_tunnel_pac" : False,
        "authenticate_server" : True,
        "use_machine_pac" : False,
        "request_authorization_pac" : False,
        "machine_pac_file_name" : '.\\run_env\\machine-tlsuser<ind 0 10000>.pac',
        "request_machine_pac" : False,
        "tls_fragment_length" : 2048,
        "version" : 1,
        "configured_types" :
        [
            'EAP-MS-CHAP-V2'
        ],
        "use_authorization_pac" : False,
        "authorization_pac_file_name" : '.\\run_env\\authorization-tlsuser<ind 0 10000>.pac'
    },
    "eap_md5" :
    {
        "password" : 'tlsuser<ind 0 10000>'
    },
    "hooks" :
    [
        'rad_hook.py',
        'eap_gtc_hook.py',
        'eap_tls_hook.py',
        'eap_tls_data_hook.py',
        'eap_hook.py',
        'rad_stress_reporter.py',
        'eap_mschapv2_hook.py'
    ],
    "peap" :
    {
        "version" : 0,
        "configured_types" :
        [
            'EAP-MS-CHAP-V2'
        ],
        "tls_fragment_length" : 2048
    },
    "applications" :
    {
        "configured" : 'EAP',
        "implemented" :
        [
            'EAP',
            'PAP',
            'RADIUS CoA',
            'RADIUS Accounting',
            'RADIUS Server'
        ]
    },
    "radius" :
    {
        "retries" : 3,
        "dictionaries" :
        [
            './dictionaries'
        ],
        "host" : 'yizaq-lnx',
        "secret" : 'acsi',
        "timeout" : 5,
        "attributes" :
        {
            "User-Password" :
            [
                'rree12#$'
            ],
            "NAS-IP-Address" :
            [
                '1.1.1.1'
            ],
            "User-Name" :
            [
                'yosi_i_test1'
            ],
            "Message-Authenticator" :
            [
                'Message'
            ],
            "VSA" :
            {
                "Cisco" :
                {
                    "Cisco-AVPair" :
                    [
                        'name=value'
                    ]
                }
            },
            "Session-Timeout" :
            [
                90
            ],
            "Calling-Station-Id" :
            [
                '1.2.3.4'
            ]
        },
        "port" : 1812
    },
    "radius_server" :
    {
        "attributes" :
        {
            "NAS-IP-Address" :
            [
                '1.1.1.1'
            ],
            "VSA" :
            {
                "Cisco" :
                {
                    "Cisco-AVPair" :
                    [
                        'attribute=returned_by_server'
                    ]
                }
            }
        },
        "host" : '',
        "handlers" :
        [
            {
                "name" : 'CoA Server',
                "module" : 'coa_server.py'
            }
        ],
        "secret" : 'cisco123',
        "port" : 3799
    },
    "eap" :
    {
        "implemented_types" :
        [
            'EAP-MD5',
            'LEAP',
            'EAP-TLS',
            'PEAP',
            'EAP-FAST'
        ],
        "identity" : 'tlsuser<ind 0 10000>',
        "configured_types" :
        [
            'PEAP'
        ],
        "inner_identity" : 'tlsuser<ind 0 10000>'
    },
    "eap_tls" :
    {
        "reuse_session" : False,
        "user_key" : 'giora0.pvk',
        "user_cert" : 'giora0.cer',
        "ca_cert" : 'ca.cer',
        "tls_fragment_length" : 1002
    },
    "stress" :
    {
        "repeat" : 1,
        "num_tasks" : 1,
        "num_clients" : 1
    },
    "logging" :
    {
        "hooks" :
        [
            './log_hooks'
        ],
        "onoff" : 'on',
        "file" : 'stdout',
        "level" : 'Debug'
    },
    "leap" :
    {
        "username" : 'tlsuser<ind 0 10000>',
        "password" : 'tlsuser<ind 0 10000>'
    },
    "eap_ms_chapv2" :
    {
        "new_password" : '',
        "password" : 'rree12#$',
        "name" : 'yosi_i_test1'
    },
    "eap_gtc" :
    {
        "Change Password: " : '56789',
        "python regex 4" : 'response',
        "python regex 1" : 'response',
        "python regex 3" : 'response',
        "python regex 2" : 'response',
        "^CHALLENGE=Password:.*$" : 'RESPONSE=tlsuser<ind 0 10000>',
        "^Password:.*$" : 'tlsuser<ind 0 10000>'
    }
}


				3.2.2.1.1  Logs
---------- Begin run ---------
INFO:reactor:starting reactor
INFO:eap:starting EAP conversation
INFO:eap:about to compose EAP identity message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 181
DEBUG:eap:EAP type: 1
DEBUG:eap:EAP identity length: 13
DEBUG:eap:74 6c 73 75 73 65 72 30                            tlsuser0
INFO:eap:about to send EAP identity message
DEBUG:eap:02 b5 00 0d 01 74 6c 73 75 73 65 72 30             .....tlsuser0
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 1
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02\xb5\x00\r\x01tlsuser0']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 01 00 75 0d 26 a0 6c c8 8c bc ca 74 e0 ab 55    ...u.&.l....t..U
DEBUG:radius:d5 c6 4d 9b 02 12 18 3a 42 60 b3 0a 3e d9 a5 c5    ..M....:B`..>...
DEBUG:radius:a7 f8 86 1d 38 bf 04 06 01 01 01 01 01 0e 79 6f    ....8.........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 1b 06 00 00    ..name=value....
DEBUG:radius:00 5a 4f 0f 02 b5 00 0d 01 74 6c 73 75 73 65 72    .ZO......tlsuser
DEBUG:radius:30 1f 02 50 12 4b 79 98 c2 23 22 56 9b 7f 92 30    0..P.Ky..#"V...0
DEBUG:radius:71 51 bf 9a c5                                     qQ...
INFO:radius:received RADIUS message
DEBUG:radius:0b 01 00 53 f7 d6 8d 9f c2 4b d3 77 7d 0d e0 be    ...S.....K.w}...
DEBUG:radius:e5 1d b2 8b 18 25 33 32 53 65 73 73 69 6f 6e 49    .....%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 08 01 74 00 06 0d    4319/209;O..t...
DEBUG:radius:20 50 12 a5 78 84 4e dc 97 4c ba 5c 89 84 5f 76     P..x.N..L.\.._v
DEBUG:radius:4d 37 c8                                           M7.
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 1
DEBUG:radius:RADIUS message length: 83
DEBUG:radius:RADIUS authenticator: f7 d6 8d 9f c2 4b d3 77 7d 0d e0 be e5 1d b2 8b    .....K.w}.......
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 74 00 06 0d 20                                  .t... 
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        a5 78 84 4e dc 97 4c ba 5c 89 84 5f 76 4d 37 c8    .x.N..L.\.._vM7.
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 74 00 06 0d 20                                  .t... 
INFO:eap:parsed incoming EAP message
INFO:eap:about to compose EAP nak message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 116
DEBUG:eap:EAP type: 3
DEBUG:eap:EAP types ['0x19']
DEBUG:eap:EAP nak response length: 6
INFO:eap:about to send EAP nak message
DEBUG:eap:02 74 00 06 03 19                                  .t....
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 2
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02t\x00\x06\x03\x19']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 02 00 93 7d 73 44 47 46 67 d4 cd 3a ca e8 a7    ....}sDGFg..:...
DEBUG:radius:0d 35 7e 03 02 12 41 87 21 d1 18 e5 1a fa 71 d5    .5~...A.!.....q.
DEBUG:radius:de f9 d4 f6 f6 25 04 06 01 01 01 01 01 0e 79 6f    .....%........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 08 02 74 00 06 03 19 1f    ;.....ZO..t.....
DEBUG:radius:02 50 12 77 43 04 da eb e1 dc c7 dd 78 1e 07 da    .P.wC.......x...
DEBUG:radius:ff 33 d2                                           .3.
INFO:radius:received RADIUS message
DEBUG:radius:0b 02 00 53 2d 46 70 1e 2c f2 d8 f7 4f 8a bf 89    ...S-Fp.,...O...
DEBUG:radius:3a f2 a6 c4 18 25 33 32 53 65 73 73 69 6f 6e 49    :....%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 08 01 75 00 06 19    4319/209;O..u...
DEBUG:radius:21 50 12 31 c7 6c e7 08 cd 7e 05 f1 53 49 da 69    !P.1.l...~..SI.i
DEBUG:radius:b0 5b d6                                           .[.
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 2
DEBUG:radius:RADIUS message length: 83
DEBUG:radius:RADIUS authenticator: 2d 46 70 1e 2c f2 d8 f7 4f 8a bf 89 3a f2 a6 c4    -Fp.,...O...:...
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 75 00 06 19 21                                  .u...!
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        31 c7 6c e7 08 cd 7e 05 f1 53 49 da 69 b0 5b d6    1.l...~..SI.i.[.
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 75 00 06 19 21                                  .u...!
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:received TLS handshake message
INFO:tls:about to send TLS handshake message
DEBUG:tls:16 03 01 00 61 01 00 00 5d 03 01 4d 3e e3 31 9c    ....a...]..M>.1.
DEBUG:tls:87 19 36 09 c9 a3 df 3e 52 1a 08 38 54 6c a5 cf    ..6....>R..8Tl..
DEBUG:tls:f8 81 bd dd 6f 3a 8e b0 a9 d0 77 00 00 36 00 33    ....o:....w..6.3
DEBUG:tls:00 05 00 34 00 3a 00 39 00 38 00 35 00 32 00 2f    ...4.:.9.8.5.2./
DEBUG:tls:00 16 00 15 00 14 00 13 00 12 00 11 00 0a 00 09    ................
DEBUG:tls:00 08 00 07 00 06 00 04 00 03 00 1b 00 1a 00 19    ................
DEBUG:tls:00 18 00 17 01 00                                  ......
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 102
DEBUG:eap_tls_data:16 03 01 00 61 01 00 00 5d 03 01 4d 3e e3 31 9c    ....a...]..M>.1.
DEBUG:eap_tls_data:87 19 36 09 c9 a3 df 3e 52 1a 08 38 54 6c a5 cf    ..6....>R..8Tl..
DEBUG:eap_tls_data:f8 81 bd dd 6f 3a 8e b0 a9 d0 77 00 00 36 00 33    ....o:....w..6.3
DEBUG:eap_tls_data:00 05 00 34 00 3a 00 39 00 38 00 35 00 32 00 2f    ...4.:.9.8.5.2./
DEBUG:eap_tls_data:00 16 00 15 00 14 00 13 00 12 00 11 00 0a 00 09    ................
DEBUG:eap_tls_data:00 08 00 07 00 06 00 04 00 03 00 1b 00 1a 00 19    ................
DEBUG:eap_tls_data:00 18 00 17 01 00                                  ......
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 117
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 112
DEBUG:eap:80 00 00 00 66 16 03 01 00 61 01 00 00 5d 03 01    ....f....a...]..
DEBUG:eap:4d 3e e3 31 9c 87 19 36 09 c9 a3 df 3e 52 1a 08    M>.1...6....>R..
DEBUG:eap:38 54 6c a5 cf f8 81 bd dd 6f 3a 8e b0 a9 d0 77    8Tl......o:....w
DEBUG:eap:00 00 36 00 33 00 05 00 34 00 3a 00 39 00 38 00    ..6.3...4.:.9.8.
DEBUG:eap:35 00 32 00 2f 00 16 00 15 00 14 00 13 00 12 00    5.2./...........
DEBUG:eap:11 00 0a 00 09 00 08 00 07 00 06 00 04 00 03 00    ................
DEBUG:eap:1b 00 1a 00 19 00 18 00 17 01 00                   ...........
INFO:eap:about to send EAP message
DEBUG:eap:02 75 00 70 19 80 00 00 00 66 16 03 01 00 61 01    .u.p.....f....a.
DEBUG:eap:00 00 5d 03 01 4d 3e e3 31 9c 87 19 36 09 c9 a3    ..]..M>.1...6...
DEBUG:eap:df 3e 52 1a 08 38 54 6c a5 cf f8 81 bd dd 6f 3a    .>R..8Tl......o:
DEBUG:eap:8e b0 a9 d0 77 00 00 36 00 33 00 05 00 34 00 3a    ....w..6.3...4.:
DEBUG:eap:00 39 00 38 00 35 00 32 00 2f 00 16 00 15 00 14    .9.8.5.2./......
DEBUG:eap:00 13 00 12 00 11 00 0a 00 09 00 08 00 07 00 06    ................
DEBUG:eap:00 04 00 03 00 1b 00 1a 00 19 00 18 00 17 01 00    ................
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 3
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02u\x00p\x19\x80\x00\x00\x00f\x16\x03\x01\x00a\x01\x00\x00]\x03\x01M>\xe31\x9c\x87\x196\t\xc9\xa3\xdf>R\x1a\x088Tl\xa5\xcf\xf8\x81\xbd\xddo:\x8e\xb0\xa9\xd0w\x00\x006\x003\x00\x05\x004\x00:\x009\x008\x005\x002\x00/\x00\x16\x00\x15\x00\x14\x00\x13\x00\x12\x00\x11\x00\n\x00\t\x00\x08\x00\x07\x00\x06\x00\x04\x00\x03\x00\x1b\x00\x1a\x00\x19\x00\x18\x00\x17\x01\x00']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 03 00 fd 23 46 3d 9f 2c 8b 7a f1 67 0e b2 e2    ....#F=.,.z.g...
DEBUG:radius:9f 70 cc 8d 02 12 52 1e 32 e7 90 14 d7 4b 99 a7    .p....R.2....K..
DEBUG:radius:0c c4 ec 1c 9c dd 04 06 01 01 01 01 01 0e 79 6f    ..............yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 72 02 75 00 70 19 80 00    ;.....ZOr.u.p...
DEBUG:radius:00 00 66 16 03 01 00 61 01 00 00 5d 03 01 4d 3e    ..f....a...]..M>
DEBUG:radius:e3 31 9c 87 19 36 09 c9 a3 df 3e 52 1a 08 38 54    .1...6....>R..8T
DEBUG:radius:6c a5 cf f8 81 bd dd 6f 3a 8e b0 a9 d0 77 00 00    l......o:....w..
DEBUG:radius:36 00 33 00 05 00 34 00 3a 00 39 00 38 00 35 00    6.3...4.:.9.8.5.
DEBUG:radius:32 00 2f 00 16 00 15 00 14 00 13 00 12 00 11 00    2./.............
DEBUG:radius:0a 00 09 00 08 00 07 00 06 00 04 00 03 00 1b 00    ................
DEBUG:radius:1a 00 19 00 18 00 17 01 00 1f 02 50 12 c1 58 94    ...........P..X.
DEBUG:radius:64 ad 37 91 2f c1 06 71 c2 32 69 aa a2             d.7./..q.2i..
INFO:radius:received RADIUS message
DEBUG:radius:0b 03 02 aa fc a7 64 5e 83 80 9e e1 8e 3b fe 80    ......d^.....;..
DEBUG:radius:71 16 95 3d 18 25 33 32 53 65 73 73 69 6f 6e 49    q..=.%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f ff 01 76 02 59 19    4319/209;O..v.Y.
DEBUG:radius:00 16 03 01 00 4a 02 00 00 46 03 01 4d 3e e2 2f    .....J...F..M>./
DEBUG:radius:32 86 c7 dc 82 13 6d 46 29 20 45 dd e1 aa f0 01    2.....mF) E.....
DEBUG:radius:b8 f6 e4 0a 78 21 25 fa a4 8a 5d bc 20 0c ce 43    ....x!%...]. ..C
DEBUG:radius:23 a8 5d c0 1b 2d fe ee 0e 29 ce 6f d7 42 fc 65    #.]..-...).o.B.e
DEBUG:radius:4d a8 d3 ae 4a be 2a 80 bf 43 8e 56 0c 00 35 00    M...J.*..C.V..5.
DEBUG:radius:16 03 01 01 f6 0b 00 01 f2 00 01 ef 00 01 ec 30    ...............0
DEBUG:radius:82 01 e8 30 82 01 51 a0 03 02 01 02 02 05 00 93    ...0..Q.........
DEBUG:radius:52 91 a3 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05    R..0...*.H......
DEBUG:radius:05 00 30 38 31 10 30 0e 06 03 55 04 0a 13 07 55    ..081.0...U....U
DEBUG:radius:6e 6b 6e 6f 77 6e 31 10 30 0e 06 03 55 04 0b 13    nknown1.0...U...
DEBUG:radius:07 55 6e 6b 6e 6f 77 6e 31 12 30 10 06 03 55 04    .Unknown1.0...U.
DEBUG:radius:03 13 09 79 69 7a 61 71 2d 6c 6e 78 30 1e 17 0d    ...yizaq-lnx0...
DEBUG:radius:31 31 30 31 32 34 30 39 35 32 30 31 5a 17 0d 31    110124095201Z..1
DEBUG:radius:31 30 34 32 34 30 39 35 32 30 31 5a 30 38 31 10    10424095201Z081.
DEBUG:radius:30 0e 06 03 55 04 0a 13 07 55 6e 6b 6e 6f 77 6e    0...U....Unknown
DEBUG:radius:31 10 30 0e 06 03 55 04 4f ff 0b 13 07 55 6e 6b    1.0...U.O....Unk
DEBUG:radius:6e 6f 77 6e 31 12 30 10 06 03 55 04 03 13 09 79    nown1.0...U....y
DEBUG:radius:69 7a 61 71 2d 6c 6e 78 30 81 9f 30 0d 06 09 2a    izaq-lnx0..0...*
DEBUG:radius:86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81    .H............0.
DEBUG:radius:89 02 81 81 00 99 40 ea 97 f2 ad 1a c7 9e 12 1e    ......@.........
DEBUG:radius:ce 37 26 fe 02 c9 22 82 fd 35 33 c6 6a 0c ce 3f    .7&..."..53.j..?
DEBUG:radius:e5 cf ba 8b a7 bc f8 14 ef 7a 7d d9 68 a2 0e f8    .........z}.h...
DEBUG:radius:19 96 5a 7b d9 f0 61 0a cb b5 e2 e5 64 eb 9a ac    ..Z{..a.....d...
DEBUG:radius:97 fa 59 bd be d8 39 b1 c9 20 27 2a 17 e9 1a 23    ..Y...9.. '*...#
DEBUG:radius:de b6 5c 21 51 fd 3b 04 53 d1 1b 3e 0d 77 8e 53    ..\!Q.;.S..>.w.S
DEBUG:radius:dc 2f 2a 39 84 04 9f 50 2c 00 a6 4c 25 8e 1a ec    ./*9...P,..L%...
DEBUG:radius:3a 9c e3 72 f8 f7 80 2c df 03 7a 74 6e cf b2 2e    :..r...,..ztn...
DEBUG:radius:8e aa a2 86 a9 02 03 01 00 01 30 0d 06 09 2a 86    ..........0...*.
DEBUG:radius:48 86 f7 0d 01 01 05 05 00 03 81 81 00 68 dc 37    H............h.7
DEBUG:radius:9c b7 ae 81 c8 15 19 1f b9 aa b5 84 0d 0e 54 f3    ..............T.
DEBUG:radius:d5 c3 2d d8 0b 16 34 32 91 b8 39 96 c1 c4 63 49    ..-...42..9...cI
DEBUG:radius:ab 79 d5 5f fc 84 06 4f 61 55 52 43 ff f9 fb 2d    .y._...OaURC...-
DEBUG:radius:b6 0a 58 23 18 e4 b1 1f ea 38 05 80 12 2a c5 04    ..X#.....8...*..
DEBUG:radius:9a 55 b5 c6 d4 a7 78 1f ff 75 47 9d f5 ea 0e 9a    .U....x..uG.....
DEBUG:radius:5e 53 f8 99 5c fb 00 af cf f0 0d 46 85 e9 ae 9a    ^S..\......F....
DEBUG:radius:d2 ef 04 e2 a7 54 dd bc b3 7a 95 09 b2 d8 2b 58    .....T...z....+X
DEBUG:radius:10 11 da 1a 51 9c df 14 b0 00 fe ad 8f aa 0a 16    ....Q...........
DEBUG:radius:03 01 00 04 0e 00 00 00 50 12 17 30 cd 7f fd 0c    ........P..0....
DEBUG:radius:51 75 e5 8e 36 90 e9 e3 03 d9                      Qu..6.....
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 3
DEBUG:radius:RADIUS message length: 682
DEBUG:radius:RADIUS authenticator: fc a7 64 5e 83 80 9e e1 8e 3b fe 80 71 16 95 3d    ..d^.....;..q..=
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 76 02 59 19 00 16 03 01 00 4a 02 00 00 46 03    .v.Y......J...F.
DEBUG:radius:        01 4d 3e e2 2f 32 86 c7 dc 82 13 6d 46 29 20 45    .M>./2.....mF) E
DEBUG:radius:        dd e1 aa f0 01 b8 f6 e4 0a 78 21 25 fa a4 8a 5d    .........x!%...]
DEBUG:radius:        bc 20 0c ce 43 23 a8 5d c0 1b 2d fe ee 0e 29 ce    . ..C#.]..-...).
DEBUG:radius:        6f d7 42 fc 65 4d a8 d3 ae 4a be 2a 80 bf 43 8e    o.B.eM...J.*..C.
DEBUG:radius:        56 0c 00 35 00 16 03 01 01 f6 0b 00 01 f2 00 01    V..5............
DEBUG:radius:        ef 00 01 ec 30 82 01 e8 30 82 01 51 a0 03 02 01    ....0...0..Q....
DEBUG:radius:        02 02 05 00 93 52 91 a3 30 0d 06 09 2a 86 48 86    .....R..0...*.H.
DEBUG:radius:        f7 0d 01 01 05 05 00 30 38 31 10 30 0e 06 03 55    .......081.0...U
DEBUG:radius:        04 0a 13 07 55 6e 6b 6e 6f 77 6e 31 10 30 0e 06    ....Unknown1.0..
DEBUG:radius:        03 55 04 0b 13 07 55 6e 6b 6e 6f 77 6e 31 12 30    .U....Unknown1.0
DEBUG:radius:        10 06 03 55 04 03 13 09 79 69 7a 61 71 2d 6c 6e    ...U....yizaq-ln
DEBUG:radius:        78 30 1e 17 0d 31 31 30 31 32 34 30 39 35 32 30    x0...11012409520
DEBUG:radius:        31 5a 17 0d 31 31 30 34 32 34 30 39 35 32 30 31    1Z..110424095201
DEBUG:radius:        5a 30 38 31 10 30 0e 06 03 55 04 0a 13 07 55 6e    Z081.0...U....Un
DEBUG:radius:        6b 6e 6f 77 6e 31 10 30 0e 06 03 55 04             known1.0...U.
DEBUG:radius:    EAP-Message:
DEBUG:radius:        0b 13 07 55 6e 6b 6e 6f 77 6e 31 12 30 10 06 03    ...Unknown1.0...
DEBUG:radius:        55 04 03 13 09 79 69 7a 61 71 2d 6c 6e 78 30 81    U....yizaq-lnx0.
DEBUG:radius:        9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00    .0...*.H........
DEBUG:radius:        03 81 8d 00 30 81 89 02 81 81 00 99 40 ea 97 f2    ....0.......@...
DEBUG:radius:        ad 1a c7 9e 12 1e ce 37 26 fe 02 c9 22 82 fd 35    .......7&..."..5
DEBUG:radius:        33 c6 6a 0c ce 3f e5 cf ba 8b a7 bc f8 14 ef 7a    3.j..?.........z
DEBUG:radius:        7d d9 68 a2 0e f8 19 96 5a 7b d9 f0 61 0a cb b5    }.h.....Z{..a...
DEBUG:radius:        e2 e5 64 eb 9a ac 97 fa 59 bd be d8 39 b1 c9 20    ..d.....Y...9.. 
DEBUG:radius:        27 2a 17 e9 1a 23 de b6 5c 21 51 fd 3b 04 53 d1    '*...#..\!Q.;.S.
DEBUG:radius:        1b 3e 0d 77 8e 53 dc 2f 2a 39 84 04 9f 50 2c 00    .>.w.S./*9...P,.
DEBUG:radius:        a6 4c 25 8e 1a ec 3a 9c e3 72 f8 f7 80 2c df 03    .L%...:..r...,..
DEBUG:radius:        7a 74 6e cf b2 2e 8e aa a2 86 a9 02 03 01 00 01    ztn.............
DEBUG:radius:        30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00 03    0...*.H.........
DEBUG:radius:        81 81 00 68 dc 37 9c b7 ae 81 c8 15 19 1f b9 aa    ...h.7..........
DEBUG:radius:        b5 84 0d 0e 54 f3 d5 c3 2d d8 0b 16 34 32 91 b8    ....T...-...42..
DEBUG:radius:        39 96 c1 c4 63 49 ab 79 d5 5f fc 84 06             9...cI.y._...
DEBUG:radius:    EAP-Message:
DEBUG:radius:        55 52 43 ff f9 fb 2d b6 0a 58 23 18 e4 b1 1f ea    URC...-..X#.....
DEBUG:radius:        38 05 80 12 2a c5 04 9a 55 b5 c6 d4 a7 78 1f ff    8...*...U....x..
DEBUG:radius:        75 47 9d f5 ea 0e 9a 5e 53 f8 99 5c fb 00 af cf    uG.....^S..\....
DEBUG:radius:        f0 0d 46 85 e9 ae 9a d2 ef 04 e2 a7 54 dd bc b3    ..F.........T...
DEBUG:radius:        7a 95 09 b2 d8 2b 58 10 11 da 1a 51 9c df 14 b0    z....+X....Q....
DEBUG:radius:        00 fe ad 8f aa 0a 16 03 01 00 04 0e 00 00 00       ...............
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        17 30 cd 7f fd 0c 51 75 e5 8e 36 90 e9 e3 03 d9    .0....Qu..6.....
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 76 02 59 19 00 16 03 01 00 4a 02 00 00 46 03    .v.Y......J...F.
DEBUG:eap:01 4d 3e e2 2f 32 86 c7 dc 82 13 6d 46 29 20 45    .M>./2.....mF) E
DEBUG:eap:dd e1 aa f0 01 b8 f6 e4 0a 78 21 25 fa a4 8a 5d    .........x!%...]
DEBUG:eap:bc 20 0c ce 43 23 a8 5d c0 1b 2d fe ee 0e 29 ce    . ..C#.]..-...).
DEBUG:eap:6f d7 42 fc 65 4d a8 d3 ae 4a be 2a 80 bf 43 8e    o.B.eM...J.*..C.
DEBUG:eap:56 0c 00 35 00 16 03 01 01 f6 0b 00 01 f2 00 01    V..5............
DEBUG:eap:ef 00 01 ec 30 82 01 e8 30 82 01 51 a0 03 02 01    ....0...0..Q....
DEBUG:eap:02 02 05 00 93 52 91 a3 30 0d 06 09 2a 86 48 86    .....R..0...*.H.
DEBUG:eap:f7 0d 01 01 05 05 00 30 38 31 10 30 0e 06 03 55    .......081.0...U
DEBUG:eap:04 0a 13 07 55 6e 6b 6e 6f 77 6e 31 10 30 0e 06    ....Unknown1.0..
DEBUG:eap:03 55 04 0b 13 07 55 6e 6b 6e 6f 77 6e 31 12 30    .U....Unknown1.0
DEBUG:eap:10 06 03 55 04 03 13 09 79 69 7a 61 71 2d 6c 6e    ...U....yizaq-ln
DEBUG:eap:78 30 1e 17 0d 31 31 30 31 32 34 30 39 35 32 30    x0...11012409520
DEBUG:eap:31 5a 17 0d 31 31 30 34 32 34 30 39 35 32 30 31    1Z..110424095201
DEBUG:eap:5a 30 38 31 10 30 0e 06 03 55 04 0a 13 07 55 6e    Z081.0...U....Un
DEBUG:eap:6b 6e 6f 77 6e 31 10 30 0e 06 03 55 04 0b 13 07    known1.0...U....
DEBUG:eap:55 6e 6b 6e 6f 77 6e 31 12 30 10 06 03 55 04 03    Unknown1.0...U..
DEBUG:eap:13 09 79 69 7a 61 71 2d 6c 6e 78 30 81 9f 30 0d    ..yizaq-lnx0..0.
DEBUG:eap:06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d    ..*.H...........
DEBUG:eap:00 30 81 89 02 81 81 00 99 40 ea 97 f2 ad 1a c7    .0.......@......
DEBUG:eap:9e 12 1e ce 37 26 fe 02 c9 22 82 fd 35 33 c6 6a    ....7&..."..53.j
DEBUG:eap:0c ce 3f e5 cf ba 8b a7 bc f8 14 ef 7a 7d d9 68    ..?.........z}.h
DEBUG:eap:a2 0e f8 19 96 5a 7b d9 f0 61 0a cb b5 e2 e5 64    .....Z{..a.....d
DEBUG:eap:eb 9a ac 97 fa 59 bd be d8 39 b1 c9 20 27 2a 17    .....Y...9.. '*.
DEBUG:eap:e9 1a 23 de b6 5c 21 51 fd 3b 04 53 d1 1b 3e 0d    ..#..\!Q.;.S..>.
DEBUG:eap:77 8e 53 dc 2f 2a 39 84 04 9f 50 2c 00 a6 4c 25    w.S./*9...P,..L%
DEBUG:eap:8e 1a ec 3a 9c e3 72 f8 f7 80 2c df 03 7a 74 6e    ...:..r...,..ztn
DEBUG:eap:cf b2 2e 8e aa a2 86 a9 02 03 01 00 01 30 0d 06    .............0..
DEBUG:eap:09 2a 86 48 86 f7 0d 01 01 05 05 00 03 81 81 00    .*.H............
DEBUG:eap:68 dc 37 9c b7 ae 81 c8 15 19 1f b9 aa b5 84 0d    h.7.............
DEBUG:eap:0e 54 f3 d5 c3 2d d8 0b 16 34 32 91 b8 39 96 c1    .T...-...42..9..
DEBUG:eap:c4 63 49 ab 79 d5 5f fc 84 06 55 52 43 ff f9 fb    .cI.y._...URC...
DEBUG:eap:2d b6 0a 58 23 18 e4 b1 1f ea 38 05 80 12 2a c5    -..X#.....8...*.
DEBUG:eap:04 9a 55 b5 c6 d4 a7 78 1f ff 75 47 9d f5 ea 0e    ..U....x..uG....
DEBUG:eap:9a 5e 53 f8 99 5c fb 00 af cf f0 0d 46 85 e9 ae    .^S..\......F...
DEBUG:eap:9a d2 ef 04 e2 a7 54 dd bc b3 7a 95 09 b2 d8 2b    ......T...z....+
DEBUG:eap:58 10 11 da 1a 51 9c df 14 b0 00 fe ad 8f aa 0a    X....Q..........
DEBUG:eap:16 03 01 00 04 0e 00 00 00                         .........
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:received TLS handshake message
INFO:tls:about to send TLS handshake message
DEBUG:tls:16 03 01 00 86 10 00 00 82 00 80 2f df 92 0d c3    .........../....
DEBUG:tls:7a 96 40 11 02 a8 aa 79 48 0a bb b2 39 9c cc 7f    z.@....yH...9...
DEBUG:tls:ee 71 53 41 e2 11 37 68 ab b0 2f 95 a2 96 54 e4    .qSA..7h../...T.
DEBUG:tls:0f 33 86 19 ff 45 a8 69 cf e4 25 38 f7 8b b4 6a    .3...E.i..%8...j
DEBUG:tls:d7 10 07 02 c2 38 18 1b 92 24 a4 13 c4 7f a5 5b    .....8...$.....[
DEBUG:tls:63 02 ba 18 1e e1 85 46 17 c0 d2 bb ab 1e eb 93    c......F........
DEBUG:tls:21 4d d7 36 41 50 6b b3 00 99 1e 30 29 74 fa 64    !M.6APk....0)t.d
DEBUG:tls:20 0d db db e5 2a 7f a7 fd 2b 3b 3a 8f 0a e6 02     ....*...+;:....
DEBUG:tls:56 70 90 b2 48 c1 f1 c1 bc 31 5a 14 03 01 00 01    Vp..H....1Z.....
DEBUG:tls:01 16 03 01 00 30 b7 3d 07 09 f5 0e 38 fb 57 cf    .....0.=....8.W.
DEBUG:tls:45 6b 01 59 5f af 77 75 6e 63 51 10 aa d5 98 86    Ek.Y_.wuncQ.....
DEBUG:tls:20 af 19 5c 7b 28 e3 3c 61 29 fc 3a 22 05 33 8e     ..\{(.<a).:".3.
DEBUG:tls:ed f1 a1 1a b6 1f                                  ......
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 198
DEBUG:eap_tls_data:16 03 01 00 86 10 00 00 82 00 80 2f df 92 0d c3    .........../....
DEBUG:eap_tls_data:7a 96 40 11 02 a8 aa 79 48 0a bb b2 39 9c cc 7f    z.@....yH...9...
DEBUG:eap_tls_data:ee 71 53 41 e2 11 37 68 ab b0 2f 95 a2 96 54 e4    .qSA..7h../...T.
DEBUG:eap_tls_data:0f 33 86 19 ff 45 a8 69 cf e4 25 38 f7 8b b4 6a    .3...E.i..%8...j
DEBUG:eap_tls_data:d7 10 07 02 c2 38 18 1b 92 24 a4 13 c4 7f a5 5b    .....8...$.....[
DEBUG:eap_tls_data:63 02 ba 18 1e e1 85 46 17 c0 d2 bb ab 1e eb 93    c......F........
DEBUG:eap_tls_data:21 4d d7 36 41 50 6b b3 00 99 1e 30 29 74 fa 64    !M.6APk....0)t.d
DEBUG:eap_tls_data:20 0d db db e5 2a 7f a7 fd 2b 3b 3a 8f 0a e6 02     ....*...+;:....
DEBUG:eap_tls_data:56 70 90 b2 48 c1 f1 c1 bc 31 5a 14 03 01 00 01    Vp..H....1Z.....
DEBUG:eap_tls_data:01 16 03 01 00 30 b7 3d 07 09 f5 0e 38 fb 57 cf    .....0.=....8.W.
DEBUG:eap_tls_data:45 6b 01 59 5f af 77 75 6e 63 51 10 aa d5 98 86    Ek.Y_.wuncQ.....
DEBUG:eap_tls_data:20 af 19 5c 7b 28 e3 3c 61 29 fc 3a 22 05 33 8e     ..\{(.<a).:".3.
DEBUG:eap_tls_data:ed f1 a1 1a b6 1f                                  ......
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 118
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 208
DEBUG:eap:80 00 00 00 c6 16 03 01 00 86 10 00 00 82 00 80    ................
DEBUG:eap:2f df 92 0d c3 7a 96 40 11 02 a8 aa 79 48 0a bb    /....z.@....yH..
DEBUG:eap:b2 39 9c cc 7f ee 71 53 41 e2 11 37 68 ab b0 2f    .9....qSA..7h../
DEBUG:eap:95 a2 96 54 e4 0f 33 86 19 ff 45 a8 69 cf e4 25    ...T..3...E.i..%
DEBUG:eap:38 f7 8b b4 6a d7 10 07 02 c2 38 18 1b 92 24 a4    8...j.....8...$.
DEBUG:eap:13 c4 7f a5 5b 63 02 ba 18 1e e1 85 46 17 c0 d2    ....[c......F...
DEBUG:eap:bb ab 1e eb 93 21 4d d7 36 41 50 6b b3 00 99 1e    .....!M.6APk....
DEBUG:eap:30 29 74 fa 64 20 0d db db e5 2a 7f a7 fd 2b 3b    0)t.d ....*...+;
DEBUG:eap:3a 8f 0a e6 02 56 70 90 b2 48 c1 f1 c1 bc 31 5a    :....Vp..H....1Z
DEBUG:eap:14 03 01 00 01 01 16 03 01 00 30 b7 3d 07 09 f5    ..........0.=...
DEBUG:eap:0e 38 fb 57 cf 45 6b 01 59 5f af 77 75 6e 63 51    .8.W.Ek.Y_.wuncQ
DEBUG:eap:10 aa d5 98 86 20 af 19 5c 7b 28 e3 3c 61 29 fc    ..... ..\{(.<a).
DEBUG:eap:3a 22 05 33 8e ed f1 a1 1a b6 1f                   :".3.......
INFO:eap:about to send EAP message
DEBUG:eap:02 76 00 d0 19 80 00 00 00 c6 16 03 01 00 86 10    .v..............
DEBUG:eap:00 00 82 00 80 2f df 92 0d c3 7a 96 40 11 02 a8    ...../....z.@...
DEBUG:eap:aa 79 48 0a bb b2 39 9c cc 7f ee 71 53 41 e2 11    .yH...9....qSA..
DEBUG:eap:37 68 ab b0 2f 95 a2 96 54 e4 0f 33 86 19 ff 45    7h../...T..3...E
DEBUG:eap:a8 69 cf e4 25 38 f7 8b b4 6a d7 10 07 02 c2 38    .i..%8...j.....8
DEBUG:eap:18 1b 92 24 a4 13 c4 7f a5 5b 63 02 ba 18 1e e1    ...$.....[c.....
DEBUG:eap:85 46 17 c0 d2 bb ab 1e eb 93 21 4d d7 36 41 50    .F........!M.6AP
DEBUG:eap:6b b3 00 99 1e 30 29 74 fa 64 20 0d db db e5 2a    k....0)t.d ....*
DEBUG:eap:7f a7 fd 2b 3b 3a 8f 0a e6 02 56 70 90 b2 48 c1    ...+;:....Vp..H.
DEBUG:eap:f1 c1 bc 31 5a 14 03 01 00 01 01 16 03 01 00 30    ...1Z..........0
DEBUG:eap:b7 3d 07 09 f5 0e 38 fb 57 cf 45 6b 01 59 5f af    .=....8.W.Ek.Y_.
DEBUG:eap:77 75 6e 63 51 10 aa d5 98 86 20 af 19 5c 7b 28    wuncQ..... ..\{(
DEBUG:eap:e3 3c 61 29 fc 3a 22 05 33 8e ed f1 a1 1a b6 1f    .<a).:".3.......
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 4
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02v\x00\xd0\x19\x80\x00\x00\x00\xc6\x16\x03\x01\x00\x86\x10\x00\x00\x82\x00\x80/\xdf\x92\r\xc3z\x96@\x11\x02\xa8\xaayH\n\xbb\xb29\x9c\xcc\x7f\xeeqSA\xe2\x117h\xab\xb0/\x95\xa2\x96T\xe4\x0f3\x86\x19\xffE\xa8i\xcf\xe4%8\xf7\x8b\xb4j\xd7\x10\x07\x02\xc28\x18\x1b\x92$\xa4\x13\xc4\x7f\xa5[c\x02\xba\x18\x1e\xe1\x85F\x17\xc0\xd2\xbb\xab\x1e\xeb\x93!M\xd76APk\xb3\x00\x99\x1e0)t\xfad \r\xdb\xdb\xe5*\x7f\xa7\xfd+;:\x8f\n\xe6\x02Vp\x90\xb2H\xc1\xf1\xc1\xbc1Z\x14\x03\x01\x00\x01\x01\x16\x03\x01\x000\xb7=\x07\t\xf5\x0e8\xfbW\xcfEk\x01Y_\xafwuncQ\x10\xaa\xd5\x98\x86 \xaf\x19\\{(\xe3<a)\xfc:"\x053\x8e\xed\xf1\xa1\x1a\xb6\x1f']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 04 01 5d d7 09 3d e0 8f 14 3d c5 9d 98 1f 36    ...]..=...=....6
DEBUG:radius:8b 61 92 21 02 12 4a ea 50 9c b8 13 90 54 44 2b    .a.!..J.P....TD+
DEBUG:radius:0e 04 01 51 88 bf 04 06 01 01 01 01 01 0e 79 6f    ...Q..........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f d2 02 76 00 d0 19 80 00    ;.....ZO..v.....
DEBUG:radius:00 00 c6 16 03 01 00 86 10 00 00 82 00 80 2f df    ............../.
DEBUG:radius:92 0d c3 7a 96 40 11 02 a8 aa 79 48 0a bb b2 39    ...z.@....yH...9
DEBUG:radius:9c cc 7f ee 71 53 41 e2 11 37 68 ab b0 2f 95 a2    ....qSA..7h../..
DEBUG:radius:96 54 e4 0f 33 86 19 ff 45 a8 69 cf e4 25 38 f7    .T..3...E.i..%8.
DEBUG:radius:8b b4 6a d7 10 07 02 c2 38 18 1b 92 24 a4 13 c4    ..j.....8...$...
DEBUG:radius:7f a5 5b 63 02 ba 18 1e e1 85 46 17 c0 d2 bb ab    ..[c......F.....
DEBUG:radius:1e eb 93 21 4d d7 36 41 50 6b b3 00 99 1e 30 29    ...!M.6APk....0)
DEBUG:radius:74 fa 64 20 0d db db e5 2a 7f a7 fd 2b 3b 3a 8f    t.d ....*...+;:.
DEBUG:radius:0a e6 02 56 70 90 b2 48 c1 f1 c1 bc 31 5a 14 03    ...Vp..H....1Z..
DEBUG:radius:01 00 01 01 16 03 01 00 30 b7 3d 07 09 f5 0e 38    ........0.=....8
DEBUG:radius:fb 57 cf 45 6b 01 59 5f af 77 75 6e 63 51 10 aa    .W.Ek.Y_.wuncQ..
DEBUG:radius:d5 98 86 20 af 19 5c 7b 28 e3 3c 61 29 fc 3a 22    ... ..\{(.<a).:"
DEBUG:radius:05 33 8e ed f1 a1 1a b6 1f 1f 02 50 12 d3 60 a8    .3.........P..`.
DEBUG:radius:a3 b6 e4 e1 6a d4 14 d0 a4 31 ec 9b 60             ....j....1..`
INFO:radius:received RADIUS message
DEBUG:radius:0b 04 00 8e 9b 1b a1 e5 35 cb 1e 6f 58 2a 01 1e    ........5..oX*..
DEBUG:radius:0b 57 b0 0a 18 25 33 32 53 65 73 73 69 6f 6e 49    .W...%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 43 01 77 00 41 19    4319/209;OC.w.A.
DEBUG:radius:00 14 03 01 00 01 01 16 03 01 00 30 29 38 a5 47    ...........0)8.G
DEBUG:radius:9d f2 92 bf b5 aa 0d e6 c8 82 2a ac 0f e0 26 fd    ..........*...&.
DEBUG:radius:57 3d e3 3b 00 87 05 09 4d d5 f6 00 90 c1 25 81    W=.;....M.....%.
DEBUG:radius:cb 57 1e 10 e4 1f af 5e e9 7a 3b d2 50 12 3b 90    .W.....^.z;.P.;.
DEBUG:radius:f7 81 23 03 7b c2 79 e5 cb 43 7d 58 d6 4e          ..#.{.y..C}X.N
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 4
DEBUG:radius:RADIUS message length: 142
DEBUG:radius:RADIUS authenticator: 9b 1b a1 e5 35 cb 1e 6f 58 2a 01 1e 0b 57 b0 0a    ....5..oX*...W..
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 77 00 41 19 00 14 03 01 00 01 01 16 03 01 00    .w.A............
DEBUG:radius:        30 29 38 a5 47 9d f2 92 bf b5 aa 0d e6 c8 82 2a    0)8.G..........*
DEBUG:radius:        ac 0f e0 26 fd 57 3d e3 3b 00 87 05 09 4d d5 f6    ...&.W=.;....M..
DEBUG:radius:        00 90 c1 25 81 cb 57 1e 10 e4 1f af 5e e9 7a 3b    ...%..W.....^.z;
DEBUG:radius:        d2                                                 .
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        3b 90 f7 81 23 03 7b c2 79 e5 cb 43 7d 58 d6 4e    ;...#.{.y..C}X.N
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 77 00 41 19 00 14 03 01 00 01 01 16 03 01 00    .w.A............
DEBUG:eap:30 29 38 a5 47 9d f2 92 bf b5 aa 0d e6 c8 82 2a    0)8.G..........*
DEBUG:eap:ac 0f e0 26 fd 57 3d e3 3b 00 87 05 09 4d d5 f6    ...&.W=.;....M..
DEBUG:eap:00 90 c1 25 81 cb 57 1e 10 e4 1f af 5e e9 7a 3b    ...%..W.....^.z;
DEBUG:eap:d2                                                 .
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:received TLS handshake message
INFO:tls:TLS handshake done
INFO:eap_tls_data:about to send EAP-TLS-DATA ack message
DEBUG:eap_tls_data:00                                                 .
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 119
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 6
DEBUG:eap:00                                                 .
INFO:eap:about to send EAP message
DEBUG:eap:02 77 00 06 19 00                                  .w....
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 5
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02w\x00\x06\x19\x00']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 05 00 93 09 18 74 a4 68 cd 24 ef 9e 3a 99 fe    ......t.h.$..:..
DEBUG:radius:af 0e 0b 07 02 12 1f 97 94 70 64 3e 78 ff 64 13    .........pd>x.d.
DEBUG:radius:de 68 12 49 8a a9 04 06 01 01 01 01 01 0e 79 6f    .h.I..........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 08 02 77 00 06 19 00 1f    ;.....ZO..w.....
DEBUG:radius:02 50 12 de bd 48 f0 dd b0 41 56 16 52 c0 6d 63    .P...H...AV.R.mc
DEBUG:radius:f7 5c f1                                           .\.
INFO:radius:received RADIUS message
DEBUG:radius:0b 05 00 78 89 a4 e9 69 b5 4c 71 4b c5 a3 e5 69    ...x...i.LqK...i
DEBUG:radius:5b 45 53 8a 18 25 33 32 53 65 73 73 69 6f 6e 49    [ES..%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 2d 01 78 00 2b 19    4319/209;O-.x.+.
DEBUG:radius:00 17 03 01 00 20 87 69 5a 02 b7 9b 59 d5 5d 49    ..... .iZ...Y.]I
DEBUG:radius:b6 90 c4 eb 70 c0 52 dd 35 01 d4 05 d8 0c 6a d1    ....p.R.5.....j.
DEBUG:radius:88 44 53 56 c5 66 50 12 50 03 53 10 e7 73 bd da    .DSV.fP.P.S..s..
DEBUG:radius:90 23 d7 f0 b5 c2 c5 a6                            .#......
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 5
DEBUG:radius:RADIUS message length: 120
DEBUG:radius:RADIUS authenticator: 89 a4 e9 69 b5 4c 71 4b c5 a3 e5 69 5b 45 53 8a    ...i.LqK...i[ES.
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 78 00 2b 19 00 17 03 01 00 20 87 69 5a 02 b7    .x.+...... .iZ..
DEBUG:radius:        9b 59 d5 5d 49 b6 90 c4 eb 70 c0 52 dd 35 01 d4    .Y.]I....p.R.5..
DEBUG:radius:        05 d8 0c 6a d1 88 44 53 56 c5 66                   ...j..DSV.f
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        50 03 53 10 e7 73 bd da 90 23 d7 f0 b5 c2 c5 a6    P.S..s...#......
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 78 00 2b 19 00 17 03 01 00 20 87 69 5a 02 b7    .x.+...... .iZ..
DEBUG:eap:9b 59 d5 5d 49 b6 90 c4 eb 70 c0 52 dd 35 01 d4    .Y.]I....p.R.5..
DEBUG:eap:05 d8 0c 6a d1 88 44 53 56 c5 66                   ...j..DSV.f
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:recived tunneled data
INFO:peap:received PEAPv0 start message
DEBUG:peap:01                                                 .
INFO:eap:starting inner EAP
INFO:eap:about to compose EAP identity message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 120
DEBUG:eap:EAP type: 1
DEBUG:eap:EAP identity length: 13
DEBUG:eap:74 6c 73 75 73 65 72 30                            tlsuser0
INFO:eap:about to send EAP identity message
DEBUG:eap:02 78 00 0d 01 74 6c 73 75 73 65 72 30             .x...tlsuser0
INFO:peap:send PEAPv0 start message response
DEBUG:peap:01 74 6c 73 75 73 65 72 30                         .tlsuser0
INFO:tls:about to send tunneled data
DEBUG:tls:17 03 01 00 20 a6 a8 33 31 29 d7 1a 15 a5 af 6c    .... ..31).....l
DEBUG:tls:52 fa 5d 0d c1 dc 79 3e 1e 05 c9 58 d3 74 34 0b    R.]...y>...X.t4.
DEBUG:tls:f8 89 63 a7 99                                     ..c..
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 37
DEBUG:eap_tls_data:17 03 01 00 20 a6 a8 33 31 29 d7 1a 15 a5 af 6c    .... ..31).....l
DEBUG:eap_tls_data:52 fa 5d 0d c1 dc 79 3e 1e 05 c9 58 d3 74 34 0b    R.]...y>...X.t4.
DEBUG:eap_tls_data:f8 89 63 a7 99                                     ..c..
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 120
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 47
DEBUG:eap:80 00 00 00 25 17 03 01 00 20 a6 a8 33 31 29 d7    ....%.... ..31).
DEBUG:eap:1a 15 a5 af 6c 52 fa 5d 0d c1 dc 79 3e 1e 05 c9    ....lR.]...y>...
DEBUG:eap:58 d3 74 34 0b f8 89 63 a7 99                      X.t4...c..
INFO:eap:about to send EAP message
DEBUG:eap:02 78 00 2f 19 80 00 00 00 25 17 03 01 00 20 a6    .x./.....%.... .
DEBUG:eap:a8 33 31 29 d7 1a 15 a5 af 6c 52 fa 5d 0d c1 dc    .31).....lR.]...
DEBUG:eap:79 3e 1e 05 c9 58 d3 74 34 0b f8 89 63 a7 99       y>...X.t4...c..
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 6
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02x\x00/\x19\x80\x00\x00\x00%\x17\x03\x01\x00 \xa6\xa831)\xd7\x1a\x15\xa5\xaflR\xfa]\r\xc1\xdcy>\x1e\x05\xc9X\xd3t4\x0b\xf8\x89c\xa7\x99']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 06 00 bc fd db d5 93 b9 87 fb 09 87 5c 78 23    .............\x#
DEBUG:radius:cb b6 9a 5f 02 12 a3 f2 fb 82 d5 1d e3 78 c1 10    ..._.........x..
DEBUG:radius:08 07 d5 f4 47 3f 04 06 01 01 01 01 01 0e 79 6f    ....G?........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 31 02 78 00 2f 19 80 00    ;.....ZO1.x./...
DEBUG:radius:00 00 25 17 03 01 00 20 a6 a8 33 31 29 d7 1a 15    ..%.... ..31)...
DEBUG:radius:a5 af 6c 52 fa 5d 0d c1 dc 79 3e 1e 05 c9 58 d3    ..lR.]...y>...X.
DEBUG:radius:74 34 0b f8 89 63 a7 99 1f 02 50 12 45 07 20 3d    t4...c....P.E. =
DEBUG:radius:85 1c bf 85 8a b8 bf e0 f2 d5 28 4e                ..........(N
INFO:radius:received RADIUS message
DEBUG:radius:0b 06 00 98 ab 31 21 cf d1 d2 1b f3 f2 36 68 12    .....1!......6h.
DEBUG:radius:ce 3a 14 00 18 25 33 32 53 65 73 73 69 6f 6e 49    .:...%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 4d 01 79 00 4b 19    4319/209;OM.y.K.
DEBUG:radius:00 17 03 01 00 40 aa 95 14 90 ee ce 30 b0 42 46    .....@......0.BF
DEBUG:radius:5a 56 19 ce 74 66 24 b8 58 ce 5c cd 28 ec d8 8c    ZV..tf$.X.\.(...
DEBUG:radius:e1 d0 a3 c1 f2 31 dc 54 ba 51 e9 e7 17 84 e5 6e    .....1.T.Q.....n
DEBUG:radius:41 6f 3e b8 56 b1 05 89 db 75 4b 69 72 50 8d 46    Ao>.V....uKirP.F
DEBUG:radius:0b fa d9 5e d0 e4 50 12 b2 79 ba e6 59 42 3d 0c    ...^..P..y..YB=.
DEBUG:radius:6c fd 9b 18 2a a7 a7 f8                            l...*...
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 6
DEBUG:radius:RADIUS message length: 152
DEBUG:radius:RADIUS authenticator: ab 31 21 cf d1 d2 1b f3 f2 36 68 12 ce 3a 14 00    .1!......6h..:..
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 79 00 4b 19 00 17 03 01 00 40 aa 95 14 90 ee    .y.K......@.....
DEBUG:radius:        ce 30 b0 42 46 5a 56 19 ce 74 66 24 b8 58 ce 5c    .0.BFZV..tf$.X.\
DEBUG:radius:        cd 28 ec d8 8c e1 d0 a3 c1 f2 31 dc 54 ba 51 e9    .(........1.T.Q.
DEBUG:radius:        e7 17 84 e5 6e 41 6f 3e b8 56 b1 05 89 db 75 4b    ....nAo>.V....uK
DEBUG:radius:        69 72 50 8d 46 0b fa d9 5e d0 e4                   irP.F...^..
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        b2 79 ba e6 59 42 3d 0c 6c fd 9b 18 2a a7 a7 f8    .y..YB=.l...*...
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 79 00 4b 19 00 17 03 01 00 40 aa 95 14 90 ee    .y.K......@.....
DEBUG:eap:ce 30 b0 42 46 5a 56 19 ce 74 66 24 b8 58 ce 5c    .0.BFZV..tf$.X.\
DEBUG:eap:cd 28 ec d8 8c e1 d0 a3 c1 f2 31 dc 54 ba 51 e9    .(........1.T.Q.
DEBUG:eap:e7 17 84 e5 6e 41 6f 3e b8 56 b1 05 89 db 75 4b    ....nAo>.V....uK
DEBUG:eap:69 72 50 8d 46 0b fa d9 5e d0 e4                   irP.F...^..
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:recived tunneled data
INFO:peap:received PEAPv0 inner method message
DEBUG:peap:1a 01 79 00 1e 10 e0 89 e2 cb 7b 8d c7 d5 61 f2    ..y.......{...a.
DEBUG:peap:ed 64 49 67 51 48 79 69 7a 61 71 2d 6c 6e 78       .dIgQHyizaq-lnx
INFO:eap:received raw EAP message
DEBUG:eap:01 79 00 4b 1a 01 79 00 1e 10 e0 89 e2 cb 7b 8d    .y.K..y.......{.
DEBUG:eap:c7 d5 61 f2 ed 64 49 67 51 48 79 69 7a 61 71 2d    ..a..dIgQHyizaq-
DEBUG:eap:6c 6e 78                                           lnx
INFO:eap:parsed incoming EAP message
INFO:eap_mschapv2:received message
DEBUG:eap_mschapv2:01 79 00 1e 10 e0 89 e2 cb 7b 8d c7 d5 61 f2 ed    .y.......{...a..
DEBUG:eap_mschapv2:64 49 67 51 48 79 69 7a 61 71 2d 6c 6e 78          dIgQHyizaq-lnx
INFO:eap_mschapv2:parsed challenge message
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 opcode: 1
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 identifier: 121
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 message length: 30
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 Value length: 16
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 name: yizaq-lnx
DEBUG:eap_mschapv2:e0 89 e2 cb 7b 8d c7 d5 61 f2 ed 64 49 67 51 48    ....{...a..dIgQH
INFO:eap_mschapv2:Compose challenge response message
DEBUG:eap_mschapv2:EAP-MS-CHAPv2 user name: yosi_i_test1
INFO:eap_mschapv2:Send challenge response message
DEBUG:eap_mschapv2:02 79 00 42 31 f1 d7 3b 9a b9 59 d6 5b b9 fb 84    .y.B1..;..Y.[...
DEBUG:eap_mschapv2:fb 41 25 00 c9 00 00 00 00 00 00 00 00 ac 7d dd    .A%...........}.
DEBUG:eap_mschapv2:ba c2 b2 d0 c3 11 eb 4c 03 97 03 46 da df 70 79    .......L...F..py
DEBUG:eap_mschapv2:c8 8e f9 93 2f 00 79 6f 73 69 5f 69 5f 74 65 73    ..../.yosi_i_tes
DEBUG:eap_mschapv2:74 31                                              t1
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 121
DEBUG:eap:EAP type: 26
DEBUG:eap:EAP response length: 71
DEBUG:eap:02 79 00 42 31 f1 d7 3b 9a b9 59 d6 5b b9 fb 84    .y.B1..;..Y.[...
DEBUG:eap:fb 41 25 00 c9 00 00 00 00 00 00 00 00 ac 7d dd    .A%...........}.
DEBUG:eap:ba c2 b2 d0 c3 11 eb 4c 03 97 03 46 da df 70 79    .......L...F..py
DEBUG:eap:c8 8e f9 93 2f 00 79 6f 73 69 5f 69 5f 74 65 73    ..../.yosi_i_tes
DEBUG:eap:74 31                                              t1
INFO:eap:about to send EAP message
DEBUG:eap:02 79 00 47 1a 02 79 00 42 31 f1 d7 3b 9a b9 59    .y.G..y.B1..;..Y
DEBUG:eap:d6 5b b9 fb 84 fb 41 25 00 c9 00 00 00 00 00 00    .[....A%........
DEBUG:eap:00 00 ac 7d dd ba c2 b2 d0 c3 11 eb 4c 03 97 03    ...}........L...
DEBUG:eap:46 da df 70 79 c8 8e f9 93 2f 00 79 6f 73 69 5f    F..py..../.yosi_
DEBUG:eap:69 5f 74 65 73 74 31                               i_test1
INFO:peap:send PEAPv0 inner method response
DEBUG:peap:1a 02 79 00 42 31 f1 d7 3b 9a b9 59 d6 5b b9 fb    ..y.B1..;..Y.[..
DEBUG:peap:84 fb 41 25 00 c9 00 00 00 00 00 00 00 00 ac 7d    ..A%...........}
DEBUG:peap:dd ba c2 b2 d0 c3 11 eb 4c 03 97 03 46 da df 70    ........L...F..p
DEBUG:peap:79 c8 8e f9 93 2f 00 79 6f 73 69 5f 69 5f 74 65    y..../.yosi_i_te
DEBUG:peap:73 74 31                                           st1
INFO:tls:about to send tunneled data
DEBUG:tls:17 03 01 00 60 39 f2 c9 fe 5a d9 ba ae af a8 c9    ....`9...Z......
DEBUG:tls:07 18 93 99 d1 96 0c f7 52 f7 5a 80 6d 43 c5 d8    ........R.Z.mC..
DEBUG:tls:8f af 62 e8 ce 91 7f a2 74 2c ae 96 3d 73 0e ba    ..b.....t,..=s..
DEBUG:tls:75 2a 8e fb 2e 02 42 d8 33 3b c0 18 b1 4f 4d 44    u*....B.3;...OMD
DEBUG:tls:e0 a3 72 eb 9c 31 4c e0 aa 35 8c f5 bf 9c 99 de    ..r..1L..5......
DEBUG:tls:fa b6 7a 72 21 2b e4 98 b5 38 05 71 42 84 2f 69    ..zr!+...8.qB./i
DEBUG:tls:db d8 07 1a f6                                     .....
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 101
DEBUG:eap_tls_data:17 03 01 00 60 39 f2 c9 fe 5a d9 ba ae af a8 c9    ....`9...Z......
DEBUG:eap_tls_data:07 18 93 99 d1 96 0c f7 52 f7 5a 80 6d 43 c5 d8    ........R.Z.mC..
DEBUG:eap_tls_data:8f af 62 e8 ce 91 7f a2 74 2c ae 96 3d 73 0e ba    ..b.....t,..=s..
DEBUG:eap_tls_data:75 2a 8e fb 2e 02 42 d8 33 3b c0 18 b1 4f 4d 44    u*....B.3;...OMD
DEBUG:eap_tls_data:e0 a3 72 eb 9c 31 4c e0 aa 35 8c f5 bf 9c 99 de    ..r..1L..5......
DEBUG:eap_tls_data:fa b6 7a 72 21 2b e4 98 b5 38 05 71 42 84 2f 69    ..zr!+...8.qB./i
DEBUG:eap_tls_data:db d8 07 1a f6                                     .....
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 121
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 111
DEBUG:eap:80 00 00 00 65 17 03 01 00 60 39 f2 c9 fe 5a d9    ....e....`9...Z.
DEBUG:eap:ba ae af a8 c9 07 18 93 99 d1 96 0c f7 52 f7 5a    .............R.Z
DEBUG:eap:80 6d 43 c5 d8 8f af 62 e8 ce 91 7f a2 74 2c ae    .mC....b.....t,.
DEBUG:eap:96 3d 73 0e ba 75 2a 8e fb 2e 02 42 d8 33 3b c0    .=s..u*....B.3;.
DEBUG:eap:18 b1 4f 4d 44 e0 a3 72 eb 9c 31 4c e0 aa 35 8c    ..OMD..r..1L..5.
DEBUG:eap:f5 bf 9c 99 de fa b6 7a 72 21 2b e4 98 b5 38 05    .......zr!+...8.
DEBUG:eap:71 42 84 2f 69 db d8 07 1a f6                      qB./i.....
INFO:eap:about to send EAP message
DEBUG:eap:02 79 00 6f 19 80 00 00 00 65 17 03 01 00 60 39    .y.o.....e....`9
DEBUG:eap:f2 c9 fe 5a d9 ba ae af a8 c9 07 18 93 99 d1 96    ...Z............
DEBUG:eap:0c f7 52 f7 5a 80 6d 43 c5 d8 8f af 62 e8 ce 91    ..R.Z.mC....b...
DEBUG:eap:7f a2 74 2c ae 96 3d 73 0e ba 75 2a 8e fb 2e 02    ..t,..=s..u*....
DEBUG:eap:42 d8 33 3b c0 18 b1 4f 4d 44 e0 a3 72 eb 9c 31    B.3;...OMD..r..1
DEBUG:eap:4c e0 aa 35 8c f5 bf 9c 99 de fa b6 7a 72 21 2b    L..5........zr!+
DEBUG:eap:e4 98 b5 38 05 71 42 84 2f 69 db d8 07 1a f6       ...8.qB./i.....
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 7
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02y\x00o\x19\x80\x00\x00\x00e\x17\x03\x01\x00`9\xf2\xc9\xfeZ\xd9\xba\xae\xaf\xa8\xc9\x07\x18\x93\x99\xd1\x96\x0c\xf7R\xf7Z\x80mC\xc5\xd8\x8f\xafb\xe8\xce\x91\x7f\xa2t,\xae\x96=s\x0e\xbau*\x8e\xfb.\x02B\xd83;\xc0\x18\xb1OMD\xe0\xa3r\xeb\x9c1L\xe0\xaa5\x8c\xf5\xbf\x9c\x99\xde\xfa\xb6zr!+\xe4\x98\xb58\x05qB\x84/i\xdb\xd8\x07\x1a\xf6']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 07 00 fc 10 f8 1b ab 19 ff ec 18 ab 2a ea fb    .............*..
DEBUG:radius:dc 5e a7 26 02 12 67 b9 55 96 b1 4a 04 0b 0d dd    .^.&..g.U..J....
DEBUG:radius:57 64 94 6e 4b ba 04 06 01 01 01 01 01 0e 79 6f    Wd.nK.........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 71 02 79 00 6f 19 80 00    ;.....ZOq.y.o...
DEBUG:radius:00 00 65 17 03 01 00 60 39 f2 c9 fe 5a d9 ba ae    ..e....`9...Z...
DEBUG:radius:af a8 c9 07 18 93 99 d1 96 0c f7 52 f7 5a 80 6d    ...........R.Z.m
DEBUG:radius:43 c5 d8 8f af 62 e8 ce 91 7f a2 74 2c ae 96 3d    C....b.....t,..=
DEBUG:radius:73 0e ba 75 2a 8e fb 2e 02 42 d8 33 3b c0 18 b1    s..u*....B.3;...
DEBUG:radius:4f 4d 44 e0 a3 72 eb 9c 31 4c e0 aa 35 8c f5 bf    OMD..r..1L..5...
DEBUG:radius:9c 99 de fa b6 7a 72 21 2b e4 98 b5 38 05 71 42    .....zr!+...8.qB
DEBUG:radius:84 2f 69 db d8 07 1a f6 1f 02 50 12 50 3b 7a a7    ./i.......P.P;z.
DEBUG:radius:2b 7a 28 dd 02 94 58 07 6a 41 f5 fe                +z(...X.jA..
INFO:radius:received RADIUS message
DEBUG:radius:0b 07 00 a8 9b 96 9c e1 3a cf 18 93 ac 00 ce 74    ........:......t
DEBUG:radius:ad 2c ea 34 18 25 33 32 53 65 73 73 69 6f 6e 49    .,.4.%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 5d 01 7a 00 5b 19    4319/209;O].z.[.
DEBUG:radius:00 17 03 01 00 50 a0 63 42 9a e5 3c 56 0b bf 3e    .....P.cB..<V..>
DEBUG:radius:53 3f ac fc ca 4f 50 42 2b 9a 72 19 4e 0d 4d 6f    S?...OPB+.r.N.Mo
DEBUG:radius:d3 bd 34 08 89 43 0b 6f 96 9c 4c bc be 95 b6 3d    ..4..C.o..L....=
DEBUG:radius:0f c3 b2 55 57 6a a0 d7 50 2e cd a5 fe dd e0 d3    ...UWj..P.......
DEBUG:radius:b2 c6 9f 9a 84 4a 51 fe ca 58 84 85 54 6d 7d 4b    .....JQ..X..Tm}K
DEBUG:radius:70 3c ca 09 c1 50 50 12 26 71 96 09 ce 4b 5e 17    p<...PP.&q...K^.
DEBUG:radius:50 e8 f7 a0 23 f9 82 01                            P...#...
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 7
DEBUG:radius:RADIUS message length: 168
DEBUG:radius:RADIUS authenticator: 9b 96 9c e1 3a cf 18 93 ac 00 ce 74 ad 2c ea 34    ....:......t.,.4
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 7a 00 5b 19 00 17 03 01 00 50 a0 63 42 9a e5    .z.[......P.cB..
DEBUG:radius:        3c 56 0b bf 3e 53 3f ac fc ca 4f 50 42 2b 9a 72    <V..>S?...OPB+.r
DEBUG:radius:        19 4e 0d 4d 6f d3 bd 34 08 89 43 0b 6f 96 9c 4c    .N.Mo..4..C.o..L
DEBUG:radius:        bc be 95 b6 3d 0f c3 b2 55 57 6a a0 d7 50 2e cd    ....=...UWj..P..
DEBUG:radius:        a5 fe dd e0 d3 b2 c6 9f 9a 84 4a 51 fe ca 58 84    ..........JQ..X.
DEBUG:radius:        85 54 6d 7d 4b 70 3c ca 09 c1 50                   .Tm}Kp<...P
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        26 71 96 09 ce 4b 5e 17 50 e8 f7 a0 23 f9 82 01    &q...K^.P...#...
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 7a 00 5b 19 00 17 03 01 00 50 a0 63 42 9a e5    .z.[......P.cB..
DEBUG:eap:3c 56 0b bf 3e 53 3f ac fc ca 4f 50 42 2b 9a 72    <V..>S?...OPB+.r
DEBUG:eap:19 4e 0d 4d 6f d3 bd 34 08 89 43 0b 6f 96 9c 4c    .N.Mo..4..C.o..L
DEBUG:eap:bc be 95 b6 3d 0f c3 b2 55 57 6a a0 d7 50 2e cd    ....=...UWj..P..
DEBUG:eap:a5 fe dd e0 d3 b2 c6 9f 9a 84 4a 51 fe ca 58 84    ..........JQ..X.
DEBUG:eap:85 54 6d 7d 4b 70 3c ca 09 c1 50                   .Tm}Kp<...P
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:recived tunneled data
INFO:peap:received PEAPv0 inner method message
DEBUG:peap:1a 03 79 00 2e 53 3d 33 36 38 45 33 41 30 42 32    ..y..S=368E3A0B2
DEBUG:peap:33 31 45 32 45 39 39 41 38 38 34 38 39 36 37 35    31E2E99A88489675
DEBUG:peap:46 44 33 39 46 30 41 31 31 36 39 38 32 31 36       FD39F0A11698216
INFO:eap:received raw EAP message
DEBUG:eap:01 7a 00 5b 1a 03 79 00 2e 53 3d 33 36 38 45 33    .z.[..y..S=368E3
DEBUG:eap:41 30 42 32 33 31 45 32 45 39 39 41 38 38 34 38    A0B231E2E99A8848
DEBUG:eap:39 36 37 35 46 44 33 39 46 30 41 31 31 36 39 38    9675FD39F0A11698
DEBUG:eap:32 31 36                                           216
INFO:eap:parsed incoming EAP message
INFO:eap_mschapv2:received message
DEBUG:eap_mschapv2:03 79 00 2e 53 3d 33 36 38 45 33 41 30 42 32 33    .y..S=368E3A0B23
DEBUG:eap_mschapv2:31 45 32 45 39 39 41 38 38 34 38 39 36 37 35 46    1E2E99A88489675F
DEBUG:eap_mschapv2:44 33 39 46 30 41 31 31 36 39 38 32 31 36          D39F0A11698216
INFO:eap_mschapv2:Received authentication success message
DEBUG:eap_mschapv2:03 79 00 2e 53 3d 33 36 38 45 33 41 30 42 32 33    .y..S=368E3A0B23
DEBUG:eap_mschapv2:31 45 32 45 39 39 41 38 38 34 38 39 36 37 35 46    1E2E99A88489675F
DEBUG:eap_mschapv2:44 33 39 46 30 41 31 31 36 39 38 32 31 36          D39F0A11698216
INFO:eap_mschapv2:Compose authentication success response message
INFO:eap_mschapv2:Send authentication success response message
DEBUG:eap_mschapv2:03                                                 .
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 122
DEBUG:eap:EAP type: 26
DEBUG:eap:EAP response length: 6
DEBUG:eap:03                                                 .
INFO:eap:about to send EAP message
DEBUG:eap:02 7a 00 06 1a 03                                  .z....
INFO:peap:send PEAPv0 inner method response
DEBUG:peap:1a 03                                              ..
INFO:tls:about to send tunneled data
DEBUG:tls:17 03 01 00 20 1a 5a e6 58 b8 16 73 78 9f d1 49    .... .Z.X..sx..I
DEBUG:tls:02 46 9a 5e 08 7c 7a 37 ec fe 9a ce 13 ea e8 b1    .F.^.|z7........
DEBUG:tls:1d 09 b0 37 30                                     ...70
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 37
DEBUG:eap_tls_data:17 03 01 00 20 1a 5a e6 58 b8 16 73 78 9f d1 49    .... .Z.X..sx..I
DEBUG:eap_tls_data:02 46 9a 5e 08 7c 7a 37 ec fe 9a ce 13 ea e8 b1    .F.^.|z7........
DEBUG:eap_tls_data:1d 09 b0 37 30                                     ...70
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 122
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 47
DEBUG:eap:80 00 00 00 25 17 03 01 00 20 1a 5a e6 58 b8 16    ....%.... .Z.X..
DEBUG:eap:73 78 9f d1 49 02 46 9a 5e 08 7c 7a 37 ec fe 9a    sx..I.F.^.|z7...
DEBUG:eap:ce 13 ea e8 b1 1d 09 b0 37 30                      ........70
INFO:eap:about to send EAP message
DEBUG:eap:02 7a 00 2f 19 80 00 00 00 25 17 03 01 00 20 1a    .z./.....%.... .
DEBUG:eap:5a e6 58 b8 16 73 78 9f d1 49 02 46 9a 5e 08 7c    Z.X..sx..I.F.^.|
DEBUG:eap:7a 37 ec fe 9a ce 13 ea e8 b1 1d 09 b0 37 30       z7...........70
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 8
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02z\x00/\x19\x80\x00\x00\x00%\x17\x03\x01\x00 \x1aZ\xe6X\xb8\x16sx\x9f\xd1I\x02F\x9a^\x08|z7\xec\xfe\x9a\xce\x13\xea\xe8\xb1\x1d\t\xb070']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 08 00 bc 6b 9c 44 a9 13 af 08 02 73 82 8f 18    ....k.D.....s...
DEBUG:radius:5f a8 ef 36 02 12 b7 e0 a3 2e 78 8c 73 77 ac e4    _..6......x.sw..
DEBUG:radius:5f 58 d4 cd 27 67 04 06 01 01 01 01 01 0e 79 6f    _X..'g........yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 31 02 7a 00 2f 19 80 00    ;.....ZO1.z./...
DEBUG:radius:00 00 25 17 03 01 00 20 1a 5a e6 58 b8 16 73 78    ..%.... .Z.X..sx
DEBUG:radius:9f d1 49 02 46 9a 5e 08 7c 7a 37 ec fe 9a ce 13    ..I.F.^.|z7.....
DEBUG:radius:ea e8 b1 1d 09 b0 37 30 1f 02 50 12 42 61 20 7d    ......70..P.Ba }
DEBUG:radius:b7 6d db fc 1b 7f b5 b6 76 e7 57 37                .m......v.W7
INFO:radius:received RADIUS message
DEBUG:radius:0b 08 00 78 fc df 89 94 2f c4 6e 19 03 d7 59 cb    ...x..../.n...Y.
DEBUG:radius:ee 9d 31 74 18 25 33 32 53 65 73 73 69 6f 6e 49    ..1t.%32SessionI
DEBUG:radius:44 3d 79 69 7a 61 71 2d 6c 6e 78 2f 38 35 33 32    D=yizaq-lnx/8532
DEBUG:radius:34 33 31 39 2f 32 30 39 3b 4f 2d 01 7b 00 2b 19    4319/209;O-.{.+.
DEBUG:radius:00 17 03 01 00 20 db 8d a7 19 1a 73 d1 12 ce 26    ..... .....s...&
DEBUG:radius:78 3e 59 d6 02 c4 d0 b5 9b 88 f9 d9 9b de 89 a3    x>Y.............
DEBUG:radius:24 93 c7 75 b9 fc 50 12 4b 6a 0f 1b 0a 75 9a bf    $..u..P.Kj...u..
DEBUG:radius:fb 91 9a 2f 21 d5 e1 ae                            .../!...
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Challenge
DEBUG:radius:RADIUS identifier: 8
DEBUG:radius:RADIUS message length: 120
DEBUG:radius:RADIUS authenticator: fc df 89 94 2f c4 6e 19 03 d7 59 cb ee 9d 31 74    ..../.n...Y...1t
DEBUG:radius:    State:
DEBUG:radius:        32SessionID=yizaq-lnx/85324319/209;
DEBUG:radius:    EAP-Message:
DEBUG:radius:        01 7b 00 2b 19 00 17 03 01 00 20 db 8d a7 19 1a    .{.+...... .....
DEBUG:radius:        73 d1 12 ce 26 78 3e 59 d6 02 c4 d0 b5 9b 88 f9    s...&x>Y........
DEBUG:radius:        d9 9b de 89 a3 24 93 c7 75 b9 fc                   .....$..u..
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        4b 6a 0f 1b 0a 75 9a bf fb 91 9a 2f 21 d5 e1 ae    Kj...u...../!...
DEBUG:radius:        
INFO:eap:received raw EAP message
DEBUG:eap:01 7b 00 2b 19 00 17 03 01 00 20 db 8d a7 19 1a    .{.+...... .....
DEBUG:eap:73 d1 12 ce 26 78 3e 59 d6 02 c4 d0 b5 9b 88 f9    s...&x>Y........
DEBUG:eap:d9 9b de 89 a3 24 93 c7 75 b9 fc                   .....$..u..
INFO:eap:parsed incoming EAP message
INFO:eap_tls_data:received another EAP-TLS-DATA message
INFO:eap_tls_data:parsed another EAP-TLS-DATA message
INFO:tls:recived tunneled data
INFO:peap:received PEAPv0 message
DEBUG:peap:01 7b 00 0b 21 80 03 00 02 00 01                   .{..!......
INFO:peap:parsed PEAPv0/eap-extension message
DEBUG:peap:PEAPv0/eap-extension identifier: 123
DEBUG:peap:PEAPv0/eap-extension message length: 11
DEBUG:peap:PEAPv0/eap-extension eap type: 33
DEBUG:peap:PEAPv0/eap-extension AV-Pair type: 3
DEBUG:peap:PEAPv0/eap-extension AV-Pair length: 2
DEBUG:peap:PEAPv0/eap-extension AV-Pair status: 1
INFO:peap:send PEAPv0/eap-extension response
DEBUG:peap:02 7b 00 0b 21 80 03 00 02 00 01                   .{..!......
INFO:tls:about to send tunneled data
DEBUG:tls:17 03 01 00 20 07 3c 97 6c 84 21 f1 c7 f7 35 d3    .... .<.l.!...5.
DEBUG:tls:5d 4f 9a a8 ef c0 7c 17 6e 23 a0 cf 95 a2 df a9    ]O....|.n#......
DEBUG:tls:35 05 88 c6 59                                     5...Y
INFO:eap_tls_data:about to compose first EAP-TLS-DATA fragment
DEBUG:eap_tls_data:flags: 128
DEBUG:eap_tls_data:response_length: 37
DEBUG:eap_tls_data:17 03 01 00 20 07 3c 97 6c 84 21 f1 c7 f7 35 d3    .... .<.l.!...5.
DEBUG:eap_tls_data:5d 4f 9a a8 ef c0 7c 17 6e 23 a0 cf 95 a2 df a9    ]O....|.n#......
DEBUG:eap_tls_data:35 05 88 c6 59                                     5...Y
INFO:eap:about to compose EAP message
DEBUG:eap:EAP code: 2
DEBUG:eap:EAP identifier: 123
DEBUG:eap:EAP type: 25
DEBUG:eap:EAP response length: 47
DEBUG:eap:80 00 00 00 25 17 03 01 00 20 07 3c 97 6c 84 21    ....%.... .<.l.!
DEBUG:eap:f1 c7 f7 35 d3 5d 4f 9a a8 ef c0 7c 17 6e 23 a0    ...5.]O....|.n#.
DEBUG:eap:cf 95 a2 df a9 35 05 88 c6 59                      .....5...Y
INFO:eap:about to send EAP message
DEBUG:eap:02 7b 00 2f 19 80 00 00 00 25 17 03 01 00 20 07    .{./.....%.... .
DEBUG:eap:3c 97 6c 84 21 f1 c7 f7 35 d3 5d 4f 9a a8 ef c0    <.l.!...5.]O....
DEBUG:eap:7c 17 6e 23 a0 cf 95 a2 df a9 35 05 88 c6 59       |.n#......5...Y
INFO:radius:about to compose RADIUS message
DEBUG:radius:RADIUS code: Access-Request
DEBUG:radius:RADIUS identifier: 9
DEBUG:radius:RADIUS secret: acsi
DEBUG:radius:RADIUS attributes:
DEBUG:radius:    User-Password: ['rree12#$']
DEBUG:radius:    NAS-IP-Address: ['1.1.1.1']
DEBUG:radius:    User-Name: ['yosi_i_test1']
DEBUG:radius:    Message-Authenticator: ['Message']
DEBUG:radius:    VSA: {'Cisco': {'Cisco-AVPair': ['name=value']}}
DEBUG:radius:    State: ['32SessionID=yizaq-lnx/85324319/209;']
DEBUG:radius:    Session-Timeout: [90]
DEBUG:radius:    EAP-Message: ['\x02{\x00/\x19\x80\x00\x00\x00%\x17\x03\x01\x00 \x07<\x97l\x84!\xf1\xc7\xf75\xd3]O\x9a\xa8\xef\xc0|\x17n#\xa0\xcf\x95\xa2\xdf\xa95\x05\x88\xc6Y']
DEBUG:radius:    Calling-Station-Id: ['1.2.3.4']
INFO:radius:about to send radius message
DEBUG:radius:01 09 00 bc 13 fa d2 2c 53 dd a8 5a ff bf 6c f8    .......,S..Z..l.
DEBUG:radius:60 28 bc 7e 02 12 77 83 c4 96 76 0c 3d 6a 3a 36    `(.~..w...v.=j:6
DEBUG:radius:46 bd d1 12 94 83 04 06 01 01 01 01 01 0e 79 6f    F.............yo
DEBUG:radius:73 69 5f 69 5f 74 65 73 74 31 1a 12 00 00 00 09    si_i_test1......
DEBUG:radius:01 0c 6e 61 6d 65 3d 76 61 6c 75 65 18 25 33 32    ..name=value.%32
DEBUG:radius:53 65 73 73 69 6f 6e 49 44 3d 79 69 7a 61 71 2d    SessionID=yizaq-
DEBUG:radius:6c 6e 78 2f 38 35 33 32 34 33 31 39 2f 32 30 39    lnx/85324319/209
DEBUG:radius:3b 1b 06 00 00 00 5a 4f 31 02 7b 00 2f 19 80 00    ;.....ZO1.{./...
DEBUG:radius:00 00 25 17 03 01 00 20 07 3c 97 6c 84 21 f1 c7    ..%.... .<.l.!..
DEBUG:radius:f7 35 d3 5d 4f 9a a8 ef c0 7c 17 6e 23 a0 cf 95    .5.]O....|.n#...
DEBUG:radius:a2 df a9 35 05 88 c6 59 1f 02 50 12 3a 66 f9 8f    ...5...Y..P.:f..
DEBUG:radius:0f e5 17 44 e7 44 7d 45 6f 91 20 bc                ...D.D}Eo. .
INFO:radius:received RADIUS message
DEBUG:radius:02 09 00 c7 40 69 da ef 05 9b 05 c2 ba 52 95 a8    ....@i.......R..
DEBUG:radius:16 d3 d3 e4 01 0a 74 6c 73 75 73 65 72 30 19 1d    ......tlsuser0..
DEBUG:radius:43 41 43 53 3a 79 69 7a 61 71 2d 6c 6e 78 2f 38    CACS:yizaq-lnx/8
DEBUG:radius:35 33 32 34 33 31 39 2f 32 30 39 4f 06 03 7b 00    5324319/209O..{.
DEBUG:radius:04 50 12 2b d6 a6 35 51 03 fc 00 64 83 99 54 80    .P.+..5Q...d..T.
DEBUG:radius:cc 98 c7 1a 3a 00 00 01 37 10 34 e5 a9 ad e4 e0    ....:...7.4.....
DEBUG:radius:33 d4 27 0a 1f 38 4a c0 a3 3d 79 7d f9 d9 47 a1    3.'..8J..=y}..G.
DEBUG:radius:d9 1f 50 61 11 f1 43 5c 17 0f 7c 0c eb 2c b5 3e    ..Pa..C\..|..,.>
DEBUG:radius:4b 36 3b 44 6e 58 8a e6 67 85 e9 21 12 1a 3a 00    K6;DnX..g..!..:.
DEBUG:radius:00 01 37 11 34 87 bf c6 5a ae 86 ee 61 79 32 7c    ..7.4...Z...ay2|
DEBUG:radius:e4 b1 97 54 39 11 5a b3 3c 84 0a c6 30 a7 b6 2d    ...T9.Z.<...0..-
DEBUG:radius:7c 09 27 e8 6d 45 ec 23 88 19 f3 d5 c5 b7 02 51    |.'.mE.#.......Q
DEBUG:radius:cd 67 24 03 77 5e 4d                               .g$.w^M
INFO:radius:parsed RADIUS message
DEBUG:radius:RADIUS code: Access-Accept
DEBUG:radius:RADIUS identifier: 9
DEBUG:radius:RADIUS message length: 199
DEBUG:radius:RADIUS authenticator: 40 69 da ef 05 9b 05 c2 ba 52 95 a8 16 d3 d3 e4    @i.......R......
DEBUG:radius:    User-Name:
DEBUG:radius:        tlsuser0
DEBUG:radius:    Message-Authenticator:
DEBUG:radius:        2b d6 a6 35 51 03 fc 00 64 83 99 54 80 cc 98 c7    +..5Q...d..T....
DEBUG:radius:        
DEBUG:radius:    MS-MPPE-Send-Key:
DEBUG:radius:        e5 a9 ad e4 e0 33 d4 27 0a 1f 38 4a c0 a3 3d 79    .....3.'..8J..=y
DEBUG:radius:        7d f9 d9 47 a1 d9 1f 50 61 11 f1 43 5c 17 0f 7c    }..G...Pa..C\..|
DEBUG:radius:        0c eb 2c b5 3e 4b 36 3b 44 6e 58 8a e6 67 85 e9    ..,.>K6;DnX..g..
DEBUG:radius:        21 12                                              !.
DEBUG:radius:    MS-MPPE-Recv-Key:
DEBUG:radius:        87 bf c6 5a ae 86 ee 61 79 32 7c e4 b1 97 54 39    ...Z...ay2|...T9
DEBUG:radius:        11 5a b3 3c 84 0a c6 30 a7 b6 2d 7c 09 27 e8 6d    .Z.<...0..-|.'.m
DEBUG:radius:        45 ec 23 88 19 f3 d5 c5 b7 02 51 cd 67 24 03 77    E.#.......Q.g$.w
DEBUG:radius:        5e 4d                                              ^M
DEBUG:radius:    EAP-Message:
DEBUG:radius:        03 7b 00 04                                        .{..
DEBUG:radius:    Class:
DEBUG:radius:        CACS:yizaq-lnx/85324319/209
INFO:eap:received raw EAP message
DEBUG:eap:03 7b 00 04                                        .{..
INFO:eap:parsed incoming EAP message
INFO:eap:received EAP success
DEBUG:eap:sending back response []
INFO:eap:underlying EAP transport had closed
INFO:reactor:stopping reactor
---------- End run -----------



*/

id=__pez_eap_peap_challenge_response
			3.2.2.2 EAP, PEAP challenge response Configuration
- EAP-FAST GTC
ACS Challenge regexp: ^CHALLENGE=Password:.*$ 
response:             RESPONSE=user0\0kvvcc12#$ 

In case ACS sends another Challenge just add a regexp to deal with it.
ex: in case of wrong pwd ACS challenge will be: E=691 R=1 M=ERROR_AUTHENTICATION_FAILURE
So add ^E=691 R=1 M=ERROR_AUTHENTICATION_FAILURE$ as challenge and right pwd as response: RESPONSE=user0\0user0

Config file: pez_EAP_GTC_Authent_WrongPWD_OneRetryWithCorrectPWD_PAC_PROV_config
source: eapgtc.py
hook: eap_gtc_hook.py. 
To print challenge uncomment on_eap_gtc_challenge() line: print state.challenge
To print response uncomment on_eap_gtc_response() line: pprint.pprint( state.response.raw)

- PEAPV1.0 MSCHAP challenge is ^CHALLENGE=Password:.*$ 
- PEAPV1.0 GTC challenge is ^Password:.*$

- Note that if for example wront password challenge is same regexp (Password:) then you can always modify eap_gtc_hook.py to return right passowrd on 2nd attempt. See example:
i=0
def on_eap_gtc_response(state, notepad, point):
    # uncomment following line to print hook doc_string
    # --------------------------------------------------
    # print hooks.help(state)
    # --------------------------------------------------
    # uncomment following lines to print parameters
    # --------------------------------------------------
    pprint.pprint( state.response.raw)
    # --------------------------------------------------
    # uncomment following lines to modify outgoing EAP
    # GTC response 
    # --------------------------------------------------j
    #new_response = 'x' * 25 * 1024
    
    global i
    if (i >= 0) :
        new_response = "vvcc12#$"
        new_response_length = len(new_response)
        response_buff = create_string_buffer(new_response_length)
        struct.pack_into(
                '%ds' % new_response_length,
                response_buff,
                0,
           new_response)
        state.response = response_buff


    i+=1
    # --------------------------------------------------
    return 'ok'

			3.2.2.3

		3.2.3
	3.3 Real Device and switch 

-> Devices details - RAS: http://cd-acs-ras.cisco.com:8080/ras-new/
-> Protocol supplicants -> Test Protocols 18 
cd-sw-psup14 	Switch 		10.56.52.94 	nm-ts-s15.cisco.com:2004 
cd-acs-psup28 	XP 		10.56.52.58 	nm-kvm-s15.cisco.com:12

access:
supplicant:VNC: 10.56.52.58:5 acsi
Switch:telnet nm-ts-s15.cisco.com 2004  

		3.3.1  PEAP

			3.3.1.1  Switch

				3.3.1.1.1  Configure
-> Switch#sh running-config 
Building configuration...
...
radius-server host 10.56.13.134 auth-port 1812 acct-port 1813 key acsi
radius-server source-ports 1645-1646
...

Switch#sh run | i radius-server
radius-server host 64.103.112.44 auth-port 1812 acct-port 1813 key acsi   
radius-server source-ports 1645-1646

-> Configure AAA server
Switch#conf t
Switch(config)# no radius-server host 10.56.13.134 auth-port 1812 acct-port 18$
Switch(config)#radius-server host 64.103.112.44 auth-port 1812 acct-port 1813 key acsi           
Switch(config)#exit
Switch#wr mem
Building configuration...
[OK]
Switch#sh run
...
radius-server host 64.103.112.44 auth-port 1812 acct-port 1813 key acsi
radius-server source-ports 1645-1646
...




			3.3.1.2  Supplicant

If already configured then
-> Open CSSC
-> Connect to "wired"
-> Enter user name
-> PWD when prompted


Note, 
If ACS shows error:
"
Eap,27/01/2011,16:11:11:882,WARN ,43068336,cntx=0000001070,sesn=yizaq-lnx/85498649/19,user=yosi_i_test1,Client requested Authorization PAC, but Statless session resume is not allowed,EapFastTlv.cpp:644
EventHandler,27/01/2011,16:11:11:883,ERROR,43068336,caught exception while calling SessionCache: Method MethodCaller<SessionCache, MaxSessionsAznEvent>: The attribute with id [366] doesn't exist in attribute set [SESSION] in version [13],EventStack.cpp:218
"
Then disable fast reconnect
CSSC management->Next until you get to networks-> double click "wired" -> Next until you get to EAP-FAST and PEAP-> Configure, now:
Disable fast reconnect
Allow only EAP-MSCHAPv2

			3.3.1.3 ACS

-> Config network device
-> Config AD
-> ID policy, set AD ID store

			3.3.1.4 Shlomi's setup
		Shlomi Alfi:   
Supplicant: 10.56.52.60 12:20 PM 
VNC password: acsi  12:21 PM 
AP: 10.56.62.135  12:21 PM 
SSIP: Toyota  12:21 PM 
SSID  12:21 PM 
Yosi Izaq (yizaq - ENGINEER.SOFTWARE ENGINEERING):   
acs, acS100% 12:23 PM 
security-> server mgr  12:24 PM 
note for me   : enter radius ip: 64.103.112.44, apply, then change Admin Auth (RDS) to server IP 12:27 PM 
https://10.56.62.135 12:34 PM 
Shlomi, supp is configured to leap  12:34 PM 
how do I change to PEAP-MSCHAPv2? 
	
			3.3.1.5
		3.3.2 Odds and ends re. supplicants

			3.3.2.1 Change password

MSCHAP Failure packet has indication of occurred error and indication of allowed retry attempt:
•	E=648	( password expired )
•	R=0 – retry is not allowed, R=1 ( retry is allowed )

RFC differences:
•	RFC 2759  has scenario sequences with E=648 R=0
•	EAP-MSCHAPv2 draft has scenario sequences with E=648 R=1

Implementation differences:
•	ACS 4.1 implements E=648 R=0
•	ACS 4.2 implements E=648 R=1
•	ACS 5.0 implements E=648 R=0

Implications on different supplicants:
	PEAPv0	PEAPv1	EAP-FAST
CSSC 4.1	N/A	Yes: R=0 and R=1	Yes: R=0 and R=1
CSSC 5.1 
(doesn’t  work)	N/A	Yes: R=0 and R=1	Yes: R=0 and R=1
XP	Yes: R=0
No: R=1
Supplicant drops conversation upon receiving MSCHAP Failure with ‘password expired’ error	N/A	N/A
Funk	N/A	Yes: R=0
	Yes: R=0
Yes: R=1
Vista	Yes: R=0
R=1 not tested	N/A	Yes: R=0 and R=1

N/A – protocol not supported by supplicant



PEAPv0	PEAPv1	EAP-FAST
CSSC 4.2.2.6304
(on XP)	N/A	CPNC: +
CPV: +
AOP: +
ANP: +	CPNC: +
CPV: +
AOP: +
ANP: +
CSSC 5.1.0.39
(on XP)	N/A	No	No
XP 	CPNC: +
CPV: +
AOP: N/A, supplicant caches username/password and doesn’t prompt for it after successful authentication until reseted
ANP: N/A, the same reason	N/A	N/A
Funk 4.02.0.2000
(on XP)	N/A	CPNC: +
CPV: +
AOP: N/A, supplicant caches username/password and doesn’t prompt for it after successful authentication until reseted
ANP: N/A, the same reason	Provisioning only
CPNC: +
Supplicant’s bug: after entering a non-complaint password supplicant receives “change password failed” error but doesn’t ask for new password anymore however uses last entered non-complaint new password for authentication rather then the old one (the last known good). To stop this: restart the service. 
The same about entering wrong password
CPV: +
AOP: +
ANP: +
Vista	CPNC: +
CPV: +
AOP: +
ANP: +
Supplicant’s feature: after entering wrong password it drops the conversation instead of terminating it gracefully (in EAP-FAST it doesn’t happen)
	N/A	Version 2.2.9.0
CPNC: +
CPV: +
AOP: +
ANP: +


Flow:
CPNC: non compliant password
CPV: valid password
AOP: authentication with old password
ANP: authentication with new password


Bugs:
•	CSCsq84312 - PEAP - After failed 'Change password' user can not login
	After non comliant password supplicant doesn’t allow to perform change password. Happens on CSSC 5.1 and XP
	Seems the same as non-complaint password use case CPNC
	See note for Funk/Eap-Fast, is it the same case?
•	CSCsq93896 - PEAP - user can not authenticate after failed 'password change'
After entering old password incorrect supplicant doesn’t ask use anymore to change password
The same for CSSC 5.x against ACS 4.0.1.27
Seems like a CSSC 5.x problem. 
CSSC 4.2 doesn’ ask for old password
Funk asks for old password and doesn’t have such problem
Vista asks for old password and doesn’t have such problem
•	CSCsu08253 - Internal Usr. Authentication succeed with old password
Change password, then enter the old one and authentication is succeeded.
Ask Shlomi about it

Next steps:
•	Every supplicant doesn’t undertake a direct retry when password not compliant. Why?

			3.3.2.2 XP Supplicant
•	PEAP v0: remembers last login/password for a while and doesn't ask. Need to disable adapter, run ResetWirelessPass.exe utility and then enable adapter back
http://www.depts.ttu.edu/helpcentral/info/passwords/winxp_sp2_wireless_fix.php
•	Sometimes when server suggests it another protocol XP supplicant doesn’t send NAK but drops the conversation
•	During PEAP sends empty TLS message (like ACK) instead of TLS alert when server certificate validation failed

			3.3.2.3 TLS L bit for single fragment message

Supplicant	EAP-TLS	PEAP	EAP-FAST
Vista	no L		no L
CSSC 4.0	no L	all	all
CSSC 5.0	no L	all	all
XP	no L	no L inside the tunnel	N/A

Legend:
L – L bit and message field are used for single fragment
no L – no L bit and message field are used for single fragment
all – doesn’t matter

ACS 5.0: no L
ACS 4.2: while building the tunnel - L, when tunnel is built – no L

The decision for ACS 5.0 is to use “no L bit” for all cases

			3.3.2.4 PEAP version negotiated 

Supplicant	
Vista	
CSSC 4.0	no L	all	all
CSSC 5.0 always 1
XP
Funk always 1

			3.3.2.5 Stripping user name in UPN and NETBIOS formats

	PEAPv0	PEAPv1	EAP-FAST
CSSC 4.1	N/A		
CSSC 5.1 	N/A		
XP	•	Strips MSCHAP username for NETBIOS
•	Strips MSCHAP username for UPN
•	Doesn’t strip user identity for both	N/A	N/A
Funk	N/A		
Vista		N/A	


			3.3.2.6 PEAP Session resume/Fast reconnect

	PEAPv0	PEAPv1
CSSC 4.2.2.6304	N/A	•	Performs every authentication twice with about 5 seconds internval
•	When “Allow fast session resumption” is off, performs in first conversation full handshake, in the second – sometimes full, sometimes session resume (fast reconnect performed by server is acceptted)
Scenario:
full, full
full, full
full, short
full, short etc.
•	When “Allow fast session resumption” is on, performs once full handshake, then session resume (fast reconnect performed by server is acceptted)
full, short
full, short
full, short etc.

CSSC 5.1	N/A	•	When “Enable fast reconnect” is on - performs every authentication twice with about 5 seconds internval 
Scenario:
full, full
short,
full, shrot,
full, shrot etc
•	When “Enable fast reconnect” is off - performs every authentication once 
Scenario:
full, 
short,
shrot etc.
XP	•	always performs session resume
•	when server performs fast reconnect and it is disabled on supplicant – sends ResultTLV(Faulire) in protected termination	N/A
Funk	N/A	
Vista		N/A

SSID must be in single beacon mode to be connecta ble from Vista.


XP: 
•	PEAPv0 with inner EAP-MSCHAPv2 or EAP-TLS, fast reconnect
•	EAP-TLS

CSSC 5: 
•	EAP-FAST, anon & auth provisioning, PAC-based authentication, both with EAP-MSCHAPv2, EAP-GTC, EAP-TLS.
•	PAC-less with  EAP-MSCHAPv2, EAP-GTC, EAP-TLS
•	PEAP with  EAP-MSCHAPv2, EAP-GTC, EAP-TLS, fast reconnect
•	EAP-TLS
•	EAP-MD5

CSSC 4:
•	EAP-FAST, PAC-based authentication, with EAP-MSCHAPv2, EAP-GTC, EAP-TLS (anon & auth provisioning ?)
•	PEAP with EAP-MSCHAPv2, EAP-GTC, EAP-TLS

Funk 4.72:
•	EAP-MD5
•	EAP-FAST with anonymous only prov:EAP-MSCHAPv2 only, auth:EAP-GTC only
o	EAP-FAST auth/GTC – password change doesn’t work with ACS 4.2 and ACS 5.1 (supplicant cuts the conversation and doesn’t provide challenge)
o	Inner GTC: supplicant drops the conversation upon receivnng an error from ACS (more generic case of the previous issue)
•	PEAPv1 with EAP-MSCHAPv2 or EAP-GTC

Vista:
•	EAP-FAST, PAC-based authentication, with EAP-MSCHAPv2, EAP-GTC
•	PAC-less with EAP-MSCHAPv2, EAP-GTC
•	PEAP with EAP-MSCHAPv2 or EAP-TLS
•	EAP-TLS



Intel supplicant
•	EAP-FAST inner method failed (user disabled) the supplicant cuts the session (no response to inner EAP Failure)
 


EAP-FAST provisionig doesn’t match

	Provisioning 
	Anonymous enabled	Authenticated enabled
CSSC 4.1		
CSSC 5.1 	anonymous may be disabled
OK
acs: alert
client: ack
acs: eap failure	authenticated always enabled
XP	N/A	N/A
Funk	OK	OK
acs: alert
client: ack
acs: eap failure
Vista		



EAP-FAST Change Password challenge usage (what challenge supplicant uses when creating change password packet)

	Provisioning 	Authentication 
MS-CHAP	Authentication
GTC
	Anonymous	Authenticated		
	MS-CHAP	GTC	MS-CHAP	GTC		
CSSC 4.1	uses old server challenge (derived from MSK, the same was used for authentication) but new client challenge. Ignores new server challenge sent in change password packet					
CSSC 5.1 	uses new challenge but has a bug on password change, see next table					
XP	N/A	N/A	N/A	N/A	N/A	N/A
Funk	uses new challenge	N/A	N/A	N/A	N/A	no (supplicant cuts the conversation upon receiving password change request)
Vista	uses old challenge (derived from MSK, the same was used for authentication)		N/A	N/A		
Intel	uses new challenge					


Retry on bad password (E=691 R=1) in the same conversation:

	Provisioning 	Authentication 
MS-CHAP	Authentication
GTC
	Anonymous	Authenticated		
	MS-CHAP	GTC	MS-CHAP	GTC		
CSSC 4.1						
CSSC 5.1 
(doesn’t  work)						
XP	N/A	N/A	N/A	N/A	N/A	N/A
Funk	no (supplicant sends mschap failure upon receiving E=691 R=1)	N/A	N/A	N/A	N/A	no (supplicant cuts the conversation upon receiving E=691 R=1)
Vista						


PAC-less EAP-FAST

	Support PAC-less	TLS session resume for PAC-less
CSSC 4.1		
CSSC 5.1 	yes	no, supplicant sends tls session id = 0
XP	N/A	
Funk	N/A	
Vista	yes	no, supplicant sends only anonymous cipher suite list
Intel		


Expired PAC 

	
CSSC 4.1	doesn’t recognize alert “no shared cipher”
CSSC 5.1 	doesn’t recognize alert “no shared cipher”
XP	N/A
Funk	ok
Vista	doesn't recognize alert "no shared cipher"
Intel	


		3.3.3 Dot1x Setups Configuration, EDCS-798269 
Created by Oleg Pekar
With assistance of Alex Atlas, Golan Lavi
						
			3.3.3.1 Switch

				3.3.3.1.1 Debugging the switch
You can temporary enable the debugging of the switch to verify dot1x authentication from the supplicant.

Turn on dot1x debugging:
debug dot1x all

Restrict debug log to specific interface:
debug condition interface GigabitEthernet 1/0/13

Verify debugging condition:
show debugging

Condition 2: interface Gi1/0/14 (1 flags triggered)
        Flags: Gi1/0/14

Remove debugging condition:
no debug condition interface GigabitEthernet 1/0/13

Turn off dot1x debugging:
no debug dot1x all

				3.3.3.1.2 Configuring the switch
First of all disable and enable wired adapter on the supplicant to reveal its interface number on switch. You will see the following line appear on switch:

4w3d: %LINK-3-UPDOWN: Interface GigabitEthernet1/0/14, changed state to down
4w3d: %LINK-3-UPDOWN: Interface GigabitEthernet1/0/14, changed state to up

This is the number of interface. Could be referenced as g1/0/14 on switch

Then configure dot1x access on switch (specify your parameters instead of shown by italyc):
configure terminal 
aaa new-model
aaa authentication dot1x default group radius
aaa accounting dot1x default start-stop group radius
dot1x system-auth-control
interface GigabitEthernet1/0/13
  description *** dot1x ***
  switchport access vlan 172
  switchport mode access
  dot1x pae authenticator
  dot1x port-control auto
  dot1x timeout reauth-period server
  dot1x reauthentication

radius-server host 64.103.112.59 auth-port 1645 acct-port 1646 key acsi

Full configuration of switch with interfaces g1/0/13 and g1/0/14 configuredfor dot1x access should look like this (obtained by executing “show run” command):
show run
Building configuration...

Current configuration : 2491 bytes
!
version 12.2
no service pad
service timestamps debug uptime
service timestamps log uptime
no service password-encryption
!
hostname cd-sw-psup06
!
!
aaa new-model
aaa authentication login login-none none
aaa authentication dot1x default group radius
aaa accounting dot1x default start-stop group radius
!
aaa session-id common
switch 1 provision ws-c3750g-24t
system mtu routing 1500
vtp mode transparent
ip subnet-zero
!
ip dhcp pool net172
   network 172.16.1.0 255.255.255.0
   default-router 172.16.1.1
!
!
!
!
dot1x system-auth-control
no file verify auto
spanning-tree mode pvst
spanning-tree extend system-id
!
vlan internal allocation policy ascending
!
vlan 52,172
!
interface GigabitEthernet1/0/1
!
interface GigabitEthernet1/0/2
!
interface GigabitEthernet1/0/3
!
interface GigabitEthernet1/0/4
!
interface GigabitEthernet1/0/5
!
interface GigabitEthernet1/0/6
!
interface GigabitEthernet1/0/7
!
interface GigabitEthernet1/0/8
!
interface GigabitEthernet1/0/9
!
interface GigabitEthernet1/0/10
!
interface GigabitEthernet1/0/11
!
interface GigabitEthernet1/0/12
!
interface GigabitEthernet1/0/13
 description *** dot1x ***
 switchport access vlan 172
 switchport mode access
 dot1x pae authenticator
 dot1x port-control auto
!
interface GigabitEthernet1/0/14
 description *** dot1x ***
 switchport access vlan 172
 switchport mode access
 dot1x pae authenticator
 dot1x port-control auto
!
interface GigabitEthernet1/0/15
 description *** dot1x ***
 switchport access vlan 172
!
interface GigabitEthernet1/0/16
 description *** dot1x ***
 switchport access vlan 172
!
interface GigabitEthernet1/0/17
!
interface GigabitEthernet1/0/18
!
interface GigabitEthernet1/0/19
!
interface GigabitEthernet1/0/20
!
interface GigabitEthernet1/0/21
!
interface GigabitEthernet1/0/22
!
interface GigabitEthernet1/0/23
!
interface GigabitEthernet1/0/24
 description *** Switch Uplink ***
 switchport access vlan 52
!
interface Vlan1
 ip address dhcp
 shutdown
!
interface Vlan52
 ip address 10.56.52.86 255.255.255.0
!
interface Vlan172
 ip address 172.16.1.1 255.255.255.0
!
ip default-gateway 10.56.52.1
ip classless
ip http server
!
radius-server host 64.103.112.59 auth-port 1645 acct-port 1646 key acsi
radius-server source-ports 1645-1646
!
control-plane
!
line con 0
 privilege level 15
 login authentication login-none
line vty 5
 privilege level 15
 login authentication login-none
 rotary 30
line vty 6 15
!
end

To change radius server:
configure terminal
no radius-server host <old server IP> auth-port 1645 acct-port 1646 key acsi
radius-server host <new server IP> auth-port 1645 acct-port 1646 key acsi

				3.3.3.1.3 Configure REV on switch:
Enter the following commands:
configure terminal
mka policy my_policy
interface <mka interface>
switchport mode access
authentication linksec policy must-secure  
authentication port-control auto  
authentication timer restart 10  (optional)
mka policy my_policy  
dot1x pae authenticator

				3.3.3.1.4 Configuring clock on switch 
Enter the following command:
NTP server cd-acs-ntp  

				3.3.3.1.5 Loading image to switch
First copy the image to TFTP server (cd-acs-ftp)
Then enter the following commands on switch (to allow it automatically load specified image on next boot):
dir flash:
del flash:<image>
copy tftp flash
Addr of remote host: <IP address of tftp server>
     Src filename: <location of the image>
boot system flash:/<new image>
reload

				3.3.3.1.6 Configure Access Point
You can configure Access Point either from GUI or from console. This section describes the second option.

How to create new SSID ‘hugo’ and connect it to specific RADIUS server 64.103.112.59:

  conf t	
	radius-server host 64.103.112.59 auth-port 1812 acct-port 1813 key acsi
	
	aaa group server radius rad_eap_hugo
	   server 64.103.112.59 auth-port 1812 acct-port 1813
	
	aaa group server radius rad_acct_hugo
	   server 64.103.112.59 auth-port 1812 acct-port 1813
	
	aaa authentication login eap_methods_hugo group rad_eap_hugo
	aaa accounting network acct_methods_hugo start-stop group rad_acct_hugo
	
	dot11 ssid hugo
	   authentication open eap eap_methods_hugo
	   authentication network-eap eap_methods_hugo
	   accounting acct_methods_hugo
	
	interface Dot11Radio0
		 ssid hugo


				3.3.3.1.7 Configuring re-authentication on switch
To command the switch to cause re-authentication to supplicant (and so cause the supplicant to perform session resume):
	conf t
	int <interface> (for example int g1/0/14)
	sh (here switch indicates “Interface GigabitEthernet1/0/14, changed state to administratively down”
	no sh (here switch indicates “Interface GigabitEthernet1/0/14, changed state to up”) and supplicant should start re-authentication


			3.3.3.2 Supplicant GUI configuration

				3.3.3.2.1 Vista

Open “Connect to a network” dialog, right click on selected network, and choose properties. If there is no properties menu item – go to “Set up a connection or network” configure this network using the same SSID.  Afterwards, the properties button will appear


 

Setup PEAP settings

  

Press “Settings…” button
 

Press “Configure…” button
 

Now PEAP is configured. Start the conversation. Double click on desired network
 

See the dialog with additional info request. Double click on “Enter/select additional log on information”
 

Enter user credentials
 

Watch the connection progress
 


				3.3.3.2.2 XP native
Open “Network connections”, right-click on wireless connection and select “Properties”
 

Verify that there is no other supplicant software activated on this connection. If you found any – uncheck it, press “OK” and open “Properties” dialog again.
 

Press “Add” button to add desired network.
 

Enter network name (SSID)
 

Choose PEAP protocol for authentication. The press “Propertoes” button
 

Note: if you turn “Validate server certificate” on – you need to install CA for server certificate on supplicant’s computer
 


Troubleshooting

•	When you connect to a network for the first time, you will be prompted for your user credentials. XP will save the credentials you supply and use them for all future connections to the network. You can clear out the credential cache by editing the registry. Fire up the registry editor, and delete the HKEY_CURRENT_USER\Software\Microsoft\EAPOL\UserEAPinfo tree. 
•	Turn on tracing: Set HKEY_LOCAL_MACHINE\Software\Microsoft\Tracing\EAPOL\EnableFileTracing to 1. File path is specified in FileDirectiry value. Default location is <windows folder>/Tracing/eapol.log
•	If supplicant doesn’t connect try to remove the tree HKEY_LOCAL_MACHINE\Software\Microsoft\EAPOL\Parameters\Interfaces
•	Don’t use Remote Desktop to connect to supplicant. Use VNC instead since in Remote Desktop you will not see supplicant’s prompt for username/password.
•	For EAP-TLS import .p12 user certificate to Certificates\Current user\Personal\Certificates
•	For PEAP-TLS configure the connection then diable and enable it

Protocol specific implementation
•	When Server Certificate is untrusted, the supplicant sends empty TLS message (ack) instead of alert


				3.3.3.2.3 Funk Odyssey

a.	Disable Windows XP native supplicant on the adapter. Right click on network adapter, select “Properties” and uncheck “Use Windows...” checkbox
 

b.	Open Odyssey configuration dialog and start from binding to network adapter. Select “Adapters” item on the left and press “Add” button
 

c.	Select an adapter to add. Note that Odyssey sometimes doesn’t recognize the adapter type so always select “All adapters” to view the list
 

d.	Configure profile. Select “Profiles” item on the left and press “Add” button.

 

e.	Enter profile name (its convenient to use EAP protocol  name in profile name). Enter user name and choose options as shown below.
 

f.	Configure protocol. Using “Add” and “Remove” buttons configure desired protocol. It is recommended to specify single protocol.
 

g.	Configure inner method (for PEAP only). For EAP-FAST Odyssey uses predefined inner methods: EAP-MSCHAPv2 for provisioning and EAP-GTC for authentication.
 

h.	Configure network. Select "Networks" item on the left and press "Add" button
 

i.	Enter SSID name (exactly as specified on AP). Select profile created before.
 

				3.3.3.2.4 CSSC 5.1
| 10.	Run CSSC management utility. Press the "modify existing configuration profile" button.
|  
| 
| 
| 11.	Press next button
|  
| 
| 12.	Choose wired or wireless method
|  
| 
| 13.	Choose authentication methods on the right:
|  
| 
| 14.	Create a network. Press “add network” button
|  
| 
| 
| 15.	Choose wired network. Press next.
|  
| 
| 16.	Enter network name, select “Authenticating network” radio button.
|  
| 
| 
| 17.	Press next button:
|  
| 
| 18.	Choose “user connection” option
|  
| 
| 19.	Choose the protocol and press its “configure” button. Upon returning from protocol configuration press “next” button
|  
| 
| 20.	Configure PEAP
|  
| 
| •	Validate server identity ON – supplicant validates server certificate, you need to install the CA certificate that signed server certificate.
| •	Enable fast reconnect ON – enable PEAP fast reconnect option on
| •	Autheticate using a password – choose PEAP inner methof EAP-MSCHAPv2 or EAP-GTC
| 
| 21.	Configure user credentials
|  
| 
| 21.1.	Choose “prompt for credentials”
| 21.2.	Choose “Never remember”
| 
| Press “finish” button
| 
| 22.	Press “finish” button on final screen
|  
| 
| 23.	Open CSSC client dialog, right click on desired network and choose “connect exclusively”
 


					3.3.3.2.4.1 Install user certificate
 
					3.3.3.2.4.2 CSSC dot1x rev configuration
Wiki: http://wikicentral.cisco.com/confluence/display/PROJECT/Installation
Read instructions.doc provided in supplicant installation
Install cimd-macsec.zip


				3.3.3.2.5 Intel

					3.3.3.2.5.1 2User authentication

In the main supplicant window press “Profiles” button to create new profile
 


Press “Add” button 
 


Enter profile name and SSID and press “Next” button
 


Choose “Enterprise secuity”. Set “Network authentication” to Open, “Data Encryption” to WEP, select “Enable 802.1X”. Then specify protocol (e.g. EAP-FAST ), specify protocol parameters and press “OK” button
 


					3.3.3.2.5.2 Machine authentication

In main dialog’s menu choose “Tools->Administrator Tool”.
Enter the password:
  


Create (if you run it for the first time) or open existing administrator package:
  


From now you are aditing administrator package. It is an executable (in our example machine.exe)
Check “Include Profiles in this package”. Then add/edit authentication profiles as for user authentication.
 


At the end press “Close” button. Then select “Yes” to save changes:
 


Save the package somewhere. Then check “Apply this package to this computer:
 


					3.3.3.2.5.3 Removing EAP-FAST PAC
In profile configuration press “Select server” button
 


Then select the PAC you want to delete and press “Remove” button
 





 


			3.3.3.3 Features chart

				3.3.3.3.1 EAP-FAST

			Vista	XP native	Funk 4.72	CSSC 5.1	Intel
Anonymous provisioning	EAP-MSCHAP	Credential check	y	n	y	y	?
		Change password	y	n	y	y	?
	EAP-GTC	Credential check	n\a	n\a	n\a	n\a	n\a
		Change password	n\a	n\a	n\a	n\a	n\a
Authenticated provisioning	EAP-MSCHAP	Credential check	y	n	n	y	y
		Change password	y	n	n	y	?
	EAP-GTC	Credential check	y	n	n	y	y
		Change password	y	n	n	y	?
PAC-based authentication	EAP-MSCHAP	Credential check	y	n	n	y	y
		Change password	y	n	n	y	?
	EAP-GTC	Credential check	y	n	y	y	y
		Change password	y	n	n	y	n
PAC-less	EAP-MSCHAP	Credential check	y	n	n	y	n
		Change password	y	n	n	y	n
	EAP-GTC	Credential check	y	n	n	y	n
		Change password	y	n	n	y	n
machine authentication			y	yes, but tries to obtain Machine PAC on anonymous provisioning (impossible)	y	uses Tunnel PAC v1a for machine authentication	y
stateless session resume			y	n	?	y	n
invalid PAC fallback			y	n	n	y	n
TLS renegotiation (from provisioning to authentication)			y	n	n	n	n


				3.3.3.3.2 Other protocols and features

		Vista	XP native	Funk 4.72	CSSC 5.1	Intel
PEAPv0	EAP-MSCHAP	y	y	y	y	y
	EAP-GTC	n	n	?	y	?
PEAPv1	EAP-MSCHAP	n	n	y	y	y
	EAP-GTC	y	n	y	y	y
EAP-TLS		y	y	y	y	y
LEAP		y	n	y	y	y
EAP-MD5		n	n	y	y	n
Support of UTF-8 for username/password			radius username – yes, inner identity - no		y	

PEAP/EAP-MSCHAPv2: PEAPversion negotiation results and fast reconnect:
	Vista	XP native	Funk 4.72	CSSC 5.1	Intel
PEAP version
negotiated	PEAP v0	PEAP v0	PEAP v1	PEAP v1	PEAP v1
ACS 4.2 fast reconnect	no, unsupported by server	no, unsupported by server	yes	yes	yes
ACS 5.1 fast reconnect	yes	yes	yes	yes	yes




				3.3.3.3.3 ACS 4.2 Features
•	Doesn’t perform fast reconnect for PEAPv0/EAP-MSCHAPv2

			3.3.3.4 Behavior, Troubleshooting and Known Issues

				3.3.3.4.1 Vista

					3.3.3.4.1.1 Behavior and Troubleshooting
•	When you double-click on a wireless network in the list, supplicant uses the configured method for this network. To switch between user and machine authentication for the network:
o	Run “netsh wlan show profiles” to see wireless profiles names
o	Run “netsh wlan set profileparameter name=”<profile name>” authMode=machineOnly | userOnly | machineOrUser
o	For wired change “wlan” to “lan”
•	To perform machine authentication disable/enable network interface. But Vista selects the network for authentication in undefined way
•	When PEAP fast reconnect is disabled on supplicant but ACS starts fast reconnect – supplicant sends ResultTlv(Failure)

					3.3.3.4.1.2 Known Issues
•	Vista asks for Tunnel PAC v1a (instead of Machine PAC) when performing authentication of machine. To obtain Machine PAC you need to perform user authentication.

				3.3.3.4.2 XP native

					3.3.3.4.2.1 Behavior and Troubleshooting
•	Turn tracing on:
Set HKEY_LOCAL_MACHINE\Software\Microsoft\Tracing\EAPOL to 1
•	If supplicant doesn’t ask for user credentials you need to clear user info under
HKEY_CURRENT_USER\Software\Microsoft\EAPOL\UserEAPinfo 
•	If supplicant doesn’t connect try to delete this HKEY_LOCAL_MACHINE\Software\Microsoft\EAPOL\Parameters\Interfaces
•	Switch between machine and user authentication:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\EAPOL\General\Global
New DWARD value: name: AuthMode, value:2 (for machine auth) or 0 (for user auth) or 1 (for user & machine auth).
•	When PEAP fast reconnect is disabled on supplicant but ACS starts fast reconnect – supplicant sends ResultTlv(Failure)


				3.3.3.4.3 Funk Odyssey 4.72
•	Performs only anonymous EAP-FAST provosioning thus can’t perform EAP-FAST machine authentication with ACS 5.x

				3.3.3.4.4 CSSC 5.1

					3.3.3.4.4.1 Behavior and Troubleshooting

•	Turn tracing on:
Create file c:\acedebug.txt that contains text “0xffffffff” (10 bytes total). Reboot the machine. CSSC writes log into folder C:\Documents and Settings\All
Users\Application Data\Cisco\Cisco Secure Services Client\logs
•	If CSSC conducts successful conversation with ACS (ACS sends Access Accept) but CSSC doesn’t change state to “Connected” and starts another conversation – possibly DHCP is not correctly configured on supplicant/switch and CSSC is unable to aquire IP address after successful authentication.
•	When CSSC is installed on a computer with more then one network interfaces and management network interface is not the first (see the picture below), Windows gets the default gateway from another (for example dot1x) interface. It could be usually a fake address returned by dot1x swich. 
 

To fix this problem open the TCP/IP properties of management interface, press “Advanced” button and uncheck “Automatic metric” checkbox and specify “1” in “Interface metric” editbox.
 

•	Licenses: 

SAKQ-Y62P-OIWF-2T7L-2TNC-HRWQ-BXJZ-EEZR-P54R-PRKL-3NMH-VZQ7-XT3M-MF4O-JYM5-BBVY-LJP6-BPEC
 
or
 
ONDP-2NTR-CZL5-PHHF-4YVG-3HUD-6GTE-CLNC-BCD4-O43Z-M3LO-ENMH-FR3B-TZXQ-M6DZ-TGTV-IWO3-YKG2

•	For EAP-TLS import .p12 user certificate to Certificates\Current user\Personal\Certificates

					3.3.3.4.4.2 Known Issues

						3.3.3.4.4.2.1 EAP-FAST or PEAP with EAP-GTC against RSA
•	Simple PEAP/EAP-GTC passcode authentication. CSSC received AccessAccept from ACS but doesn't change state to connected and starts another conversation. Happens sometimes. ACS 5.1 and ACS 4.2.
•	Simple PEAP/EAP-GTC passcode authentication. When ACS sends the first inner PEAP/EAP-GTC message "Enter password" CSSC drops the conversation and starts the new one that is successful. However CSSCstill doesn't change state to connected (see issue #1). The first conversation will be seen in customer log as "Eap session timeout".
•	Simple EAP-FAST/EAP-GTC passcode authentication. When user enters invalid passcode, ACS sends error in format "E=eeeeeeeeee R=r M=<msg>" specified by RFC draft-zhou-emu-fast-gtc-05. CSSC displays the error message from <msg> field as prompt to user:
 
•	EAP-FAST-GTC against RSA: CSSC sends NAK TLV inside the tunnel to reject the conversation when user doesn’t enter the password for specific timeout 


				3.3.3.4.5 Intel 12.4.0.0

					3.3.3.4.5.1 Behavior and Troubleshooting
•	On EAP-FAST user PAC provisioning asks for Machine PAC also. On EAP-FAST user authentication asks for authorization PAC
•	To perforom machine authentication reboot the supplicant
•	Supplicant performs machine authentication on Windows boot, then accounting start for machine on user loging and accounting stop for machine on shutdown

					3.3.3.4.5.2 Known Issues
•	Doesn’t recognize EAP id = 0 so ACS 5.x avoids this value
•	Doesn’t support invalid PAC fallback and doesn’t remove PAC upon receiving of  servers’s TLS alert “bad certificate” in case of PAC is expired. Sends alert when ACS tries to perfrom fallback to full handshake. When PAC is expired it takes a couple of hours to stop unsuccessful authentications.



				3.3.3.4.6 Other
Supplicants installations location:
\\csi-filer01a\projects\embu-projects\emproj1\ACS-5.X-Test\Test_Tools\Supplicants\Vista


		3.3.4 EAP-TLS

			3.3.4.1 Test strategy, components

				3.3.4.1.1  Client, supplicant
Either a simulator (winRadius, pez) or a real supplicant (Windows native, CSSC etc.)

Note, WinRds is hard coded to:
A. Expect the CA certificate to be installed to Local Computer Certificate store
To do so:
- Launch MMC (start, mmc)
- ctrl-M (File -> Snap-in)
- Certificate -> user store
- Certificate -> computer store
Then double click the CA.cer to install it

B. Be given path to public key (.cer) & private key (.pvk) pair

				3.3.4.1.2 User, Machine
The user (or machine) to be authenticated should have a valide user certificate - say, user.cer
Clearly is should be validate via a chain of CA certificates, say CA_Cert.cer -> Intermediate_CA_Cert.cer -> Root_CA_Cert.cer  

				3.3.4.1.3 ID Store, CA
Say AD.
Use CA service for management, configuration & services of PKI.
Key points:

-> Get certificats, CRLS etc
https://[CA Server]/certsrv
Note, need to enable activx controls in order to enable the option to get the full certificate with the private key (.pfx as opposed to .cer - only public key)

-> Configure CA
Administrative tools -> Certificate Authority -> right click root CA for properties

-> Get CA trust chain
"Download CA certificate chain"
result: c:\Users\yizaq\Downloads\Issuer-2003CA_Chain.p7b 
Double click to open with certmgr
Navigate to Certificates folder
for each of the certificats in the chain do, export (as DER)

				3.3.4.1.4 ACS Server

					3.3.4.1.4.1 Define CA Certificate chain
Users and Identity Stores > 	... > 	Certificate Authorities -> Add CA Certificate
repeat for each CA certificate in the chain, say: CA_Cert.cer -> Intermediate_CA_Cert.cer -> Root_CA_Cert.cer  

					3.3.4.1.4.2 Extra configuration of CA Certificate 
Trust for client with EAP-TLS: check 4 EAP-TLS  

Download CRL: 	yes/no
CRL Distribution URL: enter URL 	
Retrieve CRL: 	Automatically X time before expiration. 
  	
  Every 
 
If download failed, wait X time before retry.
Bypass CRL Verification if CRL is not Received: 	
Ignore CRL Expiration: 	
					3.3.4.1.4.3

				3.3.4.1.5
			3.3.4.2


		3.3.5
	3.4 Logging


		3.4.1  Local store

			3.4.1.1  Configure passed attmepts to be sent to local store
System Administration > 	... > 	Configuration > 	Log Configuration > 	Logging Categories > 	Global > 	Edit: "Passed Authentications"

check Log to Local Target 	
		3.4.2

	3.5 Stress employer


		3.5.1  Configuration
For multiple users that follow a pattern (as in user0, user1, etc) check "use pattern" 
and enter user<IND>

for more options use help->user/pwd formats

		3.5.2 Nuts and Bolts
For EAP-FAST GTC to work you must work around Stress Employer bug so do:
a. Install ACS CA server cert
b. do EAP-FAST MSCHAP anonymous ("c:\work\acs\test tools\TestTools3_75\yizaq-lnx_AD_Canada_EAP_FAST_MSCHAP.sed" )
c. do EAP-FAST GTC authenticated ("c:\work\acs\test tools\TestTools3_75\yizaq-lnx_AD_Canada_EAP_FAST_GTC.sed" ) 
		3.5.3
	3.6

4. CARS

	4.1 Material
http://wwwin-eng.cisco.com/cgi-bin/edcs/edcs_info?EDCS-718393
c:\work\acs\5.3\CARS\CARS-Arch-TOI_3.ppt 

Note, CARS 1.x has moved from ACME to Subversion, hence to pull a CARS 1.2 workspace, do the following:

% svn co https://wwwin-svn-sjc.cisco.com/pmbu/cars/branches/cars_1x/

	4.2 Architecture

		4.2.1 CARS Overview
CARS - Common Application Runtime Services
CARS started as the common Linux for NMTG applications. It has since been adopted as the platform for the ACS Express 5.x, ACS View 4.x, ACS 5.x, and will eventually be the platform for PMBU’s new policy services product (Positron). 
CARS features include: 
IOS-like CLI shell, based on SAN OS Vegas shell, can be used as is, or extended by application teams 
Generic application interfaces for common tasks such as start/stop, backup/restore, status, and logging 

SNMP and CDP support 
File transfer for install, backup/restore, via remote 'repositories' 
SDK with Java and C APIs for applications to manage the appliance 
Firewall (iptables) with application interfaces 
Recovery image for password recovery or appliance re-image 
Support for CAM gen1 appliances, and VMWare ESX, IBM xseries, Cisco UCS on the roadmap.

CARS 1.0 – Developed in RTP and San Jose, used by ACS Express 5.0
CARS 1.1 – Development started in RTP, finished in San Jose, used by ACS View 4.0, ACS 5.0
CARS 1.2 – Development in San Jose, ACS 5.1/5.2
CARS 2.0 – Development in San Jose, used primarily by PMBU ISE and NMTG/WNBU Lumos.

		4.2.2 Block diagram


+----------------------------------------------------------------------------------------------------------------+
|                                                                                                                |
|                                                                                                                |
| +----------------+                          +-------------------+                                              |
| |                |  Applications            |                   |                                              |
| | ACS View 4     | ----------------------   | NAC Manager       |                                              |
| +----------------+                          +-------------------+                                              |
| +----------------+ +-----------------+      +-------------------+                                              |
| | ACS 5.x        | | ACS Express 5.x |      | CEPM              |                                              |
| +----------------+ +-----------------+      +-------------------+                                              |
+----------------------------------------------------------------------------------------------------------------+
|      CARS exposed components                                                                                   |
|      ------------------------------------------------------------                                              |
|                                                                                                                |
| +---------------------------------------------------------------------------+                                  |
| | Java & C APIs for CLI Functionality                                       |                                  |
| |                                                                           |                                  |
| +---------------------------------------------------------------------------+                                  |
|                                                                                                                |
| +--------------+   +------------------+     +-------------------------------+                                  |
| | Vegas Shell CLI  | SNMP             |     | Admin User Mgmt               |                                  |
| ---------------+   +------------------+     +-------------------------------+                                  |
|                                                                                                                |
|                                                                                                                |
| +--------------+   +------------------+     +-------------------------------+                                  |
| | Backup/Restor|   | NTP              |     | Appliance Bootstrap           |                                  |
| ---------------+   +------------------+     +-------------------------------+                                  |
|                                                                                                                |
| +--------------+   +------------------+     +-------------------------------+                                  |
| | CDP          |   | Scheduler        |     | File Transport                |                                  |
| ---------------+   +------------------+     +-------------------------------+                                  |
+----------------------------------------------------------------------------------------------------------------+
|                                                                                                                |
|        Base Linux Distribution (RHEL/CentOS)                                                                   |
+----------------------------------------------------------------------------------------------------------------+
|        Hardware (IBM/CAM/UCS)                                                                                  |
+----------------------------------------------------------------------------------------------------------------+

		4.2.3
	4.3 CLI

		4.3.1 Debug mode
-> Subject: Debug mode in CLI <- URGENT Please, read. 
Hi team 

One of our customers accidentally turned on CLI into debug mode using Spanish keyboard. Do you know how to turn it off?  
It’s a toggle.


-> The keypress is ESCAPE then ! to toggle on/off

		4.3.2

	4.4

5. Linux Dev box 

	5.1 Open debug logs

		5.1.1 Open management debug logs
go to /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib
there is  ManagementDebugLog.config file
try to mv  ManagementDebugLogEnable.config to  ManagementDebugLog.config and restart

see aliases:
[yizaq@yizaq-lnx:Sun Jan 09:/view/yizaq__yizaq_5_3.int.acs5_0.lx/vob/nm_acs/acs]$ grepa mgmt
alias open_acs_mgmt_debug_logs='sudo cp /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLogEnable.config  /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLog.config'
alias close_acs_mgmtrt_debug_logs='sudo cp /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLogDefault.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias read_acs_mgmt_debug_logs=' sudo vi /opt/CSCOacs/logs/ACSManagement.log'


		5.1.2 debug rt daemon
a. generate configuration file
sudo /opt/CSCOacs/runtime/bin/rt-generate-config.sh > /tmp/gen.xml

b. stop RT daemon
[yizaq@yizaq-lnx:Sun Jul 10:~]$ acs_monit_rt_down 
Password:
[yizaq@yizaq-lnx:Mon Jul 18:~]$ acs_monit_summary 
The monit daemon 4.9 uptime: 11m 

Process 'database'                  running
Process 'management'                running
Process 'runtime'                   not monitored
Process 'adclient'                  running
File 'nodeInfo.txt'                 accessible
Process 'view-database'             running
Process 'view-jobmanager'           running
Process 'view-alertmanager'         running
Process 'view-collector'            running
Process 'view-logprocessor'         not monitored
System 'yizaq-lnx'                  running

c. Edit run.sh script
/view/yizaq__yizaq_5_3_bugs2.int.acs5_0.lx/vob/nm_acs/acs/runtime/daemons/rt_daemon]$ vi dev-run.sh

modify to
#$ACS_RT_DIR/src/Debug/rt_daemon $GENFILE
/usr/bin/gdb $ACS_RT_DIR/src/Debug/rt_daemon 

d. Start daemon 
[yizaq@yizaq-lnx:Mon Jul 18:/view/yizaq__yizaq_5_3_bugs2.int.acs5_0.lx/vob/nm_acs/acs/runtime/daemons/rt_daemon]$ sudo ./dev-run.sh start 

e. Set config file and breakpoints, then start
(gdb) set args /tmp/gen.xml 

		5.1.3

	5.2

6. Cryptography

	6.1 PKI

		6.1.1 CRL

			6.1.1.1 Issuing Distribution Point

				6.1.1.1.1 openssl docs
Issuing Distribution Point

This extension should only appear in CRLs. It is a multi valued extension whose syntax is similar to the ``section'' pointed to by the CRL distribution points extension with a few differences.

The names ``reasons'' and ``CRLissuer'' are not recognized.

The name ``onlysomereasons'' is accepted which sets this field. The value is in the same format as the CRL distribution point ``reasons'' field.

The names ``onlyuser'', ``onlyCA'', ``onlyAA'' and ``indirectCRL'' are also accepted the values should be a boolean value (TRUE or FALSE) to indicate the value of the corresponding field.

Example:

 issuingDistributionPoint=critical, @idp_section

 [idp_section]

 fullname=URI:http://myhost.com/myca.crl
 indirectCRL=TRUE
 onlysomereasons=keyCompromise, CACompromise

 [issuer_sect]
 C=UK
 O=Organisation
 CN=Some Name

 
=head2 Certificate Policies.

This is a raw extension. All the fields of this extension can be set by using the appropriate syntax.

If you follow the PKIX recommendations and just using one OID then you just include the value of that OID. Multiple OIDs can be set separated by commas, for example:

 certificatePolicies= 1.2.4.5, 1.1.3.4

If you wish to include qualifiers then the policy OID and qualifiers need to be specified in a separate section: this is done by using the @section syntax instead of a literal OID value.

The section referred to must include the policy OID using the name policyIdentifier, cPSuri qualifiers can be included using the syntax:

 CPS.nnn=value

userNotice qualifiers can be set using the syntax:

 userNotice.nnn=@notice

The value of the userNotice qualifier is specified in the relevant section. This section can include explicitText, organization and noticeNumbers options. explicitText and organization are text strings, noticeNumbers is a comma separated list of numbers. The organization and noticeNumbers options (if included) must BOTH be present. If you use the userNotice option with IE5 then you need the 'ia5org' option at the top level to modify the encoding: otherwise it will not be interpreted properly.

Example:

 certificatePolicies=ia5org,1.2.3.4,1.5.6.7.8,@polsect

 [polsect]

 policyIdentifier = 1.3.5.8
 CPS.1="http://my.host.name/";
 CPS.2="http://my.your.name/";
 userNotice.1=@notice

 [notice]

 explicitText="Explicit Text Here"
 organization="Organisation Name"
 noticeNumbers=1,2,3,4

The ia5org option changes the type of the organization field. In RFC2459 it can only be of type DisplayText. In RFC3280 IA5Strring is also permissible. Some software (for example some versions of MSIE) may require ia5org. 

				6.1.1.1.2 Description

The issuing distribution point is a critical CRL extension
that identifies the CRL distribution point and scope for a
particular CRL, and it indicates whether the CRL covers
revocation for end entity certificates only, CA
certificates only, attribute certificates only, or a limited
set of reason codes.
issuingDistributionPoint ::= SEQUENCE {
distributionPoint [0] DistributionPointName OPTIONAL,
onlyContainsUserCerts [1] BOOLEAN DEFAULT FALSE,
onlyContainsCACerts [2] BOOLEAN DEFAULT FALSE,
onlySomeReasons [3] ReasonFlags OPTIONAL,
indirectCRL [4] BOOLEAN DEFAULT FALSE,
onlyContainsAttributeCerts [5] BOOLEAN DEFAULT FALSE
}

				6.1.1.1.3 From Safari
->
Issuing Distribution Point indicates the name of the CRL Distribution Point (if any) and the types of certificates contained within the CRL (for example, end-user certificates only, CA certificates only, and/or certificates revoked for a specific reason only). When applicable, it indicates that the CRL is an indirect CRL. (Additional information on indirect CRLs is provided later in the chapter.) Note that this extension, if present, must be marked critical in accordance with X.509. Even though this extension must be marked critical, RFC3280 does not require conforming implementations to support this extension.

-> 
Certification Authority Revocation Lists (CARLs)

A CARL, as its name implies, is a CRL devoted exclusively to revocation information that is associated with CAs. Thus, by definition, CARLs do not contain end-user certificate revocation information. A CARL is identified using the Issuing Distribution Point and/or CRL Scope extension(s).

CARLs are used to revoke the public-key certificates of other CAs. The issuer of a CARL is typically either a superior CA (that is, it is responsible for revoking any subordinate CAs) or the issuing CA is revoking a cross-certificate issued by that CA. (The concepts associated with superior, subordinate, and cross-certified CAs are discussed further in Chapter 9.) Support for indirect CARLs is also possible. When validating a certificate path, a valid CARL must be available for each CA that has signed one or more certificates in that path. (This does not apply to self-signed CA certificates.) In general, revocation of CA certificates will be an exception rather than the rule.[3] Thus, the list of revoked certificates on a CARL will typically be absent or relatively small, making the overhead associated with retrieving CARLs minimal.

    [3] Revocation of CA certificates is expected to be quite rare. Generally, a CA certificate need only be revoked when it is decommissioned or when compromise of the CA's private key is known or suspected. Note also that in a strict rooted hierarchy, revocation of any given superior CA impacts all subordinate CAs and all end entities that fall under any of the affected CAs. The “higher” in the tree the revocation occurs, the more widespread the effect. Cross-certification has the distinct advantage that revocation of any given CA does not impact the internal operation of any other CA domain. These concepts are discussed further in Chapter 9.

End-entity Public-key Certificate Revocation Lists (EPRLs)

An EPRL, the converse to the CARL, is a CRL devoted exclusively to revocation information that is associated with end entities. Thus, by definition, EPRLs do not contain revocation information associated with CAs. An EPRL is identified using the Issuing Distribution Point and/or CRL Scope extension(s).

A single EPRL could contain all the end entity revocation information for a given PKI domain, or it could be partitioned in a variety of ways, as discussed further in the following pages.

-> 
CRL Distribution Points

CRL Distribution Points (sometimes referred to as Partitioned CRLs) allow revocation information within a single CA domain to be posted in multiple CRLs. CRL Distribution Points have two significant benefits over complete CRLs:

   a.  The revocation information can be subdivided or partitioned into more manageable pieces to avoid the proliferation of voluminous CRLs.
   b.  The certificates can point to the location of the CRL Distribution Point, so the relying party doesn't need to have prior knowledge of where the revocation information for a particular certificate might reside.

Thus, the syntax of the CRL Distribution Point extension enables one to identify the specific location of the corresponding CRL partition. For example, a CRL Distribution Point can identify a specific server (for example, using a DNS name or IP address), as well as the specific location within that server where the CRL partition can be found (for example, a specific location within a Directory Information Tree [DIT] of a public repository or the name of a file resident on a Web server). Figure 8.3 illustrates the notion of a CRL Distribution Point.

Figure 8.3. CRL Distribution Point.


In summary, CRL Distribution Points offer a much more scalable alternative as compared with complete CRL postings. They can also be used to alleviate the performance issue when combined with proper partitioning and caching. However, one criticism levied against the use of CRL Distribution Points is that the CRL partitions are fixed or static. The notion of a more dynamic partitioning scheme is discussed next.
Redirect CRLs

One drawback associated with the use of CRL Distribution Points is that once the associated certificate is issued, the CRL partition pointed to by the CRL Distribution Point is fixed for the life of that certificate. It also implies that the issuing CA has a prior knowledge regarding how the CRL information should be partitioned and that this partitioning cannot change over time. However, it may be desirable to make this more flexible, so the CRL partition sizes and storage locations may vary over time (for example, to optimize performance as the size and/ or needs of the PKI community fluctuate).

Further, partitioning strategies could be based on a number of elements, including certificate serial number ranges, revocation reasons, certificate types, name subtrees, or any other range criteria that might apply to CRL information. It is therefore desirable to define new CRL extensions that would permit this more flexible and dynamic partitioning capability.

Members of the IETF PKIX working group developed the notion of dynamic partitioning, and these concepts were formally standardized in the 2000 version of X.509 [X509-00] through the definition of the CRL Scope and Status Referral extensions. The Status Referral extension provides a capability to “redirect” a relying party to the appropriate CRL. In other words, Status Referral can “point to” another location where the target CRL information actually resides. This intermediate CRL is referred to as a Redirect CRL.

As illustrated in Figure 8.4, the CRL Distribution Point certificate extension points to the Redirect CRL, and the Redirect CRL contains a Status Referral extension that points to the appropriate target CRL. Note that consistency checks are made along the way to prevent spoofing attempts such as CRL-substitution attacks. Also note that the Redirect CRL does not actually contain a list of revoked certificates. A Redirect CRL provides pointers only to target CRLs. This allows partitions to be changed over time without impacting the existing certificates. (Specifically, the CRL Distribution Point within the certificates need not change even if the CRL partitioning scheme happens to change.)

Figure 8.4. Redirect CRL orientation.


It is possible that this redirect process could be iterative, but this must be tempered with the additional performance overhead that would be incurred through multiple retrievals of the redirect information. In general, it is expected that one level of indirection will be sufficient.

The CRL Scope extension syntax is similar to the existing Issuing Distribution Point extension syntax, but it adds several new attributes such as the name of the CA (necessary if different from the issuer of the referral), specified ranges such as serial number range or subject public-key identifier range, and subtree name constraints. Given that the Issuing Distribution Point extension and the CRL Scope extension may contain overlapping fields (for example, they both can identify the Distribution Point name, and they both can contain the Only Contains User Certs, Only Contains Authority Certs, and Only Some Reasons flags), it is possible that the two extensions can conflict with one another. As such, these two extensions are not meant to be used together. However, as this is not explicitly prohibited, care must be exercised to ensure consistency between them if they both are used.

-> 
Indirect CRLs

Indirect CRLs enable revocation information normally supplied from multiple CAs to be issued within a single CRL. Indirect CRLs can be used to reduce the number of overall CRLs that need to be retrieved by relying parties when performing the certificate validation process. For example, a single PKI domain may have several CAs. Rather than force a relying party to retrieve multiple CRLs (one for each CA), the domain may decide to improve efficiency by combining all of that domain's certificate revocation information into one Indirect CRL. This may also prove useful in interdomain scenarios, to reduce traffic load and cost. There is also the possibility that trusted third-party service providers might offer this capability as a for-fee service. In all cases, the relying party must trust the Indirect CRL issuer to the same degree that they trust the CA issuing the certificate in question.

One way to determine if a CRL is an Indirect CRL is to examine the Indirect CRL component in the Issuing Distribution Point extension. If it is set to TRUE, then the CRL may contain revocation information from multiple sources. The Certificate Issuer component associated with each revocation entry is used to determine the associated issuer. For implementations that are compliant with the 2000 version of X.509, Indirect CRLs can also be supported through the presence of multiple Per Authority Scopes with different CA names specified in the Authority Name component.

The X.509 standard does not specify how revocation information is to be conveyed between the individual CAs and the CA issuing the Indirect CRL. However, it might be reasonable for the generator of the Indirect CRL to collate revocation information based on individual CRLs issued by each CA. This would allow an existing standard mechanism to be exploited, and it would still have the benefit of reducing the number of CRLs that each relying party must download. The reasonable assumption here is that the number of relying parties will far exceed the number of Indirect CRL issuers. However, the realized benefit is based on a number of factors, including assurance that the Indirect CRL does not become so large as to counter the performance benefit expected through combining revocation information from multiple sources.

				6.1.1.1.4 How to test ACS compatibility?


					6.1.1.1.4.1 Certificate Enrollment

Use the following procedure to request a certificate from the Certificate Services Web Enrollment pages:

|    1.  Open Internet Explorer.
|    2.  In Internet Explorer, open the URL http://CertServerDNS/certsrv (where CertServerDNS is the Domain Name System [DNS] name of the Windows Server 2003 CA).
| 
|       Note:
| 
|       The Certificate Server's DNS name should be added to the Local intranet site at all computers. If the Web site is not added to the Local intranet site, users are prompted for their user name and password. The process of adding the DNS name to the Local intranet site is described in Chapter 15.
|    3.  On the Welcome page, click the Request a certificate link.
|    4.  On the Request a Certificate page, click the Advanced Certificate Request link.
| 
|       Note:
| 
|       This page only appears if the User certificate template is published at the CA. If the User certificate template is not published, step 4 does not occur.
|    5.  On the Advanced Certificate Request page, click the Create and Submit a Request to this CA link.
|    6.  On the Advanced Certificate Request page (see Figure 12-2), you can define the following options for the certificate request:
| 
|       Figure 12-2. The Advanced Certificate Request page
| 
|           * Certificate template drop-down list. Lists the certificate templates for which the user is assigned Read and Enroll permissions.
|           * Key set. Allows you to choose between generating a new key set or using the existing key set.
|           * CSP drop-down list. Allows you to select a CSP installed on the client computer to use for the certificate request.
|           * Key size. The length of the key pair generated for the certificate request.
|           * Container name. The key container where the certificate's key pair is stored.
|           * Export options. Allows you to request that the certificate's private key be exportable.
|           * Strong key protection. Requires a password each time the certificate's private key is accessed.
|           * Store certificate in the local computer store. Enable this option for computer certificates only, not for user certificates.
|           * Request format. You can choose between Certificate Management Message over Cryptographic Message Syntax (CMC) or Public Key Cryptography Standards (PKCS) #10 request formats. CMC is required for digitally signed requests and key archival requests.
|           * Friendly name. A logical name assigned to the certificate. This name is not part of the certificate. Rather, it is the logical display name when the certificate is viewed with Microsoft tools that can be changed without invalidating the signature applied to the certificate.
| 
|       Note:
| 
|       The default values shown on the Advanced Certificate Request page are based on the values defined in the certificate template.
|    7.  Once all options are defined, click Submit on the Advanced Certificate Request page.
|    8.  In the Potential Scripting Violation dialog box, allow the Web site to request a certificate on your behalf by clicking Yes.
|    9.  On the Certificate Issued page, click the Install this Certificate link.
|   10.  In the Potential Scripting Violation dialog box, accept that the Web site is adding a certificate to your computer by clicking Yes.
|   11.  Ensure that the Certificate Installed page appears, indicating that the certificate has installed successfully.
|   12.  Close Internet Explorer.

Note: Microsoft Knowledge Base Article "Flaw in Certificate Enrollment Control May Cause Digital Certificates to Be Deleted" describes the MS02-048 security update, which introduced the Potential Scripting Violation dialog box. This dialog box warns the user anytime a certificate request is submitted to a CA or a CA-issued certificate is installed in the user's store.

Example:
a. https://10.56.60.46/certsrv
b. give user/pwd
c. Request a certificate
d. choose params and install it

					6.1.1.1.4.2 CRL, Certificate Revocation

# At a command prompt, type: certutil -revoke 06E373C0000000000002
# In the Certification Authority console, right-click the certificate. Select AllTasks, Revoke Certificate.

					6.1.1.1.4.3 CA configuration files

During the installation of each CA in the CA hierarchy, there are configuration files that are used to tailor each CA’s configuration. These configuration scripts include:

    * CAPolicy.inf Provides Certificate Services configuration information, which is read during initial CA installation and whenever you renew a CA certificate.
    * Pre-installation configuration batch files When installing subordinate CAs in a multi-tier CA hierarchy, you must manually install your root CA certificate so that the subordinate CA considers the root CA to be a trusted root CA. In addition, you may have to install subordinate CA certificates and root and subordinate CA certificate revocation lists (CRLs) to allow revocation checking during the subordinate CA installation.
    * Post-installation configuration batch files Once Certificate Services is installed, you can complete configuration by scripting several Certutil.exe commands. The benefit of using the certutil commands in a batch file is that the configuration is reproducible, and it allows you to validate the configuration and fix any errors.

The following sections provide details and recommendations for each of the configuration file types.
CAPolicy.inf File

The CAPolicy.inf file defines settings specific to root CAs as well as settings that affect all CAs in the CA hierarchy. The CAPolicy.inf file provides the following information for a root CA:

    * Certificate revocation list (CRL) publication points When validating a certificate chain, the certificate chaining engine must validate every certificate in the chain. Rather than using the default CRL publication points, you can define custom revocation points based on your network’s configuration. The actual order of the publication points is important because a client attempts to retrieve the CRL in the order specified in the CAPolicy.inf file.
    * CA certificate publication points The certificate chaining engine might have to download the root CA’s certificate. This section of the CAPolicy.inf file defines the publication points for the root CA’s certificate. The actual order of the publication points is important because a client attempts to retrieve the CA certificate in the order specified in the CAPolicy.inf file.
    * Enhanced Key Usage The CAPolicy.inf file can limit the application purposes of certificates issued by the CA. For example, if you limit the CA to issuing certificates for client authentication, server authentication, or secure e-mail, the CA cannot issue any certificates for the purpose of code signing.
    * The renewal configuration The CAPolicy.inf defines the renewal key length and validity period for the root CA’s certificate. Typically, this section of the CAPolicy.inf file is configured to match the initial key length and validity period defined for the root CA. Matching the initial key length and validity period ensures that the designed settings are not modified when the CA’s key pair is renewed.

Note

	

You can designate the cryptographic service provider (CSP) used by the CA only at installation time. You cannot change the CSP by modifying the CAPolicy.inf file.

The CAPolicy.inf file is also used in the installation of subordinate CAs in the hierarchy. The following settings in the CAPolicy.inf file can be defined for both root and subordinate CAs:

    * Certification practice statement (CPS) information The CPS defines the operating procedures and practices employed at the CA as well as at subordinate CAs, which enforce the certificate policies implemented at the CAs. The CPS is typically applied at:
          o The root CA in a single-tier CA hierarchy.
          o The combination policy CA/issuing CA in a two-tier CA hierarchy.
          o The policy CAs in a three-tier CA hierarchy.

      Note A CPS is considered to be effective for the CA in which the CPS is defined and for all subordinate CAs.  
    * CRL publication interval The base CRL is published at the interval specified in the CAPolicy.inf file.
    * Delta CRL publication interval The delta CRL is published at the interval specified in the CAPolicy.inf file. If the interval is specified as a value of zero, the publication of delta CRLs is disabled at the CA.
    * Basic constraints Limitations can be set on the number of certificates allowed below the CA in which the CAPolicy.inf file is defined. Basic constraints protect against complex hierarchies that implement long certificate chains. A basic constraint also indicates whether the certificate is issued to a CA or to an end entity other than a CA.

Creating the CAPolicy.inf File

By default, the CAPolicy.inf file does not exist when you install Windows Server 2008. You must manually create the file in the Microsoft Windows operating system folder (%Windir% folder). When you install Certificate Services, the operating system applies any settings defined in the CAPolicy.inf file.

Warning Be sure the file is named CAPolicy.inf and is stored in the %Windir% folder. It is a common mistake to create the file in Notepad and save the file as CAPolicy.inf.txt. To prevent this, change the file type to All Files from the default of Text Documents (*.txt).

Sample CAPolicy.inf Contents

You can implement specified settings when you create a CAPolicy.inf file, depending on which CA in the CA hierarchy you apply the file to. A template for the CAPolicy.inf file follows:
[Version]
Signature= "$Windows NT$"

[PolicyStatementExtension]
Policies = LegalPolicy
Critical = 0

[LegalPolicy]
OID = 1.3.6.1.4.1.311.21.43
Notice = "Legal policy statement text."
URL = "http://www.example.com/certdata/cps.asp"

[AuthorityInformationAccess]
Empty = true ; Required only for Windows Server 2003
;URL = http://%1/Public/My CA.crt
;URL = file://\\%1\Public\My CA.crt
Critical = true

[CRLDistributionPoint]
Empty = true; Required only for Windows Server 2003
;URL = http://%1/Public/My CA.crl
;URL = file://\\%1\Public\My CA.crl
Critical = true

[EnhancedKeyUsageExtension]
OID = 1.3.6.1.4.1.311.21.6 ; szOID_KP_KEY_RECOVERY_AGENT
OID = 1.3.6.1.4.1.311.10.3.9 ; szOID_ROOT_LIST_SIGNER
OID = 1.3.6.1.4.1.311.10.3.1 ; szOID_KP_CTL_USAGE_SIGNING
Critical = false
[basicconstraintsextension]
pathlength = 3
critical=true

[certsrv_server]
renewalkeylength=2048
RenewalValidityPeriodUnits=20
RenewalValidityPeriod=years
CRLPeriod = days
CRLPeriodUnits = 2
CRLDeltaPeriod = hours
CRLDeltaPeriodUnits = 4
LoadDefaultTemplates=0

					  


More Info 
A sample CAPolicy.inf file is included with the materials related to this chapter on the companion CD-ROM.

CAPolicy.inf File Sections

Within the CAPolicy.inf file, there are several predefined sections, each of which defines specific settings for Certificate Services. These sections and related decisions regarding their contents are outlined here. Also outlined is whether the section applies to root CA installations, subordinate CA installations, or to both root and subordinate CA installations.
[Version]

The [Version] section specifies that the INF file uses the Microsoft Windows NT format. This section must exist for both root and subordinate CA installations. It contains a single line:

Signature= "$Windows NT$"


[PolicyStatementExtension]

The [PolicyStatementExtension] section defines a CA’s CPSs and certificate policies. This section’s inclusion depends on the number of tiers in the CA hierarchy.

In a single-tier CA hierarchy, the [PolicyStatementExtension] and related [PolicyName] sections are defined at the root CA. In a two-tier CA hierarchy, you should include the [PolicyStatementExtension] and related [PolicyName] sections at each issuing CA in the hierarchy. In a three-tier CA hierarchy, the [PolicyStatementExtension] and related [PolicyName] sections are typically defined at the policy CAs on the second tier. If different CPSs are required, separate policy CAs are deployed in the CA hierarchy.

In the [PolicyStatementExtension] section, you define one or more subsections that will follow. Within the subsections, you define a minimum of three settings:

    * Object identifier (OID). An object identifier can be applied to each CPS. The OID is an identifier that is tied to the CPS or, if multiple policies are defined, to each CA’s certificate policy.

Note 
There is a practical limit to the number of certificate policies that can be included in a CA certificate. The Active Directory Domain Services (AD DS) schema allows only a maximum string length of 4,096 bytes for all CPS information, including OID, notification text, and URL. The total length of the certificate policy entries must be less than 4,096 bytes.

Where Do I Get an OID?

An OID is a unique sequence of numbers that identifies a specific directory object or attribute. You can define an OID for a CPS as either a public OID or a private OID.

If your organization plans to use PKI-enabled applications in conjunction with other organizations, you must obtain an OID from a public number-assignment company to ensure that your OID will be unique on the Internet. Sources for public OIDs include:

    * The Internet Assigned Numbers Authority (IANA) This source issues free OIDs under the Private Enterprises arc. Every OID assigned by the IANA begins with the numbers 1.3.6.1.4.1, which represent iso(1).org(3).dod(6).internet(1).private(4).enterprise(1).

      Note 
      An arc is the term used to reference a specific path in the global OID tree maintained by the International Organization for Standardization (ISO) and the International Telecommunication Union (ITU). This global OID tree is sometimes referred to as the joint ISO/ITU-T tree. For example, the Private Enterprises arc contains all OIDs that begin with 1.3.6.1.4.1.

    * The American National Standards Institute (ANSI) This source issues OIDs for purchase under the United States organizations arc of the ANSI OID tree. Every OID assigned by the ANSI begins with the numbers 2.16.840.1, which represent joint-iso-itu-t(2).country(16).US(840).US company arc(1). Fees include acquisition fees for the OID arc and search fees to determine if your organization already owns an OID arc.
    * Other countries Each country has its own OID-management organization. The easiest way to find the organization for a given country is to perform an Internet search with the search phrase Country (where Country is the name of the given country) and “Object Identifier.” Here are some examples of the arcs available within the joint ISO/ITU-T tree:
          o Canada: joint-iso-itu-t(2).country(16).canada(124)
          o Netherlands: joint-iso-itu-t(2).country(16).netherlands(528)
          o Switzerland: joint-iso-itu-t(2).country(16).switzerland(756)
          o Thailand: joint-iso-itu-t(2).country(16).thailand(764)

You can also generate a private OID based on your forest’s GUID within the Microsoft IANA-assigned tree. If you decide to use these OIDs, you will have an OID assigned from 1.3.6.1.4.1.311.21.8.a.b.c.d.e.1.402 (where a.b.c.d.e is a unique string of numbers based on your forest’s GUID).

Note 
Use this private OID tree only if you do not foresee using the OIDs in conjunction with other organizations, and your organization is unwilling to obtain a free OID from the IANA. If you plan on using PKI-enabled applications within other organizations, obtain a free OID tree from the IANA, or buy a tree from the ANSI.

Tip 
You can obtain your forest’s private OID by opening the Certificate Templates (certtmpl.msc) console as a member of the Enterprise Admins group. In the console tree, right-click Certificate Templates, and then click View Object Identifiers. In the resulting dialog box, choose the High Assurance Object Identifier, and then click the Copy Object Identifier button. Once you copy the OID, you can plug your forest’s values into the placeholders a.b.c.d.e and remove any trailing digits.


    * Notice The Notice line provides the text that appears when a user clicks the Issuer Statement button when the CA’s certificate is displayed. The Issuer Statement is typically the title of the CPS and does not display any details about the CPS. Remember that you are limited to a total of 4,096 bytes of data in the Certificate Policies extension. Including the entire CPS in the Notice line will result in a very large CA certificate because the entire text of the CPS is included in the CA certificate.
    * URLs Multiple URLs can be provided for the CPS. The URLs provide links to the actual text of the CPS. When you view the Notice text, clicking More Info opens a browser window that displays the content of the URL specified in the URL line. Typically, the URL is a Hypertext Transfer Protocol (HTTP) URL.

[AuthorityInformationAccess] and [CRLDistributionPoint]

The typical strategy for root CAs is to not publish CA certificate and CRL retrieval URLs in the root CA’s certificate. By excluding the Authority Information Access (AIA) and CRL Distribution Point (CDP) extensions from the root CA certificate, you block the certificate chaining engine from checking the root CA certificate’s revocation status. The root CA certificate is designated as trusted by adding the certificate to the trusted root CA store at client computers. Most applications do not check revocation status of the root CA certificate unless it contains a CDP extension. Removing the AIA and CDP extensions from the root CA certificate ensures that all applications bypass revocation checking on the root CA certificate.

In Windows Server 2003, you had to include the following lines in your CAPolicy.inf file to prevent the inclusion of the AIA and CDP extensions in the root CA certificate:

[AuthorityInformationAccess]
Empty = true

[CRLDistributionPoint]
Empty = true


Note 
Alternatively, you can exclude the Empty = true lines from each section. The inclusion of the [AuthorityInformationAccess] and [CrlDistributionPoint] sections in the CAPolicy.inf file will prevent the inclusion of the AIA and CDP extensions in the root CA certificate.

The [AuthorityInformationAccess] and [CRLDistributionPoint] sections specify the publication points for a root CA’s certificate and CRL. These sections are disregarded by subordinate CAs because the CRL and CA certificate distribution points are defined in the configuration of the parent CA, not at subordinate CAs.

In Windows Server 2008, the default behavior is different. When you install a root CA, the default is to create a root CA certificate with no CDP and AIA extensions.

If you decide to define AIA and CDP URLs for the root CA certificate, you can use predefined variables rather than coding the actual URLs. Windows Server 2003 provides the variables shown in Table 6-1 for defining AIA and CDP URL paths.

Table 6-1. AIA and CDP Variable Definitions
Variable	Name	Description
%1	ServerDNSName	The CA computer’s Domain Name System (DNS) name
%2	ServerShortName	The CA computer’s NetBIOS name
%3	CA Name	The CA’s logical name
%4	CertificateName	The name of the CA’s certificate file
%5	Domain DN	Not used in the Windows Server 2003 PKI
%6	ConfigDN	The Lightweight Directory Access Protocol (LDAP) path of the forest’s configuration naming context for the forest
%7	CATruncatedName	The CA’s “sanitized” name
%8	CRLNameSuffix	The CRL’s renewal extension
%9	DeltaCRLAllowed	Indicates whether delta CRLs are supported by the CA
%10	CDPObjectClass	Indicates that the object is a CDP object in AD DS
%11	CAObjectClass	Indicates that the object is a CA certificate object in AD DS

When variables are used in the CAPolicy.inf file, the installation of Certificate Services parses the file and replaces the variables with the actual names implemented by the CA. For example, if you do not define a [CRLDistributionPoint] section, a Windows Server 2003 root CA implements the following default paths for CRL publication:

    * %Windir%\System32\CertSrv\CertEnroll\%3%8%9.crl
    * ldap:///CN=%7%8,CN=%2,CN=CDP,CN=Public Key Services, CN=Services,%6%10
    * http://%1/CertEnroll/%3%8%9.crl
    * file://\\%1\CertEnroll\%3%8%9.crl

Likewise, if you do not define an [AuthorityInformationAccess] section within a CAPolicy.inf file, a Windows Server 2003 root CA implements the following default paths for CA certificate publication:

    * %Windir%\System32\CertSrv\CertEnroll\%1_%3%4.crt
    * ldap:///CN=%7,CN=AIA,CN=Public Key Services,CN=Services,%6%11
    * http://%1/CertEnroll/%1_%3%4.crt
    * file://\\%1\CertEnroll\%1_%3%4.crt

Important 
The defaults have changed for Windows Server 2008. By default, the root CA certificate is created with no CDP or AIA extensions.

[EnhancedKeyUsageExtension]

This section is used to restrict the types of certificates a CA can issue.

For example, if you want to restrict a CA to issuing certificates for Client Authentication, Server Authentication, and Secure Email, you would define the [EnhancedKeyUsageExtension] as shown here:

[EnhancedKeyUsageExtension]
OID = 1.3.6.1.5.5.7.3.2  ; Client Authentication
OID = 1.3.6.1.5.5.7.3.1  ; Server Authentication
OID = 1.3.6.1.5.5.7.3.4  ; Secure Email


Note 
These are predefined OIDs defined by the IANA or by Microsoft. You can view the list of predefined OIDs in the Certificate Templates console using the same method you use to identify your forest’s privately assigned OID tree.

[BasicConstraintsExtension]

The basic constraints section allows you to define path-length restrictions. A path-length restriction allows you to limit the depth of your CA hierarchy. For example, if you want to prevent the installation of an additional tier below the current CA, you can define the [BasicConstraintsExtension] extension as shown here:

[BasicConstraintsExtension]
pathlength = 0


Note 
All CA certificates have a basic constraints extension, even if you do not define the section in the CAPolicy.inf file. The basic constraints extension indicates whether the certificate is issued to a CA or to a user, computer, service, or network device. CA certificate identification allows the chaining engine to determine whether the certificate can be used to sign other certificates.

[certsrv_server]

The [certsrv_server] section has entries that apply to all CAs in the CA hierarchy. The following entries can be defined in this section:

    * RenewalKeyLength The requested length of the CA’s private key and public key when the CA certificate is renewed. The value should match the value assigned to the CA’s key length during initial installation, unless you decide to modify the length of the CA’s certificate at renewal time.
    * RenewalValidityPeriod The validity period’s unit of measurement. Accepted values are years, weeks, and days, though use of anything other than years is uncommon.
    * RenewalValidityPeriodUnits The specific number of units for the validity period. For example, if you configure a CA with a 15-year validity period, the RenewalValidityPeriodUnits value is 15.

      Note 
      You cannot set the initial CA key length and validity period in the CAPolicy.inf file. The value at installation is configured in the installation wizard for a root CA and is defined by the parent CA for all subordinate CAs. The CAPolicy.inf file specifies key length and validity period settings used when you renew the CA’s certificate.

    * CRLPeriod The CRL publication interval’s unit of measurement. The default value is days, but years, weeks, and hours are acceptable.
    * CRLPeriodUnits The specific number of units for the CRL publication interval. The default value is seven, but this value is typically changed based on the CA’s design.
    * CRLOverlapUnits Works together with CRLOverlapPeriod to specify how long to extend the validity period of a base CRL beyond the specified base CRL publication interval. The CRLOverlapUnits is the specific number of units for the base CRL overlap.
    * CRLOverlapPeriod The base CRL overlap period’s unit of measurement. The default is days, but years, weeks, minutes, and hours are acceptable.
    * CRLDeltaPeriod The unit of measurement for the delta CRL publication interval. The default unit or value is days, but years, weeks, and hours are acceptable.
    * CRLDeltaPeriodUnits The specific number of units for the delta CRL publication interval. The default value is 1, but this value is typically changed based on the CA’s design.
    * CRLDeltaOverlapPeriod The delta CRL overlap period’s unit of measurement. The default is minutes, but years, weeks, days, and hours are acceptable.
    * CRLDeltaOverlapUnits Works together with CRLDeltaOverlapPeriod to specify how long to extend the validity period of a delta CRL beyond the defined delta CRL publication interval. The CRLOverlapUnits is the specific number of units for the base CRL overlap.
    * ClockSkewMinutes A safety factor for clock synchronization issues. The base and delta CRL are published with a beginning time equal to the ClockSkewMinutes before the current time. The default value is 10 minutes. As an example, if the current time is 10:00, a new base or delta CRL will be published with an effective time of 09:50.

Windows Server 2008 introduces new options for the CAPolicy.inf file. These options include:

    * LoadDefaultTemplates The LoadDefaultTemplates option was introduced in Windows Server 2003 Service Pack 1. The setting prevents the publication of the default templates after installation of an enterprise CA if assigned a value of 0. In Windows Server 2008, the setting is applicable to any enterprise CA, whether the CA is a root CA or a subordinate CA.
    * DiscreteSignatureAlgorithm The DiscreteSignatureAlgorithm option, when assigned a value of 1, enables support for the PKCS#1 V2.1 signature format for both the CA certificate and CA certificate requests. If implemented on a root CA, the root CA will generate a root certificate that includes the PKCS#1 V2.1 signature format. If implemented on a subordinate CA, the subordinate CA will generate a certificate request that includes the PKCS#1 V2.1 signature format.

Note 
Discrete signatures for RSA-based certificates are documented as part of the PKCS #1: RSA Cryptography Standard. For more information about the standard, see the RSA Web site at http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/.

What Are Discrete Signatures?

With the support of Cryptography Next Generation (CNG) and the new Suite B signature and encryption algorithms, it is necessary to include information about algorithms in both certificate and certificate requests. If this information is not included, an entity processing the certificate or certificate request may not be able to verify the signature of the object.

As shown in Figure 6-3, when a certificate or certificate request is signed, an initial hash is generated against the Subject, Public Key Algorithm, Public Key Length, Public Key, Request Attributes, and Certificate Extensions of the certificate or certificate request. Once the hash is generated, it is signed with the private key of the associated key pair by using an asymmetric algorithm.

Figure 6-3. The combination of hash and signing algorithms


CNG introduces an increasing number of available algorithms. This results in an ever-growing list of possible combinations for hash and signature algorithms. For example, a certificate request might be hashed with a MD5 and signed with RSA but the issued certificate was hashed with SHA384 and signed with ECDSA_P256. Therefore, you must add information about the used algorithms into the certificate or request instead of maintaining a list of identifiers that translate the combinations.

Pre-Installation Scripts

In a CA hierarchy with two or more tiers, there are pre-installation scripts that must be executed to prepare the subordinate CA for installation. These pre-installation scripts include:

    * Publish the root CA and all subordinate CA certificate and CRLs that exist between the new subordinate CA and the root CA to the local computer store.
    * Publish the root CA and all subordinate CA certificate and CRLs that exist between the new subordinate CA and the root CA to AD DS.

Warning 
If you do not install the certificates and CRLs before installation of the subordinate CA, you might receive an error message when you install the subordinate CA certificate stating that the CA cannot determine the revocation status of the CA certificate.

Publishing Certificates and CRLs to the Local Computer Store

You must be a member of the local Administrators group to add CRLs and certificates to the local computer store. The combination of certificates and CRLs that must be installed depends on where the target CA exists in the CA hierarchy:

    * If the new CA is installed at the second tier of the hierarchy, you must install the root CA’s certificate and CRL.
    * If the new CA is at the third tier of the hierarchy or lower, you must install all CA certificates and CRLs in the certificate chain above the new CA.

To add a root CA’s certificate to the trusted root CA store of the computer, you can use the following command:

certutil -addstore -f Root RootCACertificateFile.crt,


where RootCACertificateFile is the file name of the root CA’s certificate file.

To add a root CA’s CRL to the trusted root CA store, you can use the following command:

certutil -addstore -f Root RootCACRLFile.crl,


where RootCACRLFile is the file name of the root CA’s CRL file.

To add a subordinate CA’s certificate to the intermediate CA store, you can use the following command:

certutil -addstore -f CA SubCACertificateFile.crt,


where SubCACertificateFile is the file name of the subordinate CA’s certificate file.

To add a subordinate CA’s CRL to the intermediate CA store, you can use the following command:

certutil -addstore -f CA SubCACRLFile.crl,


where SubCACRLFile is the file name of the subordinate CA’s CRL file.
Publishing Certificates and CRLs to AD DS

In addition to publishing the CA certificates and CRLs to the local machine store of subordinate CAs, you can publish CA certificates and CRLs for any offline CAs to AD DS. By publishing the CA certificates to AD DS, you ensure the automatic propagation of CA certificates and CRLs to all domain member computers running Microsoft Windows 2000 or later operating systems.

The published CA certificates and CRLs are automatically downloaded to the forest members running Windows 2000 or later through Group Policy. The processing of Group Policy triggers the autoenrollment mechanism, initiating the automatic download of any certificates or CRLs published in AD DS to the forest members. Figure 6-4 shows where the CA certificates and CRLs are published when they are published into AD DS.

Figure 6-4. AD DS publication locations

[View full size image]

In Figure 6-4, CA certificates are published into the following locations:

    * All CA certificates are published into the CN=AIA,CN=Public Key Services,CN=Services,CN=Configuration,ForestRootDomain (where ForestRootDomain is the LDAP distinguished name of your organization’s forest root domain) container.
    * Root CA certificates are also published into the CN=Certification Authorities, CN=Public Key Services,CN=Services,CN=Configuration,ForestRootDomain container.
    * Enterprise CA certificates are published into the CN=NTAuthCertificates,CN=Public Key Services,CN=Services,CN=Configuration,DC=ForestRootDomain object.

Note 
The AIA container and Certification Authorities container are used by the certificate chaining engine to acquire certificates for chain building. For example, subordinate CA certificates are included only in the AIA container, whereas root CA certificates are included in both the AIA and Certification Authorities container. The NTAuthCertificates container indicates CAs that can issue certificates used for smart card logon.

To publish a root CA certificate into AD DS, you can use the following command:

certutil -dspublish -f RootCACertificateFile.crt RootCA


where RootCACertificateFile.crt is the file name of the root CA’s certificate file.

Note 
If the CA certificate file’s name contains spaces, you must delimit the file name with quotes. For example, the command line to publish the Fabrikam root CA certificate would be certutil –dspublish –f “Fabrikam Corporate Root CA.crt” RootCA.

To publish a subordinate CA’s certificate to AD DS, you can use the following command:

certutil –dspublish -f SubCACertificateFile.crt SubCA


where SubCACertificateFile.crt is the file name of the subordinate CA’’s certificate file.

Note 
When the RootCA option is used with the certutil –dspublish command, the CA certificate is published to the both the AIA and Certification Authorities containers. If the SubCA option is used, the CA certificate is published only to the AIA container.

CRLs are published into unique containers within the CN=CDP,CN=Public Key Services,CN=Services,CN=Configuration,ForestRootDomain container. For example, the CRL for the server with the NetBIOS name FABINCCA01 is published within the CN=FABINCCA01,CN=CDP,CN=Public Key Services,CN=Services,CN=Configuration,ForestRootDomain container.

When adding a CA’s CRL into AD DS, there is no difference between publishing a root CA and a subordinate CA CRL. To publish the CRL, use the following command:

certutil –dspublish -f CACRLFile.crl


where CACRLFile is the logical name of the root CA.

Note 
If publication fails, an error in the CRL might not contain sufficient LDAP information regarding the CRL publication location. You can force publication into AD DS by adding the CA’s NetBIOS name to the publication command. For example, if the NetBIOS name of Fabrikam’s root CA is FABINCCA01, the command to publish the Fabrikam root CA’s CRL is certutil –dspublish –f “Fabrikam Corporate Root CA.crl” FABINCCA01.

Once the CA certificates and CRLs are published into AD DS, you can force their propagation at each client computer by using the Group Policy application to trigger the autoenrollment engine, resulting in the propagation of the certificates and CRLs to the client computer.

    * At computers running Windows 2000, a user can type secedit /refreshpolicy machine_policy /enforce.
    * At computers running Windows XP and later, a user can type gpupdate /target:computer /force and then type certutil -pulse to initiate autoenrollment requests.

Alternatively, publication also takes place the next time the computer restarts, forcing triggering of the autoenrollment engine or a wait period of 90 minutes with a randomized offset of plus or minus 30 minutes at client computers, the default interval for Group Policy application.
Post-Installation Scripts

Some of the configuration areas to include in the post-installation script are described in the next sections of this chapter.

Note 
Although reviewed separately in this chapter, the following sections of the chapter are combined into a single script file for post-installation configuration. This book does not show every possible configuration that uses the certutil command in a script.

Declaring the Configuration Naming Context

One of the first tasks required for a post-installation script file is to declare the forest’s configuration naming context. The configuration naming context replicates to all domain controllers in the forest and contains the publication points for all CA certificates and CRLs. (See Figure 6-4, above.)

To define the configuration naming context for your forest, use the following certutil command, where ForestRootDomain is the LDAP distinguished name of your organization’s forest. This command defines the variable %6:

certutil -setreg CA\DSConfigDN CN=Configuration,ForestRootDomain


Defining CRL Publication Intervals

A post-installation script is commonly used to ensure that CRL and delta CRL publication intervals are defined correctly. Although you can define these settings in the CAPolicy.inf file, adding the settings to a post-installation script ensures consistent application of the required settings. If you are unsure if settings are modified, you can re-run the post-installation script to reapply the correct settings.

Note 
Although the settings are replicated in both CAPolicy.inf and in the post-installation script, the settings in CAPolicy.inf are read only at installation and during renewal. The post-installation script can be executed at any time to reset CA configuration settings to the settings recorded in the script.

Adding the following entries to a post-installation script ensures that Certificate Services implements the desired publication intervals:

::Define CRL Publication Intervals
certutil -setreg CA\CRLPeriodUnits 26
certutil -setreg CA\CRLPeriod "Weeks"
certutil -setreg CA\CRLOverlapUnits 22
certutil -setreg CA\CRLOverlapPeriod "Weeks"
certutil -setreg CA\CRLDeltaPeriodUnits 0
certutil -setreg CA\CRLDeltaPeriod "days"


In this example, the CRL publication interval is set to every 26 weeks with a 2-week overlap, and the publication of delta CRLs is disabled with its interval set to zero days.
Defining Publication Points

One of the key tasks after installing Certificate Services is defining publication points for a CA’s certificate and CRL. The publication points can be configured in the CA console in the CA’s Properties dialog box. (See Figure 6-5.)

Figure 6-5. Defining CRL distribution points


This dialog box allows you to choose between CDP URLs and AIA URLs. In both cases, you must also choose the URL path where the CRL or AIA will be referenced.

Table 6-2 shows the options available for CRL publication locations.

Table 6-2. CRL Publication Options
Display name	Description	Label	Value
Publish CRLs to this location.	Identifies locations to which the CA should automatically publish the physical CRL files.	ServerPublish	1
Include in all issued certificates.	Place a URL for the base CRL in all certificates issued by the CA.	AddtoCertCDP	2
Include in CRLs. Clients use this to find delta CRL locations.	Places a URL for delta CRL retrieval in a base CRL. This publication point is stored in the freshest CRL extension of a CRL and is retrieved only during the CRL checking process.	AddtoFreshestCRL	4
Include in the CDP extension of CRLs.	Places a URL in the CDP extension of a CRL issued by the CA to allow the relying party certificate chaining engine to download the latest CRL version if the current version has expired.	AddtoCRLCDP	8
Publish delta CRLs to this location. Specifies where to publish in AD DS when publishing to LDAP URLs.	If the CA is configured to enable delta CRLs, the delta CRL files are automatically published to this location.	ServerPublishDelta	64
Include in the IDP extension of issued CRLs	Used by non-Windows clients to determine the scope of the CRL. The scope can include end-entity certificates only, CA certificates only, attribute certificate only, or a limited set of reason codes.	IssuingDistributionPoint	128

For each location, you can choose to enable any combination of check boxes by adding the numbers in the Value column. For example, if you want to enable the publication of CRLs and delta CRLs, a value of 65 will accomplish this.

Likewise, there are specific entries for CA certificate publication locations. When you enable these options, the URLs are placed in the AIA extension of issued certificates. Table 6-3 shows the values that are available for AIA publication URLs.

Table 6-3. AIA Publication Options
Display name	Description	Label	Value
Publish CRLs to this location	Identifies locations to which the CA should automatically or manually publish the physical CRL files	ServerPublish	1
Include in the AIA extension of issued certificates	Includes the URLs for the CA certificate in all issued certificates	AddtoCertCDP	2
Include in the Online Certificate Status Protocol (OCSP) extension	Includes the HTTP URL for the designated OCSP server in all issued certificates	AddtoCertOCSP	32

As with the CDP extensions, you can determine which check boxes to enable for each AIA extension by referencing the numbers in the Value column and adding the numbers.
Defining CRL Distribution Points

You can define a CA’s CDP URLs by using the certutil command to edit the CRLPublicationURLs registry entry. The command allows you to designate one or more URLs as well as which CRL publication options are enabled for each URL.

For example, consider the following certutil command that defines the CDP extension:
Code View: Scroll / Show All

certutil -setreg CA\CRLPublicationURLs
"1:%windir%\system32\CertSrv\CertEnroll\%%3%%8%%9.crl\n2:http://www.fabrikam.com/CertData/
%%3%%8%%9.crl\n10:ldap:///CN=%%7%%8,CN=%%2,CN=CDP,CN=Public Key
Services,CN=Services,%%6%%10"

					  


This command defines three separate URLs. The URL order is important when implementing Windows clients because it specifies the order in which the certificate chaining engine searches URLs when retrieving an updated CRL version. Likewise, the number that precedes each URL represents the enabled options for each URL.

Note

	

Each URL is separated by \n. This character combination is the line separation indicator used for multi-valued registry entries.

    *

      1:%windir%\system32\CertSrv\CertEnroll\%%3%%8%%9.crl This URL ensures that the CRL file is copied to the local file system every time the CRL is automatically or manually published.
    *

      2:http://www.fabrikam.com/CertData/%%3%%8%%9.crl This URL ensures that the URL www.fabrikam.com/Certdata/%%3%%8%%9.crl is included in the CDP extension of all issued certificates.
    *

      10:ldap:///CN=%%7%%8,CN=%%2,CN=CDP,CN=Public Key Services,CN=Services,%%6%%10 This URL enables two values: 2 to designate the CRL’s publication point in AD DS and 8 to include the CDP URL in all CA-issued certificates.

Note

	

Notice that the variables used in the certutil commands are the same as those used in the CAPolicy.inf file. The only difference is that the variables are prefixed with %% rather than %. The additional % character is an escape character required by certutil.

Defining CA Certificate Distribution Points

As with the CDP extension, you can modify the AIA extension to designate CA-certificate publication points. This is accomplished by using the certutil command to modify the CACertPublicationURLs registry entry, as shown here:
Code View: Scroll / Show All

::Modify the AIA Extension URLs
certutil -setreg CA\CACertPublicationURLs
"1:%windir%\system32\CertSrv\CertEnroll\%%1_%%3%%4.crt\n2:http://www.fabrikam.com/CertData/
%%1_%%3%%4.crt\n2:ldap:///CN=%%7,CN=AIA,CN=Public Key Services,CN=Services,%%6%%11"

					  


This example places three entries in the registry value:

    *

      1:%windir%\system32\CertSrv\CertEnroll\%%1_%%3%%4.crt This entry ensures that the CA certificate is published to the local file system.
    *

      2:http://www.fabrikam.com/CertData/%%1_%%3%%4.crt This entry ensures that the HTTP URL is included in the AIA extension of all issued certificates.
    *

      2:ldap:///CN=%%7,CN=AIA,CN=Public Key Services,CN=Services,%%6%%11 This entry ensures that the LDAP URL is included in the AIA extension of all issued certificates.

Defining Validity Periods for Issued Certificates

Another CA configuration option that can be defined with certutil is the maximum validity period for any CA-issued certificate. The manner in which the validity period for issued certificates is applied depends on whether the CA is a standalone CA or an enterprise CA.

In the case of a standalone CA, the specification of a validity period sets the validity period for all CA-issued certificates. In the case of an enterprise CA, the maximum validity period acts as a maximum value for any CA-issued certificates. An issued certificate is always assigned the lesser value of the remaining validity period of the CA certificate and the configured maximum validity period. In other words, if you specify the maximum validity period as four years, and the CA has only three years remaining in its certificate’s validity period, the maximum validity period of a newly issued certificate is three years.

In the case of an enterprise CA, another variable enters the picture. Enterprise CAs issue certificates based on certificate templates. Each certificate template has its own configured validity period. The applied validity period for certificates issued by an enterprise CA is the minimum value of the CA certificate’s remaining validity period, the CA’s maximum validity period setting, and the certificate template’s validity period.

To configure the maximum validity period for issued certificates, two certutil commands are required to modify the two related registry entries: ValidityPeriodUnits and ValidityPeriod. The following example shows the combination to set the maximum validity period to 10 years.

::Set Validity Period for Issued Certificates
certutil -setreg CA\ValidityPeriodUnits 10
certutil -setreg CA\ValidityPeriod "Years"


Enabling Auditing at the CA

You can enable auditing on a CA in Windows Server 2008 to provide an audit log for all Certificate Services management tasks. To enable auditing, you must ensure that both success and failure auditing is applied to either the Local Security Policy of an offline CA or a Group Policy Object (GPO) applied to the organizational unit (OU) containing the CA’s computer account for an online CA. All Certificate Services auditing is reported to the security log in Event Viewer.
PKI Auditing Categories

The following auditing categories can be enabled or disabled on a case-by-case basis:

    *

      Back up and restore the CA database Any attempt to back up or restore the CA database is logged to the Windows security log.
    *

      Change CA configurations Any attempt to modify CA configurations is logged. This can include attempts to define AIA and CDP URLs or a key recovery agent.
    *

      Change CA security settings Any attempt to modify CA permissions is logged. This can include adding CA administrators or certificate managers.
    *

      Issue and manage certificate requests Logs any attempt by a certificate manager to approve or deny certificate requests with subject approval pending.
    *

      Revoke certificates and publish CRLs Logs any attempt by a certificate manager to revoke an issued certificate or by a CA administrator to publish an updated CRL.
    *

      Store and retrieve archived keys Logs any attempt by the enrollment process to archive private keys in the CA database or by certificate managers to extract archived private keys from the CA database.
    *

      Start and stop Certificate Services Any attempt by the CA administrator to start or stop Certificate Services is logged.

Note

	

To modify these settings in the properties of the CA, you must be assigned the Manage Auditing and Security Log user right at the CA.

PKI Auditing Details

Table 6-4 summarizes the security log entries related to Certificate Services auditing.

Table 6-4. Certificate Services Event IDs
Event ID	Event description
772	The certificate manager denied a pending certificate request.
773	Certificate Services received a resubmitted certificate request. This means that a certificate manager issued a certificate that was pending.
774	Certificate Services revoked a certificate.
775	Certificate Services received a request to publish the CRL.
776	Certificate Services published the CRL.
777	A certificate request extension changed.
778	One or more certificate request attributes changed.
779	Certificate Services received a request to shut down.
780	Certificate Services backup started.
781	Certificate Services backup completed.
782	Certificate Services restore started.
783	Certificate Services restore completed.
784	Certificate Services started.
785	Certificate Services stopped.
786	Security permissions for Certificate Services changed.
787	Certificate Services retrieved an archived key.
788	Certificate Services imported a certificate into its database.
789	The audit filter for Certificate Services changed.
790	Certificate Services received a certificate request.
791	Certificate Services approved a certificate request and issued a certificate.
792	Certificate Services denied a certificate request.
793	Certificate Services set the status of a certificate request to pending.
794	The certificate manager settings for Certificate Services changed.
795	A configuration entry changed in Certificate Services.
796	A property of Certificate Services changed.
797	Certificate Services archived a key.
798	Certificate Services imported and archived a key.
799	Certificate Services published the CA certificate to AD DS.
800	One or more rows have been deleted from the certificate database.
801	Role separation enforcement is enabled. If role separation enforcement is enabled, the event log entry will state Yes. If disabled, the event log entry will state No.

Once you have enabled object access auditing for successes and failures, the following lines in a post-installation script ensure that all auditing categories are enabled:

::Enable all auditing events for the CA
certutil -setreg CA\AuditFilter 127


CNG Auditing

To meet Common Criteria requirements, you can enable auditing in the Microsoft software key storage provider (KSP) to enable auditing of actions that happen in the CNG layer. These auditable actions include:

    *

      Key and key-pair generation failures
    *

      Key import and export actions
    *

      Key destruction failures
    *

      Writing and reading persistent keys from files
    *

      Pair-wise consistency check failures
    *

      Secret key validation failures
    *

      Failures in encryption, decryption, hashing, signature, verification, key exchange, and random number generation
    *

      Cryptographic self-test successes and failures

Note

	

In general, if a key does not have a name, it is an ephemeral key. An ephemeral key does not persist, and the Microsoft KSP does not generate audit records for ephemeral keys.

When auditing is enabled for the Microsoft KSP, only audit records for events that occur in user mode in the Local Security Authority (LSA) process are included. No audit records are generated by kernel mode CNG operations.
Publishing an Updated CRL

Once all of the configuration changes are made to a CA, including the definition of CDP and AIA extensions, you must restart Certificate Services to enable the changes. Because the CDP extension allows you to modify the CRL location, it is advisable to copy the CRL to a floppy disk when configuring offline CAs. The following combination of commands enables the restart of Certificate Services, publishes an updated CRL, and copies the updated CRL to the floppy drive.

net stop certsvc & net start certsvc
Sleep 5
Echo Insert a Floppy disk in Drive A:
certutil –CRL
sleep 5
copy /y %windir%\system32\certsrv\certenroll\*.crl a:\


Note

	

This script sample also utilizes the Sleep utility from the Windows Server 2003 Resource Kit. This command will pause a batch file for the indicated number of seconds—five seconds in this case. You may have to increase the sleep interval to a longer time frame depending on the size of your CA database and CRL. The sleep interval needs to be of a long enough duration to ensure that the CA has finished publishing the new CRL before the copy operation is attempted.

    * Safari Books Online

					6.1.1.1.4.4
				6.1.1.1.5
		6.1.2

	6.2 Crypto module

		6.2.1 Documentation

			6.2.1.1 ACS - PKI - Software Design Specification: EDCS-747115
				6.2.1.1.1	Introduction

This section describes the TLS authentication methods and use-cases for ACS 5.x. 

					6.2.1.1.1.1	Certificates Authentications
ACS PKI authentication is based on X509 certificate identification. The entity which identifies itself with a certificate holds the private-key that associated to the public-key stored in the certificate. 
A certificate can be either self-signed or signed by another CA (Certificate-Authority). A hierarchy of certificate can be made to form trust relations of each entity to its CA. A root-CA would be the entity that signs the certificate of all other CA that eventually ends up signing each certificate in its hierarchy.
A certificate can be verified using a public-key by each entity which preliminarily trust some certificate in that hierarchy by following the trust relations path from the certificate up to the trusted CA.
The ACS identifies itself with its own certificate. For SSL protocols such as HTTPS, the local-certificate should contain the server’s IP or hostname as the Subject's CommonName (CN) field in the certificate.
The ACS support Certificate-Trust-List (CTL) for authorizing connection certificates. The ACS will support complex hierarchies authorizing an identity certificate in the case that all of the chain certificates are presented to it. 
ACS will support all RSA key sizes used in the certificate that is either 512, 1024, 2048 or 4096 bits, where ACS will not prevent the use of other key sizes. 
ACS would support either MD5 and SHA1 based signatures for both client and server certificates. It is the administrator's responsibility to configure the PKI deployment of the organization to not include MD5 signatures as a response to latest vulnerabilities of MD5 based signatures. 
Version note: In ACS5.1 only RSA is supported whereas the Digital-Signature-Algorithm (DSA) is not supported by ACS although in some use cases, ACS will not prevent DSA cipher suites from being used.

						6.2.1.1.1.1.1	PKI authentication
An SSL/TLS tunnel authentication is conducted by both peers and is initiated by the client. In ACS for different use cases, the tunnel can be either authenticated by both peers, by either just one side or by none of them. A tunnel which is being constructed without authentication is considered an anonymous tunnel and is usually being constructed by Diffie-Hellman key exchange protocol.
					6.2.1.1.1.2 ACS Local Certificates
The following certificates are used to identify ACS by various protocols.
Upon installation, a default self-signed certificate is generated and associated to all use-cases. 

						6.2.1.1.1.2.1 EAP Server Credentials
The EAP server's certificate is being used to authenticate ACS by EAP supplicants.
The certificate should be marked for "Server Authentication" in the Enhanced-Key-Usage (EKU) extension
As EAP servers lay behind NAS devices and access-points, the EAP server's IP is not known to the EAP-Client. Therefore, the EAP server's certificate does not have to include the server's IP or DNS name in its subject's CN field.

						6.2.1.1.1.2.2 ACS Credentials used for External Policy Servers
The External-Policy-System certificate is used to authenticate the ACS as a client for GAME protocols over HTTPS.
The certificate should be marked for "Client Authentication" in the Enhanced-Key-Usage (EKU) extension
As the GAME server may have access to the ACS's IP, the External-Policy-System certificate should contain either the ACS's IP or DNS name in it's subject's CN field.

						6.2.1.1.1.2.3 Management Credentials
ACS would generate and use self-signed certificates as a basic mean to identify the ACS server for management protocols such as the GUI/PI HTTPS. 
The certificate should be marked for "Server Authentication" in the Enhanced-Key-Usage (EKU) extension
As the other peers may have access to the ACS's IP, the management certificate should contain either the server's IP or DNS name in it's subject's CN field.

Version note: Currently ACS 5.0 & 5.1, supports only the GUI/PI certificates. For other management protocols listed below, a different mechanism is used. Currently, these credentials can not be replaced by the administrator. 
•	SSH and SFTP servers – for these interfaces, a public/private key pair is generated upon installation and is used to open SSL tunnels. The client may cache these credentials as a mean of authenticating the server. 
•	ActiveMQ/RMI/SQL – for these interfaces, a self-signed certificate is generated upon installation and each time the ACS machine is restarted. The certificate is generated with a large expiry TTL, thus there is no chance that it will become expired during the ACS activation lifetime. 

Note: As a failover mechanism, if an internal error occurs, the GUI might use a self-signed certificate instead of the one configured for management GUI.

					6.2.1.1.1.3 Session re-use
ACS supports SSL/TLS session resume for all TLS protocol. For each session, ACS would maintain in cache the tunnel keys and cipher used to establish the tunnel communication. Fetching an old session is based on the session ID which is supposed to be unique for each client.
The timeout used to maintain a session in the cache would be configurable for each protocol individually. The lifetime of a session is measured from the beginning of the conversation and is being determined when the TLS session is created.

						6.2.1.1.1.3.1 Fast PAC based sessions establishment
For protocols such as EAP-FAST, ACS supports establishment of a tunnel from a commonly shared key known to the client and the server. The key is kept secured in a PAC structure that is held by the client and sent to the server on the first tunnel establishment messages. The key is used to derive a shared tunnel TLS-master-key which will be used to open a tunnel. This mechanism involves a shorter TLS negotiation.

					6.2.1.1.1.4 Anonymous Authentications (Diffie-Hellman)
An anonymous Diffie-Hellman tunnel relates to the establishment of a completely anonymous tunnel between a client and a server in which none of the peers authenticates itself. ACS runtime would support anonymous-DH tunnels for EAP-FAST with a predefined prime and a predefined generator of 2. No server authentication is being conducted within anonymous DH tunnel cipher-suites.
Further client authentications are conducted within the tunnel using some other means such as MSCHAP, EAP-TLS, GTC or other. 
 
				6.2.1.1.2

			6.2.1.2
		6.2.2 Crypto Module SDK

			6.2.2.1 Important files

runtime/infrastructure/cryptoLib/src/CryptoLibCommon.h
runtime/infrastructure/cryptoLib/src/CryptoLibExternal.h
runtime/infrastructure/cryptoLib/src/CryptoLib.h
runtime/infrastructure/cryptoLib/src/CryptoLibInterface.h
runtime/infrastructure/cryptoLib/src/FipsControl.h
runtime/infrastructure/cryptoLib/src/SSLInterface.h

			6.2.2.2

		6.2.3

	6.3
7. Setups

	7.1 Sustain

		7.1.1 ACS, my machines 
|      acs-sus-e4m 10.56.24.243 admin/Acs5.3 root/Acs5.3 acsadmin/Acs5.3
|      10.56.24.181 - ACS 5.1 (pwd Acs5.1) 
|      10.56.24.243 - ACS 5.3 (pwd Acs5.2) 
|      10.56.24.244 - ACS 5.3 admin/Acs5.3 root/Acs5.3
|      10.56.24.182 – ACS 5.2 admin/Acs5.2
|      acs-sus-e2f 10.56.24.217 admin/Acs5.3

		7.1.2 CA

			7.1.2.1 Machines


The CA server on Windows 2008R2 is ready.

RDP: 10.56.24.215
User: administrator@2008R2.local
Password: www123!@#

CA web server: http://10.56.24.215/certsrv

In order to start testing EAP-TLS please use the attached user and CA server certificates.

The private key password for the user certificate is: 1234


User, yosi, pwd qqq123!@#

			7.1.2.2 How to install a windows 2008 CA?
Installation process:

http://www.lockergnome.com/it/2008/03/17/installing-and-configuring-certificate-services-on-windows-server-2008-part-ii-2/
Once you have met the system requirements, you are ready to install the Enterprise Root CA for your network. The Enterprise Root CA is at the top of the certificate authority hierarchy. This server is automatically registered in Active Directory and therefore trusted by all computers within the domain. The Enterprise Root CA for your organization is responsible for issuing certificates to Enterprise Subordinate CAs. These servers in turn issue certificates to users and computers within the domain. Every certificate issued within your domain can be traced back to the Enterprise Root CA.

Installing an Enterprise Root Certificate Authority

In order to install and configure an Enterprise Root CA, you must log onto the server with a user account that belongs to the Domain Admins group.

To set up an enterprise root CA in Windows Server 2008:

Click Start, point to Administrative Tools, and then click Server Manager.
In the Roles Summary section, click Add roles.
On the Select Server Roles page, select the Active Directory Certificate Services check box. Click Next two times.
On the Select Role Services page, select the Certification Authority check box, and then click Next.
On the Specify Setup Type page, click Enterprise, and then click Next.
On the Specify CA Type page, click Root CA, and then click Next.
On the Set Up Private Key and Configure Cryptography for CA pages, you can configure optional configuration settings, including cryptographic service providers. Click Next twice.
In the Common name for this CA box, type the common name of the CA. The common name for a CA is usually the same as its host name or computer name. Keep in mind as well, that you will not be able to change any of the identifying information after the service is installed.
Click Next.
On the Set the Certificate Validity Period page, configure the default validity duration for the root CA. The Validity period defines how long issued certificates remain valid. The default value for this field is 5 years. You can increase or decrease the number as necessary. Click Next after you have filled in the information.
On the Configure Certificate Database page, configure the location of the Certificate database, the Certificate database log, and the shared folder. The default location for the database and database log is C:\WINDOWS\system32\CertLog. You use the default value or use the Browse button to select a different location. Click Next.
After verifying the information on the Confirm Installation Options page, click Install.
Setup will configure the necessary components. If setup cannot locate the necessary files, you will be prompted for the Windows Server 2008 CD-ROM to continue. If IIS is not installed, a warning will appear. IIS is required in order to use Certificate Services Web Enrollment Support. Click OK to acknowledge the message.

Review the information on the confirmation screen to verify that the installation was successful.

			7.1.2.3
		7.1.3 "New" machines 
serial   location      name             console 
kqzmnlr  M-9-12 9      cd-sus-c9        telnet://acs-sus-con2:2011, ip address 10.56.24.199 
kqzmnmy  m-9-12        cd-sus-c10       telnet://acs-sus-con2:2012, ip address 10.56.24.200 
In lab near Yavor's office

		7.1.4
	7.2

8. Mgmt

	8.1  PKI

		8.1.1  Certificate trust list

			8.1.1.1  Add feature - prevent non utf-8 encoded certificate installation

				8.1.1.1.1  Example insert exception
Mar 20 2011 16:56:07 com.cisco.nm.acs.mgmt.gui.app.utils.DistributedManagerGuiUtils.log(DistributedManagerGuiUtils.java:289) FATAL http-443-2 Acs.MGMT.GUI bogus.cer
java.io.FileNotFoundException: bogus.cer
	at com.cisco.nm.acs.mgmt.gui.app.actions.TrustCertificateLPInputAction.onSaveNew(TrustCertificateLPInputAction.java:118)
	at com.cisco.nm.acs.mgmt.gui.framework.actions.LPInputAction.save(LPInputAction.java:452)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.lang.reflect.Method.invoke(Unknown Source)
	at org.apache.struts.actions.DispatchAction.dispatchMethod(DispatchAction.java:266)
	at com.cisco.nm.acs.mgmt.gui.framework.actions.ACSBaseAction.dispatchMethod(ACSBaseAction.java:395)
	at org.apache.struts.actions.DispatchAction.execute(DispatchAction.java:167)
	at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:413)
	at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:225)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1858)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:459)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at com.cisco.nm.acs.mgmt.gui.framework.web.GUIAuditFilter.doFilter(GUIAuditFilter.java:118)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at com.cisco.nm.acs.mgmt.performancemonitoring.filter.PerformanceMonitoringSensorFilter.doFilter(PerformanceMonitoringSensorFilter.java:46)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at com.cisco.nm.acs.mgmt.gui.framework.web.UserAuthenticatedFilter.doFilter(UserAuthenticatedFilter.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:525)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
	at org.apache.catalina.authenticator.SingleSignOn.invoke(SingleSignOn.java:421)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
	at java.lang.Thread.run(Unknown Source)

				8.1.1.1.2 Example, load exception

<!--  [Exception]Unable to translatecom.cisco.nm.acs.im.certificate.TrustCertificate Object{ downloadCRL=false, automaticCRLUpdate=true, nonAutomaticCRLUpdatePeriod=3600, purgeExpiredCRL=false, automaticCRLUpdatePreload=300, crlDownloadFailureRetries=600, authenticateBeforeCRLReceived=false, ignoreCRLExpiration=false, version=0, description=Enterprise Enrolment CA for Statoil@Work2, issuedTo=Enterprise Enrolment CA for Statoil@Work2, notBefore=Tue Sep 01 21:24:45 IDT 2009, friendlyName=Enterprise Enrolment CA for Statoil@Work2, id=1, serialNumber=-3817363634149881244, notAfter=Sat May 07 09:50:10 IDT 2011, encoded=[B@5ba0d9, certificateFilename=null, issuedBy= S t a t o i l @ W o r k   E n t e r p r i s e   R o o t, subject=[B@501c1d, name=[B@159eaf3, crlDownloadURLs=[]} due to exception: 
Error writing marshalled document
java.io.IOException: Illegal character code 0x0 in content text
	at org.jibx.runtime.impl.UTF8Escaper.writeContent(UTF8Escaper.java:128)
	at org.jibx.runtime.impl.GenericXMLWriter.writeTextContent(GenericXMLWriter.java:221)
	at org.jibx.runtime.impl.MarshallingContext.element(MarshallingContext.java:707)
	at com.cisco.nm.acs.im.certificate.Certificate.JiBX_jibxBinding_marshal_3_1(Certificate.java)
	at com.cisco.nm.acs.im.certificate.TrustCertificate.JiBX_jibxBinding_marshal_4_0(TrustCertificate.java)
	at com.cisco.nm.acs.im.certificate.JiBX_jibxBindingTrustCertificate_access.marshal()
	at com.cisco.nm.acs.im.certificate.TrustCertificate.marshal(TrustCertificate.java)
	at org.jibx.runtime.impl.MarshallingContext.marshalRoot(MarshallingContext.java:1044)
	at org.jibx.runtime.impl.MarshallingContext.marshalDocument(MarshallingContext.java:1070)
	at com.cisco.nm.acs.mgmt.replication.RuntimeXMLTranslator.generateObject(RuntimeXMLTranslator.java:261)
	at com.cisco.nm.acs.mgmt.configloader.ConfigLoader.loadObjectXML(ConfigLoader.java:657)
	at com.cisco.nm.acs.mgmt.configloader.ConfigLoader.loadAllImObjectXML(ConfigLoader.java:400)
	at com.cisco.nm.acs.mgmt.configloader.ConfigLoader.loadAllImXML(ConfigLoader.java:360)
	at com.cisco.nm.acs.mgmt.configloader.ConfigLoader.main(ConfigLoader.java:1494)

				8.1.1.1.3
			8.1.1.2

		8.1.2

	8.2

9.  Clearcase ACS code, streams and operations

	9.1  Open case to RE (Release Engineering)

http://wikicentral.cisco.com/confluence/display/GROUP/Open+PMBU+RE+Case
To Open a Case with the PMBU Release Engineering Team :

| 1. Go to the following URL : http://srm.cisco.com/
| 2. Type under "Search.. for" relevant word "PMBU-RE"
| 3. Choose appropriate product and click "Request Now"

10. Defects, Bugs

	10.1 Usefull links
ACS 5.3 wiki - http://zed.cisco.com/confluence/display/ACS5/ACS+5.3

QDDTS - http://www-tac.cisco.com/topic/topicweb/care2ddts/care2ddts.html

5.3 + CFD opened bugs 
http://wwwin-metrics.cisco.com/protected-cgi-bin/ddts_query.cgi?expert=Engineer%3Ayizaq%20and%20Product%3Aacs5%20and%20Severity%3A1%2C2%20and%20Status%3AS%2CN%2CA%2CO%2CW%2CH%2CI%2CP%2CM%20or%20%28%20Engineer%3Ayizaq%20and%20Product%3Aacs5%20and%20Severity%3A1%2C2%2C3%20and%20Status%3AS%2CN%2CA%2CO%2CW%2CH%2CI%2CP%2CM%20and%20Found%3Acustomer-use%20%29%20or%20%28%20Engineer%3Ayizaq%20and%20Attribute%3A%2A5.3-fcs%2A%20and%20Product%3Aacs5%20and%20Status%3AS%2CN%2CA%2CO%2CW%2CH%2CI%2CP%2CM%20%29&type=directweb&sort=Severity&fields=Status%3APriority%3ASeverity%3AFound%3ADE-manager%3AAge%3AComponent%3AHeadline%3AAttribute%3AEngineer

	10.2


11.  Protocols

	11.1  EAP-FAST

		11.1.1  Ultimate wireless security guide: A primer on Cisco EAP-FAST authentication
By George Ou
January 11, 2007, 5:00pm PST
Recommend
0 Votes
0 Comments
Share
more +

The complete TechRepublic Ultimate WirelessSecurity Guide is available as a download in PDF form.

With the threat of ASLEAP looming, Cisco created their newFlexible Authentication via Secure Tunneling Extensible Authentication ProtocolMethod (EAP-FAST) protocol and submitted it to the IETF. EAP-FAST as proclaimedby Cisco marketing would be "as secure as PEAP" and "as easy asLEAP"! EAP-FAST achieves this by creating the same secure encrypted tunnelused to protect user credentials during the authentication session as PEAPwithout the need for any kind of PKI on the client end or even the server end.Naturally, I immediately became skeptical of that claim. Of course there areother ways such as secret key cryptography of achieving a secure key exchangewithout PKI, but none are ever as elegant or as easy to deploy in large scale.Is EAP-FAST the exception?
EAP-FAST phases

EAP-FAST undernormal operation is just like PEAP and has two phases. Phase 1 sets up a secure encrypted tunnel and Phase 2 is a MS-CHAPv2session that verifies the client to the authentication server. Since MS-CHAPv2 iswidely known to be very weak against dictionary attacks, the encrypted tunnels establishedin Phase 1 provides a safe environment for the MS-CHAPv2 session. The differenceis that EAP-FAST uses a PAC (Protected Access Credentials) shared secret to setup the tunnel where as PEAP uses the server side digital certificate to set up aTLS tunnel (similar to how secure Web servers work). A unique user specific PACfile is generated from a single EAP-FAST Master Key on the authentication serverfor each and every user. Distributing the PAC can be achieved by an optional "Phase0" (AKA automatic provisioning) or by other out-of-band methods such as sneakernet, protected admin-only file share, or user specific restricted directory.
Marketing vs. reality

After carefullyreading through the IETF draft of the EAP-FAST protocol submitted by Cisco, it becamefairly obvious that Cisco's marketing claims were not entirely accurate. Althoughit was technically true that EAP-FAST "could" be as secure as PEAP andit "could" be as easy as LEAP, Cisco's marketing left out the fine printand omitted the fact that you just couldn't have both at the same time.

The fact of thematter is, in order for EAP-FAST to truly be as secure as PEAP, it would have torun in "server-side authentication Diffie-Hellmanmode" in "Phase 0" which ironically requires a server side DigitalCertificate. As you recall, the very need for a server side Digital Certificatewas the very thing that scared people away from PEAP in the first place. Cisco saysthat you could resort to other "out-of-band" methods of PAC provisioningwhich doesn't require a server side certificate but the practicality of manual PACprovisioning is rather dubious. The EAP-FAST PAC refresh mechanism on the otherhand does automatically provision keys in a secure manner but it can only be usedto maintain the PAC but does not address the need for initial PAC provisioning.

In order to beas easy as LEAP, EAP-FAST had to run "Phase 0" in anonymous Diffie-Hellman mode. An anonymous Diffie-Hellmankey exchange by definition means that you can't verify who is on the other end.In this case, a hacker can pose as your access-point and authentication server inPhase 0 and wait for an unsuspecting user to connect at phase 0 and wait for theclear text username and the hashed passwords. Since the server is obviously a fake,it would fail the server challenge and phase 0 would be aborted by the client. However,enough of the MS-CHAPv2 session has been captured to perform an offline ASLEAP attack.If the user's password is not extremely complex which is usually the case, thengame over and the hacker gains both user credentials and access to your wirelessLAN.

According to the EAP-FAST IETF draft paper,if such a man in the middle exploit is attempted, the user is to immediately changetheir password. However, there is no indication that the EAP-FAST client will automaticallywarn the user and administrator or force the password change. At least running EAP-FASTwith this convenient but weak form of automatic PAC provisioning is still significantlymore secure than running LEAP for two reasons.

    First, PAC provisioning is only done once to set up the PAC secret between the server and client and all subsequent EAP-FAST sessions skip "Phase 0". LEAP on the other hand is vulnerable each and every time a user authenticates with the radius server during the wireless LAN authentication.
    Second, even during a phase 0 anonymous DH session, the attack must be active which exposes the hacker to detection and is significantly more risky. A LEAP attacker on the other hand can perform the exploit with virtual impunity.

Even though thisis a significant improvement over LEAP, EAP-FAST can never be as secure as EAP-TLS,EAP-TTLS, or PEAP while running in this mode. EAP-FAST does provide a faster authenticationsession because it uses symmetric cryptography instead of the asymmetric cryptographythat EAP-TLS, EAP-TTLS, or PEAP uses but that's hardly an advantage. I have eventried PEAP authentication on 266 MHz PDA devices which is the slowest platform youwould run EAP on and I can't see any significant delays with PEAP. I really doubtyou will ever miss a few milliseconds on your notebook when authenticating withPEAP for wireless LAN access. Speed in deployment is what I'm concerned about andthis is where EAP-FAST falls on its face.
EAP-FAST deployment troubles

The deployment of EAP-FAST is marketed "as easy asLEAP" but the reality is not so simple. According to Cisco's own EAP-FAST deployment guide,you cannot completely rely on automatic provisioning of PAC files because it issusceptible to an active attack. The following is an excerpt from that deploymentguide.

Note: Because transmission of PACs in phase zero is secured byMS-CHAPv2 authentication and MS-CHAPv2 is vulnerable to dictionary attacks, werecommend that you limit use of automatic provisioning to initial deployment ofEAP-FAST. After a large EAP-FAST deployment, PAC provisioning should beperformed manually to ensure the highest security for PACs. For moreinformation about manual PAC provisioning, see Manual PAC Provisioning.

Source: Cisco EAP-FAST deployment guide

As you can see in the fine print, EAP-FAST deployment isnot that straight forward. You must eventually resort to manual provisioning ofuser specific PAC secrets that must be deployed with the greatest secrecy and care.The secret must even be kept from other legitimate users or else the PAC is stillcompromised because you wouldn't want multiple users knowing the same PAC.

After reading the Manual PAC Provisioning section from the same Cisco document, it becamerather amusing to see the amount of work it takes to deploy EAP-FAST in a securemanner. Having plenty of experience in deploying EAP-TLS or PEAP, I can tell youright now that EAP-FAST manual PAC provisioning is the most labor intensive wayof deploying secure authentication. In the case of PEAP, trust of the PEAP server'sdigital certificate is inherent if the certificate was purchased from a public CertificateAuthority.

Even if you didn't want to spend the $300 a year to buya digital certificate for your PEAP server, you could always build your own CertificateAuthority or self sign a digitalcertificate which could be deployed automatically using Active Directory.If your company runs Windows NT domains or some other non-Microsoft user directorywhich doesn't support automatic deployment of a Root Certificate, then the publiccertificate ".cer file" of the PEAP server couldsimply be posted on a public intranet page for users to manually install in theirroot CTL (Certificate Trust List). There is absolutely no fear of the public certificatefalling in to the wrong hands because it only contains the 1024-bit public key portionof the certificate which is practically impossible to crack.

With EAP-FAST userspecific PAC files, you literally have to generate and manage thousands (one forevery user) of unique user-specific private keys where you can't even afford a singlecompromise of a single key. You can forget about posting that on a public intranetserver let alone automatically deploying it with Active Directory group policies.Each PAC is unique and must be manually imported in to the Cisco ACU (Aironet Client Utility) on each end user's laptop. You can seewhy I chuckle when Cisco claims EAP-FAST is "easy as LEAP" because itisn't even as easy as EAP-TLS in a managed environment.
More limitations on Cisco EAP-FAST

Cisco EAP-FAST requires the use of newer Cisco Wi-Fi adapters since the older cards don't support it. CiscoEAP-FAST also requires the use of a very expensive authentication platform usingCisco ACS (Access Control Server) which ironically isn't as flexible or easy tomanage as Microsoft's built in RADIUS server IAS (Internet Authentication Service)and this is speaking from a lot of experience dealing with both platforms. The Ciscoclient also doesn't support "machine login" which is a way for a computerto log on to the network before the user signs on to Windows. For Enterprisedeployments this is extremely important because of the need for logon scripts andgroup policies to function properly. Cisco's own Websiteinstructs users to use the Microsoft Wireless Client if they wish to implement machinelogins.
The bottom line on EAP-FAST

So is Cisco's EAP-FAST an exception to the rule where you can'tget away with no PKI to facilitate secure key exchangeon a large scale? I think we can safely conclude no, it cannot. After reading throughthe deployment section, one really begins to wonder if EAP-FAST is really worthall that trouble just to avoid deploying a digital certificate on the authenticationserver because you don't want to build a PKI Certificate Authority or because youdon't want to purchase a $300 digital certificate every year. If you were hopingthat EAP-FAST was going to be your savior, it won't happen since it can never be"as easy as LEAP" if it wants to be secure like PEAP. The best solutionis to use PEAPauthentication.

		11.1.2 Wrong password


<URL:/cygdrive/c/work/acs/RFCs/EAP-GTC/rfc5421.txt>
<URL:/cygdrive/c/work/acs/PKI/draft-hzhou-pppext-peapv1-00.txt>

		11.1.3 openSSL layer

			11.1.3.1 http://fixunix.com/openssl/152751-re-openssl-eap-fast-clienthello-ext-no-certificates.html 
Re: OpenSSL and EAP-FAST (ClientHello ext and no certificates)

 

--oLBj+sq0vYjzfsbl
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

On Tue, Jun 07, 2005 at 03:40:58PM +0300, Alexey Kobozev wrote:

> I've checked your patch and seems like you're not fully aware of what
> actually needed to support EAP-FAST in OpenSSL. There are actually
> two things:
> 1. TLS client hello extension support
> 2. Ability to perform the TLS session resume based on externally
> negotiated pre-shared key material.

Unfortunately, I missed your email to the mailing list and it took this
long to finally notice it.

I was doing the same part of copying s->session->master_key, but not as
a callback. This made me miss the part of setting s->hit and having to
workaround the other parts of the message processing. Your patch was
quite helpful in understanding how this can be done properly.

> Attached is the patch made for OpenSSL 0.9.8 beta 2, which includes the
> following modifications and updates for both server and client:
>
> - Client can attach additional data (PAC) to client hello using the newly added
> SSL_set_hello_extension() function.

This worked nicely and is certainly more generic way of doing this than
the quick test version I was using.

> - Client and server can register the callback, which will be called while creating
> TLS session. This callback provides the pre-shared secret for TLS session.
> This callback has cipher suites input and output parameters, which can be used
> to affect the cipher suite choice.

I needed to modify this part a bit to get EAP-FAST working. First, I was
triggering a segfault since my callback function did not set pref_cipher
to NULL and the variable happened to get non-NULL value.. I changed your
code for the client case to set pref_cipher=NULL before calling the
callback. Actually, this was already done in the server case.

After this, I was hitting a problem where the server was setting Session
ID length to zero and s->hit was cleared immediately after having been
set after successful tls_session_secret_cb call. ssl3_get_server_hello()
seems to be requiring that Session ID length is non-zero (j != 0 after
the tls_session_secret_cb). I don't know whether the EAP server was
supposed to set this to non-zero, but at least it did not seem to do
this in my tests, so I added some more code to allow s->hit being set
even if Session ID length is zero, but tls_session_secret_cb is
completed successfully. This allowed me to complete EAP-FAST
authentication. I changed wpa_supplicant to use this patch.

> P.S. I'd like this patch (with some modifications maybe) to be considered for committing
> it to current or future versions of OpenSSL.

I'd second this. The attached patch is a combination of your separate
t1_ext.c file and the other changes with the small modifications
mentioned above. This is against OpenSSL 0.9.8 beta 6.

--
Jouni Malinen PGP id EFC895FA

--oLBj+sq0vYjzfsbl
Content-Type: text/plain; charset=us-ascii
Content-Disposition: attachment; filename="openssl-098b6-ext.patch"

diff -uprN openssl-0.9.8-beta6.orig/include/openssl/ssl.h openssl-0.9.8-beta6/include/openssl/ssl.h
--- openssl-0.9.8-beta6.orig/include/openssl/ssl.h	2005-06-10 12:51:16.000000000 -0700
+++ openssl-0.9.8-beta6/include/openssl/ssl.h	2005-06-29 22:17:29.000000000 -0700
@@ -340,6 +340,7 @@ extern "C" {
* 'struct ssl_st *' function parameters used to prototype callbacks
* in SSL_CTX. */
typedef struct ssl_st *ssl_crock_st;
+typedef struct tls_extension_st TLS_EXTENSION;

/* used to hold info on the particular ciphers used */
typedef struct ssl_cipher_st
@@ -361,6 +362,8 @@ DECLARE_STACK_OF(SSL_CIPHER)
typedef struct ssl_st SSL;
typedef struct ssl_ctx_st SSL_CTX;

+typedef int (*tls_session_secret_cb_fn)(SSL *s, void *secret, int *secret_len, STACK_OF(SSL_CIPHER) *peer_ciphers, SSL_CIPHER **cipher, void *arg);
+
/* Used to hold functions for SSLv2 or SSLv3/TLSv1 functions */
typedef struct ssl_method_st
{
@@ -968,6 +971,15 @@ struct ssl_st
int first_packet;
int client_version;	/* what was passed, used for
* SSLv3/TLS rollback check */
+
+	/* TLS externsions */
+	TLS_EXTENSION *tls_extension;
+	int (*tls_extension_cb)(SSL *s, TLS_EXTENSION *tls_ext, void *arg);
+	void *tls_extension_cb_arg;
+
+	/* TLS pre-shared secret session resumption */
+	tls_session_secret_cb_fn tls_session_secret_cb;
+	void *tls_session_secret_cb_arg;
};

#ifdef __cplusplus
@@ -1533,6 +1545,13 @@ void *SSL_COMP_get_compression_methods(v
int SSL_COMP_add_compression_method(int id,void *cm);
#endif

+/* TLS extensions functions */
+int SSL_set_hello_extension(SSL *s, int ext_type, void *ext_data, int ext_len);
+int SSL_set_hello_extension_cb(SSL *s, int (*cb)(SSL *, TLS_EXTENSION *, void *), void *arg);
+
+/* Pre-shared secret session resumption functions */
+int SSL_set_session_secret_cb(SSL *s, tls_session_secret_cb_fn tls_session_secret_cb, void *arg);
+
/* BEGIN ERROR CODES */
/* The following lines are auto generated by the script mkerr.pl. Any changes
* made after this point may be overwritten when the script is next run.
@@ -1714,6 +1733,7 @@ void ERR_load_SSL_strings(void);
#define SSL_F_TLS1_ENC	 210
#define SSL_F_TLS1_SETUP_KEY_BLOCK	 211
#define SSL_F_WRITE_PENDING	 212
+#define SSL_F_SSL_SET_HELLO_EXTENSION	 213

/* Reason codes. */
#define SSL_R_APP_DATA_IN_HANDSHAKE	 100
diff -uprN openssl-0.9.8-beta6.orig/include/openssl/tls1.h openssl-0.9.8-beta6/include/openssl/tls1.h
--- openssl-0.9.8-beta6.orig/include/openssl/tls1.h	2003-07-22 05:34:21.000000000 -0700
+++ openssl-0.9.8-beta6/include/openssl/tls1.h	2005-06-29 22:17:29.000000000 -0700
@@ -282,6 +282,14 @@ extern "C" {
#define TLS_MD_MASTER_SECRET_CONST "\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x 74" /*master secret*/
#endif

+/* TLS extension struct */
+struct tls_extension_st
+{
+	unsigned short type;
+	unsigned short length;
+	void *data;
+};
+
#ifdef __cplusplus
}
#endif
diff -uprN openssl-0.9.8-beta6.orig/ssl/Makefile openssl-0.9.8-beta6/ssl/Makefile
--- openssl-0.9.8-beta6.orig/ssl/Makefile	2005-05-30 16:20:30.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/Makefile	2005-06-29 22:17:29.000000000 -0700
@@ -24,7 +24,7 @@ LIBSRC=	\
s2_meth.c s2_srvr.c s2_clnt.c s2_lib.c s2_enc.c s2_pkt.c \
s3_meth.c s3_srvr.c s3_clnt.c s3_lib.c s3_enc.c s3_pkt.c s3_both.c \
s23_meth.c s23_srvr.c s23_clnt.c s23_lib.c s23_pkt.c \
-	t1_meth.c t1_srvr.c t1_clnt.c t1_lib.c t1_enc.c \
+	t1_meth.c t1_srvr.c t1_clnt.c t1_lib.c t1_enc.c t1_ext.c \
d1_meth.c d1_srvr.c d1_clnt.c d1_lib.c d1_pkt.c \
d1_both.c d1_enc.c \
ssl_lib.c ssl_err2.c ssl_cert.c ssl_sess.c \
@@ -35,7 +35,7 @@ LIBOBJ= \
s2_meth.o s2_srvr.o s2_clnt.o s2_lib.o s2_enc.o s2_pkt.o \
s3_meth.o s3_srvr.o s3_clnt.o s3_lib.o s3_enc.o s3_pkt.o s3_both.o \
s23_meth.o s23_srvr.o s23_clnt.o s23_lib.o s23_pkt.o \
-	t1_meth.o t1_srvr.o t1_clnt.o t1_lib.o t1_enc.o \
+	t1_meth.o t1_srvr.o t1_clnt.o t1_lib.o t1_enc.o t1_ext.o \
d1_meth.o d1_srvr.o d1_clnt.o d1_lib.o d1_pkt.o \
d1_both.o d1_enc.o \
ssl_lib.o ssl_err2.o ssl_cert.o ssl_sess.o \
@@ -968,3 +968,4 @@ t1_srvr.o: ../include/openssl/ssl23.h ..
t1_srvr.o: ../include/openssl/stack.h ../include/openssl/symhacks.h
t1_srvr.o: ../include/openssl/tls1.h ../include/openssl/x509.h
t1_srvr.o: ../include/openssl/x509_vfy.h ssl_locl.h t1_srvr.c
+t1_ext.o: t1_ext.c ssl_locl.h
diff -uprN openssl-0.9.8-beta6.orig/ssl/s3_clnt.c openssl-0.9.8-beta6/ssl/s3_clnt.c
--- openssl-0.9.8-beta6.orig/ssl/s3_clnt.c	2005-05-16 03:11:03.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/s3_clnt.c	2005-06-30 20:52:03.000000000 -0700
@@ -606,6 +606,20 @@ int ssl3_client_hello(SSL *s)
}
*(p++)=0; /* Add the NULL method */

+	 /* send client hello extensions if any */
+	 if (s->version >= TLS1_VERSION && s->tls_extension)
+	 {
+	 // set the total extensions length
+	 s2n(s->tls_extension->length + 4, p);
+
+	 // put the extensions with type and length
+	 s2n(s->tls_extension->type, p);
+	 s2n(s->tls_extension->length, p);
+
+	 memcpy(p, s->tls_extension->data, s->tls_extension->length);
+	 p+=s->tls_extension->length;
+	 }
+
l=(p-d);
d=buf;
*(d++)=SSL3_MT_CLIENT_HELLO;
@@ -628,7 +642,7 @@ int ssl3_get_server_hello(SSL *s)
STACK_OF(SSL_CIPHER) *sk;
SSL_CIPHER *c;
unsigned char *p,*d;
-	int i,al,ok;
+	int i,al,ok,pre_shared;
unsigned int j;
long n;
SSL_COMP *comp;
@@ -693,7 +707,24 @@ int ssl3_get_server_hello(SSL *s)
goto f_err;
}

-	if (j != 0 && j == s->session->session_id_length
+	/* check if we want to resume the session based on external pre-shared secret */
+	pre_shared = 0;
+	if (s->version >= TLS1_VERSION && s->tls_session_secret_cb)
+	{
+	 SSL_CIPHER *pref_cipher=NULL;
+	 s->session->master_key_length=sizeof(s->session->master_key);
+	 if (s->tls_session_secret_cb(s, s->session->master_key, &s->session->master_key_length,
+	 NULL, &pref_cipher, s->tls_session_secret_cb_arg))
+	 {
+	 s->hit=1;
+	 s->session->cipher=pref_cipher ? pref_cipher : ssl_get_cipher_by_char(s,p+j);
+	 s->session->session_id_length = j;
+	 memcpy(s->session->session_id, p, j);
+	 pre_shared = 1;
+	 }
+	}
+
+	if ((pre_shared || j != 0) && j == s->session->session_id_length
&& memcmp(p,s->session->session_id,j) == 0)
{
if(s->sid_ctx_length != s->session->sid_ctx_length
diff -uprN openssl-0.9.8-beta6.orig/ssl/s3_srvr.c openssl-0.9.8-beta6/ssl/s3_srvr.c
--- openssl-0.9.8-beta6.orig/ssl/s3_srvr.c	2005-05-22 17:32:55.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/s3_srvr.c	2005-06-29 22:17:29.000000000 -0700
@@ -955,6 +955,75 @@ int ssl3_get_client_hello(SSL *s)
}
#endif

+	/* Check for TLS client hello extension here */
+	if (p < (d+n) && s->version >= TLS1_VERSION)
+	{
+	 if (s->tls_extension_cb)
+	 {
+	 TLS_EXTENSION tls_ext;
+	 unsigned short ext_total_len;
+
+	 n2s(p, ext_total_len);
+	 n2s(p, tls_ext.type);
+	 n2s(p, tls_ext.length);
+
+	 // sanity check in TLS extension len
+	 if (tls_ext.length > (d+n) - p)
+	 {
+	 // just cut the lenth to packet border
+	 tls_ext.length = (d+n) - p;
+	 }
+
+	 tls_ext.data = p;
+
+	 // returns an alert code or 0
+	 al = s->tls_extension_cb(s, &tls_ext, s->tls_extension_cb_arg);
+	 if (al != 0)
+	 {
+	 SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO,SSL_R_PEER_ERRO R);
+	 goto f_err;
+	 }
+	 }
+	}
+
+	/* Check if we want to use external pre-shared secret for this handshake */
+	/* for not reused session only */
+	if (!s->hit && s->version >= TLS1_VERSION && s->tls_session_secret_cb)
+	{
+	 SSL_CIPHER *pref_cipher=NULL;
+
+	 s->session->master_key_length=sizeof(s->session->master_key);
+	 if(s->tls_session_secret_cb(s, s->session->master_key, &s->session->master_key_length,
+	 ciphers, &pref_cipher, s->tls_session_secret_cb_arg))
+	 {
+	 s->hit=1;
+	 s->session->ciphers=ciphers;
+	 s->session->verify_result=X509_V_OK;
+
+	 ciphers=NULL;
+
+	 /* check if some cipher was preferred by call back */
+	 pref_cipher=pref_cipher ? pref_cipher : ssl3_choose_cipher(s, s->session->ciphers, SSL_get_ciphers(s));
+	 if (pref_cipher == NULL)
+	 {
+	 al=SSL_AD_HANDSHAKE_FAILURE;
+	 SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO,SSL_R_NO_SHARED _CIPHER);
+	 goto f_err;
+	 }
+
+	 s->session->cipher=pref_cipher;
+
+	 if (s->cipher_list)
+	 sk_SSL_CIPHER_free(s->cipher_list);
+
+	 if (s->cipher_list_by_id)
+	 sk_SSL_CIPHER_free(s->cipher_list_by_id);
+
+	 s->cipher_list = sk_SSL_CIPHER_dup(s->session->ciphers);
+	 s->cipher_list_by_id = sk_SSL_CIPHER_dup(s->session->ciphers);
+	 }
+	}
+
/* Given s->session->ciphers and SSL_get_ciphers, we must
* pick a cipher */

diff -uprN openssl-0.9.8-beta6.orig/ssl/ssl_err.c openssl-0.9.8-beta6/ssl/ssl_err.c
--- openssl-0.9.8-beta6.orig/ssl/ssl_err.c	2005-06-10 12:51:16.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/ssl_err.c	2005-06-29 22:17:29.000000000 -0700
@@ -242,6 +242,7 @@ static ERR_STRING_DATA SSL_str_functs[]=
{ERR_FUNC(SSL_F_TLS1_ENC),	"TLS1_ENC"},
{ERR_FUNC(SSL_F_TLS1_SETUP_KEY_BLOCK),	"TLS1_SETUP_KEY_BLOCK"},
{ERR_FUNC(SSL_F_WRITE_PENDING),	"WRITE_PENDING"},
+{ERR_FUNC(SSL_F_SSL_SET_HELLO_EXTENSION), "SSL_set_hello_extension"},
{0,NULL}
};

diff -uprN openssl-0.9.8-beta6.orig/ssl/ssl.h openssl-0.9.8-beta6/ssl/ssl.h
--- openssl-0.9.8-beta6.orig/ssl/ssl.h	2005-06-10 12:51:16.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/ssl.h	2005-06-29 22:17:29.000000000 -0700
@@ -340,6 +340,7 @@ extern "C" {
* 'struct ssl_st *' function parameters used to prototype callbacks
* in SSL_CTX. */
typedef struct ssl_st *ssl_crock_st;
+typedef struct tls_extension_st TLS_EXTENSION;

/* used to hold info on the particular ciphers used */
typedef struct ssl_cipher_st
@@ -361,6 +362,8 @@ DECLARE_STACK_OF(SSL_CIPHER)
typedef struct ssl_st SSL;
typedef struct ssl_ctx_st SSL_CTX;

+typedef int (*tls_session_secret_cb_fn)(SSL *s, void *secret, int *secret_len, STACK_OF(SSL_CIPHER) *peer_ciphers, SSL_CIPHER **cipher, void *arg);
+
/* Used to hold functions for SSLv2 or SSLv3/TLSv1 functions */
typedef struct ssl_method_st
{
@@ -968,6 +971,15 @@ struct ssl_st
int first_packet;
int client_version;	/* what was passed, used for
* SSLv3/TLS rollback check */
+
+	/* TLS externsions */
+	TLS_EXTENSION *tls_extension;
+	int (*tls_extension_cb)(SSL *s, TLS_EXTENSION *tls_ext, void *arg);
+	void *tls_extension_cb_arg;
+
+	/* TLS pre-shared secret session resumption */
+	tls_session_secret_cb_fn tls_session_secret_cb;
+	void *tls_session_secret_cb_arg;
};

#ifdef __cplusplus
@@ -1533,6 +1545,13 @@ void *SSL_COMP_get_compression_methods(v
int SSL_COMP_add_compression_method(int id,void *cm);
#endif

+/* TLS extensions functions */
+int SSL_set_hello_extension(SSL *s, int ext_type, void *ext_data, int ext_len);
+int SSL_set_hello_extension_cb(SSL *s, int (*cb)(SSL *, TLS_EXTENSION *, void *), void *arg);
+
+/* Pre-shared secret session resumption functions */
+int SSL_set_session_secret_cb(SSL *s, tls_session_secret_cb_fn tls_session_secret_cb, void *arg);
+
/* BEGIN ERROR CODES */
/* The following lines are auto generated by the script mkerr.pl. Any changes
* made after this point may be overwritten when the script is next run.
@@ -1714,6 +1733,7 @@ void ERR_load_SSL_strings(void);
#define SSL_F_TLS1_ENC	 210
#define SSL_F_TLS1_SETUP_KEY_BLOCK	 211
#define SSL_F_WRITE_PENDING	 212
+#define SSL_F_SSL_SET_HELLO_EXTENSION	 213

/* Reason codes. */
#define SSL_R_APP_DATA_IN_HANDSHAKE	 100
diff -uprN openssl-0.9.8-beta6.orig/ssl/ssl_sess.c openssl-0.9.8-beta6/ssl/ssl_sess.c
--- openssl-0.9.8-beta6.orig/ssl/ssl_sess.c	2005-04-29 13:10:06.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/ssl_sess.c	2005-06-29 22:17:29.000000000 -0700
@@ -656,6 +656,15 @@ long SSL_CTX_get_timeout(const SSL_CTX *
return(s->session_timeout);
}

+int SSL_set_session_secret_cb(SSL *s, int (*tls_session_secret_cb)(SSL *s, void *secret, int *secret_len,
+	STACK_OF(SSL_CIPHER) *peer_ciphers, SSL_CIPHER **cipher, void *arg), void *arg)
+{
+	if (s == NULL) return(0);
+	s->tls_session_secret_cb = tls_session_secret_cb;
+	s->tls_session_secret_cb_arg = arg;
+	return(1);
+}
+
typedef struct timeout_param_st
{
SSL_CTX *ctx;
diff -uprN openssl-0.9.8-beta6.orig/ssl/t1_ext.c openssl-0.9.8-beta6/ssl/t1_ext.c
--- openssl-0.9.8-beta6.orig/ssl/t1_ext.c	1969-12-31 16:00:00.000000000 -0800
+++ openssl-0.9.8-beta6/ssl/t1_ext.c	2005-06-29 22:30:22.000000000 -0700
@@ -0,0 +1,45 @@
+
+#include 
+#include "ssl_locl.h"
+
+
+int SSL_set_hello_extension(SSL *s, int ext_type, void *ext_data, int ext_len)
+{
+	if(s->version >= TLS1_VERSION)
+	{
+	 if(s->tls_extension)
+	 {
+	 OPENSSL_free(s->tls_extension);
+	 s->tls_extension = NULL;
+	 }
+
+	 s->tls_extension = OPENSSL_malloc(sizeof(TLS_EXTENSION) + ext_len);
+	 if(!s->tls_extension)
+	 {
+	 SSLerr(SSL_F_SSL_SET_HELLO_EXTENSION, ERR_R_MALLOC_FAILURE);
+	 return 0;
+	 }
+
+	 s->tls_extension->type = ext_type;
+	 s->tls_extension->length = ext_len;
+	 s->tls_extension->data = s->tls_extension + 1;
+	 memcpy(s->tls_extension->data, ext_data, ext_len);
+
+	 return 1;
+	}
+
+	return 0;
+}
+
+int SSL_set_hello_extension_cb(SSL *s, int (*cb)(SSL *, TLS_EXTENSION *, void *), void *arg)
+{
+	if(s->version >= TLS1_VERSION)
+	{
+	 s->tls_extension_cb = cb;
+	 s->tls_extension_cb_arg = arg;
+
+	 return 1;
+	}
+
+	return 0;
+}
diff -uprN openssl-0.9.8-beta6.orig/ssl/t1_lib.c openssl-0.9.8-beta6/ssl/t1_lib.c
--- openssl-0.9.8-beta6.orig/ssl/t1_lib.c	2005-04-26 09:02:40.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/t1_lib.c	2005-06-29 22:17:29.000000000 -0700
@@ -131,6 +131,10 @@ int tls1_new(SSL *s)

void tls1_free(SSL *s)
{
+	if(s->tls_extension)
+	{
+	 OPENSSL_free(s->tls_extension);
+	}
ssl3_free(s);
}

diff -uprN openssl-0.9.8-beta6.orig/ssl/tls1.h openssl-0.9.8-beta6/ssl/tls1.h
--- openssl-0.9.8-beta6.orig/ssl/tls1.h	2003-07-22 05:34:21.000000000 -0700
+++ openssl-0.9.8-beta6/ssl/tls1.h	2005-06-29 22:17:29.000000000 -0700
@@ -282,6 +282,14 @@ extern "C" {
#define TLS_MD_MASTER_SECRET_CONST "\x6d\x61\x73\x74\x65\x72\x20\x73\x65\x63\x72\x65\x 74" /*master secret*/
#endif

+/* TLS extension struct */
+struct tls_extension_st
+{
+	unsigned short type;
+	unsigned short length;
+	void *data;
+};
+
#ifdef __cplusplus
}
#endif
diff -uprN openssl-0.9.8-beta6.orig/util/ssleay.num openssl-0.9.8-beta6/util/ssleay.num
--- openssl-0.9.8-beta6.orig/util/ssleay.num	2005-05-08 17:22:02.000000000 -0700
+++ openssl-0.9.8-beta6/util/ssleay.num	2005-06-29 22:17:29.000000000 -0700
@@ -226,3 +226,6 @@ DTLSv1_server_method
SSL_COMP_get_compression_methods 276	EXIST:!VMS:FUNCTION:COMP
SSL_COMP_get_compress_methods 276	EXIST:VMS:FUNCTION:COMP
SSL_SESSION_get_id 277	EXIST::FUNCTION:
+SSL_set_hello_extension	 278	EXIST::FUNCTION:
+SSL_set_hello_extension_cb	 279	EXIST::FUNCTION:
+SSL_set_session_secret_cb	 280	EXIST::FUNCTION:


			11.1.3.2 OpenSSL and EAP-FAST (ClientHello ext and no certificates)

EAP-FAST has some additional requirements for TLS that do not seem to be
currently supported in OpenSSL. EAP-FAST uses ClientHello extension (RFC
3546, Section 3.1) and it does not use certificates in TLS handshake;
instead, TLS pre-master-secret is set based on PAC-Key (shared secret
from EAP-FAST provisioning).

I have made a proof-of-concept type of patch for OpenSSL to allow
testing EAP-FAST implementation in wpa_supplicant. This seems to be
enough to make EAP-FAST interoperate with Cisco ACS. However, the
changes to OpenSSL are not very clean and may very well be completely
incorrect. Consequently, I would be interested in finding out whether
someone with better understanding of OpenSSL than I have would be
interested in commenting the changes, or even better, in actually making
such changes to OpenSSL distribution.

I've attached the patch file showing the changes I needed to get
EAP-FAST authentication completed. This adds a simple way of adding
ClientHello extensions (RFC 3546, Section 3.1). More generic support for
TLS extensions would of course be ok for this, too. Rest of the patch is
very quick hack to allow TLS handshake to be completed without
certificates; I just changed number of functions to skip certificate
request and validation during the handshake. This is clearly not
suitable to be applied as-is, but I hope it would be enough to generate
some comments on how this should be done correctly.

--
This is a quick hack for testing EAP-FAST with openssl.
(Continue reading)

Permalink | Reply | 
headers Alexey Kobozev | 7 Jun 14:40
  
 
RE: OpenSSL and EAP-FAST (ClientHello ext and no certificates)


Hi Jouni!

I've checked your patch and seems like you're not fully aware of what
actually needed to support EAP-FAST in OpenSSL. There are actually 
two things: 
a. TLS client hello extension support 
b. Ability to perform the TLS session resume based on externally 
negotiated pre-shared key material.

There are two phases in EAP-FAST: PAC provisioning and authentication.
PAC provisioning requires anonymous Diffie-Hellman TLS handshake, which doesn't
involve certificates. This feature doesn't require any code change in OpenSSL.
The authentication phase involves use of TLS client hello extension and
TLS session resume based on pre-shared secret extracted from PAC received
in client hello extension.

Attached is the patch made for OpenSSL 0.9.8 beta 2, which includes the 
following modifications and updates for both server and client:

- Client can attach additional data (PAC) to client hello using the newly added 
SSL_set_hello_extension() function.

- Server can process the client hello extension by registering the extension handler 
callback using SSL_set_hello_extension_cb() function (this callback can decrypt
PAC and extract pre-shared secret from it).

- Client and server can register the callback, which will be called while creating
TLS session. This callback provides the pre-shared secret for TLS session.
This callback has cipher suites input and output parameters, which can be used
(Continue reading)

Permalink | Reply | 
headers Jouni Malinen | 1 Jul 06:37
  
 
Re: OpenSSL and EAP-FAST (ClientHello ext and no certificates)

On Tue, Jun 07, 2005 at 03:40:58PM +0300, Alexey Kobozev wrote:

> I've checked your patch and seems like you're not fully aware of what
> actually needed to support EAP-FAST in OpenSSL. There are actually 
> two things: 
> 1. TLS client hello extension support 
> 2. Ability to perform the TLS session resume based on externally 
> negotiated pre-shared key material.

Unfortunately, I missed your email to the mailing list and it took this
long to finally notice it.

I was doing the same part of copying s->session->master_key, but not as
a callback. This made me miss the part of setting s->hit and having to
workaround the other parts of the message processing. Your patch was
quite helpful in understanding how this can be done properly.

> Attached is the patch made for OpenSSL 0.9.8 beta 2, which includes the 
> following modifications and updates for both server and client:
> 
> - Client can attach additional data (PAC) to client hello using the newly added 
> SSL_set_hello_extension() function.

This worked nicely and is certainly more generic way of doing this than
the quick test version I was using.

> - Client and server can register the callback, which will be called while creating
> TLS session. This callback provides the pre-shared secret for TLS session.
> This callback has cipher suites input and output parameters, which can be used
> to affect the cipher suite choice. 
(Continue reading)

Permalink | Reply | 
headers Alexey Kobozev | 4 Jul 10:39
  
 
RE: OpenSSL and EAP-FAST (ClientHello ext and no certificates)


Hi Jouni,

That's great. So now we have fixed, working and verified patch that can
be proposed as contribution to OpenSSL.

Do you know what needs to be done to put this patch for consideration
of making it to be a part of OpenSSL?

Thanks! 

[skip]
______________________________________________________________________
OpenSSL Project                                 http://www.openssl.org
Development Mailing List                       openssl-dev <at> openssl.org
Automated List Manager                           majordomo <at> openssl.org

Permalink | Reply | 
headers Jouni Malinen | 20 Jul 05:38
  
 
Re: OpenSSL and EAP-FAST (ClientHello ext and no certificates)

On Mon, Jul 04, 2005 at 11:39:26AM +0300, Alexey Kobozev wrote:

> That's great. So now we have fixed, working and verified patch that can
> be proposed as contribution to OpenSSL.

One additional change makes the features easier to use: allow extension
to be removed. The attached patch does this for the case where ext_data
for SSL_set_hello_extension() is NULL. In addition, this is diffed
against 0.9.8, not a beta version.

> Do you know what needs to be done to put this patch for consideration
> of making it to be a part of OpenSSL?

README file has information on how to contribute to OpenSSL. If you are
outside US, it looks like the only missing part would be in adding
string "[PATCH]" to the subject line when sending the patch to this
mailing list.

--
diff -uprN openssl-0.9.8.orig/include/openssl/ssl.h openssl-0.9.8/include/openssl/ssl.h
--- openssl-0.9.8.orig/include/openssl/ssl.h	2005-06-10 12:51:16.000000000 -0700
+++ openssl-0.9.8/include/openssl/ssl.h	2005-07-19 20:02:15.000000000 -0700
@@ -340,6 +340,7 @@ extern "C" {
  * 'struct ssl_st *' function parameters used to prototype callbacks
  * in SSL_CTX. */
 typedef struct ssl_st *ssl_crock_st;
+typedef struct tls_extension_st TLS_EXTENSION;
(Continue reading)

Permalink | Reply | 
headers Alexey Kobozev | 20 Jul 14:22
  
 
RE: OpenSSL and EAP-FAST (ClientHello ext and no certificates)


Hi Jouni!

I'll send the patch with explanations a bit later.
Thanks for your time and information.

> -----Original Message-----
> From: Jouni Malinen [mailto:jm <at> jm.kir.nu] On Behalf Of Jouni Malinen
> Sent: Wednesday, July 20, 2005 6:38 AM
> To: Alexey Kobozev
> Cc: openssl-dev <at> openssl.org
> Subject: Re: OpenSSL and EAP-FAST (ClientHello ext and no 
> certificates)
> 
> On Mon, Jul 04, 2005 at 11:39:26AM +0300, Alexey Kobozev wrote:
> 
> > That's great. So now we have fixed, working and verified patch that 
> > can be proposed as contribution to OpenSSL.
> 
> One additional change makes the features easier to use: allow 
> extension to be removed. The attached patch does this for the 
> case where ext_data for SSL_set_hello_extension() is NULL. In 
> addition, this is diffed against 0.9.8, not a beta version.
> 
> > Do you know what needs to be done to put this patch for 
> consideration 
> > of making it to be a part of OpenSSL?
> 
> README file has information on how to contribute to OpenSSL. 
> If you are outside US, it looks like the only missing part 
(Continue reading)

			11.1.3.3
		11.1.4
	11.2 PEAP


		11.2.1 wiki,http://en.wikipedia.org/wiki/Protected_Extensible_Authentication_Protocol 
Protected Extensible Authentication Protocol
From Wikipedia, the free encyclopedia

    PEAP is also an acronym for Personal Egress Air Packs.

The Protected Extensible Authentication Protocol, also known as Protected EAP or simply PEAP, is a protocol that encapsulates the Extensible Authentication Protocol (EAP) within an encrypted and authenticated Transport Layer Security (TLS) tunnel.[1][2][3] The purpose was to correct deficiencies in EAP; EAP assumed a protected communication channel, such as that provided by physical security, so facilities for protection of the EAP conversation were not provided.[4]

PEAP was jointly developed by Cisco Systems, Microsoft, and RSA Security. PEAPv0 was the version included with Microsoft Windows XP and was nominally defined in draft-kamath-pppext-peapv0-00. PEAPv1 and PEAPv2 were defined in different versions of draft-josefsson-pppext-eap-tls-eap. PEAPv1 was defined in draft-josefsson-pppext-eap-tls-eap-00 through draft-josefsson-pppext-eap-tls-eap-05,[5] and PEAPv2 was defined in versions beginning with draft-josefsson-pppext-eap-tls-eap-06.[6]

The protocol only specifies chaining multiple EAP mechanisms and not any specific method.[2][7] However, use of the EAP-MSCHAPv2 and EAP-GTC methods are the most commonly supported.[citation needed]
Contents
[hide]

    1 Overview
    2 PEAPv0 with EAP-MSCHAPv2
    3 PEAPv1 with EAP-GTC
    4 References
    5 External links

[edit] Overview

PEAP is similar in design to EAP-TTLS, requiring only a server-side PKI certificate to create a secure TLS tunnel to protect user authentication, and uses server-side public key certificates to authenticate the server. It then creates an encrypted TLS tunnel between the client and the authentication server. In most configurations, the keys for this encryption are transported using the server's public key. The ensuing exchange of authentication information inside the tunnel to authenticate the client is then encrypted and user credentials are safe from eavesdropping.

As of May 2005, there were two PEAP sub-types certified for the updated WPA and WPA2 standard. They are:

    PEAPv0/EAP-MSCHAPv2
    PEAPv1/EAP-GTC

PEAPv0 and PEAPv1 both refer to the outer authentication method and are the mechanisms that create the secure TLS tunnel to protect subsequent authentication transactions. EAP-MSCHAPv2, EAP-GTC, and EAP-SIM refer to the inner authentication methods which provide user or device authentication.

Within Cisco products, PEAPv0 supports inner EAP methods EAP-MSCHAPv2 and EAP-SIM while PEAPv1 supports inner EAP methods EAP-GTC and EAP-SIM. Since Microsoft only supports PEAPv0 and doesn’t support PEAPv1, Microsoft simply calls PEAPv0 PEAP without the v0 or v1 designator. Another difference between Microsoft and Cisco is that Microsoft only supports the EAP-MSCHAPv2 method and not the EAP-SIM method.

However, Microsoft supports another form of PEAPv0 (which Microsoft calls PEAP-EAP-TLS) that Cisco and other third-party server and client software don’t support. PEAP-EAP-TLS requires client installation of a client-side digital certificate or a more secure smartcard. PEAP-EAP-TLS is very similar in operation to the original EAP-TLS but provides slightly more protection because portions of the client certificate that are unencrypted in EAP-TLS are encrypted in PEAP-EAP-TLS. Ultimately, PEAPv0/EAP-MSCHAPv2 is by far the most prevalent implementation of PEAP, due to the integration of PEAPv0 into Microsoft Windows products. Cisco's CSSC client now supports PEAP-EAP-TLS.

PEAP has been so successful in the market place that even Funk Software, the defunct inventor and backer of EAP-TTLS, had no choice but to support PEAP in their server and client software for wireless networks.
[edit] PEAPv0 with EAP-MSCHAPv2

PEAPv0/EAP-MSCHAPv2 is the most common form of PEAP in use, and what is usually referred to as PEAP. The inner authentication protocol is Microsoft's Challenge Handshake Authentication Protocol, meaning it allows authentication to databases that support the MS-CHAPv2 format, including Microsoft NT and Microsoft Active Directory.

Behind EAP-TLS, PEAPv0/EAP-MSCHAPv2 is the second most widely supported EAP standard in the world. There are client and server implementations of it from various vendors, including support in all recent releases from Microsoft, Apple Computer and Cisco. Other implementations exist, such as the xsupplicant from the Open1x.org project, and wpa supplicant.

As with other 802.1X and EAP types, dynamic encryption can be used with PEAP.

A CA certificate must be used at each client to authenticate the server to each client before the client submits authentication credentials. If the CA certificate is not validated it is generally trivially easy (in wireless networks) to introduce a fake Access Point which allows gathering MS-CHAPv2 handshakes, which on recent hardware can be cracked in a matter of seconds.
[edit] PEAPv1 with EAP-GTC

PEAPv1/EAP-GTC was created by Cisco to provide interoperability with existing token card and directory based authentication systems via a protected channel. Even though Microsoft co-invented the PEAP standard, Microsoft never added support for PEAPv1 in general, which means PEAPv1/EAP-GTC has no native Windows OS support. Since Cisco has typically recommended lightweight EAP protocols such as LEAP and EAP-FAST protocols instead of PEAP, PEAP has not been as widely adopted as some had hoped.

With no interest from Microsoft to support PEAPv1 and no promotion from Cisco, PEAPv1 authentication is rarely used.[when?] Even in Windows 7, released in late 2009, Microsoft has not added support for any other authentication system other than MSCHAPv2.

As of 2010, there are very few operating systems with native support for this EAP protocol. Nokia E66 and later mobile phones ship with a version of Symbian which includes EAP-GTC support.

	11.3


12. FAQS

	12.1 What hostname formats are supported by ACS when working with AD?
ACS 5.x (and ACS 4.x as far as I recall) supports the next formats for hostname:
| 1.	hostname$ (matched/authenticated against sAMAccountName)
| 2.	NTLMDOMAIN\hostname$  (matched/authenticated against sAMAccountName + NTLMDOMAIN)
| 3.	host/hostname (matched/authenticated against short 'servicePrincipalName')
| 4.	host/hostname.dnsdomain.com  (matched/authenticated against fully qualified 'servicePrincipalName')

	12.2 What fields from user certificate can be used for Authorization policy?

		12.2.1 email:

(+ dev group)

Hi Kemal,

That’s correct. The customer can also get the actual list on the fly by going to Policy Elements > Session Conditions > Custom > Create, then choosing “Certificate Dictionary” and hitting select.

Thx,
Yosi
From: Kemal Akozer (kemal) 
Sent: Friday, September 23, 2011 5:14 AM
To: Yosi Izaq (yizaq)
Cc: Shelly Cadora (scadora); Gert Tilburgs (gtilburg); cs-ibns(mailer list); cs-ciscosecure (mailer list)
Subject: Re: ACS 5.2 dot1x PKI requirements

Forgot to add Yosi.

Kemal Akozer wrote:
Adding Yosi.

If I understand the question correctly, the following fields in a certificate can be compared in a policy rule in ACS 5.2 : 
Common Name String 
Country String 
Email String 
LocationSubject String 
Organization String 
Organization Unit String 
State or Province String 
Subject String 
Subject Alternative Name String 
Subject Alternative Name - DNS String 
Subject Alternative Name - EMail String 
Subject Alternative Name - Other Name String 
Subject Serial Number String
 
Kemal


Shelly Cadora (scadora) wrote:
Including ACS team.
 
From: Gert Tilburgs (gtilburg) 
Sent: Wednesday, September 21, 2011 7:53 AM
To: cs-ibns(mailer list)
Subject: ACS 5.2 dot1x PKI requirements
 
Hi,

What specific fields is the ACS validating in case we use certificates for 802.1x authentication?
Our customer is considering to use the same certs for 802.1x auth as for other usage and wants to understand what fields cannot be changed in the certificate profile?

Many thanks,
Gert

Gert Tilburgs - CCIE R&S 21187
Network Consulting Engineer
CA, Advanced Services Security Practice
Phone:  +3227046188 - Email:  gtilburg@cisco.com

For corporate legal information go to:
http://www.cisco.com/web/about/doing_business/legal/cri/index.html 

	12.3 Subject: ACS 5.2 CRL list verification - how to export latest downloaded CRL list ? 
Adding Yosi to comment on if this is possible and if so, how?

Janne Tagtstrom (jtagtstr) wrote:

2nd try
 
From: Janne Tagtstrom (jtagtstr) 
Sent: 19. lokakuuta 2011 14:35
To: cs-ciscosecure (mailer list)
Subject: ACS 5.2 CRL list verification - how to export latest downloaded CRL list ? 
 
Hi, 
 
From the logs I can see CRL retrieval has been successful, but what I  would like to do is to export downloaded CRL-list from ACS to verify itâ€™s content. 
 
Is this possible?
 
Thank you 
 
Janne TÃ¤gtstrÃ¶m 
Security Systems Engineer 

Answer: Currently not supported. Can be added as feature.

Detailed Answer:
- runtime/infrastructure/cryptoLib/src/SSL.cpp, Result CSSL::addCRL(IN ICertificate* pIssuerCertificate...) 
High level call to DL CRL

-class CRLManager: public IConfigNotifSubscriber
Manage HTTP DLer

-int CRLHttpWorker::svc()
CRL DL worker, this is the actual do it funtion

	12.4  Customer asked if there is a way (thru logging / syslog) to verify whether ACS has a valid copy of the CRL and is actually using it

Hi Ralph, 

you need first to configure ACS send INFO message to ACS View: 

System Administration >Configuration > Log Configuration > Logging Categories > Global <javascript:top.invokingLinkCallback('dSystemAdmins',%20'LogScopeLPInputAction.do?updateAuthorized=true&updateAuthorized=true&contextData.bcId=3
42&bclinkid=4&contextData.flowId=340&contextData.contextVersion=341',%20'contentarea',%20'LogConfig2')>  > Edit: "System Diagnostics"

Log Sevirity=INFO.

You can check relevant information from ACS Instance > ACS Log Information (or ACS Instance > Diagnostics) see attached. 

If retrieval was not successful you will have also following error: 

9:18:53 PM GMT+00:00 acs52-1 System Diagnostics Message_Code = 33402 Message_Severity = ERROR Category = CSCOacs_Internal_Operations_Diagnostics
Diagnostic_Info = LastErrorMessage=Failed performing HTTP GET error:
404, Certificate Revocation list
Url=http://192.126.1.14/certenroll/compe2008-BOSS-CA_vaara-osoite.crl

br

janne






From: Ralph Schmieder (rschmied) 
Sent: 26. lokakuuta 2011 16:31
To: Yosi Izaq (yizaq); Kemal Akozer (kemal); Janne Tagtstrom (jtagtstr)
Cc: cs-ciscosecure (mailer list); Alexander Atlas (aatlas); group.yazoulay@cisco.com
Subject: RE: FW: ACS 5.2 CRL list verification - how to export latest downloaded CRL list ?

Yosi, all, I had a similar question a couple of days back regarding CRL verification and haven’t received any feedback. The customer was actually wondering whether the CRL has been successfully received and if it is being used or not:

Customer asked if there is a way (thru logging / syslog) to verify whether ACS has a valid copy of the CRL and is actually using it. There's an option to "Bypass CRL Verification if CRL is not Received: " Can one actually see if that option is in use? Am I as an administrator notified? How? Is there an Alarm?

Janne: Where exactly have you seen the CRL retrieval? 

	12.5 Do we have such a whitepaper or other type of doc. providing detailed info on configuring EAP-TLS and certs with LDAP as external DB?
(+ team)
Hi Kemal,

There’s none that I know of. TAC training has some slides but they’re not A-Z guide. 
I’d say the following procedure should suffice:
| 1.	Configure LDAP server (ACS_LDAP_CFG_GUI.JPG)
| 2.	Install a server certificate in ACS (ACS_SRV_CERT_CFG_GUI.JPG)
| 3.	Add the Trust Certificate List so that the CA issuing end-user client certificates is trusted (ACS_CA_CERT_CFG_GUI.JPG)
| 4.	Enable EAP-TLS on the Access Service ‘Allowed Protocols’ page (ACS_ALLOW_TLS_CFG_GUI.JPG)
| 5.	Edit or add a Certificate Authentication Profile (ACS_CERT_AUTH_PROFILE_LDAP_GUI.JPG), set bin comparison and choose LDAP server (in my example NAC profiler)

To recap, ACS needs the server cert. + the CA trust list + LDAP server configuration.

HTH,
Yosi

From: Kemal Akozer (kemal) 
Sent: Wednesday, November 02, 2011 6:44 AM
To: Yosi Izaq (yizaq); Santhana Krishnan Mahalingam -X (sanmahal - HCL TECHNOLOGIES LIMITED at Cisco)
Cc: Jeremy Junginger (jjunging); cs-ciscosecure (mailer list); sevt-sec-vpn-all (mailer list)
Subject: Re: ACS 5.X, EAP-TLS, Certificates, LDAP

Hi Yosi, Santhana,

Do we have such a whitepaper or other type of doc. providing detailed info on configuring EAP-TLS and certs with LDAP as external DB?

Thanks,
Kemal


Jeremy Junginger (jjunging) wrote:

Experts,
 
I¹m looking at a configuration guide or whitepaper where we detail how to do EAP-TLS machine auth with certificates and use LDAP as external DB.
 
Thank you!
 

	12.6 Certificate Attribute Extraction for external DB lookup
From: Christopher Murray (chmurray) 
Sent: Friday, November 30, 2012 5:09 PM
To: Ralph Schmieder (rschmied); Yosi Izaq (yizaq); Kemal Akozer (kemal)
Cc: cs-ciscosecure(mailer list); Michael Peeters (mpeeters)
Subject: RE: Certificate Attribute Extraction for external DB lookup

See Yosi and Sasha’s reply – if the cert has the right info in one of the supported fields in the cert, you can configure ACS to locate it.

However, there’s several problems I’m aware of (we’re scoping a solution for this in ISE 1.3 / PBIS).
Sometimes the certs are incorrectly generated and some correction or manipulation is needed dynamically.
Also configuring a field to search for is global, but I have seen the situation where the customer had some certs that needed one setting and another batch that needed another.  We should make all the cert fields available to the idstore so it can make its own decision dynamically on what to search for – for example we can program AD idstore to know what a DC is, or a UPN, etc.
----------------------------------------------------------------------------------------------------
Hi Ralph,

 

What is a DN for ‘Scott Inwood’ user? 

 

If it is ‘CN=Scott Inwood,OU=HQ,OU=Users,DC=net,DC=rim,DC=qa’ as written in the certificate then the customer can select ‘Subject’ on Certificate Authentication Profile to serve as User Principal Name.

 

DN is supported type of username for EAP-TLS authentication.

 

Thanks,

Sasha

I checked the source code and as far as I could tell it looks like no manipulation is done (so no ignoring the domain part).

This is inline w/ ACS general guideline of not manipulating user names. 

 

Sasha, can you plz confirm/advise before I send to big audience?

 

Thanks,

Yosi
From: Ralph Schmieder (rschmied) 
Sent: 29 November 2012 17:21
To: Yosi Izaq (yizaq); Kemal Akozer (kemal)
Cc: cs-ciscosecure(mailer list); Michael Peeters (mpeeters); Christopher Murray (chmurray)
Subject: Re: Certificate Attribute Extraction for external DB lookup

Right... But the point is that the company apparently has no influence on how those certs fields are being filled *and* they differ in terms of what's in the cert and what's on the domain. Hence the question. 

UPN in cert is bla@rim.com and on the AD it is bla@rim.net

The DN has it in the right form, but the SAN apparently not. 

The question is: how is the lookup actually being done? Are we using the 'user part' to do the user lookup in AD and ignore the domain part (iow, lookup 'bla' and not 'bla@rim.net'?

Thanks,
-ralph


On 11/29/12 6:11 PM, "Yosi Izaq (yizaq)" <yizaq@cisco.com> wrote:

Hi,
 
The cust. should choose one of the below fields that contains the appropriate ID/user ID (AD UPN if I understand correctly):
Common Name 
Subject 
Subject Alternative Name 
Subject Alternative Name - DNS 
Subject Alternative Name - EMail  
Subject Alternative Name - Other Name 
Subject Serial Number 
 
These are the currently supported fields AFAIK.
 
Thanks,
Yosi
 
From: Kemal Akozer (kemal) 
Sent: Thursday, November 29, 2012 6:52 PM
To: Ralph Schmieder (rschmied)
Cc: cs-ciscosecure(mailer list); Michael Peeters (mpeeters); Yosi Izaq (yizaq); Christopher Murray (chmurray)
Subject: Re: Certificate Attribute Extraction for external DB lookup
 
Adding Yosi and Chris.
Ralph Schmieder (rschmied) wrote:
Kemal & Team,
 
Is there a way the following customer problem can be addressed with ACS 5? I was always using the SAN for AD lookups w/ Certs. My UPN is in the SAN but with the correct domain prefix (theirs is apparently not). Not sure how the match exactly works. Anyone can shed some light on the attribute extraction part...?
 
Thanks,
-ralph
 
 
 
 
###### snip #####
 
To give you some back ground info, we use EAP-TLS for the encryption and authentication method for the current BlackBerry Smartphones on the production network. Users are pushed the WLAN profile, and automatically go through a certificate enrollment process. We refer to this as Zero Touch since the user really does not have to configure anything. The push is a function of the BlackBerry Enterprise Server (BES). On the ACS side, we configured the Cdertificate Authentication Profile to reference the Common Name field of the digital certificate, where the CN is the users Active Directory username. So ACS extracts the CN and validates the user against AD.
So now with PlayBook and “future” products, we have an issue where BDS (new version of BlackBerry Enterprise Server) is not capable of specifying the CN as the AD username but rather the display name. I thought about using email address to identify users however although it worked in the lab, it will not work in prod simply because when the certificate is requested it populates the UPN with the users email address which is xxx.rim.com, where in reality the UPN defined in AD is rim.net (which is what RIM’s email address/domain used to be). So the user lookup in AD would fail.
So this leads me to my question. With reference to the lab certificate details below can we use either the distinguished  name field within the cert, or separately, can I use the username that is specified within the Wireless LAN profile to validate a user within AD?
 
The example below are some of the details from within the cert that we are issuing. I just removed the public key etc info to get the email as short as possible.
 
X509 Certificate:
Version: 3
Serial Number: 18fc391d000200000211
Signature Algorithm:
    Algorithm ObjectId: 1.2.840.113549.1.1.5 sha1RSA
    Algorithm Parameters:
    05 00
Issuer:
    CN=RIM QALabs Subordinate CA MCAQA02YYZ
    DC=qa
    DC=rim
    DC=net
 
NotBefore: 11/22/2012 5:00 PM
NotAfter: 4/13/2014 1:53 PM
 
Subject:
    CN=Scott Inwood
    OU=HQ
    OU=Users
    DC=net
    DC=rim
    DC=qa
 
Public Key Algorithm:
    Algorithm ObjectId: 1.2.840.113549.1.1.1 RSA
    Algorithm Parameters:
    05 00
Public Key Length: 2048 bits
    2.5.29.17: Flags = 0, Length = 34
    Subject Alternative Name
        Other Name:
             Principal Name=sinwood@rim.com
        RFC822 Name=sinwood@rim.com
 

13. Educational Debug logs

	13.1 Runtime

		13.1.1 Identity Stores

			13.1.1.1 ActiveDirectory

				13.1.1.1.1 Initialization

					13.1.1.1.1.1 When configured in DB

 13146 ActiveDirectoryIDStoreManager,18/07/2011,18:03:44:898,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStoreManager::getActiveDirectoryName sKey= AD1,ActiveDirectoryIDSt        oreManager.cpp:198
  13147 ActiveDirectoryIDStoreManager,18/07/2011,18:03:44:898,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStoreManager::onConfigVersionActivateEvent add handler for string         sKey= AD1,ActiveDirectoryIDStoreManager.cpp:103
  13148 EventHandler,18/07/2011,18:03:44:898,INFO ,78937008,Registered EventHandler: ActiveDirectoryIDStoreHandler, with key: AD1,EventDispatcher.cpp:175
  13149 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key MSCHAPAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13150 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key MSCHAPChangePasswordEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13151 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key PlainAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13152 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key QueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13153 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key CertificateAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13154 EventDispatchTable,18/07/2011,18:03:44:898,INFO ,78937008,Register handler method void (ActiveDirectoryIDStoreHandler::*)(AcsEvent*) for EventHandler: ActiveDirecto        ryIDStoreHandler with key PAPChangePasswordEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13155 ActiveDirectoryIDStoreManager,18/07/2011,18:03:44:898,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStoreManager::onConfigVersionActivateEvent performing AD LRPC Ping        ,ActiveDirectoryIDStoreManager.cpp:112
  13156 ActiveDirectoryUtils,18/07/2011,18:03:44:898,DEBUG,78937008,NIL-CONTEXT,[ActiveDirectoryUtils::ping()] Performing ping LRPC session,ActiveDirectoryUtils.cpp:88
  13157 ActiveDirectoryUtils,18/07/2011,18:03:44:898,DEBUG,78937008,NIL-CONTEXT,[ActiveDirectoryUtils::ping()] Successfuly created LRPC session,ActiveDirectoryUtils.cpp:99
  13158 ActiveDirectoryIDStore,18/07/2011,18:03:44:905,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStore::ActiveDirectoryIDStore <AD1_12>,ActiveDirectoryIDStore.cpp:44
  13159 ActiveDirectoryIDStoreManager,18/07/2011,18:03:44:905,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStoreManager::getActiveDirectoryObjectId ID= 14,ActiveDirectoryIDS        toreManager.cpp:225
  13160 DictionaryUtils,18/07/2011,18:03:44:905,DEBUG,78937008,IDStoreDictionaryUtils::getIDStoreDictionary Attributes list,IDStoreDictionaryUtils.cpp:60
  13161 DictionaryUtils,18/07/2011,18:03:44:905,DEBUG,78937008, Attribute IdentityAccessRestricted =,IDStoreDictionaryUtils.cpp:66
  13162 DictionaryUtils,18/07/2011,18:03:44:905,DEBUG,78937008, Attribute ExternalGroups =,IDStoreDictionaryUtils.cpp:66
  13163 ActiveDirectoryIDStore,18/07/2011,18:03:44:905,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStore::init - registerHandler AD1_12,ActiveDirectoryIDStore.cpp:57
  13164 isNoGroupConfigured,18/07/2011,18:03:44:906,INFO ,78937008,IDStoreDictionaryUtils::isNoGroupConfigured AttributeKey=1000008,IDStoreDictionaryUtils.cpp:145
  13165 isNoGroupConfigured,18/07/2011,18:03:44:906,INFO ,78937008,IDStoreDictionaryUtils::isNoGroupConfigured ExternalGroupList is empty,IDStoreDictionaryUtils.cpp:166
  13166 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(MSCHAPAuthenticateAndQueryEvent*) for EventHandle        r: ActiveDirectoryIDStore with key MSCHAPAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13167 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(MSCHAPChangePasswordEvent*) for EventHandler: Act        iveDirectoryIDStore with key MSCHAPChangePasswordEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13168 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(PlainAuthenticateAndQueryEvent*) for EventHandler        : ActiveDirectoryIDStore with key PlainAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13169 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(CertificateAuthenticateAndQueryEvent*) for EventH        andler: ActiveDirectoryIDStore with key CertificateAuthenticateAndQueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13170 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(QueryEvent*) for EventHandler: ActiveDirectoryIDS        tore with key QueryEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13171 EventDispatchTable,18/07/2011,18:03:44:906,INFO ,78937008,Register handler method void (ActiveDirectoryIDStore::*)(PAPChangePasswordEvent*) for EventHandler: Active        DirectoryIDStore with key PAPChangePasswordEvent,../../../build/lnx26/include/EventDispatchTable.h:112
  13172 EventHandler,18/07/2011,18:03:44:906,INFO ,78937008,Registered EventHandler: ActiveDirectoryIDStore, with key: AD1_12,EventDispatcher.cpp:175
  13173 ActiveDirectoryIDStore,18/07/2011,18:03:44:906,DEBUG,78937008,NIL-CONTEXT,ActiveDirectoryIDStore::init - registerHandler done,ActiveDirectoryIDStore.cpp:120

					13.1.1.1.1.2

				13.1.1.1.2

			13.1.1.2

		13.1.2

	13.2

14. Monitoring and reports

	14.1 log forward

		14.1.1 Source code 
/view/yizaq1__int.acs5_0.lx/vob/nm_acs/acs/runtime/
|+3rdParty/
|+build/
|+businessLogic/
|~daemons/
| |+config/
| |~logForward/
| | |+config/
| | |~src/
| | | |+Debug/
| | | |-Daemon.cpp [RO]
| | | |-Daemon.h [RO]
| | | |-Filter.cpp [RO]
| | | |-Filter.h [RO]
| | | |-GNUmakefile [RO]
| | | |-LogForwardDaemon.cpp [RO]
| | | |-LogForwardDaemon.h [RO]
| | | |-main.cpp [RO]
| | | |-Tailor.cpp [RO]
| | | |-Tailor.h [RO]
| | | |-ViewMessagesRecoveryEvent.cpp [RO]
| | | |-ViewMessagesRecoveryEvent.h [RO]
| | | |-ViewMessagesRecoveryService.cpp [RO]
| | | `-ViewMessagesRecoveryService.h [RO]

Run from daemon: runtime/daemons/logForward/src/LogForwardDaemon.cpp

Parameters:
static const char* CONFIG_FILE = "nodeInfo.txt";
static const char* SYSLOG_IP = "viewCollectorIP";
static const char* ACS_LOG_COLLECTOR = "ACS LogCollector address: ";

Constructor:
LogForwardDaemon::LogForwardDaemon()
    : Daemon("Acs.LogForward.Daemon"), m_tailor(0), m_filter(0), 
      m_syslogPort(0), m_active(-1), m_pHttpWorkerThread(NULL)

		14.1.2 Install setup
monit cfg:
[yizaq@yizaq-lnx:Thu Sep 22:/opt/CSCOacs]$ cat config/monitrc-logforward 
#############################################
# Copyright (C) 2009 by Cisco Systems, Inc. #
# All rights reserved.                      #
#############################################
##
## ADE log forwarding
## 
## if process has crashed 6 times in a row, watchdog will stop monitoring it
check process logforward with pidfile "/var/run/logforward.pid"
       start program = "/opt/CSCOacs/bin/exec_wrapper.sh logforward start /opt/CSCOacs/runtime/bin/run-logforward.sh logforward /var/run/logforward.pid"
       stop program = "/opt/CSCOacs/bin/exec_wrapper.sh logforward stop /opt/CSCOacs/runtime/bin/run-logforward.sh /var/run/logforward.pid no-kill"
       if 6 restarts within 6 cycles then timeout
       group logforward

script:
#!/bin/sh
#**************************************************
# Copyright (c) 2009 Cisco Systems, Inc.
# All rights reserved.
#**************************************************

daemon=logforward
logfile=/var/log/ade/ADE.log

#set stack limit to 1MB instead 10MB default
ulimit -s 1024
ulimit -n 20000
ulimit -c unlimited

# set acs root directory 
. /etc/setenv.sh 

case "$1" in
    'stop')
        timeout=20
        pid=`pgrep "^\<$daemon\>"`
        if [ -n "$pid" ]; then
            kill $pid
            echo "Waiting for $daemon to shut down (max $timeout sec)..."
            for (( i = 0; i <= "$timeout"; i++)); do
                echo -n .
                sleep 1
                rpid=`pgrep "^\<$daemon\>"`
                if [ -n "$rpid"  ]; then
                    if [ "$i" == "$timeout" ]; then
                        echo .
                        echo "Send kill -9 to $daemon to shut down..."
                        kill -9 $rpid
                    fi
                else
                    break
                fi
            done
            echo .
            echo "done"
            echo "$daemon stopped"
        else
            echo "$daemon not running" 
        fi
    ;;

    'start')
        if [ ! -f $logfile ]; then 
           echo "$logfile does not exist. logforward will not start."
           exit 0
        fi 

        _pwd=`pwd`
        pid=`pgrep "^\<$daemon\>"`
        if [ -n "$pid" ]; then
            echo "$daemon already started, pid $pid"
            ps -ef | grep "$pid"
        else
            if [ -f /var/run/$daemon.init ]; then
              rm -f /var/run/$daemon.init 
            fi

            if [ -z $ACS_ROOT_DIR ]; then
                ACS_ROOT_DIR=/opt/CSCOacs
                export ACS_ROOT_DIR
            fi

            ACS_RT_DIR=$ACS_ROOT_DIR/runtime
            export ACS_RT_DIR

            # no need DB support
            #. $ACS_ROOT_DIR/db/dbsrv/bin32/sa_config.sh

            LD_LIBRARY_PATH=$ACS_RT_DIR/lib:$LD_LIBRARY_PATH
            export LD_LIBRARY_PATH
            
            echo LD_LIBRARY_PATH is set to: $LD_LIBRARY_PATH

            # Cleanup cores 
            # $ACS_ROOT_DIR/bin/corecleanup.sh

            ACS_LOG_DIR=/tmp/logforward
            export ACS_LOG_DIR

            mkdir -p $ACS_LOG_DIR

            # Cleanup temporary local store
            rm -rf $ACS_LOG_DIR/*
            
            # CSCsu26442 clean up config loader processes
            #configLoaderScriptPid=`ps -ef | grep rt-generate-config | grep -v grep | awk '{print $2}'`
            #if [ -n "$configLoaderScriptPid" ]; then
            #  echo "Killing config loader script (pid: $configLoaderScriptPid)"
            #  kill -9 $configLoaderScriptPid
            #fi 
            #configLoaderPid=`ps -ef | grep CONFIGLOADER | grep -v grep | awk '{print $2}'` 
            #if [ -n "$configLoaderPid" ]; then
            #  echo "Killing config loader process (pid: $configLoaderPid)"
            #  kill -9 $configLoaderPid
            #fi 
              
            ACS_DEBUG_LOG_CONFIG=logforward/LogForwardDebugLog.config
            export ACS_DEBUG_LOG_CONFIG

            # no need DB support
            #ODBCINI=$ACS_ROOT_DIR/db/odbc.ini
            #export ODBCINI
            
            #set number of threads in the main processing thread pool
            MAIN_WORKER_THREADS_COUNT=1
            export MAIN_WORKER_THREADS_COUNT

            LDAP_IN_MAIN_POOL=1
            export LDAP_IN_MAIN_POOL

            LOGGING_IN_MAIN_POOL=1
            export LOGGING_IN_MAIN_POOL

            INTERNAL_ID_STORE_THREADS_COUNT=1
            export INTERNAL_ID_STORE_THREADS_COUNT

            AD_ID_STORE_THREADS_COUNT=1
            export AD_ID_STORE_THREADS_COUNT
            
            cd $ACS_RT_DIR/bin

            echo "starting $daemon in `pwd`"
            ./$daemon -b -f $logfile
        fi
        
        cd $_pwd
        ;;

    'status')
        echo not supported
        ;;

    *)
        echo "use: $0 stop|start for stop or start $daemon"
        exit 1
        ;;
        
esac

*/


- config:
[yizaq@yizaq-lnx:Thu Sep 22:/opt/CSCOacs/runtime/config/logforward]$ ls
FilterConfig.txt  LogForwardDebugLog.config

- filters: 
# **************************************************
# Copyright (c) 2008, 2009, 2011 Cisco Systems, Inc.
# All rights reserved.
# **************************************************

# process start by monit
58001=Internal,monit\[\d+\],'[a-z\-]+' start:.*

# process stop by monit
58002=Internal,monit\[\d+\],'[a-z\-]+' stop:.*

# process restart by monit
58005=Internal,monit\[\d+\],'[a-z\-]+' trying to restart 

# Watchdog configuration reloaded
58006=Internal,monit\[\d+\],Monit reloaded

# CARS backup
58008=CLI,debugd\[\d+\],\[\d+\]: backup-restore:backup: br_backup\.c\[\d+\]( \[\S+\])?: backup .+ to repository .+: success.*

# CARS restore
58009=CLI,debugd\[\d+\],\[\d+\]: backup-restore:restore: br_restore\.c\[\d+\]( \[\S+\])?: restore .+ from repository .+: success.*

# CARS CLI - clock set
58020=CLI,debugd\[\d+\],\[\d+\]: config:clock: sysconfig\.c\[\d+\]( \[\S+\])?: Date command output: .+

# CARS CLI - timezone set
58021=CLI,debugd\[\d+\],\[\d+\]: config:clock: sysconfig\.c\[\d+\]( \[\S+\])?: Successfully set timezone to: .+

# CARS CLI - ntp server set
58022=CLI,debugd\[\d+\],\[\d+\]: config:clock: sysconfig\.c\[\d+\]( \[\S+\])?: Setting the NTP Config\.\.\..*

# CARS CLI - hostname set
58023=CLI,debugd\[\d+\],\[\d+\]: config:network: syscfg_cli\.c\[\d+\]( \[\S+\])?: Setting hostname to .+

# CARS CLI - IP address set
58024=CLI,debugd\[\d+\],\[\d+\]: config:network: sysconfig\.c\[\d+\]( \[\S+\])?: Setting ipaddress: [0-9.]+ netmask: [0-9.]+ on interface: .+

# CARS CLI - IP address set
58024=CLI,debugd\[\d+\],\[\d+\]: config:network: sysconfig\.c\[\d+\]( \[\S+\])?: Unsetting ipaddress for .+

# CARS CLI - IP address state
58025=CLI,debugd\[\d+\],\[\d+\]: config:network: sysconfig\.c\[\d+\]( \[\S+\])?: Setting interface .+ to state: .+

# CARS CLI - default gateway set
58026=CLI,debugd\[\d+\],\[\d+\]: config:network: sysconfig\.c\[\d+\]( \[\S+\])?: Setting gateway on .+ to .+

# CARS CLI - name server set
58027=CLI,debugd\[\d+\],\[\d+\]: config:network: sysconfig\.c\[\d+\]( \[\S+\])?: Setting nameserver \d+ to .+

# ADE OS Xfer library error
58028=CLI,debugd\[\d+\],\[\d+\]: application:install cars_install\.c\[\d+\]( \[\S+\])?: Could not get remote bundle .+ from repo .+

# ADE OS install library error
58029=CLI,debugd\[\d+\],\[\d+\]: application:install install_cli\.c\[\d+\]( \[\S+\])?: error message: .+

# upgrade - schema change
58030=Internal,ACS dbupgrade,.*: Ending SqlAnywhereUpgradeV5_1_0_1\.schemaUpgrade

# upgrade - dictionary
58031=Internal,ACS dbupgrade,.*: Ending SqlAnywhereUpgradeV5_1_1_100\.dictionaryDataUpgrade

# upgrade - data manipulation
58032=Internal,ACS dbupgrade,.*: Ending SqlAnywhereUpgradeV5_1_0_1\.dataUpgrade

# upgrade - AAC
# TBD

# upgrade - PKI
58034=Internal,ACS dbupgrade,.*: Ending SqlAnywhereUpgradeV5_1_0_1\.certificateDataUpgrade

# Centrify - join error
58038=Internal,adjoin\[\d+\],INFO  cli\.adjoin Join to domain.+ failed.*

# Centrify - join domain (adagent debug on!)
58039=Internal,adjoin\[\d+\],DEBUG cli\.adjoin Join to domain.+ successful.*

# Centrify - leave domain
58040=Internal,adleave\[\d+\],INFO  cli\.adleave Leaving domain.+ successful.*

# config change notification
*CONFIG=Internal,monit\[\d+\],'nodeInfo.txt' timestamp was changed.*

# config change notification from Runtime
*CONFIG_RT=Internal,rt_daemon,ACS LogCollector address: .*

		14.1.3 author
Sergey
		14.1.4

	14.2 System Statistics

		14.2.1 Sources
runtime/daemons/rt_daemon/src/SysStatsEventHandler.cpp

DNA:


// static stuff

EventHandler::Key_t SysStatsEventHandler::s_Key("SysStatsEventHandler");
SysStatsEventHandler* SysStatsEventHandler::s_pInstance;
ReactorThreadPtr SysStatsEventHandler::s_pReactorPool;
const time_t SysStatsEventHandler::s_startTimeoutSeconds = 10;
const time_t SysStatsEventHandler::s_stopTimeoutSeconds = 30; 

/////////////////////////////////////
// SysStatsEventHandler
/////////////////////////////////////

/*
 * NOTE on error handling
 * 	All error codes returned here are "local" error codes.
 * 	System calls ( system(), statvfs() ) that fail have their
 * 	error code placed into the m_iLastHealthStatsOsError or m_iLastSysStatsOsError.
 */

SysStatsEventHandler::SysStatsEventHandler(const Key_t& rKey,
        const ReactorThreadPtr &pReactorThread) :
    ReactiveEventHandler(rKey, pReactorThread), m_bTimerIsSet(false),
            m_iFileSystemCount(MAX_NUM_OF_PARTITIONS),
            m_iFileSystemFound(0),
            m_iNumInterfacesFound(0),
            m_bFirstInterval(true), m_bFirstStats(true),
            m_iLastSysStatsOsError(AOK),
            m_iLastHealthStatsOsError(AOK), m_iPollingPeriod(300),
            m_sNodeTypeName(), m_sNodeName(),
             m_condition(m_mutex), m_state(stateUnknown)
-------------------------------------------------------------------------------------

SysStatsEventHandler::~SysStatsEventHandler()
-------------------------------------------------------------------------------------

int
SysStatsEventHandler::handle_timeout(const ACE_Time_Value &current_time,
        const void *act)-------------------------------------------------------------------------------------

int
SysStatsEventHandler::handle_close(ACE_HANDLE handle, ACE_Reactor_Mask mask)
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::startTimer()
-------------------------------------------------------------------------------------

void 
SysStatsEventHandler::stopTimer()
-------------------------------------------------------------------------------------

const SysStatsEventHandler*
SysStatsEventHandler::instance()
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::init()
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::destroy()
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::getStats()
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::getPartitionUtil()
-------------------------------------------------------------------------------------
StatsError_e
SysStatsEventHandler::getMountedPartitionUtil(part_util_t part_utl[],
        int *fs_count)-------------------------------------------------------------------------------------

// this lets us grab the utilization for any directory.

StatsError_e
SysStatsEventHandler::diskUtil(const char *dev, const char *mountpt,
        const char *fstype, part_util_t* pUtil)-------------------------------------------------------------------------------------



/*
 * grab numbers out of /proc/meminfo
 *  We'll use Active / MemTotal for utilization
* Modified the logic to fix the bug CSCtg15941, which reports high memory consumption even when ACS is idle or with less activities. After analysis it was found that, the high memory consumption is in fact false positive and the way in which currently we calculate the memory usage needs to be changed. As per the memory management of Linux, it is normal to see the memory usage 90% over the period time (20 to 50 days), because Linux maintains a cache to store the content of the files that it accesses over the period of time. As long as the data doesn't change, subsequent requests for that file will be read from memory instead of physical disk. This improves file access time. Memory used in such a manner can be freed up almost instantly, thus should really be counted as free memory instead of used memory.
 * Currently to calculate memory consumption the data of 'Active' and 'MemTotal' are used . 'Active' is treated as used memory and it is compared against the total available memory to arrive at percentage of memory usage. Actually 'Active' includes cached memory, hence should not be considered as used memory for the reason explained above. Hence, the calculation is changed as follows
 * sum up data of 'MemFree', 'Buffers' and 'Cached' to arrive at total free memory. This is what displayed as total free memory in the 2nd line of the output of 'free -m' command. Deduct this total free memory from total available memory to arrive at total used memory. Then compare the newly computed total used memory and total available memory to calculate the % memory usage.
 */
void
SysStatsEventHandler::getMemUtil(mem_util_t* pMemUtil)
-------------------------------------------------------------------------------------




/*
 * Since this stat is reported as a diff between successive intervals,
 * we report the current total for the first interval.
 */
void
SysStatsEventHandler::getNetActivity(interface_activity_t pNetActivity[],
        int sz)-------------------------------------------------------------------------------------

void
SysStatsEventHandler::getCpuStats(cpu_stats_t* pCpu)
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::getIOStats(io_stats_t* pIo)
-------------------------------------------------------------------------------------

#define MONIT_OUTPUT_FILE	"/tmp/monit.txt"

void
SysStatsEventHandler::getProcessHealth(process_health_t* pHealth)
-------------------------------------------------------------------------------------

StatsError_e
SysStatsEventHandler::syscmd(const char *cmd, const char *fname, int hd_sz,
        char *buffer, int *sz, int* pOsErr)-------------------------------------------------------------------------------------

StatsError_e
SysStatsEventHandler::getConfigInfo(const int32_t nVersionID)
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::onConfigVersionCreateEvent(
        ConfigVersionCreateEvent *pEvent)-------------------------------------------------------------------------------------

void
SysStatsEventHandler::onConfigChangeEvent(ConfigChangeEvent *pEvent)
-------------------------------------------------------------------------------------

void
SysStatsEventHandler::onConfigVersionActivateEvent(
        ConfigVersionActivateEvent *pEvent)-------------------------------------------------------------------------------------

void
SysStatsEventHandler::onConfigVersionReleaseEvent(
        ConfigVersionReleaseEvent *pEvent)-------------------------------------------------------------------------------------

void
SysStatsEventHandler::setLastError(Context* pContext) const-------------------------------------------------------------------------------------
void
SysStatsEventHandler::setLastHealthError(Context* pContext) const-------------------------------------------------------------------------------------
void
SysStatsEventHandler::clearAllErrors()
-------------------------------------------------------------------------------------

const char* SysStatsEventHandler::getStateStr(State state) const-------------------------------------------------------------------------------------

void SysStatsEventHandler::start()
-------------------------------------------------------------------------------------

void SysStatsEventHandler::stop()
-------------------------------------------------------------------------------------

void SysStatsEventHandler::onStartSysStatsEvent(StartSysStatsEvent* pEvent)
-------------------------------------------------------------------------------------

void SysStatsEventHandler::onStopSysStatsEvent(
                            StopSysStatsEvent* pEvent)-------------------------------------------------------------------------------------

void SysStatsEventHandler::waitStart()
-------------------------------------------------------------------------------------

void SysStatsEventHandler::waitStop()
-------------------------------------------------------------------------------------

		14.2.2 flow

Life cycle:
runtime/daemons/rt_daemon/src/Lifecycle.cpp|326| <<start>> SysStatsEventHandler::init();
runtime/daemons/rt_daemon/src/Lifecycle.cpp|327| <<start>> SysStatsEventHandler::start();
runtime/daemons/rt_daemon/src/Lifecycle.cpp|383| <<stop>> SysStatsEventHandler::stop();
runtime/daemons/rt_daemon/src/Lifecycle.cpp|411| <<stop>> SysStatsEventHandler::destroy();

Wakeup:
	-> onStartSysStatsEvent: start

logs:
Statistics,25/09/2011,13:05:54:711,DEBUG,83159984,SysStatsEventHandler::getIOStats(),SysStatsEventHandler.cpp:932
Statistics,25/09/2011,13:05:54:712,DEBUG,83159984,SysStatsEventHandler::getCpuStats(),SysStatsEventHandler.cpp:856
Statistics,25/09/2011,13:05:54:712,DEBUG,83159984,SysStatsEventHandler::getMemUtil(),SysStatsEventHandler.cpp:576
Statistics,25/09/2011,13:05:54:712,DEBUG,83159984,SysStatsEventHandler::getNetActivity(),SysStatsEventHandler.cpp:721
Statistics,25/09/2011,13:05:54:712,DEBUG,83159984,SysStatsEventHandler::getDiskUtil(),SysStatsEventHandler.cpp:374
Statistics,25/09/2011,13:10:54:713,DEBUG,83159984,SysStatsEventHandler::handle_timeout(),SysStatsEventHandler.cpp:91
Statistics,25/09/2011,13:10:54:713,DEBUG,83159984,SysStatsEventHandler::getProcessHealth(),SysStatsEventHandler.cpp:1012
Statistics,25/09/2011,13:10:54:713,DEBUG,83159984,SysStatsEventHandler::syscmd(),SysStatsEventHandler.cpp:1166
Statistics,25/09/2011,13:10:54:713,DEBUG,83159984,SysStatsEventHandler::syscmd(): executing system command '/opt/CSCOacs/runtime/../bin/monit summary',SysStatsEventHandler.cpp:1171
Statistics,25/09/2011,13:10:54:742,DEBUG,83159984,SysStatsEventHandler::getIOStats(),SysStatsEventHandler.cpp:932
Statistics,25/09/2011,13:10:54:742,DEBUG,83159984,SysStatsEventHandler::getCpuStats(),SysStatsEventHandler.cpp:856
Statistics,25/09/2011,13:10:54:742,DEBUG,83159984,SysStatsEventHandler::getMemUtil(),SysStatsEventHandler.cpp:576
Statistics,25/09/2011,13:10:54:742,DEBUG,83159984,SysStatsEventHandler::getNetActivity(),SysStatsEventHandler.cpp:721
Statistics,25/09/2011,13:10:54:743,DEBUG,83159984,SysStatsEventHandler::getDiskUtil(),SysStatsEventHandler.cpp:374
EventHandler,25/09/2011,13:13:44:568,DEBUG,83159984,Stack: 0x903cc38 Calling SysStatsEventHandler: Method MethodCaller<SysStatsEventHandler, StopSysStatsEvent> in thread: 83159984,EventStack.cpp:204
Statistics,25/09/2011,13:13:44:568,DEBUG,83159984,SysStatsEventHandler::onStopSysStatsEvent: signal,SysStatsEventHandler.cpp:1613
EventHandler,25/09/2011,13:13:44:569,INFO ,3085850912,Unregistered EventHandler: SysStatsEventHandler, with key: SysStatsEventHandler,EventDispatcher.cpp:199
Statistics,25/09/2011,13:13:44:569,DEBUG,3085850912,SysStatsEventHandler::destructor,SysStatsEventHandler.cpp:74

Starting:
EventDispatchTable,25/09/2011,13:15:35:898,INFO ,3085785376,Register handler method void (SysStatsEventHandler::*)(StartSysStatsEvent*) for EventHandler: SysStatsEventHandler with key StartSysStatsEvent,../../../build/lnx26/include/EventDispatchTable.h:112
EventDispatchTable,25/09/2011,13:15:35:898,INFO ,3085785376,Register handler method void (SysStatsEventHandler::*)(StopSysStatsEvent*) for EventHandler: SysStatsEventHandler with key StopSysStatsEvent,../../../build/lnx26/include/EventDispatchTable.h:112
EventHandler,25/09/2011,13:15:35:898,INFO ,3085785376,Registered EventHandler: SysStatsEventHandler, with key: SysStatsEventHandler,EventDispatcher.cpp:175
EventHandler,25/09/2011,13:15:35:898,DEBUG,82258864,Stack: 0x95777e0 Calling SysStatsEventHandler: Method MethodCaller<SysStatsEventHandler, StartSysStatsEvent> in thread: 82258864,EventStack.cpp:204
Statistics,25/09/2011,13:15:35:898,DEBUG,82258864,SysStatsEventHandler::onStartSysStatsEvent: signal,SysStatsEventHandler.cpp:1587
Statistics,25/09/2011,13:15:35:899,DEBUG,3085785376,SysStatsEventHandler::waitStart state=Started,SysStatsEventHandler.cpp:1641
Statistics,25/09/2011,13:15:35:899,INFO ,3085785376,SysStatsEventHandler::start: OK,SysStatsEventHandler.cpp:1556
Statistics,25/09/2011,13:16:46:929,INFO ,67734448,Got configured stats polling period: 300,SysStatsEventHandler.cpp:1364
Statistics,25/09/2011,13:16:46:930,INFO ,67734448,Grabbing initial copy of stats.,SysStatsEventHandler.cpp:224
Statistics,25/09/2011,13:16:46:930,DEBUG,67734448,SysStatsEventHandler::getProcessHealth(),SysStatsEventHandler.cpp:1012
Statistics,25/09/2011,13:16:46:930,DEBUG,67734448,SysStatsEventHandler::getIOStats(),SysStatsEventHandler.cpp:932
Statistics,25/09/2011,13:16:46:930,DEBUG,67734448,SysStatsEventHandler::getCpuStats(),SysStatsEventHandler.cpp:856
Statistics,25/09/2011,13:16:46:930,DEBUG,67734448,SysStatsEventHandler::getMemUtil(),SysStatsEventHandler.cpp:576
Statistics,25/09/2011,13:16:46:930,DEBUG,67734448,SysStatsEventHandler::getNetActivity(),SysStatsEventHandler.cpp:721
Statistics,25/09/2011,13:16:46:931,DEBUG,67734448,SysStatsEventHandler::getDiskUtil(),SysStatsEventHandler.cpp:374
Statistics,25/09/2011,13:16:46:932,INFO ,67734448,Got configured stats polling period: 300,SysStatsEventHandler.cpp:1364
		14.2.3
	14.3

15. RT Interfaces

	15.1 HTTP listener

		15.1.1 Check objects in DB 
- Example: AD configuration:

$ curl http://localhost:8080/config/ActiveDirectoryIdentityStore
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<acsConfig
    xmlns="http://cisco.com/nm/acs/runtime/im"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://cisco.com/nm/acs/runtime/im acsConfig2.xsd">
<!-- dump time: Sun Sep 25 16:10:53 2011
 -->

<ActiveDirectoryIdentityStore><id>14</id><reserved1/><reserved2/><reserved3/><reserved4/><reserved5/><name>AD1</name><description/><version>1</version><rejected>false</rejected><exampleUser/><domainName>canada.north.amer.acs.com</domainName><adminName>acsadmin</adminName><adminPassword>acS100%</adminPassword><enablePasswordChange>true</enablePasswordChange><enableMachineAuthen>true</enableMachineAuthen><machineNamePrefix>/host</machineNamePrefix><enableMachineAccessRestrictions>false</enableMachineAccessRestrictions><machineAccessRestrictionsAgingTime>6</machineAccessRestrictionsAgingTime><enableDialinPermissionCheck>true</enableDialinPermissionCheck><enableCallbackForDialinClient>true</enableCallbackForDialinClient></ActiveDirectoryIdentityStore>

</acsConfig>
 

		15.1.2 RT CLI
[yizaq@yizaq-lnx:Sun Sep 25:/view/yizaq1__int.acs5_0.lx/vob/nm_acs/acs/runtime/tools/rtcli]$ rtcli.py 
>?
q       quit CLI
?       get help
up      go up one level
show    get available types
show *  print out entire RT configuration
show [type] [*|name]    print out specific type/object
show runningConfigVersion       print latest config version
show runningConfigTransaction   print DB transaction information
type [type]     change context to the named type
object [type] [name}    change context to the object
coa nas [IP Address]    set the IP address of the NAS
coa attribute [name] [value]    Add a session identification attribute
coa authen [type] [method]      Set the CoA type to reauthentication
coa disconnect [action] Set the CoA type to disconnect
coa clear       Clear all CoA settings and start over
coa preview     Print the XML that will be sent to the runtime
coa send        Send the CoA request to the runtime
>

	15.2

16.
