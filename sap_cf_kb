.........................................Table Of Contents...............................................................
1. BLIs <URL:#tn=1. BLIs>
    1.0 BLIs template, tags: BLIs template <URL:#tn=    1.0 BLIs template, tags: BLIs template>
        1.0.1 Bussi's BLIs Template, tags: Bussi's BLIs Template <URL:#tn=        1.0.1 Bussi's BLIs Template, tags: Bussi's BLIs Template>
        1.0.2 General BLI Template (gemini), tags: General BLI Template (gemini) <URL:#tn=        1.0.2 General BLI Template (gemini), tags: General BLI Template (gemini)>
    1.1  2019 <URL:#tn=    1.1  2019>
        1.1.1  Delete site <URL:#tn=        1.1.1  Delete site>
            1.1.1.1  Links <URL:#tn=            1.1.1.1  Links>
            1.1.1.2 description <URL:#tn=            1.1.1.2 description>
            1.1.1.3 Design <URL:#tn=            1.1.1.3 Design>
                1.1.1.3.1 wiki <URL:#tn=                1.1.1.3.1 wiki>
                1.1.1.3.2 Activation service wiki <URL:#tn=                1.1.1.3.2 Activation service wiki>
                1.1.1.3.3 <URL:#tn=                1.1.1.3.3>
            1.1.1.4 Task breakdown <URL:#tn=            1.1.1.4 Task breakdown>
                1.1.1.4.1  client. site-directory <URL:#tn=                1.1.1.4.1  client. site-directory>
                1.1.1.4.2  BL, semantic, <URL:#tn=                1.1.1.4.2  BL, semantic,>
                    1.1.1.4.2.1  Delete RT site <URL:#tn=                    1.1.1.4.2.1  Delete RT site>
                1.1.1.4.3  Backend, cdm-store <URL:#tn=                1.1.1.4.3  Backend, cdm-store>
                1.1.1.4.4  Test scope  [Pending] <URL:#tn=                1.1.1.4.4  Test scope  [Pending]>
                1.1.1.4.6  Manual E2E tests <URL:#tn=                1.1.1.4.6  Manual E2E tests>
                1.1.1.4.8 <URL:#tn=                1.1.1.4.8>
                1.1.1.4.9 <URL:#tn=                1.1.1.4.9>
                1.1.1.4.10 <URL:#tn=                1.1.1.4.10>
                1.1.1.4.11 <URL:#tn=                1.1.1.4.11>
            1.1.1.5 Strings <URL:#tn=            1.1.1.5 Strings>
            1.1.1.6 <URL:#tn=            1.1.1.6>
        1.1.2  Metering service <URL:#tn=        1.1.2  Metering service>
            1.1.2.1  Resources <URL:#tn=            1.1.2.1  Resources>
            1.1.2.2 E2E tests <URL:#tn=            1.1.2.2 E2E tests>
                1.1.2.2.1 Hack to test metering client <URL:#tn=                1.1.2.2.1 Hack to test metering client>
                    1.1.2.2.1.1 code <URL:#tn=                    1.1.2.2.1.1 code>
                    1.1.2.2.1.2 Tests steps <URL:#tn=                    1.1.2.2.1.2 Tests steps>
                        1.1.2.2.1.2.1 create Maas default plan <URL:#tn=                        1.1.2.2.1.2.1 create Maas default plan>
                        1.1.2.2.1.2.2 <URL:#tn=                        1.1.2.2.1.2.2>
                    1.1.2.2.1.3 <URL:#tn=                    1.1.2.2.1.3>
                1.1.2.2.2 E2E sanity 26/12/18 <URL:#tn=                1.1.2.2.2 E2E sanity 26/12/18>
                1.1.2.2.3 <URL:#tn=                1.1.2.2.3>
            1.1.2.3 sample application <URL:#tn=            1.1.2.3 sample application>
            1.1.2.4 <URL:#tn=            1.1.2.4>
        1.1.3 Cred-store <URL:#tn=        1.1.3 Cred-store>
            1.1.3.1 Semantic store salt key in cred-store <URL:#tn=            1.1.3.1 Semantic store salt key in cred-store>
            1.1.3.2 <URL:#tn=            1.1.3.2>
        1.1.4 <URL:#tn=        1.1.4>
    1.2 Delete site <URL:#tn=    1.2 Delete site>
        1.2.3 <URL:#tn=        1.2.3>
    1.3 Features Toggles <URL:#tn=    1.3 Features Toggles>
        1.3.1 research <URL:#tn=        1.3.1 research>
            1.3.1.1 Feature Flags <URL:#tn=            1.3.1.1 Feature Flags>
                1.3.1.1.1 Feature Flags API <URL:#tn=                1.3.1.1.1 Feature Flags API>
                1.3.1.1.2 Feature Flags Service on Cloud Foundry Environment <URL:#tn=                1.3.1.1.2 Feature Flags Service on Cloud Foundry Environment>
                1.3.1.1.3 quick start <URL:#tn=                1.3.1.1.3 quick start>
                1.3.1.1.4 Demo application <URL:#tn=                1.3.1.1.4 Demo application>
                1.3.1.1.5 CF cli to push changes <URL:#tn=                1.3.1.1.5 CF cli to push changes>
                1.3.1.1.6 <URL:#tn=                1.3.1.1.6>
            1.3.1.2 <URL:#tn=            1.3.1.2>
        1.3.2 <URL:#tn=        1.3.2>
    1.4 [cFLP] Content Manager - Support Catalogs and Groups <URL:#tn=    1.4 [cFLP] Content Manager - Support Catalogs and Groups>
        1.4.1 general <URL:#tn=        1.4.1 general>
        1.4.2 <URL:#tn=        1.4.2>
    1.5 Enable FLP for stakeholders, aka default group and catalog mitigation <URL:#tn=    1.5 Enable FLP for stakeholders, aka default group and catalog mitigation>
        1.5.1  Task breakdown <URL:#tn=        1.5.1  Task breakdown>
        1.5.2 URLs <URL:#tn=        1.5.2 URLs>
        1.5.3 websequence <URL:#tn=        1.5.3 websequence>
            1.5.3.1 Positive site create <URL:#tn=            1.5.3.1 Positive site create>
            1.5.3.2 Negative site create <URL:#tn=            1.5.3.2 Negative site create>
            1.5.3.3 Positive app create <URL:#tn=            1.5.3.3 Positive app create>
            1.5.3.4 Positive and Negative app creation <URL:#tn=            1.5.3.4 Positive and Negative app creation>
            1.5.3.5 Design notes <URL:#tn=            1.5.3.5 Design notes>
            1.5.3.6 <URL:#tn=            1.5.3.6>
        1.5.4 logs <URL:#tn=        1.5.4 logs>
            1.5.4.1 getting FLP page and default-group and default-catalog <URL:#tn=            1.5.4.1 getting FLP page and default-group and default-catalog>
        1.5.5 diffs <URL:#tn=        1.5.5 diffs>
        1.5.6 <URL:#tn=        1.5.6>
    1.6 consume schema from nexus <URL:#tn=    1.6 consume schema from nexus>
        1.6.0. links <URL:#tn=        1.6.0. links>
        1.6.1  pre research <URL:#tn=        1.6.1  pre research>
        1.6.2 email 2 amir re change examples <URL:#tn=        1.6.2 email 2 amir re change examples>
        1.6.3 demo require <URL:#tn=        1.6.3 demo require>
        1.6.4 plan <URL:#tn=        1.6.4 plan>
        1.6.5 update schema <URL:#tn=        1.6.5 update schema>
        1.6.6 PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/204 <URL:#tn=        1.6.6 PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/204>
        1.6.7 <URL:#tn=        1.6.7>
    1.7 undo enable flp mitigation and add all groups to groupOrder array <URL:#tn=    1.7 undo enable flp mitigation and add all groups to groupOrder array>
        1.7.1 pre research <URL:#tn=        1.7.1 pre research>
        1.7.2 plan <URL:#tn=        1.7.2 plan>
        1.7.3 <URL:#tn=        1.7.3>
    1.8 [App Technologies] Destinations list: fetch from Cockpit + pre-fetch <URL:#tn=    1.8 [App Technologies] Destinations list: fetch from Cockpit + pre-fetch>
        1.8.1 general <URL:#tn=        1.8.1 general>
        1.8.2 urls <URL:#tn=        1.8.2 urls>
        1.8.3 code <URL:#tn=        1.8.3 code>
        1.8.4 Design <URL:#tn=        1.8.4 Design>
        1.8.5 <URL:#tn=        1.8.5>
    1.9 [App Technologies] Inbound params + Viz params in Business App editor <URL:#tn=    1.9 [App Technologies] Inbound params + Viz params in Business App editor>
        1.9.1 general <URL:#tn=        1.9.1 general>
        1.9.2 links <URL:#tn=        1.9.2 links>
        1.9.3 Design <URL:#tn=        1.9.3 Design>
            1.9.3.1 Motivation <URL:#tn=            1.9.3.1 Motivation>
            1.9.3.2 data-binding <URL:#tn=            1.9.3.2 data-binding>
            1.9.3.3 last moment changes <URL:#tn=            1.9.3.3 last moment changes>
            1.9.3.4 help w/ urlTemplate qunits <URL:#tn=            1.9.3.4 help w/ urlTemplate qunits>
                1.9.3.4.1 UrlTemplate.js <URL:#tn=                1.9.3.4.1 UrlTemplate.js>
                1.9.3.4.2 UrlTemplate.qunit.js <URL:#tn=                1.9.3.4.2 UrlTemplate.qunit.js>
                1.9.3.4.3 <URL:#tn=                1.9.3.4.3>
            1.9.3.5 <URL:#tn=            1.9.3.5>
        1.9.4 open questions <URL:#tn=        1.9.4 open questions>
        1.9.5 learn <URL:#tn=        1.9.5 learn>
            1.9.5.1 Session: /Users/i500695/work/vim_sessions/sap/appEditor <URL:#tn=            1.9.5.1 Session: /Users/i500695/work/vim_sessions/sap/appEditor>
            1.9.5.2 Content Manager View: <URL:#tn=            1.9.5.2 Content Manager View:>
        1.9.6 add info icons <URL:#tn=        1.9.6 add info icons>
            1.9.6.1  research <URL:#tn=            1.9.6.1  research>
            1.9.6.2 <URL:#tn=            1.9.6.2>
        1.9.7 Code <URL:#tn=        1.9.7 Code>
        1.9.8 <URL:#tn=        1.9.8>
    1.10 sap_everyone role <URL:#tn=    1.10 sap_everyone role>
        1.10.1 general <URL:#tn=        1.10.1 general>
        1.10.2 links <URL:#tn=        1.10.2 links>
        1.10.3 Design <URL:#tn=        1.10.3 Design>
        1.10.4 Code <URL:#tn=        1.10.4 Code>
        1.10.5 <URL:#tn=        1.10.5>
    1.11 [Eng] API Integration Tests for Semantic Service - Research & POC - aka automtion tests, fs-automation <URL:#tn=    1.11 [Eng] API Integration Tests for Semantic Service - Research & POC - aka automtion tests, fs-automation>
        1.11.1 commitment <URL:#tn=        1.11.1 commitment>
        1.11.2 Planing <URL:#tn=        1.11.2 Planing>
        1.11.3 Getting started <URL:#tn=        1.11.3 Getting started>
        1.11.4 Run vs a provider dev space <URL:#tn=        1.11.4 Run vs a provider dev space>
        1.11.5 Nightly job <URL:#tn=        1.11.5 Nightly job>
        1.11.6 E2E integration test <URL:#tn=        1.11.6 E2E integration test>
        1.11.7 Nightly tests on LKG <URL:#tn=        1.11.7 Nightly tests on LKG>
        1.11.8 Puppeteer tests <URL:#tn=        1.11.8 Puppeteer tests>
        1.11.9 <URL:#tn=        1.11.9>
    1.12 MaaS retry mechanism <URL:#tn=    1.12 MaaS retry mechanism>
        1.12.1 commitment <URL:#tn=        1.12.1 commitment>
        1.12.2 Links <URL:#tn=        1.12.2 Links>
        1.12.3 code <URL:#tn=        1.12.3 code>
            1.12.3.1 shared lib reliability code <URL:#tn=            1.12.3.1 shared lib reliability code>
            1.12.3.2 Usage of retry and breaker <URL:#tn=            1.12.3.2 Usage of retry and breaker>
                1.12.3.2.1 shared lib infrastructure <URL:#tn=                1.12.3.2.1 shared lib infrastructure>
                1.12.3.2.2 configuration and usage <URL:#tn=                1.12.3.2.2 configuration and usage>
        1.12.4 suggested retry policy <URL:#tn=        1.12.4 suggested retry policy>
        1.12.5 implementation <URL:#tn=        1.12.5 implementation>
        1.12.6 E2E manual tests <URL:#tn=        1.12.6 E2E manual tests>
            1.12.6.1  Performance tests infra <URL:#tn=            1.12.6.1  Performance tests infra>
                1.12.6.1.1  https://github.wdf.sap.corp/Portal-CF/monkey-proxy <URL:#tn=                1.12.6.1.1  https://github.wdf.sap.corp/Portal-CF/monkey-proxy>
                    1.12.6.1.1.1  code <URL:#tn=                    1.12.6.1.1.1  code>
                    1.12.6.1.1.2 usage <URL:#tn=                    1.12.6.1.1.2 usage>
                1.12.6.1.2 git repositories <URL:#tn=                1.12.6.1.2 git repositories>
                    1.12.6.1.2.1 https://github.wdf.sap.corp/Portal-CF/cf-gatling/ <URL:#tn=                    1.12.6.1.2.1 https://github.wdf.sap.corp/Portal-CF/cf-gatling/>
                        1.12.6.1.2.1.1 performance PRs <URL:#tn=                        1.12.6.1.2.1.1 performance PRs>
                        1.12.6.1.2.1.2 <URL:#tn=                        1.12.6.1.2.1.2>
                    1.12.6.1.2.2 <URL:#tn=                    1.12.6.1.2.2>
                1.12.6.1.3 <URL:#tn=                1.12.6.1.3>
            1.12.6.2 Transport service manual tests <URL:#tn=            1.12.6.2 Transport service manual tests>
                1.12.6.2.1 transport <URL:#tn=                1.12.6.2.1 transport>
                    1.12.6.2.1.1 basic transport flow <URL:#tn=                    1.12.6.2.1.1 basic transport flow>
                    1.12.6.2.1.2 <URL:#tn=                    1.12.6.2.1.2>
                1.12.6.2.2 export <URL:#tn=                1.12.6.2.2 export>
                    1.12.6.2.2.1  export site <URL:#tn=                    1.12.6.2.2.1  export site>
                    1.12.6.2.2.2 export granularity <URL:#tn=                    1.12.6.2.2.2 export granularity>
                    1.12.6.2.2.3 <URL:#tn=                    1.12.6.2.2.3>
                1.12.6.2.3 import <URL:#tn=                1.12.6.2.3 import>
                    1.12.6.2.3.1 import site <URL:#tn=                    1.12.6.2.3.1 import site>
                    1.12.6.2.3.2 import content granularity <URL:#tn=                    1.12.6.2.3.2 import content granularity>
                1.12.6.2.4 <URL:#tn=                1.12.6.2.4>
            1.12.6.3 <URL:#tn=            1.12.6.3>
        1.12.7 <URL:#tn=        1.12.7>
    1.13 [Shared Content] Site references (aka Collection) entity creation in Site creation <URL:#tn=    1.13 [Shared Content] Site references (aka Collection) entity creation in Site creation>
        1.13.1 general <URL:#tn=        1.13.1 general>
        1.13.2 websequence <URL:#tn=        1.13.2 websequence>
            1.13.2.1 Positive site create <URL:#tn=            1.13.2.1 Positive site create>
        1.13.3 Tests <URL:#tn=        1.13.3 Tests>
    1.14 EUXTEAMGUYM-1883, Use new filter to Destination Service (BFF) API <URL:#tn=    1.14 EUXTEAMGUYM-1883, Use new filter to Destination Service (BFF) API>
        1.14.1 general <URL:#tn=        1.14.1 general>
        1.14.2 code <URL:#tn=        1.14.2 code>
        1.14.3 backend service, bff <URL:#tn=        1.14.3 backend service, bff>
        1.14.4 <URL:#tn=        1.14.4>
    1.15 Shared content <URL:#tn=    1.15 Shared content>
        1.15.1  EUXTEAMGUYM-1805, shared content <URL:#tn=        1.15.1  EUXTEAMGUYM-1805, shared content>
        1.15.2 task breakdown <URL:#tn=        1.15.2 task breakdown>
        1.15.3 code <URL:#tn=        1.15.3 code>
        1.15.4 links <URL:#tn=        1.15.4 links>
        1.15.5 diagrams <URL:#tn=        1.15.5 diagrams>
            1.15.5.1 websequence <URL:#tn=            1.15.5.1 websequence>
            1.15.5.2 graphviz <URL:#tn=            1.15.5.2 graphviz>
            1.15.5.3 Design <URL:#tn=            1.15.5.3 Design>
                1.15.5.3.1 APIs <URL:#tn=                1.15.5.3.1 APIs>
                    1.15.5.3.1.1 /semantic/batch	post <URL:#tn=                    1.15.5.3.1.1 /semantic/batch	post>
                    1.15.5.3.1.2 /semantic/entity/	get <URL:#tn=                    1.15.5.3.1.2 /semantic/entity/	get>
                    1.15.5.3.1.3 /semantic/entity/{entityType}	get <URL:#tn=                    1.15.5.3.1.3 /semantic/entity/{entityType}	get>
                    1.15.5.3.1.4 200, read entity <URL:#tn=                    1.15.5.3.1.4 200, read entity>
                    1.15.5.3.1.5 <URL:#tn=                    1.15.5.3.1.5>
                1.15.5.3.2 implementation notes <URL:#tn=                1.15.5.3.2 implementation notes>
                1.15.5.3.3 <URL:#tn=                1.15.5.3.3>
            1.15.5.4 <URL:#tn=            1.15.5.4>
        1.15.4 Pull requests, PRs <URL:#tn=        1.15.4 Pull requests, PRs>
        1.15.5 related BLIs <URL:#tn=        1.15.5 related BLIs>
        1.15.6 delete site and its assets <URL:#tn=        1.15.6 delete site and its assets>
            1.15.6.1 integration test logs <URL:#tn=            1.15.6.1 integration test logs>
                1.15.6.1.1 Wed Jul 31 15:29:23 IDT 2019 <URL:#tn=                1.15.6.1.1 Wed Jul 31 15:29:23 IDT 2019>
                    1.15.6.1.1.1 portal-cf-assets-service: <URL:#tn=                    1.15.6.1.1.1 portal-cf-assets-service:>
                    1.15.6.1.1.2 portal-cf-site-semantic-service <URL:#tn=                    1.15.6.1.1.2 portal-cf-site-semantic-service>
                    1.15.6.1.1.3 <URL:#tn=                    1.15.6.1.1.3>
                1.15.6.1.2 <URL:#tn=                1.15.6.1.2>
            1.15.6.2 <URL:#tn=            1.15.6.2>
        1.15.7 assets-client w/ map of functions <URL:#tn=        1.15.7 assets-client w/ map of functions>
        1.15.8 Tests <URL:#tn=        1.15.8 Tests>
        1.15.9 entities search APIs <URL:#tn=        1.15.9 entities search APIs>
        1.15.10 [Shared Content] Cleanup of 'sharedContent' "toggle" dependencies - semantic-service <URL:#tn=        1.15.10 [Shared Content] Cleanup of 'sharedContent' "toggle" dependencies - semantic-service>
        1.15.11 <URL:#tn=        1.15.11>
    1.16 Federation <URL:#tn=    1.16 Federation>
        1.16.1 EUXTEAMGUYM-1886, [Federation] Snapshot and Cherry-pick <URL:#tn=        1.16.1 EUXTEAMGUYM-1886, [Federation] Snapshot and Cherry-pick>
            1.16.1.1 general <URL:#tn=            1.16.1.1 general>
            1.16.1.2 diagrams <URL:#tn=            1.16.1.2 diagrams>
                1.16.1.2.1 websequence <URL:#tn=                1.16.1.2.1 websequence>
            1.16.1.3 pull requests <URL:#tn=            1.16.1.3 pull requests>
            1.16.1.4 <URL:#tn=            1.16.1.4>
        1.16.2 <URL:#tn=        1.16.2>
    1.17 takt9 2019.t9 1909 <URL:#tn=    1.17 takt9 2019.t9 1909>
        1.17.1[Eng] Cross teams integration test  https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2065 <URL:#tn=        1.17.1[Eng] Cross teams integration test  https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2065>
            1.17.1 Possible Automation Flow: <URL:#tn=            1.17.1 Possible Automation Flow:>
            1.17.2 tasks <URL:#tn=            1.17.2 tasks>
            1.17.3 My task - prepare environment <URL:#tn=            1.17.3 My task - prepare environment>
                1.17.3.1 examples, from flpdevelop... <URL:#tn=                1.17.3.1 examples, from flpdevelop...>
                    1.17.3.1.1 SAP-GUI <URL:#tn=                    1.17.3.1.1 SAP-GUI>
                    1.17.3.1.2 SAP-UI5 , Apollo <URL:#tn=                    1.17.3.1.2 SAP-UI5 , Apollo>
                    1.17.3.1.3 WDA <URL:#tn=                    1.17.3.1.3 WDA>
                1.17.3.2 Jenkins <URL:#tn=                1.17.3.2 Jenkins>
                1.17.3.3 Cross-team cflp tests coverage <URL:#tn=                1.17.3.3 Cross-team cflp tests coverage>
                    1.17.3.3.1  Summary, fs-automation jenkins <URL:#tn=                    1.17.3.3.1  Summary, fs-automation jenkins>
                    1.17.3.3.2  Full console <URL:#tn=                    1.17.3.3.2  Full console>
            1.17.1.4 <URL:#tn=            1.17.1.4>
                1.17.1.2 adapt APIs to shared content <URL:#tn=                1.17.1.2 adapt APIs to shared content>
            1.17.2	Finish cherry-pick BLI integration with cdm-store-client <URL:#tn=            1.17.2	Finish cherry-pick BLI integration with cdm-store-client>
            1.17.3	EUXTEAMGUYM-2146 [Eng] UIVeri5 - parallel tests execution <URL:#tn=            1.17.3	EUXTEAMGUYM-2146 [Eng] UIVeri5 - parallel tests execution>
        1.17.4 [Federation] CF Provider synchronization - design https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2130 <URL:#tn=        1.17.4 [Federation] CF Provider synchronization - design https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2130>
            1.17.4.1 Motivation: <URL:#tn=            1.17.4.1 Motivation:>
            1.17.4.2 <URL:#tn=            1.17.4.2>
        1.17.5 [Federation] S/4 on-prem - Design to support federation of external providers https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2143 <URL:#tn=        1.17.5 [Federation] S/4 on-prem - Design to support federation of external providers https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2143>
            1.17.5.1 general <URL:#tn=            1.17.5.1 general>
            1.17.5.2 <URL:#tn=            1.17.5.2>
        1.17.6 EUXTEAMGUYM-2141 [Federation] ABAP Content Federation Service POC <URL:#tn=        1.17.6 EUXTEAMGUYM-2141 [Federation] ABAP Content Federation Service POC>
            1.17.6.1  General <URL:#tn=            1.17.6.1  General>
            1.17.6.2 schemas <URL:#tn=            1.17.6.2 schemas>
            1.17.6.3 Entities <URL:#tn=            1.17.6.3 Entities>
            1.17.6.4 Import apps PoC <URL:#tn=            1.17.6.4 Import apps PoC>
            1.17.6.5 emails re. PoC prep <URL:#tn=            1.17.6.5 emails re. PoC prep>
            1.17.6.6 issues with client editors <URL:#tn=            1.17.6.6 issues with client editors>
            1.17.6.7 role, catalog, group jsons <URL:#tn=            1.17.6.7 role, catalog, group jsons>
            1.17.6.8 email from Shani <URL:#tn=            1.17.6.8 email from Shani>
            1.17.6.9 Validate urz entities <URL:#tn=            1.17.6.9 Validate urz entities>
            1.17.6.10 CFLP Test setup <URL:#tn=            1.17.6.10 CFLP Test setup>
            1.17.6.11 Gaps in portal editors <URL:#tn=            1.17.6.11 Gaps in portal editors>
            1.17.6.12 Demo 16/10/19 13:41:24 <URL:#tn=            1.17.6.12 Demo 16/10/19 13:41:24>
            1.17.6.13 uxt system integration <URL:#tn=            1.17.6.13 uxt system integration>
                1.17.6.13.1  S4 setup <URL:#tn=                1.17.6.13.1  S4 setup>
            1.17.6.14 script for adapting s4 json entities <URL:#tn=            1.17.6.14 script for adapting s4 json entities>
            1.17.6.15 apps w/ same title <URL:#tn=            1.17.6.15 apps w/ same title>
            1.17.6.16 Create user for ert system <URL:#tn=            1.17.6.16 Create user for ert system>
                1.17.6.16.1 email from wini <URL:#tn=                1.17.6.16.1 email from wini>
                1.17.6.16.2 my users <URL:#tn=                1.17.6.16.2 my users>
                1.17.6.16.3 <URL:#tn=                1.17.6.16.3>
            1.17.6.17 Navigation to WDA apps <URL:#tn=            1.17.6.17 Navigation to WDA apps>
            1.17.6.18 <URL:#tn=            1.17.6.18>
        1.17.7 <URL:#tn=        1.17.7>
    1.18 Move to saar team, new jira <URL:#tn=    1.18 Move to saar team, new jira>
    1.19 Transport service, https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=8499&view=detail&selectedIssue=EUXTEAMSAAR-1283 <URL:#tn=    1.19 Transport service, https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=8499&view=detail&selectedIssue=EUXTEAMSAAR-1283>
        1.19.1  general <URL:#tn=        1.19.1  general>
            1.19.1.1  run locally <URL:#tn=            1.19.1.1  run locally>
                1.19.1.1.1  Connect to PG docker <URL:#tn=                1.19.1.1.1  Connect to PG docker>
                    1.19.1.1.1.1   cat src/config/local.config.ts <URL:#tn=                    1.19.1.1.1.1   cat src/config/local.config.ts>
                    1.19.1.1.1.2 <URL:#tn=                    1.19.1.1.1.2>
                1.19.1.1.2 start dev <URL:#tn=                1.19.1.1.2 start dev>
                1.19.1.1.3 <URL:#tn=                1.19.1.1.3>
            1.19.1.2 intro <URL:#tn=            1.19.1.2 intro>
            1.19.1.1  sequence diagrams <URL:#tn=            1.19.1.1  sequence diagrams>
            1.19.1.2 state machine <URL:#tn=            1.19.1.2 state machine>
                1.19.1.2.1 s4 on-prem import job state machine <URL:#tn=                1.19.1.2.1 s4 on-prem import job state machine>
                1.19.1.2.2 export site content state machine <URL:#tn=                1.19.1.2.2 export site content state machine>
                1.19.1.2.3 <URL:#tn=                1.19.1.2.3>
            1.19.1.3 <URL:#tn=            1.19.1.3>
        1.19.2 connectivity <URL:#tn=        1.19.2 connectivity>
            1.19.2.1  Proxy <URL:#tn=            1.19.2.1  Proxy>
            1.19.2.2 https://blogs.sap.com/2019/03/28/announcing-the-sap-s4hana-cloud-sdk-for-javascript/ <URL:#tn=            1.19.2.2 https://blogs.sap.com/2019/03/28/announcing-the-sap-s4hana-cloud-sdk-for-javascript/>
                1.19.2.2.1  deploy destination connector to CF <URL:#tn=                1.19.2.2.1  deploy destination connector to CF>
            1.19.2.3 local mock odata server <URL:#tn=            1.19.2.3 local mock odata server>
                1.19.2.3.1 by hacking an existing app <URL:#tn=                1.19.2.3.1 by hacking an existing app>
                1.19.2.3.2 By using a simple http server app, Asaf mock provider <URL:#tn=                1.19.2.3.2 By using a simple http server app, Asaf mock provider>
                    1.19.2.3.2.1 Asaf destination mosko team old mock provider, tags: Asaf destination mosko team old mock provider <URL:#tn=                    1.19.2.3.2.1 Asaf destination mosko team old mock provider, tags: Asaf destination mosko team old mock provider>
                    1.19.2.3.2.2 add x509 support <URL:#tn=                    1.19.2.3.2.2 add x509 support>
                        1.19.2.3.2.2.1 branch: yosi_03_12_20__11_59 <URL:#tn=                        1.19.2.3.2.2.1 branch: yosi_03_12_20__11_59>
                        1.19.2.3.2.2.2 test locally <URL:#tn=                        1.19.2.3.2.2.2 test locally>
                        1.19.2.3.2.2.3 Deploy x509 mock provider <URL:#tn=                        1.19.2.3.2.2.3 Deploy x509 mock provider>
                        1.19.2.3.2.2.3 <URL:#tn=                        1.19.2.3.2.2.3>
                    1.19.2.3.2.3 Mock provider returning always 500 (test retry strategy) <URL:#tn=                    1.19.2.3.2.3 Mock provider returning always 500 (test retry strategy)>
                        1.19.2.3.2.3.1 code <URL:#tn=                        1.19.2.3.2.3.1 code>
                        1.19.2.3.2.3.2 deploy and configure <URL:#tn=                        1.19.2.3.2.3.2 deploy and configure>
                        1.19.2.3.2.3.3 test <URL:#tn=                        1.19.2.3.2.3.3 test>
                        1.19.2.3.2.3.4 logs <URL:#tn=                        1.19.2.3.2.3.4 logs>
                        1.19.2.3.2.3.5 <URL:#tn=                        1.19.2.3.2.3.5>
                    1.19.2.3.2.4 <URL:#tn=                    1.19.2.3.2.4>
                1.19.2.3.3 <URL:#tn=                1.19.2.3.3>
            1.19.2.4 <URL:#tn=            1.19.2.4>
        1.19.3 <URL:#tn=        1.19.3>
                    1.19.2.3.2.4 <URL:#tn=                    1.19.2.3.2.4>
                1.19.2.3.3 <URL:#tn=                1.19.2.3.3>
            1.19.2.4 <URL:#tn=            1.19.2.4>
        1.19.3 generate odata client: https://developers.sap.com/tutorials/cloudsdk-js-generator.html <URL:#tn=        1.19.3 generate odata client: https://developers.sap.com/tutorials/cloudsdk-js-generator.html>
        1.19.4 Cloud connector and S/4HANA OnPrem backend system, Noboru Ora blog <URL:#tn=        1.19.4 Cloud connector and S/4HANA OnPrem backend system, Noboru Ora blog>
            1.19.4.1 blog <URL:#tn=            1.19.4.1 blog>
            1.19.4.2 code <URL:#tn=            1.19.4.2 code>
            1.19.4.3 my tests <URL:#tn=            1.19.4.3 my tests>
            1.19.4.4 Use the Application Router in Cloud Foundry to Connect to ABAP System <URL:#tn=            1.19.4.4 Use the Application Router in Cloud Foundry to Connect to ABAP System>
        1.19.5 destination service <URL:#tn=        1.19.5 destination service>
        1.19.6 connectivity service <URL:#tn=        1.19.6 connectivity service>
            1.19.6.1 documentation <URL:#tn=            1.19.6.1 documentation>
                1.19.6.1.1 On S4 on-prem side, install and configure cloud connector <URL:#tn=                1.19.6.1.1 On S4 on-prem side, install and configure cloud connector>
                1.19.6.1.2 Cloud-Platform side <URL:#tn=                1.19.6.1.2 Cloud-Platform side>
                    1.19.6.1.2.1 Create and Bind a Connectivity Service InstanceUse the following CLI commands to create a service instance and bind it to an application: <URL:#tn=                    1.19.6.1.2.1 Create and Bind a Connectivity Service InstanceUse the following CLI commands to create a service instance and bind it to an application:>
                    1.19.6.1.2.2 Read environment variables <URL:#tn=                    1.19.6.1.2.2 Read environment variables>
                    1.19.6.1.2.3 Get destination from destination service <URL:#tn=                    1.19.6.1.2.3 Get destination from destination service>
                        1.19.6.1.2.3.1 Configure HTTP destination <URL:#tn=                        1.19.6.1.2.3.1 Configure HTTP destination>
                        1.19.6.1.2.3.2 consume destination service <URL:#tn=                        1.19.6.1.2.3.2 consume destination service>
                    1.19.6.1.2.4 Get HTTP proxy and create oauth access token using connectivity and XSUAA services <URL:#tn=                    1.19.6.1.2.4 Get HTTP proxy and create oauth access token using connectivity and XSUAA services>
                    1.19.6.1.2.5 From your application access on-prem system (via TLS tunnel to cloud connector) <URL:#tn=                    1.19.6.1.2.5 From your application access on-prem system (via TLS tunnel to cloud connector)>
                1.19.6.1.3 <URL:#tn=                1.19.6.1.3>
            1.19.6.2 our implementations <URL:#tn=            1.19.6.2 our implementations>
            1.19.6.3 <URL:#tn=            1.19.6.3>
        1.19.7 transport PRs <URL:#tn=        1.19.7 transport PRs>
            1.19.7.1 Adam, Destinations <URL:#tn=            1.19.7.1 Adam, Destinations>
            1.19.7.2 Hadar, skeleton <URL:#tn=            1.19.7.2 Hadar, skeleton>
            1.19.7.3 <URL:#tn=            1.19.7.3>
        1.19.8 manually create and bind services during development <URL:#tn=        1.19.8 manually create and bind services during development>
        1.19.9 Transports to s4 Federation Embedded and hub subaccount <URL:#tn=        1.19.9 Transports to s4 Federation Embedded and hub subaccount>
        1.19.10 Transport service swagger <URL:#tn=        1.19.10 Transport service swagger>
        1.19.11 docker-compose <URL:#tn=        1.19.11 docker-compose>
            1.19.11.1 PR https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/152 <URL:#tn=            1.19.11.1 PR https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/152>
            1.19.11.2 run docker-compose <URL:#tn=            1.19.11.2 run docker-compose>
            1.19.11.3 <URL:#tn=            1.19.11.3>
        1.19.12 Mock external (s4) content provider <URL:#tn=        1.19.12 Mock external (s4) content provider>
        1.19.13 Integration-Tests <URL:#tn=        1.19.13 Integration-Tests>
            1.19.13.1 how to run <URL:#tn=            1.19.13.1 how to run>
                1.19.13.1.1 run redis <URL:#tn=                1.19.13.1.1 run redis>
                1.19.13.1.2 run postgres docker, tags: docker postgres pg <URL:#tn=                1.19.13.1.2 run postgres docker, tags: docker postgres pg>
                1.19.13.1.3 run tests <URL:#tn=                1.19.13.1.3 run tests>
                1.19.13.1.4 <URL:#tn=                1.19.13.1.4>
            1.19.13.2 <URL:#tn=            1.19.13.2>
        1.19.14 transport import <URL:#tn=        1.19.14 transport import>
            1.19.14.1 build browser side <URL:#tn=            1.19.14.1 build browser side>
            1.19.14.2 <URL:#tn=            1.19.14.2>
        1.19.15 delta link <URL:#tn=        1.19.15 delta link>
        1.19.16 Troubelshooting <URL:#tn=        1.19.16 Troubelshooting>
            1.19.16.1 Build <URL:#tn=            1.19.16.1 Build>
                1.19.16.1.1 Subsequent variable declarations must have the same type.  Variable 'WebGL2RenderingContext' <URL:#tn=                1.19.16.1.1 Subsequent variable declarations must have the same type.  Variable 'WebGL2RenderingContext'>
                1.19.16.1.2 error TS2307: Cannot find module './node_modules/tapable' or its corresponding type declarations. <URL:#tn=                1.19.16.1.2 error TS2307: Cannot find module './node_modules/tapable' or its corresponding type declarations.>
                1.19.16.1.3 <URL:#tn=                1.19.16.1.3>
            1.19.16.2 <URL:#tn=            1.19.16.2>
        1.19.17 CDM content generation <URL:#tn=        1.19.17 CDM content generation>
            1.19.17.1 Jawad's mock provider (cdm content generator), tags: Jawad mock provider cdm content generator <URL:#tn=            1.19.17.1 Jawad's mock provider (cdm content generator), tags: Jawad mock provider cdm content generator>
                1.19.17.1.1 Readme.md <URL:#tn=                1.19.17.1.1 Readme.md>
                1.19.17.1.2 Tasks CLI <URL:#tn=                1.19.17.1.2 Tasks CLI>
                    1.19.17.1.2.1 Example postman <URL:#tn=                    1.19.17.1.2.1 Example postman>
                    1.19.17.1.2.2 The python raw requests <URL:#tn=                    1.19.17.1.2.2 The python raw requests>
                    1.19.17.1.2.3 The CLI skeleton <URL:#tn=                    1.19.17.1.2.3 The CLI skeleton>
                    1.19.17.1.2.4 <URL:#tn=                    1.19.17.1.2.4>
                1.19.17.1.3 <URL:#tn=                1.19.17.1.3>
            1.19.17.2 <URL:#tn=            1.19.17.2>
        1.19.18 <URL:#tn=        1.19.18>
    1.20 2020 <URL:#tn=    1.20 2020>
        1.20.1   T01 <URL:#tn=        1.20.1   T01>
            1.20.1.1   [Eng.] Better and readable errors regarding schema issues <URL:#tn=            1.20.1.1   [Eng.] Better and readable errors regarding schema issues>
                1.20.1.1.1   Performance test <URL:#tn=                1.20.1.1.1   Performance test>
                    1.20.1.1.1.1   Internal code <URL:#tn=                    1.20.1.1.1.1   Internal code>
                        1.20.1.1.1.1.1   Our branch <URL:#tn=                        1.20.1.1.1.1.1   Our branch>
                        1.20.1.1.1.1.2 TCP json validation server <URL:#tn=                        1.20.1.1.1.1.2 TCP json validation server>
                        1.20.1.1.1.1.3 TCP json validation client <URL:#tn=                        1.20.1.1.1.1.3 TCP json validation client>
                        1.20.1.1.1.1.4 <URL:#tn=                        1.20.1.1.1.1.4>
                    1.20.1.1.1.2 external code <URL:#tn=                    1.20.1.1.1.2 external code>
                1.20.1.1.2 readability <URL:#tn=                1.20.1.1.2 readability>
        1.20.2 [Export_Import] Export of cFLP site with content-Server side - Design + Implementation <URL:#tn=        1.20.2 [Export_Import] Export of cFLP site with content-Server side - Design + Implementation>
            1.20.2.1 Links <URL:#tn=            1.20.2.1 Links>
            1.20.2.2 Design <URL:#tn=            1.20.2.2 Design>
                1.20.2.2.1 synchronous service <URL:#tn=                1.20.2.2.1 synchronous service>
                1.20.2.2.1 asynchronous service <URL:#tn=                1.20.2.2.1 asynchronous service>
            1.20.2.3 Tests <URL:#tn=            1.20.2.3 Tests>
                1.20.2.3.1 synchronous service <URL:#tn=                1.20.2.3.1 synchronous service>
                1.20.2.3.1 asynchronous service <URL:#tn=                1.20.2.3.1 asynchronous service>
            1.20.2.4 Tasks <URL:#tn=            1.20.2.4 Tasks>
                1.20.2.4.1 synchronous service <URL:#tn=                1.20.2.4.1 synchronous service>
                1.20.2.4.1 asynchronous service <URL:#tn=                1.20.2.4.1 asynchronous service>
            1.20.2.5 pull requests <URL:#tn=            1.20.2.5 pull requests>
                1.20.2.5.1 export job integration #3 <URL:#tn=                1.20.2.5.1 export job integration #3>
                1.20.2.5.2 <URL:#tn=                1.20.2.5.2>
            1.20.2.6 E2E tests <URL:#tn=            1.20.2.6 E2E tests>
            1.20.2.7 chunk aggregator tree <URL:#tn=            1.20.2.7 chunk aggregator tree>
            1.20.2.8 CTMS, , tags: CTMS, export import <URL:#tn=            1.20.2.8 CTMS, , tags: CTMS, export import>
            1.20.2.9 <URL:#tn=            1.20.2.9>
        1.20.3 spaces-and-pages   https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1368 / EUXTEAMSAAR-1369 [S4 Federation] Support Spaces & Pages as CDM entity - Design/Implementation <URL:#tn=        1.20.3 spaces-and-pages   https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1368 / EUXTEAMSAAR-1369 [S4 Federation] Support Spaces & Pages as CDM entity - Design/Implementation>
            1.20.3.1 Links <URL:#tn=            1.20.3.1 Links>
            1.20.3.2 Design <URL:#tn=            1.20.3.2 Design>
                1.20.3.2.1 relations diagram <URL:#tn=                1.20.3.2.1 relations diagram>
                1.20.3.2.2 my proposal <URL:#tn=                1.20.3.2.2 my proposal>
                1.20.3.2.3 <URL:#tn=                1.20.3.2.3>
            1.20.3.3 Tests <URL:#tn=            1.20.3.3 Tests>
            1.20.3.4 Implementation Tasks <URL:#tn=            1.20.3.4 Implementation Tasks>
                1.20.3.4.1 CDM-Store client expose methods w/ stop condition <URL:#tn=                1.20.3.4.1 CDM-Store client expose methods w/ stop condition>
                    1.20.3.4.1.1 list current search methods <URL:#tn=                    1.20.3.4.1.1 list current search methods>
                        1.20.3.4.1.1.1 CDM store methods <URL:#tn=                        1.20.3.4.1.1.1 CDM store methods>
                        1.20.3.4.1.1.2 CDM store client methods <URL:#tn=                        1.20.3.4.1.1.2 CDM store client methods>
                        1.20.3.4.1.1.3 Usage in semantic service <URL:#tn=                        1.20.3.4.1.1.3 Usage in semantic service>
                        1.20.3.4.1.1.4 Usage in activation service: <URL:#tn=                        1.20.3.4.1.1.4 Usage in activation service:>
                        1.20.3.4.1.1.5 Usage in provisioning service <URL:#tn=                        1.20.3.4.1.1.5 Usage in provisioning service>
                        1.20.3.4.1.1.6 Usage in transport service <URL:#tn=                        1.20.3.4.1.1.6 Usage in transport service>
                        1.20.3.4.1.1.7 summary emails <URL:#tn=                        1.20.3.4.1.1.7 summary emails>
                        1.20.3.4.1.1.8 <URL:#tn=                        1.20.3.4.1.1.8>
                    1.20.3.4.1.2 Implementation initial thoughts <URL:#tn=                    1.20.3.4.1.2 Implementation initial thoughts>
                    1.20.3.4.1.3 <URL:#tn=                    1.20.3.4.1.3>
                1.20.3.4.2 <URL:#tn=                1.20.3.4.2>
            1.20.3.5 PRs <URL:#tn=            1.20.3.5 PRs>
                1.20.3.5.1 CDM store <URL:#tn=                1.20.3.5.1 CDM store>
                1.20.3.5.2 CDM store client <URL:#tn=                1.20.3.5.2 CDM store client>
                1.20.3.5.3 transport <URL:#tn=                1.20.3.5.3 transport>
                1.20.3.5.4 cdm-schema <URL:#tn=                1.20.3.5.4 cdm-schema>
                1.20.3.5.5 <URL:#tn=                1.20.3.5.5>
            1.20.3.6 Followup <URL:#tn=            1.20.3.6 Followup>
                1.20.3.6.1  pages and sections apps ids missing providerid prefix <URL:#tn=                1.20.3.6.1  pages and sections apps ids missing providerid prefix>
                1.20.3.6.2 Fix <URL:#tn=                1.20.3.6.2 Fix>
            1.20.3.7 <URL:#tn=            1.20.3.7>
        1.20.4  upgrade spring version https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1373 <URL:#tn=        1.20.4  upgrade spring version https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1373>
        1.20.5   Support Helium like application in launchpad – Design &  Implementation <URL:#tn=        1.20.5   Support Helium like application in launchpad – Design &  Implementation>
            1.20.5.0 general <URL:#tn=            1.20.5.0 general>
            1.20.5.1 Links <URL:#tn=            1.20.5.1 Links>
                1.20.5.1.1 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1528 <URL:#tn=                1.20.5.1.1 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1528>
                1.20.5.1.2 [Launchpad/Workzone] - Approuter as a Service "helium like" consumption <URL:#tn=                1.20.5.1.2 [Launchpad/Workzone] - Approuter as a Service "helium like" consumption>
                    1.20.5.1.2.1 CF Content consumption <URL:#tn=                    1.20.5.1.2.1 CF Content consumption>
                    1.20.5.1.2.2 user story <URL:#tn=                    1.20.5.1.2.2 user story>
                    1.20.5.1.2.3 Design <URL:#tn=                    1.20.5.1.2.3 Design>
                1.20.5.1.3 <URL:#tn=                1.20.5.1.3>
            1.20.5.2 Design <URL:#tn=            1.20.5.2 Design>
                1.20.5.2.1 websequence diagram <URL:#tn=                1.20.5.2.1 websequence diagram>
            1.20.5.3 Tests <URL:#tn=            1.20.5.3 Tests>
            1.20.5.4 Tasks <URL:#tn=            1.20.5.4 Tasks>
                1.20.5.4.1 GET /tenants/provider/ids <URL:#tn=                1.20.5.4.1 GET /tenants/provider/ids>
                1.20.5.4.2 Data termination <URL:#tn=                1.20.5.4.2 Data termination>
                    1.20.5.4.2.1 Get subscribed providers <URL:#tn=                    1.20.5.4.2.1 Get subscribed providers>
                    1.20.5.4.2.2 DELETE helium instance from CDM-store <URL:#tn=                    1.20.5.4.2.2 DELETE helium instance from CDM-store>
                    1.20.5.4.2.3 add API to commons <URL:#tn=                    1.20.5.4.2.3 add API to commons>
                    1.20.5.4.2.4 Add helium provider PR <URL:#tn=                    1.20.5.4.2.4 Add helium provider PR>
                    1.20.5.4.2.5 data termination PR <URL:#tn=                    1.20.5.4.2.5 data termination PR>
                    1.20.5.4.2.6 Adam's local provider pull-request <URL:#tn=                    1.20.5.4.2.6 Adam's local provider pull-request>
                    1.20.5.4.2.7 <URL:#tn=                    1.20.5.4.2.7>
            1.20.5.5 related bug <URL:#tn=            1.20.5.5 related bug>
            1.20.5.6 demo sprint review <URL:#tn=            1.20.5.6 demo sprint review>
            1.20.5.7 <URL:#tn=            1.20.5.7>
        1.20.6   [S4 Federation] Support mass content CDM store Pagination Design <URL:#tn=        1.20.6   [S4 Federation] Support mass content CDM store Pagination Design>
            1.20.6.1   general <URL:#tn=            1.20.6.1   general>
                1.20.6.1.1   Sasha's bug <URL:#tn=                1.20.6.1.1   Sasha's bug>
                    1.20.6.1.1.1 Increase memory to 4GB <URL:#tn=                    1.20.6.1.1.1 Increase memory to 4GB>
                    1.20.6.1.1.2 Getting heap data <URL:#tn=                    1.20.6.1.1.2 Getting heap data>
                        1.20.6.1.1.2.1 Getting heap data using http actuator <URL:#tn=                        1.20.6.1.1.2.1 Getting heap data using http actuator>
                            1.20.6.1.1.2.1.1 How to <URL:#tn=                            1.20.6.1.1.2.1.1 How to>
                        1.20.6.1.1.2.2 code diff <URL:#tn=                        1.20.6.1.1.2.2 code diff>
                        1.20.6.1.1.2.3 <URL:#tn=                        1.20.6.1.1.2.3>
                    1.20.6.1.1.3 <URL:#tn=                    1.20.6.1.1.3>
                1.20.6.1.2 <URL:#tn=                1.20.6.1.2>
            1.20.6.2 Profiling cdm store java process <URL:#tn=            1.20.6.2 Profiling cdm store java process>
                1.20.6.2.1 enable JMX on CF <URL:#tn=                1.20.6.2.1 enable JMX on CF>
                1.20.6.2.2 <URL:#tn=                1.20.6.2.2>
            1.20.6.3 Action plan <URL:#tn=            1.20.6.3 Action plan>
            1.20.6.4 Sasha's Gatling system <URL:#tn=            1.20.6.4 Sasha's Gatling system>
                1.20.6.4.1 API, get entities with relations, maas content <URL:#tn=                1.20.6.4.1 API, get entities with relations, maas content>
                1.20.6.4.2 API, get entities with relations, normal content, nightly <URL:#tn=                1.20.6.4.2 API, get entities with relations, normal content, nightly>
                1.20.6.4.3 a short how to  for the API load tests <URL:#tn=                1.20.6.4.3 a short how to  for the API load tests>
                    1.20.6.4.3.1 VM values for Shlomi system <URL:#tn=                    1.20.6.4.3.1 VM values for Shlomi system>
                    1.20.6.4.3.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/docs/add_APIs_to_the_test_suite.md, <URL:#tn=                    1.20.6.4.3.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/docs/add_APIs_to_the_test_suite.md,>
                    1.20.6.4.3.3 <URL:#tn=                    1.20.6.4.3.3>
                1.20.6.4.4 <URL:#tn=                1.20.6.4.4>
            1.20.6.5 Additional use case. Content manager get local content <URL:#tn=            1.20.6.5 Additional use case. Content manager get local content>
            1.20.6.6 <URL:#tn=            1.20.6.6>
        1.20.7 EUXTEAMSAAR-1594    [Support Custom Tiles] Handle references for external providers <URL:#tn=        1.20.7 EUXTEAMSAAR-1594    [Support Custom Tiles] Handle references for external providers>
            1.20.7.1 Links <URL:#tn=            1.20.7.1 Links>
            1.20.7.2 Design, tags: Global Provider smartbusiness <URL:#tn=            1.20.7.2 Design, tags: Global Provider smartbusiness>
            1.20.7.3 Tests <URL:#tn=            1.20.7.3 Tests>
            1.20.7.4 Tasks <URL:#tn=            1.20.7.4 Tasks>
                1.20.7.4.1 transport-service <URL:#tn=                1.20.7.4.1 transport-service>
                    1.20.7.4.1.0 Add vizType to Portal schema – 4 pds <URL:#tn=                    1.20.7.4.1.0 Add vizType to Portal schema – 4 pds>
                    1.20.7.4.1.1 Create vizType cherry pick and reference to global provider cherry pick – 7 pds <URL:#tn=                    1.20.7.4.1.1 Create vizType cherry pick and reference to global provider cherry pick – 7 pds>
                    1.20.7.4.1.2 Activate store client for adding viztype relations + add UT. <URL:#tn=                    1.20.7.4.1.2 Activate store client for adding viztype relations + add UT.>
                        1.20.7.4.1.2.1 Add viztype relations PR in store client. Alina. <URL:#tn=                        1.20.7.4.1.2.1 Add viztype relations PR in store client. Alina.>
                        1.20.7.4.1.2.2 <URL:#tn=                        1.20.7.4.1.2.2>
                    1.20.7.4.1.3 Verify in sync that cherry pick vizType deleted and a new one is created – 2pds <URL:#tn=                    1.20.7.4.1.3 Verify in sync that cherry pick vizType deleted and a new one is created – 2pds>
                    1.20.7.4.1.4 Update transport report when vizType doesn't exist in the Global provider  - 4 pds <URL:#tn=                    1.20.7.4.1.4 Update transport report when vizType doesn't exist in the Global provider  - 4 pds>
                    1.20.7.4.1.5 Update transport report when vizType doesn't exist in the Global provider  - 4 <URL:#tn=                    1.20.7.4.1.5 Update transport report when vizType doesn't exist in the Global provider  - 4>
                    1.20.7.4.1.6 Update transport report when global provider with the given namespace doesn't exist – 3 pds <URL:#tn=                    1.20.7.4.1.6 Update transport report when global provider with the given namespace doesn't exist – 3 pds>
                    1.20.7.4.1.7 <URL:#tn=                    1.20.7.4.1.7>
                1.20.7.4.2 <URL:#tn=                1.20.7.4.2>
            1.20.7.5 Code <URL:#tn=            1.20.7.5 Code>
            1.20.7.6 FAQ <URL:#tn=            1.20.7.6 FAQ>
                1.20.7.6.1 My apps are being dropped in RT <URL:#tn=                1.20.7.6.1 My apps are being dropped in RT>
            1.20.7.7 <URL:#tn=            1.20.7.7>
        1.20.8  2020 T07 <URL:#tn=        1.20.8  2020 T07>
            1.20.8.1  Crown Jewels - Tenant Data Deletion & Validation - Cross team design and implementation <URL:#tn=            1.20.8.1  Crown Jewels - Tenant Data Deletion & Validation - Cross team design and implementation>
                1.20.8.1.1 Links <URL:#tn=                1.20.8.1.1 Links>
                1.20.8.1.2 Design <URL:#tn=                1.20.8.1.2 Design>
                1.20.8.1.3 Tests <URL:#tn=                1.20.8.1.3 Tests>
                1.20.8.1.4 Tasks <URL:#tn=                1.20.8.1.4 Tasks>
                1.20.8.1.5 Code <URL:#tn=                1.20.8.1.5 Code>
                1.20.8.1.6 Additional <URL:#tn=                1.20.8.1.6 Additional>
            1.20.8.2  provisioning service in NestJS aka new provisioning service <URL:#tn=            1.20.8.2  provisioning service in NestJS aka new provisioning service>
                1.20.8.2.1 Links <URL:#tn=                1.20.8.2.1 Links>
                1.20.8.2.2 Design <URL:#tn=                1.20.8.2.2 Design>
                1.20.8.2.3 Tests <URL:#tn=                1.20.8.2.3 Tests>
                1.20.8.2.4 Tasks <URL:#tn=                1.20.8.2.4 Tasks>
                1.20.8.2.5 Code <URL:#tn=                1.20.8.2.5 Code>
                    1.20.8.2.5.1 First steps <URL:#tn=                    1.20.8.2.5.1 First steps>
                    1.20.8.2.5.2 <URL:#tn=                    1.20.8.2.5.2>
                1.20.8.2.6 In depth <URL:#tn=                1.20.8.2.6 In depth>
                    1.20.8.2.6.1 graphql APIs <URL:#tn=                    1.20.8.2.6.1 graphql APIs>
                    1.20.8.2.6.2 <URL:#tn=                    1.20.8.2.6.2>
                1.20.8.2.7 run locally <URL:#tn=                1.20.8.2.7 run locally>
                    1.20.8.2.7.1 local APIs <URL:#tn=                    1.20.8.2.7.1 local APIs>
                    1.20.8.2.7.2 <URL:#tn=                    1.20.8.2.7.2>
                1.20.8.2.8 <URL:#tn=                1.20.8.2.8>
            1.20.8.3 <URL:#tn=            1.20.8.3>
        1.20.9   2020 T08 <URL:#tn=        1.20.9   2020 T08>
            1.20.9.1    [S4 Federation] Support S4 tiles in spaces and pages visualized as links <URL:#tn=            1.20.9.1    [S4 Federation] Support S4 tiles in spaces and pages visualized as links>
                1.20.9.1.1 Links <URL:#tn=                1.20.9.1.1 Links>
                1.20.9.1.2 relevant section: Follow ups <URL:#tn=                1.20.9.1.2 relevant section: Follow ups>
                1.20.9.1.2 Design <URL:#tn=                1.20.9.1.2 Design>
                    1.20.9.1.2.1 Preparatory <URL:#tn=                    1.20.9.1.2.1 Preparatory>
                        1.20.9.1.2.1.1 content <URL:#tn=                        1.20.9.1.2.1.1 content>
                        1.20.9.1.2.1.2 <URL:#tn=                        1.20.9.1.2.1.2>
                    1.20.9.1.2.2 <URL:#tn=                    1.20.9.1.2.2>
                1.20.9.1.3 Tests <URL:#tn=                1.20.9.1.3 Tests>
                1.20.9.1.4 Tasks <URL:#tn=                1.20.9.1.4 Tasks>
                1.20.9.1.5 Code <URL:#tn=                1.20.9.1.5 Code>
                    1.20.9.1.5.1 cdm-store-client <URL:#tn=                    1.20.9.1.5.1 cdm-store-client>
                    1.20.9.1.5.2 portal-cf-transport-service <URL:#tn=                    1.20.9.1.5.2 portal-cf-transport-service>
                    1.20.9.1.5.3 <URL:#tn=                    1.20.9.1.5.3>
                1.20.9.1.6 <URL:#tn=                1.20.9.1.6>
            1.20.9.2 <URL:#tn=            1.20.9.2>
            1.20.9.3 <URL:#tn=            1.20.9.3>
        1.20.10  2020 t09 <URL:#tn=        1.20.10  2020 t09>
            1.20.10.1 Import entities per product <URL:#tn=            1.20.10.1 Import entities per product>
                1.20.10.1.1 Links <URL:#tn=                1.20.10.1.1 Links>
                1.20.10.1.2 Design <URL:#tn=                1.20.10.1.2 Design>
                    1.20.10.1.2.1 User story <URL:#tn=                    1.20.10.1.2.1 User story>
                    1.20.10.1.2.2 websequence diagram <URL:#tn=                    1.20.10.1.2.2 websequence diagram>
                        1.20.10.1.2.2.1 Jawads previous websequence <URL:#tn=                        1.20.10.1.2.2.1 Jawads previous websequence>
                        1.20.10.1.2.2.2 per product import websequence <URL:#tn=                        1.20.10.1.2.2.2 per product import websequence>
                        1.20.10.1.2.2.3 <URL:#tn=                        1.20.10.1.2.2.3>
                    1.20.10.1.2.3 <URL:#tn=                    1.20.10.1.2.3>
                1.20.10.1.3 Tests <URL:#tn=                1.20.10.1.3 Tests>
                1.20.10.1.4 Tasks <URL:#tn=                1.20.10.1.4 Tasks>
                    1.20.10.1.4.1 Add version and product name to manifest <URL:#tn=                    1.20.10.1.4.1 Add version and product name to manifest>
                    1.20.10.1.4.2 zip utils <URL:#tn=                    1.20.10.1.4.2 zip utils>
                    1.20.10.1.4.3 CDM entity normalization <URL:#tn=                    1.20.10.1.4.3 CDM entity normalization>
                    1.20.10.1.4.4 Tasks infra <URL:#tn=                    1.20.10.1.4.4 Tasks infra>
                    1.20.10.1.4.5 Tasks planner <URL:#tn=                    1.20.10.1.4.5 Tasks planner>
                    1.20.10.1.4.6 <URL:#tn=                    1.20.10.1.4.6>
                1.20.10.1.5 Code <URL:#tn=                1.20.10.1.5 Code>
                1.20.10.1.6 Additional <URL:#tn=                1.20.10.1.6 Additional>
            1.20.10.2 [Platform] Hyperscale's Postgres & Redis transition - POC & Implementation <URL:#tn=            1.20.10.2 [Platform] Hyperscale's Postgres & Redis transition - POC & Implementation>
                1.20.10.2.1 Links <URL:#tn=                1.20.10.2.1 Links>
                1.20.10.2.2 Design <URL:#tn=                1.20.10.2.2 Design>
                1.20.10.2.3 Tests <URL:#tn=                1.20.10.2.3 Tests>
                    1.20.10.2.1.1 portal-cf-provisioning-service <URL:#tn=                    1.20.10.2.1.1 portal-cf-provisioning-service>
                    1.20.10.2.1.2 portal-cf-sdm-store-service <URL:#tn=                    1.20.10.2.1.2 portal-cf-sdm-store-service>
                    1.20.10.2.1.3 portal-cf-transport-service redis tests <URL:#tn=                    1.20.10.2.1.3 portal-cf-transport-service redis tests>
                    1.20.10.2.1.4 E2E <URL:#tn=                    1.20.10.2.1.4 E2E>
                    1.20.10.2.1.5 problems <URL:#tn=                    1.20.10.2.1.5 problems>
                        1.20.10.2.1.5.1 ERROR: could not extend file \"base/16385/2658\": No space left on device <URL:#tn=                        1.20.10.2.1.5.1 ERROR: could not extend file \"base/16385/2658\": No space left on device>
                            1.20.10.2.1.5.1.1  rc. apparently I was running on dev plan which gives 750MB only <URL:#tn=                            1.20.10.2.1.5.1.1  rc. apparently I was running on dev plan which gives 750MB only>
                            1.20.10.2.1.5.1.2   try unbind + rebind services <URL:#tn=                            1.20.10.2.1.5.1.2   try unbind + rebind services>
                            1.20.10.2.1.5.1.3 repro w/ small plan <URL:#tn=                            1.20.10.2.1.5.1.3 repro w/ small plan>
                            1.20.10.2.1.5.1.4 create composite indexes <URL:#tn=                            1.20.10.2.1.5.1.4 create composite indexes>
                        1.20.10.2.1.5.2 <URL:#tn=                        1.20.10.2.1.5.2>
                    1.20.10.2.1.6 add prints to transport service <URL:#tn=                    1.20.10.2.1.6 add prints to transport service>
                        1.20.10.2.1.6.1 code <URL:#tn=                        1.20.10.2.1.6.1 code>
                        1.20.10.2.1.6.2 logs <URL:#tn=                        1.20.10.2.1.6.2 logs>
                        1.20.10.2.1.6.3 <URL:#tn=                        1.20.10.2.1.6.3>
                        1.20.10.2.1.6.4 <URL:#tn=                        1.20.10.2.1.6.4>
                    1.20.10.2.1.7 <URL:#tn=                    1.20.10.2.1.7>
                1.20.10.2.4 Tasks <URL:#tn=                1.20.10.2.4 Tasks>
                1.20.10.2.5 Code <URL:#tn=                1.20.10.2.5 Code>
                    1.20.10.2.1.1 transport_service <URL:#tn=                    1.20.10.2.1.1 transport_service>
                    1.20.10.2.1.2 <URL:#tn=                    1.20.10.2.1.2>
                1.20.10.2.6 <URL:#tn=                1.20.10.2.6>
                1.20.10.2.1 Additional <URL:#tn=                1.20.10.2.1 Additional>
            1.20.10.3 <URL:#tn=            1.20.10.3>
        1.20.11 2020 t11, t10 <URL:#tn=        1.20.11 2020 t11, t10>
            1.20.11.1 Adopt XSUAA changes <URL:#tn=            1.20.11.1 Adopt XSUAA changes>
                1.20.11.1.1 Links <URL:#tn=                1.20.11.1.1 Links>
                1.20.11.1.2 Code <URL:#tn=                1.20.11.1.2 Code>
            1.20.11.6 Additional <URL:#tn=            1.20.11.6 Additional>
            1.20.11.2  move to node 14 <URL:#tn=            1.20.11.2  move to node 14>
                11.20.11.2.1 Links <URL:#tn=                11.20.11.2.1 Links>
                11.20.11.2.2 Design <URL:#tn=                11.20.11.2.2 Design>
                    11.20.11.2.2.1 NodeJS14 features <URL:#tn=                    11.20.11.2.2.1 NodeJS14 features>
                    11.20.11.2.2.2 research <URL:#tn=                    11.20.11.2.2.2 research>
                        11.20.11.2.2.2.1 pre upgrade <URL:#tn=                        11.20.11.2.2.2.1 pre upgrade>
                        11.20.11.2.2.2.2 ts-node impact <URL:#tn=                        11.20.11.2.2.2.2 ts-node impact>
                            11.20.11.2.2.2.2.1 https://stackoverflow.com/questions/61305578/what-typescript-configuration-produces-output-closest-to-node-js-14-capabilities <URL:#tn=                            11.20.11.2.2.2.2.1 https://stackoverflow.com/questions/61305578/what-typescript-configuration-produces-output-closest-to-node-js-14-capabilities>
                            11.20.11.2.2.2.2.2 commonjs modules <URL:#tn=                            11.20.11.2.2.2.2.2 commonjs modules>
                            11.20.11.2.2.2.2.3 push w/ node 14 build pack <URL:#tn=                            11.20.11.2.2.2.2.3 push w/ node 14 build pack>
                            11.20.11.2.2.2.2.4 <URL:#tn=                            11.20.11.2.2.2.2.4>
                        11.20.11.2.2.2.3 <URL:#tn=                        11.20.11.2.2.2.3>
                    11.20.11.2.2.3 open questions <URL:#tn=                    11.20.11.2.2.3 open questions>
                11.20.11.2.3 Tests <URL:#tn=                11.20.11.2.3 Tests>
                    11.20.11.2.3.1 logs <URL:#tn=                    11.20.11.2.3.1 logs>
                11.20.11.2.4 Tasks <URL:#tn=                11.20.11.2.4 Tasks>
                11.20.11.2.5 Code <URL:#tn=                11.20.11.2.5 Code>
                11.20.11.2.6 Additional <URL:#tn=                11.20.11.2.6 Additional>
                    11.20.11.2.6.1 Update regarding Node14 <URL:#tn=                    11.20.11.2.6.1 Update regarding Node14>
                    11.20.11.2.6.2 action items <URL:#tn=                    11.20.11.2.6.2 action items>
                    11.20.11.2.6.3 <URL:#tn=                    11.20.11.2.6.3>
                11.20.11.2.7 <URL:#tn=                11.20.11.2.7>
            1.20.11.3 Fix transport commit timeout, mass content <URL:#tn=            1.20.11.3 Fix transport commit timeout, mass content>
        1.20.11.3.1 Links <URL:#tn=        1.20.11.3.1 Links>
        1.20.11.3.2 Design <URL:#tn=        1.20.11.3.2 Design>
        1.20.11.3.3 Tests <URL:#tn=        1.20.11.3.3 Tests>
        1.20.11.3.4 Tasks <URL:#tn=        1.20.11.3.4 Tasks>
            1.20.11.3.4.1 Transport <URL:#tn=            1.20.11.3.4.1 Transport>
                1.20.11.3.4.1.1 Enforce max entity size limit <URL:#tn=                1.20.11.3.4.1.1 Enforce max entity size limit>
                1.20.11.3.4.1.2 Enforce max payload length. Fail transport on exceeding length. <URL:#tn=                1.20.11.3.4.1.2 Enforce max payload length. Fail transport on exceeding length.>
                    1.20.11.3.4.1.2.1 axios maxContentLength limit test on example role <URL:#tn=                    1.20.11.3.4.1.2.1 axios maxContentLength limit test on example role>
                    1.20.11.3.4.1.2.2 review preparation <URL:#tn=                    1.20.11.3.4.1.2.2 review preparation>
                    1.20.11.3.4.1.2.3 report error strings <URL:#tn=                    1.20.11.3.4.1.2.3 report error strings>
                1.20.11.3.4.1.3 Take # entities from destination property. <URL:#tn=                1.20.11.3.4.1.3 Take # entities from destination property.>
                1.20.11.3.4.1.4 Delete payload <URL:#tn=                1.20.11.3.4.1.4 Delete payload>
                1.20.11.3.4.1.5 Adapt relations resolvers <URL:#tn=                1.20.11.3.4.1.5 Adapt relations resolvers>
                1.20.11.3.4.1.6 <URL:#tn=                1.20.11.3.4.1.6>
            1.20.11.3.4.2 CDM-store Client <URL:#tn=            1.20.11.3.4.2 CDM-store Client>
            1.20.11.3.4.3 CDM-store <URL:#tn=            1.20.11.3.4.3 CDM-store>
                1.20.11.3.4.3.1 Adapt to new relations structure (no context) and no payload. <URL:#tn=                1.20.11.3.4.3.1 Adapt to new relations structure (no context) and no payload.>
            1.20.11.3.4.4 General <URL:#tn=            1.20.11.3.4.4 General>
            1.20.11.3.4.5 Validation Service <URL:#tn=            1.20.11.3.4.5 Validation Service>
            1.20.11.3.4.6 Schema <URL:#tn=            1.20.11.3.4.6 Schema>
            1.20.11.3.4.7 <URL:#tn=            1.20.11.3.4.7>
        1.20.11.3.5 Code <URL:#tn=        1.20.11.3.5 Code>
        1.20.11.3.6 Additional <URL:#tn=        1.20.11.3.6 Additional>
            1.20.11.3.6.1 NodeJs increase heap size <URL:#tn=            1.20.11.3.6.1 NodeJs increase heap size>
            1.20.11.3.6.2 Java increase memory size <URL:#tn=            1.20.11.3.6.2 Java increase memory size>
            1.20.11.3.6.3 <URL:#tn=            1.20.11.3.6.3>
        1.20.11.3.7 <URL:#tn=        1.20.11.3.7>
            1.20.11.4 <URL:#tn=            1.20.11.4>
        1.20.12 2020 t12 <URL:#tn=        1.20.12 2020 t12>
            1.20.12.1 Transport - disk quota exceeded bug <URL:#tn=            1.20.12.1 Transport - disk quota exceeded bug>
                1.20.12.1.1 analysis <URL:#tn=                1.20.12.1.1 analysis>
                1.20.12.1.2 possible solutions <URL:#tn=                1.20.12.1.2 possible solutions>
                1.20.12.1.3 OR <URL:#tn=                1.20.12.1.3 OR>
                1.20.12.1.4 <URL:#tn=                1.20.12.1.4>
            1.20.12.2 redis-cache delete keys by pattern issue <URL:#tn=            1.20.12.2 redis-cache delete keys by pattern issue>
                1.20.12.2.1 Shared-lib redis fix <URL:#tn=                1.20.12.2.1 Shared-lib redis fix>
                1.20.12.2.2 portal-cf-transport-service fix, DWPBUGS-855 <URL:#tn=                1.20.12.2.2 portal-cf-transport-service fix, DWPBUGS-855>
                1.20.12.2.3 <URL:#tn=                1.20.12.2.3>
            1.20.12.3 <URL:#tn=            1.20.12.3>
        1.20.13 2020 t13 <URL:#tn=        1.20.13 2020 t13>
            1.20.13.1 dynamic logging <URL:#tn=            1.20.13.1 dynamic logging>
                1.20.13.1.1 Links <URL:#tn=                1.20.13.1.1 Links>
                1.20.13.1.2 Design <URL:#tn=                1.20.13.1.2 Design>
                1.20.13.1.3 Tests <URL:#tn=                1.20.13.1.3 Tests>
                    1.20.13.1.3.1 on hadar's space <URL:#tn=                    1.20.13.1.3.1 on hadar's space>
                        1.20.13.1.3.1.1 generate client token, tags: generate client technical token <URL:#tn=                        1.20.13.1.3.1.1 generate client token, tags: generate client technical token>
                    1.20.13.1.3.2 <URL:#tn=                    1.20.13.1.3.2>
                1.20.13.1.4 Tasks <URL:#tn=                1.20.13.1.4 Tasks>
                    1.20.13.1.4.1 research <URL:#tn=                    1.20.13.1.4.1 research>
                        1.20.13.1.4.1.1 related PRs <URL:#tn=                        1.20.13.1.4.1.1 related PRs>
                        1.20.13.1.4.1.2 Node impl start point <URL:#tn=                        1.20.13.1.4.1.2 Node impl start point>
                        1.20.13.1.4.1.3 Transport equivalent <URL:#tn=                        1.20.13.1.4.1.3 Transport equivalent>
                        1.20.13.1.4.1.4 shared lib infra <URL:#tn=                        1.20.13.1.4.1.4 shared lib infra>
                            1.20.13.1.4.1.4.1 clearLoggingLevelMaps(loggerCtx) <URL:#tn=                            1.20.13.1.4.1.4.1 clearLoggingLevelMaps(loggerCtx)>
                            1.20.13.1.4.1.4.2 setKeyAndValueInMap(loggerCtx, type, key, value) <URL:#tn=                            1.20.13.1.4.1.4.2 setKeyAndValueInMap(loggerCtx, type, key, value)>
                            1.20.13.1.4.1.4.3 setLoggingLevelSpecificConfig(loggerCtx, instanceId, userId, tenantId) <URL:#tn=                            1.20.13.1.4.1.4.3 setLoggingLevelSpecificConfig(loggerCtx, instanceId, userId, tenantId)>
                        1.20.13.1.4.1.5 setDynamicLoggingLevel <URL:#tn=                        1.20.13.1.4.1.5 setDynamicLoggingLevel>
                        1.20.13.1.4.1.6 <URL:#tn=                        1.20.13.1.4.1.6>
                    1.20.13.1.4.2 <URL:#tn=                    1.20.13.1.4.2>
                1.20.13.1.5 Code <URL:#tn=                1.20.13.1.5 Code>
                    1.20.13.1.5.1 middleware <URL:#tn=                    1.20.13.1.5.1 middleware>
                    1.20.13.1.5.2 Logger <URL:#tn=                    1.20.13.1.5.2 Logger>
                    1.20.13.1.5.3 Technical token authentication <URL:#tn=                    1.20.13.1.5.3 Technical token authentication>
                    1.20.13.1.5.4 Add TTL to dynamicLogData <URL:#tn=                    1.20.13.1.5.4 Add TTL to dynamicLogData>
                    1.20.13.1.5.5 <URL:#tn=                    1.20.13.1.5.5>
                1.20.13.1.6 Additional <URL:#tn=                1.20.13.1.6 Additional>
            1.20.13.2 browserify, disk quota exceeded EUXTEAMSAAR-2015 <URL:#tn=            1.20.13.2 browserify, disk quota exceeded EUXTEAMSAAR-2015>
            1.20.13.3 <URL:#tn=            1.20.13.3>
        1.20.14 2020 t14 <URL:#tn=        1.20.14 2020 t14>
            1.20.14.1 Links <URL:#tn=            1.20.14.1 Links>
    1.21 2021 <URL:#tn=    1.21 2021>
        1.21.1  T01 <URL:#tn=        1.21.1  T01>
            1.21.1.1  x509 Support Transport service with ClientCertificateAuthentication <URL:#tn=            1.21.1.1  x509 Support Transport service with ClientCertificateAuthentication>
                1.21.1.1.1 Links <URL:#tn=                1.21.1.1.1 Links>
                1.21.1.1.2 Design <URL:#tn=                1.21.1.1.2 Design>
                1.21.1.1.3 Tests <URL:#tn=                1.21.1.1.3 Tests>
                    1.21.1.1.3.1 create mock certificates <URL:#tn=                    1.21.1.1.3.1 create mock certificates>
                    1.21.1.1.3.2 Create mock provider that accepts client certificate authentication <URL:#tn=                    1.21.1.1.3.2 Create mock provider that accepts client certificate authentication>
                    1.21.1.1.3.3 Destination response <URL:#tn=                    1.21.1.1.3.3 Destination response>
                    1.21.1.1.3.4 Daniels certificates <URL:#tn=                    1.21.1.1.3.4 Daniels certificates>
                    1.21.1.1.3.5 iva.doncheva response <URL:#tn=                    1.21.1.1.3.5 iva.doncheva response>
                    1.21.1.1.3.6 <URL:#tn=                    1.21.1.1.3.6>
                1.21.1.1.4 Tasks <URL:#tn=                1.21.1.1.4 Tasks>
                1.21.1.1.5 Code <URL:#tn=                1.21.1.1.5 Code>
                1.21.1.1.6 Additional <URL:#tn=                1.21.1.1.6 Additional>
                1.21.1.2.6 <URL:#tn=                1.21.1.2.6>
            1.21.1.3 <URL:#tn=            1.21.1.3>
        1.21.2  T02 <URL:#tn=        1.21.2  T02>
            1.21.2.2 Prevent principal propogation, EUXTEAMSAAR-2108 [Federation] Support Transport service with Cloud connector configured to X509 <URL:#tn=            1.21.2.2 Prevent principal propogation, EUXTEAMSAAR-2108 [Federation] Support Transport service with Cloud connector configured to X509>
                1.21.2.2.1 general <URL:#tn=                1.21.2.2.1 general>
                1.21.2.2.2 tracking branch <URL:#tn=                1.21.2.2.2 tracking branch>
                1.21.2.2.3 Saar Setup <URL:#tn=                1.21.2.2.3 Saar Setup>
                1.21.2.2.4 Tests <URL:#tn=                1.21.2.2.4 Tests>
                1.21.2.2.5 Code <URL:#tn=                1.21.2.2.5 Code>
            1.21.2.3 <URL:#tn=            1.21.2.3>
        1.21.3  T03 <URL:#tn=        1.21.3  T03>
            1.21.3.1   [Federation-Automatic sync] Transport service support new parameters(callback, token) - Design, tags: auto sync callback token <URL:#tn=            1.21.3.1   [Federation-Automatic sync] Transport service support new parameters(callback, token) - Design, tags: auto sync callback token>
                1.21.3.1.1   General <URL:#tn=                1.21.3.1.1   General>
                1.21.3.1.2 high level design <URL:#tn=                1.21.3.1.2 high level design>
                1.21.3.1.3 <URL:#tn=                1.21.3.1.3>
            1.21.3.2 [Mass Content] Support CDM store Full text search - Design <URL:#tn=            1.21.3.2 [Mass Content] Support CDM store Full text search - Design>
                1.21.3.2.1 Links <URL:#tn=                1.21.3.2.1 Links>
            1.21.3.3 [Federation-Automatic sync] Transport service support new parameters(callback, token) - Implementation <URL:#tn=            1.21.3.3 [Federation-Automatic sync] Transport service support new parameters(callback, token) - Implementation>
                1.21.3.3.1 Links <URL:#tn=                1.21.3.3.1 Links>
                1.21.3.3.2 Design <URL:#tn=                1.21.3.3.2 Design>
                1.21.3.3.3 Tests <URL:#tn=                1.21.3.3.3 Tests>
                1.21.3.3.4 Tasks <URL:#tn=                1.21.3.3.4 Tasks>
                    1.21.3.3.4.1  Write Test Scope <URL:#tn=                    1.21.3.3.4.1  Write Test Scope>
                    1.21.3.3.4.2  Prep setup/space <URL:#tn=                    1.21.3.3.4.2  Prep setup/space>
                    1.21.3.3.4.3  DCM DTO update <URL:#tn=                    1.21.3.3.4.3  DCM DTO update>
                    1.21.3.3.4.4  Job ID logic <URL:#tn=                    1.21.3.3.4.4  Job ID logic>
                    1.21.3.3.4.5  412 EP error handling <URL:#tn=                    1.21.3.3.4.5  412 EP error handling>
                    1.21.3.3.4.6  Prefer header <URL:#tn=                    1.21.3.3.4.6  Prefer header>
                    1.21.3.3.4.7  Report changes <URL:#tn=                    1.21.3.3.4.7  Report changes>
                    1.21.3.3.4.8  Delta link prefer + callback headers <URL:#tn=                    1.21.3.3.4.8  Delta link prefer + callback headers>
                    1.21.3.3.4.9  Delta link response logic <URL:#tn=                    1.21.3.3.4.9  Delta link response logic>
                    1.21.3.3.4.10 Report Versions "DB" layer, including migration <URL:#tn=                    1.21.3.3.4.10 Report Versions "DB" layer, including migration>
                    1.21.3.3.4.11 Report Versions business logic <URL:#tn=                    1.21.3.3.4.11 Report Versions business logic>
                    1.21.3.3.4.12 Error handling <URL:#tn=                    1.21.3.3.4.12 Error handling>
                    1.21.3.3.4.13 Zero report overwrite or not <URL:#tn=                    1.21.3.3.4.13 Zero report overwrite or not>
                    1.21.3.3.4.14 Transport manage loop <URL:#tn=                    1.21.3.3.4.14 Transport manage loop>
                    1.21.3.3.4.15 Partial stop loop <URL:#tn=                    1.21.3.3.4.15 Partial stop loop>
                    1.21.3.3.4.16 Improved retry <URL:#tn=                    1.21.3.3.4.16 Improved retry>
                    1.21.3.3.4.17 Non user token <URL:#tn=                    1.21.3.3.4.17 Non user token>
                    1.21.3.3.4.18 Feature Toggle <URL:#tn=                    1.21.3.3.4.18 Feature Toggle>
                        1.21.3.3.4.18.1 reference in transport_service <URL:#tn=                        1.21.3.3.4.18.1 reference in transport_service>
                        1.21.3.3.4.18.2 reference in semantic-service <URL:#tn=                        1.21.3.3.4.18.2 reference in semantic-service>
                        1.21.3.3.4.18.3 <URL:#tn=                        1.21.3.3.4.18.3>
                    1.21.3.3.4.19 Integration with semantic service <URL:#tn=                    1.21.3.3.4.19 Integration with semantic service>
                    1.21.3.3.4.20 Integration/Manual tests <URL:#tn=                    1.21.3.3.4.20 Integration/Manual tests>
                    1.21.3.3.4.21 Auto tests <URL:#tn=                    1.21.3.3.4.21 Auto tests>
                1.21.3.3.5 Code <URL:#tn=                1.21.3.3.5 Code>
                1.21.3.3.6 Additional <URL:#tn=                1.21.3.3.6 Additional>
            1.21.3.4 placeholder <URL:#tn=            1.21.3.4 placeholder>
                1.21.3.4.1 Links <URL:#tn=                1.21.3.4.1 Links>
                1.21.3.4.2 Design <URL:#tn=                1.21.3.4.2 Design>
                1.21.3.4.3 Tests <URL:#tn=                1.21.3.4.3 Tests>
                1.21.3.4.4 Tasks <URL:#tn=                1.21.3.4.4 Tasks>
                1.21.3.4.5 Code <URL:#tn=                1.21.3.4.5 Code>
                1.21.3.4.6 Additional <URL:#tn=                1.21.3.4.6 Additional>
        1.21.4  T04 <URL:#tn=        1.21.4  T04>
            1.21.4.1  CDM Store NestJS design 10 PDs B <URL:#tn=            1.21.4.1  CDM Store NestJS design 10 PDs B>
                1.21.4.1.1 Links <URL:#tn=                1.21.4.1.1 Links>
                1.21.4.1.2 Design <URL:#tn=                1.21.4.1.2 Design>
                1.21.4.1.3 Tests <URL:#tn=                1.21.4.1.3 Tests>
                1.21.4.1.4 Tasks <URL:#tn=                1.21.4.1.4 Tasks>
                1.21.4.1.5 Code <URL:#tn=                1.21.4.1.5 Code>
                1.21.4.1.6 Additional <URL:#tn=                1.21.4.1.6 Additional>
            1.21.4.2 [Mass Content] CDM store Support autoscale - preparation 12 PDs A Working with Nadav's team, tags: cdm-store, autoscaler <URL:#tn=            1.21.4.2 [Mass Content] CDM store Support autoscale - preparation 12 PDs A Working with Nadav's team, tags: cdm-store, autoscaler>
                1.21.4.2.1 Links <URL:#tn=                1.21.4.2.1 Links>
                1.21.4.2.2 Design <URL:#tn=                1.21.4.2.2 Design>
                    1.21.4.2.2.1 documentation <URL:#tn=                    1.21.4.2.2.1 documentation>
                        1.21.4.2.2.1.1 Official documentation <URL:#tn=                        1.21.4.2.2.1.1 Official documentation>
                            1.21.4.2.2.1.1.1 Procedure <URL:#tn=                            1.21.4.2.2.1.1.1 Procedure>
                            1.21.4.2.2.1.1.2 autoscaler policy <URL:#tn=                            1.21.4.2.2.1.1.2 autoscaler policy>
                                1.21.4.2.2.1.1.2.1 Dynamic Scaling Policy <URL:#tn=                                1.21.4.2.2.1.1.2.1 Dynamic Scaling Policy>
                                1.21.4.2.2.1.1.2.2 Recurring Schedules <URL:#tn=                                1.21.4.2.2.1.1.2.2 Recurring Schedules>
                            1.21.4.2.2.1.1.3 <URL:#tn=                            1.21.4.2.2.1.1.3>
                        1.21.4.2.2.1.2 definitions and testing <URL:#tn=                        1.21.4.2.2.1.2 definitions and testing>
                        1.21.4.2.2.1.3 integration <URL:#tn=                        1.21.4.2.2.1.3 integration>
                        1.21.4.2.2.1.4 autoscaler binding manifest-concourse example <URL:#tn=                        1.21.4.2.2.1.4 autoscaler binding manifest-concourse example>
                        1.21.4.2.2.1.5 a scaling policy example policy <URL:#tn=                        1.21.4.2.2.1.5 a scaling policy example policy>
                        1.21.4.2.2.1.6 how to attach scaling policy <URL:#tn=                        1.21.4.2.2.1.6 how to attach scaling policy>
                        1.21.4.2.2.1.7 Maximum number of connections to database <URL:#tn=                        1.21.4.2.2.1.7 Maximum number of connections to database>
                            1.21.4.2.2.1.7.1 hyperscaler <URL:#tn=                            1.21.4.2.2.1.7.1 hyperscaler>
                            1.21.4.2.2.1.7.2 Service Fabric <URL:#tn=                            1.21.4.2.2.1.7.2 Service Fabric>
                        1.21.4.2.2.1.8 Additional <URL:#tn=                        1.21.4.2.2.1.8 Additional>
                1.21.4.2.3 Tests <URL:#tn=                1.21.4.2.3 Tests>
                    1.21.4.2.3.1 on my dev space <URL:#tn=                    1.21.4.2.3.1 on my dev space>
                    1.21.4.2.3.2 on LTS <URL:#tn=                    1.21.4.2.3.2 on LTS>
                1.21.4.2.4 Tasks <URL:#tn=                1.21.4.2.4 Tasks>
                1.21.4.2.5 Code <URL:#tn=                1.21.4.2.5 Code>
                1.21.4.2.6 Additional <URL:#tn=                1.21.4.2.6 Additional>
                1.21.4.2.7 Content creator service <URL:#tn=                1.21.4.2.7 Content creator service>
                1.21.4.2.8 Cloud Foundry CLI AutoScaler Plug-in <URL:#tn=                1.21.4.2.8 Cloud Foundry CLI AutoScaler Plug-in>
                1.21.4.2.9 Adam python load script <URL:#tn=                1.21.4.2.9 Adam python load script>
                1.21.4.2.10 <URL:#tn=                1.21.4.2.10>
            1.21.4.3 others <URL:#tn=            1.21.4.3 others>
                1.21.4.3.1 https://jira.tools.sap/browse/DWPBUGS-3566   Deleting roles in CP -> roles still appears in cockpit <URL:#tn=                1.21.4.3.1 https://jira.tools.sap/browse/DWPBUGS-3566   Deleting roles in CP -> roles still appears in cockpit>
                1.21.4.3.2 <URL:#tn=                1.21.4.3.2>
            1.21.4.4 <URL:#tn=            1.21.4.4>
        1.21.5  T05 <URL:#tn=        1.21.5  T05>
        1.21.6  T06 <URL:#tn=        1.21.6  T06>
        1.21.7  T07 <URL:#tn=        1.21.7  T07>
        1.21.8  T08 <URL:#tn=        1.21.8  T08>
        1.21.9  T09 <URL:#tn=        1.21.9  T09>
        1.21.10 T10 <URL:#tn=        1.21.10 T10>
        1.21.11 T11 <URL:#tn=        1.21.11 T11>
            1.21.11.1  team BLIs <URL:#tn=            1.21.11.1  team BLIs>
                1.21.11.1.1   EUXTEAMSAAR-2682 CEP Activation - Message Queue Library <URL:#tn=                1.21.11.1.1   EUXTEAMSAAR-2682 CEP Activation - Message Queue Library>
                1.21.11.1.2  EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces  Core and Portal Schema. <URL:#tn=                1.21.11.1.2  EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces  Core and Portal Schema.>
                1.21.11.1.3 security fix <URL:#tn=                1.21.11.1.3 security fix>
                1.21.11.1.4  EUXTEAMSAAR-2663 [Manual integration] Support additional param types in navigation. <URL:#tn=                1.21.11.1.4  EUXTEAMSAAR-2663 [Manual integration] Support additional param types in navigation.>
                1.21.11.1.5 EUXTEAMSAAR-2579 [CEP: Content Management] Support for Workpages & Workspaces - Transport Service and CDM Store <URL:#tn=                1.21.11.1.5 EUXTEAMSAAR-2579 [CEP: Content Management] Support for Workpages & Workspaces - Transport Service and CDM Store>
                1.21.11.1.6  EUXTEAMSAAR-2631 CEP Activation - Add Message Queue to CDM Store <URL:#tn=                1.21.11.1.6  EUXTEAMSAAR-2631 CEP Activation - Add Message Queue to CDM Store>
                1.21.11.1.7 EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces - Core and Portal Schema <URL:#tn=                1.21.11.1.7 EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces - Core and Portal Schema>
                1.21.11.1.8 EUXTEAMSAAR-2702 Improve DB performance II <URL:#tn=                1.21.11.1.8 EUXTEAMSAAR-2702 Improve DB performance II>
                1.21.11.1.9 Task -  Research Security Issues class validator code injection <URL:#tn=                1.21.11.1.9 Task -  Research Security Issues class validator code injection>
                1.21.11.1.10 <URL:#tn=                1.21.11.1.10>
            1.21.11.2 Other BLIs <URL:#tn=            1.21.11.2 Other BLIs>
                1.21.11.2.1 Lazy fix of FDC-app-host-id <URL:#tn=                1.21.11.2.1 Lazy fix of FDC-app-host-id>
                1.21.11.2.2 [CEP: Content Management] Extend the Site Manager to Support Content Packages <URL:#tn=                1.21.11.2.2 [CEP: Content Management] Extend the Site Manager to Support Content Packages>
                1.21.11.2.3 Business Application Variant <URL:#tn=                1.21.11.2.3 Business Application Variant>
                1.21.11.2.4 CEP site schema <URL:#tn=                1.21.11.2.4 CEP site schema>
                1.21.11.2.5 crown jewls, mtls <URL:#tn=                1.21.11.2.5 crown jewls, mtls>
                1.21.11.2.6 Enhance Transport Report <URL:#tn=                1.21.11.2.6 Enhance Transport Report>
            1.21.11.3 <URL:#tn=            1.21.11.3>
        1.21.12 T12 <URL:#tn=        1.21.12 T12>
            1.21.12.1 team BLIs <URL:#tn=            1.21.12.1 team BLIs>
                1.21.12.1.1 Engineering: Create site-entity table <URL:#tn=                1.21.12.1.1 Engineering: Create site-entity table>
                1.21.12.1.2 CEP Activation - Message Queue Library <URL:#tn=                1.21.12.1.2 CEP Activation - Message Queue Library>
                1.21.12.1.3 CEP Activation -  Solace Service Instance Provisioning <URL:#tn=                1.21.12.1.3 CEP Activation -  Solace Service Instance Provisioning>
                1.21.12.1.4 CEP Activation – Add Message Queue to CDM Store <URL:#tn=                1.21.12.1.4 CEP Activation – Add Message Queue to CDM Store>
                1.21.12.1.5 Mass Content – POC (resilience) <URL:#tn=                1.21.12.1.5 Mass Content – POC (resilience)>
                1.21.12.1.6 [Supportability] Transport service - enhance errors & logging <URL:#tn=                1.21.12.1.6 [Supportability] Transport service - enhance errors & logging>
                1.21.12.1.7 <URL:#tn=                1.21.12.1.7>
            1.21.12.2 External BLIs <URL:#tn=            1.21.12.2 External BLIs>
            1.21.12.3 <URL:#tn=            1.21.12.3>
        1.21.13 T13 <URL:#tn=        1.21.13 T13>
            1.21.13.10 Signoff <URL:#tn=            1.21.13.10 Signoff>
            1.21.13.11 Scrum-of-scrums <URL:#tn=            1.21.13.11 Scrum-of-scrums>
                1.21.13.11.1 21/12/21 13:28:10 <URL:#tn=                1.21.13.11.1 21/12/21 13:28:10>
                1.21.13.11.2 <URL:#tn=                1.21.13.11.2>
            1.21.13.2 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2753 - is_alive <URL:#tn=            1.21.13.2 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2753 - is_alive>
            1.21.13.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2754 - support (optional) indirect and direct relations <URL:#tn=            1.21.13.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2754 - support (optional) indirect and direct relations>
                1.21.13.3.1 general information <URL:#tn=                1.21.13.3.1 general information>
                1.21.13.3.2 migration code <URL:#tn=                1.21.13.3.2 migration code>
                1.21.13.3.3 <URL:#tn=                1.21.13.3.3>
            1.21.13.4 CEP Activation – Add Message Queue to CDM Store https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631 <URL:#tn=            1.21.13.4 CEP Activation – Add Message Queue to CDM Store https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631>
            1.21.13.5 Support Sergey's team with - Business Application Variant - Extend CDM client <URL:#tn=            1.21.13.5 Support Sergey's team with - Business Application Variant - Extend CDM client>
        1.21.14 [Mass Content] Compliant Backend Search - Imp <URL:#tn=        1.21.14 [Mass Content] Compliant Backend Search - Imp>
        1.21.15 Determine max page size for activation - Perform  measurement tests - 5 PDs. Margieh, Jawad <URL:#tn=        1.21.15 Determine max page size for activation - Perform  measurement tests - 5 PDs. Margieh, Jawad>
        1.21.16 related <URL:#tn=        1.21.16 related>
        1.21.17 [ENG] CDM Store refactor -kickstart <URL:#tn=        1.21.17 [ENG] CDM Store refactor -kickstart>
        1.21.18 <URL:#tn=        1.21.18>
    1.22 2022 <URL:#tn=    1.22 2022>
        1.22.1  T01 <URL:#tn=        1.22.1  T01>
            1.22.1.1  BLIs and tasks <URL:#tn=            1.22.1.1  BLIs and tasks>
                1.22.1.1.1 Apollo, DTS and Developer SCENARIOS  Handover <URL:#tn=                1.22.1.1.1 Apollo, DTS and Developer SCENARIOS  Handover>
                1.22.1.1.2 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2755 SRE: [Mass Content] Compliant Backend Search - Imp  -  Cohen, Adam <URL:#tn=                1.22.1.1.2 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2755 SRE: [Mass Content] Compliant Backend Search - Imp  -  Cohen, Adam>
                1.22.1.1.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2820 [ENG] CDM Store refactor 2 <URL:#tn=                1.22.1.1.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2820 [ENG] CDM Store refactor 2>
                1.22.1.1.4 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631 <URL:#tn=                1.22.1.1.4 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631>
                1.22.1.1.5 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation <URL:#tn=                1.22.1.1.5 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation>
                1.22.1.1.6 [ENG] Regular update of OSS and 3rd party versions https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2819 <URL:#tn=                1.22.1.1.6 [ENG] Regular update of OSS and 3rd party versions https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2819>
                1.22.1.1.7 <URL:#tn=                1.22.1.1.7>
                1.22.1.1.8 <URL:#tn=                1.22.1.1.8>
            1.22.1.2 related <URL:#tn=            1.22.1.2 related>
                1.22.1.2.1 [DR] Activation Supporting group/catalog role optional relation <URL:#tn=                1.22.1.2.1 [DR] Activation Supporting group/catalog role optional relation>
                1.22.1.2.2 <URL:#tn=                1.22.1.2.2>
            1.22.1.3 retro <URL:#tn=            1.22.1.3 retro>
            1.22.1.4 <URL:#tn=            1.22.1.4>
        1.22.2  T02 <URL:#tn=        1.22.2  T02>
            1.22.2.1   signoff <URL:#tn=            1.22.2.1   signoff>
            1.22.2.2  [ENG] test and build using docker <URL:#tn=            1.22.2.2  [ENG] test and build using docker>
            1.22.2.3 https://jira.tools.sap/browse/EUXTEAMSAAR-2853 <URL:#tn=            1.22.2.3 https://jira.tools.sap/browse/EUXTEAMSAAR-2853>
            1.22.2.4 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation <URL:#tn=            1.22.2.4 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation>
                1.22.2.4.1 QA day <URL:#tn=                1.22.2.4.1 QA day>
                    1.22.2.4.1.1  email thread <URL:#tn=                    1.22.2.4.1.1  email thread>
                1.22.2.4.2 Test-Scope <URL:#tn=                1.22.2.4.2 Test-Scope>
                1.22.2.4.3 <URL:#tn=                1.22.2.4.3>
            1.22.2.5 [SRE] backend search - migration <URL:#tn=            1.22.2.5 [SRE] backend search - migration>
            1.22.2.6 EUXTEAMSAAR-2846 [Federation] Support optional relation between roles and catalogs/groups - Migration of existing content <URL:#tn=            1.22.2.6 EUXTEAMSAAR-2846 [Federation] Support optional relation between roles and catalogs/groups - Migration of existing content>
            1.22.2.7 EUXTEAMSAAR-2816 Message queuing capacity planning <URL:#tn=            1.22.2.7 EUXTEAMSAAR-2816 Message queuing capacity planning>
            1.22.2.8 <URL:#tn=            1.22.2.8>
        1.22.3  T03 <URL:#tn=        1.22.3  T03>
            1.22.3.1  [Federation] Implement an encoding and decoding logic for role IDs - research and design	 - https://jira.tools.sap/browse/EUXTEAMSAAR-2907 <URL:#tn=            1.22.3.1  [Federation] Implement an encoding and decoding logic for role IDs - research and design	 - https://jira.tools.sap/browse/EUXTEAMSAAR-2907>
                1.22.3.1.1  background <URL:#tn=                1.22.3.1.1  background>
                1.22.3.1.2 Risks+HLEE for implementation on launchpad <URL:#tn=                1.22.3.1.2 Risks+HLEE for implementation on launchpad>
            1.22.3.2 EUXTEAMSAAR-2842 Enabling Transport of "Save As Local" applications <URL:#tn=            1.22.3.2 EUXTEAMSAAR-2842 Enabling Transport of "Save As Local" applications>
            1.22.3.3 EUXTEAMSAAR-2305 [Supportability] Transport service - enhance errors & logging <URL:#tn=            1.22.3.3 EUXTEAMSAAR-2305 [Supportability] Transport service - enhance errors & logging>
            1.22.3.4 EUXTEAMSAAR-2843 [CEP: Federated HTML5) DTS move from batch API to import API <URL:#tn=            1.22.3.4 EUXTEAMSAAR-2843 [CEP: Federated HTML5) DTS move from batch API to import API>
            1.22.3.5 EUXTEAMSAAR-2903 [ENG] upgrade node version <URL:#tn=            1.22.3.5 EUXTEAMSAAR-2903 [ENG] upgrade node version>
            1.22.3.6 <URL:#tn=            1.22.3.6>
        1.22.4  T04 <URL:#tn=        1.22.4  T04>
            1.22.4.1  [CEP] RT API - Services Productization <URL:#tn=            1.22.4.1  [CEP] RT API - Services Productization>
                1.22.4.1.1  design :[CEP] CEP Content API - Services Productization <URL:#tn=                1.22.4.1.1  design :[CEP] CEP Content API - Services Productization>
                1.22.4.1.2 <URL:#tn=                1.22.4.1.2>
            1.22.4.2 product support workshop <URL:#tn=            1.22.4.2 product support workshop>
                1.22.4.2.1 task, https://jira.tools.sap/browse/EUXTEAMSAAR-2969 <URL:#tn=                1.22.4.2.1 task, https://jira.tools.sap/browse/EUXTEAMSAAR-2969>
                1.22.4.2.2 <URL:#tn=                1.22.4.2.2>
            1.22.4.3 changing the current structure of workspace / workpage <URL:#tn=            1.22.4.3 changing the current structure of workspace / workpage>
                1.22.4.3.1 BLIs <URL:#tn=                1.22.4.3.1 BLIs>
                1.22.4.3.2 <URL:#tn=                1.22.4.3.2>
            1.22.4.4 Monitor features with Dynatrace. <URL:#tn=            1.22.4.4 Monitor features with Dynatrace.>
            1.22.4.5 Jawad architecture track <URL:#tn=            1.22.4.5 Jawad architecture track>
                1.22.4.5.1 PG encryption <URL:#tn=                1.22.4.5.1 PG encryption>
                1.22.4.5.3 get site entities <URL:#tn=                1.22.4.5.3 get site entities>
            1.22.4.6  role ID special characters BLIs <URL:#tn=            1.22.4.6  role ID special characters BLIs>
            1.22.4.7 Subject: [SRE] Removing dependency in HTML5 Repository <URL:#tn=            1.22.4.7 Subject: [SRE] Removing dependency in HTML5 Repository>
            1.22.4.8 PG benchmark <URL:#tn=            1.22.4.8 PG benchmark>
                1.22.4.5.4 <URL:#tn=                1.22.4.5.4>
            1.22.4.6  Node 16 upgrade - Sheli <URL:#tn=            1.22.4.6  Node 16 upgrade - Sheli>
            1.22.4.7 <URL:#tn=            1.22.4.7>
        1.22.5  T05 <URL:#tn=        1.22.5  T05>
            1.22.5.1  EUXTEAMSAAR-2940 Apollo: support FDC enhancement for search only return sap.app/type is application or card <URL:#tn=            1.22.5.1  EUXTEAMSAAR-2940 Apollo: support FDC enhancement for search only return sap.app/type is application or card>
            1.22.5.2 EUXTEAMSAAR-2984 Role ID special characters in launchpad service- implementation <URL:#tn=            1.22.5.2 EUXTEAMSAAR-2984 Role ID special characters in launchpad service- implementation>
            1.22.5.3 Tal-Haviv EUXTEAMNILI-5895 - [SRE] Load runtime site with minimal dependencies-Destination service <URL:#tn=            1.22.5.3 Tal-Haviv EUXTEAMNILI-5895 - [SRE] Load runtime site with minimal dependencies-Destination service>
            1.22.5.4 EUXTEAMSAAR-2991 [ENG] Design.  Improvement to cdm-store tables <URL:#tn=            1.22.5.4 EUXTEAMSAAR-2991 [ENG] Design.  Improvement to cdm-store tables>
            1.22.5.5 <URL:#tn=            1.22.5.5>
        1.22.6  T06 <URL:#tn=        1.22.6  T06>
            1.22.6.1 tags: Ariel-Tamam new architecture <URL:#tn=            1.22.6.1 tags: Ariel-Tamam new architecture>
            1.22.6.2 tags: Multiple URL-Templates per Business-App <URL:#tn=            1.22.6.2 tags: Multiple URL-Templates per Business-App>
                1.22.6.2.1 readme.md <URL:#tn=                1.22.6.2.1 readme.md>
                1.22.6.2.2 <URL:#tn=                1.22.6.2.2>
            1.22.6.3 Signoff <URL:#tn=            1.22.6.3 Signoff>
            1.22.6.4 Extend Role-Mapping to support Derived/Composite Roles <URL:#tn=            1.22.6.4 Extend Role-Mapping to support Derived/Composite Roles>
            1.22.6.5 [Mass content ] graphQL Mesh support - research - https://jira.tools.sap/browse/EUXTEAMSAAR-3017 <URL:#tn=            1.22.6.5 [Mass content ] graphQL Mesh support - research - https://jira.tools.sap/browse/EUXTEAMSAAR-3017>
            1.22.6.6 Extend CDM store API to search for apps which are not URL template nativeiOS or NativeAndroid <URL:#tn=            1.22.6.6 Extend CDM store API to search for apps which are not URL template nativeiOS or NativeAndroid>
            1.22.6.7 Role ID special characters - additional characters newely supported by XSUAA <URL:#tn=            1.22.6.7 Role ID special characters - additional characters newely supported by XSUAA>
            1.22.6.8 Private Key Rotation Test Scope QA Week <URL:#tn=            1.22.6.8 Private Key Rotation Test Scope QA Week>
                1.22.6.8.1 email-thread <URL:#tn=                1.22.6.8.1 email-thread>
                1.22.6.8.2 <URL:#tn=                1.22.6.8.2>
            1.22.6.9 <URL:#tn=            1.22.6.9>
        1.22.7  T07 <URL:#tn=        1.22.7  T07>
            1.22.7.1   multiple URL-templates <URL:#tn=            1.22.7.1   multiple URL-templates>
            1.22.7.2 golang <URL:#tn=            1.22.7.2 golang>
            1.22.7.3 CEP new experience <URL:#tn=            1.22.7.3 CEP new experience>
            1.22.7.4 DTS refactoring <URL:#tn=            1.22.7.4 DTS refactoring>
            1.22.7.5 signoff <URL:#tn=            1.22.7.5 signoff>
            1.22.7.6 reduce disk space <URL:#tn=            1.22.7.6 reduce disk space>
            1.22.7.7 EUXTEAMSAAR-3055 Role ID special characters - additional characters newely supported by XSUAA - the schema changes <URL:#tn=            1.22.7.7 EUXTEAMSAAR-3055 Role ID special characters - additional characters newely supported by XSUAA - the schema changes>
        1.22.8  T08 <URL:#tn=        1.22.8  T08>
            1.22.8.1  Other teams <URL:#tn=            1.22.8.1  Other teams>
                1.22.8.1.1  [CEP] New activation service- Error handling (https://jira.tools.sap/browse/EUXTEAMNILI-5598) <URL:#tn=                1.22.8.1.1  [CEP] New activation service- Error handling (https://jira.tools.sap/browse/EUXTEAMNILI-5598)>
                1.22.8.1.2 timestamps Immanuel <URL:#tn=                1.22.8.1.2 timestamps Immanuel>
                1.22.8.1.3   Content Package E2E Flows <URL:#tn=                1.22.8.1.3   Content Package E2E Flows>
                1.22.8.1.4 content-manager react <URL:#tn=                1.22.8.1.4 content-manager react>
                1.22.8.1.5 <URL:#tn=                1.22.8.1.5>
            1.22.8.2 our team <URL:#tn=            1.22.8.2 our team>
                1.22.8.2.1 EUXTEAMSAAR-3038 [CEP] Multiple URL Templates for business app - CDM Store/Transport Service <URL:#tn=                1.22.8.2.1 EUXTEAMSAAR-3038 [CEP] Multiple URL Templates for business app - CDM Store/Transport Service>
                1.22.8.2.2 Role ID special characters - additional characters newely supported by XSUAA - the schema changes <URL:#tn=                1.22.8.2.2 Role ID special characters - additional characters newely supported by XSUAA - the schema changes>
                1.22.8.2.3 DTS refactoring <URL:#tn=                1.22.8.2.3 DTS refactoring>
                1.22.8.2.4 [CEP] Import local Spaces and WorkPages - implementation, tags: Import local Spaces and WorkPages gil guide <URL:#tn=                1.22.8.2.4 [CEP] Import local Spaces and WorkPages - implementation, tags: Import local Spaces and WorkPages gil guide>
                    1.22.8.2.4.1 BLI https://jira.tools.sap/browse/EUXTEAMSAAR-3075 <URL:#tn=                    1.22.8.2.4.1 BLI https://jira.tools.sap/browse/EUXTEAMSAAR-3075>
                    1.22.8.2.4.2 Import spaces and workpages guide <URL:#tn=                    1.22.8.2.4.2 Import spaces and workpages guide>
                    1.22.8.2.4.3 Test-Scope <URL:#tn=                    1.22.8.2.4.3 Test-Scope>
                    1.22.8.2.4.4 <URL:#tn=                    1.22.8.2.4.4>
                1.22.8.2.5 Update minimum UI5 version supported for launchpad module <URL:#tn=                1.22.8.2.5 Update minimum UI5 version supported for launchpad module>
                1.22.8.2.6 [CEP]: CDM Store – add "timestamp" attribute to all events <URL:#tn=                1.22.8.2.6 [CEP]: CDM Store – add "timestamp" attribute to all events>
                1.22.8.2.7 <URL:#tn=                1.22.8.2.7>
            1.22.8.3 <URL:#tn=            1.22.8.3>
        1.22.9 2022 T09 <URL:#tn=        1.22.9 2022 T09>
            1.22.9.1 Signoff <URL:#tn=            1.22.9.1 Signoff>
            1.22.9.2 team BLIs <URL:#tn=            1.22.9.2 team BLIs>
                1.22.9.2.1 CEP tasks <URL:#tn=                1.22.9.2.1 CEP tasks>
                    1.22.9.2.1.1 29/08/22 14:10:35 <URL:#tn=                    1.22.9.2.1.1 29/08/22 14:10:35>
                1.22.9.2.2 [CEP]: CDM Store – add "timestamp" attribute to all events <URL:#tn=                1.22.9.2.2 [CEP]: CDM Store – add "timestamp" attribute to all events>
                    1.22.9.2.2.1 RC_CANDI fix for Duplicate html5 provider <URL:#tn=                    1.22.9.2.2.1 RC_CANDI fix for Duplicate html5 provider>
                        1.22.9.2.2.1.1 actual RC_CANDI <URL:#tn=                        1.22.9.2.2.1.1 actual RC_CANDI>
                        1.22.9.2.2.1.2 Leftovers UT+IT <URL:#tn=                        1.22.9.2.2.1.2 Leftovers UT+IT>
                        1.22.9.2.2.1.3 <URL:#tn=                        1.22.9.2.2.1.3>
                    1.22.9.2.2.2 <URL:#tn=                    1.22.9.2.2.2>
                1.22.9.2.3 <URL:#tn=                1.22.9.2.3>
            1.22.9.3 non team BLIs <URL:#tn=            1.22.9.3 non team BLIs>
                1.22.9.3.1 tenant separation, role collections issue, frosta, novartis <URL:#tn=                1.22.9.3.1 tenant separation, role collections issue, frosta, novartis>
                    1.22.9.3.1.1 issue summary <URL:#tn=                    1.22.9.3.1.1 issue summary>
                    1.22.9.3.1.2 <URL:#tn=                    1.22.9.3.1.2>
                1.22.9.3.2 upgrading approuter to version 11.4.0 <URL:#tn=                1.22.9.3.2 upgrading approuter to version 11.4.0>
            1.22.9.4 Sprint reviews <URL:#tn=            1.22.9.4 Sprint reviews>
                1.22.9.4.1 2022 9a <URL:#tn=                1.22.9.4.1 2022 9a>
                1.22.9.4.2 2022 9b <URL:#tn=                1.22.9.4.2 2022 9b>
            1.22.9.5 <URL:#tn=            1.22.9.5>
        1.22.10 T10 <URL:#tn=        1.22.10 T10>
            1.22.10.1 [CEP] Implement materialized view for paginated search - Design <URL:#tn=            1.22.10.1 [CEP] Implement materialized view for paginated search - Design>
            1.22.10.2 <URL:#tn=            1.22.10.2>
        1.22.11 T11 <URL:#tn=        1.22.11 T11>
            1.22.11.1 signoff <URL:#tn=            1.22.11.1 signoff>
            1.22.11.2 <URL:#tn=            1.22.11.2>
        1.22.12 T12 <URL:#tn=        1.22.12 T12>
            1.22.12.1  Signoff <URL:#tn=            1.22.12.1  Signoff>
            1.22.12.2 [CEP] CDM store consume events from RT services <URL:#tn=            1.22.12.2 [CEP] CDM store consume events from RT services>
            1.22.12.3 <URL:#tn=            1.22.12.3>
        1.22.13 T13 <URL:#tn=        1.22.13 T13>
            1.22.13.1 CEP] CDM store consume events from RT services <URL:#tn=            1.22.13.1 CEP] CDM store consume events from RT services>
            1.22.13.2 rebranding launchpad ( 12/1) - API hub , links <URL:#tn=            1.22.13.2 rebranding launchpad ( 12/1) - API hub , links>
            1.22.13.3 Cred store E2E validation <URL:#tn=            1.22.13.3 Cred store E2E validation>
            1.22.13.4 [CEP] Support for custom domain based on IAS - Validation 	, tags: Support for custom domain based on IAS validation manual <URL:#tn=            1.22.13.4 [CEP] Support for custom domain based on IAS - Validation 	, tags: Support for custom domain based on IAS validation manual>
            1.22.13.5 [CEP] Enable content package update <URL:#tn=            1.22.13.5 [CEP] Enable content package update>
            1.22.13.6 Setting up a custom domain on SAP Build Work Zone, standard edition - KT <URL:#tn=            1.22.13.6 Setting up a custom domain on SAP Build Work Zone, standard edition - KT>
            1.22.13.7 <URL:#tn=            1.22.13.7>
        1.22.14 <URL:#tn=        1.22.14>
    1.23 2023 , year of CEP, workzone standard and advanced editions, tags: 2023, CEP <URL:#tn=    1.23 2023 , year of CEP, workzone standard and advanced editions, tags: 2023, CEP>
        1.23.1    Takt01 , T01 <URL:#tn=        1.23.1    Takt01 , T01>
            1.23.1.1    signoff <URL:#tn=            1.23.1.1    signoff>
            1.23.1.2 [CEP] Support for custom domain based on IAS <URL:#tn=            1.23.1.2 [CEP] Support for custom domain based on IAS>
            1.23.1.3 Admin UI - API to fetch snapshot and cherrypick entities for content explorer <URL:#tn=            1.23.1.3 Admin UI - API to fetch snapshot and cherrypick entities for content explorer>
            1.23.1.4 bugs <URL:#tn=            1.23.1.4 bugs>
                1.23.1.4.1 https://jira.tools.sap/browse/DWPBUGS-3173, New content manager table do not show updates if description has more then 1 line <URL:#tn=                1.23.1.4.1 https://jira.tools.sap/browse/DWPBUGS-3173, New content manager table do not show updates if description has more then 1 line>
                1.23.1.4.2 https://jira.tools.sap/browse/DWPBUGS-3032?filter=259181, HTML5 app isn't part of CDM RT API V1 <URL:#tn=                1.23.1.4.2 https://jira.tools.sap/browse/DWPBUGS-3032?filter=259181, HTML5 app isn't part of CDM RT API V1>
                1.23.1.4.3 <URL:#tn=                1.23.1.4.3>
            1.23.1.5 <URL:#tn=            1.23.1.5>
        1.23.2    Takt02 , T02 <URL:#tn=        1.23.2    Takt02 , T02>
            1.23.2.1    Sign-off <URL:#tn=            1.23.2.1    Sign-off>
            1.23.2.2 [CEP] Enable content package update <URL:#tn=            1.23.2.2 [CEP] Enable content package update>
            1.23.2.3 [Eng] Node 16/18 Update <URL:#tn=            1.23.2.3 [Eng] Node 16/18 Update>
            1.23.2.4 [CEP]Stable and Unique IDs for Elements of Work Pages <URL:#tn=            1.23.2.4 [CEP]Stable and Unique IDs for Elements of Work Pages>
            1.23.2.5 [CEP] content package automations <URL:#tn=            1.23.2.5 [CEP] content package automations>
            1.23.2.6 <URL:#tn=            1.23.2.6>
            1.23.2.7 cross-effort <URL:#tn=            1.23.2.7 cross-effort>
            1.23.2.8 <URL:#tn=            1.23.2.8>
        1.23.3    Takt03 , T03 <URL:#tn=        1.23.3    Takt03 , T03>
            1.23.3.1     QA day content package update <URL:#tn=            1.23.3.1     QA day content package update>
            1.23.3.2 Configurations HL Overview & Design. <URL:#tn=            1.23.3.2 Configurations HL Overview & Design.>
            1.23.3.3 others <URL:#tn=            1.23.3.3 others>
                1.23.3.3.1 autovacuum_vacuum_scale_factor <URL:#tn=                1.23.3.3.1 autovacuum_vacuum_scale_factor>
                1.23.3.3.2 <URL:#tn=                1.23.3.3.2>
            1.23.3.4 <URL:#tn=            1.23.3.4>
        1.23.4    Takt04 , T04 <URL:#tn=        1.23.4    Takt04 , T04>
            1.23.4.1    Sign-off <URL:#tn=            1.23.4.1    Sign-off>
            1.23.4.2 Security issues - Whitesource vulnerabilities - phosphor <URL:#tn=            1.23.4.2 Security issues - Whitesource vulnerabilities - phosphor>
            1.23.4.3 Preparation  for security validation <URL:#tn=            1.23.4.3 Preparation  for security validation>
            1.23.4.4 content package automations <URL:#tn=            1.23.4.4 content package automations>
                1.23.4.4.1 wiki <URL:#tn=                1.23.4.4.1 wiki>
                1.23.4.4.2 <URL:#tn=                1.23.4.4.2>
            1.23.4.5 Consume HTML5 applications from multiple subaccounts <URL:#tn=            1.23.4.5 Consume HTML5 applications from multiple subaccounts>
            1.23.4.6 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Design <URL:#tn=            1.23.4.6 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Design>
            1.23.4.7 BETA feature toggle ennablement with a roster between the on-duty of the different teams, tags: CEP beta feature toggle sap start standard <URL:#tn=            1.23.4.7 BETA feature toggle ennablement with a roster between the on-duty of the different teams, tags: CEP beta feature toggle sap start standard>
            1.23.4.8 <URL:#tn=            1.23.4.8>
        1.23.5    Takt05 , T05 <URL:#tn=        1.23.5    Takt05 , T05>
            1.23.5.1    Sign-off <URL:#tn=            1.23.5.1    Sign-off>
            1.23.5.2 Leftover Automation - add jobs to Jenkins jobs and dashboard <URL:#tn=            1.23.5.2 Leftover Automation - add jobs to Jenkins jobs and dashboard>
            1.23.5.3 Import/Transport services - Add Malware Scans <URL:#tn=            1.23.5.3 Import/Transport services - Add Malware Scans>
            1.23.5.4 Secval preparation <URL:#tn=            1.23.5.4 Secval preparation>
            1.23.5.5 Support CMK and PGB in CDM store - Design  , tags: Support CMK and PGB in CDM store - Design <URL:#tn=            1.23.5.5 Support CMK and PGB in CDM store - Design  , tags: Support CMK and PGB in CDM store - Design>
            1.23.5.6 Support Object store CMK in Node JS services <URL:#tn=            1.23.5.6 Support Object store CMK in Node JS services>
            1.23.5.7 Setup Automation - Automatic Assignment of Provider roles to Site - design <URL:#tn=            1.23.5.7 Setup Automation - Automatic Assignment of Provider roles to Site - design>
            1.23.5.8 Support CMK and PGB in CDM store - Imp <URL:#tn=            1.23.5.8 Support CMK and PGB in CDM store - Imp>
            1.23.5.9 CDM schema -  change  "path" as mandatory property in the indicatorDataSource <URL:#tn=            1.23.5.9 CDM schema -  change  "path" as mandatory property in the indicatorDataSource>
            1.23.5.10 Add deleted role to the report chunk for CDM store <URL:#tn=            1.23.5.10 Add deleted role to the report chunk for CDM store>
            1.23.5.11 [CEP] trigger activation on a subaccount level - design <URL:#tn=            1.23.5.11 [CEP] trigger activation on a subaccount level - design>
            1.23.5.12 Support CMK for apple in object store <URL:#tn=            1.23.5.12 Support CMK for apple in object store>
            1.23.5.13 <URL:#tn=            1.23.5.13>
        1.23.6    Takt06 , T06 <URL:#tn=        1.23.6    Takt06 , T06>
            1.23.6.1    Sign-off <URL:#tn=            1.23.6.1    Sign-off>
            1.23.6.2  CDM store Service to support Data termination Process on Unsubscribe Total <URL:#tn=            1.23.6.2  CDM store Service to support Data termination Process on Unsubscribe Total>
            1.23.6.3  E2E validation before GA <URL:#tn=            1.23.6.3  E2E validation before GA>
            1.23.6.4  Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start, tags: Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start <URL:#tn=            1.23.6.4  Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start, tags: Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start>
            1.23.6.5  [CEP] performant APIs for CEP-activation <URL:#tn=            1.23.6.5  [CEP] performant APIs for CEP-activation>
            1.23.6.6  CDM-Store breaks eventual consistency <URL:#tn=            1.23.6.6  CDM-Store breaks eventual consistency>
            1.23.6.7  Support CMK and PGB in CDM store <URL:#tn=            1.23.6.7  Support CMK and PGB in CDM store>
            1.23.6.8  Support Object store CMK in Node JS services <URL:#tn=            1.23.6.8  Support Object store CMK in Node JS services>
            1.23.6.9 Sap-Start Setup Automation: Support Auto sync callback URL for content package creation from store <URL:#tn=            1.23.6.9 Sap-Start Setup Automation: Support Auto sync callback URL for content package creation from store>
            1.23.6.10 import agents, tags: import agents <URL:#tn=            1.23.6.10 import agents, tags: import agents>
            1.23.6.11 <URL:#tn=            1.23.6.11>
        1.23.7    Takt07 , T07 , tags: 2023 T07 takt07 <URL:#tn=        1.23.7    Takt07 , T07 , tags: 2023 T07 takt07>
            1.23.7.1    Signoff <URL:#tn=            1.23.7.1    Signoff>
            1.23.7.2 Team BLIs <URL:#tn=            1.23.7.2 Team BLIs>
                1.23.7.2.1 Support CMK For Apple in CDM store <URL:#tn=                1.23.7.2.1 Support CMK For Apple in CDM store>
                1.23.7.2.2 Support CMK for Apple in Node JS services <URL:#tn=                1.23.7.2.2 Support CMK for Apple in Node JS services>
                1.23.7.2.3 [O&S 3-8]write an Audit Log event when the export happens <URL:#tn=                1.23.7.2.3 [O&S 3-8]write an Audit Log event when the export happens>
                1.23.7.2.4 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 32 SOFT <URL:#tn=                1.23.7.2.4 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 32 SOFT>
            1.23.7.3 external contribution, tags: external contribution <URL:#tn=            1.23.7.3 external contribution, tags: external contribution>
                1.23.7.3.1 FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko , tags: FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko first code contribution <URL:#tn=                1.23.7.3.1 FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko , tags: FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko first code contribution>
            1.23.7.4 Other teams <URL:#tn=            1.23.7.4 Other teams>
                1.23.7.4.1  CEP Activation optimize classic homepage <URL:#tn=                1.23.7.4.1  CEP Activation optimize classic homepage>
                1.23.7.4.2 <URL:#tn=                1.23.7.4.2>
            1.23.7.5 <URL:#tn=            1.23.7.5>
        1.23.8    Takt08 , T08 <URL:#tn=        1.23.8    Takt08 , T08>
            1.23.8.1     sign-off <URL:#tn=            1.23.8.1     sign-off>
            1.23.8.2 [Performance] CDM on event <URL:#tn=            1.23.8.2 [Performance] CDM on event>
            1.23.8.3 Setup Automation - Support Automatic Assignment of Provider roles to Sites <URL:#tn=            1.23.8.3 Setup Automation - Support Automatic Assignment of Provider roles to Sites>
            1.23.8.4 Support CMK For Apple in CDM store <URL:#tn=            1.23.8.4 Support CMK For Apple in CDM store>
            1.23.8.5 other teams <URL:#tn=            1.23.8.5 other teams>
                1.23.8.5.1 reuven-kandov Design Nili's team CMK: Node Changes - Phase 1 -> Object store support <URL:#tn=                1.23.8.5.1 reuven-kandov Design Nili's team CMK: Node Changes - Phase 1 -> Object store support>
                1.23.8.5.2 Daniel-Turin, Alma-Shalom: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+SAP+Start%3A+Administration+Capabilities <URL:#tn=                1.23.8.5.2 Daniel-Turin, Alma-Shalom: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+SAP+Start%3A+Administration+Capabilities>
2.4.  Disable subaccount settings capabilities by plan <URL:#tn=2.4.  Disable subaccount settings capabilities by plan>
            1.23.8.6 [CMK] Embedded Content Providers handling - Test Scope <URL:#tn=            1.23.8.6 [CMK] Embedded Content Providers handling - Test Scope>
            1.23.8.7 Support CMK for Apple in Node JS services <URL:#tn=            1.23.8.7 Support CMK for Apple in Node JS services>
            1.23.8.8 <URL:#tn=            1.23.8.8>
        1.23.9    Takt09 , T09 , tags: Takt09 , T09 <URL:#tn=        1.23.9    Takt09 , T09 , tags: Takt09 , T09>
            1.23.9.1    sign-off <URL:#tn=            1.23.9.1    sign-off>
            1.23.9.2 CMK E2E validations, <URL:#tn=            1.23.9.2 CMK E2E validations,>
            1.23.9.3 Delete space  provider fail issue <URL:#tn=            1.23.9.3 Delete space  provider fail issue>
            1.23.9.4 bind WZ AR to Mock workflow service LTS eu10 <URL:#tn=            1.23.9.4 bind WZ AR to Mock workflow service LTS eu10>
            1.23.9.5 Redis cleanup <URL:#tn=            1.23.9.5 Redis cleanup>
            1.23.9.6 [Security] Upgrade Ajv to newest version (cdm-schema) <URL:#tn=            1.23.9.6 [Security] Upgrade Ajv to newest version (cdm-schema)>
            1.23.9.7 CMK E2E validation <URL:#tn=            1.23.9.7 CMK E2E validation>
            1.23.9.8 other teams <URL:#tn=            1.23.9.8 other teams>
                1.23.9.8.1 Support WZ provisioning for CMK customers <URL:#tn=                1.23.9.8.1 Support WZ provisioning for CMK customers>
                1.23.9.8.2 <URL:#tn=                1.23.9.8.2>
            1.23.9.9 CMK for apple  in Node JS services – Automation <URL:#tn=            1.23.9.9 CMK for apple  in Node JS services – Automation>
            1.23.9.10 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp <URL:#tn=            1.23.9.10 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp>
            1.23.9.11 Delete space / provider fail issue <URL:#tn=            1.23.9.11 Delete space / provider fail issue>
            1.23.9.12 Subaccount activation from CDM store - Design <URL:#tn=            1.23.9.12 Subaccount activation from CDM store - Design>
        1.23.10   Takt10, T10 <URL:#tn=        1.23.10   Takt10, T10>
            1.23.10.1 Subaccount activation from CDM store  - design <URL:#tn=            1.23.10.1 Subaccount activation from CDM store  - design>
            1.23.10.2 related: MQ related issues, tags:  MQ related issues , solace, eventual consistency, race condition <URL:#tn=            1.23.10.2 related: MQ related issues, tags:  MQ related issues , solace, eventual consistency, race condition>
            1.23.10.3 Table partitioning poc <URL:#tn=            1.23.10.3 Table partitioning poc>
            1.23.10.4 Odata compliance:  deleted entity in a delta payload - 1PD  - <URL:#tn=            1.23.10.4 Odata compliance:  deleted entity in a delta payload - 1PD  ->
            1.23.10.5 E2E automation suites switch to ng-router <URL:#tn=            1.23.10.5 E2E automation suites switch to ng-router>
            1.23.10.6 Security validations prep&demo <URL:#tn=            1.23.10.6 Security validations prep&demo>
            1.23.10.7 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp <URL:#tn=            1.23.10.7 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp>
            1.23.10.8 [security] Upgrade JAVA version and Spring Boot 3 <URL:#tn=            1.23.10.8 [security] Upgrade JAVA version and Spring Boot 3>
            1.23.10.9 Setup Automation - Terminate the provider to site association removes the role assignment <URL:#tn=            1.23.10.9 Setup Automation - Terminate the provider to site association removes the role assignment>
            1.23.10.10 [CEP] Support export / import - Enable Transport Agents - design <URL:#tn=            1.23.10.10 [CEP] Support export / import - Enable Transport Agents - design>
            1.23.10.11 Subaccount activation from CDM store - IMP <URL:#tn=            1.23.10.11 Subaccount activation from CDM store - IMP>
            1.23.10.12 other teams <URL:#tn=            1.23.10.12 other teams>
                1.23.10.12.1 [DR] [CEP] Content API - Support Filtering visualizations (Launchtype, Devicetype) <URL:#tn=                1.23.10.12.1 [DR] [CEP] Content API - Support Filtering visualizations (Launchtype, Devicetype)>
            1.23.10.13 <URL:#tn=            1.23.10.13>
        1.23.11   Takt11, T11 <URL:#tn=        1.23.11   Takt11, T11>
            1.23.11.1    Planning <URL:#tn=            1.23.11.1    Planning>
            1.23.11.2 Disk storage near maximum - start with checking cost for increasing quota <URL:#tn=            1.23.11.2 Disk storage near maximum - start with checking cost for increasing quota>
            1.23.11.3 hotfix  Customer is not able to sync his content provider due to http request timeout. <URL:#tn=            1.23.11.3 hotfix  Customer is not able to sync his content provider due to http request timeout.>
            1.23.11.4 CDM store deadlock issue <URL:#tn=            1.23.11.4 CDM store deadlock issue>
            1.23.11.5 Table partitioning poc <URL:#tn=            1.23.11.5 Table partitioning poc>
            1.23.11.6 [CEP] Support export / import - Enable Transport Agents - design <URL:#tn=            1.23.11.6 [CEP] Support export / import - Enable Transport Agents - design>
            1.23.11.7 Add deleted role to the report chunk for CDM store <URL:#tn=            1.23.11.7 Add deleted role to the report chunk for CDM store>
            1.23.11.8 Setup Automation - Terminate the provider to site association removes the role assignment <URL:#tn=            1.23.11.8 Setup Automation - Terminate the provider to site association removes the role assignment>
            1.23.11.9 Extent the API in Provisioning service to return the Tenant id <URL:#tn=            1.23.11.9 Extent the API in Provisioning service to return the Tenant id>
            1.23.11.10 [Sap Start] support Private key rotation for  content package - CDM store <URL:#tn=            1.23.11.10 [Sap Start] support Private key rotation for  content package - CDM store>
            1.23.11.11 <URL:#tn=            1.23.11.11>
        1.23.12   2023 Takt12 T12, tags: 2023 Takt12 T12 <URL:#tn=        1.23.12   2023 Takt12 T12, tags: 2023 Takt12 T12>
            1.23.12.0 sign-off <URL:#tn=            1.23.12.0 sign-off>
            1.23.12.1   x509 compliance - Connection to External Services Using x509 Audit-Log-service oauth2 <URL:#tn=            1.23.12.1   x509 compliance - Connection to External Services Using x509 Audit-Log-service oauth2>
            1.23.12.2 Store CMK resilience  -cron jobs <URL:#tn=            1.23.12.2 Store CMK resilience  -cron jobs>
            1.23.12.3 [CEP] Implement agent orchestration - export <URL:#tn=            1.23.12.3 [CEP] Implement agent orchestration - export>
            1.23.12.4 [CEP] Implement agent orchestration - import <URL:#tn=            1.23.12.4 [CEP] Implement agent orchestration - import>
            1.23.12.5 Subaccount activation from CDM store <URL:#tn=            1.23.12.5 Subaccount activation from CDM store>
            1.23.12.6 Fix recent report related issues - fixing a bug <URL:#tn=            1.23.12.6 Fix recent report related issues - fixing a bug>
            1.23.12.7 Multiple TENANT_HOST_PATTERN for SDM <URL:#tn=            1.23.12.7 Multiple TENANT_HOST_PATTERN for SDM>
            1.23.12.8 <URL:#tn=            1.23.12.8>
        1.23.13   Takt13, T13, tags: Takt13, T13 <URL:#tn=        1.23.13   Takt13, T13, tags: Takt13, T13>
            1.23.13.1  sign-off <URL:#tn=            1.23.13.1  sign-off>
            1.23.13.2 external teams designs and BLIs <URL:#tn=            1.23.13.2 external teams designs and BLIs>
                1.23.13.2.1 STD-NG approuter and super common domain support, tags: STD-NG approuter and super common domain support <URL:#tn=                1.23.13.2.1 STD-NG approuter and super common domain support, tags: STD-NG approuter and super common domain support>
                1.23.13.2.2 export import agents - Liraz <URL:#tn=                1.23.13.2.2 export import agents - Liraz>
                1.23.13.2.3 <URL:#tn=                1.23.13.2.3>
            1.23.13.3 Fix recent report related issues <URL:#tn=            1.23.13.3 Fix recent report related issues>
            1.23.13.4 Workzone Postgres DB - impact of unavailability <URL:#tn=            1.23.13.4 Workzone Postgres DB - impact of unavailability>
            1.23.13.5 [Security] cls-hooked <URL:#tn=            1.23.13.5 [Security] cls-hooked>
            1.23.13.6 Subaccount activation from CDM store  , tags: activation from CDM store <URL:#tn=            1.23.13.6 Subaccount activation from CDM store  , tags: activation from CDM store>
                1.23.13.6.1 CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli , tags: SAA sub-account-activation CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli <URL:#tn=                1.23.13.6.1 CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli , tags: SAA sub-account-activation CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli>
                1.23.13.6.2 <URL:#tn=                1.23.13.6.2>
            1.23.13.7 <URL:#tn=            1.23.13.7>
        1.23.14 <URL:#tn=        1.23.14>
            1.23.13.2 <URL:#tn=            1.23.13.2>
        1.23.14 <URL:#tn=        1.23.14>
    1.24 2024, tags: 2024 <URL:#tn=    1.24 2024, tags: 2024>
        1.24.1    Takt01 , T01 , tags: Takt01 <URL:#tn=        1.24.1    Takt01 , T01 , tags: Takt01>
            1.24.1.1    signoff <URL:#tn=            1.24.1.1    signoff>
            1.24.1.2 NG approuter E2E validation and automation <URL:#tn=            1.24.1.2 NG approuter E2E validation and automation>
            1.24.1.3 [DevOps] review env vars <URL:#tn=            1.24.1.3 [DevOps] review env vars>
            1.24.1.4 Subaccount activation from CDM store - migration execution <URL:#tn=            1.24.1.4 Subaccount activation from CDM store - migration execution>
            1.24.1.5 [Security] Connection to External Services Using x509 <URL:#tn=            1.24.1.5 [Security] Connection to External Services Using x509>
            1.24.1.6 Destination Mapping for Cards - support search of card aliases <URL:#tn=            1.24.1.6 Destination Mapping for Cards - support search of card aliases>
            1.24.1.7 [CEP] Implement agent orchestration - export <URL:#tn=            1.24.1.7 [CEP] Implement agent orchestration - export>
            1.24.1.8 [CEP] Implement agent orchestration - import <URL:#tn=            1.24.1.8 [CEP] Implement agent orchestration - import>
            1.24.1.9 Other teams BLIs <URL:#tn=            1.24.1.9 Other teams BLIs>
                1.24.1.9.1 [CF] Consolidate get dependencies logic to one service (remove from App router) - Design <URL:#tn=                1.24.1.9.1 [CF] Consolidate get dependencies logic to one service (remove from App router) - Design>
                1.24.1.9.2 [ANS Notification] Support multiple mobile instances <URL:#tn=                1.24.1.9.2 [ANS Notification] Support multiple mobile instances>
                1.24.1.9.3 <URL:#tn=                1.24.1.9.3>
            1.24.1.10 <URL:#tn=            1.24.1.10>
        1.24.2    Takt02 , T02 <URL:#tn=        1.24.2    Takt02 , T02>
            1.24.2.1    external teams <URL:#tn=            1.24.2.1    external teams>
                1.24.2.1.1    NG router-replace XSUAA sample go library - Design <URL:#tn=                1.24.2.1.1    NG router-replace XSUAA sample go library - Design>
                1.24.2.1.2  Destination Mapping for Cards - Extend CDM portal schema for provider entity <URL:#tn=                1.24.2.1.2  Destination Mapping for Cards - Extend CDM portal schema for provider entity>
                    1.24.2.1.2.1  design <URL:#tn=                    1.24.2.1.2.1  design>
                    1.24.2.1.2.2 <URL:#tn=                    1.24.2.1.2.2>
                1.24.2.1.3 <URL:#tn=                1.24.2.1.3>
            1.24.2.2 <URL:#tn=            1.24.2.2>
            1.24.2.2 signoff <URL:#tn=            1.24.2.2 signoff>
            1.24.2.3 Destination Mapping for Cards - CDM store migration <URL:#tn=            1.24.2.3 Destination Mapping for Cards - CDM store migration>
            1.24.2.4 Sprint review <URL:#tn=            1.24.2.4 Sprint review>
        1.24.3    Takt03 , T03 <URL:#tn=        1.24.3    Takt03 , T03>
            1.24.3.1    Planning <URL:#tn=            1.24.3.1    Planning>
            1.24.3.2 signoff <URL:#tn=            1.24.3.2 signoff>
            1.24.3.3 [SECURITY] Upgrade security-patched-spring-boot-starter in cdm-store service <URL:#tn=            1.24.3.3 [SECURITY] Upgrade security-patched-spring-boot-starter in cdm-store service>
            1.24.3.4 Unique Inbound ID for Federated Applications - Transport <URL:#tn=            1.24.3.4 Unique Inbound ID for Federated Applications - Transport>
            1.24.3.5 Replay Event ( SAA)- Enhance API to support entity type and context <URL:#tn=            1.24.3.5 Replay Event ( SAA)- Enhance API to support entity type and context>
            1.24.3.6 Unique Inbound ID for Federated Applications - HTML5/Apollo <URL:#tn=            1.24.3.6 Unique Inbound ID for Federated Applications - HTML5/Apollo>
            1.24.3.7 CDM store reduce load - code removal <URL:#tn=            1.24.3.7 CDM store reduce load - code removal>
            1.24.3.8 [CEP] Implement agent orchestration - import <URL:#tn=            1.24.3.8 [CEP] Implement agent orchestration - import>
            1.24.3.9 [CEP] Implement agent orchestration - export <URL:#tn=            1.24.3.9 [CEP] Implement agent orchestration - export>
            1.24.3.10 Arburg escalation (internal server error) <URL:#tn=            1.24.3.10 Arburg escalation (internal server error)>
                1.24.3.10.1 email thread <URL:#tn=                1.24.3.10.1 email thread>
                1.24.3.10.2 REDIS perf fixes <URL:#tn=                1.24.3.10.2 REDIS perf fixes>
                1.24.3.10.3 RCA <URL:#tn=                1.24.3.10.3 RCA>
                1.24.3.10.4 <URL:#tn=                1.24.3.10.4>
            1.24.3.11 Planned migrations <URL:#tn=            1.24.3.11 Planned migrations>
            1.24.3.12 WZ Advanced Migration of existing WZ standalone Cards to standalone local Apps <URL:#tn=            1.24.3.12 WZ Advanced Migration of existing WZ standalone Cards to standalone local Apps>
            1.24.3.13 <URL:#tn=            1.24.3.13>
        1.24.4    Takt04 , T04 <URL:#tn=        1.24.4    Takt04 , T04>
            1.24.4.1     signoff <URL:#tn=            1.24.4.1     signoff>
            1.24.4.2  Unique Inbound ID - Migration for existing content (local + federated) <URL:#tn=            1.24.4.2  Unique Inbound ID - Migration for existing content (local + federated)>
            1.24.4.3 [CEP] Implement agent orchestration - import <URL:#tn=            1.24.4.3 [CEP] Implement agent orchestration - import>
            1.24.4.4 [CEP] Implement agent orchestration - export <URL:#tn=            1.24.4.4 [CEP] Implement agent orchestration - export>
            1.24.4.5 CDM store to support filter assignment per vis type <URL:#tn=            1.24.4.5 CDM store to support filter assignment per vis type>
            1.24.4.6 [Golden Path] HTML5 as a Content provider: CDM library logging and schema validation <URL:#tn=            1.24.4.6 [Golden Path] HTML5 as a Content provider: CDM library logging and schema validation>
            1.24.4.7  other teams <URL:#tn=            1.24.4.7  other teams>
                1.24.4.7.1  UPA <URL:#tn=                1.24.4.7.1  UPA>
                    1.24.4.7.1.1  [UPA] Exposure of site via content provider - Design Review <URL:#tn=                    1.24.4.7.1.1  [UPA] Exposure of site via content provider - Design Review>
                    1.24.4.7.1.2 <URL:#tn=                    1.24.4.7.1.2>
                1.24.4.7.2 <URL:#tn=                1.24.4.7.2>
            1.24.4.8 <URL:#tn=            1.24.4.8>
            1.24.4.9 <URL:#tn=            1.24.4.9>
            1.24.4.10 <URL:#tn=            1.24.4.10>
            1.24.4.11 <URL:#tn=            1.24.4.11>
            1.24.4.12 <URL:#tn=            1.24.4.12>
        1.24.5    Takt05 , T05 , tags: 2024 Takt05 <URL:#tn=        1.24.5    Takt05 , T05 , tags: 2024 Takt05>
            1.24.5.1    signoff <URL:#tn=            1.24.5.1    signoff>
            1.24.5.2 SecVal preparation for T05B <URL:#tn=            1.24.5.2 SecVal preparation for T05B>
            1.24.5.3 NG router validation in ADV <URL:#tn=            1.24.5.3 NG router validation in ADV>
            1.24.5.4 Update the cdm-schema with the new extended regex provided in the Lang-code ADR <URL:#tn=            1.24.5.4 Update the cdm-schema with the new extended regex provided in the Lang-code ADR>
            1.24.5.5 Unique Inbound ID - Migration for existing content (local + federated) <URL:#tn=            1.24.5.5 Unique Inbound ID - Migration for existing content (local + federated)>
            1.24.5.6 Schema validation for unknown entity types <URL:#tn=            1.24.5.6 Schema validation for unknown entity types>
            1.24.5.7 CDM store to support filter assignment per vis type <URL:#tn=            1.24.5.7 CDM store to support filter assignment per vis type>
            1.24.5.8 [CEP] Implement agent orchestration <URL:#tn=            1.24.5.8 [CEP] Implement agent orchestration>
            1.24.5.9 [CEP] Implement agent orchestration <URL:#tn=            1.24.5.9 [CEP] Implement agent orchestration>
            1.24.5.10 Update the cdm-schema with the new extended regex provided in the Lang-code ADR <URL:#tn=            1.24.5.10 Update the cdm-schema with the new extended regex provided in the Lang-code ADR>
        1.24.6    Takt06  T06 , tags: Takt06  T06 <URL:#tn=        1.24.6    Takt06  T06 , tags: Takt06  T06>
            1.24.6.1    signoff <URL:#tn=            1.24.6.1    signoff>
            1.24.6.2 <URL:#tn=            1.24.6.2>
        1.24.7    Takt07  T07 , tags: Takt07  T07 <URL:#tn=        1.24.7    Takt07  T07 , tags: Takt07  T07>
            1.24.7.1     signoff <URL:#tn=            1.24.7.1     signoff>
                1.24.7.1.1     email <URL:#tn=                1.24.7.1.1     email>
                1.24.7.1.2 wiki <URL:#tn=                1.24.7.1.2 wiki>
                1.24.7.1.3 Tasks <URL:#tn=                1.24.7.1.3 Tasks>
                    1.24.7.1.3.1 [Task] NG router Validations in ADV 3 PDs A Fried, Yoav 2 [Task] Default VizType - Support Migration <URL:#tn=                    1.24.7.1.3.1 [Task] NG router Validations in ADV 3 PDs A Fried, Yoav 2 [Task] Default VizType - Support Migration>
                    1.24.7.1.3.2 PDs A Cohen, Shirly 3 [Task] Replay Migration not starting on US10 3 PDs A Manshari, Alon Izaq, Yosi <URL:#tn=                    1.24.7.1.3.2 PDs A Cohen, Shirly 3 [Task] Replay Migration not starting on US10 3 PDs A Manshari, Alon Izaq, Yosi>
                    1.24.7.1.3.4 [Task] Security Scans (OSS & SAST) - replace outdated FOSSs in 'cdm.store.service' 2 PDs A/B Stalmakhova, Nataliya (external - Project) <URL:#tn=                    1.24.7.1.3.4 [Task] Security Scans (OSS & SAST) - replace outdated FOSSs in 'cdm.store.service' 2 PDs A/B Stalmakhova, Nataliya (external - Project)>
                    1.24.7.1.3.5 [Task] Unique Inbound ID - Support Migration 2 PDs A/B Cohen, Shirly <URL:#tn=                    1.24.7.1.3.5 [Task] Unique Inbound ID - Support Migration 2 PDs A/B Cohen, Shirly>
                    1.24.7.1.3.6 [Task] Security - Remove secrets from application logs for 'cdm-export-service' 1 PDs A/B Stalmakhova, Nataliya (external - Project) <URL:#tn=                    1.24.7.1.3.6 [Task] Security - Remove secrets from application logs for 'cdm-export-service' 1 PDs A/B Stalmakhova, Nataliya (external - Project)>
                1.24.7.1.4 BLIs <URL:#tn=                1.24.7.1.4 BLIs>
                    1.24.7.1.4.1 [Golden Path] HTML5 as a Content provider: E2E integration and validation 10 PDs A Margieh, Jawad Fried, Yoav <URL:#tn=                    1.24.7.1.4.1 [Golden Path] HTML5 as a Content provider: E2E integration and validation 10 PDs A Margieh, Jawad Fried, Yoav>
                        1.24.7.1.4.1.1  Subject: RE: Please review the HTML5 content provider documentation - updated links <URL:#tn=                        1.24.7.1.4.1.1  Subject: RE: Please review the HTML5 content provider documentation - updated links>
                        1.24.7.1.4.1.2 <URL:#tn=                        1.24.7.1.4.1.2>
                    1.24.7.1.4.2 [CEP] Implement agent orchestration - import 18 PDs A Manshari, Alon Kobi, Hadar <URL:#tn=                    1.24.7.1.4.2 [CEP] Implement agent orchestration - import 18 PDs A Manshari, Alon Kobi, Hadar>
                    1.24.7.1.4.3 [CEP] Support export / import - Implement workpage export logic 2 PD A Labinsky, Kalman <URL:#tn=                    1.24.7.1.4.3 [CEP] Support export / import - Implement workpage export logic 2 PD A Labinsky, Kalman>
                    1.24.7.1.4.4 [CEP] Import/export page and spaces - E2E validation cross teams 13 PDs A+B Labinsky, Kalman <URL:#tn=                    1.24.7.1.4.4 [CEP] Import/export page and spaces - E2E validation cross teams 13 PDs A+B Labinsky, Kalman>
                    1.24.7.1.4.5 Unique Inbound ID - E2E Validation & Testing 8 PDs A+B Cohen, Shirly <URL:#tn=                    1.24.7.1.4.5 Unique Inbound ID - E2E Validation & Testing 8 PDs A+B Cohen, Shirly>
                    1.24.7.1.4.6 [CEP] Support export / import - productisation - Public API for export 4 PDs SOFT Labinsky, Kalman <URL:#tn=                    1.24.7.1.4.6 [CEP] Support export / import - productisation - Public API for export 4 PDs SOFT Labinsky, Kalman>
                        1.24.7.1.4.6.1 Subject: Public API - Portal PR - add support for workpages and pages <URL:#tn=                        1.24.7.1.4.6.1 Subject: Public API - Portal PR - add support for workpages and pages>
                        1.24.7.1.4.6.2 <URL:#tn=                        1.24.7.1.4.6.2>
                1.24.7.1.5 Eng <URL:#tn=                1.24.7.1.5 Eng>
                    1.24.7.1.5.1 [ENG] Skipping siteActivation calculation in the cdm store service during content deployment 10 PDs Capped by 5 PDs allocation for eng SOFT Margieh, Jawad <URL:#tn=                    1.24.7.1.5.1 [ENG] Skipping siteActivation calculation in the cdm store service during content deployment 10 PDs Capped by 5 PDs allocation for eng SOFT Margieh, Jawad>
                    1.24.7.1.5.2 <URL:#tn=                    1.24.7.1.5.2>
                1.24.7.1.6 <URL:#tn=                1.24.7.1.6>
            1.24.7.2 Additional BLIs <URL:#tn=            1.24.7.2 Additional BLIs>
                1.24.7.2.1 Provider site handling errors & messages Design review <URL:#tn=                1.24.7.2.1 Provider site handling errors & messages Design review>
                1.24.7.2.2 <URL:#tn=                1.24.7.2.2>
            1.24.7.3 <URL:#tn=            1.24.7.3>
        1.24.8    Takt08  T08 , tags: Takt08  T08 <URL:#tn=        1.24.8    Takt08  T08 , tags: Takt08  T08>
        1.24.9    Takt09  T09 , tags: Takt09  T09 <URL:#tn=        1.24.9    Takt09  T09 , tags: Takt09  T09>
        1.24.10   Takt10 T10, tags: Takt10 T10 <URL:#tn=        1.24.10   Takt10 T10, tags: Takt10 T10>
        1.24.11   Takt11 T11 <URL:#tn=        1.24.11   Takt11 T11>
        1.24.12   Takt12 T12 <URL:#tn=        1.24.12   Takt12 T12>
        1.24.13   Takt13 T13 <URL:#tn=        1.24.13   Takt13 T13>
    1.25 2025 <URL:#tn=    1.25 2025>
    1.26 <URL:#tn=    1.26>
    1.27 <URL:#tn=    1.27>
    1.28 <URL:#tn=    1.28>
    1.29 <URL:#tn=    1.29>
    1.30 <URL:#tn=    1.30>
    1.31 <URL:#tn=    1.31>
    1.32 <URL:#tn=    1.32>
    1.33 <URL:#tn=    1.33>
    1.34 <URL:#tn=    1.34>
    1.35 <URL:#tn=    1.35>
    1.36 <URL:#tn=    1.36>
    1.37 <URL:#tn=    1.37>
    1.38 <URL:#tn=    1.38>
    1.39 <URL:#tn=    1.39>
    1.40 <URL:#tn=    1.40>
    1.41 <URL:#tn=    1.41>
    1.42 <URL:#tn=    1.42>
    1.43 <URL:#tn=    1.43>
    1.44 <URL:#tn=    1.44>
    1.45 <URL:#tn=    1.45>
    1.46 <URL:#tn=    1.46>
    1.47 <URL:#tn=    1.47>
    1.48 <URL:#tn=    1.48>
    1.49 <URL:#tn=    1.49>
    1.50 <URL:#tn=    1.50>
2. CF, Cloud Foundry <URL:#tn=2. CF, Cloud Foundry>
    2.0 logs, kibana, tags: logs, kibana, CLS, cloud logging service <URL:#tn=    2.0 logs, kibana, tags: logs, kibana, CLS, cloud logging service>
        2.0.1  application logging <URL:#tn=        2.0.1  application logging>
        2.0.2 CLS, cloud logging service, tags: CLS, cloud logging service, <URL:#tn=        2.0.2 CLS, cloud logging service, tags: CLS, cloud logging service,>
        2.0.3 <URL:#tn=        2.0.3>
    2.1 CF CLI tags: CF CLI, command line <URL:#tn=    2.1 CF CLI tags: CF CLI, command line>
        2.1.1 First steps , tags: cf 101, login, api, endpoint <URL:#tn=        2.1.1 First steps , tags: cf 101, login, api, endpoint>
            2.1.1.1 install <URL:#tn=            2.1.1.1 install>
            2.1.1.2 login, api endpoints , tags: login api endpoints <URL:#tn=            2.1.1.2 login, api endpoints , tags: login api endpoints>
                2.1.1.2.1 EU10 canary api <URL:#tn=                2.1.1.2.1 EU10 canary api>
                2.1.1.2.2 EU10 production <URL:#tn=                2.1.1.2.2 EU10 production>
                2.1.1.2.3 US20, US21 <URL:#tn=                2.1.1.2.3 US20, US21>
                2.1.1.2.4 General form API <URL:#tn=                2.1.1.2.4 General form API>
                2.1.1.2.5 EU12 provider accounts endpoints <URL:#tn=                2.1.1.2.5 EU12 provider accounts endpoints>
            2.1.1.3 login <URL:#tn=            2.1.1.3 login>
            2.1.1.4 <URL:#tn=            2.1.1.4>
        2.1.2 manage service-instances <URL:#tn=        2.1.2 manage service-instances>
            2.1.2.1 get list of bound services: cf s <URL:#tn=            2.1.2.1 get list of bound services: cf s>
            2.1.2.2 unbind service: cf us app service <URL:#tn=            2.1.2.2 unbind service: cf us app service>
            2.1.2.3 delete a service: cf ds service <URL:#tn=            2.1.2.3 delete a service: cf ds service>
            2.1.2.4 create service <URL:#tn=            2.1.2.4 create service>
            2.1.2.5 bind service to app <URL:#tn=            2.1.2.5 bind service to app>
            2.1.2.6 restage, reload configuration <URL:#tn=            2.1.2.6 restage, reload configuration>
            2.1.2.7 env, read app config <URL:#tn=            2.1.2.7 env, read app config>
            2.1.2.8 set env <URL:#tn=            2.1.2.8 set env>
                2.1.2.8.1 set log level <URL:#tn=                2.1.2.8.1 set log level>
                2.1.2.8.2 <URL:#tn=                2.1.2.8.2>
            2.1.2.9 manually copy files ssh to container <URL:#tn=            2.1.2.9 manually copy files ssh to container>
            2.1.2.10 restart <URL:#tn=            2.1.2.10 restart>
            2.1.2.11 cf cli check information re. redis service plan and version <URL:#tn=            2.1.2.11 cf cli check information re. redis service plan and version>
            2.1.2.12 <URL:#tn=            2.1.2.12>
        2.1.3 generate oauth-token <URL:#tn=        2.1.3 generate oauth-token>
            2.1.2.11 unbind all apps using a service and then delete it <URL:#tn=            2.1.2.11 unbind all apps using a service and then delete it>
            2.1.2.12 <URL:#tn=            2.1.2.12>
        2.1.4 organizations and spaces <URL:#tn=        2.1.4 organizations and spaces>
            2.1.4.1 get organizations names <URL:#tn=            2.1.4.1 get organizations names>
            2.1.4.2 get organization GUID <URL:#tn=            2.1.4.2 get organization GUID>
            2.1.4.3 get spaces names <URL:#tn=            2.1.4.3 get spaces names>
            2.1.4.4 get space guid <URL:#tn=            2.1.4.4 get space guid>
            2.1.4.5 create space <URL:#tn=            2.1.4.5 create space>
            2.1.4.6 programmatically iterate over spaces in org <URL:#tn=            2.1.4.6 programmatically iterate over spaces in org>
            2.1.4.7 share services <URL:#tn=            2.1.4.7 share services>
                2.1.4.7.1  share services manual <URL:#tn=                2.1.4.7.1  share services manual>
                2.1.4.7.2 share service to space command <URL:#tn=                2.1.4.7.2 share service to space command>
                2.1.4.7.3 <URL:#tn=                2.1.4.7.3>
            2.1.4.8 <URL:#tn=            2.1.4.8>
        2.1.5 read event logs <URL:#tn=        2.1.5 read event logs>
        2.1.6 <URL:#tn=        2.1.6>
    2.2 FAQ <URL:#tn=    2.2 FAQ>
        2.2.1  manifest-dev.yml <URL:#tn=        2.2.1  manifest-dev.yml>
            2.2.1.1  url <URL:#tn=            2.2.1.1  url>
        2.2.2 path attribute, tags: manifest path attribute cf push <URL:#tn=        2.2.2 path attribute, tags: manifest path attribute cf push>
        2.2.3 <URL:#tn=        2.2.3>
    2.3 Push services <URL:#tn=    2.3 Push services>
        2.3.1 java based <URL:#tn=        2.3.1 java based>
            2.3.1.1 push latest version <URL:#tn=            2.3.1.1 push latest version>
        2.3.2 nodejs based <URL:#tn=        2.3.2 nodejs based>
        2.3.3 <URL:#tn=        2.3.3>
    2.4 Remote debug <URL:#tn=    2.4 Remote debug>
        2.4.1 real remote debug <URL:#tn=        2.4.1 real remote debug>
            2.4.1.1 An easy way to debug Node.JS apps in Cloud Foundry <URL:#tn=            2.4.1.1 An easy way to debug Node.JS apps in Cloud Foundry>
            2.4.1.2 my guide for remote debug <URL:#tn=            2.4.1.2 my guide for remote debug>
                2.4.1.2.1 remote debug wiki <URL:#tn=                2.4.1.2.1 remote debug wiki>
                2.4.1.2.2 setup nodejs app <URL:#tn=                2.4.1.2.2 setup nodejs app>
                2.4.1.2.3 remote debug steps <URL:#tn=                2.4.1.2.3 remote debug steps>
            2.4.1.3 possible issues <URL:#tn=            2.4.1.3 possible issues>
        2.4.2 Connect to CF xsa from local machine <URL:#tn=        2.4.2 Connect to CF xsa from local machine>
            2.4.2.1 instructionas in node_modules/@sap/xsenv/README.md <URL:#tn=            2.4.2.1 instructionas in node_modules/@sap/xsenv/README.md>
            2.4.2.2 <URL:#tn=            2.4.2.2>
        2.4.3 Issues <URL:#tn=        2.4.3 Issues>
            2.4.3.1 remote debug your newly concurse created space that SSH fails. <URL:#tn=            2.4.3.1 remote debug your newly concurse created space that SSH fails.>
        2.4.4 <URL:#tn=        2.4.4>
    2.5 cf ssh, tags: cf ssh enable-ssh <URL:#tn=    2.5 cf ssh, tags: cf ssh enable-ssh>
        2.5.1  basic cf ssh <URL:#tn=        2.5.1  basic cf ssh>
        2.5.2 copy files from CF <URL:#tn=        2.5.2 copy files from CF>
            2.5.2.1 my way <URL:#tn=            2.5.2.1 my way>
            2.5.2.2 scp or sftp <URL:#tn=            2.5.2.2 scp or sftp>
        2.5.3 <URL:#tn=        2.5.3>
    2.6 CF administration <URL:#tn=    2.6 CF administration>
        2.6.1 Configure destinations <URL:#tn=        2.6.1 Configure destinations>
        2.6.2 clp instance ID <URL:#tn=        2.6.2 clp instance ID>
            2.6.2.1 get clp instance ID <URL:#tn=            2.6.2.1 get clp instance ID>
            2.6.2.2 <URL:#tn=            2.6.2.2>
        2.6.3 <URL:#tn=        2.6.3>
    2.7 CF Portal <URL:#tn=    2.7 CF Portal>
        2.7.1 portal-cli , tags: Jawad portal cli <URL:#tn=        2.7.1 portal-cli , tags: Jawad portal cli>
            2.7.1.1 readme <URL:#tn=            2.7.1.1 readme>
            2.7.1.2 Connect to CMK DB <URL:#tn=            2.7.1.2 Connect to CMK DB>
            2.7.1.3 my examples <URL:#tn=            2.7.1.3 my examples>
                2.7.1.3.1  getMyToken  alias <URL:#tn=                2.7.1.3.1  getMyToken  alias>
            2.7.1.4 readme The Portal CLI intends to bring several day-to-day development operations/tools to the command line <URL:#tn=            2.7.1.4 readme The Portal CLI intends to bring several day-to-day development operations/tools to the command line>
            2.7.1.5 remote redis connection <URL:#tn=            2.7.1.5 remote redis connection>
            2.7.1.6 start all apps <URL:#tn=            2.7.1.6 start all apps>
            2.7.1.7 releases <URL:#tn=            2.7.1.7 releases>
            2.7.1.8 Thursday 9 November 2023 at 16:03 major update, tags: Thursday 9 November 2023 at 16:03 major update <URL:#tn=            2.7.1.8 Thursday 9 November 2023 at 16:03 major update, tags: Thursday 9 November 2023 at 16:03 major update>
                2.7.1.8.1 new features <URL:#tn=                2.7.1.8.1 new features>
                    2.7.1.8.1.1 Jawad's message <URL:#tn=                    2.7.1.8.1.1 Jawad's message>
                    2.7.1.8.1.2 logs <URL:#tn=                    2.7.1.8.1.2 logs>
                    2.7.1.8.1.3 generate user token <URL:#tn=                    2.7.1.8.1.3 generate user token>
                    2.7.1.8.1.4 open redis connection <URL:#tn=                    2.7.1.8.1.4 open redis connection>
127.0.0.1:7892> ping <URL:#tn=127.0.0.1:7892> ping>
127.0.0.1:7892> set yosi izaq <URL:#tn=127.0.0.1:7892> set yosi izaq>
                    2.7.1.8.1.5 remote debug java application <URL:#tn=                    2.7.1.8.1.5 remote debug java application>
                    2.7.1.8.1.6 restart or restage all applications <URL:#tn=                    2.7.1.8.1.6 restart or restage all applications>
                    2.7.1.8.1.7 Ask GPT re. use cases and docs <URL:#tn=                    2.7.1.8.1.7 Ask GPT re. use cases and docs>
                    2.7.1.8.1.8 <URL:#tn=                    2.7.1.8.1.8>
                2.7.1.8.2 <URL:#tn=                2.7.1.8.2>
            2.7.1.9 cf user-token <URL:#tn=            2.7.1.9 cf user-token>
                2.7.1.9.1 Oriel's email <URL:#tn=                2.7.1.9.1 Oriel's email>
                2.7.1.9.2 <URL:#tn=                2.7.1.9.2>
            2.7.1.10 <URL:#tn=            2.7.1.10>
    2.8 CF plugins, extensions <URL:#tn=    2.8 CF plugins, extensions>
        2.8.1 cf top <URL:#tn=        2.8.1 cf top>
        2.8.2  list-services <URL:#tn=        2.8.2  list-services>
        2.8.3 log-stream <URL:#tn=        2.8.3 log-stream>
        2.8.4 lookup-route <URL:#tn=        2.8.4 lookup-route>
        2.8.5 Cloud Foundry CLI AutoScaler Plug-in <URL:#tn=        2.8.5 Cloud Foundry CLI AutoScaler Plug-in>
        2.8.6 <URL:#tn=        2.8.6>
    2.9 login <URL:#tn=    2.9 login>
        2.9.1 2fa, two factor authentication <URL:#tn=        2.9.1 2fa, two factor authentication>
        2.9.2 chrome 2fa extension <URL:#tn=        2.9.2 chrome 2fa extension>
            2.9.2.1 updated for 15/12/22 10:04:33 <URL:#tn=            2.9.2.1 updated for 15/12/22 10:04:33>
            2.9.2.2 original wiki <URL:#tn=            2.9.2.2 original wiki>
        2.9.3 <URL:#tn=        2.9.3>
    2.10 Troubleshooting Slow Requests in CF <URL:#tn=    2.10 Troubleshooting Slow Requests in CF>
        2.10.1 Overview <URL:#tn=        2.10.1 Overview>
        2.10.1 Experiment 1: Measure Total Round-Trip App Requests <URL:#tn=        2.10.1 Experiment 1: Measure Total Round-Trip App Requests>
        2.10.2 Experiment 2: View Request Time in Access Logs <URL:#tn=        2.10.2 Experiment 2: View Request Time in Access Logs>
        2.10.3 Experiment 3: Duplicate Latency on Another Endpoint <URL:#tn=        2.10.3 Experiment 3: Duplicate Latency on Another Endpoint>
        2.10.4 Experiment 4: Remove the Load Balancer from Request Path <URL:#tn=        2.10.4 Experiment 4: Remove the Load Balancer from Request Path>
        2.10.5 Experiment 5: Remove Gorouter from Request Path <URL:#tn=        2.10.5 Experiment 5: Remove Gorouter from Request Path>
        2.10.6 Experiment 6: Test the Network between the Router and the App <URL:#tn=        2.10.6 Experiment 6: Test the Network between the Router and the App>
        2.10.7 Use App Logs to Locate Delays in CF <URL:#tn=        2.10.7 Use App Logs to Locate Delays in CF>
        2.10.8 Operations Recommendations <URL:#tn=        2.10.8 Operations Recommendations>
        2.10.1 <URL:#tn=        2.10.1>
    2.11 remote connections <URL:#tn=    2.11 remote connections>
        2.11.1  remote connection to postgres <URL:#tn=        2.11.1  remote connection to postgres>
        2.11.2  remote connection to redis <URL:#tn=        2.11.2  remote connection to redis>
            2.11.2.1  general procedure <URL:#tn=            2.11.2.1  general procedure>
            2.11.2.2 adaptions for connecting to hyperscaler-redis <URL:#tn=            2.11.2.2 adaptions for connecting to hyperscaler-redis>
                2.11.2.2.1 amazon elasticcache <URL:#tn=                2.11.2.2.1 amazon elasticcache>
                2.11.2.2.2 <URL:#tn=                2.11.2.2.2>
            2.11.2.3 <URL:#tn=            2.11.2.3>
        2.11.3 <URL:#tn=        2.11.3>
    2.12 provider spaces <URL:#tn=    2.12 provider spaces>
        2.12.1 update space Jenkins <URL:#tn=        2.12.1 update space Jenkins>
        2.12.2 <URL:#tn=        2.12.2>
    2.13 BTP CLI , tags: BTP CLI <URL:#tn=    2.13 BTP CLI , tags: BTP CLI>
        2.13.1 install <URL:#tn=        2.13.1 install>
        2.13.2 assign entitlements for subaccounts <URL:#tn=        2.13.2 assign entitlements for subaccounts>
        2.13.3 <URL:#tn=        2.13.3>
    2.14 CF stacks <URL:#tn=    2.14 CF stacks>
        2.14.1 changing stacks <URL:#tn=        2.14.1 changing stacks>
        2.14.2 <URL:#tn=        2.14.2>
    2.15 Performance <URL:#tn=    2.15 Performance>
        2.15.1 NodeJS Performance <URL:#tn=        2.15.1 NodeJS Performance>
            2.15.1.1 Pavel wiki on Nodejs performance, tags: Pavel wiki on Nodejs performance <URL:#tn=            2.15.1.1 Pavel wiki on Nodejs performance, tags: Pavel wiki on Nodejs performance>
            2.15.1.2 <URL:#tn=            2.15.1.2>
        2.15.2 <URL:#tn=        2.15.2>
    2.16 dmol displaying memory and logs of Cloud Foundry application instances <URL:#tn=    2.16 dmol displaying memory and logs of Cloud Foundry application instances>
    2.17 <URL:#tn=    2.17>
3. research features <URL:#tn=3. research features>
    3.1 Add default catalog and group upon site creation <URL:#tn=    3.1 Add default catalog and group upon site creation>
        3.1.1  code research <URL:#tn=        3.1.1  code research>
        3.1.2 <URL:#tn=        3.1.2>
    3.2 <URL:#tn=    3.2>
4. REST examples, API, Postman, curl <URL:#tn=4. REST examples, API, Postman, curl>
    4.1 semantic <URL:#tn=    4.1 semantic>
        4.1.1  Batch requests <URL:#tn=        4.1.1  Batch requests>
            4.1.1.1  CREATE Batch requests <URL:#tn=            4.1.1.1  CREATE Batch requests>
                4.1.1.1.1  Create bussiness-app request <URL:#tn=                4.1.1.1.1  Create bussiness-app request>
                4.1.1.1.2 create a catalog <URL:#tn=                4.1.1.1.2 create a catalog>
                4.1.1.1.3 create a group <URL:#tn=                4.1.1.1.3 create a group>
            4.1.1.2 DELETE <URL:#tn=            4.1.1.2 DELETE>
                4.1.1.2.1 delete a group <URL:#tn=                4.1.1.2.1 delete a group>
                4.1.1.2.2 <URL:#tn=                4.1.1.2.2>
            4.1.1.3 UPDATE <URL:#tn=            4.1.1.3 UPDATE>
                4.1.1.3.1 update app title <URL:#tn=                4.1.1.3.1 update app title>
                4.1.1.3.2 update catlog title <URL:#tn=                4.1.1.3.2 update catlog title>
                4.1.1.3.3 update groupt title <URL:#tn=                4.1.1.3.3 update groupt title>
                4.1.1.3.4 <URL:#tn=                4.1.1.3.4>
            4.1.1.4 READ <URL:#tn=            4.1.1.4 READ>
        4.1.2 semantic Swagger API <URL:#tn=        4.1.2 semantic Swagger API>
        4.1.3 get site <URL:#tn=        4.1.3 get site>
        4.1.4 <URL:#tn=        4.1.4>
    4.2 cdm-store-service <URL:#tn=    4.2 cdm-store-service>
        4.2.0 Access tokens <URL:#tn=        4.2.0 Access tokens>
            4.2.0.1 > postman collection: cdm store <URL:#tn=            4.2.0.1 > postman collection: cdm store>
                4.2.0.1.1 generate client token, tags: generate client technical token <URL:#tn=                4.2.0.1.1 generate client token, tags: generate client technical token>
        4.2.1  is alive <URL:#tn=        4.2.1  is alive>
        4.2.2 get entity by type and id <URL:#tn=        4.2.2 get entity by type and id>
        4.2.3 get entities with relations <URL:#tn=        4.2.3 get entities with relations>
        4.2.4 get all entities of type <URL:#tn=        4.2.4 get all entities of type>
        4.2.5 search cherry-pick local providers <URL:#tn=        4.2.5 search cherry-pick local providers>
        4.2.6 Search all provider entities, cherry-pick from SaaS and base from Apollo provider PaaS <URL:#tn=        4.2.6 Search all provider entities, cherry-pick from SaaS and base from Apollo provider PaaS>
        4.2.7 get all roles <URL:#tn=        4.2.7 get all roles>
        4.2.8 <URL:#tn=        4.2.8>
    4.3 <URL:#tn=    4.3>
40. tags: Microservices and libraries, tags: Microservices , libraries, git repositoires <URL:#tn=40. tags: Microservices and libraries, tags: Microservices , libraries, git repositoires>
    40.1  portal-cf-site-semantic-service <URL:#tn=    40.1  portal-cf-site-semantic-service>
        40.1.1   lifecycle <URL:#tn=        40.1.1   lifecycle>
        40.1.2 CI Builds <URL:#tn=        40.1.2 CI Builds>
        40.1.3 Master builds <URL:#tn=        40.1.3 Master builds>
            40.1.3.1 Frequent issues <URL:#tn=            40.1.3.1 Frequent issues>
                40.1.3.1.1 Deployment failures <URL:#tn=                40.1.3.1.1 Deployment failures>
                    40.1.3.1.1.1  App is not starting <URL:#tn=                    40.1.3.1.1.1  App is not starting>
                        40.1.3.1.1.1.1  Src depends on test root cause <URL:#tn=                        40.1.3.1.1.1.1  Src depends on test root cause>
                        40.1.3.1.1.1.2 <URL:#tn=                        40.1.3.1.1.1.2>
                    40.1.3.1.1.2 <URL:#tn=                    40.1.3.1.1.2>
                40.1.3.1.2 <URL:#tn=                40.1.3.1.2>
            40.1.3.2 <URL:#tn=            40.1.3.2>
        40.1.4 <URL:#tn=        40.1.4>
    40.2 portal-metering-service <URL:#tn=    40.2 portal-metering-service>
    40.3 portal-cf-dt-approuter <URL:#tn=    40.3 portal-cf-dt-approuter>
        40.3.1 general <URL:#tn=        40.3.1 general>
        40.3.2 Test locally <URL:#tn=        40.3.2 Test locally>
            40.3.2.1 web server <URL:#tn=            40.3.2.1 web server>
            40.3.2.2 manual local tests with mock <URL:#tn=            40.3.2.2 manual local tests with mock>
            40.3.2.3 qunit <URL:#tn=            40.3.2.3 qunit>
            40.3.2.4 UIVeri5 <URL:#tn=            40.3.2.4 UIVeri5>
                40.3.2.4.1 How to run localy <URL:#tn=                40.3.2.4.1 How to run localy>
                40.3.2.4.2 improve speed, run in paralel <URL:#tn=                40.3.2.4.2 improve speed, run in paralel>
                40.3.2.4.3 <URL:#tn=                40.3.2.4.3>
            40.3.2.5 <URL:#tn=            40.3.2.5>
        40.3.3 Eslint <URL:#tn=        40.3.3 Eslint>
        40.3.4 code coverage <URL:#tn=        40.3.4 code coverage>
        40.3.5 deploy to space <URL:#tn=        40.3.5 deploy to space>
        40.3.6 dt-approuter debug tips <URL:#tn=        40.3.6 dt-approuter debug tips>
        40.3.7 qunit tests <URL:#tn=        40.3.7 qunit tests>
    40.4 dt-static-resources <URL:#tn=    40.4 dt-static-resources>
        40.4.1 repo <URL:#tn=        40.4.1 repo>
        40.4.2 readme <URL:#tn=        40.4.2 readme>
        40.4.3 <URL:#tn=        40.4.3>
    40.5 cdm-store microservice , tags: cdm-store microservice <URL:#tn=    40.5 cdm-store microservice , tags: cdm-store microservice>
        40.5.1  getting started <URL:#tn=        40.5.1  getting started>
            40.5.1.1  get code <URL:#tn=            40.5.1.1  get code>
            40.5.1.2 15/10/23 12:44:11  - SAP stops working with oracle java. <URL:#tn=            40.5.1.2 15/10/23 12:44:11  - SAP stops working with oracle java.>
            40.5.1.3 Java 17 <URL:#tn=            40.5.1.3 Java 17>
                40.5.1.3.1  preliminary steps <URL:#tn=                40.5.1.3.1  preliminary steps>
                40.5.1.3.2 build <URL:#tn=                40.5.1.3.2 build>
                40.5.1.3.3 run tests <URL:#tn=                40.5.1.3.3 run tests>
            40.5.1.4 40.5.1.1  Fix build issues <URL:#tn=            40.5.1.4 40.5.1.1  Fix build issues>
            40.5.1.1  main tables <URL:#tn=            40.5.1.1  main tables>
                40.5.1.1.1  CDM_ENTITIES <URL:#tn=                40.5.1.1.1  CDM_ENTITIES>
                40.5.1.1.2 RELATIONS <URL:#tn=                40.5.1.1.2 RELATIONS>
            40.5.1.2 <URL:#tn=            40.5.1.2>
        40.5.2 CDM store APIs, Requests, collections , tags: CDM store APIs, Requests, collections <URL:#tn=        40.5.2 CDM store APIs, Requests, collections , tags: CDM store APIs, Requests, collections>
            40.5.2.1  BATCH API <URL:#tn=            40.5.2.1  BATCH API>
                40.5.2.1.1  code <URL:#tn=                40.5.2.1.1  code>
                40.5.2.1.2 curl batch request <URL:#tn=                40.5.2.1.2 curl batch request>
                40.5.2.1.3 <URL:#tn=                40.5.2.1.3>
            40.5.2.2 is_alive <URL:#tn=            40.5.2.2 is_alive>
            40.5.2.3 <URL:#tn=            40.5.2.3>
        40.5.3 push to space <URL:#tn=        40.5.3 push to space>
        40.5.4 Connect to Database <URL:#tn=        40.5.4 Connect to Database>
            40.5.4.1 how to connect to cdm-store db, tags: how to connect to cdm-store db <URL:#tn=            40.5.4.1 how to connect to cdm-store db, tags: how to connect to cdm-store db>
            40.5.4.2 When our apps are connecting to the Postgres DB do they use username and password or the server cert, tags: When our apps are connecting to the Postgres DB do they use username and password or the server cert <URL:#tn=            40.5.4.2 When our apps are connecting to the Postgres DB do they use username and password or the server cert, tags: When our apps are connecting to the Postgres DB do they use username and password or the server cert>
            40.5.4.3 <URL:#tn=            40.5.4.3>
        40.5.5 cdm-store tests, api payloads <URL:#tn=        40.5.5 cdm-store tests, api payloads>
            40.5.5.1 Batch payloads <URL:#tn=            40.5.5.1 Batch payloads>
                40.5.5.1.1 create <URL:#tn=                40.5.5.1.1 create>
                40.5.5.1.2 <URL:#tn=                40.5.5.1.2>
            40.5.5.2 <URL:#tn=            40.5.5.2>
        40.5.6 migrations <URL:#tn=        40.5.6 migrations>
            40.5.6.1 Migration Guides <URL:#tn=            40.5.6.1 Migration Guides>
            40.5.6.2 <URL:#tn=            40.5.6.2>
        40.5.7 Swagger <URL:#tn=        40.5.7 Swagger>
        40.5.8 buildpack, tags buildpack java version end of life support <URL:#tn=        40.5.8 buildpack, tags buildpack java version end of life support>
        40.5.9 CDM-Store-Service error handling <URL:#tn=        40.5.9 CDM-Store-Service error handling>
            40.5.9.1 RestResponseEntityExceptionHandler <URL:#tn=            40.5.9.1 RestResponseEntityExceptionHandler>
            40.5.9.2 Custom validators <URL:#tn=            40.5.9.2 Custom validators>
            40.5.9.3 <URL:#tn=            40.5.9.3>
        40.5.10 CDM-Store-Service updates,, tags: CDM-Store-Service updates <URL:#tn=        40.5.10 CDM-Store-Service updates,, tags: CDM-Store-Service updates>
            40.5.10.1 Congratulations a new Postgres image has been added to portal-cf-cdm-store-service, 19/06/23 13:11:26 <URL:#tn=            40.5.10.1 Congratulations a new Postgres image has been added to portal-cf-cdm-store-service, 19/06/23 13:11:26>
            40.5.10.2 <URL:#tn=            40.5.10.2>
        40.5.11 CDM-Store Events functionality <URL:#tn=        40.5.11 CDM-Store Events functionality>
            40.5.11.1 introduction to CDM-Store Events functionality <URL:#tn=            40.5.11.1 introduction to CDM-Store Events functionality>
                40.5.11.1.1 CDM-Store published events to Solace MQ <URL:#tn=                40.5.11.1.1 CDM-Store published events to Solace MQ>
                40.5.11.1.2 main code entries <URL:#tn=                40.5.11.1.2 main code entries>
                40.5.11.1.3 who is sending events? <URL:#tn=                40.5.11.1.3 who is sending events?>
            40.5.11.2 Events are saved to an events log table <URL:#tn=            40.5.11.2 Events are saved to an events log table>
            40.5.11.3 <URL:#tn=            40.5.11.3>
        40.5.12 odds and ends of CDM-store , tags: odds and ends of CDM-store <URL:#tn=        40.5.12 odds and ends of CDM-store , tags: odds and ends of CDM-store>
            40.5.12.1 tenantid is actually md5 hash of indentityZoneId and instancId <URL:#tn=            40.5.12.1 tenantid is actually md5 hash of indentityZoneId and instancId>
            40.5.12.2 <URL:#tn=            40.5.12.2>
        40.5.13 <URL:#tn=        40.5.13>
    40.6 portal-cf-provisioning-service, tags: portal-cf-provisioning-service <URL:#tn=    40.6 portal-cf-provisioning-service, tags: portal-cf-provisioning-service>
        40.6.1 new <URL:#tn=        40.6.1 new>
        40.6.2 old <URL:#tn=        40.6.2 old>
        40.6.2 build, test <URL:#tn=        40.6.2 build, test>
        40.6.3 Swagger <URL:#tn=        40.6.3 Swagger>
        4.6.4 Tables, DB, tags: provisioning-service Tables, DB, microservice <URL:#tn=        4.6.4 Tables, DB, tags: provisioning-service Tables, DB, microservice>
            4.6.4.1 schema <URL:#tn=            4.6.4.1 schema>
            4.6.4.2 provisioning-service tables <URL:#tn=            4.6.4.2 provisioning-service tables>
                4.6.4.2.1  subscribers table <URL:#tn=                4.6.4.2.1  subscribers table>
                4.6.4.2.2  providers table <URL:#tn=                4.6.4.2.2  providers table>
                4.6.4.2.3 global_providers <URL:#tn=                4.6.4.2.3 global_providers>
                4.6.4.2.4 <URL:#tn=                4.6.4.2.4>
            4.6.4.3 <URL:#tn=            4.6.4.3>
        4.6.5 <URL:#tn=        4.6.5>
    40.7 cdm-store-client , tags: cdm-store-client microservice <URL:#tn=    40.7 cdm-store-client , tags: cdm-store-client microservice>
        40.7.1 commit flow <URL:#tn=        40.7.1 commit flow>
            40.7.1.1 update version <URL:#tn=            40.7.1.1 update version>
            40.7.1.2 <URL:#tn=            40.7.1.2>
        40.7.2 frequent cdm-store-client issues <URL:#tn=        40.7.2 frequent cdm-store-client issues>
            40.7.2.1 error TS2307: Cannot find module 'cdm-store-client' or its corresponding type declarations. <URL:#tn=            40.7.2.1 error TS2307: Cannot find module 'cdm-store-client' or its corresponding type declarations.>
1.25.0-20200610072804 <URL:#tn=1.25.0-20200610072804>
        40.7.3 <URL:#tn=        40.7.3>
    40.8 portal-platform-commons <URL:#tn=    40.8 portal-platform-commons>
        40.8.1  git repo <URL:#tn=        40.8.1  git repo>
        40.8.2 use portal-platform-commons <URL:#tn=        40.8.2 use portal-platform-commons>
            40.8.2.1 update version in portal-cf-provisioning-service <URL:#tn=            40.8.2.1 update version in portal-cf-provisioning-service>
        40.8.3 <URL:#tn=        40.8.3>
    40.9 tag: portal-cf-transport-service <URL:#tn=    40.9 tag: portal-cf-transport-service>
        40.9.1 Main use cases and architecture <URL:#tn=        40.9.1 Main use cases and architecture>
        40.9.2 Unit and Integration tests <URL:#tn=        40.9.2 Unit and Integration tests>
            40.9.2.1 transport Integration tests <URL:#tn=            40.9.2.1 transport Integration tests>
            40.9.2.2 import Integration tests <URL:#tn=            40.9.2.2 import Integration tests>
            40.9.2.3 transport integration tests common errors <URL:#tn=            40.9.2.3 transport integration tests common errors>
                40.9.2.3.1 timeout exceeded <URL:#tn=                40.9.2.3.1 timeout exceeded>
                    40.9.2.3.1.1 redis keys not deleted <URL:#tn=                    40.9.2.3.1.1 redis keys not deleted>
127.0.0.1:6379> KEYS * <URL:#tn=127.0.0.1:6379> KEYS *>
127.0.0.1:6379> FLUSHALL <URL:#tn=127.0.0.1:6379> FLUSHALL>
                40.9.2.3.2 Validation pipe double/mismatch validation <URL:#tn=                40.9.2.3.2 Validation pipe double/mismatch validation>
                40.9.2.3.3 <URL:#tn=                40.9.2.3.3>
            40.9.2.4 <URL:#tn=            40.9.2.4>
        40.9.3 swagger <URL:#tn=        40.9.3 swagger>
            40.9.3.1 Consume, read API <URL:#tn=            40.9.3.1 Consume, read API>
            40.9.3.2 Build swagger <URL:#tn=            40.9.3.2 Build swagger>
            40.9.3.3 <URL:#tn=            40.9.3.3>
        40.9.4 transport-service help <URL:#tn=        40.9.4 transport-service help>
            40.9.4.1 CIAS Guide: SAP Launchpad Service Integration with SAP S/4HANA <URL:#tn=            40.9.4.1 CIAS Guide: SAP Launchpad Service Integration with SAP S/4HANA>
        40.9.5 <URL:#tn=        40.9.5>
    40.10 technical support <URL:#tn=    40.10 technical support>
        40.10.1 General <URL:#tn=        40.10.1 General>
        40.10.2 Technical support set log level <URL:#tn=        40.10.2 Technical support set log level>
        40.10.3 <URL:#tn=        40.10.3>
    40.11 Developer-Scenario, tags: Developer-Scenario, Apollo, HTML5 providers <URL:#tn=    40.11 Developer-Scenario, tags: Developer-Scenario, Apollo, HTML5 providers>
        40.11.1 Wikis <URL:#tn=        40.11.1 Wikis>
        40.11.2 Deprecation of old portal deployer API <URL:#tn=        40.11.2 Deprecation of old portal deployer API>
        40.11.3 troubelshooting <URL:#tn=        40.11.3 troubelshooting>
            40.11.3.1 Session Time Out guide - to get approve for customer: <URL:#tn=            40.11.3.1 Session Time Out guide - to get approve for customer:>
            40.11.3.2 <URL:#tn=            40.11.3.2>
    40.12  DTS, tags: DTS, design time service, portal-cf-design-time-service <URL:#tn=    40.12  DTS, tags: DTS, design time service, portal-cf-design-time-service>
        40.12.1  background <URL:#tn=        40.12.1  background>
        40.12.2 general information <URL:#tn=        40.12.2 general information>
        40.12.3 features and PRs <URL:#tn=        40.12.3 features and PRs>
            40.12.3.1  multiple  applications with same IDs <URL:#tn=            40.12.3.1  multiple  applications with same IDs>
            40.12.3.2 <URL:#tn=            40.12.3.2>
        40.12.4 <URL:#tn=        40.12.4>
    40.13 git repositories <URL:#tn=    40.13 git repositories>
        40.13.1 k6 testing https://github.wdf.sap.corp/Portal-CF/k6-load-testing, tags: Jawad k6 testing <URL:#tn=        40.13.1 k6 testing https://github.wdf.sap.corp/Portal-CF/k6-load-testing, tags: Jawad k6 testing>
            40.13.1.1 README.md <URL:#tn=            40.13.1.1 README.md>
            40.13.1.2 k6 <URL:#tn=            40.13.1.2 k6>
        40.13.2 <URL:#tn=        40.13.2>
    40.14 tags: SAP cloud Connector, SCC <URL:#tn=    40.14 tags: SAP cloud Connector, SCC>
        40.14.1 SAP help Cloud Connector resources <URL:#tn=        40.14.1 SAP help Cloud Connector resources>
        40.14.3 <URL:#tn=        40.14.3>
    40.15 cdm-schema, tags: cdm-schema, schema <URL:#tn=    40.15 cdm-schema, tags: cdm-schema, schema>
        40.15.1 repositories <URL:#tn=        40.15.1 repositories>
            40.15.1.1 public <URL:#tn=            40.15.1.1 public>
            40.15.1.2 internal <URL:#tn=            40.15.1.2 internal>
            40.15.1.3 <URL:#tn=            40.15.1.3>
        40.15.2 README.md <URL:#tn=        40.15.2 README.md>
        40.15.3 validate entities <URL:#tn=        40.15.3 validate entities>
            40.15.3.1 cli <URL:#tn=            40.15.3.1 cli>
            40.15.3.2 UX <URL:#tn=            40.15.3.2 UX>
            40.15.3.3 <URL:#tn=            40.15.3.3>
        40.15.4 code structure <URL:#tn=        40.15.4 code structure>
            40.15.4.1 CLI <URL:#tn=            40.15.4.1 CLI>
            40.15.4.2 <URL:#tn=            40.15.4.2>
        40.15.5 FAQ re. CDM schema <URL:#tn=        40.15.5 FAQ re. CDM schema>
            40.15.5.1 portal schema <URL:#tn=            40.15.5.1 portal schema>
                40.15.5.1.1 validation of portal schema entities <URL:#tn=                40.15.5.1.1 validation of portal schema entities>
                40.15.5.1.2 <URL:#tn=                40.15.5.1.2>
            40.15.5.2 core schema <URL:#tn=            40.15.5.2 core schema>
        40.15.6 <URL:#tn=        40.15.6>
    40.16 credential-store, cred-store service, tags: credential-store, cred-store service <URL:#tn=    40.16 credential-store, cred-store service, tags: credential-store, cred-store service>
        40.16.1 General information <URL:#tn=        40.16.1 General information>
        40.16.2 X509 and Cred-store <URL:#tn=        40.16.2 X509 and Cred-store>
            40.16.2.1 certificate renovation <URL:#tn=            40.16.2.1 certificate renovation>
                40.16.2.1.1 Kalman's procedure for Nili's automations <URL:#tn=                40.16.2.1.1 Kalman's procedure for Nili's automations>
            40.16.2.2 <URL:#tn=            40.16.2.2>
        40.16.3 <URL:#tn=        40.16.3>
    40.17 SAP message queue, solace, activemq, tags: SAP message queue, tags: SAP message queue <URL:#tn=    40.17 SAP message queue, solace, activemq, tags: SAP message queue, tags: SAP message queue>
        40.17.1 contacts, links <URL:#tn=        40.17.1 contacts, links>
        40.17.2 Design-Documents <URL:#tn=        40.17.2 Design-Documents>
        40.17.3 Solace FAQ, tags: Solace FAQ <URL:#tn=        40.17.3 Solace FAQ, tags: Solace FAQ>
            40.17.3.1 how to perform certificate rotation for the solace without the devops job, tags: how to perform certificate rotation for the solace without the devops job <URL:#tn=            40.17.3.1 how to perform certificate rotation for the solace without the devops job, tags: how to perform certificate rotation for the solace without the devops job>
            40.17.3.2 <URL:#tn=            40.17.3.2>
        40.17.4 XSUAA , tags: XSUAA <URL:#tn=        40.17.4 XSUAA , tags: XSUAA>
            40.17.4.1 XSUAA FAQ, tags: XSUAA FAQ <URL:#tn=            40.17.4.1 XSUAA FAQ, tags: XSUAA FAQ>
                40.17.4.1.1  max issued certificate validity performing <URL:#tn=                40.17.4.1.1  max issued certificate validity performing>
            40.17.4.2 <URL:#tn=            40.17.4.2>
        40.17.5 <URL:#tn=        40.17.5>
    40.18 Content Provider Types in our product, tags: Content Provider Types in our product <URL:#tn=    40.18 Content Provider Types in our product, tags: Content Provider Types in our product>
        40.18.1 HTML5 apps content provider (aka saas approuter) <URL:#tn=        40.18.1 HTML5 apps content provider (aka saas approuter)>
        40.18.2 Apollo Content provider (aka CF content provider aka Apollo bluebox) <URL:#tn=        40.18.2 Apollo Content provider (aka CF content provider aka Apollo bluebox)>
        40.18.3 External content provider <URL:#tn=        40.18.3 External content provider>
        40.18.4 Embedded content provider <URL:#tn=        40.18.4 Embedded content provider>
        40.18.5 Workzone Local content provider <URL:#tn=        40.18.5 Workzone Local content provider>
        40.18.6 Hosted content provider <URL:#tn=        40.18.6 Hosted content provider>
        40.18.7 global vizTypes provider <URL:#tn=        40.18.7 global vizTypes provider>
        40.18.8 OOTB Plugins <URL:#tn=        40.18.8 OOTB Plugins>
        40.18.9 Hardcoded in code: <URL:#tn=        40.18.9 Hardcoded in code:>
        40.18.10 <URL:#tn=        40.18.10>
    40.19 CF services processes <URL:#tn=    40.19 CF services processes>
        40.19.1 deprecation, out of commission, retire service, tags:deprecation, out of commission, retire service <URL:#tn=        40.19.1 deprecation, out of commission, retire service, tags:deprecation, out of commission, retire service>
            40.19.1.1 Productive services deprecation process, shany, old GraphQL service,tags: Productive services deprecation process, shany, old GraphQL service, <URL:#tn=            40.19.1.1 Productive services deprecation process, shany, old GraphQL service,tags: Productive services deprecation process, shany, old GraphQL service,>
            40.19.1.2 <URL:#tn=            40.19.1.2>
        40.19.2 <URL:#tn=        40.19.2>
    40.20 CF components products  and plans, tags: CF components products and plans <URL:#tn=    40.20 CF components products  and plans, tags: CF components products and plans>
        40.20.1 07/09/23 15:54:08  products and plans list <URL:#tn=        40.20.1 07/09/23 15:54:08  products and plans list>
        40.20.2 <URL:#tn=        40.20.2>
    40.21 CF setups common issues, certificates, credentials, tags: CF setups common issues,  certificates, credentials, <URL:#tn=    40.21 CF setups common issues, certificates, credentials, tags: CF setups common issues,  certificates, credentials,>
        40.21.1 <URL:#tn=        40.21.1>
    40.22 SAP mobile start, tags: SAP mobile start <URL:#tn=    40.22 SAP mobile start, tags: SAP mobile start>
        40.22.1  SAP mobile start help, tags: SAP mobile start help <URL:#tn=        40.22.1  SAP mobile start help, tags: SAP mobile start help>
        40.22.2 SAP mobile start Architecture, tags: SAP mobile start Architecture <URL:#tn=        40.22.2 SAP mobile start Architecture, tags: SAP mobile start Architecture>
        40.22.3 SAP mobile start  integration to workzone, tags: SAP mobile start  integration to workzone <URL:#tn=        40.22.3 SAP mobile start  integration to workzone, tags: SAP mobile start  integration to workzone>
            40.22.3.1   SAP mobile start  integration to workzone - known issues, tags: SAP mobile start  integration to workzone - known issues <URL:#tn=            40.22.3.1   SAP mobile start  integration to workzone - known issues, tags: SAP mobile start  integration to workzone - known issues>
                40.22.3.1.1    Navigation to URL app now working, tags: Navigation to URL app now working <URL:#tn=                40.22.3.1.1    Navigation to URL app now working, tags: Navigation to URL app now working>
                40.22.3.1.2 <URL:#tn=                40.22.3.1.2>
            40.22.3.2 <URL:#tn=            40.22.3.2>
        40.22.4 <URL:#tn=        40.22.4>
    40.23 <URL:#tn=    40.23>
41. placeholder <URL:#tn=41. placeholder>
5. Operations <URL:#tn=5. Operations>
    5.1 Migration from Cred Store to CUPS <URL:#tn=    5.1 Migration from Cred Store to CUPS>
    5.2 create dev space concurse <URL:#tn=    5.2 create dev space concurse>
        5.2.1  intro <URL:#tn=        5.2.1  intro>
            5.2.1.1  devops presentation <URL:#tn=            5.2.1.1  devops presentation>
            5.2.1.2 slack channel, #prtl-init-env <URL:#tn=            5.2.1.2 slack channel, #prtl-init-env>
            5.2.1.3 request git permissions <URL:#tn=            5.2.1.3 request git permissions>
            5.2.1.4 create space instructions <URL:#tn=            5.2.1.4 create space instructions>
                5.2.1.4.1 ## Prerequisites-one time only <URL:#tn=                5.2.1.4.1 ## Prerequisites-one time only>
                5.2.1.4.2 iacbox <URL:#tn=                5.2.1.4.2 iacbox>
                5.2.1.4.3 ## Init environment execution <URL:#tn=                5.2.1.4.3 ## Init environment execution>
            5.2.1.5 <URL:#tn=            5.2.1.5>
        5.2.2 <URL:#tn=        5.2.2>
    5.3 <URL:#tn=    5.3>
6. Authentication and authorization <URL:#tn=6. Authentication and authorization>
    6.1  XS UAA <URL:#tn=    6.1  XS UAA>
        6.1.1  https://github.wdf.sap.corp/xs2/node-xs2sec#usage-of-the-xs-advanced-container-security-api-in-your-nodejs-application <URL:#tn=        6.1.1  https://github.wdf.sap.corp/xs2/node-xs2sec#usage-of-the-xs-advanced-container-security-api-in-your-nodejs-application>
        6.1.2 <URL:#tn=        6.1.2>
    6.2 <URL:#tn=    6.2>
7. technical resources <URL:#tn=7. technical resources>
    7.1 https://stackoverflow.com/questions/tagged/sap-cloud-sdk <URL:#tn=    7.1 https://stackoverflow.com/questions/tagged/sap-cloud-sdk>
    7.2 <URL:#tn=    7.2>
8. security <URL:#tn=8. security>
    8.1 security checks on source code <URL:#tn=    8.1 security checks on source code>
        8.1.1 Vulas <URL:#tn=        8.1.1 Vulas>
            8.1.1.1 problem description <URL:#tn=            8.1.1.1 problem description>
            8.1.1.2 Fix process <URL:#tn=            8.1.1.2 Fix process>
            8.1.1.3 <URL:#tn=            8.1.1.3>
        8.1.2 PPMS <URL:#tn=        8.1.2 PPMS>
            8.1.2.1 problem description <URL:#tn=            8.1.2.1 problem description>
            8.1.2.2 request permission <URL:#tn=            8.1.2.2 request permission>
            8.1.2.3 <URL:#tn=            8.1.2.3>
        8.1.3 <URL:#tn=        8.1.3>
    8.2 <URL:#tn=    8.2>
9. Tests tags: E2E tests, integration tests, nightly tests, Automation <URL:#tn=9. Tests tags: E2E tests, integration tests, nightly tests, Automation>
    9.1   Cross team integration tests <URL:#tn=    9.1   Cross team integration tests>
    9.2 Guys E2E,  CFLP-E2E-INTEGRATION-TEST <URL:#tn=    9.2 Guys E2E,  CFLP-E2E-INTEGRATION-TEST>
    9.3   setups <URL:#tn=    9.3   setups>
        9.3.1   LKG <URL:#tn=        9.3.1   LKG>
        9.3.2 tags: LTS <URL:#tn=        9.3.2 tags: LTS>
            9.3.2.1 LTS system <URL:#tn=            9.3.2.1 LTS system>
            9.3.2.2 cockpit of mainsub lts, tags: lts cockpit <URL:#tn=            9.3.2.2 cockpit of mainsub lts, tags: lts cockpit>
            9.3.2.3 consumers accounts <URL:#tn=            9.3.2.3 consumers accounts>
                9.3.2.3.1 saartest <URL:#tn=                9.3.2.3.1 saartest>
                9.3.2.3.2 yosi-e2e-tests <URL:#tn=                9.3.2.3.2 yosi-e2e-tests>
                9.3.2.3.3 <URL:#tn=                9.3.2.3.3>
            9.3.2.4 Subscribed accounts <URL:#tn=            9.3.2.4 Subscribed accounts>
        9.3.3 Dev <URL:#tn=        9.3.3 Dev>
            9.3.3.1 tags: Yosi, formerly Saar, global account dev spaces <URL:#tn=            9.3.3.1 tags: Yosi, formerly Saar, global account dev spaces>
                9.3.3.1.1 cockpit <URL:#tn=                9.3.3.1.1 cockpit>
                9.3.3.1.2 CF cli access <URL:#tn=                9.3.3.1.2 CF cli access>
                    9.3.3.1.2.1 my space <URL:#tn=                    9.3.3.1.2.1 my space>
                    9.3.3.1.2.2 update space <URL:#tn=                    9.3.3.1.2.2 update space>
                    9.3.3.1.2.3 <URL:#tn=                    9.3.3.1.2.3>
                9.3.3.1.3 tags: control center <URL:#tn=                9.3.3.1.3 tags: control center>
                9.3.3.1.4 Manage entitlements and quotas <URL:#tn=                9.3.3.1.4 Manage entitlements and quotas>
                9.3.3.1.5 <URL:#tn=                9.3.3.1.5>
            9.3.3.2 <URL:#tn=            9.3.3.2>
        9.3.4 RCT, Release-candidate-test <URL:#tn=        9.3.4 RCT, Release-candidate-test>
            9.3.4.1 RCT space <URL:#tn=            9.3.4.1 RCT space>
            9.3.4.2 rct cockpit <URL:#tn=            9.3.4.2 rct cockpit>
        9.3.5 <URL:#tn=        9.3.5>
    9.4   tags: post-deployment tests, sanity, FLP-UI-SANITY-E2E, portal-cf-fs-automation <URL:#tn=    9.4   tags: post-deployment tests, sanity, FLP-UI-SANITY-E2E, portal-cf-fs-automation>
        9.4.0   SANITY-POST-DEPLOY <URL:#tn=        9.4.0   SANITY-POST-DEPLOY>
            9.4.0.1   README, tags: SANITY-POST-DEPLOY, SANITY-POST-DEPLOY-PORTAL, SANITY-POST-DEPLOY-LAUNCHPAD, readme, Kalman <URL:#tn=            9.4.0.1   README, tags: SANITY-POST-DEPLOY, SANITY-POST-DEPLOY-PORTAL, SANITY-POST-DEPLOY-LAUNCHPAD, readme, Kalman>
            9.4.0.2 manual Verification <URL:#tn=            9.4.0.2 manual Verification>
            9.4.0.3 post-deployment environments <URL:#tn=            9.4.0.3 post-deployment environments>
            9.4.0.4 <URL:#tn=            9.4.0.4>
        9.4.1   current job <URL:#tn=        9.4.1   current job>
        9.4.2 old test suites <URL:#tn=        9.4.2 old test suites>
            9.4.2.1 FLP-UI-SANITY-E2E <URL:#tn=            9.4.2.1 FLP-UI-SANITY-E2E>
            9.4.2.2 <URL:#tn=            9.4.2.2>
        9.4.3 <URL:#tn=        9.4.3>
    9.5   Tests configuration  - ci-tools repository <URL:#tn=    9.5   Tests configuration  - ci-tools repository>
        9.5.1 tweak e2e test job configuration <URL:#tn=        9.5.1 tweak e2e test job configuration>
        9.5.2 <URL:#tn=        9.5.2>
    9.6   Test Tools <URL:#tn=    9.6   Test Tools>
        9.6.1   A new CLI for fetching E2E jobs parameters <URL:#tn=        9.6.1   A new CLI for fetching E2E jobs parameters>
            9.6.1.1    usage example: <URL:#tn=            9.6.1.1    usage example:>
            9.6.1.2  code <URL:#tn=            9.6.1.2  code>
            9.6.1.3 <URL:#tn=            9.6.1.3>
        9.6.2 <URL:#tn=        9.6.2>
    9.7   EXTERNAL-PROVIDER-SYNC <URL:#tn=    9.7   EXTERNAL-PROVIDER-SYNC>
        9.7.1   Support Direct Role Relation <URL:#tn=        9.7.1   Support Direct Role Relation>
            9.7.1.1   Summary <URL:#tn=            9.7.1.1   Summary>
            9.7.1.2 <URL:#tn=            9.7.1.2>
        9.7.2 <URL:#tn=        9.7.2>
    9.8   DTS automations <URL:#tn=    9.8   DTS automations>
        9.8.1   background <URL:#tn=        9.8.1   background>
        9.8.2 HTML5_APPS_NEW_SCENARIO <URL:#tn=        9.8.2 HTML5_APPS_NEW_SCENARIO>
            9.8.2.1 code <URL:#tn=            9.8.2.1 code>
            9.8.2.2 example, skip test <URL:#tn=            9.8.2.2 example, skip test>
            9.8.2.3 <URL:#tn=            9.8.2.3>
        9.8.3 <URL:#tn=        9.8.3>
    9.9  tags: html5-new-tenant <URL:#tn=    9.9  tags: html5-new-tenant>
    9.10  Team Automations, E2E tests, tags: Team Automations <URL:#tn=    9.10  Team Automations, E2E tests, tags: Team Automations>
        9.10.1  Embedded content provider <URL:#tn=        9.10.1  Embedded content provider>
        9.10.2 <URL:#tn=        9.10.2>
    9.11 <URL:#tn=    9.11>
    9.12 <URL:#tn=    9.12>
    9.13 <URL:#tn=    9.13>
    9.14 <URL:#tn=    9.14>
    9.15 <URL:#tn=    9.15>
    9.16 <URL:#tn=    9.16>
10.  guidelines <URL:#tn=10.  guidelines>
    10.1  Source code conventions <URL:#tn=    10.1  Source code conventions>
        10.1.1  portal product scenarios <URL:#tn=        10.1.1  portal product scenarios>
        10.1.2 <URL:#tn=        10.1.2>
    10.2 <URL:#tn=    10.2>
11. BUGS, tags: bugs, defects, bcp, jiraa, snow, service-now, customer support <URL:#tn=11. BUGS, tags: bugs, defects, bcp, jiraa, snow, service-now, customer support>
    11.1  BCP <URL:#tn=    11.1  BCP>
        11.1.1  General <URL:#tn=        11.1.1  General>
            11.1.1.1  Open internal incident <URL:#tn=            11.1.1.1  Open internal incident>
            11.1.1.2 Ticket lifecycle <URL:#tn=            11.1.1.2 Ticket lifecycle>
        11.1.2  Customer BCPs <URL:#tn=        11.1.2  Customer BCPs>
            11.1.2.1    Incident 701620 / 2020 / A Subscribed Business application is not displayed on the content manager contents / SAP Delivered Support <URL:#tn=            11.1.2.1    Incident 701620 / 2020 / A Subscribed Business application is not displayed on the content manager contents / SAP Delivered Support>
                11.1.2.1.1    general <URL:#tn=                11.1.2.1.1    general>
                11.1.2.1.2 msgs 2 Customer <URL:#tn=                11.1.2.1.2 msgs 2 Customer>
                11.1.2.1.3 login to PaaS <URL:#tn=                11.1.2.1.3 login to PaaS>
                11.1.2.1.4 Search providers <URL:#tn=                11.1.2.1.4 Search providers>
                11.1.2.1.5 repro logs <URL:#tn=                11.1.2.1.5 repro logs>
                11.1.2.1.6 more info  Tue Dec  8 09:29:11 IST 2020 <URL:#tn=                11.1.2.1.6 more info  Tue Dec  8 09:29:11 IST 2020>
                    11.1.2.1.6.1 Boris duplicate base provider suspicion <URL:#tn=                    11.1.2.1.6.1 Boris duplicate base provider suspicion>
                    11.1.2.1.6.2 access DB with Boaz/Run <URL:#tn=                    11.1.2.1.6.2 access DB with Boaz/Run>
                    11.1.2.1.6.3 <URL:#tn=                    11.1.2.1.6.3>
                11.1.2.1.7 <URL:#tn=                11.1.2.1.7>
            11.1.2.2   placeholder <URL:#tn=            11.1.2.2   placeholder>
            11.1.2.3   placeholder <URL:#tn=            11.1.2.3   placeholder>
            11.1.2.4   placeholder <URL:#tn=            11.1.2.4   placeholder>
            11.1.2.5   placeholder <URL:#tn=            11.1.2.5   placeholder>
            11.1.2.6   placeholder <URL:#tn=            11.1.2.6   placeholder>
            11.1.2.7   placeholder <URL:#tn=            11.1.2.7   placeholder>
            11.1.2.8   placeholder <URL:#tn=            11.1.2.8   placeholder>
            11.1.2.9   placeholder <URL:#tn=            11.1.2.9   placeholder>
            11.1.2.10  placeholder <URL:#tn=            11.1.2.10  placeholder>
            11.1.2.11  placeholder <URL:#tn=            11.1.2.11  placeholder>
            11.1.2.12  placeholder <URL:#tn=            11.1.2.12  placeholder>
            11.1.2.13  placeholder <URL:#tn=            11.1.2.13  placeholder>
            11.1.2.14  placeholder <URL:#tn=            11.1.2.14  placeholder>
            11.1.2.15  placeholder <URL:#tn=            11.1.2.15  placeholder>
            11.1.2.16  placeholder <URL:#tn=            11.1.2.16  placeholder>
            11.1.2.17  placeholder <URL:#tn=            11.1.2.17  placeholder>
            11.1.2.18  placeholder <URL:#tn=            11.1.2.18  placeholder>
            11.1.2.19  placeholder <URL:#tn=            11.1.2.19  placeholder>
            11.1.2.20  placeholder <URL:#tn=            11.1.2.20  placeholder>
            11.1.2.21  placeholder <URL:#tn=            11.1.2.21  placeholder>
        11.1.3 SNOW, service now , tags: SNOW , service now <URL:#tn=        11.1.3 SNOW, service now , tags: SNOW , service now>
            11.1.3.0 signature template, tags: signature template <URL:#tn=            11.1.3.0 signature template, tags: signature template>
            11.1.3.1  Team snow wiki, tags: team snow wiki filter <URL:#tn=            11.1.3.1  Team snow wiki, tags: team snow wiki filter>
            11.1.3.2 Ticket processing <URL:#tn=            11.1.3.2 Ticket processing>
                11.1.3.2.1 template SNOW, service-now, Ticket basic info template  tags: template SNOW, service-now, customer issue Ticket basic info template <URL:#tn=                11.1.3.2.1 template SNOW, service-now, Ticket basic info template  tags: template SNOW, service-now, customer issue Ticket basic info template>
                    11.1.3.2.1.1 ticket signature template, tags: ticket signature template <URL:#tn=                    11.1.3.2.1.1 ticket signature template, tags: ticket signature template>
                    11.1.3.2.1.2 missing info template, tags: missing info template <URL:#tn=                    11.1.3.2.1.2 missing info template, tags: missing info template>
                11.1.3.2.2 related improvements <URL:#tn=                11.1.3.2.2 related improvements>
            11.1.3.3 guidelines for ticket severity, priority especially VH very high, tags: guidelines for ticket severity , especially VH very high, , tags: guidelines for ticket severity priority <URL:#tn=            11.1.3.3 guidelines for ticket severity, priority especially VH very high, tags: guidelines for ticket severity , especially VH very high, , tags: guidelines for ticket severity priority>
                11.1.3.3.1 official documentation <URL:#tn=                11.1.3.3.1 official documentation>
                11.1.3.3.2 example messages requesting the customer to reduce the severity of the problem, tags: example messages requesting the customer to reduce the severity of the problem <URL:#tn=                11.1.3.3.2 example messages requesting the customer to reduce the severity of the problem, tags: example messages requesting the customer to reduce the severity of the problem>
                11.1.3.3.3 <URL:#tn=                11.1.3.3.3>
            11.1.3.4 SNOW, ServiceNow, Jira customer responses template, tags: SNOW, ServiceNow, Jira customer responses <URL:#tn=            11.1.3.4 SNOW, ServiceNow, Jira customer responses template, tags: SNOW, ServiceNow, Jira customer responses>
                11.1.3.4.1  Customer response template , https://wiki.one.int.sap/wiki/display/CPPortals/Customer+Response+Templates <URL:#tn=                11.1.3.4.1  Customer response template , https://wiki.one.int.sap/wiki/display/CPPortals/Customer+Response+Templates>
                11.1.3.4.2 <URL:#tn=                11.1.3.4.2>
            11.1.3.5 <URL:#tn=            11.1.3.5>
        11.1.4 Components for assigning BCP and SNOW bugs, tags: Components BCP SNOW bugs tickets external internal, tags: Components, BCP, SNOW, tickets, bugs, customers <URL:#tn=        11.1.4 Components for assigning BCP and SNOW bugs, tags: Components BCP SNOW bugs tickets external internal, tags: Components, BCP, SNOW, tickets, bugs, customers>
            11.1.4.1 internal Components <URL:#tn=            11.1.4.1 internal Components>
            11.1.4.2 Components (SNOW, BCP) <URL:#tn=            11.1.4.2 Components (SNOW, BCP)>
        11.1.5 interesting tickets <URL:#tn=        11.1.5 interesting tickets>
            11.1.5.1 session timeout and logout issues <URL:#tn=            11.1.5.1 session timeout and logout issues>
                11.1.5.1.1 VH at 25/06/22 16:18:39  from TfNSW <URL:#tn=                11.1.5.1.1 VH at 25/06/22 16:18:39  from TfNSW>
                11.1.5.1.2 <URL:#tn=                11.1.5.1.2>
            11.1.5.2 <URL:#tn=            11.1.5.2>
        11.1.6 <URL:#tn=        11.1.6>
    11.2 DWP bugs, jiraa, open jira bug, tags: DWP bugs <URL:#tn=    11.2 DWP bugs, jiraa, open jira bug, tags: DWP bugs>
        11.2.0  jira bugs templates , tags: jira bugs templates <URL:#tn=        11.2.0  jira bugs templates , tags: jira bugs templates>
            11.2.0.1  Nili Bug template, tags: Nili Bug template <URL:#tn=            11.2.0.1  Nili Bug template, tags: Nili Bug template>
                11.2.0.1.1 <URL:#tn=                11.2.0.1.1>
                11.2.0.1.2 Description <URL:#tn=                11.2.0.1.2 Description>
                11.2.0.2.3 Repro <URL:#tn=                11.2.0.2.3 Repro>
                11.2.0.3.4 Root cause <URL:#tn=                11.2.0.3.4 Root cause>
                11.2.0.4.5 Fix <URL:#tn=                11.2.0.4.5 Fix>
                11.2.0.5.6 PRs, diffs <URL:#tn=                11.2.0.5.6 PRs, diffs>
            11.2.0.6 My jira template, tags: Shiri jira template <URL:#tn=            11.2.0.6 My jira template, tags: Shiri jira template>
            11.2.0.7 <URL:#tn=            11.2.0.7>
        11.2.1 add tests to resolver service, https://sapjira.wdf.sap.corp/browse/DWPBUGS-274 <URL:#tn=        11.2.1 add tests to resolver service, https://sapjira.wdf.sap.corp/browse/DWPBUGS-274>
        11.2.2 freestyle site doesn't work after export/import <URL:#tn=        11.2.2 freestyle site doesn't work after export/import>
            11.2.2.1 Description <URL:#tn=            11.2.2.1 Description>
            11.2.2.2 Repro <URL:#tn=            11.2.2.2 Repro>
            11.2.2.3 Root cause <URL:#tn=            11.2.2.3 Root cause>
            11.2.2.4 Fix <URL:#tn=            11.2.2.4 Fix>
            11.2.2.5 PRs, diffs <URL:#tn=            11.2.2.5 PRs, diffs>
            11.2.2.2 <URL:#tn=            11.2.2.2>
        11.2.3 [SMB] Global Content Provider - cannot be deployed if already DWPBUGS-534 <URL:#tn=        11.2.3 [SMB] Global Content Provider - cannot be deployed if already DWPBUGS-534>
            11.2.3.1 jira and description <URL:#tn=            11.2.3.1 jira and description>
            11.2.3.2 Fix <URL:#tn=            11.2.3.2 Fix>
            11.2.3.3 export (site and granularity) multiple providers call <URL:#tn=            11.2.3.3 export (site and granularity) multiple providers call>
                11.2.3.3.1 Description <URL:#tn=                11.2.3.3.1 Description>
                11.2.3.3.2 Gil fix <URL:#tn=                11.2.3.3.2 Gil fix>
                11.2.3.3.3 root-cause <URL:#tn=                11.2.3.3.3 root-cause>
                11.2.3.3.4 my fix <URL:#tn=                11.2.3.3.4 my fix>
                11.2.3.3.5 repro logs <URL:#tn=                11.2.3.3.5 repro logs>
                11.2.3.3.6 <URL:#tn=                11.2.3.3.6>
            11.2.3.4 <URL:#tn=            11.2.3.4>
        11.2.4 Template for Handover of Tickets from Product-Support to dev <URL:#tn=        11.2.4 Template for Handover of Tickets from Product-Support to dev>
        11.2.5 JIRA searches and filters, tags: JIRA searches and filters <URL:#tn=        11.2.5 JIRA searches and filters, tags: JIRA searches and filters>
            11.2.5.1 Team bugs <URL:#tn=            11.2.5.1 Team bugs>
            11.2.5.2 <URL:#tn=            11.2.5.2>
        11.2.6 Performance bugs.  tags: Performance bugs <URL:#tn=        11.2.6 Performance bugs.  tags: Performance bugs>
            11.2.6.1 20/03/23 13:23:24 <URL:#tn=            11.2.6.1 20/03/23 13:23:24>
            11.2.6.2 <URL:#tn=            11.2.6.2>
    11.3 feature requests <URL:#tn=    11.3 feature requests>
        11.3.1 tags: SAP feature requests site <URL:#tn=        11.3.1 tags: SAP feature requests site>
        11.3.2 <URL:#tn=        11.3.2>
    11.4 hotfix , tags: hotfix, REL_CANDI, RC_CANDI, patch <URL:#tn=    11.4 hotfix , tags: hotfix, REL_CANDI, RC_CANDI, patch>
        11.4.1 patch process , DORA tags: patch process DORA <URL:#tn=        11.4.1 patch process , DORA tags: patch process DORA>
        11.4.2 example hotfix <URL:#tn=        11.4.2 example hotfix>
        11.4.3 hotfix procedure <URL:#tn=        11.4.3 hotfix procedure>
        11.4.4 branches <URL:#tn=        11.4.4 branches>
        11.4.5 configuration request, , tags: configuration request <URL:#tn=        11.4.5 configuration request, , tags: configuration request>
            11.4.5.1  template <URL:#tn=            11.4.5.1  template>
            11.4.5.2 <URL:#tn=            11.4.5.2>
        11.4.6 <URL:#tn=        11.4.6>
    11.5 tags: Documentation <URL:#tn=    11.5 tags: Documentation>
        11.5.1 launchpad <URL:#tn=        11.5.1 launchpad>
            11.5.1.1 destinations <URL:#tn=            11.5.1.1 destinations>
            11.5.1.2 <URL:#tn=            11.5.1.2>
        11.5.2 <URL:#tn=        11.5.2>
    11.6 Recurring issues <URL:#tn=    11.6 Recurring issues>
        11.6.1 tags: can't delete service instance <URL:#tn=        11.6.1 tags: can't delete service instance>
            11.6.1.1 Not able to  delete copin-portal-service instance in sandboxpm4 space <URL:#tn=            11.6.1.1 Not able to  delete copin-portal-service instance in sandboxpm4 space>
            11.6.1.2 related documentation <URL:#tn=            11.6.1.2 related documentation>
                11.6.1.2.1 Getting an Application Access Token <URL:#tn=                11.6.1.2.1 Getting an Application Access Token>
                11.6.1.2.2 Using SAP SaaS Provisioning Service APIs to Manage Multitenant Applications <URL:#tn=                11.6.1.2.2 Using SAP SaaS Provisioning Service APIs to Manage Multitenant Applications>
                11.6.1.2.3 <URL:#tn=                11.6.1.2.3>
            11.6.1.3 <URL:#tn=            11.6.1.3>
        11.6.2 <URL:#tn=        11.6.2>
    11.7 Jira dashboards, tags: Jira dashboards <URL:#tn=    11.7 Jira dashboards, tags: Jira dashboards>
        11.7.1  team jira dashboard, , tags: team jira dashboard <URL:#tn=        11.7.1  team jira dashboard, , tags: team jira dashboard>
        11.7.2 <URL:#tn=        11.7.2>
    11.8 customer support FAQ, tags: customer support FAQ <URL:#tn=    11.8 customer support FAQ, tags: customer support FAQ>
        11.8.1   session timeout extension <URL:#tn=        11.8.1   session timeout extension>
            11.8.1.1   session timeout extension approval procedure <URL:#tn=            11.8.1.1   session timeout extension approval procedure>
            11.8.1.2 <URL:#tn=            11.8.1.2>
        11.8.2 <URL:#tn=        11.8.2>
    11.9 MENA customers, tags: MENA customers <URL:#tn=    11.9 MENA customers, tags: MENA customers>
    11.10 Jira, SNOW, tickets, customers, issues processes and best practices, tags: Jira, SNOW, tickets, customers, issues processes and best practices <URL:#tn=    11.10 Jira, SNOW, tickets, customers, issues processes and best practices, tags: Jira, SNOW, tickets, customers, issues processes and best practices>
        11.10.1  Process for SNOW tickets that were closed with a code fix, tags: Process for SNOW tickets that were closed with a code fix <URL:#tn=        11.10.1  Process for SNOW tickets that were closed with a code fix, tags: Process for SNOW tickets that were closed with a code fix>
            11.10.1.1 <URL:#tn=            11.10.1.1>
        11.10.2 <URL:#tn=        11.10.2>
    11.11 <URL:#tn=    11.11>
12. Development <URL:#tn=12. Development>
    12.1 Java, maven, maven dependencies <URL:#tn=    12.1 Java, maven, maven dependencies>
        12.1.1 dependencies <URL:#tn=        12.1.1 dependencies>
            12.1.1.1 check if updates are required <URL:#tn=            12.1.1.1 check if updates are required>
            12.1.1.2 update versions <URL:#tn=            12.1.1.2 update versions>
        12.1.2 <URL:#tn=        12.1.2>
    12.2 Node modules repositories nexus, artifactory etc, tags: Node modules repositories nexus <URL:#tn=    12.2 Node modules repositories nexus, artifactory etc, tags: Node modules repositories nexus>
        12.2.1 nexus <URL:#tn=        12.2.1 nexus>
            12.2.1.1 dependencies <URL:#tn=            12.2.1.1 dependencies>
        12.2.2 artifactory <URL:#tn=        12.2.2 artifactory>
        12.2.3 github get list of versions, tags: github get list of latest versions <URL:#tn=        12.2.3 github get list of versions, tags: github get list of latest versions>
        12.2.4 <URL:#tn=        12.2.4>
    12.3 <URL:#tn=    12.3>
13. Load testing <URL:#tn=13. Load testing>
    13.1 load testing 101 <URL:#tn=    13.1 load testing 101>
    13.2 load test basic course <URL:#tn=    13.2 load test basic course>
        13.2.1 https://wiki.wdf.sap.corp/wiki/display/+/Gatling+Automation+Environment <URL:#tn=        13.2.1 https://wiki.wdf.sap.corp/wiki/display/+/Gatling+Automation+Environment>
        13.2.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/exercise1/gatling/README.md <URL:#tn=        13.2.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/exercise1/gatling/README.md>
        13.2.3 <URL:#tn=        13.2.3>
    13.3 <URL:#tn=    13.3>
14. on call dev duty <URL:#tn=14. on call dev duty>
    14.1 general <URL:#tn=    14.1 general>
        14.1.1 daily checklist <URL:#tn=        14.1.1 daily checklist>
            14.1.1.1 dashboard https://dash.cfapps.sap.hana.ondemand.com/micro-services <URL:#tn=            14.1.1.1 dashboard https://dash.cfapps.sap.hana.ondemand.com/micro-services>
                14.1.1.1.1 dashboard architecture, tags: Dashboard architecture <URL:#tn=                14.1.1.1.1 dashboard architecture, tags: Dashboard architecture>
                    14.1.1.1.1.1 Main Backend Features <URL:#tn=                    14.1.1.1.1.1 Main Backend Features>
                    14.1.1.1.1.2 Main Front Features and Structure of the Dashboard <URL:#tn=                    14.1.1.1.1.2 Main Front Features and Structure of the Dashboard>
                    14.1.1.1.1.3 links <URL:#tn=                    14.1.1.1.1.3 links>
                    14.1.1.1.1.4 <URL:#tn=                    14.1.1.1.1.4>
                14.1.1.1.2 <URL:#tn=                14.1.1.1.2>
            14.1.1.2 bcp <URL:#tn=            14.1.1.2 bcp>
            14.1.1.3 SNOW <URL:#tn=            14.1.1.3 SNOW>
            14.1.1.4 <URL:#tn=            14.1.1.4>
        14.1.2 check note "Weekend CF duty" <URL:#tn=        14.1.2 check note "Weekend CF duty">
    14.2 KT wikis <URL:#tn=    14.2 KT wikis>
    14.3 <URL:#tn=    14.3>
15. Tools <URL:#tn=15. Tools>
    15.1 Loggy <URL:#tn=    15.1 Loggy>
        15.1.1 loggy git repo <URL:#tn=        15.1.1 loggy git repo>
        15.1.2 installation <URL:#tn=        15.1.2 installation>
            15.1.2.1  using venv <URL:#tn=            15.1.2.1  using venv>
            15.1.2.2 Installation <URL:#tn=            15.1.2.2 Installation>
        15.1.2 Common issues <URL:#tn=        15.1.2 Common issues>
            15.1.2.1 No module named loggy <URL:#tn=            15.1.2.1 No module named loggy>
            15.1.2.2  structure <URL:#tn=            15.1.2.2  structure>
            15.1.2.3 <URL:#tn=            15.1.2.3>
        15.1.3 test <URL:#tn=        15.1.3 test>
        15.1.4 backlog <URL:#tn=        15.1.4 backlog>
        15.1.5 <URL:#tn=        15.1.5>
    15.2 https://github.wdf.sap.corp/portal-cf-yosi-devs/cf_cli_automations <URL:#tn=    15.2 https://github.wdf.sap.corp/portal-cf-yosi-devs/cf_cli_automations>
        15.2.1 orphand resources cleanups <URL:#tn=        15.2.1 orphand resources cleanups>
    15.2.2 auto shutdown start all apps in space, Shutdown all applications on developers' provider spaces every night, tags: shutdown, start, automatic, applications, apps, space, developer <URL:#tn=    15.2.2 auto shutdown start all apps in space, Shutdown all applications on developers' provider spaces every night, tags: shutdown, start, automatic, applications, apps, space, developer>
        15.2.2.1 my script <URL:#tn=        15.2.2.1 my script>
        15.2.2.2 tigran script <URL:#tn=        15.2.2.2 tigran script>
        15.2.2.3 yaniv-peeri update <URL:#tn=        15.2.2.3 yaniv-peeri update>
        15.2.2.4 <URL:#tn=        15.2.2.4>
    15.3 <URL:#tn=    15.3>
16. Automation tests <URL:#tn=16. Automation tests>
    16.1 Puppeteer <URL:#tn=    16.1 Puppeteer>
        16.1.1 readme <URL:#tn=        16.1.1 readme>
        16.1.2 <URL:#tn=        16.1.2>
    16.2 <URL:#tn=    16.2>
17. yosi team management tags: yosi team management, syncs, Scrum-of-scrums, PO, manager <URL:#tn=17. yosi team management tags: yosi team management, syncs, Scrum-of-scrums, PO, manager>
    17.0 team <URL:#tn=    17.0 team>
        17.0.1 tags: team members, iusers, team members emails <URL:#tn=        17.0.1 tags: team members, iusers, team members emails>
        17.0.2 New employee <URL:#tn=        17.0.2 New employee>
        17.0.3 Past employees <URL:#tn=        17.0.3 Past employees>
        17.0.4 Team 1:1 meetings, tags: Team 1:1 meetings <URL:#tn=        17.0.4 Team 1:1 meetings, tags: Team 1:1 meetings>
            17.0.4.1  November 23-30 meetings, tags: November 23-30 meetings <URL:#tn=            17.0.4.1  November 23-30 meetings, tags: November 23-30 meetings>
                17.0.4.1.1  Hadar-Kobi <URL:#tn=                17.0.4.1.1  Hadar-Kobi>
                17.0.4.1.2 Gil-Shikva <URL:#tn=                17.0.4.1.2 Gil-Shikva>
                17.0.4.1.3 Shirly-Cohen <URL:#tn=                17.0.4.1.3 Shirly-Cohen>
                17.0.4.1.4 Alon-Manshari <URL:#tn=                17.0.4.1.4 Alon-Manshari>
                17.0.4.1.5 Yoav-Fried <URL:#tn=                17.0.4.1.5 Yoav-Fried>
                17.0.4.1.6 jawad-margieh <URL:#tn=                17.0.4.1.6 jawad-margieh>
                17.0.4.1.7 Kalman-Labinsky <URL:#tn=                17.0.4.1.7 Kalman-Labinsky>
                17.0.4.1.8 <URL:#tn=                17.0.4.1.8>
            17.0.4.2 <URL:#tn=            17.0.4.2>
        17.0.5 <URL:#tn=        17.0.5>
    17.1 team resources <URL:#tn=    17.1 team resources>
        17.1.1 capacity tags: capacity <URL:#tn=        17.1.1 capacity tags: capacity>
        17.1.2 takt timeliness, tags: takt timeliness, CF timeline QPA toolbox <URL:#tn=        17.1.2 takt timeliness, tags: takt timeliness, CF timeline QPA toolbox>
        17.1.3 duty Roster <URL:#tn=        17.1.3 duty Roster>
        17.1.4 RCA wikis <URL:#tn=        17.1.4 RCA wikis>
            17.1.4.1 RCA examples <URL:#tn=            17.1.4.1 RCA examples>
            17.1.4.2 team RCA wiki <URL:#tn=            17.1.4.2 team RCA wiki>
            17.1.4.3 <URL:#tn=            17.1.4.3>
        17.1.5 Team kanban board , tags: Team kanban board <URL:#tn=        17.1.5 Team kanban board , tags: Team kanban board>
        17.1.6 <URL:#tn=        17.1.6>
    17.2 Recruitment <URL:#tn=    17.2 Recruitment>
        17.2.1 interviewing candidates <URL:#tn=        17.2.1 interviewing candidates>
        17.2.2 New employee resources <URL:#tn=        17.2.2 New employee resources>
        17.2.3 Support Engineer's onboarding <URL:#tn=        17.2.3 Support Engineer's onboarding>
        17.2.4 New team engineer member onboarding process, tags: New team engineer member onboarding process <URL:#tn=        17.2.4 New team engineer member onboarding process, tags: New team engineer member onboarding process>
            17.2.4.1 overall procedure <URL:#tn=            17.2.4.1 overall procedure>
            17.2.4.2 resources <URL:#tn=            17.2.4.2 resources>
            17.2.4.3 roadmap <URL:#tn=            17.2.4.3 roadmap>
            17.2.4.4 <URL:#tn=            17.2.4.4>
        17.2.5 <URL:#tn=        17.2.5>
    17.3 Git <URL:#tn=    17.3 Git>
        17.3.1 git teams <URL:#tn=        17.3.1 git teams>
        17.3.2 CODEOWNERS <URL:#tn=        17.3.2 CODEOWNERS>
        17.3.3 <URL:#tn=        17.3.3>
    17.4 steering and execution sync <URL:#tn=    17.4 steering and execution sync>
    17.5 My Vacation days <URL:#tn=    17.5 My Vacation days>
    17.6 distribution lists <URL:#tn=    17.6 distribution lists>
        17.6.1 SAP outlook DLs <URL:#tn=        17.6.1 SAP outlook DLs>
            17.6.1.1 Design review DLs, tags: Design review DLs <URL:#tn=            17.6.1.1 Design review DLs, tags: Design review DLs>
            17.6.1.2 Review MoM + Signoffs <URL:#tn=            17.6.1.2 Review MoM + Signoffs>
            17.6.1.3 Scrum Masters DL, tags: Scrum Masters DL <URL:#tn=            17.6.1.3 Scrum Masters DL, tags: Scrum Masters DL>
            17.6.1.4 Design reviewers DL , tags: Design reviewers DL <URL:#tn=            17.6.1.4 Design reviewers DL , tags: Design reviewers DL>
            17.6.1.4  When subbing as SM. Notify this distribution of vacations. tags: substitute, sick, OOO, SM, ScM, Scrum-Master, replacement, DLs, oneliner <URL:#tn=            17.6.1.4  When subbing as SM. Notify this distribution of vacations. tags: substitute, sick, OOO, SM, ScM, Scrum-Master, replacement, DLs, oneliner>
                17.6.1.4.1  big audience <URL:#tn=                17.6.1.4.1  big audience>
                17.6.1.4.2 Smaller audience one liner <URL:#tn=                17.6.1.4.2 Smaller audience one liner>
                17.6.1.4.3 Message examples <URL:#tn=                17.6.1.4.3 Message examples>
                    17.6.1.4.3.1 vacation <URL:#tn=                    17.6.1.4.3.1 vacation>
                    17.6.1.4.3.2 sick leave <URL:#tn=                    17.6.1.4.3.2 sick leave>
                    17.6.1.4.3.3 long vacation <URL:#tn=                    17.6.1.4.3.3 long vacation>
                17.6.1.4.4 Additional steps <URL:#tn=                17.6.1.4.4 Additional steps>
                17.6.1.4.5 important DLs , tags: important DLs <URL:#tn=                17.6.1.4.5 important DLs , tags: important DLs>
        17.6.2 manage my distribution lists, tags: manage my distribution lists, delegated DLs, Owned DLs <URL:#tn=        17.6.2 manage my distribution lists, tags: manage my distribution lists, delegated DLs, Owned DLs>
        17.6.3 Scrum rituals emails - alignment <URL:#tn=        17.6.3 Scrum rituals emails - alignment>
        17.6.5 DL CDM Schema Reviewers (External), tags: DL CDM Schema Reviewers (External) <URL:#tn=        17.6.5 DL CDM Schema Reviewers (External), tags: DL CDM Schema Reviewers (External)>
        17.6.6  Ilan's group <URL:#tn=        17.6.6  Ilan's group>
        17.6.7 <URL:#tn=        17.6.7>
    17.7 tags: team repositories, services, code base <URL:#tn=    17.7 tags: team repositories, services, code base>
        17.7.1 unified list <URL:#tn=        17.7.1 unified list>
        17.7.1 Shany team repositories <URL:#tn=        17.7.1 Shany team repositories>
        17.7.2 Adoram, Nili <nili.adoram@sap.com> repositories <URL:#tn=        17.7.2 Adoram, Nili <nili.adoram@sap.com> repositories>
        17.7.3 Sergey repositories <URL:#tn=        17.7.3 Sergey repositories>
        17.7.4 <URL:#tn=        17.7.4>
    17.8 wiki pages, tags: team wiki pages automtions designs, knowledge-base <URL:#tn=    17.8 wiki pages, tags: team wiki pages automtions designs, knowledge-base>
        17.8.1 Design-Documents <URL:#tn=        17.8.1 Design-Documents>
        17.8.2 technical knowledge-base <URL:#tn=        17.8.2 technical knowledge-base>
        17.8.3 team automation <URL:#tn=        17.8.3 team automation>
            17.8.3.1 DTS Automations <URL:#tn=            17.8.3.1 DTS Automations>
            17.8.3.2 Import Export Automations <URL:#tn=            17.8.3.2 Import Export Automations>
        17.8.4 <URL:#tn=        17.8.4>
    17.9 Scrum-masters forum <URL:#tn=    17.9 Scrum-masters forum>
        17.9.1  Teams Scrum-masters forum agenda <URL:#tn=        17.9.1  Teams Scrum-masters forum agenda>
        17.9.2 <URL:#tn=        17.9.2>
    17.10 1:1 Meni, tags: 1:1 Meni <URL:#tn=    17.10 1:1 Meni, tags: 1:1 Meni>
        17.10.1 01/2022 <URL:#tn=        17.10.1 01/2022>
        17.10.2 Thu Feb 17 17:57:38 IST 2022 <URL:#tn=        17.10.2 Thu Feb 17 17:57:38 IST 2022>
        17.10.3 Thu Mar 24 17:33:04 IST 2022 <URL:#tn=        17.10.3 Thu Mar 24 17:33:04 IST 2022>
        17.10.4, 1:1 Meni 06/04/22 16:36:43 <URL:#tn=        17.10.4, 1:1 Meni 06/04/22 16:36:43>
        17.10.5, tags topics 1:1 <URL:#tn=        17.10.5, tags topics 1:1>
        17.10.6, tags topics 1:1 Meni Wed Apr 20 11:21:50 IDT 2022 <URL:#tn=        17.10.6, tags topics 1:1 Meni Wed Apr 20 11:21:50 IDT 2022>
        17.10.7 06/07/22 13:32:46 <URL:#tn=        17.10.7 06/07/22 13:32:46>
        17.10.8 14.7 14.7 <URL:#tn=        17.10.8 14.7 14.7>
        17.10.9 18/08/22 17:40:17 <URL:#tn=        17.10.9 18/08/22 17:40:17>
        17.10.10 13/09/22 11:33:12 <URL:#tn=        17.10.10 13/09/22 11:33:12>
        17.10.11 1:1 with Meni 03/11/22 14:56:50 <URL:#tn=        17.10.11 1:1 with Meni 03/11/22 14:56:50>
        17.10.12 29/01/23 13:03:26 <URL:#tn=        17.10.12 29/01/23 13:03:26>
        17.10.13 20/02 <URL:#tn=        17.10.13 20/02>
        17.10.14 03/04/23 12:38:39 <URL:#tn=        17.10.14 03/04/23 12:38:39>
        17.10.15 10/04/23 17:32:24 <URL:#tn=        17.10.15 10/04/23 17:32:24>
        17.10.16 17/05/23 15:40:21 <URL:#tn=        17.10.16 17/05/23 15:40:21>
        17.10.17  25/05/23 15:44:39 <URL:#tn=        17.10.17  25/05/23 15:44:39>
        17.10.18  05/06/23 15:45:04 <URL:#tn=        17.10.18  05/06/23 15:45:04>
        17.10.19 10/07/23 15:06:11 <URL:#tn=        17.10.19 10/07/23 15:06:11>
        17.10.20 18/07/23 11:29:49 <URL:#tn=        17.10.20 18/07/23 11:29:49>
        17.10.21 14/08/23 14:47:54 <URL:#tn=        17.10.21 14/08/23 14:47:54>
        17.10.22 21/08/23 15:35:48 <URL:#tn=        17.10.22 21/08/23 15:35:48>
        17.10.23 <URL:#tn=        17.10.23>
        17.10.24 26/09/23 12:30:47 <URL:#tn=        17.10.24 26/09/23 12:30:47>
        17.10.25 26.10.23 <URL:#tn=        17.10.25 26.10.23>
        17.10.26 22/11/23 12:38:05 <URL:#tn=        17.10.26 22/11/23 12:38:05>
        17.10.27 04/12/23 10:06:02 <URL:#tn=        17.10.27 04/12/23 10:06:02>
        17.10.28 25/12/23 16:11:07 <URL:#tn=        17.10.28 25/12/23 16:11:07>
        17.10.29 01/01/24 15:40:27 <URL:#tn=        17.10.29 01/01/24 15:40:27>
        17.10.30 08/01/24 15:35:15 <URL:#tn=        17.10.30 08/01/24 15:35:15>
        17.10.31 15/01/24 15:31:12 <URL:#tn=        17.10.31 15/01/24 15:31:12>
        17.10.32 28/01/24 11:31:17 <URL:#tn=        17.10.32 28/01/24 11:31:17>
        17.10.33 05/02/24 15:05:08 <URL:#tn=        17.10.33 05/02/24 15:05:08>
        17.10.35 19/02 <URL:#tn=        17.10.35 19/02>
        17.10.36 04/03/24 <URL:#tn=        17.10.36 04/03/24>
        17.10.37 11/03/24 <URL:#tn=        17.10.37 11/03/24>
        17.10.38 21/03/24 12:07:17 <URL:#tn=        17.10.38 21/03/24 12:07:17>
        17.10.39 27/05/24 13:36:04 <URL:#tn=        17.10.39 27/05/24 13:36:04>
        17.10.40 18/07/24 16:02:36 <URL:#tn=        17.10.40 18/07/24 16:02:36>
        17.10.41 26/08/24 14:16:13 <URL:#tn=        17.10.41 26/08/24 14:16:13>
        17.10.42 12/11/24 14:38:03 <URL:#tn=        17.10.42 12/11/24 14:38:03>
        17.10.43 20/01/25 16:08:30 <URL:#tn=        17.10.43 20/01/25 16:08:30>
        17.10.44 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.44 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.45  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.45  topics next 1:1, tags: tags topics next 1:1>
        17.10.46  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.46  topics next 1:1, tags: tags topics next 1:1>
        17.10.47  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.47  topics next 1:1, tags: tags topics next 1:1>
        17.10.48  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.48  topics next 1:1, tags: tags topics next 1:1>
        17.10.49  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.49  topics next 1:1, tags: tags topics next 1:1>
        17.10.50  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.50  topics next 1:1, tags: tags topics next 1:1>
        17.10.51  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.51  topics next 1:1, tags: tags topics next 1:1>
        17.10.52  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.52  topics next 1:1, tags: tags topics next 1:1>
        17.10.53  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.53  topics next 1:1, tags: tags topics next 1:1>
        17.10.54  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.54  topics next 1:1, tags: tags topics next 1:1>
        17.10.55  topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.55  topics next 1:1, tags: tags topics next 1:1>
        17.10.56  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.56  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.57  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.57  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.58  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.58  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.59  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.59  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.60  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.60  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.61  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.61  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.62  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.62  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.63  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.63  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.64  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.64  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.65  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.65  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.66  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.66  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.67  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.67  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.68  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.68  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.69  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.69  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.70  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.70  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.71  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.71  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.72  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.72  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.73  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.73  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.74  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.74  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.75  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.75  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.76  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.76  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.77  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.77  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.78  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.78  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.79  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.79  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.80  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.80  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.81  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.81  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.82  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.82  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.83  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.83  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.84  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.84  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.85  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.85  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.86  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.86  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.87  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.87  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.88  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.88  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.89  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.89  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.90  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.90  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.91  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.91  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.92  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.92  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.93  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.93  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.94  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.94  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.95  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.95  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.96  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.96  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.97  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.97  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.98  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.98  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.99  tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.99  tags topics next 1:1, tags: tags topics next 1:1>
        17.10.100 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.100 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.101 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.101 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.102 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.102 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.103 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.103 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.104 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.104 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.105 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.105 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.106 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.106 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.107 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.107 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.108 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.108 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.109 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.109 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.110 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.110 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.111 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.111 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.112 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.112 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.113 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.113 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.114 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.114 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.115 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.115 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.116 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.116 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.117 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.117 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.118 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.118 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.119 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.119 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.120 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.120 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.121 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.121 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.122 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.122 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.123 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.123 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.124 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.124 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.125 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.125 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.126 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.126 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.127 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.127 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.128 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.128 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.129 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.129 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.130 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.130 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.131 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.131 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.132 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.132 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.133 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.133 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.134 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.134 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.135 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.135 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.136 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.136 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.137 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.137 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.138 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.138 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.139 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.139 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.140 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.140 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.141 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.141 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.142 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.142 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.143 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.143 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.144 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.144 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.145 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.145 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.146 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.146 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.147 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.147 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.148 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.148 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.149 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.149 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.150 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.150 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.151 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.151 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.152 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.152 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.153 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.153 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.154 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.154 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.155 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.155 tags topics next 1:1, tags: tags topics next 1:1>
        17.10.156 tags topics next 1:1, tags: tags topics next 1:1 <URL:#tn=        17.10.156 tags topics next 1:1, tags: tags topics next 1:1>
    17.11 Templates <URL:#tn=    17.11 Templates>
        17.11.1 Meeting invite <URL:#tn=        17.11.1 Meeting invite>
        17.11.2 <URL:#tn=        17.11.2>
    17.12 important meetings <URL:#tn=    17.12 important meetings>
        17.12.1 scrum best practices <URL:#tn=        17.12.1 scrum best practices>
    17.13 CAM profiles <URL:#tn=    17.13 CAM profiles>
        17.13.1 git developers profiles <URL:#tn=        17.13.1 git developers profiles>
        17.13.2 <URL:#tn=        17.13.2>
    17.14 appreciation, tags: appreciation, rewards <URL:#tn=    17.14 appreciation, tags: appreciation, rewards>
        17.14.1  list of appreciated team members <URL:#tn=        17.14.1  list of appreciated team members>
        17.14.2 <URL:#tn=        17.14.2>
    17.15 Team sergey <URL:#tn=    17.15 Team sergey>
    17.16 tags: developers cost reductions <URL:#tn=    17.16 tags: developers cost reductions>
        17.16.1 06.2022 cost-reduction <URL:#tn=        17.16.1 06.2022 cost-reduction>
            17.16.1.1 email to team <URL:#tn=            17.16.1.1 email to team>
            17.16.1.2 Shani delete space script <URL:#tn=            17.16.1.2 Shani delete space script>
                17.16.1.2.1 readme <URL:#tn=                17.16.1.2.1 readme>
                    17.16.1.2.1.1 intro <URL:#tn=                    17.16.1.2.1.1 intro>
                    17.16.1.2.1.2 requirements <URL:#tn=                    17.16.1.2.1.2 requirements>
                    17.16.1.2.1.3 installation <URL:#tn=                    17.16.1.2.1.3 installation>
                    17.16.1.2.1.4 Delete space <URL:#tn=                    17.16.1.2.1.4 Delete space>
                    17.16.1.2.1.5 <URL:#tn=                    17.16.1.2.1.5>
                17.16.1.2.2 cf cli version swiching <URL:#tn=                17.16.1.2.2 cf cli version swiching>
                17.16.1.2.3 <URL:#tn=                17.16.1.2.3>
            17.16.1.3 <URL:#tn=            17.16.1.3>
        17.16.2 <URL:#tn=        17.16.2>
    17.17 Ariel-Guy synchs, Tags: Ariel-Guy synchs <URL:#tn=    17.17 Ariel-Guy synchs, Tags: Ariel-Guy synchs>
        17.17.1 19/09/22 11:34:06 <URL:#tn=        17.17.1 19/09/22 11:34:06>
        17.17.2 13/12/22 15:32:32 <URL:#tn=        17.17.2 13/12/22 15:32:32>
        17.17.3 sync 28/12/22 15:34:56 <URL:#tn=        17.17.3 sync 28/12/22 15:34:56>
        17.17.4 14/03/23 16:48:42 <URL:#tn=        17.17.4 14/03/23 16:48:42>
        17.17.5  18/04/23 15:24:25 <URL:#tn=        17.17.5  18/04/23 15:24:25>
        17.17.6  02/05/23 17:12:45 <URL:#tn=        17.17.6  02/05/23 17:12:45>
        17.17.7 1.6 <URL:#tn=        17.17.7 1.6>
        17.17.8 12/07/23 14:39:38 <URL:#tn=        17.17.8 12/07/23 14:39:38>
        17.17.9 22/08/23 14:49:19 <URL:#tn=        17.17.9 22/08/23 14:49:19>
        17.17.10 19/09/23 15:31:42 <URL:#tn=        17.17.10 19/09/23 15:31:42>
        17.17.12 03/10/23 15:39:19 <URL:#tn=        17.17.12 03/10/23 15:39:19>
        17.17.13 10/10/23 15:43:40 <URL:#tn=        17.17.13 10/10/23 15:43:40>
        17.17.14 12/10/23 15:46:59 <URL:#tn=        17.17.14 12/10/23 15:46:59>
        17.17.15 24/10/23 15:52:00 <URL:#tn=        17.17.15 24/10/23 15:52:00>
        17.17.16 31/10/23 15:34:09 <URL:#tn=        17.17.16 31/10/23 15:34:09>
        17.17.17  14/11/23 14:32:32 <URL:#tn=        17.17.17  14/11/23 14:32:32>
        17.17.18 21/11/23 15:27:52 <URL:#tn=        17.17.18 21/11/23 15:27:52>
        17.17.19 27/12/23 16:06:01 <URL:#tn=        17.17.19 27/12/23 16:06:01>
        17.17.20 07/01/24 11:28:29 <URL:#tn=        17.17.20 07/01/24 11:28:29>
        17.17.21 10/01/24 16:37:22 <URL:#tn=        17.17.21 10/01/24 16:37:22>
        17.17.22 24/01/24 17:00:37 <URL:#tn=        17.17.22 24/01/24 17:00:37>
        17.17.23 28/02/24 16:41:06 <URL:#tn=        17.17.23 28/02/24 16:41:06>
        17.17.24 06/03/24 16:59:54 <URL:#tn=        17.17.24 06/03/24 16:59:54>
        17.17.25 27/03/24 16:51:48 <URL:#tn=        17.17.25 27/03/24 16:51:48>
        17.17.26 next, , tags: ariel, next <URL:#tn=        17.17.26 next, , tags: ariel, next>
        17.17.27 next, , tags: ariel, next <URL:#tn=        17.17.27 next, , tags: ariel, next>
        17.17.28 next, , tags: ariel, next <URL:#tn=        17.17.28 next, , tags: ariel, next>
        17.17.29 next, , tags: ariel, next <URL:#tn=        17.17.29 next, , tags: ariel, next>
        17.17.30 next, , tags: ariel, next <URL:#tn=        17.17.30 next, , tags: ariel, next>
        17.17.31 next, , tags: ariel, next <URL:#tn=        17.17.31 next, , tags: ariel, next>
        17.17.32 next, , tags: ariel, next <URL:#tn=        17.17.32 next, , tags: ariel, next>
        17.17.33 next, , tags: ariel, next <URL:#tn=        17.17.33 next, , tags: ariel, next>
        17.17.34 next, , tags: ariel, next <URL:#tn=        17.17.34 next, , tags: ariel, next>
        17.17.35 next, , tags: ariel, next <URL:#tn=        17.17.35 next, , tags: ariel, next>
        17.17.36 next, , tags: ariel, next <URL:#tn=        17.17.36 next, , tags: ariel, next>
        17.17.37 next, , tags: ariel, next <URL:#tn=        17.17.37 next, , tags: ariel, next>
        17.17.38 next, , tags: ariel, next <URL:#tn=        17.17.38 next, , tags: ariel, next>
        17.17.39 next, , tags: ariel, next <URL:#tn=        17.17.39 next, , tags: ariel, next>
        17.17.40 next, , tags: ariel, next <URL:#tn=        17.17.40 next, , tags: ariel, next>
        17.17.41 next, , tags: ariel, next <URL:#tn=        17.17.41 next, , tags: ariel, next>
    17.18 Jira , tags: jira, permissions <URL:#tn=    17.18 Jira , tags: jira, permissions>
        17.17.10 06/09/23 15:58:36 <URL:#tn=        17.17.10 06/09/23 15:58:36>
        17.18.1 give permissions to jira for developers <URL:#tn=        17.18.1 give permissions to jira for developers>
    17.19 recognition <URL:#tn=    17.19 recognition>
        17.19.1 20/09/22 15:21:26  group meeting <URL:#tn=        17.19.1 20/09/22 15:21:26  group meeting>
        17.19.2 2023 EoY recognition, tags: 2023 EoY recognition <URL:#tn=        17.19.2 2023 EoY recognition, tags: 2023 EoY recognition>
        17.19.3 <URL:#tn=        17.19.3>
    17.20 Core meetings <URL:#tn=    17.20 Core meetings>
        17.20.1 Topics for next core meeting <URL:#tn=        17.20.1 Topics for next core meeting>
        17.20.2 <URL:#tn=        17.20.2>
    17.21 Scrum-of-scrums tags: Scrum-of-scrums topics, scrum masters <URL:#tn=    17.21 Scrum-of-scrums tags: Scrum-of-scrums topics, scrum masters>
        17.21.1 30/01/23 16:08:25 <URL:#tn=        17.21.1 30/01/23 16:08:25>
        17.21.2 31/01/23 14:03:08 <URL:#tn=        17.21.2 31/01/23 14:03:08>
        17.21.3 14.2 <URL:#tn=        17.21.3 14.2>
        17.21.4 14/03/23 12:18:45 <URL:#tn=        17.21.4 14/03/23 12:18:45>
        17.21.5 06/06/23 13:47:36 <URL:#tn=        17.21.5 06/06/23 13:47:36>
        17.21.6 next Scrum-of-scrums topics, tags: next Scrum-of-scrums topics <URL:#tn=        17.21.6 next Scrum-of-scrums topics, tags: next Scrum-of-scrums topics>
        17.21.7 <URL:#tn=        17.21.7>
    17.22 EoY, end of year, yearly feedback review team members, tags: EoY, end of year, yearly feedback review assess team members <URL:#tn=    17.22 EoY, end of year, yearly feedback review team members, tags: EoY, end of year, yearly feedback review assess team members>
        17.22.3 EoY feedback template tags: EoY, end of year, yearly feedback review team members Template: <URL:#tn=        17.22.3 EoY feedback template tags: EoY, end of year, yearly feedback review team members Template:>
            17.22.3.1 Yosi <URL:#tn=            17.22.3.1 Yosi>
            17.22.3.2 Kalman <URL:#tn=            17.22.3.2 Kalman>
            17.22.3.3 Yoav <URL:#tn=            17.22.3.3 Yoav>
            17.22.3.4 Shirly <URL:#tn=            17.22.3.4 Shirly>
            17.22.3.5 Gil <URL:#tn=            17.22.3.5 Gil>
            17.22.3.6 Jawad <URL:#tn=            17.22.3.6 Jawad>
            17.22.3.7 Hadar <URL:#tn=            17.22.3.7 Hadar>
            17.22.3.8 Alon <URL:#tn=            17.22.3.8 Alon>
        17.22.0  2021 feedback <URL:#tn=        17.22.0  2021 feedback>
        17.22.1 2022 <URL:#tn=        17.22.1 2022>
            17.22.1.1 self yearly feedback <URL:#tn=            17.22.1.1 self yearly feedback>
            17.22.1.2 team yearly feedback <URL:#tn=            17.22.1.2 team yearly feedback>
                17.22.1.2.1 Kalman <URL:#tn=                17.22.1.2.1 Kalman>
                17.22.1.2.2 Yoav <URL:#tn=                17.22.1.2.2 Yoav>
                17.22.1.2.3 Shirly <URL:#tn=                17.22.1.2.3 Shirly>
                17.22.1.2.4 Gil <URL:#tn=                17.22.1.2.4 Gil>
                17.22.1.2.5 Jawad <URL:#tn=                17.22.1.2.5 Jawad>
                17.22.1.2.6 Hadar <URL:#tn=                17.22.1.2.6 Hadar>
                17.22.1.2.7 <URL:#tn=                17.22.1.2.7>
            17.22.1.3 <URL:#tn=            17.22.1.3>
            17.22.2.1  Yoav <URL:#tn=            17.22.2.1  Yoav>
            17.22.2.2 <URL:#tn=            17.22.2.2>
        17.22.2 2023 <URL:#tn=        17.22.2 2023>
            17.22.2.1 Yosi <URL:#tn=            17.22.2.1 Yosi>
            17.22.2.2 Kalman <URL:#tn=            17.22.2.2 Kalman>
            17.22.2.3 Yoav <URL:#tn=            17.22.2.3 Yoav>
            17.22.2.4 Shirly <URL:#tn=            17.22.2.4 Shirly>
            17.22.2.5 Gil <URL:#tn=            17.22.2.5 Gil>
            17.22.2.6 Jawad <URL:#tn=            17.22.2.6 Jawad>
            17.22.2.7 Hadar <URL:#tn=            17.22.2.7 Hadar>
            17.22.2.8 Alon <URL:#tn=            17.22.2.8 Alon>
        17.22.3 2024  EOY Reviews, tags: 2024  EOY Reviews <URL:#tn=        17.22.3 2024  EOY Reviews, tags: 2024  EOY Reviews>
            17.22.3.1 Yosi <URL:#tn=            17.22.3.1 Yosi>
            17.22.3.2 Kalman <URL:#tn=            17.22.3.2 Kalman>
            17.22.3.3 Yoav <URL:#tn=            17.22.3.3 Yoav>
            17.22.3.4 Shirly <URL:#tn=            17.22.3.4 Shirly>
            17.22.3.5 Gil <URL:#tn=            17.22.3.5 Gil>
            17.22.3.6 Jawad <URL:#tn=            17.22.3.6 Jawad>
            17.22.3.7 Hadar <URL:#tn=            17.22.3.7 Hadar>
02.07 She had a complete meltdown over something she perceived as not ok by me (there was a high priority issue she was working on and I tried to call her to get her status but she was not answering, later she admitted she didn't answer on purpose). She then sent me extremely inappropriate and offensive whatsapp messages. <URL:#tn=02.07 She had a complete meltdown over something she perceived as not ok by me (there was a high priority issue she was working on and I tried to call her to get her status but she was not answering, later she admitted she didn't answer on purpose). She then sent me extremely inappropriate and offensive whatsapp messages.>
            17.22.3.8 Alon <URL:#tn=            17.22.3.8 Alon>
        17.22.4 2025 EoY feedback, tags: 2025 EoY feedback <URL:#tn=        17.22.4 2025 EoY feedback, tags: 2025 EoY feedback>
            17.22.4.1 Yosi <URL:#tn=            17.22.4.1 Yosi>
            17.22.4.2 Kalman <URL:#tn=            17.22.4.2 Kalman>
            17.22.4.3 Yoav <URL:#tn=            17.22.4.3 Yoav>
            17.22.4.4 Shirly <URL:#tn=            17.22.4.4 Shirly>
            17.22.4.5 Gil <URL:#tn=            17.22.4.5 Gil>
            17.22.4.6 Jawad <URL:#tn=            17.22.4.6 Jawad>
            17.22.4.7 Hadar <URL:#tn=            17.22.4.7 Hadar>
            17.22.4.8 Alon <URL:#tn=            17.22.4.8 Alon>
        17.22.5 2026 EoY feedback, tags: 2026 EoY feedback <URL:#tn=        17.22.5 2026 EoY feedback, tags: 2026 EoY feedback>
    17.23 Ilan and the Scrum-masters, tags:Ilan and the Scrum-masters <URL:#tn=    17.23 Ilan and the Scrum-masters, tags:Ilan and the Scrum-masters>
        17.23.1 09/05/23 14:25:10 <URL:#tn=        17.23.1 09/05/23 14:25:10>
        17.23.2 29/08/23 14:37:57 <URL:#tn=        17.23.2 29/08/23 14:37:57>
        17.23.3 next meeting, tags: Ilan and the Scrum-masters next meeting <URL:#tn=        17.23.3 next meeting, tags: Ilan and the Scrum-masters next meeting>
        17.23.4 <URL:#tn=        17.23.4>
    17.24 Send dev on duty meetings, tags:Send dev on duty meetings, <URL:#tn=    17.24 Send dev on duty meetings, tags:Send dev on duty meetings,>
        17.24.1 create a new meeting <URL:#tn=        17.24.1 create a new meeting>
    17.25 sap appreciation gifts , tags: sap appreciation gifts <URL:#tn=    17.25 sap appreciation gifts , tags: sap appreciation gifts>
        17.25.1 app link <URL:#tn=        17.25.1 app link>
        17.25.2 sap appreciation gifts  log, tags: sap appreciation gifts  log <URL:#tn=        17.25.2 sap appreciation gifts  log, tags: sap appreciation gifts  log>
    17.26 QPE, Olga-Avrahami, sync tags: QPE Olga-Avrahami, sync <URL:#tn=    17.26 QPE, Olga-Avrahami, sync tags: QPE Olga-Avrahami, sync>
        17.26.1  QPE, Olga-Avrahami,next sync tags: QPE Olga-Avrahami, next sync <URL:#tn=        17.26.1  QPE, Olga-Avrahami,next sync tags: QPE Olga-Avrahami, next sync>
        17.26.2 <URL:#tn=        17.26.2>
    17.27 Support-Engineer, Shani-Shorer  sync tags: Support-Engineer, Shani-Shorer  sync <URL:#tn=    17.27 Support-Engineer, Shani-Shorer  sync tags: Support-Engineer, Shani-Shorer  sync>
        17.27.1 Support-Engineer, Shani-Shorer  next sync tags: Support-Engineer, Shani-Shorer  next sync <URL:#tn=        17.27.1 Support-Engineer, Shani-Shorer  next sync tags: Support-Engineer, Shani-Shorer  next sync>
        17.27.2 <URL:#tn=        17.27.2>
    17.28 Signoff,  tags: Signoff <URL:#tn=    17.28 Signoff,  tags: Signoff>
        17.28.1 signoff process, tags: signoff process <URL:#tn=        17.28.1 signoff process, tags: signoff process>
        17.28.2 <URL:#tn=        17.28.2>
    17.29 Code contribution, tags: Code contribution <URL:#tn=    17.29 Code contribution, tags: Code contribution>
        17.29.1 guidelines wiki <URL:#tn=        17.29.1 guidelines wiki>
    17.30 important emails and messages, tags: important emails and messages <URL:#tn=    17.30 important emails and messages, tags: important emails and messages>
        17.30.1  my Scrum-Master appointment, tags: my Scrum-Master appointment <URL:#tn=        17.30.1  my Scrum-Master appointment, tags: my Scrum-Master appointment>
        17.30.2 <URL:#tn=        17.30.2>
    17.31 meni team management meetings 06/03/24 14:09:13 <URL:#tn=    17.31 meni team management meetings 06/03/24 14:09:13>
        17.31.1   06/04 <URL:#tn=        17.31.1   06/04>
        17.31.2   10/06/24 17:34:14 <URL:#tn=        17.31.2   10/06/24 17:34:14>
        17.31.3   Meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.3   Meni team management meetings next , tags: meni team management meetings next>
        17.31.4   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.4   meni team management meetings next , tags: meni team management meetings next>
        17.31.5   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.5   meni team management meetings next , tags: meni team management meetings next>
        17.31.6   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.6   meni team management meetings next , tags: meni team management meetings next>
        17.31.7   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.7   meni team management meetings next , tags: meni team management meetings next>
        17.31.8   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.8   meni team management meetings next , tags: meni team management meetings next>
        17.31.9   meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.9   meni team management meetings next , tags: meni team management meetings next>
        17.31.10  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.10  meni team management meetings next , tags: meni team management meetings next>
        17.31.11  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.11  meni team management meetings next , tags: meni team management meetings next>
        17.31.12  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.12  meni team management meetings next , tags: meni team management meetings next>
        17.31.13  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.13  meni team management meetings next , tags: meni team management meetings next>
        17.31.14  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.14  meni team management meetings next , tags: meni team management meetings next>
        17.31.15  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.15  meni team management meetings next , tags: meni team management meetings next>
        17.31.16  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.16  meni team management meetings next , tags: meni team management meetings next>
        17.31.17  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.17  meni team management meetings next , tags: meni team management meetings next>
        17.31.18  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.18  meni team management meetings next , tags: meni team management meetings next>
        17.31.19  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.19  meni team management meetings next , tags: meni team management meetings next>
        17.31.20  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.20  meni team management meetings next , tags: meni team management meetings next>
        17.31.21  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.21  meni team management meetings next , tags: meni team management meetings next>
        17.31.22  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.22  meni team management meetings next , tags: meni team management meetings next>
        17.31.23  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.23  meni team management meetings next , tags: meni team management meetings next>
        17.31.24  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.24  meni team management meetings next , tags: meni team management meetings next>
        17.31.25  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.25  meni team management meetings next , tags: meni team management meetings next>
        17.31.26  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.26  meni team management meetings next , tags: meni team management meetings next>
        17.31.27  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.27  meni team management meetings next , tags: meni team management meetings next>
        17.31.28  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.28  meni team management meetings next , tags: meni team management meetings next>
        17.31.29  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.29  meni team management meetings next , tags: meni team management meetings next>
        17.31.30  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.30  meni team management meetings next , tags: meni team management meetings next>
        17.31.31  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.31  meni team management meetings next , tags: meni team management meetings next>
        17.31.32  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.32  meni team management meetings next , tags: meni team management meetings next>
        17.31.33  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.33  meni team management meetings next , tags: meni team management meetings next>
        17.31.34  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.34  meni team management meetings next , tags: meni team management meetings next>
        17.31.35  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.35  meni team management meetings next , tags: meni team management meetings next>
        17.31.36  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.36  meni team management meetings next , tags: meni team management meetings next>
        17.31.37  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.37  meni team management meetings next , tags: meni team management meetings next>
        17.31.38  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.38  meni team management meetings next , tags: meni team management meetings next>
        17.31.39  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.39  meni team management meetings next , tags: meni team management meetings next>
        17.31.40  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.40  meni team management meetings next , tags: meni team management meetings next>
        17.31.41  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.41  meni team management meetings next , tags: meni team management meetings next>
        17.31.42  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.42  meni team management meetings next , tags: meni team management meetings next>
        17.31.43  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.43  meni team management meetings next , tags: meni team management meetings next>
        17.31.44  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.44  meni team management meetings next , tags: meni team management meetings next>
        17.31.45  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.45  meni team management meetings next , tags: meni team management meetings next>
        17.31.46  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.46  meni team management meetings next , tags: meni team management meetings next>
        17.31.47  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.47  meni team management meetings next , tags: meni team management meetings next>
        17.31.48  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.48  meni team management meetings next , tags: meni team management meetings next>
        17.31.49  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.49  meni team management meetings next , tags: meni team management meetings next>
        17.31.50  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.50  meni team management meetings next , tags: meni team management meetings next>
        17.31.51  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.51  meni team management meetings next , tags: meni team management meetings next>
        17.31.52  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.52  meni team management meetings next , tags: meni team management meetings next>
        17.31.53  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.53  meni team management meetings next , tags: meni team management meetings next>
        17.31.54  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.54  meni team management meetings next , tags: meni team management meetings next>
        17.31.55  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.55  meni team management meetings next , tags: meni team management meetings next>
        17.31.56  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.56  meni team management meetings next , tags: meni team management meetings next>
        17.31.57  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.57  meni team management meetings next , tags: meni team management meetings next>
        17.31.58  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.58  meni team management meetings next , tags: meni team management meetings next>
        17.31.59  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.59  meni team management meetings next , tags: meni team management meetings next>
        17.31.60  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.60  meni team management meetings next , tags: meni team management meetings next>
        17.31.61  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.61  meni team management meetings next , tags: meni team management meetings next>
        17.31.62  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.62  meni team management meetings next , tags: meni team management meetings next>
        17.31.63  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.63  meni team management meetings next , tags: meni team management meetings next>
        17.31.64  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.64  meni team management meetings next , tags: meni team management meetings next>
        17.31.65  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.65  meni team management meetings next , tags: meni team management meetings next>
        17.31.66  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.66  meni team management meetings next , tags: meni team management meetings next>
        17.31.67  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.67  meni team management meetings next , tags: meni team management meetings next>
        17.31.68  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.68  meni team management meetings next , tags: meni team management meetings next>
        17.31.69  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.69  meni team management meetings next , tags: meni team management meetings next>
        17.31.70  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.70  meni team management meetings next , tags: meni team management meetings next>
        17.31.71  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.71  meni team management meetings next , tags: meni team management meetings next>
        17.31.72  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.72  meni team management meetings next , tags: meni team management meetings next>
        17.31.73  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.73  meni team management meetings next , tags: meni team management meetings next>
        17.31.74  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.74  meni team management meetings next , tags: meni team management meetings next>
        17.31.75  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.75  meni team management meetings next , tags: meni team management meetings next>
        17.31.76  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.76  meni team management meetings next , tags: meni team management meetings next>
        17.31.77  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.77  meni team management meetings next , tags: meni team management meetings next>
        17.31.78  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.78  meni team management meetings next , tags: meni team management meetings next>
        17.31.79  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.79  meni team management meetings next , tags: meni team management meetings next>
        17.31.80  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.80  meni team management meetings next , tags: meni team management meetings next>
        17.31.81  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.81  meni team management meetings next , tags: meni team management meetings next>
        17.31.82  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.82  meni team management meetings next , tags: meni team management meetings next>
        17.31.83  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.83  meni team management meetings next , tags: meni team management meetings next>
        17.31.84  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.84  meni team management meetings next , tags: meni team management meetings next>
        17.31.85  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.85  meni team management meetings next , tags: meni team management meetings next>
        17.31.86  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.86  meni team management meetings next , tags: meni team management meetings next>
        17.31.87  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.87  meni team management meetings next , tags: meni team management meetings next>
        17.31.88  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.88  meni team management meetings next , tags: meni team management meetings next>
        17.31.89  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.89  meni team management meetings next , tags: meni team management meetings next>
        17.31.90  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.90  meni team management meetings next , tags: meni team management meetings next>
        17.31.91  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.91  meni team management meetings next , tags: meni team management meetings next>
        17.31.92  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.92  meni team management meetings next , tags: meni team management meetings next>
        17.31.93  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.93  meni team management meetings next , tags: meni team management meetings next>
        17.31.94  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.94  meni team management meetings next , tags: meni team management meetings next>
        17.31.95  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.95  meni team management meetings next , tags: meni team management meetings next>
        17.31.96  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.96  meni team management meetings next , tags: meni team management meetings next>
        17.31.97  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.97  meni team management meetings next , tags: meni team management meetings next>
        17.31.98  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.98  meni team management meetings next , tags: meni team management meetings next>
        17.31.99  meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.99  meni team management meetings next , tags: meni team management meetings next>
        17.31.100 meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.100 meni team management meetings next , tags: meni team management meetings next>
        17.31.101 meni team management meetings next , tags: meni team management meetings next <URL:#tn=        17.31.101 meni team management meetings next , tags: meni team management meetings next>
    17.32 Sync bussi , tags: Sync bussi <URL:#tn=    17.32 Sync bussi , tags: Sync bussi>
        17.32.1  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.1  Sync bussi , tags: Sync bussi next>
        17.32.2    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.2    Sync bussi , tags: Sync bussi next>
        17.32.3    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.3    Sync bussi , tags: Sync bussi next>
        17.32.4    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.4    Sync bussi , tags: Sync bussi next>
        17.32.5    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.5    Sync bussi , tags: Sync bussi next>
        17.32.6    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.6    Sync bussi , tags: Sync bussi next>
        17.32.7    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.7    Sync bussi , tags: Sync bussi next>
        17.32.8    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.8    Sync bussi , tags: Sync bussi next>
        17.32.9    Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.9    Sync bussi , tags: Sync bussi next>
        17.32.10   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.10   Sync bussi , tags: Sync bussi next>
        17.32.11   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.11   Sync bussi , tags: Sync bussi next>
        17.32.12   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.12   Sync bussi , tags: Sync bussi next>
        17.32.13   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.13   Sync bussi , tags: Sync bussi next>
        17.32.14   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.14   Sync bussi , tags: Sync bussi next>
        17.32.15   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.15   Sync bussi , tags: Sync bussi next>
        17.32.16   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.16   Sync bussi , tags: Sync bussi next>
        17.32.17   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.17   Sync bussi , tags: Sync bussi next>
        17.32.18   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.18   Sync bussi , tags: Sync bussi next>
        17.32.19   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.19   Sync bussi , tags: Sync bussi next>
        17.32.20   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.20   Sync bussi , tags: Sync bussi next>
        17.32.21   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.21   Sync bussi , tags: Sync bussi next>
        17.32.22   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.22   Sync bussi , tags: Sync bussi next>
        17.32.23   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.23   Sync bussi , tags: Sync bussi next>
        17.32.24   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.24   Sync bussi , tags: Sync bussi next>
        17.32.25   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.25   Sync bussi , tags: Sync bussi next>
        17.32.26   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.26   Sync bussi , tags: Sync bussi next>
        17.32.27   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.27   Sync bussi , tags: Sync bussi next>
        17.32.28   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.28   Sync bussi , tags: Sync bussi next>
        17.32.29   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.29   Sync bussi , tags: Sync bussi next>
        17.32.30   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.30   Sync bussi , tags: Sync bussi next>
        17.32.31   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.31   Sync bussi , tags: Sync bussi next>
        17.32.32   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.32   Sync bussi , tags: Sync bussi next>
        17.32.33   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.33   Sync bussi , tags: Sync bussi next>
        17.32.34   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.34   Sync bussi , tags: Sync bussi next>
        17.32.35   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.35   Sync bussi , tags: Sync bussi next>
        17.32.36   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.36   Sync bussi , tags: Sync bussi next>
        17.32.37   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.37   Sync bussi , tags: Sync bussi next>
        17.32.38   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.38   Sync bussi , tags: Sync bussi next>
        17.32.39   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.39   Sync bussi , tags: Sync bussi next>
        17.32.40   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.40   Sync bussi , tags: Sync bussi next>
        17.32.41   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.41   Sync bussi , tags: Sync bussi next>
        17.32.42   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.42   Sync bussi , tags: Sync bussi next>
        17.32.43   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.43   Sync bussi , tags: Sync bussi next>
        17.32.44   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.44   Sync bussi , tags: Sync bussi next>
        17.32.45   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.45   Sync bussi , tags: Sync bussi next>
        17.32.46   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.46   Sync bussi , tags: Sync bussi next>
        17.32.47   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.47   Sync bussi , tags: Sync bussi next>
        17.32.48   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.48   Sync bussi , tags: Sync bussi next>
        17.32.49   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.49   Sync bussi , tags: Sync bussi next>
        17.32.50   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.50   Sync bussi , tags: Sync bussi next>
        17.32.51   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.51   Sync bussi , tags: Sync bussi next>
        17.32.52   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.52   Sync bussi , tags: Sync bussi next>
        17.32.53   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.53   Sync bussi , tags: Sync bussi next>
        17.32.54   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.54   Sync bussi , tags: Sync bussi next>
        17.32.55   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.55   Sync bussi , tags: Sync bussi next>
        17.32.56   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.56   Sync bussi , tags: Sync bussi next>
        17.32.57   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.57   Sync bussi , tags: Sync bussi next>
        17.32.58   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.58   Sync bussi , tags: Sync bussi next>
        17.32.59   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.59   Sync bussi , tags: Sync bussi next>
        17.32.60   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.60   Sync bussi , tags: Sync bussi next>
        17.32.61   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.61   Sync bussi , tags: Sync bussi next>
        17.32.62   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.62   Sync bussi , tags: Sync bussi next>
        17.32.63   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.63   Sync bussi , tags: Sync bussi next>
        17.32.64   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.64   Sync bussi , tags: Sync bussi next>
        17.32.65   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.65   Sync bussi , tags: Sync bussi next>
        17.32.66   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.66   Sync bussi , tags: Sync bussi next>
        17.32.67   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.67   Sync bussi , tags: Sync bussi next>
        17.32.68   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.68   Sync bussi , tags: Sync bussi next>
        17.32.69   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.69   Sync bussi , tags: Sync bussi next>
        17.32.70   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.70   Sync bussi , tags: Sync bussi next>
        17.32.71   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.71   Sync bussi , tags: Sync bussi next>
        17.32.72   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.72   Sync bussi , tags: Sync bussi next>
        17.32.73   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.73   Sync bussi , tags: Sync bussi next>
        17.32.74   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.74   Sync bussi , tags: Sync bussi next>
        17.32.75   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.75   Sync bussi , tags: Sync bussi next>
        17.32.76   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.76   Sync bussi , tags: Sync bussi next>
        17.32.77   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.77   Sync bussi , tags: Sync bussi next>
        17.32.78   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.78   Sync bussi , tags: Sync bussi next>
        17.32.79   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.79   Sync bussi , tags: Sync bussi next>
        17.32.80   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.80   Sync bussi , tags: Sync bussi next>
        17.32.81   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.81   Sync bussi , tags: Sync bussi next>
        17.32.82   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.82   Sync bussi , tags: Sync bussi next>
        17.32.83   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.83   Sync bussi , tags: Sync bussi next>
        17.32.84   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.84   Sync bussi , tags: Sync bussi next>
        17.32.85   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.85   Sync bussi , tags: Sync bussi next>
        17.32.86   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.86   Sync bussi , tags: Sync bussi next>
        17.32.87   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.87   Sync bussi , tags: Sync bussi next>
        17.32.88   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.88   Sync bussi , tags: Sync bussi next>
        17.32.89   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.89   Sync bussi , tags: Sync bussi next>
        17.32.90   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.90   Sync bussi , tags: Sync bussi next>
        17.32.91   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.91   Sync bussi , tags: Sync bussi next>
        17.32.92   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.92   Sync bussi , tags: Sync bussi next>
        17.32.93   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.93   Sync bussi , tags: Sync bussi next>
        17.32.94   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.94   Sync bussi , tags: Sync bussi next>
        17.32.95   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.95   Sync bussi , tags: Sync bussi next>
        17.32.96   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.96   Sync bussi , tags: Sync bussi next>
        17.32.97   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.97   Sync bussi , tags: Sync bussi next>
        17.32.98   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.98   Sync bussi , tags: Sync bussi next>
        17.32.99   Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.99   Sync bussi , tags: Sync bussi next>
        17.32.100  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.100  Sync bussi , tags: Sync bussi next>
        17.32.101  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.101  Sync bussi , tags: Sync bussi next>
        17.32.102  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.102  Sync bussi , tags: Sync bussi next>
        17.32.103  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.103  Sync bussi , tags: Sync bussi next>
        17.32.104  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.104  Sync bussi , tags: Sync bussi next>
        17.32.105  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.105  Sync bussi , tags: Sync bussi next>
        17.32.106  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.106  Sync bussi , tags: Sync bussi next>
        17.32.107  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.107  Sync bussi , tags: Sync bussi next>
        17.32.108  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.108  Sync bussi , tags: Sync bussi next>
        17.32.109  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.109  Sync bussi , tags: Sync bussi next>
        17.32.110  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.110  Sync bussi , tags: Sync bussi next>
        17.32.111  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.111  Sync bussi , tags: Sync bussi next>
        17.32.112  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.112  Sync bussi , tags: Sync bussi next>
        17.32.113  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.113  Sync bussi , tags: Sync bussi next>
        17.32.114  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.114  Sync bussi , tags: Sync bussi next>
        17.32.115  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.115  Sync bussi , tags: Sync bussi next>
        17.32.116  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.116  Sync bussi , tags: Sync bussi next>
        17.32.117  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.117  Sync bussi , tags: Sync bussi next>
        17.32.118  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.118  Sync bussi , tags: Sync bussi next>
        17.32.119  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.119  Sync bussi , tags: Sync bussi next>
        17.32.120  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.120  Sync bussi , tags: Sync bussi next>
        17.32.121  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.121  Sync bussi , tags: Sync bussi next>
        17.32.122  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.122  Sync bussi , tags: Sync bussi next>
        17.32.123  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.123  Sync bussi , tags: Sync bussi next>
        17.32.124  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.124  Sync bussi , tags: Sync bussi next>
        17.32.125  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.125  Sync bussi , tags: Sync bussi next>
        17.32.126  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.126  Sync bussi , tags: Sync bussi next>
        17.32.127  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.127  Sync bussi , tags: Sync bussi next>
        17.32.128  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.128  Sync bussi , tags: Sync bussi next>
        17.32.129  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.129  Sync bussi , tags: Sync bussi next>
        17.32.130  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.130  Sync bussi , tags: Sync bussi next>
        17.32.131  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.131  Sync bussi , tags: Sync bussi next>
        17.32.132  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.132  Sync bussi , tags: Sync bussi next>
        17.32.133  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.133  Sync bussi , tags: Sync bussi next>
        17.32.134  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.134  Sync bussi , tags: Sync bussi next>
        17.32.135  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.135  Sync bussi , tags: Sync bussi next>
        17.32.136  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.136  Sync bussi , tags: Sync bussi next>
        17.32.137  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.137  Sync bussi , tags: Sync bussi next>
        17.32.138  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.138  Sync bussi , tags: Sync bussi next>
        17.32.139  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.139  Sync bussi , tags: Sync bussi next>
        17.32.140  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.140  Sync bussi , tags: Sync bussi next>
        17.32.141  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.141  Sync bussi , tags: Sync bussi next>
        17.32.142  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.142  Sync bussi , tags: Sync bussi next>
        17.32.143  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.143  Sync bussi , tags: Sync bussi next>
        17.32.144  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.144  Sync bussi , tags: Sync bussi next>
        17.32.145  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.145  Sync bussi , tags: Sync bussi next>
        17.32.146  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.146  Sync bussi , tags: Sync bussi next>
        17.32.147  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.147  Sync bussi , tags: Sync bussi next>
        17.32.148  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.148  Sync bussi , tags: Sync bussi next>
        17.32.149  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.149  Sync bussi , tags: Sync bussi next>
        17.32.150  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.150  Sync bussi , tags: Sync bussi next>
        17.32.151  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.151  Sync bussi , tags: Sync bussi next>
        17.32.152  Sync bussi , tags: Sync bussi next <URL:#tn=        17.32.152  Sync bussi , tags: Sync bussi next>
    17.33 <URL:#tn=    17.33>
18. Devops <URL:#tn=18. Devops>
    18.1 jobs <URL:#tn=    18.1 jobs>
        18.1.1 INIT-ENVIRONMENT <URL:#tn=        18.1.1 INIT-ENVIRONMENT>
        18.1.2 update-environment <URL:#tn=        18.1.2 update-environment>
        18.1.3 <URL:#tn=        18.1.3>
    18.2 <URL:#tn=    18.2>
19. Cross-team Features <URL:#tn=19. Cross-team Features>
    19.1  data termination, orphan data, tags: data termination, orphan data, <URL:#tn=    19.1  data termination, orphan data, tags: data termination, orphan data,>
        19.1.1 <URL:#tn=        19.1.1>
    19.2 CMK, tags: CMK, customer managed key, apple, postgres encryption, pgbouncer, aws rds, kyma, gardener, Kubernetes, k8s <URL:#tn=    19.2 CMK, tags: CMK, customer managed key, apple, postgres encryption, pgbouncer, aws rds, kyma, gardener, Kubernetes, k8s>
        19.2.1 important links <URL:#tn=        19.2.1 important links>
        19.2.2 CMK Feature toggle, tags: CMK Feature toggle <URL:#tn=        19.2.2 CMK Feature toggle, tags: CMK Feature toggle>
        19.2.3 <URL:#tn=        19.2.3>
    19.3 <URL:#tn=    19.3>
20. group management , tags: group management <URL:#tn=20. group management , tags: group management>
    20.1 23/08/23 13:47:44 <URL:#tn=    20.1 23/08/23 13:47:44>
    20.2  03/01/24 15:28:25 <URL:#tn=    20.2  03/01/24 15:28:25>
    20.3  10/01/24 15:12:51 <URL:#tn=    20.3  10/01/24 15:12:51>
    20.4  13/03/24 15:10:19 <URL:#tn=    20.4  13/03/24 15:10:19>
    20.5  20/03/24 15:13:41 <URL:#tn=    20.5  20/03/24 15:13:41>
    20.6    08/05/24 15:08:17 <URL:#tn=    20.6    08/05/24 15:08:17>
    20.7    26/06/24 16:29:00 <URL:#tn=    20.7    26/06/24 16:29:00>
    20.8    next group management , tags: next group management <URL:#tn=    20.8    next group management , tags: next group management>
    20.9    next group management , tags: next group management <URL:#tn=    20.9    next group management , tags: next group management>
    20.10   next group management , tags: next group management <URL:#tn=    20.10   next group management , tags: next group management>
    20.11   next group management , tags: next group management <URL:#tn=    20.11   next group management , tags: next group management>
    20.12   next group management , tags: next group management <URL:#tn=    20.12   next group management , tags: next group management>
    20.13   next group management , tags: next group management <URL:#tn=    20.13   next group management , tags: next group management>
    20.14   next group management , tags: next group management <URL:#tn=    20.14   next group management , tags: next group management>
    20.15   next group management , tags: next group management <URL:#tn=    20.15   next group management , tags: next group management>
    20.16   next group management , tags: next group management <URL:#tn=    20.16   next group management , tags: next group management>
    20.17   next group management , tags: next group management <URL:#tn=    20.17   next group management , tags: next group management>
    20.18   next group management , tags: next group management <URL:#tn=    20.18   next group management , tags: next group management>
    20.19   next group management , tags: next group management <URL:#tn=    20.19   next group management , tags: next group management>
    20.20   next group management , tags: next group management <URL:#tn=    20.20   next group management , tags: next group management>
    20.21   next group management , tags: next group management <URL:#tn=    20.21   next group management , tags: next group management>
    20.22   next group management , tags: next group management <URL:#tn=    20.22   next group management , tags: next group management>
    20.23   next group management , tags: next group management <URL:#tn=    20.23   next group management , tags: next group management>
    20.24   next group management , tags: next group management <URL:#tn=    20.24   next group management , tags: next group management>
    20.25   next group management , tags: next group management <URL:#tn=    20.25   next group management , tags: next group management>
    20.26   next group management , tags: next group management <URL:#tn=    20.26   next group management , tags: next group management>
    20.27   next group management , tags: next group management <URL:#tn=    20.27   next group management , tags: next group management>
    20.28   next group management , tags: next group management <URL:#tn=    20.28   next group management , tags: next group management>
    20.29   next group management , tags: next group management <URL:#tn=    20.29   next group management , tags: next group management>
    20.30   next group management , tags: next group management <URL:#tn=    20.30   next group management , tags: next group management>
    20.31   next group management , tags: next group management <URL:#tn=    20.31   next group management , tags: next group management>
    20.32   next group management , tags: next group management <URL:#tn=    20.32   next group management , tags: next group management>
    20.33   next group management , tags: next group management <URL:#tn=    20.33   next group management , tags: next group management>
    20.34   next group management , tags: next group management <URL:#tn=    20.34   next group management , tags: next group management>
    20.35   next group management , tags: next group management <URL:#tn=    20.35   next group management , tags: next group management>
    20.36   next group management , tags: next group management <URL:#tn=    20.36   next group management , tags: next group management>
    20.37   next group management , tags: next group management <URL:#tn=    20.37   next group management , tags: next group management>
    20.38   next group management , tags: next group management <URL:#tn=    20.38   next group management , tags: next group management>
    20.39   next group management , tags: next group management <URL:#tn=    20.39   next group management , tags: next group management>
    20.40   next group management , tags: next group management <URL:#tn=    20.40   next group management , tags: next group management>
    20.41   next group management , tags: next group management <URL:#tn=    20.41   next group management , tags: next group management>
    20.42   next group management , tags: next group management <URL:#tn=    20.42   next group management , tags: next group management>
    20.43   next group management , tags: next group management <URL:#tn=    20.43   next group management , tags: next group management>
    20.44   next group management , tags: next group management <URL:#tn=    20.44   next group management , tags: next group management>
    20.45   next group management , tags: next group management <URL:#tn=    20.45   next group management , tags: next group management>
    20.46   next group management , tags: next group management <URL:#tn=    20.46   next group management , tags: next group management>
    20.47   next group management , tags: next group management <URL:#tn=    20.47   next group management , tags: next group management>
    20.48   next group management , tags: next group management <URL:#tn=    20.48   next group management , tags: next group management>
    20.49   next group management , tags: next group management <URL:#tn=    20.49   next group management , tags: next group management>
    20.50   next group management , tags: next group management <URL:#tn=    20.50   next group management , tags: next group management>
    20.51   next group management , tags: next group management <URL:#tn=    20.51   next group management , tags: next group management>
    20.52   next group management , tags: next group management <URL:#tn=    20.52   next group management , tags: next group management>
    20.53   next group management , tags: next group management <URL:#tn=    20.53   next group management , tags: next group management>
    20.54   next group management , tags: next group management <URL:#tn=    20.54   next group management , tags: next group management>
    20.55   next group management , tags: next group management <URL:#tn=    20.55   next group management , tags: next group management>
    20.56   next group management , tags: next group management <URL:#tn=    20.56   next group management , tags: next group management>
    20.57   next group management , tags: next group management <URL:#tn=    20.57   next group management , tags: next group management>
    20.58   next group management , tags: next group management <URL:#tn=    20.58   next group management , tags: next group management>
    20.59   next group management , tags: next group management <URL:#tn=    20.59   next group management , tags: next group management>
    20.60   next group management , tags: next group management <URL:#tn=    20.60   next group management , tags: next group management>
    20.61   next group management , tags: next group management <URL:#tn=    20.61   next group management , tags: next group management>
    20.62   next group management , tags: next group management <URL:#tn=    20.62   next group management , tags: next group management>
    20.63   next group management , tags: next group management <URL:#tn=    20.63   next group management , tags: next group management>
    20.64   next group management , tags: next group management <URL:#tn=    20.64   next group management , tags: next group management>
    20.65   next group management , tags: next group management <URL:#tn=    20.65   next group management , tags: next group management>
    20.66   next group management , tags: next group management <URL:#tn=    20.66   next group management , tags: next group management>
    20.67   next group management , tags: next group management <URL:#tn=    20.67   next group management , tags: next group management>
    20.68   next group management , tags: next group management <URL:#tn=    20.68   next group management , tags: next group management>
    20.69   next group management , tags: next group management <URL:#tn=    20.69   next group management , tags: next group management>
    20.70   next group management , tags: next group management <URL:#tn=    20.70   next group management , tags: next group management>
    20.71   next group management , tags: next group management <URL:#tn=    20.71   next group management , tags: next group management>
    20.72   next group management , tags: next group management <URL:#tn=    20.72   next group management , tags: next group management>
    20.73   next group management , tags: next group management <URL:#tn=    20.73   next group management , tags: next group management>
    20.74   next group management , tags: next group management <URL:#tn=    20.74   next group management , tags: next group management>
    20.75   next group management , tags: next group management <URL:#tn=    20.75   next group management , tags: next group management>
    20.76   next group management , tags: next group management <URL:#tn=    20.76   next group management , tags: next group management>
    20.77   next group management , tags: next group management <URL:#tn=    20.77   next group management , tags: next group management>
    20.78   next group management , tags: next group management <URL:#tn=    20.78   next group management , tags: next group management>
    20.79   next group management , tags: next group management <URL:#tn=    20.79   next group management , tags: next group management>
    20.80   next group management , tags: next group management <URL:#tn=    20.80   next group management , tags: next group management>
    20.81   next group management , tags: next group management <URL:#tn=    20.81   next group management , tags: next group management>
    20.82   next group management , tags: next group management <URL:#tn=    20.82   next group management , tags: next group management>
    20.83   next group management , tags: next group management <URL:#tn=    20.83   next group management , tags: next group management>
    20.84   next group management , tags: next group management <URL:#tn=    20.84   next group management , tags: next group management>
    20.85   next group management , tags: next group management <URL:#tn=    20.85   next group management , tags: next group management>
    20.86   next group management , tags: next group management <URL:#tn=    20.86   next group management , tags: next group management>
    20.87   next group management , tags: next group management <URL:#tn=    20.87   next group management , tags: next group management>
    20.88   next group management , tags: next group management <URL:#tn=    20.88   next group management , tags: next group management>
    20.89   next group management , tags: next group management <URL:#tn=    20.89   next group management , tags: next group management>
    20.90   next group management , tags: next group management <URL:#tn=    20.90   next group management , tags: next group management>
    20.91   next group management , tags: next group management <URL:#tn=    20.91   next group management , tags: next group management>
    20.92   next group management , tags: next group management <URL:#tn=    20.92   next group management , tags: next group management>
    20.93   next group management , tags: next group management <URL:#tn=    20.93   next group management , tags: next group management>
    20.94   next group management , tags: next group management <URL:#tn=    20.94   next group management , tags: next group management>
    20.95   next group management , tags: next group management <URL:#tn=    20.95   next group management , tags: next group management>
    20.96   next group management , tags: next group management <URL:#tn=    20.96   next group management , tags: next group management>
    20.97   next group management , tags: next group management <URL:#tn=    20.97   next group management , tags: next group management>
    20.98   next group management , tags: next group management <URL:#tn=    20.98   next group management , tags: next group management>
    20.99   next group management , tags: next group management <URL:#tn=    20.99   next group management , tags: next group management>
    20.100  next group management , tags: next group management <URL:#tn=    20.100  next group management , tags: next group management>
    20.101  next group management , tags: next group management <URL:#tn=    20.101  next group management , tags: next group management>
    20.102  next group management , tags: next group management <URL:#tn=    20.102  next group management , tags: next group management>
    20.103  next group management , tags: next group management <URL:#tn=    20.103  next group management , tags: next group management>
    20.104  next group management , tags: next group management <URL:#tn=    20.104  next group management , tags: next group management>
    20.105  next group management , tags: next group management <URL:#tn=    20.105  next group management , tags: next group management>
    20.106  next group management , tags: next group management <URL:#tn=    20.106  next group management , tags: next group management>
21. New Device, tags: New Device <URL:#tn=21. New Device, tags: New Device>
    21.1 New MAC, tags: New MAC <URL:#tn=    21.1 New MAC, tags: New MAC>
    21.2 New Iphone, tags: New Iphone <URL:#tn=    21.2 New Iphone, tags: New Iphone>
    21.3 <URL:#tn=    21.3>
22. Purchase, orders, ariba tags: Purchase, orders, ariba <URL:#tn=22. Purchase, orders, ariba tags: Purchase, orders, ariba>
    22.1 Ilan Cost center tags: Ilan Cost center <URL:#tn=    22.1 Ilan Cost center tags: Ilan Cost center>
    22.2 <URL:#tn=    22.2>
23. <URL:#tn=23.>
.................................................END TOC..............................................


































































Description: 	SAP CFLP, Portal Cloud Foundry based product
Author:		Yosi Izaq. izaqyos@gmail.com, yosi.izaq@sap.com


id=__cf_BLIs__
1. BLIs

    1.0 BLIs template, tags: BLIs template
		
        1.0.1 Bussi's BLIs Template, tags: Bussi's BLIs Template


https://jira.tools.sap/browse/EUXTEAMSAAR-4406

        1.0.2 General BLI Template (gemini), tags: General BLI Template (gemini)
Here's a template for a Backlog Item (BLI), also commonly known as a Product Backlog Item (PBI) or User Story, suitable for a typical agile Scrum development team. This template incorporates common elements and best practices:

**Backlog Item (BLI) Template**

**1. Title:**

*   \[Epic Name (if applicable)] - Short, descriptive title of the BLI (e.g., "User Authentication - Implement Password Reset Feature").

**2. ID:**

*   \[Unique ID generated by your tracking system (e.g., JIRA, Azure DevOps, etc.)]

**3. Description:**

*   **As a** \[type of user/persona]
*   **I want to** \[perform an action/achieve a goal]
*   **So that** \[reason/benefit/value]

    **(Example):**
    As a registered user,
    I want to be able to reset my password,
    So that I can regain access to my account if I forget my password.

**4. Acceptance Criteria:**

*   \[Specific, measurable, achievable, relevant, and time-bound (SMART) criteria that define when the BLI is "done."]
*   \[Use clear, concise language that is understandable by both technical and non-technical stakeholders.]
*   \[Focus on observable behavior and demonstrable outcomes.]

    **(Example):**
    *   A "Forgot Password" link is displayed on the login page.
    *   Clicking the link takes the user to a "Reset Password" page.
    *   The "Reset Password" page requires the user to enter their registered email address.
    *   If the email address is valid, the system sends an email with a password reset link.
    *   The link is unique, time-limited (e.g., expires after 24 hours), and can only be used once.
    *   The link takes the user to a page where they can enter a new password.
    *   The new password must meet the defined password complexity requirements.
    *   After successfully resetting the password, the user is redirected to the login page and can log in with the new password.
    *   Appropriate error messages are displayed for invalid email addresses, expired links, and incorrect password formats.
    *   The password reset process is logged for auditing purposes.
    *   Test coverage should be at least 80%
    *   All tests should pass before marking the story as complete

**5. Story Points:**

*   \[Estimate of the relative effort required to complete the BLI (e.g., using Fibonacci sequence: 1, 2, 3, 5, 8, etc.)]

**6. Priority:**

*   \[Ranking of the BLI's importance relative to other items in the backlog (e.g., High, Medium, Low, or a numerical ranking).]

**7. Sprint:**

*   \[The Sprint to which the BLI is assigned (leave blank if it's in the Product Backlog and not yet assigned to a Sprint).]

**8. Assignee:**

*   \[The team member responsible for working on the BLI (typically assigned during Sprint Planning).]

**9. Status:**

*   \[Current state of the BLI (e.g., To Do, In Progress, Blocked, Done).]

**10. Epic/Feature:**

*   \[Link to the related Epic or Feature, if applicable.]

**11. Labels/Tags:**

*   \[Keywords or tags for categorizing and filtering BLIs (e.g., UI, Backend, Security, Bug, Enhancement).]

**12. Attachments:**

*   \[Links to relevant documents, mockups, diagrams, or other supporting materials.]

**13. Comments:**

*   \[A space for discussions, questions, and updates related to the BLI.]

**14. Definition of Ready (Optional):**

*   While not part of the story itself, each team should have a "Definition of Ready" that defines the criteria a story needs to meet before it is added to a sprint.

**Example BLI using the Template:**

**1. Title:**

*   User Authentication - Implement Password Reset Feature

**2. ID:**

*   STORY-123

**3. Description:**

*   As a registered user,
*   I want to be able to reset my password,
*   So that I can regain access to my account if I forget my password.

**4. Acceptance Criteria:**

*   A "Forgot Password" link is displayed on the login page.
*   Clicking the link takes the user to a "Reset Password" page.
*   The "Reset Password" page requires the user to enter their registered email address.
*   If the email address is valid, the system sends an email with a password reset link.
*   The link is unique, time-limited (e.g., expires after 24 hours), and can only be used once.
*   The link takes the user to a page where they can enter a new password.
*   The new password must meet the defined password complexity requirements.
*   After successfully resetting the password, the user is redirected to the login page and can log in with the new password.
*   Appropriate error messages are displayed for invalid email addresses, expired links, and incorrect password formats.
*   The password reset process is logged for auditing purposes.

**5. Story Points:**

*   5

**6. Priority:**

*   High

**7. Sprint:**

*   Sprint 3

**8. Assignee:**

*   John Doe

**9. Status:**

*   To Do

**10. Epic/Feature:**

*   EPIC-001 (User Authentication)

**11. Labels/Tags:**

*   Security, Authentication, Backend

**12. Attachments:**

*   [Link to Password Reset Wireframes]

**13. Comments:**

*   2023-10-26: Discussed password complexity requirements with the security team.
*   2023-10-27: Confirmed email sending functionality will be handled by existing service.

**Tips for Using the Template:**

*   **Adapt to Your Team:** This is a general template. Customize it to fit your team's specific needs and processes.
*   **Keep it Concise:**  Strive for brevity and clarity in your descriptions and acceptance criteria.
*   **Collaborate:**  BLIs should be created and refined collaboratively with the Product Owner, developers, and testers.
*   **Use a Tracking Tool:** Use a dedicated agile project management tool (like JIRA, Azure DevOps, Trello, etc.) to manage your backlog and track the progress of BLIs.
*   **Regularly Refine:** Backlog refinement is an ongoing process. Regularly review and update your BLIs to ensure they remain relevant and accurate.
*   **Embrace "INVEST":** Remember to try and adhere to the INVEST principle when writing stories:
    *   **I**ndependent
    *   **N**egotiable
    *   **V**aluable
    *   **E**stimable
    *   **S**mall
    *   **T**estable

This comprehensive template and guidance will help your Scrum team create and manage effective Backlog Items. Let me know if you have any other questions.

        |.1 Links
        | BLI: 
        | Design:
        | Test scope:
        |.2 Design
        |.3 Tests
        |.4 Tasks
        |.5 Code
        |.6 Additional

    1.1  2019

        1.1.1  Delete site

            1.1.1.1  Links
        Resources
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Delete+Site+Design+Document
https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCF%5D+Delete+site+test+scope

        Code
cdm-store:  https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/153
semantic: 

JIRA: https://sapjira.wdf.sap.corp/browse/CLOUDEUX-4284 
GIT: 
    semantic: delete_bli, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/tree/delete_bli 
    cdm-store: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/delete_bli/README.md

Wiki, design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Delete+Site+Design+Document
    example: https://wiki.wdf.sap.corp/wiki/display/CPPortals/CLP+Design+Documents

Test scope:

space:
https://account.int.sap.hana.ondemand.com/cockpit#/globalaccount/SA0225001210/subaccount/5eaa3606-c87b-455e-a3c2-4e80a6ff8c45/org/1c6b159e-a01c-40d0-905e-cf6e7290bd3d/space/f7ae49af-c391-4d2c-9149-221e02b7ef3d/applications
 
 
            1.1.1.2 description
Motivation
Allow the Admin to delete sites through the site directory
User Story:
As an admin I would like to delete an existing site
General \ Technical Information
Acceptance Criteria:
Once Admin go to site directory he see all of his sites as tiles, Each tile has delete "Trash" icon on it.
Admin click on the delete icon of a specific site tile
A confirmation message on the deletion will be shown, admin click delete
Delete tile from site directory page
Delete site from CDM Store (delete the site context)
Delete freestyle artifacts (not the tenant artifacts) + content Units duplication per site  [Orly, just delete by context-id from cdm-store]
Delete the RT artifacts – use API from RT
Admin gets a toast message the delete was successful
Admin gets error popup on failure with retry option (follow UX)
If admin did not confirm the deletion then no removal of the site should be done
Error handling - report to logs in the BLIs + Audit logs
Include Bleier, Orly in the technical discussions
UX
\\iltlvg101.tlv.global.corp.sap\DEV_P_EP\Projects\ODP\UX and Visuals\2018T13&#40;cFLP) Site Directory – T13 Scope.pptx
Dahan, Neta (external - Service) - add delete error popup UX
InfoDev
add the strings 
Koren, Anat
Definition Of Done:
Item	Done/Not Done/NA
| 1. Mini-design was written and reviewed (including security aspects review by security angel)	 
| 2. Full Test Scope was written, reviewed and executed by the team; 0 VH/High, Up to 3 Medium bugs	 
| 3. Automated tests were written, reviewed and executed	 
| 4. Code review was done and high priority issues were fixed	 
| 5. All code merged to master and QOS is green (including green Fortify, checkmarx , AppScan, and Sonar)	 
| 6. UX design and graphics according to UX spec were applied and reviewed	 
| 7. Strings (UI Strings, public API names, java docs) reviewed by info dev and implemented by the team and translatable	 
| 8. Performance tests were executed and meets KPIs	 
| 9. Documentation - HO to info dev done.	 
| 10. Open sources were approved , if relevant	 
| 11. Security - code is GDPR compliant and other security aspects were taken into consideration	 

        --> Goal: Admin will be able to Delete a site from site directory
Scope:
Admin delete site from site directory
Integration with semantics
Confirmation of deletion
Error handling - report to logs in the BLIs + Audit logs
@Gilady, Noam – validate the scope is OK from Freestyle perspective
Include @Bleier, Orly in the discussions
Dependencies:
RT APIs for delete RT artifact – Tal H.
 
Design + design review - 7
Test scope + Review - 2
Client side implementation of SemanticService – 2
CDM Store implementation – 7
Semantic service implementation - 5
Update Swagger (node) – 1
Integration – 3

            1.1.1.3 Design

                1.1.1.3.1 wiki
Delete Site Design Document
Skip to end of metadata
Created by Kobi, Hadar, last modified by Izaq, Yosi just a moment ago
Go to start of metadata
High level design
Objective: Allow the Admin to delete sites through the site directory
The admin can see all of his sites, as tiles, via site directory.
Each tile has delete "Trash" icon on it. The admin can click the delete icon of a specific site tile to trigger the delete flow.
The admin may not confirm, resulting in a no-op.
If he does confirm the delete flow commences. It is made up of the following steps:
Site directory sends the delete request using (client side) semantic service API specifying context-id.
Semantic service processes the delete. Performs authentication and validation the proceeds with the delete.
Delete request is sent to RT site. Pending success response, the flow continues.
Note re. Freestyle. Currently it's sufficient to delete from CDM-store using context-id. Content-units deletion is out of scope.
Delete request is sent to CDM-store. Pending success response, the flow continues.
Send success response to Site directory

Design
site-directory
Admin clicks delete on site tile. 
>>ux screenshot
Site-Directory send DELETE HTTP request via semantic component.
>> endpoint, payload
>> Expected responses
semantic service
Semantic service will perform authentication for the request and validate the context-id.
It then sends a delete request to RT site using specified API:
route /activation_service/delete/site with JWT that contains siteId
Call data termination of services:
AsyncRequest.request(loggerCtx, null, `/portal_personalization/delete_site_personalization`, serviceMethods.DELETE, token);
AsyncRequest.request(loggerCtx, null, `/site_service/delete_site_technical`, serviceMethods.DELETE, token);
AsyncRequest.request(loggerCtx, null, `/site_configuration/site_configuration`, serviceMethods.DELETE, token);
If the delete from RT site is successful proceed to send delete request to CDM Store.
>> endpoint, payload
>> Expected responses

If the delete from RT site is not successful fail the request
>> Expected response
CDM-Store
Delete site and associated entities by context-id

                1.1.1.3.2 Activation service wiki

                1.1.1.3.3
 
            1.1.1.4 Task breakdown

                1.1.1.4.1  client. site-directory
-> Delete site will use the semanticService  to perform Http request.

-> Validate we have the busy Indicator as in the mockup

-> Ux, confirmation message  [Done]

-> Check automation tests (QUnit ?), plus CI 

                1.1.1.4.2  BL, semantic,

                    1.1.1.4.2.1  Delete RT site 

Api:
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2027101605#ActivationService(portal-cf-activation-service)-/activation_service/delete/site[DELETE]-deleteruntimesite

-> routing, validation

-> technical token usage

-> implementation of delete flow. send to RT-site API. success/error ? call CDM-Store success/error ? return response

-> audit logs Integration 

-> security logs ??

-> Swagger

-> automation tests



                1.1.1.4.3  Backend, cdm-store
-> handle REST call. 
-> implementation of query for deleting associated entities 
-> audit logs Integration 
-> automation tests

                1.1.1.4.4  Test scope  [Pending]
                1.1.1.4.6  Manual E2E tests

                1.1.1.4.8  
                1.1.1.4.9  
                1.1.1.4.10 
                1.1.1.4.11 




            1.1.1.5 Strings
smb://iltlvg101.tlv.global.corp.sap/DEV_P_EP/Projects/ODP/Info Development/UI Strings/CF (Cloud Foundry)/2018.12 CF - Save, Activation, and Delete error messages.docx


|       Scenario	Current String	Proposed String (UA)	Classif.	Comments
|       1.	Save failure 
|       (create, edit, delete entity)
|       		Something went wrong, and your changes were not saved.
|       Please Retry, or Cancel and try again later.	XMSG	Popup
|       Title: Error (XTIT)
|       Buttons: Retry, Cancel (XBUT)
|       2.	Activation failure 
|       (create, edit, delete entity)
|       
|       		Something went wrong, and your changes were not updated in the runtime site.
|       To correct this inconsistency, please Retry, or Cancel and try again later.	XMSG	Popup
|       Title: Error (XTIT)
|       Buttons: Retry, Cancel (XBUT)
|       3.	Cannot delete site 
|       (from RT)		Something went wrong, and you can’t delete right now.
|       Please Retry, or Cancel and try again later.	XMSG	Popup
|       Title: Error (XTIT)
|       Buttons: Retry, Cancel (XBUT)
|       4.	Cannot delete site 
|       (from CDM – DT)		Something went wrong with the deletion of your site. 
|       Although the site is no longer available in runtime, it still exists in the Site Directory.
|       To correct this inconsistency, please Retry, or Cancel and try again later.	XMSG	Popup
|       Title: Error (XTIT)
|       Buttons: Retry, Cancel (XBUT)


            1.1.1.6
        1.1.2  Metering service

            1.1.2.1  Resources
Semantic+Maas design:https://wiki.wdf.sap.corp/wiki/display/CPPortals/Metering+%28Commercialization%29+for+Portal@CF 
 
Official documentation:
https://wiki.wdf.sap.corp/wiki/display/CPC15N/Developer+Guide+for+Metering-as-a-Service

            1.1.2.2 E2E tests

                1.1.2.2.1 Hack to test metering client

                    1.1.2.2.1.1 code
diff --git a/manifest-dev.yml b/manifest-dev.yml
index 0d3c496..75e57ea 100755
--- a/manifest-dev.yml
+++ b/manifest-dev.yml
@@ -5,7 +5,7 @@ applications:
   buildpack: nodejs_buildpack
   instances: 1
   routes:
-    - route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/semantic
+    - route: portal-service-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic
   env:
     CF_APP_LOG_LEVEL: debug
     CF_AUDIT_LOG_DEV: true
diff --git a/package-lock.json b/package-lock.json
index 17946c9..d0bd260 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -5206,9 +5206,9 @@
       "dev": true
     },
     "portal-cf-shared-lib": {
-      "version": "2.16.0-20181212155648",
-      "resolved": "http://nexus.wdf.sap.corp:8081/nexus/repository/build.releases.npm/portal-cf-shared-lib/-/portal-cf-shared-lib-2.16.0-20181212155648.tgz",
-      "integrity": "sha512-a3l71hvk/9emVITqFIuIUP2riEf/wuo5YOAEfofVKxUU1m1+Jgfn9ajD+6j+7Y3C/cqLsbGmgqolqeVJwGiyFw==",
+      "version": "2.16.0-20181216103020",
+      "resolved": "http://nexus.wdf.sap.corp:8081/nexus/repository/build.releases.npm/portal-cf-shared-lib/-/portal-cf-shared-lib-2.16.0-20181216103020.tgz",
+      "integrity": "sha512-Umm+ohVWe1odh6VpGt+s3KU1df0LLlmdIEtENxl+mLYCXUuDjpAoQ55DfF58aWfeAgiYfOTHPBcfugzHC686CQ==",
       "requires": {
         "@sap/audit-logging": "2.2.4",
         "@sap/hana-client": "2.4.89",
diff --git a/src/config/env.js b/src/config/env.js
index 2e7ea93..29ba57d 100644
--- a/src/config/env.js
+++ b/src/config/env.js
@@ -2,7 +2,8 @@
 
 const cfLogger = require('portal-cf-shared-lib/src/logs/cf-logger');
 const logger = cfLogger.initLogger('portal-cf-site-semantic-service/config/env-config.js');
-const result = require('dotenv').config({path: '../.env'});
+//const result = require('dotenv').config({path: '../.env'});
+const result = require('dotenv').config(); //ToDo: Set path: value to be path relative to project root
 
 if (result.error) {
     logger.logMessage("error", "Can not load app environment variables: " + result.error);
diff --git a/src/controllers/site-entity-controller.js b/src/controllers/site-entity-controller.js
index ee92fbf..a3ae95d 100644
--- a/src/controllers/site-entity-controller.js
+++ b/src/controllers/site-entity-controller.js
@@ -3,6 +3,7 @@
 const StoreClientFactory = require('../services/store/store-client-factory');
 const ActivationClientFactory = require('../services/activation/activation-client-factory');
 const InternalServerError = require('../errors/internal-server-error');
+const Metering = require('../services/metering/metering-client');
 
 class SiteEntityController {
 
@@ -66,6 +67,12 @@ class SiteEntityController {
             return Promise.reject(returnErr);
         }
     }
+
+    //hack for testing metering directly
+    async sendHashedBorisToMetering(logger, authInfo) {
+        return await Metering.send("346c6b76bebdd4b9dd0ss12AaAa6441adf4bd250", {logger: logger, authInfo: authInfo});
+    }
+
 }
 
 module.exports = new SiteEntityController();
diff --git a/src/routes/sites.js b/src/routes/sites.js
index 30791a2..b01fcf6 100644
--- a/src/routes/sites.js
+++ b/src/routes/sites.js
@@ -16,6 +16,12 @@ module.exports = () => {
         requestValidator.validate(req.method.toLowerCase(), req.baseUrl + (req.params.id ? "/{id}" : ""))(req, res, next);
     };
 
+    router.get('/sendHashedBorisToMetering', (req, res, next) => {
+        console.log("In api sendHashedBorisToMetering")
+        SiteEntityController.sendHashedBorisToMetering(logger.getLoggerCtx(req), req.authInfo)
+            .then(err => res.json(err), next);
+    });
+
     router.get('/:id', validateRequest, (req, res, next) => {
         let siteId = req.params.id;
 
@@ -58,6 +64,7 @@ module.exports = () => {
             .then(data => res.json(data), next);
     });
 
+
     return router;
 };
 
diff --git a/src/services/metering/metering-client.js b/src/services/metering/metering-client.js
index d3f2de6..a27ba2e 100644
--- a/src/services/metering/metering-client.js
+++ b/src/services/metering/metering-client.js
@@ -25,12 +25,18 @@ class Metering {
 
     async send(user, reqContext) {
         let token = await MeteringTokenizer.getToken(reqContext.logger, this.serviceCredentials);
-        let body = MeteringRequestBuilder.buildRequestBody(user, reqContext.authInfo.getSubaccountId(), this.getRegion(reqContext.logger));
+        //let body = MeteringRequestBuilder.buildRequestBody(user, reqContext.authInfo.getSubaccountId(), this.getRegion(reqContext.logger));
+        let body = MeteringRequestBuilder.buildRequestBody(user, 'fcc', this.getRegion(reqContext.logger));
 
         return new HttpClient(reqContext.logger, token)
             .addHeader("Content-Type", "application/json")
             .addHeader("Accept", "application/json")
-            .put(this.metering_url, body);
+            .put(this.metering_url, body).then( data => {
+                const  aData = data;
+            })
+            .catch(err => {
+                const aErr = err;
+            });
     }
 }
 
diff --git a/src/services/metering/metering-tokenizer.js b/src/services/metering/metering-tokenizer.js
index 64aca5b..513ad17 100644
--- a/src/services/metering/metering-tokenizer.js
+++ b/src/services/metering/metering-tokenizer.js
@@ -9,7 +9,7 @@ class MeteringTokenizer {
         const clientSecret = serviceCredentials.clientsecret;
         const tokenURL = serviceCredentials.token_url + '/oauth/token?grant_type=client_credentials';
 
-        return new HttpClient(loggerCtx)
+        return new HttpClient(loggerCtx, null)
             .addHeader('Content-Type', 'application/json')
             .addHeader('Authorization', 'Basic ' + new Buffer(clientId + ":" + clientSecret).toString("base64"))
             .get(tokenURL)

                    1.1.2.2.1.2 Tests steps

switch to default plan:
511  cf us portal-cf-site-semantic-service portal-metering-service 
  512  cf ds portal-metering-service
  513  cf create-service metering-service default  portal-metering-service -c '{"providerToken":"f3efd8a9-dfc7-4a98-83d6-d6c922b05a6c"}' 
  514  cf bs portal-cf-site-semantic-service portal-metering-service 
  515  cf restage portal-cf-site-semantic-service

                        1.1.2.2.1.2.1 create Maas default plan
for fcc set canary token
[i500695@C02X632CJGH6:2018-12-19 10:38:06:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1008$ cf create-service metering-service default  portal-metering-service -c '{"providerToken":"f3efd8a9-dfc7-4a98-83d6-d6c922b05a6c"}' 

bind to semantic
cf bs portal-cf-site-semantic-service portal-metering-service 
[i500695@C02X632CJGH6:2018-12-19 10:40:31:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1010$ cf bs portal-cf-site-semantic-service portal-metering-service 
Binding service portal-metering-service to app portal-cf-site-semantic-service in org fcc / space boris-provider as i500695...
OK
TIP: Use 'cf restage portal-cf-site-semantic-service' to ensure your env variable changes take effect

pull the metering-service part of vcap_services
[i500695@C02X632CJGH6:2018-12-19 10:53:55:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1013$ cf env portal-cf-site-semantic-service > ~/temp/vcap_services_def
edit file, just leave VCAP_SERVICES json
[i500695@C02X632CJGH6:2018-12-19 11:02:18:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1027$ cat ~/temp/vcap_services_def |  python3 -c "import sys, json;     print ('{"metering-service": ', json.load(sys.stdin)['VCAP_SERVICES']['metering-service'], '}');"
{metering-service:  [{'binding_name': None, 'credentials': {'clientid': 'sb-df8d8f75-40b6-4335-8833-75f2b1075cfd!b1633|metering!b4066', 'clientsecret': 'Y99ATcKhq56fnbwzAVGOvpj25zU=', 'metering_url': 'https://maas-metering.cfapps.sap.hana.ondemand.com', 'token_url': 'https://fcc.authentication.sap.hana.ondemand.com'}, 'instance_name': 'portal-metering-service', 'label': 'metering-service', 'name': 'portal-metering-service', 'plan': 'default', 'provider': None, 'syslog_drain_url': None, 'tags': ['metering', 'reporting'], 'volume_mounts': []}] }

export to env:

    - doesn't really work. 
[i500695@C02X632CJGH6:2018-12-19 11:05:06:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1030$ cat ~/temp/vcap_services_def |  python3 -c "import sys, json;     print ('{"metering-service": ', json.load(sys.stdin)['VCAP_SERVICES']['metering-service'], '}');" > ~/temp/vcap_services_def_maas
[i500695@C02X632CJGH6:2018-12-19 11:05:28:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1031$ cat !$
cat ~/temp/vcap_services_def_maas
{metering-service:  [{'binding_name': None, 'credentials': {'clientid': 'sb-df8d8f75-40b6-4335-8833-75f2b1075cfd!b1633|metering!b4066', 'clientsecret': 'Y99ATcKhq56fnbwzAVGOvpj25zU=', 'metering_url': 'https://maas-metering.cfapps.sap.hana.ondemand.com', 'token_url': 'https://fcc.authentication.sap.hana.ondemand.com'}, 'instance_name': 'portal-metering-service', 'label': 'metering-service', 'name': 'portal-metering-service', 'plan': 'default', 'provider': None, 'syslog_drain_url': None, 'tags': ['metering', 'reporting'], 'volume_mounts': []}] }
[i500695@C02X632CJGH6:2018-12-19 11:05:31:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1032$ export VCAP_SERVICES=$(cat ~/temp/vcap_services_def_maas )

        -> extract manually
            
echo $VCAP_SERVICES | python -m json.tool 
            --> default plan
{
    "application-logs": [
        {
            "binding_name": null,
            "credentials": {},
            "instance_name": "portal-application-logs",
            "label": "application-logs",
            "name": "portal-application-logs",
            "plan": "lite",
            "provider": null,
            "syslog_drain_url": "https://10.0.104.16:4433/syslogv2/MTFjOGU3NmItNWJjNi00ZDY5LTkyYTgtMzZjNjg5OTQ1MTIyL3BvcnRhbC1jZi1zaXRlLXNlbWFudGljLXNlcnZpY2UvMjVkMDJiZjktY2I4MS00NjUxLWE5ZTctOTRlZGU3MGQyNjY1L2JvcmlzLXByb3ZpZGVyLzFjNmIxNTllLWEwMWMtNDBkMC05MDVlLWNmNmU3MjkwYmQzZC9mY2MvMDVjMmM2NDctZWI2MC00MGI0LWI4YmItNjUxMmEwZWZkNjYyL2FwcGxpY2F0aW9uLWxvZ3MvM2U0NjZmYzYtODMzZS00MzBhLWE1YTEtYjlhYTIzMTk1MGM4L2xpdGUvY2UyODI2YWMtZmExZS00YTE0LTgxYTMtY2E0YzhjYWI1YjAxL3BvcnRhbC1hcHBsaWNhdGlvbi1sb2dzLzFlYzMzNDFhZmFmMDk2M2Y1MmQ5MzRhZmJjMjA2ZDg4YzZkZTg5ZGI3NTA1YjVlMGQ3MmMzYzE5YzRhMmJmMzY",
            "tags": [],
            "volume_mounts": []
        }
    ],
    "auditlog": [
        {
            "binding_name": null,
            "credentials": {
                "password": "417fa21d7b808436",
                "url": "https://api.auditlog.cf.sap.hana.ondemand.com:8081",
                "user": "6ba2d2873449048b"
            },
            "instance_name": "portal-audit-logs",
            "label": "auditlog",
            "name": "portal-audit-logs",
            "plan": "standard",
            "provider": null,
            "syslog_drain_url": null,
            "tags": [
                "auditlog",
                "audit log",
                "xsa"
            ],
            "volume_mounts": []
        }
    ],
    "metering-service": [
        {
            "binding_name": null,
            "credentials": {
                "clientid": "sb-df8d8f75-40b6-4335-8833-75f2b1075cfd!b1633|metering!b4066",
                "clientsecret": "Y99ATcKhq56fnbwzAVGOvpj25zU=",
                "metering_url": "https://maas-metering.cfapps.sap.hana.ondemand.com",
                "token_url": "https://fcc.authentication.sap.hana.ondemand.com"
            },
            "instance_name": "portal-metering-service",
            "label": "metering-service",
            "name": "portal-metering-service",
            "plan": "default",
            "provider": null,
            "syslog_drain_url": null,
            "tags": [
                "metering",
                "reporting"
            ],
            "volume_mounts": []
        }
    ],
    "user-provided": [
        {
            "binding_name": null,
            "credentials": {
                "portalServiceUrl": "https://portal-service-boris-provider-i349897.cfapps.sap.hana.ondemand.com",
                "tag": "portal-url-config"
            },
            "instance_name": "portal-cf-general-configuration",
            "label": "user-provided",
            "name": "portal-cf-general-configuration",
            "syslog_drain_url": "",
            "tags": [],
            "volume_mounts": []
        }
    ],
    "xsuaa": [
        {
            "binding_name": null,
            "credentials": {
                "clientid": "sb-portal-cf-service-boris-provider-i349897!b1633",
                "clientsecret": "uRkJVMb4kW+h3YfOeBKIV3ehc4g=",
                "identityzone": "fcc",
                "identityzoneid": "5eaa3606-c87b-455e-a3c2-4e80a6ff8c45",
                "sburl": "https://internal-xsuaa.authentication.sap.hana.ondemand.com",
                "tenantid": "5eaa3606-c87b-455e-a3c2-4e80a6ff8c45",
                "tenantmode": "dedicated",
                "trustedclientidsuffix": "|portal-cf-service-boris-provider-i349897!b1633",
                "uaadomain": "authentication.sap.hana.ondemand.com",
                "url": "https://fcc.authentication.sap.hana.ondemand.com",
                "verificationkey": "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----",
                "xsappname": "portal-cf-service-boris-provider-i349897!b1633"
            },
            "instance_name": "portal-xsuaa-broker",
            "label": "xsuaa",
            "name": "portal-xsuaa-broker",
            "plan": "broker",
            "provider": null,
            "syslog_drain_url": null,
            "tags": [
                "xsuaa"
            ],
            "volume_mounts": []
        }
    ]
}

            --> Development plan
         [i500695@C02X632CJGH6:2018-12-20 17:39:06:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1158$ cat ~/temp/vcap_services 
{
		"metering-service": [
			{
				"label": "metering-service",
				"provider": null,
				"plan": "development",
				"name": "portal-metering-service",
				"tags": [
					"metering",
					"reporting"
				],
				"instance_name": "portal-metering-service",
				"binding_name": null,
				"credentials": {
                                        "clientid": "sb-2ec054b8-3d4e-4c14-8d2d-c4c16935ba79!b1633|metering!b4066",
                                        "clientsecret": "9MSJUM0IbsJDzEok9n4h8sTWx8k=",
					"token_url": "https://fcc.authentication.sap.hana.ondemand.com",
					"metering_url": "https://maas-metering.cfapps.sap.hana.ondemand.com/dev"
				},
				"syslog_drain_url": null,
				"volume_mounts": []
			}
		],
		"auditlog": [
			{
				"label": "auditlog",
				"provider": null,
				"plan": "standard",
				"name": "portal-audit-logs",
				"tags": [
					"auditlog",
					"audit log",
					"xsa"
				],
				"instance_name": "portal-audit-logs",
				"binding_name": null,
				"credentials": {
					"url": "https://api.auditlog.cf.sap.hana.ondemand.com:8081",
					"user": "6ba2d2873449048b",
					"password": "417fa21d7b808436"
				},
				"syslog_drain_url": null,
				"volume_mounts": []
			}
		],
		"application-logs": [
			{
				"label": "application-logs",
				"provider": null,
				"plan": "lite",
				"name": "portal-application-logs",
				"tags": [],
				"instance_name": "portal-application-logs",
				"binding_name": null,
				"credentials": {},
				"syslog_drain_url": "https://10.0.104.16:4433/syslogv2/MTFjOGU3NmItNWJjNi00ZDY5LTkyYTgtMzZjNjg5OTQ1MTIyL3BvcnRhbC1jZi1zaXRlLXNlbWFudGljLXNlcnZpY2UvMjVkMDJiZjktY2I4MS00NjUxLWE5ZTctOTRlZGU3MGQyNjY1L2JvcmlzLXByb3ZpZGVyLzFjNmIxNTllLWEwMWMtNDBkMC05MDVlLWNmNmU3MjkwYmQzZC9mY2MvMDVjMmM2NDctZWI2MC00MGI0LWI4YmItNjUxMmEwZWZkNjYyL2FwcGxpY2F0aW9uLWxvZ3MvM2U0NjZmYzYtODMzZS00MzBhLWE1YTEtYjlhYTIzMTk1MGM4L2xpdGUvY2UyODI2YWMtZmExZS00YTE0LTgxYTMtY2E0YzhjYWI1YjAxL3BvcnRhbC1hcHBsaWNhdGlvbi1sb2dzLzFlYzMzNDFhZmFmMDk2M2Y1MmQ5MzRhZmJjMjA2ZDg4YzZkZTg5ZGI3NTA1YjVlMGQ3MmMzYzE5YzRhMmJmMzY",
				"volume_mounts": []
			}
		],
		"user-provided": [
			{
				"label": "user-provided",
				"name": "portal-cf-general-configuration",
				"tags": [],
				"instance_name": "portal-cf-general-configuration",
				"binding_name": null,
				"credentials": {
					"portalServiceUrl": "https://portal-service-boris-provider-i349897.cfapps.sap.hana.ondemand.com",
					"tag": "portal-url-config"
				},
				"syslog_drain_url": "",
				"volume_mounts": []
			}
		],
		"xsuaa": [
			{
				"label": "xsuaa",
				"provider": null,
				"plan": "broker",
				"name": "portal-xsuaa-broker",
				"tags": [
					"xsuaa"
				],
				"instance_name": "portal-xsuaa-broker",
				"binding_name": null,
				"credentials": {
					"uaadomain": "authentication.sap.hana.ondemand.com",
					"trustedclientidsuffix": "|portal-cf-service-boris-provider-i349897!b1633",
					"tenantmode": "dedicated",
					"sburl": "https://internal-xsuaa.authentication.sap.hana.ondemand.com",
					"clientid": "sb-portal-cf-service-boris-provider-i349897!b1633",
					"verificationkey": "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----",
					"xsappname": "portal-cf-service-boris-provider-i349897!b1633",
					"identityzone": "fcc",
					"identityzoneid": "5eaa3606-c87b-455e-a3c2-4e80a6ff8c45",
					"clientsecret": "uRkJVMb4kW+h3YfOeBKIV3ehc4g=",
					"tenantid": "5eaa3606-c87b-455e-a3c2-4e80a6ff8c45",
					"url": "https://fcc.authentication.sap.hana.ondemand.com"
				},
				"syslog_drain_url": null,
				"volume_mounts": []
			}
		]
	}   
            -->
        -
                        1.1.2.2.1.2.2

- tokens, offline provisioned to Maas and semantic
Landscape SERVICE_IDs PLAN_IDs Token
Factory(Live) portal default d6c5aa27-1221-4b16-bcd8-e693a268d4d8
Canary portal default f3efd8a9-dfc7-4a98-83d6-d6c922b05a6c
 Staging portal default 2f409e0d-9279-460a-a3e4-07c167c26249

- enroll semantic to Maas dev plan
cf cs metering-service development portal-metering-service -c '{"services":[{"id":"portal","plans":["default"]}]}'


syntax: 
cf create-service metering-service <default/development> <service instance name> -c '{"providerToken":"<provider token value>"}'

- setup
update Integration branch:  gitco metering_tokens
  git pull 

create sub branch:  gitcob metering_tokens_yosi

space:
    cf t
    export NODE_ENV=local
    export MODE=shmock
    cf push -f manifest-dev.yml 

            get VCAP_SERVICES
[i500695@C02X632CJGH6:2018-12-18 12:24:42:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]978$ cf env portal-cf-site-semantic-service
put 
  "metering-service": [
   {
           ...
   }
in file and load to env variable VCAP_SERVICES

    export VCAP_SERVICES=$(cat ~/temp/vcap_services )
    npm start

- Maas req. body example:
            --->  Maas req. body
{
  "usage": [
    {
      "timestamp": "2018-12-18T10:09:32.959",
      "service": {
        "id": "portal",
        "plan": "default"
      },
      "consumer": {
        "environment": "CF",
        "region": "cf-sap",
        "org": "fcc",
        "user": "346c6b76bebdd4b9dd0ss12AaAa6441adf4bd250"
      },
      "measures": [
        {
          "id": "admins",
          "value": 1
        }
      ]
    }
  ]
}

- postman
http://localhost:3002/semantic/entity/site/sendHashedBorisToMetering

3002 for intellij debugging
3000 for terminal 

-

                    1.1.2.2.1.3

                1.1.2.2.2 E2E sanity 26/12/18 
                

-> default plan logs
[i500695@C02X632CJGH6:2018-12-26 11:06:29:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]517$ !510
cflogsNice.sh portal-cf-site-semantic-service
[2018-12-26T11:07:41.64+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:31'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/utils/config/config-utils.js:31 - isClpScenario]
[2018-12-26T11:07:41.64+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:11'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/utils/config/config-utils.js:11 - initClpInstanceId]
[2018-12-26T11:07:41.65+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:25'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:25 - SiteEntityController::read() called]
[2018-12-26T11:07:41.65+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:33'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:33 - SiteEntityController::read() read all sites. authInfo=SecurityContext {
  token: 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI4ZDZhZWU5ZDNmNWQ0YTIxOGJhNDVlY2I2YmUzNDFjOCIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCJ9LCJ4cy51c2VyLmF0dHJpYnV0ZXMiOnt9LCJncmFudGVkX3Njb3BlcyI6WyJvcGVuaWQiLCJwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMy5TdXBlckFkbWluIiwidWFhLnVzZXIiXSwieHMuc3lzdGVtLmF0dHJpYnV0ZXMiOnsieHMucm9sZWNvbGxlY3Rpb25zIjpbInN1cGVyQWRtaW4iXX0sImdpdmVuX25hbWUiOiJZb3NpIiwiZmFtaWx5X25hbWUiOiJJemFxIiwic3ViIjoiNjEzNTMwZWEtMjJjZi00YWQ1LWEwZmEtM2ZkOTdhMTM5NWEwIiwic2NvcGUiOlsib3BlbmlkIiwicG9ydGFsLWNmLXNlcnZpY2UtdG9tZXIxLWkzMzA5NzEhYjE2MzMuU3VwZXJBZG1pbiIsInVhYS51c2VyIl0sImNsaWVudF9pZCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsImNpZCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsImF6cCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsInJldm9jYWJsZSI6dHJ1ZSwiZ3JhbnRfdHlwZSI6InVzZXJfdG9rZW4iLCJ1c2VyX2lkIjoiNjEzNTMwZWEtMjJjZi00YWQ1LWEwZmEtM2ZkOTdhMTM5NWEwIiwib3JpZ2luIjoibGRhcCIsInVzZXJfbmFtZSI6Inlvc2kuaXphcUBzYXAuY29tIiwiZW1haWwiOiJ5b3NpLml6YXFAc2FwLmNvbSIsImF1dGhfdGltZSI6MTU0NTgxNTI2MSwicmV2X3NpZyI6IjU2MTgwM2RiIiwiaWF0IjoxNTQ1ODE1MjYxLCJleHAiOjE1NDU4NTg0NjEsImlzcyI6Imh0dHA6Ly9mY2MubG9jYWxob3N0OjgwODAvdWFhL29hdXRoL3Rva2VuIiwiemlkIjoiNWVhYTM2MDYtYzg3Yi00NTVlLWEzYzItNGU4MGE2ZmY4YzQ1IiwiYXVkIjpbXX0.DQLBClCVI6jZXfZ_uGSm4Z0EI1cP6UvLpP6MtF3HN3G9u_OLK3sWrcQXTcIqueVp0an9Gf0XrzaK2Ojc5tve_kfXnGAWz5gn7WVKDlBZ0zFlNdHQRHizxkpy8OqVhEsRddH5Deaf3e1dHsYFeY9h9a9lxsC27fWTrws2zmJ4Th_4R5F2vFDjRtNjvrH8GGasqEm8rqsPjLPBSpjoekD0wQXU5WA94cVdhEflrtaBtr3cHr_KGT8yEpS0rQxWr95E_ovYHY4-tecGQjYGhPQqDYKtoUqUVv6IQd-pH7O9C1rZVy7dk7YLzbwjhdhpgz1gllN6XC52tpH9wNVydWlThA',
  config: 
   { uaadomain: 'authentication.sap.hana.ondemand.com',
     trustedclientidsuffix: '|portal-cf-service-tomer1-i330971!b1633',
     tenantmode: 'dedicated',
     sburl: 'https://internal-xsuaa.authentication.sap.hana.ondemand.com',
     clientid: 'sb-portal-cf-service-tomer1-i330971!b1633',
     verificationkey: '-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----',
     xsappname: 'portal-cf-service-tomer1-i330971!b1633',
     identityzone: 'fcc',
     identityzoneid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     clientsecret: 'cns2wKHTl/BsnFMglVXNgSyO4tY=',
     tenantid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     url: 'https://fcc.authentication.sap.hana.ondemand.com' },
  xsappname: 'portal-cf-service-tomer1-i330971!b1633',
  isForeignMode: false,
  tokenContainsAttributes: true,
  tokenContainsAdditionalAuthAttributes: false,
  userInfo: 
   { logonName: 'yosi.izaq@sap.com',
     givenName: 'Yosi',
     familyName: 'Izaq',
     email: 'yosi.izaq@sap.com' },
  scopes: 
   [ 'openid',
     'portal-cf-service-tomer1-i330971!b1633.SuperAdmin',
     'uaa.user',
     [length]: 3 ],
  samlToken: undefined,
  clientId: 'sb-93e0e5b1-7938-4ab6-947f-d8de6d3ecb24!b1633|portal-cf-service-tomer1-i330971!b1633',
  identityZone: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  subdomain: 'fcc',
  origin: 'ldap',
  userAttributes: {},
  additionalAuthAttributes: '',
  serviceinstanceid: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  grantType: 'user_token',
  ssojwt: 
   jwtValidation {
     ssolib: 
      _exports_SSOEXT_TICKET_FUNCTIONS {
        SsoExtEvalJwToken: SwigProxy {},
        SsoExtParseCertificate: SwigProxy {},
        SsoExtGetProperty: SwigProxy {},
        SsoExtSetProperty: SwigProxy {},
        SsoExtLoadKey: SwigProxy {},
        SsoExtGetVersion: SwigProxy {},
        SsoExtShutdown: SwigProxy {},
        SsoExtInitialize: SwigProxy {} },
     jwtInfo: 
      _exports_JWT_INFO {
        tAlgId: 4,
        issuedAt: SwigProxy {},
        lAudience: 2,
        pAudience: '',
        lJTI: 32,
        pJTI: '8\f�c\u000b',
        lIssuer: 41,
        pIssuer: '',
        lSubject: 36,
        pSubject: '',
        lNameIdValue: 0,
        pNameIdValue: undefined,
        lastError: '',
        lPayLoadBuffer: 1124,
        pPayloadBuffer: SwigProxy {},
        struct_size: 632 },
     certBuffer: null,
     payloadL: 0,
     payload: SwigProxy {},
     version: 1,
     rc: 0 },
  expirationDate: 2018-12-26T21:07:41.000Z }]
[2018-12-26T11:07:41.65+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:58'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/utils/technical-token.js:58 - requestAccessToken - Reqs token at https://fcc.authentication.sap.hana.ondemand.com/oauth/token]
[2018-12-26T11:07:41.65+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:67'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/utils/technical-token.js:67 - requestAccessToken - add additional attributes { tenantId: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  instanceId: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  userName: 'yosi.izaq@sap.com',
  isProvider: 'false' }]
[2018-12-26T11:07:41.65+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceRelativeUrl null, serviceMethod post, options 'SECURE']
[2018-12-26T11:07:41.65+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceMethod post, formData null, requestOptions 'SECURE']
[2018-12-26T11:07:41.81+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token succeeded]
[2018-12-26T11:07:41.81+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl /cdm_store_service/cdm/entities/type/site, serviceMethod get, options 'SECURE']
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:38 - SiteEntityController::read() encrypt user name yosi.izaq@sap.com]
[2018-12-26T11:07:41.81+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-26T11:07:41.95+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site succeeded]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:25'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:25 - HashUtil::hashString(), *Remove Log after integration* Trying to hash str yosi.izaq@sap.com]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:43 - HashUtil::javaHashAndSalt(),  Trying to java hash str yosi.izaq@sap.com]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:45 - HashUtil::javaHashAndSalt(),  java hashed str is 1375615000]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:36'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:36 - HashUtil::hashString(), hash is 49,51,55,53,54,49,53,48,48,48,102,72,68,60,85,72,82,67,115,109,60,35,83,38,81,75,62,118,40,98,64,46,43,33,119,52,126,93,106,57,78,91,91,109,40,45,121,91,58,59,99,87,89,117,74,104,35,119,69,69,97,119,114,43,50,54,74,39,85,121,82,102,95,87,126,100,38,47,58,94,103,56,61,38,94,99,102,90,106,71,47,89,56,69,85,55,87,86,36,115,76,87,126,67,100,45,41,36,99,116,112,100,72,52,114]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:38 - HashUtil::hashString(), encrypted str is 955b0bb3354941e3b62176be1bee4170]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:43 - SiteEntityController::read() update maas for (encrypted) user name 955b0bb3354941e3b62176be1bee4170]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:31'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:31 - MeteringClient::send() called]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10 - MeteringTokenizer::getToken() called]
[2018-12-26T11:07:41.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14 - MeteringTokenizer::getToken() sending get request with clientId=sb-248dd8e1-f81f-4718-a428-4f4153edcdeb!b1633|metering!b4066, clientsecret=JRbdCklU5tU8VCZnUiaMxk6rirQ=, tokenURL=https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials]
[2018-12-26T11:07:41.95+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, options 'SECURE']
[2018-12-26T11:07:41.95+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-26T11:07:42.09+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials succeeded]
[2018-12-26T11:07:42.09+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:33'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:33 - MeteringClient::send() get metering technical token 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiJjOTI5ZDBiMGNkOTQ0ZTIyODU4M2ZmMDFlOGJiMDM2OSIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiJ9LCJzdWIiOiJzYi0yNDhkZDhlMS1mODFmLTQ3MTgtYTQyOC00ZjQxNTNlZGNkZWIhYjE2MzN8bWV0ZXJpbmchYjQwNjYiLCJhdXRob3JpdGllcyI6WyJ1YWEucmVzb3VyY2UiXSwic2NvcGUiOlsidWFhLnJlc291cmNlIl0sImNsaWVudF9pZCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImNpZCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImF6cCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImdyYW50X3R5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJyZXZfc2lnIjoiOTc5YzI0OGQiLCJpYXQiOjE1NDU4MTUyNjIsImV4cCI6MTU0NTg1ODQ2MiwiaXNzIjoiaHR0cDovL2ZjYy5sb2NhbGhvc3Q6ODA4MC91YWEvb2F1dGgvdG9rZW4iLCJ6aWQiOiI1ZWFhMzYwNi1jODdiLTQ1NWUtYTNjMi00ZTgwYTZmZjhjNDUiLCJhdWQiOlsic2ItMjQ4ZGQ4ZTEtZjgxZi00NzE4LWE0MjgtNGY0MTUzZWRjZGViIWIxNjMzfG1ldGVyaW5nIWI0MDY2IiwidWFhIl19.krSLgAUQz4Zgn3iXHBW3ypNTh3BUpQ67oCpkxK1Gt3vjzNn6ZRGc6fRR0YmHvFUWSWKLWehLIUrL8Z5mRkJhsavnVk05a4dZn4Sv1NLJCoRU4xNUF7qyw4WxsYyysWHZgEMOmt0Lf0UegzJKneQCeTP0G5jKvgG9fakLG_K5Mn8tbnEb8zYQAHAkKTQfAVYrWihaQkNyd73hoadS03v__IzjNsvTiT6yndJtTGGhwn9wiSQOWKHjdXP9pr8hXbe8nx761PMakEQBR1mUSAP6Tnu-jhJIQQ9bpwQI3IkdwBDc1WcGkcJM9jvHJlzIxcgaMv_igDyn5Wdt98joaYgeOA']
[2018-12-26T11:07:42.09+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:19'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:19 - MeteringClient::getRegion() called]
[2018-12-26T11:07:42.09+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:22'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:22 - MeteringClient::getRegion() extracting region sap from https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents]
[2018-12-26T11:07:42.09+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8 - MeteringRequestBuilder::buildRequestBody() for user=955b0bb3354941e3b62176be1bee4170, identityZone=5eaa3606-c87b-455e-a3c2-4e80a6ff8c45, region=sap]
[2018-12-26T11:07:42.09+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:35'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:35 - MeteringClient::send() get metering request body { usage: 
   [ { timestamp: '2018-12-26T09:07:42.095',
       service: { id: 'portal', plan: 'default' },
       consumer: 
        { environment: 'CF',
          region: 'cf-sap',
          org: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
          user: '955b0bb3354941e3b62176be1bee4170' },
       measures: [ { id: 'admins', value: 1 }, [length]: 1 ] },
     [length]: 1 ] }. Sending put request for url https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents]
[2018-12-26T11:07:42.09+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents, serviceMethod put, options 'SECURE']
[2018-12-26T11:07:42.09+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents, serviceMethod put, formData null, requestOptions 'SECURE']
[2018-12-26T11:07:42.17+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [81f1bb18-bf53-4c14-403e-ee494698518f] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents succeeded]
[2018-12-26T11:07:42.17+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:45 - SiteEntityController::read() maas result='']
[2018-12-26T11:07:42.17+0200] [INFO] [81f1bb18-bf53-4c14-403e-ee494698518f] [Custom Fields not found] [81f1bb18-bf53-4c14-403e-ee494698518f] [Log Message not found]

-> after subaccount fix
[i500695@C02X632CJGH6:2018-12-27 11:21:16:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]533$ cflogsNice.sh portal-cf-site-semantic-service
[2018-12-27T11:21:47.61+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:31'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/utils/config/config-utils.js:31 - isClpScenario]
[2018-12-27T11:21:47.61+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:11'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/utils/config/config-utils.js:11 - initClpInstanceId]
[2018-12-27T11:21:47.62+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:25'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:25 - SiteEntityController::read() called]
[2018-12-27T11:21:47.62+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:33'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:33 - SiteEntityController::read() read all sites. authInfo=SecurityContext {
  token: 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiIzNmFlYTcwMWI1ZjI0MWVlODcwMzJmYmM3NDUxNjdjYSIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCJ9LCJ4cy51c2VyLmF0dHJpYnV0ZXMiOnt9LCJncmFudGVkX3Njb3BlcyI6WyJvcGVuaWQiLCJwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMy5TdXBlckFkbWluIiwidWFhLnVzZXIiXSwieHMuc3lzdGVtLmF0dHJpYnV0ZXMiOnsieHMucm9sZWNvbGxlY3Rpb25zIjpbInN1cGVyQWRtaW4iLCJBcmllbF9yb2xlIl19LCJnaXZlbl9uYW1lIjoiR3V5IiwiZmFtaWx5X25hbWUiOiJNb3Nrb3ZpY2giLCJzdWIiOiI4MWEwZWJlMi0zNzgyLTQ4MzItYmQ5OS0zZTg1NDhiMjRlZmEiLCJzY29wZSI6WyJvcGVuaWQiLCJwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMy5TdXBlckFkbWluIiwidWFhLnVzZXIiXSwiY2xpZW50X2lkIjoic2ItOTNlMGU1YjEtNzkzOC00YWI2LTk0N2YtZDhkZTZkM2VjYjI0IWIxNjMzfHBvcnRhbC1jZi1zZXJ2aWNlLXRvbWVyMS1pMzMwOTcxIWIxNjMzIiwiY2lkIjoic2ItOTNlMGU1YjEtNzkzOC00YWI2LTk0N2YtZDhkZTZkM2VjYjI0IWIxNjMzfHBvcnRhbC1jZi1zZXJ2aWNlLXRvbWVyMS1pMzMwOTcxIWIxNjMzIiwiYXpwIjoic2ItOTNlMGU1YjEtNzkzOC00YWI2LTk0N2YtZDhkZTZkM2VjYjI0IWIxNjMzfHBvcnRhbC1jZi1zZXJ2aWNlLXRvbWVyMS1pMzMwOTcxIWIxNjMzIiwicmV2b2NhYmxlIjp0cnVlLCJncmFudF90eXBlIjoidXNlcl90b2tlbiIsInVzZXJfaWQiOiI4MWEwZWJlMi0zNzgyLTQ4MzItYmQ5OS0zZTg1NDhiMjRlZmEiLCJvcmlnaW4iOiJsZGFwIiwidXNlcl9uYW1lIjoiZ3V5Lm1vc2tvdmljaEBzYXAuY29tIiwiZW1haWwiOiJndXkubW9za292aWNoQHNhcC5jb20iLCJhdXRoX3RpbWUiOjE1NDU5MDI1MDcsInJldl9zaWciOiI3YTlhODYwNCIsImlhdCI6MTU0NTkwMjUwNywiZXhwIjoxNTQ1OTQ1NzA3LCJpc3MiOiJodHRwOi8vZmNjLmxvY2FsaG9zdDo4MDgwL3VhYS9vYXV0aC90b2tlbiIsInppZCI6IjVlYWEzNjA2LWM4N2ItNDU1ZS1hM2MyLTRlODBhNmZmOGM0NSIsImF1ZCI6W119.cZrj2HGaRDPYamaszHVSZNEtKyV7DsoVuXYS9iLoZ-oNyPfmmz4hR4P_bZGb6ZU8ErFk9OoaeqFkdP6VdVBD_3LjjewqdYiEgWa1crJo8p2TFn8yY4qtwZ1XW6NgJhvqy1TZWFZlRdATZ1B751O9sNBDcBjUz-dgAD-eDL4iwqBYBqoKYp7OgYs8yWf1tPE1aIey4eWFJleGrE2ozxNPQjE1DqG7yWePqg-aC27meRD66IZNcklZWCXkP67XiKXVCdpQ7pAgAZX_XrIGAObOBCC66rYldTvBK0Jg6q0N14cN3hwFDzfB8DUtuyphm4-lHHhm6tW5P3SYb2soJo7F6w',
  config: 
   { uaadomain: 'authentication.sap.hana.ondemand.com',
     trustedclientidsuffix: '|portal-cf-service-tomer1-i330971!b1633',
     tenantmode: 'dedicated',
     sburl: 'https://internal-xsuaa.authentication.sap.hana.ondemand.com',
     clientid: 'sb-portal-cf-service-tomer1-i330971!b1633',
     verificationkey: '-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----',
     xsappname: 'portal-cf-service-tomer1-i330971!b1633',
     identityzone: 'fcc',
     identityzoneid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     clientsecret: 'cns2wKHTl/BsnFMglVXNgSyO4tY=',
     tenantid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     url: 'https://fcc.authentication.sap.hana.ondemand.com' },
  xsappname: 'portal-cf-service-tomer1-i330971!b1633',
  isForeignMode: false,
  tokenContainsAttributes: true,
  tokenContainsAdditionalAuthAttributes: false,
  userInfo: 
   { logonName: 'guy.moskovich@sap.com',
     givenName: 'Guy',
     familyName: 'Moskovich',
     email: 'guy.moskovich@sap.com' },
  scopes: 
   [ 'openid',
     'portal-cf-service-tomer1-i330971!b1633.SuperAdmin',
     'uaa.user',
     [length]: 3 ],
  samlToken: undefined,
  clientId: 'sb-93e0e5b1-7938-4ab6-947f-d8de6d3ecb24!b1633|portal-cf-service-tomer1-i330971!b1633',
  identityZone: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  subdomain: 'fcc',
  origin: 'ldap',
  userAttributes: {},
  additionalAuthAttributes: '',
  serviceinstanceid: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  grantType: 'user_token',
  ssojwt: 
   jwtValidation {
     ssolib: 
      _exports_SSOEXT_TICKET_FUNCTIONS {
        SsoExtEvalJwToken: SwigProxy {},
        SsoExtParseCertificate: SwigProxy {},
        SsoExtGetProperty: SwigProxy {},
        SsoExtSetProperty: SwigProxy {},
        SsoExtLoadKey: SwigProxy {},
        SsoExtGetVersion: SwigProxy {},
        SsoExtShutdown: SwigProxy {},
        SsoExtInitialize: SwigProxy {} },
     jwtInfo: 
      _exports_JWT_INFO {
        tAlgId: 4,
        issuedAt: SwigProxy {},
        lAudience: 2,
        pAudience: '[]}',
        lJTI: 32,
        pJTI: 'h�_�!',
        lIssuer: 41,
        pIssuer: ' ',
        lSubject: 36,
        pSubject: ' ',
        lNameIdValue: 0,
        pNameIdValue: undefined,
        lastError: '',
        lPayLoadBuffer: 1149,
        pPayloadBuffer: SwigProxy {},
        struct_size: 632 },
     certBuffer: null,
     payloadL: 0,
     payload: SwigProxy {},
     version: 1,
     rc: 0 },
  expirationDate: 2018-12-27T21:21:47.000Z }]
[2018-12-27T11:21:47.62+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:58'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/utils/technical-token.js:58 - requestAccessToken - Reqs token at https://fcc.authentication.sap.hana.ondemand.com/oauth/token]
[2018-12-27T11:21:47.62+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:67'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/utils/technical-token.js:67 - requestAccessToken - add additional attributes { tenantId: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  instanceId: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  userName: 'guy.moskovich@sap.com',
  isProvider: 'false' }]
[2018-12-27T11:21:47.63+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceRelativeUrl null, serviceMethod post, options 'SECURE']
[2018-12-27T11:21:47.63+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceMethod post, formData null, requestOptions 'SECURE']
[2018-12-27T11:21:47.76+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token succeeded]
[2018-12-27T11:21:47.76+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl /cdm_store_service/cdm/entities/type/site, serviceMethod get, options 'SECURE']
[2018-12-27T11:21:47.76+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-27T11:21:47.99+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site succeeded]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:38 - SiteEntityController::read() encrypt user name guy.moskovich@sap.com]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:43 - HashUtil::javaHashAndSalt(),  Trying to java hash str guy.moskovich@sap.com]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:45 - HashUtil::javaHashAndSalt(),  java hashed str is -2042027425]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:38 - HashUtil::hashString(), encrypted str is 9d733d6fae6c7119a04e2a8c5588d774]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:43 - SiteEntityController::read() update maas for (encrypted) user name 9d733d6fae6c7119a04e2a8c5588d774]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:29'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:29 - MeteringClient::send() called]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10 - MeteringTokenizer::getToken() called]
[2018-12-27T11:21:47.99+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14 - MeteringTokenizer::getToken() sending get request with clientId=sb-248dd8e1-f81f-4718-a428-4f4153edcdeb!b1633|metering!b4066, clientsecret=JRbdCklU5tU8VCZnUiaMxk6rirQ=, tokenURL=https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials]
[2018-12-27T11:21:47.99+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, options 'SECURE']
[2018-12-27T11:21:47.99+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-27T11:21:48.14+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials succeeded]
[2018-12-27T11:21:48.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:34'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:34 - MeteringClient::send() get metering technical token 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI2YzMwNWIxZjA0MjI0ZjRiYjg2NjRhNzRkNmQ3OGZiNSIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiJ9LCJzdWIiOiJzYi0yNDhkZDhlMS1mODFmLTQ3MTgtYTQyOC00ZjQxNTNlZGNkZWIhYjE2MzN8bWV0ZXJpbmchYjQwNjYiLCJhdXRob3JpdGllcyI6WyJ1YWEucmVzb3VyY2UiXSwic2NvcGUiOlsidWFhLnJlc291cmNlIl0sImNsaWVudF9pZCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImNpZCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImF6cCI6InNiLTI0OGRkOGUxLWY4MWYtNDcxOC1hNDI4LTRmNDE1M2VkY2RlYiFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImdyYW50X3R5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJyZXZfc2lnIjoiOTc5YzI0OGQiLCJpYXQiOjE1NDU5MDI1MDgsImV4cCI6MTU0NTk0NTcwOCwiaXNzIjoiaHR0cDovL2ZjYy5sb2NhbGhvc3Q6ODA4MC91YWEvb2F1dGgvdG9rZW4iLCJ6aWQiOiI1ZWFhMzYwNi1jODdiLTQ1NWUtYTNjMi00ZTgwYTZmZjhjNDUiLCJhdWQiOlsic2ItMjQ4ZGQ4ZTEtZjgxZi00NzE4LWE0MjgtNGY0MTUzZWRjZGViIWIxNjMzfG1ldGVyaW5nIWI0MDY2IiwidWFhIl19.BatrM61xvexINBOhDTg4mQCukShZ0ANtdGFbzbFXXmdO0X2PX7pzaWtIRide0qCI1u3JG142Keu_fcq6zYMPM7fHQNpI_DuxOsCOWeRVPxAfxSlaQdxN6eHXNeRf4cdV6bvYrACgTuz-Rzx4Lt7kRZN7G0ZI2iFLfTQCyDl3W2jrqVOgQAH6E5jOZC4loqJlRUC9V5KMcGNEWNqcjk5gl2KtHu_-dsfmJnX2WTX1CC8nHyOkxItIkkq9xo-cXPmAvXO7se3bHRh1K9EcUQ-1eEhBdAYJoE_hAIb5EYHhsr3DBL7Tn8hq4SvZOwrj2p41KhCUL_-aw2NE00KxAIM2Bg']
[2018-12-27T11:21:48.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:17'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:17 - MeteringClient::getRegion() called]
[2018-12-27T11:21:48.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:20'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:20 - MeteringClient::getRegion() extracting region sap from https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents]
[2018-12-27T11:21:48.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8 - MeteringRequestBuilder::buildRequestBody() for user=9d733d6fae6c7119a04e2a8c5588d774, identityZone=5eaa3606-c87b-455e-a3c2-4e80a6ff8c45, region=sap]
[2018-12-27T11:21:48.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:36'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:36 - MeteringClient::send() get metering request body { usage: 
   [ { timestamp: '2018-12-27T09:21:48.150',
       service: { id: 'portal', plan: 'default' },
       consumer: 
        { environment: 'CF',
          region: 'cf-sap',
          subAccount: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
          user: '9d733d6fae6c7119a04e2a8c5588d774' },
       measures: [ { id: 'admins', value: 1 }, [length]: 1 ] },
     [length]: 1 ] }. Sending put request for url https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents]
[2018-12-27T11:21:48.15+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents, serviceMethod put, options 'SECURE']
[2018-12-27T11:21:48.15+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents, serviceMethod put, formData null, requestOptions 'SECURE']
[2018-12-27T11:21:48.32+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://maas-metering.cfapps.sap.hana.ondemand.com/usage/v2/usage/documents succeeded]
[2018-12-27T11:21:48.32+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:45 - SiteEntityController::read() maas result='']
[2018-12-27T11:21:48.33+0200] [INFO] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [Custom Fields not found] [9d19e0ef-d263-4730-72fa-e6fd907404d4] [Log Message not found]



-> development plan
[i500695@C02X632CJGH6:2018-12-26 10:46:40:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]510$ cflogsNice.sh portal-cf-site-semantic-service
[2018-12-26T10:46:57.66+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:31'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/utils/config/config-utils.js:31 - isClpScenario]
[2018-12-26T10:46:57.66+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/utils/config/config-utils.js:11'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/utils/config/config-utils.js:11 - initClpInstanceId]
[2018-12-26T10:46:57.67+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:25'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:25 - SiteEntityController::read() called]
[2018-12-26T10:46:57.68+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:33'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:33 - SiteEntityController::read() read all sites. authInfo=SecurityContext {
  token: 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI0YzhmNDlhZDFhOGY0NjMwYTk3MWE4MDk5Y2UzMzRkNCIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCJ9LCJ4cy51c2VyLmF0dHJpYnV0ZXMiOnt9LCJncmFudGVkX3Njb3BlcyI6WyJvcGVuaWQiLCJwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMy5TdXBlckFkbWluIiwidWFhLnVzZXIiXSwieHMuc3lzdGVtLmF0dHJpYnV0ZXMiOnsieHMucm9sZWNvbGxlY3Rpb25zIjpbInN1cGVyQWRtaW4iXX0sImdpdmVuX25hbWUiOiJZb3NpIiwiZmFtaWx5X25hbWUiOiJJemFxIiwic3ViIjoiNjEzNTMwZWEtMjJjZi00YWQ1LWEwZmEtM2ZkOTdhMTM5NWEwIiwic2NvcGUiOlsib3BlbmlkIiwicG9ydGFsLWNmLXNlcnZpY2UtdG9tZXIxLWkzMzA5NzEhYjE2MzMuU3VwZXJBZG1pbiIsInVhYS51c2VyIl0sImNsaWVudF9pZCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsImNpZCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsImF6cCI6InNiLTkzZTBlNWIxLTc5MzgtNGFiNi05NDdmLWQ4ZGU2ZDNlY2IyNCFiMTYzM3xwb3J0YWwtY2Ytc2VydmljZS10b21lcjEtaTMzMDk3MSFiMTYzMyIsInJldm9jYWJsZSI6dHJ1ZSwiZ3JhbnRfdHlwZSI6InVzZXJfdG9rZW4iLCJ1c2VyX2lkIjoiNjEzNTMwZWEtMjJjZi00YWQ1LWEwZmEtM2ZkOTdhMTM5NWEwIiwib3JpZ2luIjoibGRhcCIsInVzZXJfbmFtZSI6Inlvc2kuaXphcUBzYXAuY29tIiwiZW1haWwiOiJ5b3NpLml6YXFAc2FwLmNvbSIsImF1dGhfdGltZSI6MTU0NTgxMzYyOSwicmV2X3NpZyI6IjU2MTgwM2RiIiwiaWF0IjoxNTQ1ODEzNjMwLCJleHAiOjE1NDU4NTY4MzAsImlzcyI6Imh0dHA6Ly9mY2MubG9jYWxob3N0OjgwODAvdWFhL29hdXRoL3Rva2VuIiwiemlkIjoiNWVhYTM2MDYtYzg3Yi00NTVlLWEzYzItNGU4MGE2ZmY4YzQ1IiwiYXVkIjpbXX0.oTh_Tg8jkkLAX1R8MFnrpv9te6qjaDgIFx1Sq7okPBxdamjpeLilhtR_KeubjAb8s2xtGG7doJayNCvSB07-mJhfPHx9WJKqWe_mMlFNKKJ0E11tIaR7t34fz2WWQfdsrgw8834EZ6uLbpYfMjqCUlOxKZeXz-rxfSNadSd0CUD2Wm3iG-MznLy1vG_3RhRfnKtzCfrGCs6fhi915_rs9z-kNWrsK_GsmtBKKvIKxcOvSXsDy5TiHIHMDPu4Cgb6-zF6cPCTVGZkxHmuSnzb424GGrTxN3cFthRsoo7R7w_97VnzSxC-JhyDgubqXIu6J48MZqdv-_zK3mbTAnvB5w',
  config: 
   { uaadomain: 'authentication.sap.hana.ondemand.com',
     trustedclientidsuffix: '|portal-cf-service-tomer1-i330971!b1633',
     tenantmode: 'dedicated',
     sburl: 'https://internal-xsuaa.authentication.sap.hana.ondemand.com',
     clientid: 'sb-portal-cf-service-tomer1-i330971!b1633',
     verificationkey: '-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----',
     xsappname: 'portal-cf-service-tomer1-i330971!b1633',
     identityzone: 'fcc',
     identityzoneid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     clientsecret: 'cns2wKHTl/BsnFMglVXNgSyO4tY=',
     tenantid: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
     url: 'https://fcc.authentication.sap.hana.ondemand.com' },
  xsappname: 'portal-cf-service-tomer1-i330971!b1633',
  isForeignMode: false,
  tokenContainsAttributes: true,
  tokenContainsAdditionalAuthAttributes: false,
  userInfo: 
   { logonName: 'yosi.izaq@sap.com',
     givenName: 'Yosi',
     familyName: 'Izaq',
     email: 'yosi.izaq@sap.com' },
  scopes: 
   [ 'openid',
     'portal-cf-service-tomer1-i330971!b1633.SuperAdmin',
     'uaa.user',
     [length]: 3 ],
  samlToken: undefined,
  clientId: 'sb-93e0e5b1-7938-4ab6-947f-d8de6d3ecb24!b1633|portal-cf-service-tomer1-i330971!b1633',
  identityZone: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  subdomain: 'fcc',
  origin: 'ldap',
  userAttributes: {},
  additionalAuthAttributes: '',
  serviceinstanceid: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  grantType: 'user_token',
  ssojwt: 
   jwtValidation {
     ssolib: 
      _exports_SSOEXT_TICKET_FUNCTIONS {
        SsoExtEvalJwToken: SwigProxy {},
        SsoExtParseCertificate: SwigProxy {},
        SsoExtGetProperty: SwigProxy {},
        SsoExtSetProperty: SwigProxy {},
        SsoExtLoadKey: SwigProxy {},
        SsoExtGetVersion: SwigProxy {},
        SsoExtShutdown: SwigProxy {},
        SsoExtInitialize: SwigProxy {} },
     jwtInfo: 
      _exports_JWT_INFO {
        tAlgId: 4,
        issuedAt: SwigProxy {},
        lAudience: 2,
        pAudience: '',
        lJTI: 32,
        pJTI: '8�9�W',
        lIssuer: 41,
        pIssuer: '',
        lSubject: 36,
        pSubject: '',
        lNameIdValue: 0,
        pNameIdValue: undefined,
        lastError: '',
        lPayLoadBuffer: 1124,
        pPayloadBuffer: SwigProxy {},
        struct_size: 632 },
     certBuffer: null,
     payloadL: 0,
     payload: SwigProxy {},
     version: 1,
     rc: 0 },
  expirationDate: 2018-12-26T20:40:30.000Z }]
[2018-12-26T10:46:57.68+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:58'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/utils/technical-token.js:58 - requestAccessToken - Reqs token at https://fcc.authentication.sap.hana.ondemand.com/oauth/token]
[2018-12-26T10:46:57.68+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/utils/technical-token.js:67'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/utils/technical-token.js:67 - requestAccessToken - add additional attributes { tenantId: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
  instanceId: '93e0e5b1-7938-4ab6-947f-d8de6d3ecb24',
  userName: 'yosi.izaq@sap.com',
  isProvider: 'false' }]
[2018-12-26T10:46:57.68+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceRelativeUrl null, serviceMethod post, options 'SECURE']
[2018-12-26T10:46:57.68+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token, serviceMethod post, formData null, requestOptions 'SECURE']
[2018-12-26T10:46:57.82+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token succeeded]
[2018-12-26T10:46:57.82+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl /cdm_store_service/cdm/entities/type/site, serviceMethod get, options 'SECURE']
[2018-12-26T10:46:57.82+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-26T10:46:57.95+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://portal-service-tomer1-i330971.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/site succeeded]
[2018-12-26T10:46:57.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:38 - SiteEntityController::read() encrypt user name yosi.izaq@sap.com]
[2018-12-26T10:46:57.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:25'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:25 - HashUtil::hashString(), *Remove Log after integration* Trying to hash str yosi.izaq@sap.com]
[2018-12-26T10:46:57.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:43 - HashUtil::javaHashAndSalt(),  Trying to java hash str yosi.izaq@sap.com]
[2018-12-26T10:46:57.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:45 - HashUtil::javaHashAndSalt(),  java hashed str is 1375615000]
[2018-12-26T10:46:57.95+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:36'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:36 - HashUtil::hashString(), hash is 49,51,55,53,54,49,53,48,48,48,102,72,68,60,85,72,82,67,115,109,60,35,83,38,81,75,62,118,40,98,64,46,43,33,119,52,126,93,106,57,78,91,91,109,40,45,121,91,58,59,99,87,89,117,74,104,35,119,69,69,97,119,114,43,50,54,74,39,85,121,82,102,95,87,126,100,38,47,58,94,103,56,61,38,94,99,102,90,106,71,47,89,56,69,85,55,87,86,36,115,76,87,126,67,100,45,41,36,99,116,112,100,72,52,114]
[2018-12-26T10:46:57.96+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/utils/hash-util.js:38'}] [correlationId not found] [portal-cf-site-semantic-service/utils/hash-util.js:38 - HashUtil::hashString(), encrypted str is 955b0bb3354941e3b62176be1bee4170]
[2018-12-26T10:46:57.96+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:43'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:43 - SiteEntityController::read() update maas for (encrypted) user name 955b0bb3354941e3b62176be1bee4170]
[2018-12-26T10:46:57.96+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:31'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:31 - MeteringClient::send() called]
[2018-12-26T10:46:57.96+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:10 - MeteringTokenizer::getToken() called]
[2018-12-26T10:46:57.96+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-tokenizer.js:14 - MeteringTokenizer::getToken() sending get request with clientId=sb-3beb469d-fdc2-4b0f-8de0-6a2f2f22cafa!b1633|metering!b4066, clientsecret=tIFDKHZqldICGH2kG0ZJ7AKvSdE=, tokenURL=https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials]
[2018-12-26T10:46:57.96+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, options 'SECURE']
[2018-12-26T10:46:57.96+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials, serviceMethod get, formData null, requestOptions 'SECURE']
[2018-12-26T10:46:58.10+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://fcc.authentication.sap.hana.ondemand.com/oauth/token?grant_type=client_credentials succeeded]
[2018-12-26T10:46:58.10+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:33'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:33 - MeteringClient::send() get metering technical token 'eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vZmNjLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoia2V5LWlkLTEiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiJlMTZhZTZkMjcwMTU0YTI1YTAxYzcwOGY0OTEyM2RkNiIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJmY2MiLCJzZXJ2aWNlaW5zdGFuY2VpZCI6IjNiZWI0NjlkLWZkYzItNGIwZi04ZGUwLTZhMmYyZjIyY2FmYSJ9LCJzdWIiOiJzYi0zYmViNDY5ZC1mZGMyLTRiMGYtOGRlMC02YTJmMmYyMmNhZmEhYjE2MzN8bWV0ZXJpbmchYjQwNjYiLCJhdXRob3JpdGllcyI6WyJ1YWEucmVzb3VyY2UiXSwic2NvcGUiOlsidWFhLnJlc291cmNlIl0sImNsaWVudF9pZCI6InNiLTNiZWI0NjlkLWZkYzItNGIwZi04ZGUwLTZhMmYyZjIyY2FmYSFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImNpZCI6InNiLTNiZWI0NjlkLWZkYzItNGIwZi04ZGUwLTZhMmYyZjIyY2FmYSFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImF6cCI6InNiLTNiZWI0NjlkLWZkYzItNGIwZi04ZGUwLTZhMmYyZjIyY2FmYSFiMTYzM3xtZXRlcmluZyFiNDA2NiIsImdyYW50X3R5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJyZXZfc2lnIjoiNzYyM2I1ZDgiLCJpYXQiOjE1NDU4MTQwMTgsImV4cCI6MTU0NTg1NzIxOCwiaXNzIjoiaHR0cDovL2ZjYy5sb2NhbGhvc3Q6ODA4MC91YWEvb2F1dGgvdG9rZW4iLCJ6aWQiOiI1ZWFhMzYwNi1jODdiLTQ1NWUtYTNjMi00ZTgwYTZmZjhjNDUiLCJhdWQiOlsidWFhIiwic2ItM2JlYjQ2OWQtZmRjMi00YjBmLThkZTAtNmEyZjJmMjJjYWZhIWIxNjMzfG1ldGVyaW5nIWI0MDY2Il19.uqSqmcAAk13jod7a9rpmmQ4t9J76_N2uKlBjbgyWYcc_Ijsb609bhpa1e2S9xXkseR0q-c197CA_xdpiG-0d4rO_J1e9LC20kDTh9LL1gWY4DleB1KHI5jvjucmGOA5FM9UiA0-waAjU83BGqHMGq1YI3EX19rMxgjXP-IlJMZYiB6tyROb9gfKD4girFc_NNLA7fgrmPSKA9yt5DiVfbF8OxruDKhDnrePUEGm5pW7OK23MiZoTFC8MdMHwUMa3hNb-L2tJBYvDtKm8NKOzdRG-pkhI26pHiQ8OKvA4EQ7BVyKS0YzjwXOacAyR_T0dcQCqFSlsn7bDaJ0mc-SxEg']
[2018-12-26T10:46:58.10+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:19'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:19 - MeteringClient::getRegion() called]
[2018-12-26T10:46:58.11+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:22'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:22 - MeteringClient::getRegion() extracting region sap from https://maas-metering.cfapps.sap.hana.ondemand.com/dev/usage/v2/usage/documents]
[2018-12-26T10:46:58.11+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-request-builder.js:8 - MeteringRequestBuilder::buildRequestBody() for user=955b0bb3354941e3b62176be1bee4170, identityZone=5eaa3606-c87b-455e-a3c2-4e80a6ff8c45, region=sap]
[2018-12-26T10:46:58.11+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/src/services/metering/metering-client.js:35'}] [correlationId not found] [portal-cf-site-semantic-service/src/services/metering/metering-client.js:35 - MeteringClient::send() get metering request body { usage: 
   [ { timestamp: '2018-12-26T08:46:58.110',
       service: { id: 'portal', plan: 'default' },
       consumer: 
        { environment: 'CF',
          region: 'cf-sap',
          org: '5eaa3606-c87b-455e-a3c2-4e80a6ff8c45',
          user: '955b0bb3354941e3b62176be1bee4170' },
       measures: [ { id: 'admins', value: 1 }, [length]: 1 ] },
     [length]: 1 ] }. Sending put request for url https://maas-metering.cfapps.sap.hana.ondemand.com/dev/usage/v2/usage/documents]
[2018-12-26T10:46:58.11+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:39'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:39 - request - serviceAbsoluteUrl null, serviceRelativeUrl https://maas-metering.cfapps.sap.hana.ondemand.com/dev/usage/v2/usage/documents, serviceMethod put, options 'SECURE']
[2018-12-26T10:46:58.11+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:118'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:118 - request - Service request url https://maas-metering.cfapps.sap.hana.ondemand.com/dev/usage/v2/usage/documents, serviceMethod put, formData null, requestOptions 'SECURE']
[2018-12-26T10:46:58.15+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [{'location': 'portal-cf-shared-lib/common/service-request.js:122'}] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [portal-cf-shared-lib/common/service-request.js:122 - request - Request to https://maas-metering.cfapps.sap.hana.ondemand.com/dev/usage/v2/usage/documents succeeded]
[2018-12-26T10:46:58.15+0200] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:45'}] [correlationId not found] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:45 - SiteEntityController::read() maas result='']
[2018-12-26T10:46:58.15+0200] [INFO] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [Custom Fields not found] [33ff9f5e-6d9e-4aa2-5706-52f143126d06] [Log Message not found]
->
                1.1.2.2.3

            1.1.2.3 sample application
Sample app:
https://github.wdf.sap.corp/CF-PROVISIONING/sample-saas-applications
Metering code: https://github.wdf.sap.corp/CF-PROVISIONING/sample-saas-applications/tree/master/sample-saas-application/src/main/java/com/sap/hcp/lm/sa/metering
Docs: https://github.wdf.sap.corp/CF-PROVISIONING/sample-saas-applications/wiki/Using-Metering-as-a-Service
 
            1.1.2.4
        1.1.3 Cred-store

            1.1.3.1 Semantic store salt key in cred-store


-> Emails
From: Wimmer, Boaz 
Sent: Tuesday, January 8, 2019 1:29 PM
To: Profesorsky, Run <run.profesorsky@sap.com>
Subject: RE: Metering DevOps finalization - minutes
 
Just to emphasize, after the semantic-service app will be deployed to live, you will need to follow the below procedure, so that the key will be added to the credentials store.
The various parameters are available in the env variables (e.g. oauth_token_url).
 
Her'e an example:
 
java -jar cred-store-client-1.0.0-jar-with-dependencies.jar 6b9de4b8-53e9-4081-b178-5c1779914596 MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDgCVnK9CDVBhsRCaPnN7Qf5BWJg6iVZOi0EYA5BoWg11SV7s3GGBTNfUyQL1IOmA2EmC9jy2i3UE9FDkf9FiHeKHPJMe0FJnLqAoywqFvw8SdjWu7EcmvUt9bW1eHAXLU13CZ8DP2hyVI0WXiQ2st3CugE8Gg2K6lHajx+gTC4Rg3ByM1cW6WaPvBF8LZNOEkgvGk8pTzUCfzYlFyVSpCG+uny0q8WQ8RZ9ShauDPSSQe4bWgeqDED5qExUWc0R8oQhixe8QztyL2ULP0Xazyh9w4T8jrb4iFXGT4NzmiSAW/kBtlhrd1r5uuTwV9qqdx5dnGCiBOKvd/2CkWnMwGNAgMBAAECggEBAKBpcZak+EEvLwAjA+2Rb/KJsHYXBAV8DDaqdUHfjpycsZ7tLv9QzMxZlBGFIF78tmkjQoNU6LSg1zFdyWPIjhVwp37+tXRDlHJDwxLWaYZ6VTaJrH6SYu0beMO4vvyqJMHc0N1vu8c0zBxZl784OgkRkRHARQ3Mc1eEFK6LuCOoBaHSOjwDgwAvoVH0isHm0dkrTHBB0r7qbD38/MDgqxmqXQzuV7beNDRRWi51q2tWlkvoA0IxjFEyZTFBPYILuylSPv/MHP8Fc62RqiK4oD14zZda89w553wIBW4KSppezdP9hMmpgNLpd4cbLMss2N+W2EpbDKUip/uEELyosQ0CgYEA/txtfacd+GfSRfyYpmosNRz4hyfl4hnHWg0fQxHZsqSFN5KfIKr+bVltEV9BZpugJ1G2dJGwTaUSUO9wIGaDOpUVoOZL2HkBo0ubcfYI6gYP0yDKZ1Wt5J/9HgMyAmecT1mmM4Bi4rjnTl7zURWjkD35AQTzuhOaM/KScHgiNWcCgYEA4Qmoj6aWu3b8ZhsSMeIcc5hqjR0kX8fjIuNS9HtuDUOQvGEtAC/qUdU2N1WiNNMYtKf+X8J4um8DEKzcOd9mE0a1uXSfvryBIF3C5rAtkW2/1e3gixiJ4SDiUkwcgeXYIjudSCGqlwkeHnG71GSFLSktaF2+pWTr9ww5U9n6pOsCgYB3Ly4k7NofKK40/IOGj3BNBldTHV1r9xI7EpfkDZz45edGrdKsvEpvaLqQvTMggPbMbHIe4WLJbMC8CL0u6cHEy6Nps0kU2sHhU6JGEQDqMBuGaHc/C9peaFM+jc/9P+bhVNNcklWsITxKciznZm8vLUwdJeu0wSYD1RSWdBfLUQKBgAi5pCR1tBBuq5iV4h23A51jwnXYNGnWSTM4FyZNhtXS0dDL/7+rG+2yU5jPpCtiJ+oRPWafFqk71qWV3jAMPlvu+OrI38y4aFVF7WGeYRXraG21/GfIOshUyxGfy9cpfzjMkOuUCpYyj01k4YB5qUQ3/X+3asXk5NU+Txa2M+ajAoGAa+onR4uqUg1t/4kofotANxcYAauvE32GouB7ZNTH6CWtxRMzsBJ0wABBinwZ0YGQ0uJlWramdeu345XzEYXAoctX9ggo3FQGhtkszVaK6szabwQd8chXMzTUtl+OxOAXyF5RX+faZUooOpm9wTlLK1QpJfdiyUHd7LLG4yHaT7A= https://credstoreauth.cfapps.sap.hana.ondemand.com/api/v1/token metering_service_username_salt "fHD<UHRCsm<#S&QK>v(b@.+\\!w4~]j9N[[m(-y[:;cWYuJh#wEEawr+26J'UyRf_W~d&/:^g8=&^cfZjG/Y8EU7WV$sLW~Cd-)$ctpdH4r" https://credstore.cfapps.sap.hana.ondemand.com/api/v1/credentials
 


Best Regards,
Boaz
 
From: Wimmer, Boaz 
Sent: Monday, January 7, 2019 2:45 PM
To: Profesorsky, Run <run.profesorsky@sap.com>
Subject: FW: Metering DevOps finalization - minutes
 
FYI
 
Best Regards,
Boaz
 
From: Omri, Tomer 
Sent: Sunday, January 6, 2019 3:29 PM
To: Moskovich, Guy <guy.moskovich@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Wimmer, Boaz <boaz.wimmer@sap.com>; Benjamin, Nir <nir.benjamin@sap.com>; Sklarski, Tsafrir <tsafrir.sklarski@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Neiderman, Erez <erez.neiderman@sap.com>; Blechman, Dean <dean.blechman@sap.com>
Cc: Dagan, Saar <saar.dagan@sap.com>
Subject: Re: Metering DevOps finalization - minutes
 
Hi,
 
Following our meeting today, we have created a jar file that will store (key and value) data in Credential Store:
https://github.wdf.sap.corp/i324180/cred-store-client
 
 
After the binding of the Semantic service to the Credential store is completed, from the VCAP_SERVICES, under “credstore” get the following parameters:
"VCAP_SERVICES"."credstore"."credentials"."username"
"VCAP_SERVICES"."credstore"."credentials"."private_key "
"VCAP_SERVICES"."credstore"."credentials"."oauth_token_url "
"VCAP_SERVICES"."credstore"."credentials"."url"
 
 
 
Run in terminal: java -jar cred-store-client-1.0.0-jar-with-dependencies.jar username private_key oauth_token_url key value url
 
 
 
 
Example:
java -jar cred-store-client-1.0.0-jar-with-dependencies.jar
4dc2d568-d03d-4ab2-a181-673706efd5a6 nH18ZWS99wLB6b48/97U8k3ZvQPBurXRrI0QOuxH0wKBgQCXJTxZrSNYaSk9upeJiAEnu6HiNIqnlGjGHCMMioPwuohFiiK4FExP
https://credstoreauth.cfapps.sap.hana.ondemand.com/api/v1/token metering_service_username_salt ValuePasswordSalt https://credstore.cfapps.sap.hana.ondemand.com/api/v1/credentials

-> private key, ask access from Boaz w.
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Setting+Up+a+New+Data+Center+Checklist

-> My CLI commands
  234  mkdir git
  235  cd git/
  236  mkdir i324180
  237  cd i324180
  238  git clone https://github.wdf.sap.corp/i324180/cred-store-client.git
  239  cd cred-store-client/
  240  cat README.md 
  241  mvn clean compile assembly:single
  242  java -jar target/cred-store-client-1.0.0-jar-with-dependencies.jar  048be92a-83a1-4079-93a7-d96fcf1ad685 MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQC9O2fJJ27sWS/r8LjlNEcSlDSPncOueHlMIyeG2UeK2S2f8r7mDvVd6yp3tVXpLRNdgl6vXUUjYe/pP5BrsOTgyxXqnbcL9jjip2xKy5mXSu/B6KmkKGkf65w4sjQ/jO3Srno18Qq+ty8djzH3SZebrfw68cD1bSOrsemsvfCGV5F7bY0aQF5jr6Iw7pw+mSW4uddl85u14C1t4/bfGF3/1nNChltWl3egBeix00aGO823+U3+dWd48Px9tBypHCNSXpMWzsRvGEFj8z/i8qICEFKbvEh07JGiqUhN+NgrYTl8FW7dWmkWpoESmT6m/X6qxz2I7oBJPj/p2JHVL2ENAgMBAAECggEBAK1OG7YxRDh3Uhk+xMc9wp20WBLzxQQj18swIwIwOoJidpOXaNgf+P4D40fxLnY4TxUD0h2/SROnnWY8TdMjFer+c9sEiGEPJngGJ3q0zryt57jqkXsDe4u9Z7zREGLneePK4ahHUrTp5d+nhnZY0t3EUU3WnQbo5pNXhJAtAHy3XgpTN9ZIxrb0BQgGNVdMmum9a6mU1yH2SQd0YJq+lQHrKOYWqnsPcQKog/oYJIwSj0Jyyo2N8AoOeiWVsnSM9zo1k3A7Mj/AKl3XHoDYaGYeZHbfsLam+PXHvilcOxm84OdUPmrtMDBzTWY3xkKVjpIfJR1t+PVKKj7pGMcMnE0CgYEA+RfNkUZU60e6KYH2wJoUXAFvBoPMp9N58DrfBZXpLAL1VurK3RgugqEMEg/rfnThYjhKbsWEH/4aeZZJt78CRXciyMOjISxufcE3ludzmtvUEP5+yBwkERPLBIiOF6wb6k8gFyt9k+OknBNdWPux/j6jLkO45sCrxQpQVf8naZ8CgYEAwnqtVldYG/XHNh74e8A3i3StZkM4mmonX+xVyeRn8cgx+H0UglgCiGd8zVg0+noZ5Rt8RALjSorRPRzXgo1WAsMefXaHwll3nji3P5lAqEFp+OM6EL0RO8vGsyw8Yh4VptmCdg/k8u3WREZGIsMOlwzwanlwuNAquAOdM+GBzdMCgYEA2kuL8darMQ5JDXtCHgRp9z+iZxk2T5W7dVaCgMih8dod3DAj3KMGj6BHjcS54rbXllYylOUwJ0FvPkMBE7Cncu03ZK5e1gG0Syz7ZJot6/be4I3H2eMfkH/CGZT6wbApPqxdOTD5+pMzfTxTQFpD4MZQB4l+D2umnSWuxc64YY0CgYEAp+6k5QyRIbuupLZDnSCTFhHPdaGQLA6EJ5l9TtOzSh2zwL3JSvBSZ5TtOKf1P2DWIXcFa/kOaZzLJzlTgwEmh0YTewUyH4l/+BlDa2Cba27o4ijcR/3q9rZ0wtzs21DdI3Fo7Se2bGshfV0tTPEgFSDwLRDmXEAs0y8TvOv6WU8CgYB4/K2BqNiFXZsgrgFcUVUV+W/KLncxPPq55t2A+vqIoJ+x2zD6V72jDw5XlNw8PUq9AgWF/Juk/4NrzYR/7Y+ZxJxsQTSzyXcLJeVVK9P8tFWYjBXwx2WhCvfN5lrI37Vjumsc1x2VdcifNFmZc/BxpKZwDNiHkhDlSl84wef5vQ== https://credstoreauth.cfapps.sap.hana.ondemand.com/api/v1/token metering_service_username_salt fHD<UHRCsm<#S&QK>v(b@.+!w4~]j9N[[m(-y[:;cWYuJh#wEEawr+26J'UyRf_W~d&/:^g8=&^cfZjG/Y8EU7WV$sLW~Cd-)$ctpdH4r  https://credstore.cfapps.sap.hana.ondemand.com/api/v1/credentials 
  243  ed ~/temp/salt
  244  cat ~/temp/salt
  245  java -jar target/cred-store-client-1.0.0-jar-with-dependencies.jar  048be92a-83a1-4079-93a7-d96fcf1ad685 MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQC9O2fJJ27sWS/r8LjlNEcSlDSPncOueHlMIyeG2UeK2S2f8r7mDvVd6yp3tVXpLRNdgl6vXUUjYe/pP5BrsOTgyxXqnbcL9jjip2xKy5mXSu/B6KmkKGkf65w4sjQ/jO3Srno18Qq+ty8djzH3SZebrfw68cD1bSOrsemsvfCGV5F7bY0aQF5jr6Iw7pw+mSW4uddl85u14C1t4/bfGF3/1nNChltWl3egBeix00aGO823+U3+dWd48Px9tBypHCNSXpMWzsRvGEFj8z/i8qICEFKbvEh07JGiqUhN+NgrYTl8FW7dWmkWpoESmT6m/X6qxz2I7oBJPj/p2JHVL2ENAgMBAAECggEBAK1OG7YxRDh3Uhk+xMc9wp20WBLzxQQj18swIwIwOoJidpOXaNgf+P4D40fxLnY4TxUD0h2/SROnnWY8TdMjFer+c9sEiGEPJngGJ3q0zryt57jqkXsDe4u9Z7zREGLneePK4ahHUrTp5d+nhnZY0t3EUU3WnQbo5pNXhJAtAHy3XgpTN9ZIxrb0BQgGNVdMmum9a6mU1yH2SQd0YJq+lQHrKOYWqnsPcQKog/oYJIwSj0Jyyo2N8AoOeiWVsnSM9zo1k3A7Mj/AKl3XHoDYaGYeZHbfsLam+PXHvilcOxm84OdUPmrtMDBzTWY3xkKVjpIfJR1t+PVKKj7pGMcMnE0CgYEA+RfNkUZU60e6KYH2wJoUXAFvBoPMp9N58DrfBZXpLAL1VurK3RgugqEMEg/rfnThYjhKbsWEH/4aeZZJt78CRXciyMOjISxufcE3ludzmtvUEP5+yBwkERPLBIiOF6wb6k8gFyt9k+OknBNdWPux/j6jLkO45sCrxQpQVf8naZ8CgYEAwnqtVldYG/XHNh74e8A3i3StZkM4mmonX+xVyeRn8cgx+H0UglgCiGd8zVg0+noZ5Rt8RALjSorRPRzXgo1WAsMefXaHwll3nji3P5lAqEFp+OM6EL0RO8vGsyw8Yh4VptmCdg/k8u3WREZGIsMOlwzwanlwuNAquAOdM+GBzdMCgYEA2kuL8darMQ5JDXtCHgRp9z+iZxk2T5W7dVaCgMih8dod3DAj3KMGj6BHjcS54rbXllYylOUwJ0FvPkMBE7Cncu03ZK5e1gG0Syz7ZJot6/be4I3H2eMfkH/CGZT6wbApPqxdOTD5+pMzfTxTQFpD4MZQB4l+D2umnSWuxc64YY0CgYEAp+6k5QyRIbuupLZDnSCTFhHPdaGQLA6EJ5l9TtOzSh2zwL3JSvBSZ5TtOKf1P2DWIXcFa/kOaZzLJzlTgwEmh0YTewUyH4l/+BlDa2Cba27o4ijcR/3q9rZ0wtzs21DdI3Fo7Se2bGshfV0tTPEgFSDwLRDmXEAs0y8TvOv6WU8CgYB4/K2BqNiFXZsgrgFcUVUV+W/KLncxPPq55t2A+vqIoJ+x2zD6V72jDw5XlNw8PUq9AgWF/Juk/4NrzYR/7Y+ZxJxsQTSzyXcLJeVVK9P8tFWYjBXwx2WhCvfN5lrI37Vjumsc1x2VdcifNFmZc/BxpKZwDNiHkhDlSl84wef5vQ== https://credstoreauth.cfapps.sap.hana.ondemand.com/api/v1/token metering_service_username_salt $(cat ~/temp/salt)   https://credstore.cfapps.sap.hana.ondemand.com/api/v1/credentials 
  246  rm ~/temp/salt 
  247  greph json
  248  greph python
  249  cf t -s metering-live
  250  cf t -o site-manager -s metering-live
  251  cf a | seman
  252  cf a | grep seman
  253  cf e portal-cf-site-semantic-service > ~/temp/semanticEnv
  254  cf e portal-cf-site-semantic-service 
  255  cf e portal-cf-site-semantic-service > ~/temp/semanticEnv
  256  cat ~/temp/semanticEnv >  python -c 'import sys, json; print json.load(sys.stdin)["metering-service"]'
  257  cat ~/temp/semanticEnv 
  258  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)["metering-service"]'
  259  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)[ "VCAP_SERVICES"]["metering-service"]'
  260  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)[ "VCAP_SERVICES"]["metering-service"]["credentials"]'
  261  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)[ "VCAP_SERVICES"]["metering-service"][0]["credentials"]'
  262  cat ~/temp/semanticEnv 
  263  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)[ "VCAP_SERVICES"]["metering-service"][0]["credentials"]'
  264  h
  265  cat ~/temp/semanticEnv |  python -c 'import sys, json; print json.load(sys.stdin)[ "VCAP_SERVICES"]["credstore"][0]["credentials"]'

->

            1.1.3.2
        1.1.4
    1.2 Delete site



        1.2.3

    1.3 Features Toggles

        1.3.1 research 

            1.3.1.1 Feature Flags

                1.3.1.1.1 Feature Flags API 
https://help.sap.com/viewer/2250efa12769480299a1acd282b615cf/Cloud/en-US/06d13e8b5f234d3cb8a555e5988337c0.html
Using the Evaluation API

You can evaluate the feature flags using the evaluation API with both Boolean and String response types.

Note
The simplified evaluation API is applicable only for Boolean feature flags. See Using the Simplified Evaluation API.
Routes

GET /api/v2/evaluate/{feature_flag_name}

Request Parameters

Path

Parameter
Required
Data Type
Description
feature_flag_name
Yes
String
Name of the feature flag, it has to be unique for a particular service instance.
Query

Parameter
Required
Data Type
Description
identifier
Only if the evaluated feature flag has either direct deliveries or a percentage delivery as part of its strategy.
String
Specifies the application specific tenant, for which the evaluation is performed.
errorVariation
No
Integer
Specifies the index of the variation that will be returned (indexing starts from 1) as part of the evaluation response if an error occurs during the evaluation. In case this parameter is not specified, variation 1 returned.
Examples

GET /api/v2/evaluate/<feature_flag_name>?identifier=company_id

GET /api/v2/evaluate/<feature_flag_name>?errorVariation=2

GET /api/v2/evaluate/<feature_flag_name>?identifier=company_id&errorVariation=2

Note
The identifier query parameter is mandatory only if the evaluated feature flag has either direct deliveries or a percentage delivery as part of its strategy.

The errorVariation is optional and the variation it refers to will be returned in case of the error.
Responses

Status Code 200 OK

The evaluation request is successful. The response body contains the featureName, type, variation fields.

{
    "featureName": "<feature_flag_name>",
    "type": "<feature_flag_response_type>",
    "variation": "<variation_value_returned_from_evaluation>"
}
For example, in the simplest case you have an active Boolean feature flag called my_new_feature with no strategy. The evaluation call looks like this:

GET /api/v2/evaluate/my_new_feature

{
    "featureName": "my_new_feature",
    "type": "Boolean",
    "variation": "true"
}
Status Code 400 BAD REQUEST

In case you have an active feature flag with a direct delivery strategy defined and you haven't provided an identifier:

Note
The variation, type and featureName fields are still part of the response body even when the response is not 200 OK. In such cases additional fields are added to the response body that describe the error.
{
    "httpStatus": 400,
    "message": "Input validation error",
    "errors": [
        "request :: Query parameter [identifier] must be provided in order to evaluate the specified feature"
    ],
    "featureName": "my_string_flag_name",
    "type": "STRING",
    "variation": "my variation 1"
}
Status Code 404 NOT FOUND

If the feature flag that is evaluated does not exist in the particular service instance.

{
    "httpStatus": 404
}
Status Code 500 INTERNAL SERVER ERROR

If an error occurs within the Feature Flags service.

                1.3.1.1.2 Feature Flags Service on Cloud Foundry Environment
https://help.sap.com/viewer/2250efa12769480299a1acd282b615cf/Cloud/en-US/

                1.3.1.1.3 quick start
https://help.sap.com/viewer/2250efa12769480299a1acd282b615cf/Cloud/en-US/c7b30b5bf54149148d2302617917dc3e.html

                1.3.1.1.4 Demo application
https://github.com/SAP/cloud-cf-feature-flags-sample/tree/master/src/main/java/com/sap/cloud/service/flags/demo

                1.3.1.1.5 CF cli to push changes
https://help.sap.com/viewer/2250efa12769480299a1acd282b615cf/Cloud/en-US/bffb30a916cc4b8982b9bc89fed90e70.html

                1.3.1.1.6


https://github.com/SAP/cloud-cf-feature-flags-sample

            1.3.1.2
        1.3.2 

    1.4 [cFLP] Content Manager - Support Catalogs and Groups

        1.4.1 general
@Shalom, Alma
@Izaq, Yosi
Joint BLI Saar + Guy
 
·         Goal: Show Groups and Catalogs in the content manager + integration with editors
·         Scope:
·         Visibility should be false for delivery until we finalize all FLP related BLIs (will be visible via URL parameter)

Test scope, https://wiki.wdf.sap.corp/wiki/display/CPPortals/Content+Manager+-+Support+Catalogs+and+Groups+test+scope
Design doc, https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+Content+Manager+-+Support+Catalogs+and+Groups

jiraa: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-984
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1116

Motivation
We want to allow our customers to have a Portal site with FLP User Experience
Content Manager will allow to maintain all the business apps, Catalogs and Groups that the site contains
User Story:
As an admin I would like to be able to see and maintain catalogs and groups through the content manager and navigate to their editors
Acceptance Criteria:
Content manager table will show catalogs and group (in addition to business apps)
The content manager will list all existing local business apps;catalogs;groups of a specific site
The table list should be sorted alphabetically by title (by default), and should allow sort by description (of all entities in the table)
In case there is no business app/catalogs/groups in the site, empty page with "+New" button will be shown. 
Icon of an entity should have a tooltip with the entity type 
Integration of Groups and catalogs editors to content manager, including server side
Admin will be able to view catalog or group. catalogs/group editor will be open in view mode. 
Follow UX
PO + VD + UX review 
Out of scope: Filter, search, facets
Should be automated in UIVeri5
Visibility should be false for delivery until we finalize all FLP related BLIs (will be visible via URL parameter)

UX
https://xd.adobe.com/view/763c624d-d459-4796-4f9c-a066cc60a25e-000d/ 
InfoDev
Koren, Anat - strings and docu
\\iltlvg101.tlv.global.corp.sap\DEV_P_EP\Projects\ODP\Info Development\UI Strings\CF (Cloud Foundry)\2019.01 CF - Groups & Catalogs in Content Manager.docx
\\iltlvg101.tlv.global.corp.sap\DEV_P_EP\Projects\ODP\Info Development\UI Strings\CF (Cloud Foundry)\2018.12 CF Content Manager.docx

        1.4.2


    1.5 Enable FLP for stakeholders, aka default group and catalog mitigation

research, <URL:#r=__Add_default_catalog_and_group_upon_site_creation>
        1.5.1  Task breakdown


    Goal: reveal cFLP to stakeholders so that they can start working with our solution and enable federation of content
·         Scope:
·         Should be available in T02A only in internal-Canary
Mini design – 1PD
Test scope – 1PD
In site creation, Create a default group and a default catalog – 1PD
Create default group:
Default Group json + default ID
Add default group id to groupsOrder array. This array is on the default FLP page.
Create default catalog –
Default Catalog json + default ID
Add 2 batch requests
 
The content manager table will not be empty unless the admin specifically deletes the default group and catalog
 
Every business app which is created, is automatically assigned to both default group and catalog. In delete of a Business App, make sure it`s assignment is deleted from the default group and default catalog 
Add each new created App to default group – 1PD
Get the default group , add the new created appId to the ‘Tiles’ array of the group.
 
Add each new created App to default catalog -
Get the default catalog , add the new created appId to the ‘Apps’ array of the catalog.
 
On App deletion – 1PD
Get the default group ,remove the appId from the ‘Tiles’ array of the group.
 
Get the default catalog , remove the appId from the ‘Apps’ array of the catalog.
 
 
Enable this scenario only in Internal-Canary for stakeholders use (so that customers will not be impacted by this)
Fetch the region property from vcap services – 1PD
And make sure this flow happens in Canary only.
It will not be possible as part of this scope to assign any business app to different catalogs\groups
Deletion of the default group – remove it from groupsOrder array. – 1PD
Validate that RT site is working correctly after creation of a site (with no business apps) and after creating business apps and changing Business App configuration (for example, tile type)
 
In case the stakeholder creates additional groups or catalogs, they will be available only in DT (not in RT)
Catalog - @Moskovich, Guy – ask Shani
Cover error handling
Should be available in T02A only in internal-Canary
Tests – 3PDs
Manual Validations – 2PD
12PDs

        1.5.2 URLs
JIRA: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1556
Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+Enable+FLP+for+stake+holders

        1.5.3 websequence

            1.5.3.1 Positive site create

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: CreateSite (contextId, JWT token) 
Semantic->Store: Create 
note left of Store
Create parameters are: 
entityType site, entityId==ContextID, 
{site, menu, flp, default-group, default-catalog)
end note
activate Store
note right of Store
Site is created 
with default group
and catalog
end note
#Store->Store: Create the site with the default-group and default-catalog
Store->Semantic: Create OK
deactivate Store
Semantic->Client: Create OK


            1.5.3.2 Negative site create

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: CreateSite (contextId, JWT token) 
Semantic->Store: Create 
note left of Store
Create parameters are: 
entityType site, entityId==ContextID, 
{site, menu, flp, default-group, default-catalog)
end note
activate Store
note right of Store
Site creation has encountered an error 
end note
Store->Semantic: Create Error (50x)
deactivate Store
Semantic->Client: Create Error (50x)

            1.5.3.3 Positive app create
version when GET of current group is performed:

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: Create app batch (contextId, JWT token) 
Semantic->Store: Get default group 
Store->Semantic: OK {default-group}
Semantic->Store: Get default catalog 
Store->Semantic: OK {default-catalog}
Semantic->Store: Create app batch
activate Store 
note left of Store
Batch contains 
{{App Create}, 
{default-group Update with app},
{default-catalog Update with app} 
end note
Store->Semantic: Create OK
deactivate Store
Semantic->Client: Create OK

version when GET of current group is not performed, the group is cached:

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: Create app batch (contextId, JWT token) 
activate Semantic 
note left of Semantic
Update cached group
Update cached catalog
end note
Semantic->Store: Create app batch
deactivate Semantic
activate Store 
note left of Store
Batch contains 
{{App Create}, 
{default-group Update with app},
{default-catalog Update with app} 
end note
Store->Semantic: Create OK
deactivate Store
Semantic->Client: Create OK


            1.5.3.4 Positive and Negative app creation
version when GET of current group is performed:

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: Create app batch (contextId, JWT token) 
Semantic->Store: Get default group 
alt Succesful default group retrieval
Store->Semantic: OK {default-group}
else failure to get default group
Store->Semantic: Error 
Semantic->Client: Create Error
end alt
Semantic->Store: Get default catalog 
alt Succesful default catalog retrieval
Store->Semantic: OK {default-catalog}
else failure to get default catalog
Store->Semantic: Error 
Semantic->Client: Create Error
end alt
Semantic->Store: Create app batch
activate Store 
note left of Store
Batch contains 
{{App Create}, 
{default-group Update with app},
{default-catalog Update with app} 
end note
alt Succesful creation and update
Store->Semantic: Create OK
Semantic->Client: Create OK
else failure to create and or update
Store->Semantic: Error 
Semantic->Client: Create Error
end alt
deactivate Store

version when GET of current group is not performed, the group is cached:

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: Create app batch (contextId, JWT token) 
Semantic->Store: Create app batch
activate Semantic 
note left of Semantic
Update cached group
Update cached catalog
end note
activate Store 
note left of Store
Batch contains 
{{App Create}, 
{default-group Update with app},
{default-catalog Update with app} 
end note
alt Succesful creation and update
Store->Semantic: Create OK
deactivate Semantic
Semantic->Client: Create OK
else failure to create and or update
Store->Semantic: Error 
Semantic->Client: Create Error
end alt
deactivate Store

            1.5.3.5 Design notes

a. For starters can update assignments of app to group as
push to array payload.tiles object {'appId':'0115f48e-3b04-49d9-80b5-edeb55344f6c', 'vizId':'RandomURL-Launcher'}
Don't forget to remove it for delete app

b. Also if group.default is deleted need to delete the groupsOrder from the FLP page app

            1.5.3.6

        1.5.4 logs

            1.5.4.1 getting FLP page and default-group and default-catalog

<URL:~/work/SAP/logs/createDefaultGroupAndCatalog/portal-cf-site-semantic-service_getFLP_Page_and_DefaultGroupCatalog.log>

        1.5.5 diffs

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/services/store/store-client.js
    async getEntitiesForPreBatch(contextId, reqContext) {
        //Get all entities that may require an update.
        //Get FLP page
        let localEntityType = 'pageapp';
        logger.logRequestMessage(reqContext.logger, 'debug', 'getEntitiesForPreBatch() method: GET, entityId: %s entityType: %s contextId: %s', this.flpPageID, localEntityType, contextId);
        let flpPage;
        try {
            flpPage = await this.readOne(localEntityType, this.flpPageID, contextId, reqContext);
            flpPage = flpPage.data;
        } catch (err) {
            logger.logRequestMessage(reqContext.logger, 'warning', "getEntitiesForPreBatch() get flpPage failed");
            return Promise.reject(new CDMStoreError(err.response));
        }
        logger.logRequestMessage(reqContext.logger, 'debug', "getEntitiesForPreBatch() flpPage=%s", JSON.stringify(flpPage, null, 4));

        //get default group
        localEntityType = 'group';
        logger.logRequestMessage(reqContext.logger, 'debug', 'getEntitiesForPreBatch() method: GET, entityId: %s entityType: %s contextId: %s', this.defGroupId, localEntityType, contextId);
        let defGroup;
        try {
            defGroup = await this.readOne(localEntityType, this.defGroupId, contextId, reqContext);
            defGroup = defGroup.data;
        } catch (err) {
            logger.logRequestMessage(reqContext.logger, 'warning', "getEntitiesForPreBatch() get default group failed");
            return Promise.reject(new CDMStoreError(err.response));
        }
        logger.logRequestMessage(reqContext.logger, 'debug', "getEntitiesForPreBatch() defGroup=%s", JSON.stringify(defGroup, null, 4));

        //get default catalog
        localEntityType = 'catalog';
        logger.logRequestMessage(reqContext.logger, 'debug', 'getEntitiesForPreBatch() method: GET, entityId: %s entityType: %s contextId: %s', this.defCatalogId, localEntityType, contextId);
        let defCatalog;
        try {
            defCatalog = await this.readOne(localEntityType, this.defCatalogId, contextId, reqContext);
            defCatalog = defCatalog.data;
        } catch (err) {
            logger.logRequestMessage(reqContext.logger, 'warning', "getEntitiesForPreBatch() get default catalog failed");
            return Promise.reject(new CDMStoreError(err.response));
        }
        logger.logRequestMessage(reqContext.logger, 'debug', "getEntitiesForPreBatch() defCatalog=%s", JSON.stringify(defCatalog, null, 4));

        return {flpPage, defGroup, defCatalog};
    }

    updateEntitiesForPreBatch(batchRequests, reqContext, flpPage, defGroup, defCatalog) {
        let isGroupUpdateRequired = false;
        let isCatalogUpdateRequired = false;
        let isFLPUpdateRequired = false;
        for (let batchReq of batchRequests) {
            logger.logRequestMessage(reqContext.logger, 'debug', "updateEntitiesForPreBatch() examining batch request %s", JSON.stringify(batchReq, null, 4));
            if (batchReq.metadata.operation === 'CREATE' &&
                (batchReq.cdm.identification.entityType === 'businessapp')) {
                logger.logRequestMessage(reqContext.logger, 'debug', "updateEntitiesForPreBatch() detected create businessapp batch=%s", JSON.stringify(batchReq.cdm, null, 4));
                let appIdObj = {
                    'appId': batchReq.cdm.identification.id,
                    'vizId': Object.keys(batchReq.cdm.payload.visualizations)[0]
                };
                defGroup.cdm.payload.tiles.push(appIdObj);
                defCatalog.cdm.payload.viz.push(appIdObj);
                if (!isGroupUpdateRequired) {
                    isGroupUpdateRequired = true;
                }
                if (!isCatalogUpdateRequired) {
                    isCatalogUpdateRequired = true;
                }
            } else if (batchReq.metadata.operation === 'DELETE') {
                if (batchReq.metadata.entityType === 'businessapp') {
                    logger.logRequestMessage(reqContext.logger, 'debug', "updateEntitiesForPreBatch() detected delete businessapp batch=%s", JSON.stringify(batchReq.metadata, null, 4));
                    let appId = batchReq.metadata.id;
                    defGroup.cdm.payload.tiles = defGroup.cdm.payload.tiles.filter((elem) => {
                        return elem.appId !== appId;
                    });
                    defCatalog.cdm.payload.viz = defCatalog.cdm.payload.viz.filter((elem) => {
                        return elem.appId !== appId;
                    });
                    if (!isGroupUpdateRequired) {
                        isGroupUpdateRequired = true;
                    }
                    if (!isCatalogUpdateRequired) {
                        isCatalogUpdateRequired = true;
                    }
                } else if (batchReq.metadata.entityType === 'group' && batchReq.metadata.id === this.defGroupId) {
                    logger.logRequestMessage(reqContext.logger, 'debug', "updateEntitiesForPreBatch() detected delete default group batch=%s", JSON.stringify(batchReq.metadata, null, 4));
                    flpPage.cdm.payload.pageConfig.groupsOrder.pop();
                    if (!isFLPUpdateRequired) {
                        isFLPUpdateRequired = true;
                    }
                }
            }
        }
        return {isGroupUpdateRequired, isCatalogUpdateRequired, isFLPUpdateRequired};
    }

    updateBatchRequstsForPreBatch(reqContext, batchRequestsRet, flpPage, defGroup, defCatalog, isGroupUpdateRequired, isCatalogUpdateRequired, isFLPUpdateRequired) {
        if (isGroupUpdateRequired) {
            logger.logRequestMessage(reqContext.logger, 'debug', "updateBatchRequstsForPreBatch() detected default group update is required");
            let defGroupBatch = {
                metadata: {
                    operation: 'UPDATE'
                },
                cdm: defGroup.cdm
            };
            batchRequestsRet.push(defGroupBatch);
        }

        if (isCatalogUpdateRequired) {
            logger.logRequestMessage(reqContext.logger, 'debug', "updateBatchRequstsForPreBatch() detected default catalog update is required");
            let defCatalogBatch = {
                metadata: {
                    operation: 'UPDATE'
                },
                cdm: defCatalog.cdm
            };
            batchRequestsRet.push(defCatalogBatch);
        }

        if (isFLPUpdateRequired) {
            logger.logRequestMessage(reqContext.logger, 'debug', "updateBatchRequstsForPreBatch() detected FLP page update is required");
            let flpPageBatch = {
                metadata: {
                    operation: 'UPDATE'
                },
                cdm: flpPage.cdm
            };
            batchRequestsRet.push(flpPageBatch);
        }
        return batchRequestsRet;
    }

    async preBatch(contextId, batchRequests, reqContext) {
        //Get all entities that may require an update.
        let {flpPage, defGroup, defCatalog} = await this.getEntitiesForPreBatch(contextId, reqContext);

        let {isGroupUpdateRequired, isCatalogUpdateRequired, isFLPUpdateRequired} = this.updateEntitiesForPreBatch(batchRequests, reqContext, flpPage, defGroup, defCatalog);

        logger.logRequestMessage(reqContext.logger, 'debug', "preBatch() completed pre processing");
        this.updateBatchRequstsForPreBatch(reqContext, batchRequests, flpPage, defGroup, defCatalog, isGroupUpdateRequired, isCatalogUpdateRequired, isFLPUpdateRequired);
    }

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/test/unit/services/store/store-client.spec.js
    //ToDo, restore tests after removal of enable FLP code
    describe('batch tests', () => {
        let vcapStub;
        const errMsg = StoreVars.errMsg;
        const dummyError = new DummyError(errMsg);

        before(() => {
            const VCAP = require('../../../../src/utils/vcap');
            vcapStub = sinon.stub(VCAP, 'get').returns(StoreVars.meteringVcap);
            StoreClient = rewire('../../../../src/services/store/store-client');
            StoreClient.__set__("logger", loggerMock);

        });

        after(() => {
            vcapStub.restore();
        });

        it('should call store client (post) with correct arguments and return its promise', sinonTest(async function () {
            let postStub = this.stub(StoreClient, "post").resolves(promiseData);
            let buildBatchStub = this.stub(StoreRequestBuilder, "buildBatch").returns(batchBody);
            let batchPromise = StoreClient.batch(language, contextId, batchRequests, reqContext);
            await batchPromise;
            sinon.assert.calledWith(buildBatchStub, contextId, batchRequests);
            sinon.assert.calledWith(postStub, language, '/entities', batchBody);
            return assert.becomes(batchPromise, promiseData);
        }));

        it('should call store client (post) with correct arguments and simulate a rejection', sinonTest(async function () {
            let postStub = this.stub(StoreClient, "post").rejects(dummyError);
            let preBatchStub = this.stub(StoreClient, "preBatch").resolves({});
            let buildBatchStub = this.stub(StoreRequestBuilder, "buildBatch").returns(batchBody);
            let batchPromise = StoreClient.batch(language, contextId, batchRequests, reqContext);
            await assert.isRejected(batchPromise, DummyError, errMsg);
            sinon.assert.calledWith(preBatchStub, contextId, batchRequests, reqContext);
            sinon.assert.calledWith(buildBatchStub, contextId, batchRequests);
            sinon.assert.calledWith(postStub, language, '/entities', batchBody);
        }));

        it('should call store client (post) with correct arguments and throws buildSiteCreationBatch error', sinonTest(async function () {
            this.stub(StoreClient, "post").resolves(promiseData);
            this.stub(StoreClient, "preBatch").resolves({});
            this.stub(StoreRequestBuilder, "buildBatch").throws(dummyError);
            try{
                await StoreClient.batch(language, contextId, batchRequests, reqContext);
            }
            catch (e) {
                assert.equal('Promise rejected', e.message)
            }
        }));
    });


- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/test/unit/services/store/store-request-builder.spec.js
    describe('buildSiteCreationBatch', () => {
        let buildSiteCreationBatch = () => StoreRequestBuilder.buildSiteCreationBatch(entityId, 'site');

        it('should call buildBatch with correct arguments and return its response', sinonTest(function() {
            let title = 'site';
            let batchRequests = [
                {
                    metadata: {
                        operation: 'CREATE'
                    },
                    cdm: {
                        payload: {
                        },
                        identification: {
                            id: entityId,
                            title: title
                        }
                    }
                },
                {
                    metadata: {
                        operation: 'CREATE'
                    },
                    cdm: {
                        payload: {
                        },
                        identification: {
                            id: StoreVars.uuidv1,
                            title: "menu"
                        }
                    }
                },
                {
                    metadata: {
                        operation: 'CREATE'
                    },
                    cdm: {
                        payload: {
                        },
                        identification: {
                            id: StoreVars.uuidv1,
                            title: "pageapp"
                        }
                    }
                },
                {
                    metadata: {
                        operation: 'CREATE'
                    },
                    cdm: {
                        payload: {
                        },
                        identification: {
                            id:  "groupdefault",
                            title:  "{{cdm|identification|title}}"
                        }
                    }
                },
                {
                    metadata: {
                        operation: 'CREATE'
                    },
                    cdm: {
                        payload: {
                        },
                        identification: {
                            id:  "catalogdefault",
                            title:  "{{cdm|identification|title}}"
                        }
                    }
                }

            ];

            let uuidStub = this.stub(UUID, "v1").returns(StoreVars.uuidv1);
            this.stub(TemplateBuilder, "getSite").returns({payload: {}, identification: {}});
            this.stub(TemplateBuilder, "getMenu").returns({payload: {}, identification: {title: "menu"}});
            this.stub(TemplateBuilder, "getFlpPage").returns({payload: {},
                identification: {
                id:  StoreVars.uuidv1,
                title: "pageapp"}
            });
            this.stub(TemplateBuilder, "getDefaultGroup").returns({payload: {},
                identification: {
                    id:  "groupdefault",
                    title:  "{{cdm|identification|title}}" }
            });
            this.stub(TemplateBuilder, "getDefaultCatalog").returns({payload: {},
                identification: {
                    id:  "catalogdefault",
                    title:  "{{cdm|identification|title}}" }

            });
            let buildBatchStub = this.stub(StoreRequestBuilder, "buildBatch").returns(batchBody);

            let res = StoreRequestBuilder.buildSiteCreationBatch(entityId, title);
            sinon.assert.calledWith(buildBatchStub, entityId, batchRequests);
            sinon.assert.calledOnce(uuidStub);
            assert.deepEqual(res, batchBody);
        }));

        it('should call fail upon getSite error', sinonTest(function() {
            this.stub(TemplateBuilder, "getSite").throws(dummyError);

            assert.throws(buildSiteCreationBatch, DummyError);
        }));

        it('should call fail upon getMenu error', sinonTest(function() {
            this.stub(TemplateBuilder, "getSite").returns({payload: {}, identification: {}});
            this.stub(TemplateBuilder, "getMenu").throws(dummyError);

            assert.throws(buildSiteCreationBatch, DummyError);
        }));

        it('should call fail upon getFlpPage error', sinonTest(function() {
            this.stub(TemplateBuilder, "getSite").returns({payload: {}, identification: {}});
            this.stub(TemplateBuilder, "getMenu").returns({payload: {}, identification: {title: "menu"}});
            this.stub(UUID, "v1").returns(StoreVars.uuidv1);
            this.stub(TemplateBuilder, "getFlpPage").throws(dummyError);

            assert.throws(buildSiteCreationBatch, DummyError);
        }));

        it('should call fail upon v1 error', sinonTest(function() {
            this.stub(TemplateBuilder, "getSite").returns({payload: {}, identification: {}});
            this.stub(TemplateBuilder, "getMenu").returns({payload: {}, identification: {title: "menu"}});
            this.stub(UUID, "v1").throws(dummyError);

            assert.throws(buildSiteCreationBatch, DummyError);
        }));

        it('should call fail upon buildBatch error', sinonTest(function() {
            this.stub(TemplateBuilder, "getSite").returns({payload: {}, identification: {}});
            this.stub(TemplateBuilder, "getMenu").returns({payload: {}, identification: {title: "menu"}});
            this.stub(TemplateBuilder, "getFlpPage").returns({payload: {}, identification: {title: "pageapp"}});
            this.stub(TemplateBuilder, "getDefaultGroup").returns({payload: {},
                identification: {
                    id:  "groupdefault",
                    title:  "{{cdm|identification|title}}" }
            });
            this.stub(TemplateBuilder, "getDefaultCatalog").returns({payload: {},
                identification: {
                    id:  "catalogdefault",
                    title:  "{{cdm|identification|title}}" }

            });
            this.stub(UUID, "v1").returns(StoreVars.uuidv1);
            this.stub(StoreRequestBuilder, "buildBatch").throws(dummyError);

            assert.throws(buildSiteCreationBatch, DummyError);
        }));
    });

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/services/store/store-request-builder.js
    buildSiteCreationBatch(siteId, title) {
        let site = TemplateBuilder.getSite();
        site.identification.title = title;
        site.identification.id = siteId;

        let menu = TemplateBuilder.getMenu();
        menu.identification.id = UUID.v1();

        let batchRequests = [
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: site
            },
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: menu
            },
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: TemplateBuilder.getFlpPage()
            },
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: TemplateBuilder.getDefaultGroup()
            },
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: TemplateBuilder.getDefaultCatalog()
            }
        ];

        return this.buildBatch(siteId, batchRequests);
    }

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/test/resources/store-vars.js
        this.meteringVcap = {region: 'cf-eu10-canary'};

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/cdm/template-builder.js
    getFlpPage() {
        return require(this.basePath + 'pageapp.flp');
    }

    getDefaultGroup() {
        return require(this.basePath + 'group.default');
    }

    getDefaultCatalog() {
        return require(this.basePath + 'catalog.default');
    }

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/catalog.default.json
{
  "_version": "3.0",
  "identification": {
    "id": "catalogdefault",
    "entityType": "catalog",
    "title": "{{cdm|identification|title}}",
    "description": "{{cdm|identification|description}}"
  },
  "payload": {
    "viz": []
  },
  "texts": {
    "cdm|identification|title": {
      "type": "XTIT",
      "value": {
        "": "Default Catalog"
      }
    },
    "cdm|identification|description": {
      "type": "XTIT",
      "value": {
        "": "Every app is automatically assigned to this catalog"
      }
    }
  }
}

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/group.default.json
{
  "_version": "3.0",
  "identification": {
    "id": "groupdefault",
    "entityType": "group",
    "title": "{{cdm|identification|title}}",
    "description": "{{cdm|identification|description}}"
  },
  "payload": {
    "tiles": []
  },
  "texts": {
    "cdm|identification|title": {
      "type": "XTIT",
      "value": {
        "": "Default Group"
      }
    },
    "cdm|identification|description": {
      "type": "XTIT",
      "value": {
        "": "Every app is automatically assigned to this group"
      }
    }
  }
}

- /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/pageapp.flp.json
{
  "_version": "3.0",
  "identification": {
    "id": "flp_pageapp",
    "entityType": "pageapp",
    "title": "{{title}}"
  },
  "payload": {
    "targetAppConfig": {
      "sap.app": {
        "crossNavigation": {
          "inbounds": {
            "Shell-home": {}
          }
        }
      }
    },
    "pageConfig": {
      "type": "FLP",
      "layout": {
        "groupsOrder": ["groupdefault"]
      }
    }
  },
  "texts": {
    "title": {
      "value": {
        "": "Launchpad"
      }
    }
  }
}

        1.5.6

    1.6 consume schema from nexus

        1.6.0. links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1543

        1.6.1  pre research
jira: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1625
Nexus link: https://nexussnap.wdf.sap.corp:8443/nexus/#nexus-search;quick~cdm-schema
artifact-id: cdm-schema
candidate entities to be replaced:

[i500695@C02X632CJGH6:2019-03-05 14:49:27:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]646$ ls src/resources/templates/default-site/
catalog.default.json			group.default.json			role.everyone.json
generic_url_app.json			menu.default.json			site.default.json
generic_url_app_with_query.json		pageapp.flp.json

diffs:
-> vimdiff node_modules/cdm-schema/dist/clp/site-default-entities/catalog.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/catalog.default.json

-> vimdiff node_modules/cdm-schema/dist/clp/site-default-entities/group.default.json			~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/group.default.json			

-> vimdiff node_modules/cdm-schema/dist/clp/site-default-entities/role.everyone.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/role.everyone.json 
[i500695@C02X632CJGH6:2019-03-05 15:28:01:~/work/code/nodejs/tutorial:]531$ diff node_modules/cdm-schema/dist/clp/site-default-entities/role.everyone.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/role.everyone.json
4c4
<     "id": "everyone",
---
>     "id": "role_everyone",
19c19,26
<     "apps": []
---
>     "apps": [
>       {
>         "id": "generic_url_app"
>       },
>       {
>         "id": "generic_url_app_with_query"
>       }
>     ]
25c32,35
<         "": "Everyone"
---
>         "": "My Role",
>         "en": "My Role",
>         "de": "Meine Rolle",
>         "es-AR": "Mi Papel"


-> vimdiff node_modules/cdm-schema/dist/clp/site-default-entities/generic_url_app.json			~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/generic_url_app.json			
diff node_modules/cdm-schema/dist/clp/site-default-entities/generic_url_app.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/generic_url_app.json			
doesn't exist in schema. should create. 


-> diff node_modules/cdm-schema/dist/clp/site-default-entities/menu.default.json			~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/menu.default.json	


-> diff node_modules/cdm-schema/dist/clp/site-default-entities/site.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/site.default.json
15,18c15,18
<                 "enableSearch": false,
<                 "enableUserDefaultParameters": true,
<                 "rootIntent": "Shell-home",
<                 "enableTilesOpacity": false,
---
>                 "enableFiori3": true,
>                 "enableActionModeFloatingButton": true,
>                 "enableActionModeMenuButton": true,
>                 "enableHideGroups": true,
20,21c20,21
<                 "enableUserThemes": true,
<                 "enableSetTheme": true,
---
>                 "enableRecentActivity": false,
>                 "enableSearch": true,
23,25c23,31
<                 "enableHideGroups": true,
<                 "enableActionModeMenuButton": true,
<                 "enableActionModeFloatingButton": true
---
>                 "enableTilesOpacity": false,
>                 "enableUserDefaultParameters": true,
>                 "enableUserThemes": true,
>                 "rootIntent": "Shell-home",
>                 "applications": {
>                   "Shell-home": {
>                     "enableEasyAccess": false
>                   }
>                 }
36a43,49
>         },
>         "services": {
>           "AllMyApps":{
>             "config": {
>               "enabled": true
>             }
>           }
39a53,55
>     "groupsOrder": [
>       "group.default"
>     ],
43c59
<         "available": [""]
---
>         "available": ["", "en", "de-DE"]
48,51c64,65
<         "theme.id": "sap_belize",
<         "theme.active": [
<           "sap_belize", "sap_belize_plus", "sap_hcb", "sap_belize_hcw"
<         ],
---
>         "theme.id": "sap_fiori_3",
>         "theme.active": ["sap_fiori_3"],
63c77
< }
\ No newline at end of file
---
> }

-> [i500695@C02X632CJGH6:2019-03-05 16:14:52:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]653$ vimdiff  ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/generic_url_app_with_query.json  ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/generic_url_app.json 

-> 
diff node_modules/cdm-schema/dist/clp/site-default-entities/pageapp.flp.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/pageapp.flp.json 
[i500695@C02X632CJGH6:2019-03-05 16:13:59:~/work/code/nodejs/tutorial:]548$ diff node_modules/cdm-schema/dist/clp/site-default-entities/pageapp.flp.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/pageapp.flp.json 
4c4
<     "id": "FLP_PAGEAPP",
---
>     "id": "flp_pageapp",
21,23c21
<         "groupsOrder": [
<           "group.default"
<         ]
---
>         "groupsOrder": ["groupdefault"]
30c28
<         "": "FLP Page"
---
>         "": "Launchpad"
34c32
< }
---
> }
\ No newline at end of file

        1.6.2 email 2 amir re change examples
- catalog
    -- change title to 
     "title": "{{cdm|identification|title}}",

    -- add description
     "description": "{{cdm|identification|description}}"

     ...

     "cdm|identification|description": {
       "type": "XTIT",
       "value": {
         "": "catalog description"
       }

    --

diff:
[i500695@C02X632CJGH6:2019-03-05 15:00:00:~/work/code/nodejs/tutorial:]527$ diff node_modules/cdm-schema/dist/clp/site-default-entities/catalog.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/catalog.default.json
6c6,7
<     "title": "{{catalogTitle}}"
---
>     "title": "{{cdm|identification|title}}",
>     "description": "{{cdm|identification|description}}"
12c13
<     "catalogTitle": {
---
>     "cdm|identification|title": {
16a18,23
>     },
>     "cdm|identification|description": {
>       "type": "XTIT",
>       "value": {
>         "": "Every app is automatically assigned to this catalog"
>       }

- group
    -- change title to 
     "title": "{{cdm|identification|title}}",

    -- add description
     "description": "{{cdm|identification|description}}"

     ...

     "cdm|identification|description": {
       "type": "XTIT",
       "value": {
         "": "group description"
       }

    --

diff:
[i500695@C02X632CJGH6:2019-03-05 15:21:39:~/work/code/nodejs/tutorial:]528$ diff node_modules/cdm-schema/dist/clp/site-default-entities/group.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/group.default.json 
6c6,7
<     "title": "{{groupTitle}}"
---
>     "title": "{{cdm|identification|title}}",
>     "description": "{{cdm|identification|description}}"
12c13
<     "groupTitle": {
---
>     "cdm|identification|title": {
16a18,23
>     },
>     "cdm|identification|description": {
>       "type": "XTIT",
>       "value": {
>         "": "Every app is automatically assigned to this group"
>       }

- role
    -- title key should be changed to      "cdm|identification|title"

    see:
[i500695@C02X632CJGH6:2019-03-05 15:29:33:~/work/code/nodejs/tutorial:]535$ grep title node_modules/cdm-schema/dist/clp/site-default-entities/role.everyone.json
    "title": "{{roleTitle}}"

- generic_url_app.json 
    -- need 2 add 2 dist

- menu
    -- title key should be changed to      "cdm|identification|title"

    --  suggest to add texts
   "texts": {}

diff:
$ diff node_modules/cdm-schema/dist/clp/site-default-entities/menu.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/menu.default.json 
5c5,6
<     "entityType": "menu"
---
>     "entityType": "menu",
>     "title": "{{menuTitle}}"
9c10,11
<   }
---
>   },
>   "texts": {}


- site
I want to show you the diffs

- 

        1.6.3 demo require
[i500695@C02X632CJGH6:2019-04-28 14:22:14:~/work/code/nodejs/tutorial/CF:]519$ cat .npmrc 
registry=http://nexus.wdf.sap.corp:8081/nexus/content/groups/build.releases.npm/

[i500695@C02X632CJGH6:2019-03-05 16:50:26:~/work/code/nodejs/tutorial/CF:]559$ cat  getSchemaEntities.js
let catalog = require('cdm-schema/dist/clp/site-default-entities/catalog.default.json');
console.log('schema catalog: %s',JSON.stringify(catalog, null, 4));

let menu = require('cdm-schema/dist/clp/site-default-entities/menu.default.json');
console.log('schema menu: %s',JSON.stringify(catalog, null, 4));

let role = require('cdm-schema/dist/clp/site-default-entities/role.everyone.json');
console.log('schema role: %s',JSON.stringify(catalog, null, 4));

let group = require('cdm-schema/dist/clp/site-default-entities/group.default.json');
console.log('schema group: %s',JSON.stringify(catalog, null, 4));

let pageapp = require('cdm-schema/dist/clp/site-default-entities/pageapp.flp.json');
console.log('schema pageapp: %s',JSON.stringify(catalog, null, 4));

let site = require('cdm-schema/dist/clp/site-default-entities/site.default.json');
console.log('schema site: %s',JSON.stringify(catalog, null, 4));

[i500695@C02X632CJGH6:2019-03-05 16:50:24:~/work/code/nodejs/tutorial/CF:]558$ node  getSchemaEntities.js
schema catalog: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}
schema menu: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}
schema role: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}
schema group: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}
schema pageapp: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}
schema site: {
    "_version": "3.0",
    "identification": {
        "id": "catalog.default",
        "entityType": "catalog",
        "title": "{{catalogTitle}}"
    },
    "payload": {
        "viz": []
    },
    "texts": {
        "catalogTitle": {
            "type": "XTIT",
            "value": {
                "": "Default Catalog"
            }
        }
    }
}


        1.6.4 plan
- close with amir changes to cdm-schema
    -- branch
[i500695@C02X632CJGH6:2019-03-05 18:26:12:~/work/SAP/git/cdm-schema:]539$ gitb
  master
* modifySiteEntitiesDT
    -- changes
-> Catalog 
[i500695@C02X632CJGH6:2019-03-06 08:42:14:~/work/SAP/git/cdm-schema:]542$ find . -name 'catalog.default.json'
./local-dist/clp/site-default-entities/catalog.default.json
./examples/designtime/3.0/site-default-entities/catalog.default.json
vimdiff ./examples/designtime/3.0/site-default-entities/catalog.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/catalog.default.json

-> group
vimdiff ./examples/designtime/3.0/site-default-entities/group.default.json	~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/group.default.json			

-> role

vimdiff ./examples/designtime/3.0/site-default-entities/role.everyone.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/role.everyone.json 


-> generic_url_app 
cp ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/generic_url_app.json	./examples/designtime/3.0/site-default-entities/generic_url_app.json

-> menu
vimdiff ./examples/designtime/3.0/site-default-entities/menu.default.json			~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/menu.default.json	

-> site
vimdiff ./examples/designtime/3.0/site-default-entities/site-default-entities/site.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/site.default.json
cp ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/site.default.json ./examples/designtime/3.0/site-default-entities/site.default.json 

-> flp
vimdiff ./examples/designtime/3.0/site-default-entities/pageapp.flp.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/pageapp.flp.json 

PR: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/26

->
    --

- Add npm cdm-schema dependency to semantic
    -- branch
   [i500695@C02X632CJGH6:2019-03-05 18:24:22:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]661$ gitb
  master
  masters_fixes2_yosi
  mitigation
* schemeFromNexus 
npm i cdm-schema --save --save-exact 

    --
- modify the templates from semantic. they should require the schema entities and decorate them as required

    -- Tests
    code:
    getDefaultCatalog() {
        let catalog = require('cdm-schema/dist/clp/site-default-entities/catalog.default.json');
        let fs = require("fs");
        let schemaFilepath = process.env.HOME+"/temp/schema";
        let semanticfilepath = process.env.HOME+"/temp/semantic";
        //console.log('schema catalog: %s',JSON.stringify(catalog, null, 4));


        let catalogToBeDeleted = require(this.basePath + 'catalog.default');
        //console.log('target catalog: %s',JSON.stringify(catalogToBeDeleted, null, 4));

        fs.writeFile(schemaFilepath+'Catalog.json', JSON.stringify(catalog,null,4), 'utf8', function (err) {
            if (err){
                console.log('err '+err);
            }
        });
        fs.writeFile(semanticfilepath+'Catalog.json', JSON.stringify(catalogToBeDeleted,null,4), 'utf8', function (err) {
            if (err){
                console.log('err '+err);
            }
        });
        console.log('vimdiff '+ schemaFilepath+'Catalog.json'+ ' '+ semanticfilepath+'Catalog.json');
    }


[i500695@C02X632CJGH6:2019-03-06 15:33:11:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]679$ grunt_local 
Running "nyc:local" (nyc) task
Running "mochaTest:local" (mochaTest) task


(node:45027) [DEP0005] DeprecationWarning: Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.
  Template Builder unit tests
    getDefaultCatalog
vimdiff /Users/i500695/temp/schemaCatalog.json /Users/i500695/temp/semanticCatalog.json
      ✓ should correctly decorate schema default catalog


  1 passing (12ms)


    --

- rest of semantic code should remain unchanged

- after all working - delete the template entities


        1.6.5 update schema
vimdiff examples/designtime/3.0/site-default-entities/site.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/site.default.json && vimdiff examples/designtime/3.0/site-default-entities/menu.default.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/menu.default.json && vimdiff examples/designtime/3.0/site-default-entities/pageapp.flp.json ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/pageapp.flp.json
- https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/55

- and
[i500695@C02X632CJGH6:2019-04-28 19:25:15:~/work/SAP/git/cdm-schema:]650$ vimdiff examples/designtime/3.0/site-default-entities/role.everyone.json  ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/role.default.json 
2 files to edit
[i500695@C02X632CJGH6:2019-04-29 14:13:47:~/work/SAP/git/cdm-schema:]651$ diff examples/designtime/3.0/site-default-entities/role.everyone.json  ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/role.default.json 
27c27
<   ]
---
>   }
[i500695@C02X632CJGH6:2019-04-29 14:13:52:~/work/SAP/git/cdm-schema:]652$ gitd
diff --git a/examples/designtime/3.0/site-default-entities/role.everyone.json b/examples/designtime/3.0/site-default-entities/role.everyone.json
index b342e1a..0811564 100644
--- a/examples/designtime/3.0/site-default-entities/role.everyone.json
+++ b/examples/designtime/3.0/site-default-entities/role.everyone.json
@@ -1,23 +1,28 @@
 {
   "_version": "3.0",
   "identification": {
-    "id": "everyone",
+    "id": "sap_everyone",
     "entityType": "role",
-    "title": "{{roleTitle}}",
-    "description": "{{roleDescription}}"
+    "title": "{{cdm|identification|title}}",
+    "description": "{{cdm|identification|description}}"
   },
   "payload": {
     "catalogs": [],
     "groups": [],
     "apps": []
   },
-  "texts": [
-    {
-      "locale": "",
-      "textDictionary": {
-        "roleTitle": "Everyone",
-        "roleDescription": "Default Role Description"
+  "texts": {
+    "cdm|identification|title": {
+      "type": "XTIT",
+      "value": {
+        "": "Everyone"
+      }
+    },
+    "cdm|identification|description": {
+      "type": "XTIT",
+      "value": {
+        "": "Content assigned to this role is visible to all users"
       }
     }
   ]
-}
\ No newline at end of file
+}
[i5006

        1.6.6 PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/204
-> diffs
               [i500695@C02X632CJGH6:2019-05-02 15:43:46:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]667$ gitdiffToFrom 5e755c2 983af84 > ~/temp/diff_consume_schema 

diff --git a/package.json b/package.json
index ba00d2a..06063b5 100644
--- a/package.json
+++ b/package.json
@@ -2,7 +2,7 @@
     "name": "portal-cf-site-semantic-service",
     "version": "1.12.0",
     "description": "Portal Semantic Service",
-    "scripts":     {
+    "scripts": {
         "start": "node ./bin/web",
         "start_dev": "export NODE_ENV=development && export PORT=3003 && nodemon ./bin/web",
         "test": "export NODE_ENV=local && ./node_modules/.bin/grunt",
@@ -12,10 +12,11 @@
     },
     "license": "ISC",
     "author": "SAP CF Dev",
-    "dependencies":     {
+    "dependencies": {
         "@sap/maas-client": "1.0.0-20190311072158",
         "@sap/xsenv": "1.2.9",
         "@sap/xssec": "2.1.15",
+        "cdm-schema": "3.0.0-20190501082541",
         "compression": "1.7.3",
         "dotenv": "6.1.0",
         "express": "4.16.3",
@@ -28,12 +29,12 @@
         "node-rsa": "1.0.1",
         "passport": "0.4.0",
         "path": "0.12.7",
-        "querystring": "0.2.0",
         "portal-cf-shared-lib": "3.5.0-20190228150710",
+        "querystring": "0.2.0",
         "swagger-ui-express": "4.0.2",
         "uuid": "3.3.2"
     },
-    "devDependencies":     {
+    "devDependencies": {
         "chai": "4.2.0",
         "chai-as-promised": "7.1.1",
         "eslint": "5.12.0",
@@ -48,16 +49,18 @@
         "supertest": "3.3.0",
         "nodemon": "1.18.10"
     },
-    "repository":     {
+    "repository": {
         "type": "git",
         "url": "git@github.wdf.sap.corp:Portal-CF/portal-cf-site-semantic-service.git"
     },
-    "engines": {"node": "^8"},
-    "keywords":     [
+    "engines": {
+        "node": "^8"
+    },
+    "keywords": [
         "portal",
         "semantic"
     ],
-    "files":     [
+    "files": [
         "bin",
         "src",
         "manifest.yml",
@@ -65,4 +68,4 @@
         "README.md",
         "Dockerfile"
     ]
-}
\ No newline at end of file
+}
diff --git a/src/cdm/template-builder.js b/src/cdm/template-builder.js
index 99fcf68..a84b97e 100644
--- a/src/cdm/template-builder.js
+++ b/src/cdm/template-builder.js
@@ -4,23 +4,23 @@
 class TemplateBuilder {
 
     constructor() {
-        this.basePath = '../resources/templates/default-site/';
+        this.basePath = 'cdm-schema/dist/clp/site-default-entities/';
     }
 
     getSite() {
-        return this.doRequire(this.basePath + 'site.default');
+        return this.doRequire(this.basePath + 'site.default.json');
     }
 
     getMenu() {
-        return this.doRequire(this.basePath + 'menu.default');
+        return this.doRequire(this.basePath + 'menu.default.json');
     }
 
     getFlpPage() {
-        return this.doRequire(this.basePath + 'pageapp.flp');
+        return this.doRequire(this.basePath + 'pageapp.flp.json');
     }
 
     getDefaultRole() {
-        return this.doRequire(this.basePath + 'role.default');
+        return this.doRequire(this.basePath + 'role.everyone.json');
     }
 
     doRequire(path) {
diff --git a/src/resources/templates/default-site/catalog.default.json b/src/resources/templates/default-site/catalog.default.json
deleted file mode 100644
index f84c7fb..0000000
--- a/src/resources/templates/default-site/catalog.default.json
+++ /dev/null
@@ -1,26 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "catalogdefault",
-    "entityType": "catalog",
-    "title": "{{cdm|identification|title}}",
-    "description": "{{cdm|identification|description}}"
-  },
-  "payload": {
-    "viz": []
-  },
-  "texts": {
-    "cdm|identification|title": {
-      "type": "XTIT",
-      "value": {
-        "": "Default Catalog"
-      }
-    },
-    "cdm|identification|description": {
-      "type": "XTIT",
-      "value": {
-        "": "Every app is automatically assigned to this catalog"
-      }
-    }
-  }
-}
\ No newline at end of file
diff --git a/src/resources/templates/default-site/generic_url_app.json b/src/resources/templates/default-site/generic_url_app.json
deleted file mode 100644
index 0d31fe8..0000000
--- a/src/resources/templates/default-site/generic_url_app.json
+++ /dev/null
@@ -1,52 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "generic_url_app",
-    "title": "{{appTitle}}",
-    "entityType": "businessapp"
-  },
-  "payload": {
-    "targetAppConfig": {
-      "_version": "1.13.0",
-      "sap.app": {
-        "crossNavigation": {
-          "inbounds": {
-            "GenericURL-Launch": {}
-          }
-        }
-      },
-      "sap.integration": {
-        "urlTemplateId": "templateGenericURL",
-        "urlTemplateParams": {
-          "url": "https://www.sap.com"
-        }
-      }
-    },
-    "visualizations": {
-      "GenericURL-Launch": {
-        "vizType": "sap.ushell.StaticAppLauncher",
-        "vizConfig": {
-          "sap.app": {
-            "title": "{{app_title}}"
-          },
-          "sap.flp": {
-            "target": {
-              "type": "IBN",
-              "inboundId": "GenericURL-Launch"
-            }
-          }
-        }
-      }
-    },
-    "defaultViz": "GenericURL-Launch"
-  },
-  "texts": {
-    "appTitle": {
-      "type": "XTIT",
-      "value": {
-        "": "My URL App",
-        "en": "My URL App"
-      }
-    }
-  }
-}
\ No newline at end of file
diff --git a/src/resources/templates/default-site/generic_url_app_with_query.json b/src/resources/templates/default-site/generic_url_app_with_query.json
deleted file mode 100644
index fc1ce66..0000000
--- a/src/resources/templates/default-site/generic_url_app_with_query.json
+++ /dev/null
@@ -1,55 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "generic_url_app_with_query",
-    "title": "{{appTitle}}",
-    "entityType": "businessapp"
-  },
-  "payload": {
-    "targetAppConfig": {
-      "_version": "1.13.0",
-      "sap.app": {
-        "crossNavigation": {
-          "inbounds": {
-            "GenericURLAndQuery-Launch": {}
-          }
-        }
-      },
-      "sap.integration": {
-        "urlTemplateId": "templateGenericURL",
-        "urlTemplateParams": {
-          "url": "https://www.sap.com",
-          "query": {
-            "a": "b"
-          }
-        }
-      }
-    },
-    "visualizations": {
-      "GenericURLAndQuery-Launch": {
-        "vizType": "sap.ushell.StaticAppLauncher",
-        "vizConfig": {
-          "sap.app": {
-            "title": "{{app_title}}"
-          },
-          "sap.flp": {
-            "target": {
-              "type": "IBN",
-              "inboundId": "GenericURLAndQuery-Launch"
-            }
-          }
-        }
-      }
-    },
-    "defaultViz": "GenericURLAndQuery-Launch"
-  },
-  "texts": {
-    "appTitle": {
-      "type": "XTIT",
-      "value": {
-        "": "My URL App with query",
-        "en": "My URL App"
-      }
-    }
-  }
-}
\ No newline at end of file
diff --git a/src/resources/templates/default-site/group.default.json b/src/resources/templates/default-site/group.default.json
deleted file mode 100644
index b13f052..0000000
--- a/src/resources/templates/default-site/group.default.json
+++ /dev/null
@@ -1,26 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "groupdefault",
-    "entityType": "group",
-    "title": "{{cdm|identification|title}}",
-    "description": "{{cdm|identification|description}}"
-  },
-  "payload": {
-    "tiles": []
-  },
-  "texts": {
-    "cdm|identification|title": {
-      "type": "XTIT",
-      "value": {
-        "": "Default Group"
-      }
-    },
-    "cdm|identification|description": {
-      "type": "XTIT",
-      "value": {
-        "": "Every app is automatically assigned to this group"
-      }
-    }
-  }
-}
\ No newline at end of file
diff --git a/src/resources/templates/default-site/menu.default.json b/src/resources/templates/default-site/menu.default.json
deleted file mode 100644
index f886f62..0000000
--- a/src/resources/templates/default-site/menu.default.json
+++ /dev/null
@@ -1,12 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "menu.default",
-    "entityType": "menu",
-    "title": "{{menuTitle}}"
-  },
-  "payload": {
-    "entities": []
-  },
-  "texts": {}
-}
\ No newline at end of file
diff --git a/src/resources/templates/default-site/pageapp.flp.json b/src/resources/templates/default-site/pageapp.flp.json
deleted file mode 100644
index 64ee726..0000000
--- a/src/resources/templates/default-site/pageapp.flp.json
+++ /dev/null
@@ -1,32 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "flp_pageapp",
-    "entityType": "pageapp",
-    "title": "{{title}}"
-  },
-  "payload": {
-    "targetAppConfig": {
-      "sap.app": {
-        "crossNavigation": {
-          "inbounds": {
-            "Shell-home": {}
-          }
-        }
-      }
-    },
-    "pageConfig": {
-      "type": "flp",
-      "layout": {
-        "groupsOrder": []
-      }
-    }
-  },
-  "texts": {
-    "title": {
-      "value": {
-        "": "Launchpad"
-      }
-    }
-  }
-}
diff --git a/src/resources/templates/default-site/role.default.json b/src/resources/templates/default-site/role.default.json
deleted file mode 100644
index 39b9f83..0000000
--- a/src/resources/templates/default-site/role.default.json
+++ /dev/null
@@ -1,28 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "sap_everyone",
-    "entityType": "role",
-    "title": "{{cdm|identification|title}}",
-    "description": "{{cdm|identification|description}}"
-  },
-  "payload": {
-    "catalogs": [],
-    "groups": [],
-    "apps": []
-  },
-  "texts": {
-    "cdm|identification|title": {
-      "type": "XTIT",
-      "value": {
-        "": "Everyone"
-      }
-    },
-    "cdm|identification|description": {
-      "type": "XTIT",
-      "value": {
-        "": "Content assigned to this role is visible to all users"
-      }
-    }
-  }
-}
diff --git a/src/resources/templates/default-site/site.default.json b/src/resources/templates/default-site/site.default.json
deleted file mode 100644
index 93b626e..0000000
--- a/src/resources/templates/default-site/site.default.json
+++ /dev/null
@@ -1,77 +0,0 @@
-{
-  "_version": "3.0",
-  "identification": {
-    "id": "site.default",
-    "title": "Default Site",
-    "entityType": "site"
-  },
-  "payload": {
-    "config": {
-      "ushellConfig": {
-        "ushell":{"shell":{"enableFiori3": true}},
-        "renderers": {
-          "fiori2": {
-            "componentData": {
-              "config": {
-                "enableActionModeFloatingButton": true,
-                "enableActionModeMenuButton": true,
-                "enableHideGroups": true,
-                "enablePersonalization": true,
-                "enableRecentActivity": false,
-                "enableSearch": true,
-                "enableSetLanguage": true,
-                "enableTilesOpacity": false,
-                "enableUserDefaultParameters": true,
-                "enableUserThemes": true,
-                "rootIntent": "Shell-home",
-                "applications": {
-                  "Shell-home": {
-                    "enableEasyAccess": false
-                  }
-                }
-              }
-            }
-          }
-        },
-        "modulePaths": {
-          "sap.ushell.apps.menuPlugin": "/freestyle/sap/ushell/apps/menuPlugin"
-        },
-        "bootstrapPlugins": {
-          "menuplugin": {
-            "component": "sap.ushell.apps.menuPlugin"
-          }
-        },
-        "services": {
-          "AllMyApps":{
-            "config": {
-              "enabled": true
-            }
-          }
-        }
-      }
-    },
-    "groupsOrder": [
-      "group.default"
-    ],
-    "sap.cloud.portal": {
-      "_version": "1.2.0",
-      "locales": {
-        "available": ["", "en"]
-      },
-      "availablePageTemplates": [],
-      "config": {
-        "icon": "portalsitetemplates/flp/preview.png",
-        "theme.id": "sap_fiori_3",
-        "theme.active": ["sap_fiori_3","sap_belize_hcb","sap_belize_hcw"],
-        "menu": {
-          "alignment": "left",
-          "availableDesktop": true,
-          "availableMobile": true,
-          "height": "s",
-          "version": "2.0",
-          "width": "full"
-        }
-      }
-    }
-  }
-}
diff --git a/test/unit/cdm/template-builder.spec.js b/test/unit/cdm/template-builder.spec.js
index 6c0a344..129d43d 100644
--- a/test/unit/cdm/template-builder.spec.js
+++ b/test/unit/cdm/template-builder.spec.js
@@ -7,12 +7,14 @@ const sinonTest = sinonTestFactory(sinon);
 const assert = chai.assert;
 
 describe('Template Builder unit tests', () => {
-    const basePath = '../resources/templates/default-site/';
+
+    const basePath = 'cdm-schema/dist/clp/site-default-entities/';
     const dummyTemplate = {
         "_version": "",
         "identification": {},
         "payload": {},
     };
+
     let doRequireStub;
 
     before(() => {
@@ -23,10 +25,11 @@ describe('Template Builder unit tests', () => {
         doRequireStub.restore();
     });
 
+
     describe('getSite', () => {
         it('should require and return the correct file', sinonTest(function() {
             const site = TemplateBuilder.getSite();
-            sinon.assert.calledWithExactly(doRequireStub, `${basePath}site.default`);
+            sinon.assert.calledWithExactly(doRequireStub, `${basePath}site.default.json`);
             assert.deepEqual(site, dummyTemplate);
         }));
     });
@@ -34,7 +37,7 @@ describe('Template Builder unit tests', () => {
     describe('getMenu', () => {
         it('should require and return the correct file', sinonTest(function() {
             const menu = TemplateBuilder.getMenu();
-            sinon.assert.calledWithExactly(doRequireStub, `${basePath}menu.default`);
+            sinon.assert.calledWithExactly(doRequireStub, `${basePath}menu.default.json`);
             assert.deepEqual(menu, dummyTemplate);
         }));
     });
@@ -42,7 +45,7 @@ describe('Template Builder unit tests', () => {
     describe('getFlpPage', () => {
         it('should require and return the correct file', sinonTest(function() {
             const flpPage = TemplateBuilder.getFlpPage();
-            sinon.assert.calledWithExactly(doRequireStub, `${basePath}pageapp.flp`);
+            sinon.assert.calledWithExactly(doRequireStub, `${basePath}pageapp.flp.json`);
             assert.deepEqual(flpPage, dummyTemplate);
         }));
     });
@@ -50,8 +53,8 @@ describe('Template Builder unit tests', () => {
     describe('getDefaultRole', () => {
         it('should require and return the correct file', sinonTest(function() {
             const defaultRole = TemplateBuilder.getDefaultRole();
-            sinon.assert.calledWithExactly(doRequireStub, `${basePath}role.default`);
+            sinon.assert.calledWithExactly(doRequireStub, `${basePath}role.everyone.json`);
             assert.deepEqual(defaultRole, dummyTemplate);
         }));
     });
-});
\ No newline at end of file
+});


->

        1.6.7


    1.7 undo enable flp mitigation and add all groups to groupOrder array

        1.7.1 pre research
jira: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1624
In Semantic Service:
For every new group creation, add it to the groupsOrder array in flppage.
For every group deletion, remove it from the groupsOrder array in flppage.


        1.7.2 plan
a. undo all mitigation changes
    work on branch mitigation.
    keep a copy of it


b. in preBatch detect create / delete of group.
in which case add/delete from groupsOrder array in flppage.

        1.7.3 

    1.8 [App Technologies] Destinations list: fetch from Cockpit + pre-fetch

        1.8.1 general

Goal: Load destinations from SCP in Site Manager loading
·         Contact: Tsafrir
·         @Limor, Shani – add dependency to Nili`s team
Tasks:
Sync with Nili’s Team
Design? – 1PD
Get Destinations list from Destination Service API (Nili’s Team Impl) and fill Destinations dropdown control 3PD
Tests – 2PD
7PDGoal: Load destinations from SCP in Site Manager loading
·         Contact: Tsafrir
·         @Limor, Shani – add dependency to Nili`s team
Tasks:
Sync with Nili’s Team
Design? – 1PD
Get Destinations list from Destination Service API (Nili’s Team Impl) and fill Destinations dropdown control 3PD
Tests – 2PD
7PDs


Motivation
We want to allow our customers to have a Portal site with 
User Story:
As an admin I would like to consume content from different back-ends using destination object
General \ Technical Information
API - https://api.sap.com/api/SAP_CP_CF_Connectivity_Destination/resource
Acceptance Criteria:
Load destinations from SCP when Site Manager is loading - done by Nili`s team (https://sapjira.wdf.sap.corp/browse/EUXTEAMNILI-3167 )
Connect the destinations list to the DDL attribute in the Business App editor (part of BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1548)
Show all available destinations (no destinations filter)
Client-server implementation
Cover error handling


        1.8.2 urls
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1551
JIRA: https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=3073&view=detail&selectedIssue=EUXTEAMGUYM-1551&quickFilter=9488



        1.8.3 code
[i500695@C02X632CJGH6:2019-03-18 14:36:43:~/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager:]513$ pwd
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager


        1.8.4 Design 
|  1. Establish mechanism for fetching DDL from cockpit.
|  
|  2. update code that builds model.
|  under detail model, add destinations array
|  /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/Component.js
|  
|  3. For edit mode
|  create drop down controller in Asaf's custom controller
|  
|      3.1 if not destination is selected set the 'app technology' controller to disabled with 'url' technology selected
|  
|      3.2 if a destination is selected set the 'app technology' controller is enabled 
|  
|  4. For display mode

looks like Yaron will build BFF service that would fetch the destinations.
This involves accessing xsa of a different subaccount
Then in a yet to be determined fashion this would be made available on client side

As a result I don't have real work here

        1.8.5

    1.9 [App Technologies] Inbound params + Viz params in Business App editor

        1.9.1 general

Tasks-Breakdown:
Goal: Enhance the Business App editor to support App Technologies
@Nahshon, Omer, @Barak, Shir  – inbound parameters collapsed
Tasks:
Design – 2PD
Test scope (shmanman) – 2PD
Add the parameters support to Navigation tab -
Parameters table – use sap.ui.Table – 3PDs
Collapsed when no data
Add new row when user insert new param name -  3PD
Validations – 2PD
 
Add parameters table (key, value) in Visualization tab, collapsed by default – 2PDs
 
Additional parameters in the navigation tab is managed in a check-box that influences the visualization of parameters table in the visualization tab: 2PD
If the check-box is checked: set the attribute to allowed – params area in the vis is available in the UX
If the check-box is un-checked: set the attribute to ignored – params area in the vis is not available in the UX
UIVeri5 tests – 4PD
20PDs


        1.9.2 links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1620
JIRA: 
Design-Document: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2080870733
Test-Scope: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2080871151
Strings: smb://iltlvg101.tlv.global.corp.sap/DEV_P_EP/Projects/ODP/Info Development/UI Strings/CF (Cloud Foundry)/2019.03 CF - Role Editor.docx

Strings:
Current String	Correct String	Classification	Comment
NAVIGATION	NAVIGATION	XTIT	Tab title
Inbounds	Intent	XTIT	
Please define…	An intent (inbound) is comprised of a semantic object, an action, and parameters.	XMSG	
Semantic Object	Semantic Object	XFLD	
Action	Action	XFLD	
Parameters Inbound	Intent Parameters	XTIT	
Please define…	Parameters of the intent.	XMSG	
[i]	Parameters that are passed to the app when accessing it in runtime. For more infoemation , see <link to docu>.	XMSG	Link:
https://help.sap.com/viewer/c0fe6b2660754f609482d4bfc5c619b1/1.18/en-US/bd8ae3d327ab4541bcce8e7353c046fc.html
No Parameters	No intent parameters defined	XMSG	

Current String	Correct String	Classification
Name	Name	XTIT
Default Value	Default Value	XMSG
[i]	A default value for the parameter. 	XTOL
Rename to	Rename to	XTIT
Transfer additional parameters…	Allow to pass additional parameters to the app	XCKL
[i]	Specify whether to allow passing additional parameters to the app. These parameters, defined in the Visualization tab, can provide specific values for the intent parameters, or be additional parameters that are not defined in the intent.	XTOL

Validation-Strings:
Current String	Correct String
Enter max 30 characters	Enter up to 30 characters
Invalid characters	Enter ???

        1.9.3 Design

            1.9.3.1 Motivation
 We would like to allow our customers a quick way to manually integrate UI5, WDA, WebGUI and URL applications to the portal site.
This is the first step to allow customers an FLP site with different applications side by side which are consumed from different content providers.
User Story:
As an Administrator I would like to Create / Manage / Integrate a Business App pointing to a single UI5 / WDA / WebGui technology-based app in cFLP in order to run it in the Portal site side by side with additional Business Apps
create = the administrator is adding manually the specific attributes for each technology based on the URL Template defined in CDM Schema
single UI5 / WDA / WebGui technology-based app = a Blue-Box application which is either SAP delivered or customized
 
General \ Technical Information
Epic Wiki: UI5, WDA and WebGUI apps (manual creation)
Examples in ACD wiki
Acceptance Criteria:
Enhance the Business App editor to support App Technologies
No RT validation is required in this BLI
Only one inbound for a Business App is supported at this point (later we will support full CDM 3.0 so that a Business App will have multiple in-bounds and multiple visualizations). The code should be ready to support multiple in-bounds.
Add the parameters support to Navigation tab
Add parameters table (key, value) in Visualization tab, collapsed by default
Additional parameters in the navigation tab is managed in a check-box that influences the visualization of parameters table in th visualization tab:
If the check-box is checked: set the attribute to allowed – params area in the vis is available in the UX
If the check-box is un-checked: set the attribute to ignored – params area in the vis is not available in the UX
Launcher Value parameters are not supported in the UX although the schema support it (agreed with Steffen Heuster and Amir)
Make sure that all Business App editor guidelines are followed with the addition of the visualization tab (flows: create, save (save + activate), delete, back, created attributes, modified attributes etc). Follow Business App BLI
Client-server implementation

Cover error handling
Follow UX
PO + VD + UX review 
Should be automated in UIVeri5

finder, cmd+k
smb://ILTLVG101.tlv.global.corp.sap/DEV_P_EP/Projects/ODP/UX and Visuals/2019T03/
smb://ILTLVG101.tlv.global.corp.sap/DEV_P_EP/Projects/ODP/UX and Visuals/2019T03/PDF(Omer) Nav Parameters - V03.pdf

Strings - Anat

In navigation tab.
Add '> Parameters Inbound' (string to be finalized)
Table should be hidden

click to show table
*name   Default Value i     Value Format (type) i       Rename to (i)
                            drop down                                   X

check box 
'Transfer additional parameters from the intent to the application'

            1.9.3.2 data-binding

-> Schema
[i500695@C02X632CJGH6:2019-03-26 17:03:45:~/work/SAP/git/cdm-schema:]506$ 
 examples/designtime/apollo/business-apps/businessapp.custom-tile.json  
 examples/designtime/apollo/business-apps/businessapp.dynamic-tile.json 
 examples/designtime/apollo/business-apps/businessapp.static-tile.json  
 schema/apollo/businessapp.json                                         
 schema/designtime/commons.json                                         
 schema/designtime/viztype.json                                         

 Navigation tab parameters table data binding are under targetAppConfig/sap.app/crossNavigation/inbounds
 Visualization tab parameters table data binding are under vizConfig/sap.flp/target/parameters 

{
  "_version": "3.0",
  "_layeringStrategy": {
    "object": "merge",
    "array": "replace"
  },
  "identification": {
    "id": "businessapp.static-viz",
    "entityType": "businessapp",
    "title": "{{app_title}}"
  },
  "payload": {
    "targetAppConfig": {
      "_version": "1.11.0",
      "reference": "cus.sd.billingdoclist.manages1",
      "sap.app": {
        "crossNavigation": {
          "inbounds": {
            "_layeringStrategy": "replace",
            "InvoiceList-manage": {
              "semanticObject": "InvoiceList",
              "action": "manage"
            },
            "signature": {
                    "parameters" : {
                            "<Name from parameters table>" : {
                                    "required": <required from parameters table, defaults to false>,
                                    "renameTo": <renameTo from parameters table>,
                                    "default": {
                                            "Value": <value from parameters table>,
                                            "format": <value_format, hard coded to 'plain'>
                                    }
 
                    }
 
          }
         },
            "additionalParameters": <transfer checkbox from parameters section, defaults to "allowed">
        }
        },
        "tags": {
          "_layeringStrategy": {
            "array": "append"
          },
          "technicalAttributes": [
            "SAP_TC_CEC_SD_COMMON"
          ]
        }, 
      "sap.ui": {
        "icons": {
          "icon": "sap-icon://Fiori2/F0026"
        }
      }
    },
    "visualizations": {
      "InvoiceList-manage": {
        "vizType": "sap.ushell.StaticAppLauncher",
        "vizConfig": {
          "sap.app": {
            "title": "{{viz_title}}"
          },
          "sap.flp": {
            "target": {
              "type": "IBN",
              "inboundId": "InvoiceList-manage",
              "parameters": {
                    "<value from parameters table in visualizations tab>": {
                            "value": {
                                    "value": <value from parameters table in visualizations tab>,
                                    "format": "plain"
                            }
              }
            }
          }
        }
      }
     }
    },
    "defaultViz": "InvoiceList-manage"
  }
  },
  "texts": [
    {
      "locale": "",
      "textDictionary": {
        "app_title": "Invoices",
        "viz_title": "Invoices Tile"
      }
    },
    {
      "locale": "es",
      "textDictionary": {
        "app_title": "Facturas",
        "viz_title": "Facturas Mosaico"
      }
    }
  ]
}

-> Initializer:
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/contentComponentConfig/app/AppEntityInitializer.js
    var AppEntityInitializer = {
        _addAppIntent: function (oEntity, sGeneratedIntentForUrl) {
            oEntity.cdm.payload.targetAppConfig["sap.app"].crossNavigation.inbounds[sGeneratedIntentForUrl] = {};
            oEntity.cdm.payload.targetAppConfig["sap.app"].crossNavigation["signature"] = {};
            oEntity.cdm.payload.targetAppConfig["sap.app"].crossNavigation.signature["parameters"] = {};
            oEntity.cdm.payload.targetAppConfig["sap.app"].crossNavigation.signature.additionalParameters = "allowed";
            oEntity.cdm.payload.visualizations["RandomURL-Launcher"].vizConfig["sap.flp"].target.inboundId = sGeneratedIntentForUrl;
            oEntity.cdm.payload.visualizations["RandomURL-Launcher"].vizConfig["sap.flp"].target.parameters = {};
        },

-> tests:
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/test/unit/contentComponentConfig/app/AppEntityInitializer.qunit.js
        ...
                    "payload": {
                        "targetAppConfig": {
                            "_version": "1.13.0",
                            "sap.app": {
                                "crossNavigation": {
                                    "inbounds": {
                                        "GenericURL-123": {}
                                    },
                                    "signature": {
                                        "parameters": {},
                                        "additionalParameters": "allowed"
                                    }
                                },
                                "tags": {
                                    "keywords": []
                                }
                            },
                            "sap.integration": {
                                "urlTemplateId": "templateGenericURL",
                                "urlTemplateParams": {
                                    "url": "",
                                    "query": {}
                                },
                                "navMode": "inplace"
                            }
                        },
                        "visualizations": {
                            "RandomURL-Launcher": {
                                "vizType": "sap.ushell.StaticAppLauncher",
                                "vizConfig": {
                                    "sap.ui": {
                                        "icons": {
                                            "icon": ""
                                        }
                                    },
                                    "sap.app": {
                                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
                                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
                                    },
                                    "sap.flp": {
                                        "target": {
                                            "type": "IBN",
                                            "inboundId": "GenericURL-123",
                                            "parameters": {}
                                        }
                                    }
                                }

                            }
                        },
                        "defaultViz": "RandomURL-Launcher"
                    },
...
                                    "sap.flp": {
                                        "target": {
                                            "type": "IBN",
                                            "inboundId": "GenericURL-123",
                                            "parameters": {}
                                        }
                                    }
            1.9.3.3 last moment changes

            1.9.3.4 help w/ urlTemplate qunits

                1.9.3.4.1 UrlTemplate.js

'use strict';
sap.ui.define(
  [
    'sap/ui/core/Control',
    'sap/ushell/services/designer/infra/services/cdm/UrlTemplateService',
    'sap/ushell/services/designer/infra/controls/FormElement',
    'contentManager/controls/FormGenerator'
  ],
  function(Control, UrlTemplateService, FormElement, FormGenerator) {

    return Control.extend('contentManager.controls.urlTemplate', {
      metadata: {
        properties: {
          mode: { type: 'string', defaultValue: 'display' },
          appTechnologies: { type: 'array', defaultValue: [] },
          technology: { type: 'string', defaultValue: '' },
          destination: {type: 'string', defaultValue: 'none'},
          parameters: { type: 'object', defaultValue: {} },
          apptechnology: { type: 'string', defaultValue: 'AppTech' },
          name: { type: 'string', defaultValue: 'Value' },
          value: { type: 'string', defaultValue: 'Value' }
        }
      },

/* istanbul ignore next */
      init: function() {
        this.oModel = new sap.ui.model.json.JSONModel({
          appTechnologies: [],
          mode: 'display',
          technology: null,
          parameters: {},
          URLTemplate: null,
          destination: '',
          enabledSelection: true
        });

        this.eventBus = sap.ui.getCore().getEventBus();
        this.eventBus.subscribe('urlParameters', 'paramsChanged', this._onParametersChange.bind(this));
        this.form = this._getForm();
        this.formGenerator = this._getFormGenerator();
      },

/* istanbul ignore next */
      renderer: function(oRM, oControl) {
        oRM.write('<div class="url-template"');
        oRM.writeControlData(oControl);
        oRM.write('>');
        oRM.renderControl(oControl.form);
        oRM.renderControl(oControl.formGenerator);
        oRM.write('</div>');
      },

/* istanbul ignore next */
      isAppTechEnabled: function(sDestination) {
          return (sDestination !== "none");
      },

/* istanbul ignore next */
      _getForm: function() {
        if (this.form) {
          return this.form;
        }

        var itemTemplate = new sap.ui.core.ListItem({
          key: '{key}',
          text: '{text}',
          enabled: '{enabled}'
        });

        this.cmbBox = new sap.m.ComboBox('cmbTechnologies', {
          items: {
            path: '/appTechnologies',
            template: itemTemplate
          },
          enabled: {path: '/destination', formatter: this.isAppTechEnabled},
          selectedKey: {path: '/technology'},
          selectionChange: function(evt) {
            this._onTechnologyChange(evt);
          }.bind(this)
        }).setModel(this.oModel);

        this.cmbBox.addStyleClass("UIVeri5AppTechDropdown");
        this.cmbBox.addCustomData(
          new sap.ui.core.CustomData({
            key: 'type',
            value: 'edit'
          })
        );

        var txt = new sap.m.Text({
          text: {
            path: '/technology',
            formatter: function(tech) {
              if (!this.oModel.getProperty('/technology')) {
                return '';
              }
              var appTech = _.find(this.appTechnologies, function(t) {
                return t.key === tech;
              });
              return appTech ? appTech.text : '';
            }.bind(this)
          }
        }).addCustomData(
          new sap.ui.core.CustomData({
            key: 'type',
            value: 'display'
          })
        );

        txt.addStyleClass("UIVeri5AppTechText");
        this.appTechElement = new FormElement('frmElm', {
          label: 'App Technologies',
          content: [this.cmbBox, txt]
        });
        this.form = new sap.ushell.services.designer.infra.controls.Form(
          'url-template-form',
          {
            toolbarClass: 'AppPropertiesContentGeneralToolbar',
            editable: true,
            mode: { path: '/mode' },
            content: [this.appTechElement]
          }
        ).setModel(this.oModel);
        this.form.addStyleClass('AppPropertiesContentGeneral');
        return this.form;
      },

/* istanbul ignore next */
      _getFormGenerator: function() {
        if (!this.formGenerator) {
          this.formGenerator = new FormGenerator({
            URLTemplate: { path: '/URLTemplate' },
            mode: { path: '/mode' },
            parameters: { path: '/parameters' },
            parametersChange: this._onParametersChange.bind(this)
          }).setModel(this.oModel);
        }

        return this.formGenerator;
      },

/* istanbul ignore next */
      getUrlTemplateValidators: function() {
        return this.formGenerator.getFormElementsValidations();
      },

/* istanbul ignore next */
      _onTechnologyChange: function(oEvent) {
        var key = oEvent.getParameter('selectedItem').getKey();
        this._technologyChanged(key);
      },
      _technologyChanged: function(key) {
        UrlTemplateService.getUrlTemplate(key).then(
          function(urlTemplate) {
            this.setProperty('technology', key, true);

            var params = urlTemplate.payload.parameters.signature;
            var parametersModel = _.reduce(
              params,
              function(result, value, key) {
                result[key] = value.type === 'map' ? {} : '';
                return result;
              },
              {}
            );
            this.oModel.setProperty('/parameters', parametersModel);
            var paramsModel = this.getProperty('parameters');
            Object.keys(paramsModel).forEach(function(key) {
              delete paramsModel[key];
            });
            _.reduce(
              params,
              function(result, value, key) {
                result[key] = value.type === 'map' ? {} : '';
                return result;
              },
              this.getProperty('parameters')
            );
            this.setProperty('parameters', paramsModel, true);
            this.oModel.setProperty('/URLTemplate', urlTemplate);
          }.bind(this)
        );
      },

/* istanbul ignore next */
      _onParametersChange: function(eventName, eventChannel, payload) {
        let modelParams =  payload || {};
        this.oModel.setProperty(
          '/parameters',
            modelParams
        );
        this.setProperty('parameters', modelParams, true);
      },

      /**
       * Update the ComboBox
       * @private
       */
      _populateAppTechnonlogies: function() {
        var destination = this.oModel.getProperty('/destination');
        var selectedTechnology = { key: 'urltemplate.url', text: 'URL' };
        if (destination !== 'none') {
          // URL is the default technology when no system but if there is a destination take the 1st enabled technology
          var technologies = this.oModel.getProperty('/appTechnologies');
          selectedTechnology = _.find(technologies, ['enabled', true]);
        }
        this.oModel.setProperty('/technology', selectedTechnology.key);
        this.cmbBox.rerender();
        this._technologyChanged(selectedTechnology.key);
      },

      setMode: function(sMode) {
        this.setProperty('mode', sMode, true);
        this.oModel.setProperty('/mode', sMode);
        this.rerender();
      },

      setTechnology: function(sTechnology) {
        this.setProperty('technology', sTechnology, true);
        this.oModel.setProperty('/technology', sTechnology);
        UrlTemplateService.getUrlTemplate(sTechnology).then(
          function(urlTemplate) {
            this.oModel.setProperty('/URLTemplate', urlTemplate);
          }.bind(this)
        );
      },

      setParameters: function(oParameters) {
        this.setProperty('parameters', oParameters, true);
        var parametersClone = _.cloneDeep(oParameters);
        this.oModel.setProperty('/parameters', parametersClone);
      },

      setDestination: function(sDestination) {
        this.setProperty('destination', sDestination, true);
        this.oModel.setProperty('/destination', sDestination);

        // Update technology and rerender the App Thechnology combo box
        if (this.oModel.getProperty('/mode') === 'edit') {
            this._populateAppTechnonlogies();
        }
      },

      setAppTechnologies: function(appTechnologies) {
        let allTechs = _.cloneDeep(appTechnologies);
          allTechs.forEach(function (curTech) {
                  curTech.enabled = (curTech.key !== "urltemplate.url");
              }
          );
        this.oModel.setProperty('/appTechnologies', allTechs);
        this.appTechnologies = allTechs;
      },

      exit: function() {}
    });
  }
);


                1.9.3.4.2 UrlTemplate.qunit.js

"use strict";

sap.ui.define([
    "contentManager/controls/UrlTemplate",
    'sap/ushell/services/designer/infra/services/cdm/UrlTemplateService',
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/json/JSONModel",
    "sap/ushell/services/designer/infra/utils/LibRegistry",
    'sap/ui/thirdparty/sinon'
], function (UrlTemplate, UrlTemplateService, Controller, JSONModel, LibRegistry, sinon) {

    let _;
    let oControl;
    let loadDashFindStub;
    let urlTemplateServiceGetUrlTemplateStub;
    let getPropertyStub;
    let setPropertyStub;

    QUnit.module('contentManager.controls.UrlTemplate', {
            beforeEach: function () {

                _ = LibRegistry.getLib("lodash");
                loadDashFindStub = sinon.stub(_, "find").returns({
                        key: 'aKey'
                });

                if(!oControl) {
                    oControl = new UrlTemplate();
                }
                oControl.oModel = {
                        getProperty: function () {
                            return "x";
                        },
                        setProperty: function () {

                        }
                };

                oControl.cmbBox = {
                    rerender: function () {

                    }
                };

                setPropertyStub = sinon.stub(oControl, "setProperty");
                getPropertyStub = sinon.stub(oControl, "getProperty");

                urlTemplateServiceGetUrlTemplateStub = sinon.stub(UrlTemplateService, 'getUrlTemplate').returns(jQuery.Deferred().resolve({}));
            },

            afterEach: function () {
                    loadDashFindStub.restore();
                    urlTemplateServiceGetUrlTemplateStub.restore();
                    getPropertyStub.restore();
                    setPropertyStub.restore();
            }
        });

    QUnit.test('_populateAppTechnologies', sinon.test(function (assert) {
        let setPropertyModelStub = this.stub(oControl.oModel, 'setProperty').returns([]);
        let getPropertyModelStub = this.stub(oControl.oModel, 'getProperty').returns({});
        let rerenderStub = this.stub(oControl.cmbBox, 'rerender');
        let technologyChangedStub = sinon.stub(oControl, "_technologyChanged");

        oControl._populateAppTechnonlogies();

        assert.ok(getPropertyModelStub.calledTwice);
        assert.ok(setPropertyModelStub.calledOnce);
        assert.ok(loadDashFindStub.calledOnce);
        assert.ok(technologyChangedStub.calledOnce);
        assert.ok(rerenderStub.calledOnce);
    }));

    QUnit.test('setMode', sinon.test(function (assert) {
        let rerenderStub = this.stub(oControl, 'rerender');

        oControl.setMode();
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(rerenderStub.calledOnce);
    }));

    QUnit.test('setTechnology getUrlTemplate resolved', sinon.test(function (assert) {
        oControl.setTechnology();
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(urlTemplateServiceGetUrlTemplateStub.calledOnce);
    }));

    QUnit.test('setParameters', sinon.test(function (assert) {
        const loadDashCloneDeepStub = this.stub(_, "cloneDeep").returns();
        oControl.setParameters();
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(loadDashCloneDeepStub.calledOnce);
    }));

    QUnit.test('setDestination', sinon.test(function (assert) {
        let _populateAppTechnonlogiesStub = this.stub(oControl, '_populateAppTechnonlogies');
        sinon.stub(oControl.oModel, 'getProperty').returns("edit");
        oControl.setDestination();
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(setPropertyStub.calledOnce);
        assert.ok(_populateAppTechnonlogiesStub.calledOnce);
    }));

    QUnit.test('setAppTechnologies', sinon.test(function (assert) {
        const loadDashCloneDeepStub = this.stub(_, "cloneDeep").returns([]);
        let setPropertyModelStub = this.stub(oControl.oModel, 'setProperty').returns([]);
        oControl.setAppTechnologies();
        assert.ok(setPropertyModelStub.calledOnce);
        assert.ok(loadDashCloneDeepStub.calledOnce);
    }))
});

                1.9.3.4.3
            1.9.3.5
        1.9.4 open questions
- Value format type drop down. Where to get possible types?  
/Users/i500695/work/SAP/git/cdm-schema/app-schema-dist/AppDescriptor.extended.schema.json
                                    "format": {
                                      "description": "Indicates how 'value' is to be interpreted: ('plain': the 'value' is taken as a literal string value| 'reference': the 'value' is a reference to e.g. a UserDefault parameter (e.g. 'UserDefault.CostCenter'), the resolved parameter value is used)",
                                      "type": "string",
                                      "enum": [
                                        "plain",
                                        "reference"
                                      ]

confirm w/ Amir


- 
questions to Amir
use for drop down. plain / reference

questions to Shani
- Is transfer checkbox checked by default? - checked
- UX in display mode for inbound-parameters in the navigation tab. define.
if values opened
if no values collapsed 
- 

        1.9.5 learn

            1.9.5.1 Session: /Users/i500695/work/vim_sessions/sap/appEditor

            1.9.5.2 Content Manager View: 
            /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/view/manager.view.xml
- code:
<View controllerName="contentManager.controller.manager" class="rootView" xmlns="sap.ui.table" xmlns:mvc="sap.ui.core.mvc" xmlns:u="sap.ui.unified" xmlns:c="sap.ui.core" xmlns:layout="sap.ui.layout" xmlns:m="sap.m" xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1" height="100%">
    <m:Page id="managerPage" showHeader="false" enableScrolling="true" class="managerPage bgWhite">
        <m:content>
            <m:Toolbar id="filters" height="8rem">
                <m:VBox class="sapUiMediumMargin"  >
                    <m:Label text="{i18n>ITEM_TYPE}" />
                    <m:Select id="entityTypeSelect" selectedKey="1" change="filterTable"
                              width="15rem"
                              class="filterSelect sapUiSizeCompact"
                              enabled="{path:'/items',formatter:'.formatter.itemsLengthLargerThanZero'}"
                              items="{path: 'selectModel>/items'}">
                        <m:items>
                            <c:Item key="{selectModel>type}" text="{path: 'selectModel>text_filter', formatter:'.formatter.translate'}"/>
                        </m:items>
                    </m:Select>
                </m:VBox>
            </m:Toolbar>
            <m:FlexBox direction="Column" visible="true" class="rootContainer sapUiMediumMargin">
                <m:items>
                    <m:Toolbar style="Clear" width="100%" class="toolBar">
                        <m:content>
                            <m:Title text="{i18n>TABLE_ITEMS}" level="H1" class="itemsTitle marginLeft0" />
                            <m:Title id="txtItems" text="({path:'/items',formatter:'.formatter.itemsLength'})" level="H1" />
                            <m:ToolbarSpacer />
                            <!-- <m:Button id="btnNew" icon="sap-icon://add" text="{i18n>NEW}" type="Emphasized" press="createEntityPressed"></m:Button> -->
                            <m:Button id="btnNew" text="+ {i18n>NEW}" type="Emphasized" press="createEntityPressed" class="btnNew"></m:Button>
                        </m:content>
                    </m:Toolbar>
                    <m:Label />
                    <m:FlexBox id="tableContainer" direction="Column" alignItems="Stretch" visible="{path:'/items',formatter:'.formatter.itemsLengthLargerThanZero'}">
                        <m:items>
                            <Table id="table" class="tblContentManager" rowHeight="46" alternateRowColors="true"  visibleRowCount="{path:'/items',formatter:'.formatter.itemsLength'}" minAutoRowCount="1" selectionMode="None" rows="{/items}" sort="sortDeliveryDate" ariaLabelledBy="title">
                                <columns>
                                    <Column resizable="false" width="3.5rem" hAlign="Center" class="iconColumn">
                                        <m:Label text="" />
                                        <template>
                                            <!-- <c:Icon src="{path:'type',formatter:'.formatter.iconType'}" size="1.2rem" color="#7CB342" /> -->
                                            <!-- <c:Icon src="{path:'type',formatter:'.formatter.iconType'}" size="1.2rem" color="#7CB342" /> -->
                                            <m:Image height="24px" src="{path:'type',formatter:'.formatter.iconType'}" class="tblIcon" densityAware="false" tooltip="{
                                            path:'type',
                                            formatter:'.formatter.contentType'}" />
                                        </template>
                                    </Column>
                                    <Column id="title" sortProperty="title">
                                        <m:Label text="{i18n>TBL_COL_TITLE}" class="tblHeader" />
                                        <template>
                                            <m:Link text="{title}" subtle="false" tooltip="{i18n>GO_TO_TOOLTIP} {type}: {title}" app:id="{id}" app:type="{type}" press="entityPicked" class="tblColContent UIVeri5EntityTitle" />
                                        </template>
                                    </Column>
                                    <Column id="description" showSortMenuEntry="true" sortProperty="description">
                                        <m:Label text="{i18n>TBL_COL_DESCRIPTION}" class="tblHeader" />
                                        <template>
                                            <m:Text text="{description}" wrapping="false" class="tblColContent UIVeri5EntityDescription" />
                                        </template>
                                    </Column>
                                </columns>
                            </Table>
                        </m:items>
                    </m:FlexBox>
                    <m:FlexBox id="noDataContainer" direction="Column" class="noDataContainer" alignItems="Center" justifyContent="Center" visible="{path:'/items',formatter:'.formatter.isItemsLengthZero'}">
                        <m:items>
                            <m:Image src="contentManager/resources/images/NDTD_nontext.png" densityAware="false" />
                            <m:Text text="{i18n>NO_ITEMS_TO_DISPLAY}" class="noDataText" />
                            <m:Text text="{i18n>CLICK_NEW_TO_ADD_ITEM}" />
                        </m:items>
                    </m:FlexBox>
                </m:items>
            </m:FlexBox>
        </m:content>
    </m:Page>
</View>

- Notable:
    -- page control 
    <m:Page id="managerPage" showHeader="false" enableScrolling="true" class="managerPage bgWhite">
https://sapui5.hana.ondemand.com/#/api/sap.m.Page
consists of header, content and footer
        
    -- <m:content>, the content
https://sapui5.hana.ondemand.com/#/api/sap.m.Toolbar

    -- <m:VBox class="sapUiMediumMargin"  >
https://sapui5.hana.ondemand.com/#/api/sap.m.VBox

    -- <m:Label text="{i18n>ITEM_TYPE}" />
    https://sapui5.hana.ondemand.com/#/api/sap.m.Label
label, note that the text is loaded from i18n model, ITEM_TYPE

    -- drop down
    https://sapui5.hana.ondemand.com/#/api/sap.m.Select

                    <m:Select id="entityTypeSelect" selectedKey="1" change="filterTable"
                              width="15rem"
                              class="filterSelect sapUiSizeCompact"
                              enabled="{path:'/items',formatter:'.formatter.itemsLengthLargerThanZero'}"
                              items="{path: 'selectModel>/items'}">
                        <m:items>
                            <c:Item key="{selectModel>type}" text="{path: 'selectModel>text_filter', formatter:'.formatter.translate'}"/>
                        </m:items>
                    </m:Select>

Note that change fire filterTable event which calls filterTable in manager (manager.controler.js)
formatter is another class w/ util functions that usually are used for controlling visibility and enable
items are taken from model (a big {}), they are an aggregation of Select


    --
    --
    --
    --
    --
    --


Content Manager Controller: /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/controller/manager.controller.js
Init Model and components: /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/siteSetting/webapp/Component.js
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/view/createEntity.fragment.xml
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/infra/src/sap/ushell/services/designer/infra/services/cdm/SemanticService.js
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/view/app/AppVisualizationContent.view.xml
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/contentComponentConfig/app/AppTabsSetup.js
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/resources/apps/i18n.properties
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/controller/app/AppVisualizationContent.controller.js

        1.9.6 add info icons

            1.9.6.1  research

a. /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/view/app/InboundParameters.view.xml
        <Panel expandable="true" expanded="false" class="panel-content" width="100%" headerText="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TITLE}">
        replace headerText with header Toolbar.

b. header toolbor: https://sapui5.hana.ondemand.com/#/sample/sap.m.sample.PanelExpanded/code
<mvc:View
	xmlns:l="sap.ui.layout"
	xmlns:core="sap.ui.core"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.m">
	<Panel expandable="true" expanded="false" headerText="Panel with a header text" width="auto" class="sapUiResponsiveMargin">
		<content>
			<Text text="Lorem ipsum dolor st amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat" />
		</content>
	</Panel>
	<Panel expandable="true" expanded="false" width="auto" class="sapUiResponsiveMargin">
		<headerToolbar>
			<Toolbar height="3rem" style="Clear">
				<Title text="Custom Toolbar with a header text" />
				<ToolbarSpacer />
				<Button icon="sap-icon://settings" />
				<Button icon="sap-icon://drop-down-list" />
			</Toolbar>
		</headerToolbar>
		<content>
			<Text text="Lorem ipsum dolor st amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat" />
		</content>
	</Panel>
</mvc:View>

c. replace with info icon
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/infra/src/sap/ushell/services/designer/infra/controls/InfoIcon.js

usage, created dynamically
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/infra/src/sap/ushell/services/designer/infra/components/assignmentPanel/controller/AssignmentPanel.controller.js
            _getListTitleAndInfo: function (sTranslatedTitleText, sEntityType, sTranslatedInfoIconText) {
              const HBox = new sap.m.HBox();
              HBox.addItem(new sap.m.Title({text: sTranslatedTitleText}));
              let infoIconVisibility = sEntityType === BUSINESSAPP_ENTITY_TYPE;
              const infoIconControl = new this.infoIcon({title: sTranslatedInfoIconText, visible: infoIconVisibility});
              HBox.addItem(infoIconControl);
              return HBox;
            },

usage, created statically:
https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-approuter/commit/decbc3ff6cfca574aa852c847fdaab4900c93764
 

            1.9.6.2

        1.9.7 Code 

https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-approuter/pull/516/files?utf8=✓&diff=unified

Inbound Parameters, Viz Parameters #516
Changes from all commits 
29  static-resources/contentManager/webapp/contentComponentConfig/app/AppEntityInitializer.js
@@ -1,10 +1,10 @@
	"use strict";
	sap.ui.define([
	    'sap/ushell/services/designer/infra/utils/EntityUtils'
	], function() {
	    var AppEntityInitializer = {
	], function () {
	    return {
	        initEntity: function initEntity(id) {
	            let oEntity = {
	            return {
	                "cdm": {
	                    "_version": "3.0",
	                    "identification": {
 @@ -18,7 +18,14 @@ sap.ui.define([
	                            "_version": "1.13.0",
	                            "sap.app": {
	                                "crossNavigation": {
	                                    "inbounds": {}
	                                    "inbounds": {
	                                        "GenericURL-Launch": {
	                                            "signature": {
	                                                "parameters": {},
	                                                "additionalParameters": "allowed"
	                                            }
	                                        }
	                                    }
	                                },
	                                "tags": {
	                                    "keywords": []
 @@ -43,16 +50,14 @@ sap.ui.define([
	                                        }
	                                    },
	                                    "sap.app": {
	                                        // "title": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|title}}",
	                                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	                                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	                                    },
	                                    "sap.flp": {
	                                        "target": {
	                                            "type": "IBN",
	                                            "inboundId": "",
	                                            "parameters": {
	                                            }
	                                            "parameters": {}
	                                        }
	                                    }
	                                }
 @@ -74,12 +79,6 @@ sap.ui.define([
	                                "": ""
	                            }
	                        },
	                        // "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|title": {
	                        //     "type": "XTIT",
	                        //     "value": {
	                        //         "": ""
	                        //     }
	                        // },
	                        "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
	                            "type": "XTIT",
	                            "value": {
 @@ -101,10 +100,6 @@ sap.ui.define([
	                    "updatedBy": ""
	                }
	            };
	
	            return oEntity;
	        }
	    };
	
	    return AppEntityInitializer;
	}); 
Copy path View file      
8  static-resources/contentManager/webapp/controller/app/AppNavigationContent.controller.js
 @@ -5,7 +5,7 @@ sap.ui.define([
	    'sap/ushell/services/designer/infra/utils/Validator'
	], function (Controller, Validations, Validator) {
	
	    const AppNavigationContent = Controller.extend("contentManager.controller.app.AppNavigationContent", {
	    return Controller.extend("contentManager.controller.app.AppNavigationContent", {
	
	        onInit: function () {
	            this.oCmp = this.getOwnerComponent();
 @@ -14,8 +14,10 @@ sap.ui.define([
	        },
	
	        hasInvalidControl: function () {
	            return this.getView().byId("appNavigationInbounds").getController().hasInvalidControl();
	            const parametersController = this.getView().byId("inboundParameters").getController();
	            const intentController = this.getView().byId("appNavigationInbounds").getController();
	
	            return parametersController.hasInvalidControl() || intentController.hasInvalidControl();
	        }
	    });
	    return AppNavigationContent;
	});
Copy path View file      
20  static-resources/contentManager/webapp/controller/app/AppNavigationInbounds.controller.js
 @@ -19,20 +19,20 @@ sap.ui.define([
	            this.oBundle = this.oCmp.getModel("i18n");
	        },
	
	        getActionFromInbounds: function(sVal) {
	        getActionFromInbounds: function (sVal) {
	            let res = "";
	            if (sVal && Object.keys(sVal).length > 0) {
	                res = Object.keys(sVal)[0].split('-')[1];
	            }
	            return res;
	            return res !== 'Launch' ? res : "";
	        },
	
	        getSemanticObjectFromInbounds: function(sVal) {
	        getSemanticObjectFromInbounds: function (sVal) {
	            let res = "";
	            if (sVal && Object.keys(sVal).length > 0) {
	                res = Object.keys(sVal)[0].split('-')[0];
	            }
	            return res;
	            return res !== 'GenericURL' ? res : "";
	        },
	
	        hasInvalidControl: function () {
 @@ -86,14 +86,14 @@ sap.ui.define([
	        },
	
	
	        getCurrentSelectedItemInboundsKey: function() {
	        getCurrentSelectedItemInboundsKey: function () {
	            let selectedItem = this.oCmp.getSelectedItem();
	
	            return (selectedItem.data.inbounds && Object.keys(selectedItem.data.inbounds).length > 0) ?
	                Object.keys(selectedItem.data.inbounds)[0] : "";
	        },
	
	        onSemanticObjectInputChange: function(e) {
	        onSemanticObjectInputChange: function (e) {
	            let validationControl = this.getValidationControls().filter(function (validationControl) {
	                return validationControl.uiElement.getId() === e.getSource().getId();
	            });
 @@ -105,7 +105,7 @@ sap.ui.define([
	            this.updateSelectedItemInbounds(oInboundsObject, sInboundsKey);
	        },
	
	        onActionInputChange: function(e) {
	        onActionInputChange: function (e) {
	            let validationControl = this.getValidationControls().filter(function (validationControl) {
	                return validationControl.uiElement.getId() === e.getSource().getId();
	            });
 @@ -117,19 +117,19 @@ sap.ui.define([
	            this.updateSelectedItemInbounds(oInboundsObject, sInboundsKey);
	        },
	
	        updateSelectedItemInbounds: function(oInboundsObject, sInboundsKey) {
	        updateSelectedItemInbounds: function (oInboundsObject, sInboundsKey) {
	            let selectedItem = this.oCmp.getSelectedItem();
	            selectedItem.data.inbounds = {};
	            selectedItem.data.inbounds[sInboundsKey] = oInboundsObject;
	            selectedItem.data.inboundId = sInboundsKey;
	            this.oCmp.setSelectedItem(selectedItem);
	        },
	
	        generateInboundsObject: function(sSemanticObject, sAction) {
	        generateInboundsObject: function (sSemanticObject, sAction) {
	            return {semanticObject: sSemanticObject, action: sAction};
	        },
	
	        _onCancel: function() {
	        _onCancel: function () {
	            this.getView().byId("appSemanticObjectInput").setValueState("None");
	            this.getView().byId("appActionInput").setValueState("None");
	        },
Copy path View file      
171  static-resources/contentManager/webapp/controller/app/InboundParameters.controller.js
@@ -0,0 +1,171 @@
	"use strict";
	sap.ui.define([
	    'sap/ui/core/mvc/Controller',
	    'sap/ui/core/ValueState',
	    'sap/ui/model/json/JSONModel',
	    'sap/ushell/services/designer/infra/utils/Validations',
	    'sap/ushell/services/designer/infra/utils/Validator',
	    'contentManager/controller/common/ValidationUtils',
	    'sap/m/Token',
	    'contentManager/model/formatter',
	    'sap/ushell/services/designer/infra/utils/Url',
	], function (Controller, ValueState, JSONModel, Validations, Validator, ValidationUtils, Token, Formatter, Url) {
	
	    return Controller.extend("contentManager.controller.app.InboundParameters", {
	        formatter: Formatter,
	        onInit: function () {
	            this.oCmp = this.getOwnerComponent();
	            this.oValidator = new Validator();
	
	            this.eventBus = this.oCmp.getEventBus();
	            this.eventBus.subscribe("editor.item", "initSelectedItem", this.initSelectedItem.bind(this));
	            this.eventBus.subscribe("editor.item", "onBeforeSave", this.onBeforeSave.bind(this));
	            this.eventBus.subscribe("editor.item", "edit", this.onChangeToEdit.bind(this));
	            this.eventBus.subscribe("editor.item", "cancel", this.onCancelEnded.bind(this));
	            this.oBundle = this.oCmp.getModel("i18n");
	        },
	
	        initSelectedItem: function () {
	            const selectedItem = this.oCmp.getSelectedItem();
	            this.model = new JSONModel({
	                inboundParameters: selectedItem.data.inboundParameters
	            });
	
	            if (this.oCmp.getMode() === "edit") {
	                this.addEmptyUrlTemplateParameterRow();
	            }
	            this.getView().setModel(this.model);
	        },
	
	        onBeforeSave: function () {
	            let selectedItem = this.oCmp.getSelectedItem();
	            let inboundParameters = this.model.getProperty("/inboundParameters");
	
	            selectedItem.data.inboundParameters =
	                inboundParameters.filter(function (item) {
	                    return (item.name !== "" || item.defaultValue !== "" || item.renameTo !== "");
	                });
	            this.setTableParametersModel(selectedItem.data.inboundParameters);
	            this.oCmp.setSelectedItem(selectedItem);
	        },
	
	        onChangeToEdit: function () {
	            this.addEmptyUrlTemplateParameterRow();
	        },
	
	        onCancelEnded: function () {
	            let item = this.oCmp.getSelectedItem();
	            this.model.setProperty("/inboundParameters", item.data.inboundParameters);
	        },
	
	        getTableParametersModel: function () {
	            return this.model.getProperty("/inboundParameters");
	        },
	
	        setTableParametersModel: function (parameters) {
	            this.model.setProperty("/inboundParameters", parameters);
	        },
	
	        onParameterValueTextChanged: function (changeEvent) {
	            let parameters = this.getTableParametersModel();
	            let lastParameter = parameters[parameters.length - 1];
	
	            if (lastParameter.name.length > 0 ||
	                lastParameter.defaultValue.length > 0 ||
	                lastParameter.renameTo.length > 0) {
	                this.addEmptyUrlTemplateParameterRow();
	                this.oValidator.validate({uiElement: changeEvent.getSource()});
	            }
	        },
	
	        onDeleteParameter: function (pressEvent) {
	            let path = pressEvent.getSource().getParent().getBindingContext().sPath;
	            let parameterToRemove = this.model.getProperty(path);
	            let parameters = this.getTableParametersModel();
	            let index = parameters.indexOf(parameterToRemove);
	            if (index === 0 && parameters.length === 1) {
	                parameters[0].name = "";
	                parameters[0].defaultValue = "";
	                parameters[0].renameTo = "";
	                this.setTableParametersModel(parameters);
	                return;
	            }
	
	            parameters.splice(index, 1);
	            this.setTableParametersModel(parameters);
	
	            return index;
	        },
	
	        addEmptyUrlTemplateParameterRow: function () {
	            let parameters = this.getTableParametersModel();
	            parameters.push({"name": "", "defaultValue": "", "renameTo": "", required: false});
	            this.setTableParametersModel(parameters);
	        },
	
	        getValidationControl: function () {
	            let oBundle = this.oBundle;
	            return {
	                uiElement: this.getView().byId("inboundParametersEditTable"),
	                config: {
	                    validation: function (sValue) {
	                        return !Validations.isEmptyString(sValue);
	                    },
	
	                    validate: function (tableControl, validation) {
	                        let validationObjects = [];
	                        let items = tableControl && tableControl.mAggregations && tableControl.mAggregations.items;
	                        items.forEach(function (item) {
	                            let nameControl = item.getCells && item.getCells()[0];
	                            let renameToControl = item.getCells && item.getCells()[1];
	                            let defaultValueControl = item.getCells && item.getCells()[2];
	                            if (nameControl) {
	                                let sValue = nameControl.getValue();
	                                if (sValue !== "" || renameToControl.getValue() !== "" || defaultValueControl.getValue() !== "") { //last empty string
	                                    let state = validation(sValue) ? ValueState.None : ValueState.Error;
	                                    nameControl.setValueState(state);
	                                    if (state === ValueState.Error) {
	                                        nameControl.setValueStateText(oBundle.getProperty("INTENT_PARAMETERS_NAME_STATE_TEXT"));
	                                        validationObjects.push({
	                                            valid: false,
	                                            uiElement: nameControl
	                                        });
	                                    }
	                                }
	                            }
	                        });
	
	                        if (validationObjects.length !== 0) {
	                            return validationObjects;
	                        } else {
	                            return {
	                                valid: true,
	                                uiElement: undefined
	                            };
	                        }
	                    },
	
	                    reset: function (tableControl) {
	                        tableControl && tableControl.mAggregations && tableControl.mAggregations.items &&
	                        tableControl.mAggregations.items.forEach(function (item) {
	                            let parameterNameInputControl = item.getCells && item.getCells()[0];
	                            if (parameterNameInputControl) {
	                                parameterNameInputControl.setValueState(ValueState.None);
	                            }
	                        });
	                    }
	                }
	            };
	        },
	
	        hasInvalidControl: function () {
	            let aValidationItems = this.oValidator.validate(this.getValidationControl())[0];
	            let aValidationItemsArray = Array.isArray(aValidationItems) ? aValidationItems : [aValidationItems];
	            let filtered = aValidationItemsArray.filter(function (validationItem) {
	                return !validationItem.valid;
	            })[0];
	
	            return filtered && filtered.uiElement;
	        }
	    });
	}); 
Copy path View file      
90  static-resources/contentManager/webapp/css/style.css
 @@ -17,7 +17,7 @@
	
	.filterSelect {
	    font-size: 0.95rem;
	    height: 1.625rem; 
	    height: 1.625rem;
	}
	
	.APPHeader {
 @@ -49,7 +49,7 @@
	}
	
	.tblIcon {
	    padding: 5px 2px 0px 1px;
	    padding: 5px 2px 0 1px;
	}
	
	.rootContainer .toolBar .itemsTitle{
 @@ -77,74 +77,74 @@
	
	
	.ContentEntityView .ContentEntityToolbar .NoLeftMargin {
	    margin-left: 0rem;
	    margin-left: 0;
	}
	
	.ContentEntityView .ContentEntityToolbar .NoRightMargin {
	    margin-right: 0rem;
	    margin-right: 0;
	}
	
	/*===========================*/
	/*App Editor View            */
	/*===========================*/
	.AppPropertiesContent .AppPropertiesVBoxGeneral .AppPropertiesContentGeneral div,
	.AppPropertiesContent .KeywordsTokenizer {
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	.AppPropertiesContent .AppPropertiesVBoxGeneral .AppPropertiesContentGeneralToolbar div {
	    margin-left: 0rem;
	    margin-left: 0;
	}
	
	AppPropertiesContent .AppPropertiesURLParametersTableForm .TableCell{
	.AppPropertiesContent .AppPropertiesURLParametersTableForm .TableCell {
	    background: transparent;
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	/*===========================*/
	/*Catalog Editor View            */
	/*===========================*/
	.CatalogPropertiesContent .CatalogPropertiesVBoxGeneral .CatalogPropertiesContentGeneral div,
	.CatalogPropertiesContent {
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	.CatalogPropertiesContent .CatalogPropertiesVBoxGeneral .CatalogPropertiesContentGeneralToolbar div {
	    margin-left: 0rem;
	    margin-left: 0;
	}
	
	.CatalogPropertiesContent .CatalogPropertiesURLParametersTableForm .TableCell {
	    background: transparent;
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	/*===========================*/
	/*Group Editor View            */
	/*===========================*/
	.GroupPropertiesContent .GroupPropertiesVBoxGeneral .GroupPropertiesContentGeneral div,
	.GroupPropertiesContent {
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	.GroupPropertiesContent .GroupPropertiesVBoxGeneral .GroupPropertiesContentGeneralToolbar div {
	    margin-left: 0rem;
	    margin-left: 0;
	}
	
	.GroupPropertiesContent .GroupPropertiesURLParametersTableForm .TableCell {
	    background: transparent;
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	/*===========================*/
	/*Role Editor View            */
	/*===========================*/
	.RolePropertiesContent .RolePropertiesVBoxGeneral .RolePropertiesContentGeneral div,
	.RolePropertiesContent {
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	.RolePropertiesContent .RolePropertiesVBoxGeneral .RolePropertiesContentGeneralToolbar div {
	    margin-left: 0rem;
	    margin-left: 0;
	}
	
	/* create entity popover */
 @@ -167,27 +167,71 @@ AppPropertiesContent .AppPropertiesURLParametersTableForm .TableCell{
	/*===========================*/
	
	.AppVisualizationContent .AppVisualizationVBoxGeneralTileType .AppVisualizationContentGeneral div {
	    padding-left: 0rem;
	    padding-bottom: 0rem;
	    padding-left: 0;
	    padding-bottom: 0;
	}
	.AppVisualizationContent .AppVisualizationVBoxGeneral .AppVisualizationContentGeneral div {
	    padding-left: 0rem;
	    padding-left: 0;
	}
	
	.AppVisualizationContent .AppVisualizationVBoxGeneralTileType .AppVisualizationContentGeneralToolbar div {
	    margin-left: 0rem;
	} 
	    margin-left: 0;
	}
	
	.AppVisualizationContent .previewIconColor span {
	    color: #346187;
	}
	
	.AppVisualizationContent .visualizationPreviewVBox {
	    padding-left: 18px;
	    padding-left: 1.12rem;
	}
	
	.AppVisualizationContent .visualizationPreviewVBox .visualizationPreviewInnerVBox .visualizationPreviewToolbar {
	padding-left: 4px;
	    padding-left: 0.25rem;
	}
	
	.AppNavigationContent .panel-content .parametersInbounds {
	    padding-left: 1px;
	}
	
	.AppNavigationContent .panel-content .parametersInbounds th,
	.AppNavigationContent .panel-content .parametersInbounds td {
	    border: 0.06rem solid rgb(204, 204, 204);
	}
	
	.AppNavigationContent .panel-content .AppNavigationVBoxGeneral {
	    width: 100%;
	}
	
	.AppNavigationContent .panel-content .AppNavigationVBoxGeneral .parametersInbounds tr td {
	    padding-left: 0.5rem;
	    padding-right: 0.5rem;
	}
	
	.AppNavigationContent .panel-content .AppNavigationVBoxGeneral .parametersInbounds tr th {
	    padding-left: 0;
	}
	
	.AppNavigationContent .panel-content .panel-content-title {
	    margin-right: 0;
	}
	
	.AppNavigationContent .panel-content {
	    margin-left: -0.9rem;
	}
	
	.AppNavigationContent .transfer-box{
	    margin-left: -0.5rem;
	    margin-top: 40px;
	}
	
	.AppVisualizationContent .AppVisualizationVBoxGeneralTileType .AppVisualizationContentGeneral div {
	    padding-left: 0;
	    padding-bottom: 0;
	}
	
	.AppNavigationContent .remove-row-btn {
	    padding-left: inherit;
	}
	
	.AppNavigationContentInbounds {
Copy path View file      
18  static-resources/contentManager/webapp/model/mock/businessapp/my_dummy_app.json
 @@ -13,7 +13,12 @@
	        "sap.app": {
	          "crossNavigation": {
	            "inbounds": {
	              "GenericURL-Launch": {}
	              "GenericURL-Launch": {
	                "signature": {
	                  "parameters": {},
	                  "additionalParameters": "allowed"
	                }
	              }
	            }
	          },
	          "tags": {
 @@ -54,8 +59,7 @@
	              "target": {
	                "type": "IBN",
	                "inboundId": "RandomURL-Launcher",
	                "parameters": {
	                }
	                "parameters": {}
	              },
	              "indicatorDataSource": {
	                "path": "www.sap.com",
 @@ -68,19 +72,19 @@
	      "defaultViz": "RandomURL-Launcher"
	    },
	    "texts": {
	      "cdm|identification|title" : {
	      "cdm|identification|title": {
	        "type": "XTIT",
	        "value": {
	          "": "My Dummy App"
	        }
	      },
	      "cdm|identification|description" : {
	      "cdm|identification|description": {
	        "type": "XTIT",
	        "value": {
	          "": "Dummy Desc"
	        }
	      },
	      "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle" : {
	      "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
	        "type": "XTIT",
	        "value": {
	          "": "Viz subtitle"
 @@ -94,4 +98,4 @@
	    "createdBy": "Amir Yahalom",
	    "updatedBy": "Amir Yahalom"
	  }
	} 
	}
Copy path View file      
34  static-resources/contentManager/webapp/model/mock/businessapp/my_dummy_app2.json
 @@ -13,11 +13,25 @@
	        "sap.app": {
	          "crossNavigation": {
	            "inbounds": {
	              "GenericURL-Launch2": {}
	              "GenericURL-Launch": {
	                "signature": {
	                  "parameters": {
	                    "paramFirstRow": {
	                      "required": true,
	                      "renameTo": "intentForParamFirstRow",
	                      "default": {
	                        "value": "aValueForParamFirstRow",
	                        "format": "plain"
	                      }
	                    }
	                  },
	                  "additionalParameters": "allowed"
	                }
	              }
	            }
	          },
	          "tags" : {
	            "keywords" : []
	          "tags": {
	            "keywords": []
	          }
	        },
	        "sap.integration": {
 @@ -52,6 +66,12 @@
	                "type": "IBN",
	                "inboundId": "RandomURL-Launcher",
	                "parameters": {
	                  "paramFirstRow": {
	                    "value": {
	                      "value": "BB",
	                      "format": "plain"
	                    }
	                  }
	                }
	              }
	            }
 @@ -61,19 +81,19 @@
	      "defaultViz": "RandomURL-Launcher"
	    },
	    "texts": {
	      "cdm|identification|title" : {
	      "cdm|identification|title": {
	        "type": "XTIT",
	        "value": {
	          "": "My Second Dummy App"
	        }
	      },
	      "cdm|identification|description" : {
	      "cdm|identification|description": {
	        "type": "XTIT",
	        "value": {
	          "": "Dummy Desc2"
	        }
	      },
	      "cdm|payload|visualizations|RandomURL-Launcher|vizParams|title" : {
	      "cdm|payload|visualizations|RandomURL-Launcher|vizParams|title": {
	        "type": "XTIT",
	        "value": {
	          "": "Hello URL"
 @@ -87,4 +107,4 @@
	    "createdBy": "Amir Yahalom",
	    "updatedBy": "Someone else"
	  }
	} 
	}
Copy path View file      
73  static-resources/contentManager/webapp/model/mock/businessapp/my_dummy_app3.json
 @@ -13,11 +13,32 @@
	        "sap.app": {
	          "crossNavigation": {
	            "inbounds": {
	              "GenericURL-Launch3": {}
	              "GenericURL-Launch": {},
	              "signature": {
	                "parameters": {
	                  "paramFirstRow": {
	                    "required": true,
	                    "renameTo": "intentForParamFirstRow",
	                    "default": {
	                      "value": "aValueForParamFirstRow",
	                      "format": "plain"
	                    }
	                  },
	                  "paramSecondRow": {
	                    "required": false,
	                    "renameTo": "intentForParamSecondRow",
	                    "default": {
	                      "value": "aValueForParamSecondRow",
	                      "format": "plain"
	                    }
	                  }
	                },
	                "additionalParameters": "allowed"
	              }
	            }
	          },
	          "tags" : {
	            "keywords" : []
	          "tags": {
	            "keywords": []
	          }
	        },
	        "sap.integration": {
 @@ -28,16 +49,54 @@
	          }
	        }
	      },
	      "visualizations": {}
	      "visualizations": {
	        "RandomURL-Launcher": {
	          "target": {
	            "inboundId": "RandomURL-Launcher"
	          },
	          "vizType": "sap.ushell.StaticAppLauncher",
	          "vizConfig": {
	            "sap.ui": {
	              "icons": {
	                "icon": ""
	              }
	            },
	            "sap.app": {
	              "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	              "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	            },
	            "sap.flp": {
	              "target": {
	                "type": "IBN",
	                "inboundId": "RandomURL-Launcher",
	                "parameters": {
	                  "paramFirstRow": {
	                    "value": {
	                      "value": "B1",
	                      "format": "plain"
	                    }
	                  },
	                  "paramSecondRow": {
	                    "value": {
	                      "value": "B2",
	                      "format": "plain"
	                    }
	                  }
	                }
	              }
	            }
	          }
	        }
	      }
	    },
	    "texts": {
	      "cdm|identification|title" : {
	      "cdm|identification|title": {
	        "type": "XTIT",
	        "value": {
	          "": "My Third Dummy App"
	        }
	      },
	      "cdm|identification|description" : {
	      "cdm|identification|description": {
	        "type": "XTIT",
	        "value": {
	          "": "Dummy Desc3"
 @@ -51,4 +110,4 @@
	    "createdBy": "Amir Yahalom",
	    "updatedBy": "Someone else"
	  }
	} 
	}
Copy path View file      
88  static-resources/contentManager/webapp/model/mock/businessapp/my_dummy_app4.json
 @@ -13,11 +13,41 @@
	        "sap.app": {
	          "crossNavigation": {
	            "inbounds": {
	              "GenericURL-Launch4": {}
	              "GenericURL-Launch": {
	                "signature": {
	                  "parameters": {
	                    "paramFirstRow": {
	                      "required": true,
	                      "renameTo": "intentForParamFirstRow",
	                      "default": {
	                        "value": "aValueForParamFirstRow",
	                        "format": "plain"
	                      }
	                    },
	                    "paramSecondRow": {
	                      "required": false,
	                      "renameTo": "intentForParamSecondRow",
	                      "default": {
	                        "value": "aValueForParamSecondRow",
	                        "format": "plain"
	                      }
	                    },
	                    "paramThirdRow": {
	                      "required": false,
	                      "renameTo": "intentForParamThirdRow",
	                      "default": {
	                        "value": "aValueForParamThirdRow",
	                        "format": "plain"
	                      }
	                    }
	                  },
	                  "additionalParameters": "allowed"
	                }
	              }
	            }
	          },
	          "tags" : {
	            "keywords" : []
	          "tags": {
	            "keywords": []
	          }
	        },
	        "sap.integration": {
 @@ -28,16 +58,60 @@
	          }
	        }
	      },
	      "visualizations": {}
	      "visualizations": {
	        "RandomURL-Launcher": {
	          "target": {
	            "inboundId": "RandomURL-Launcher"
	          },
	          "vizType": "sap.ushell.StaticAppLauncher",
	          "vizConfig": {
	            "sap.ui": {
	              "icons": {
	                "icon": ""
	              }
	            },
	            "sap.app": {
	              "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	              "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	            },
	            "sap.flp": {
	              "target": {
	                "type": "IBN",
	                "inboundId": "RandomURL-Launcher",
	                "parameters": {
	                  "paramFirstRow": {
	                    "value": {
	                      "value": "B1",
	                      "format": "plain"
	                    }
	                  },
	                  "paramSecondRow": {
	                    "value": {
	                      "value": "B2",
	                      "format": "plain"
	                    }
	                  },
	                  "paramThirdRow": {
	                    "value": {
	                      "value": "B3",
	                      "format": "plain"
	                    }
	                  }
	                }
	              }
	            }
	          }
	        }
	      }
	    },
	    "texts": {
	      "cdm|identification|title" : {
	      "cdm|identification|title": {
	        "type": "XTIT",
	        "value": {
	          "": "My Fourth Dummy App"
	        }
	      },
	      "cdm|identification|description" : {
	      "cdm|identification|description": {
	        "type": "XTIT",
	        "value": {
	          "": "Dummy Desc4"
 @@ -51,4 +125,4 @@
	    "createdBy": "Someone else",
	    "updatedBy": "Amir Yahalom"
	  }
	} 
	}
Copy path View file      
102  static-resources/contentManager/webapp/model/mock/businessapp/my_dummy_app44.json
 @@ -13,11 +13,49 @@
	        "sap.app": {
	          "crossNavigation": {
	            "inbounds": {
	              "GenericURL-Launch4": {}
	              "GenericURL-Launch": {
	                "signature": {
	                  "parameters": {
	                    "paramFirstRow": {
	                      "required": true,
	                      "renameTo": "intentForParamFirstRow",
	                      "default": {
	                        "value": "aValueForParamFirstRow",
	                        "format": "plain"
	                      }
	                    },
	                    "paramSecondRow": {
	                      "required": false,
	                      "renameTo": "intentForParamSecondRow",
	                      "default": {
	                        "value": "aValueForParamSecondRow",
	                        "format": "plain"
	                      }
	                    },
	                    "paramThirdRow": {
	                      "required": false,
	                      "renameTo": "intentForParamThirdRow",
	                      "default": {
	                        "value": "aValueForParamThirdRow",
	                        "format": "plain"
	                      }
	                    },
	                    "paramFourthRow": {
	                      "required": true,
	                      "renameTo": "intentForParamFourthRow",
	                      "default": {
	                        "value": "aValueForParamFourthRow",
	                        "format": "plain"
	                      }
	                    }
	                  },
	                  "additionalParameters": "allowed"
	                }
	              }
	            }
	          },
	          "tags" : {
	            "keywords" : []
	          "tags": {
	            "keywords": []
	          }
	        },
	        "sap.integration": {
 @@ -28,16 +66,66 @@
	          }
	        }
	      },
	      "visualizations": {}
	      "visualizations": {
	        "RandomURL-Launcher": {
	          "target": {
	            "inboundId": "RandomURL-Launcher"
	          },
	          "vizType": "sap.ushell.StaticAppLauncher",
	          "vizConfig": {
	            "sap.ui": {
	              "icons": {
	                "icon": ""
	              }
	            },
	            "sap.app": {
	              "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	              "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	            },
	            "sap.flp": {
	              "target": {
	                "type": "IBN",
	                "inboundId": "RandomURL-Launcher",
	                "parameters": {
	                  "paramFirstRow": {
	                    "value": {
	                      "value": "B1",
	                      "format": "plain"
	                    }
	                  },
	                  "paramSecondRow": {
	                    "value": {
	                      "value": "B2",
	                      "format": "plain"
	                    }
	                  },
	                  "paramThirdRow": {
	                    "value": {
	                      "value": "B3",
	                      "format": "plain"
	                    }
	                  },
	                  "paramFourthRow": {
	                    "value": {
	                      "value": "B4",
	                      "format": "plain"
	                    }
	                  }
	                }
	              }
	            }
	          }
	        }
	      }
	    },
	    "texts": {
	      "cdm|identification|title" : {
	      "cdm|identification|title": {
	        "type": "XTIT",
	        "value": {
	          "": "My Fourth Dummy App"
	        }
	      },
	      "cdm|identification|description" : {
	      "cdm|identification|description": {
	        "type": "XTIT",
	        "value": {
	          "": "Dummy Desc44"
 @@ -51,4 +139,4 @@
	    "createdBy": "Someone else",
	    "updatedBy": "Amir Yahalom"
	  }
	} 
	}
Copy path View file      
26  static-resources/contentManager/webapp/resources/apps/i18n.properties
 @@ -22,6 +22,8 @@ ACTION=Action
	#XMSG
	SEMANTIC_OBJECT_VALUE_STATE_TEXT=Enter max 30 characters
	#XMSG
	INTENT_PARAMETERS_NAME_STATE_TEXT=Name can contain alphanumeric characters and ., -, /, _
	#XMSG
	INTENT_CHARACTERS_VALUE_STATE=Enter alphanumeric characters or '*'
	XMSG
	ACTION_VALUE_STATE_TEXT=Enter max 60 characters
 @@ -73,6 +75,28 @@ ENTER_VALID_TITLE=Enter a title
	ENTER_VALID_PARAMETER_NAME=Enter a name
	#XFLD
	VISUALIZATION_TILE_TYPE=Visualization Type
	#XTIT
	NAVIGATION_TITLE=NAVIGATION
	#XTIT
	NAVIGATION_INBOUNDS_PARAMETERS_TITLE=Parameters
	#XMSG
	NAVIGATION_INBOUNDS_PARAMETERS_TITLE_INFO=Parameters that are passed to the app when accessing it in runtime. For more information, see Portal Cloud Foundry documentation -> Configure an App.
	#XTIT
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_NAME=Name
	#XMSG
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_VALUE=Default Value
	#XTOL
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_VALUE_TOOLTIP=A default value for the parameter
	#XTIT
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_RENAME=Rename To
	#XTOL
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_RENAME_TOOLTIP=Rename To Placeholder
	#XMSG
	NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_REQUIRED=Required
	#XCKL
	NAVIGATION_INBOUNDS_PARAMETERS_TRANSFER_CHECKBOX=Allow additional parameters
	#XTOL
	NAVIGATION_INBOUNDS_PARAMETERS_TRANSFER_CHECKBOX_TOOLTIP=Specify whether to allow passing additional parameters to the app. These parameters, defined in the Visualization tab, can provide specific values for the intent parameters, or be additional parameters that are not defined in the intent
	#XFLD
	VISUALIZATION_SIZE=Size
	#XMSG
 @@ -111,5 +135,7 @@ REFRESH_INTERVAL_UNIT=sec
	PROPERTIES=PROPERTIES
	#XTIT
	VISUALIZATION=VISUALIZATION
	#XTIT
	NAVIGATION=NAVIGATION
	#XTOL
	TOOLTIP=App
Copy path View file      
25  static-resources/contentManager/webapp/test/automation/pages/businessAppPage.js
 @@ -34,6 +34,20 @@ const appParametersNameTextArray = element.all(by.className('UIVeri5ParameterNam
	const appParametersValueInputArray = element.all(by.css('.UIVeri5ParameterValueInput input'));
	const appParametersValueTextArray = element.all(by.className('UIVeri5ParameterValueText'));
	
	const appIntentParametersNameTextArray = element.all(by.css('.UIVeri5IntentParameterNameText'));
	const appIntentParametersNameInputArray = element.all(by.css('.UIVeri5IntentParameterNameInput input'));
	
	const appIntentParametersDefaultValueTextArray = element.all(by.css('.UIVeri5IntentParameterDefaultValueText'));
	const appIntentParametersDefaultValueInputArray = element.all(by.css('.UIVeri5IntentParameterDefaultValueInput input'));
	
	const appIntentParametersRenameToTextArray = element.all(by.css('.UIVeri5IntentParameterRenameToText'));
	const appIntentParametersRenameToInputArray = element.all(by.css('.UIVeri5IntentParameterRenameToInput input'));
	
	const appIntentParametersRequiredToggle = element.all(by.css('.UIVeri5IntentParameterRequiredToggle'));
	const appIntentParametersRequiredCheckbox = element.all(by.css('.UIVeri5IntentParameterRequiredCheckbox'));
	
	const appIntentParameterDeleteButton = element.all(by.css('.UIVeri5IntentParameterDeleteButton'));
	
	const appNavigationViewName = "contentManager.view.app.AppNavigationContent";
	
	const appNavSemanticObjectText = element(by.control({ id: "appSemanticObjectText", viewName: appNavigationViewName}));
 @@ -243,6 +257,17 @@ module.exports = {
	            app.refreshInterval && this.verifyVizTypeRefreshIntervalInputEqualsTo(app.refreshInterval);
	        },
	
	        /*
	        Intent Parameters Table verifiers
	         */
	        verifyAppIntenetParameterNameextExists: (value) => {
	            const filteredIntentParametersNameTextArray = appIntentParametersNameTextArray.filter((elem) => {
	                return elem.getText().then(text => text === value);
	            });
	
	            filteredIntentParametersNameTextArray.count().then(count => expect(count > 0).toBe(true, `app intent parameter name text exists - ${value}`));
	        },
	
	        verifyAppTitleInputPresented: () => {
	            expect(appTitleInput.isPresent()).toBe(true, 'app title input presented');
	        },
Copy path View file      
1  static-resources/contentManager/webapp/test/unit/allTests.js
 @@ -4,6 +4,7 @@ sap.ui.define([
	    "./controller/app/AppNavigationInbounds.controller.qunit",
	    "./controller/app/AppPropertiesContent.controller.qunit",
	    "./controller/app/AppPropertiesURLParameters.controller.qunit",
	    "./controller/app/InboundParameters.controller.qunit",
	    "./controller/app/AppVisualizationContent.controller.qunit",
	    "./controller/catalog/CatalogPropertiesContent.controller.qunit",
	    "./controller/group/GroupPropertiesContent.controller.qunit",
Copy path View file      
16 .../contentManager/webapp/test/unit/contentComponentConfig/app/AppEntityInitializer.qunit.js
 @@ -3,9 +3,7 @@ sap.ui.define(
	    function (AppEntityInitializer) {
	        "use strict";
	
	        QUnit.module("contentManager/contentComponentConfig/app/AppEntityInitializer tests",{
	
	        });
	        QUnit.module("contentManager/contentComponentConfig/app/AppEntityInitializer tests");
	
	        QUnit.test("should return app default entity", function (assert) {
	            QUnit.dump.maxDepth = 10;
 @@ -25,7 +23,14 @@ sap.ui.define(
	                            "_version": "1.13.0",
	                            "sap.app": {
	                                "crossNavigation": {
	                                    "inbounds": {}
	                                    "inbounds": {
	                                        "GenericURL-Launch": {
	                                            "signature": {
	                                                "additionalParameters": "allowed",
	                                                "parameters": {}
	                                            }
	                                        }
	                                    },
	                                },
	                                "tags": {
	                                    "keywords": []
 @@ -57,8 +62,7 @@ sap.ui.define(
	                                        "target": {
	                                            "type": "IBN",
	                                            "inboundId": "",
	                                            "parameters": {
	                                            }
	                                            "parameters": {}
	                                        }
	                                    }
	                                }
Copy path View file      
681 ...rces/contentManager/webapp/test/unit/controller/app/InboundParameters.controller.qunit.js

Load diff
Large diffs are not rendered by default.
Copy path View file      
15  static-resources/contentManager/webapp/view/app/AppNavigationContent.view.xml
@@ -1,15 +1,14 @@
	<mvc:View controllerName="contentManager.controller.app.AppNavigationContent"
	          height="100%"
	          width="100%"
	          xmlns="sap.m"
	          xmlns:mvc="sap.ui.core.mvc"
	          xmlns:layout="sap.ui.layout"
	          xmlns:mvc="sap.ui.core.mvc"
	          class="sapUiSizeCompact AppNavigationContent">
	    <layout:Grid>
	    <VBox width="100%" class="AppNavigationBoxContainer">
	        <layoutData>
	            <layout:GridData span="L10 M10 S10"/>
	        </layoutData>
	        <mvc:XMLView id="appNavigationInbounds" viewName="contentManager.view.app.AppNavigationInbounds"/>
	    </VBox>
	    <layout:Grid defaultSpan="XL5 L4 M4 S4">
	        <VBox class="AppNavigationBoxContainer">
	            <mvc:XMLView id="appNavigationInbounds" viewName="contentManager.view.app.AppNavigationInbounds"/>
	            <mvc:XMLView id="inboundParameters" viewName="contentManager.view.app.InboundParameters"/>
	        </VBox>
	    </layout:Grid>
	</mvc:View> 
Copy path View file      
20  static-resources/contentManager/webapp/view/app/AppNavigationInboundParamsPanel.fragment.xml

Load diff
This file was deleted.
Copy path View file      
8  static-resources/contentManager/webapp/view/app/AppNavigationInbounds.view.xml
@@ -1,6 +1,6 @@
	<mvc:View controllerName="contentManager.controller.app.AppNavigationInbounds"
	          height="100%"
	          width="75%"
	          width="100%"
	          xmlns="sap.m"
	          xmlns:mvc="sap.ui.core.mvc"
	          xmlns:form="sap.ui.layout.form"
 @@ -22,14 +22,13 @@
	            <HBox justifyContent="SpaceBetween" class="sapUiTinyMarginTop" width="46%">
	                <VBox width="100%" class="sapUiMediumMarginEnd">
	                    <Label text="{i18n>SEMANTIC_OBJECT}"
	                           required="{= ${detail>/mode} === 'edit'}"></Label>
	                           required="{= ${detail>/mode} === 'edit'}"/>
	                    <Input value="{path: 'detail>/selected/data/inbounds',formatter:'.getSemanticObjectFromInbounds'}"
	                           id="appSemanticObjectInput"
	                           change="onSemanticObjectInputChange"
	                           required="true"
	                           visible="{= ${detail>/mode} === 'edit'}"
	                           class="AppInboundsSemanticObjectInput"/>
	
	                    <Text text="{path: 'detail>/selected/data/inbounds',formatter:'.getSemanticObjectFromInbounds'}"
	                          id="appSemanticObjectText"
	                          visible="{= ${detail>/mode} === 'display'}"
 @@ -38,14 +37,13 @@
	                          class="AppInboundsSemanticObjectText"/>
	                </VBox>
	                <VBox width="100%">
	                    <Label text="{i18n>ACTION}" required="{= ${detail>/mode} === 'edit'}"></Label>
	                    <Label text="{i18n>ACTION}" required="{= ${detail>/mode} === 'edit'}"/>
	                    <Input value="{path: 'detail>/selected/data/inbounds',formatter:'.getActionFromInbounds'}"
	                           id="appActionInput"
	                           change="onActionInputChange"
	                           required="true"
	                           visible="{= ${detail>/mode} === 'edit'}"
	                           class="AppInboundsActionInput"/>
	
	                    <Text text="{path: 'detail>/selected/data/inbounds',formatter:'.getActionFromInbounds'}"
	                          id="appActionText"
	                          visible="{= ${detail>/mode} === 'display'}"
Copy path View file      
79  static-resources/contentManager/webapp/view/app/AppVisualizationContent.view.xml
 @@ -3,17 +3,13 @@
	          xmlns="sap.m"
	          xmlns:core="sap.ui.core"
	          xmlns:layout="sap.ui.layout"
	          xmlns:html="http://www.w3.org/1999/xhtml"
	          xmlns:mvc="sap.ui.core.mvc"
	          xmlns:infctrl="sap.ushell.services.designer.infra.controls"
	          xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
	          class="sapUiSizeCompact AppVisualizationContent">
	
	         <layout:Grid>
	        <VBox width="90%" class="AppVisualizationVBoxGeneralTileType" >
	                <layoutData>
	                    <layout:GridData span="XL4 L4 M8 S12"/>
	                </layoutData>
	
	    <layout:Grid defaultSpan="XL4 L4 M8 S12">
	        <html:div class="AppVisualizationVBoxGeneralTileType">
	            <infctrl:Form
	                    id="app-editor-visualization-form-general-type"
	                    class="AppVisualizationContentGeneral"
 @@ -23,53 +19,61 @@
	                    mode="{detail>/mode}">
	                <infctrl:content>
	                    <infctrl:FormElement label="{i18n>VISUALIZATION_TILE_TYPE}">
	                        <Text customData:type="display" text="{path: 'detail>/selected/data/vizType', formatter: '.formatter.formatVizType'}"
	                        <Text customData:type="display"
	                              text="{path: 'detail>/selected/data/vizType', formatter: '.formatter.formatVizType'}"
	                              id="appVisualizationTextId"/>
	                        <Select customData:type="edit" selectedKey="{path: 'detail>/selected/data/vizType',
	                                                                     mode: 'OneWay'}"
	                                id="appVisualizationTypeSelectId"
	                                change="onVizTypeChange">
	                            <core:Item key="sap.ushell.StaticAppLauncher" text="{i18n>VISUALIZATION_STATIC_APP_LAUNCHER}"/>
	                            <core:Item key="sap.ushell.DynamicAppLauncher" text="{i18n>VISUALIZATION_DYNAMIC_APP_LAUNCHER}"/>
	                            <core:Item key="sap.ushell.StaticAppLauncher"
	                                       text="{i18n>VISUALIZATION_STATIC_APP_LAUNCHER}"/>
	                            <core:Item key="sap.ushell.DynamicAppLauncher"
	                                       text="{i18n>VISUALIZATION_DYNAMIC_APP_LAUNCHER}"/>
	                            <core:Item key="sap.ushell.None" text="{i18n>VISUALIZATION_NO_TILE}"/>
	                        </Select>
	                     </infctrl:FormElement>
	                    </infctrl:FormElement>
	                </infctrl:content>
	            </infctrl:Form>
	             <VBox id="visualizationGeneralVBox" class="AppVisualizationVBoxGeneral" visible="{=${detail>/selected/data/vizType} !== 'sap.ushell.None'}">
	                 <infctrl:Form
	                         id="app-editor-visualization-form-general"
	                         class="AppVisualizationContentGeneral"
	                         toolbarClass="AppVisualizationContentGeneralToolbar"
	                         editable="{= ${detail>/mode} === 'edit'}"
	                         mode="{detail>/mode}">
	                     <infctrl:content>
	            <VBox id="visualizationGeneralVBox" class="AppVisualizationVBoxGeneral"
	                  visible="{=${detail>/selected/data/vizType} !== 'sap.ushell.None'}">
	                <infctrl:Form
	                        id="app-editor-visualization-form-general"
	                        class="AppVisualizationContentGeneral"
	                        toolbarClass="AppVisualizationContentGeneralToolbar"
	                        editable="{= ${detail>/mode} === 'edit'}"
	                        mode="{detail>/mode}">
	                    <infctrl:content>
	                        <infctrl:FormElement label="{i18n>VISUALIZATION_SIZE}">
	                            <Text customData:type="display" text="{i18n>VISUALIZATION_SIZE_1x1}"
	                                  class="UIVeri5VisualizationSizeText"/>
	                            <Select customData:type="edit" selectedItem="1x1"
	                                   id="visualizationSizeId"
	                                   enabled="false"
	                                    id="visualizationSizeId"
	                                    enabled="false"
	                                    class="UIVeri5VisualizationSizeSelect">
	                                <core:Item key="1x1" text="{i18n>VISUALIZATION_SIZE_1x1}"/>
	                            </Select>
	                        </infctrl:FormElement>
	                        <infctrl:FormElement label="{i18n>VISUALIZATION_TILE_TITLE}" info="{i18n>VISUALIZATION_TILE_TITLE_INFO}">
	                            <Text customData:type="display" text="{detail>/selected/data/title}" class="UIVeri5VisualizationTitleText"/>
	                        <infctrl:FormElement label="{i18n>VISUALIZATION_TILE_TITLE}"
	                                             info="{i18n>VISUALIZATION_TILE_TITLE_INFO}">
	                            <Text customData:type="display" text="{detail>/selected/data/title}"
	                                  class="UIVeri5VisualizationTitleText"/>
	                            <Input customData:type="edit" value="{detail>/selected/data/title}"
	                                   id="visualizationTitleId"
	                                   change="onInputChange"
	                                   enabled="false"/>
	                        </infctrl:FormElement>
	                        <infctrl:FormElement label="{i18n>VISUALIZATION_SUBTITLE}">
	                            <Text customData:type="display" text="{path:'detail>/selected/data/subTitle', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                            <Text customData:type="display"
	                                  text="{path:'detail>/selected/data/subTitle', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                                  id="appVisualizationSubtitleTextId"/>
	                            <Input customData:type="edit" value="{detail>/selected/data/subTitle}"
	                                   id="appVisualizationSubtitleInputId"
	                                   change="onInputChange"/>
	                        </infctrl:FormElement>
	                        <infctrl:FormElement label="{i18n>VISUALIZATION_INFORMATION}">
	                            <Text customData:type="display" text="{path:'detail>/selected/data/information', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                            <Text customData:type="display"
	                                  text="{path:'detail>/selected/data/information', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                                  id="appVisualizationInformationTextId"/>
	                            <Input customData:type="edit" value="{detail>/selected/data/information}"
	                                   id="appVisualizationInformationInputId"
 @@ -86,17 +90,16 @@
	                                   valueHelpOnly="true"
	                                   valueHelpRequest="onSelectIcon"/>
	                        </infctrl:FormElement>
	                        <infctrl:FormElement>
	                            <infctrl:ParametersTable mode="{detail>/mode}"
	                                                     parameters="{detail>/selected/data/visualizationParameters}"
	                                                     visible="{detail>/selected/data/additionalParameters}"/>
	                        </infctrl:FormElement>
	                    </infctrl:content>
	                </infctrl:Form>
	             </VBox>
	        </VBox>
	
	            </VBox>
	        </html:div>
	        <HBox>
	
	          <layoutData>
	                    <layout:GridData span="XL8 L8 M8 S12"/>
	          </layoutData>
	
	            <VBox width="50%" visible="{=${detail>/selected/data/vizType} === 'sap.ushell.DynamicAppLauncher'}">
	                <VBox width="90%" id="dyanmicAppLauncherVBoxId" class="dyanmicAppLauncherVBox">
	                    <infctrl:Form
 @@ -105,7 +108,8 @@
	                            mode="{detail>/mode}">
	                        <infctrl:content>
	                            <infctrl:FormElement label="{i18n>VISUALIZATION_SERVICE_URL}">
	                                <Text customData:type="display" text="{path:'detail>/selected/data/serviceUrl', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                                <Text customData:type="display"
	                                      text="{path:'detail>/selected/data/serviceUrl', formatter: '.formatter.replaceEmptyStringWithDash'}"
	                                      id="appVisualizationServiceURLTextId"/>
	                                <Input customData:type="edit" value="{detail>/selected/data/serviceUrl}"
	                                       id="appVisualizationServiceURLInputId"
 @@ -130,7 +134,8 @@
	                    </infctrl:Form>
	                </VBox>
	            </VBox>
	            <VBox width="50%" visible="{=${detail>/selected/data/vizType} !== 'sap.ushell.None'}" class="visualizationPreviewVBox">
	            <VBox width="50%" visible="{=${detail>/selected/data/vizType} !== 'sap.ushell.None'}"
	                  class="visualizationPreviewVBox">
	                <VBox width="90%" id="previewVBoxId" class="visualizationPreviewInnerVBox">
	                    <infctrl:Form
	                            title="{i18n>VISUALIZATION_PREVIEW}"
 @@ -156,7 +161,5 @@
	                </VBox>
	            </VBox>
	        </HBox>
	      </layout:Grid>
	
	
	    </layout:Grid>
	</mvc:View> 
Copy path View file      
104  static-resources/contentManager/webapp/view/app/InboundParameters.view.xml
@@ -0,0 +1,104 @@
	<mvc:View
	        height="100%"
	        width="100%"
	        controllerName="contentManager.controller.app.InboundParameters"
	        xmlns="sap.m"
	        xmlns:html="http://www.w3.org/1999/xhtml"
	        xmlns:core="sap.ui.core"
	        xmlns:mvc="sap.ui.core.mvc"
	        xmlns:infctrl="sap.ushell.services.designer.infra.controls">
	    <Panel expandable="true" expanded="true" class="panel-content" width="auto">
	        <headerToolbar>
	            <Toolbar height="3rem" style="Clear">
	                <Title text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TITLE}" class="panel-content-title"/>
	                <infctrl:InfoIcon class="sapUiMediumMarginBegin sapUiTinyMarginTop"
	                                  title="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TITLE_INFO}"/>
	            </Toolbar>
	        </headerToolbar>
	        <content>
	            <html:div class="AppNavigationVBoxGeneral">
	                <Table visible="{= ${detail>/mode} === 'display'}"
	                       id="inboundParametersDisplayTable"
	                       showNoData="true"
	                       class="parametersInbounds"
	                       items="{path: '/inboundParameters'}"
	                       width="100%"
	                       fixedLayout="false">
	                    <columns>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_NAME}"/>
	                        </Column>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_VALUE}"/>
	                        </Column>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_RENAME}"/>
	                        </Column>
	                        <Column width="4.3rem">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_REQUIRED}"/>
	                        </Column>
	                    </columns>
	                    <items>
	                        <ColumnListItem>
	                            <cells>
	                                <Text text="{name}" class="UIVeri5IntentParameterNameText"/>
	                                <Text text="{defaultValue}" class="UIVeri5IntentParameterDefaultValueText"/>
	                                <Text text="{renameTo}" class="UIVeri5IntentParameterRenameToText"/>
	                                <Switch state="{required}" customTextOn="Yes" customTextOff="No"
	                                        enabled="false" class="UIVeri5IntentParameterRequiredToggle"/>
	                            </cells>
	                        </ColumnListItem>
	                    </items>
	                </Table>
	                <Table visible="{= ${detail>/mode} === 'edit'}"
	                       id="inboundParametersEditTable"
	                       showNoData="true"
	                       class="parametersInbounds"
	                       items="{path: '/inboundParameters'}"
	                       width="100%"
	                       fixedLayout="false">
	                    <columns>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_NAME}"
	                                   required="true"/>
	                        </Column>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_VALUE}"/>
	                        </Column>
	                        <Column width="27%">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_RENAME}"/>
	                        </Column>
	                        <Column width="2.85rem">
	                            <Label text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TABLE_COLUMN_REQUIRED}"/>
	                        </Column>
	                        <Column width="1rem" styleClass="remove-row-btn"/>
	                    </columns>
	                    <items>
	                        <ColumnListItem>
	                            <cells>
	                                <Input type="Text" value="{name}" change="onParameterValueTextChanged"
	                                       class="UIVeri5IntentParameterNameInput"/>
	                                <Input type="Text" value="{defaultValue}"
	                                       class="UIVeri5IntentParameterDefaultValueInput"/>
	                                <Input type="Text" value="{renameTo}"
	                                       class="UIVeri5IntentParameterRenameToInput"/>
	                                <Switch state="{required}" customTextOn="Yes" customTextOff="No"
	                                        class="UIVeri5IntentParameterRequiredCheckbox"/>
	                                <core:Icon src="sap-icon://sys-cancel" press="onDeleteParameter"
	                                           visible="{showDeleteButton}"
	                                           class="UIVeri5IntentParameterDeleteButton"
	                                           tooltip="{i18n>DELETE_PARAMETER_ICON}"/>
	                            </cells>
	                        </ColumnListItem>
	                    </items>
	                </Table>
	            </html:div>
	            <VBox>
	                <CheckBox text="{i18n>NAVIGATION_INBOUNDS_PARAMETERS_TRANSFER_CHECKBOX}"
	                          selected="{detail>/selected/data/additionalParameters}"
	                          class="transfer-box"
	                          enabled="{= ${detail>/mode} === 'edit'}"/>
	            </VBox>
	        </content>
	    </Panel>
	</mvc:View>
Copy path View file      
1 ...ces/infra/src/sap/ushell/services/designer/infra/components/assignmentPanel/css/style.css
 @@ -32,6 +32,7 @@
	    vertical-align: middle;
	    font-family: Regular, sans-serif;
	    padding-top: 0.7rem;
	    height: 2.25rem;
	}
	
	.assignment-panel .searchPanel {
Copy path View file      
197  static-resources/infra/src/sap/ushell/services/designer/infra/controls/ParametersTable.js
@@ -0,0 +1,197 @@
	'use strict';
	
	sap.ui.define(['sap/ui/core/Control'], function(Control) {
	
	    return Control.extend('com.sap.pac.SiteDirectory.parametersTable', {
	        metadata: {
	            properties: {
	                mode: { type: 'string', defaultValue: 'display' },
	                parameters: { type: 'object', defaultValue: [] },
	                name: { type: 'string', defaultValue: 'Name' },
	                value: { type: 'string', defaultValue: 'Value' },
	            }
	        },
	
	        init: function() {
	            this.oDisplayTemplate = new sap.m.ColumnListItem({
	                cells: [
	                    new sap.m.Text({ text: '{name}' ,width: '100%'}).addStyleClass("UIVeri5QueryParamNameText"),
	                    new sap.m.Text({ text: '{value}' }).addStyleClass("UIVeri5QueryParamValueText")
	                ]
	            });
	
	            this.oEditableTemplate = new sap.m.ColumnListItem({
	                cells: [
	                    new sap.m.Input({ value: '{name}', valueLiveUpdate: true }).addStyleClass("UIVeri5QueryParamNameInput"),
	                    new sap.m.Input({ value: '{value}', valueLiveUpdate: true }).addStyleClass("UIVeri5QueryParamValueInput"),
	                    new sap.ui.core.Icon({
	                        src: 'sap-icon://sys-cancel',
	                        press: this._onDeleteRow.bind(this),
	                        visible: {path: 'visible',formatter: function(vis){
	                                var sVis = !(vis === false);
	                                return sVis;
	                            }.bind(this)
	                        }
	                    }).addStyleClass("UIVeri5QueryParamDeleteButton")
	                ]
	            });
	            this.oModel = new sap.ui.model.json.JSONModel({
	                mode: 'display',
	                parameters: []
	            });
	            var oBindingModel = new sap.ui.model.Binding(
	                this.oModel,
	                '/',
	                this.oModel.getContext('/')
	            );
	            oBindingModel.sMode = sap.ui.model.BindingMode.TwoWay;
	            oBindingModel.attachChange(this._onParametersChange.bind(this));
	            this.table = this._getTable();
	        },
	
	        renderer: function(oRM, oControl) {
	            oRM.write('<div class="parameters-table-container"');
	            oRM.writeControlData(oControl);
	            oRM.write('>');
	            oRM.renderControl(oControl.table);
	            oRM.write('</div>');
	        },
	
	        _getTable: function() {
	            if (this.table) {
	                return this.table;
	            }
	
	            this.table = new sap.m.Table({
	                showSeparators: "None",
	                items: {
	                    path: 'tableParams>/parameters',
	                    template: this.oDisplayTemplate
	                },
	                columns: [
	                    new sap.m.Column({
	                        header: [
	                            new sap.m.Label({
	                                text: this.getName(),
	                            })
	                        ],
	                        width: '48%',
	                        styleClass: "parameters-table-cell",
	                    }),
	                    new sap.m.Column({
	                        header: [
	                            new sap.m.Label({
	                                text: this.getValue(),
	                            })
	                        ],
	                        width: '48%',
	                        styleClass: "parameters-table-cell",
	                    }),
	                    new sap.m.Column({
	                        header: [
	                            new sap.m.Label({
	                            })
	                        ]
	                    })
	                ]
	            }).setModel(this.oModel, 'tableParams');
	            this.table.addStyleClass("parameters-table");
	            this.table.setModel(this.oModel);
	            return this.table;
	        },
	
	        _rebindTable: function(oTemplate) {
	            this.table.bindItems({
	                path: '/parameters',
	                template: oTemplate
	            });
	        },
	
	        _onDeleteRow: function(oEvent) {
	            var rowIndex = parseInt(
	                oEvent
	                    .getSource()
	                    .getParent()
	                    .getBindingContextPath()
	                    .split('/')
	                    .pop()
	            );
	            this.oModel.getProperty('/parameters').splice(rowIndex, 1);
	
	            this.oModel.refresh();
	            this.rerender();
	        },
	
	        _onParametersChange: function() {
	            if (!this.oModel.getProperty('/parameters')) {
	                this.oModel.setProperty('/parameters', [{ name: '', value: '' }]);
	                return;
	            }
	
	            var parametersClone = _.cloneDeep(this.oModel.getProperty('/parameters'));
	            var lastRow = parametersClone.slice(-1)[0];
	            if (!lastRow) {
	                this.oModel.getProperty('/parameters').push({ name: '', value: '',visible: false });
	                return;
	            }
	            if (this.getMode() === 'edit') {
	                if (!lastRow.name && !lastRow.value) {
	                    parametersClone.splice(-1, 1);
	                } else {
	                    delete this.oModel.getProperty('/parameters')[this.oModel.getProperty('/parameters').length - 1].visible;
	                    this.oModel.getProperty('/parameters').push({ name: '', value: '' ,visible: false});
	                    this.oModel.refresh();
	                    this.rerender();
	                }
	            }
	
	            this.setProperty('parameters', this._convertArrayToMap(parametersClone), true);
	        },
	
	        setMode: function(sMode) {
	            this.setProperty('mode', sMode);
	            this.oModel.setProperty('/mode', sMode);
	            if (sMode === 'edit') {
	                this._rebindTable(this.oEditableTemplate);
	                this.rerender();
	            } else {
	                this._rebindTable(this.oDisplayTemplate);
	            }
	        },
	
	        setParameters: function(oParameters) {
	            if (!oParameters) {
	                this.oModel.setProperty('/parameters', []);
	                return;
	            }
	
	            var arrParameters = this._convertMapToArray(oParameters);
	            if (!_.isEqual(arrParameters, this.oModel.getProperty('/parameters'))) {
	                this.oModel.setProperty('/parameters', arrParameters);
	            }
	
	            if (!_.isEqual(oParameters, this.getProperty('parameters'))) {
	                this.setProperty('parameters',oParameters);
	            }
	        },
	
	        _convertMapToArray: function(obj) {
	            var arr = [];
	            Object.keys(obj).forEach(function(key) {
	                arr.push({name: key,value: obj[key]});
	            });
	
	            return arr;
	        },
	
	        _convertArrayToMap: function(arr){
	            var object = {};
	            arr.forEach(function(obj){
	                object[obj.name] = obj.value;
	            });
	            return object;
	        },
	
	        exit: function() {}
	    });
	}); 
Copy path View file      
8  ...ic-resources/infra/src/sap/ushell/services/designer/infra/model/json/BusinessAppEntity.js
 @@ -3,8 +3,9 @@
	sap.ui.define([
	    './CdmEntity',
	    './UrlTemplateAppDecorator',
	    './VisualizationDecorator'
	],function(CdmEntity, UrlTemplateAppDecorator, VisualizationDecorator) {
	    './VisualizationDecorator',
	    './InboundParametersDecorator'
	],function(CdmEntity, UrlTemplateAppDecorator, VisualizationDecorator, InboundParametersDecorator) {
	
	    let titlePaths = [
	        "cdm/identification/title",
 @@ -42,6 +43,7 @@ sap.ui.define([
	            UrlTemplateAppDecorator.call(this, json, entityStore);
	        }
	        VisualizationDecorator.call(this);
	        InboundParametersDecorator.call(this);
	    }
	
	    BusinessAppEntity.prototype = Object.create(CdmEntity.prototype);
 @@ -82,4 +84,4 @@ sap.ui.define([
	    };
	    return BusinessAppEntity;
	
	}, /* bExport= */ true); 
	}, /* bExport= */ true);
Copy path View file      
2  static-resources/infra/src/sap/ushell/services/designer/infra/model/json/CdmEntity.js
 @@ -162,7 +162,7 @@ sap.ui.define([
	                        let locale = typeof index === "string" ? index : item.locale;
	                        let text = typeof item === "string" ? item : item.text;
	                        if (!localesMap[locale]) {
	                            localesMap[locale] = {locale, textDictionary: {}};
	                            localesMap[locale] = {locale: locale, textDictionary: {}};
	                        }
	                        localesMap[locale].textDictionary[key] = text;
	                    });
Copy path View file      
63 ...ces/infra/src/sap/ushell/services/designer/infra/model/json/InboundParametersDecorator.js
@@ -0,0 +1,63 @@
	"use strict";
	
	sap.ui.define([
	    './JsonEntity',
	    '../../utils/LibRegistry',
	], function (JsonEntity, LibRegistry) {
	    const _ = LibRegistry.getLib("lodash");
	    const inboundsPath = "cdm/payload/targetAppConfig/sap.app/crossNavigation/inbounds";
	
	    return function InboundParametersDecorator() {
	        const normalPath = this._normalPath.bind(this);
	
	        this.properties.additionalParameters = function (trap, json, val) {
	            const allowed = "allowed";
	            let inbounds = _.get(json, normalPath(inboundsPath, true));
	            const additionalParametersPath = inboundsPath + '/' + Object.keys(inbounds)[0] + "/signature/additionalParameters";
	
	            if (trap === "get") {
	                let additionalParametersValue = _.get(json, normalPath(additionalParametersPath, true), allowed);
	                return (additionalParametersValue === allowed);
	            } else if (trap === "set") {
	                _.set(json, normalPath(additionalParametersPath), val ? allowed : "not" + allowed);
	            }
	        };
	
	        this.properties.inboundParameters = function (trap, json, val) {
	            let inbounds = _.get(json, normalPath(inboundsPath, true));
	            const inboundParametersPath = inboundsPath + '/' + Object.keys(inbounds)[0] + "/signature/parameters";
	
	            if (trap === "get") {
	                let inboundParametersValue = _.get(json, normalPath(inboundParametersPath, true), {});
	                return Object
	                    .keys(inboundParametersValue)
	                    .map(function (key) {
	                        return {
	                            name: key,
	                            defaultValue: inboundParametersValue[key].default.value,
	                            required: inboundParametersValue[key].required,
	                            renameTo: inboundParametersValue[key].renameTo,
	                            format: inboundParametersValue[key].default.format
	                        };
	                    });
	            } else if (trap === "set") {
	                if (!Array.isArray(val)) {
	                    throw "Inbound Parameters expected an array";
	                }
	
	                let paramsObj = {};
	                val.forEach(function (row) {
	                    paramsObj[row.name] = {
	                        required: row.required,
	                        renameTo: row.renameTo,
	                        default: {
	                            format: "plain",
	                            value: row.defaultValue
	                        }
	                    };
	                });
	                _.set(json, normalPath(inboundParametersPath), paramsObj);
	            }
	        };
	    };
	}); 
Copy path View file      
58 ...sources/infra/src/sap/ushell/services/designer/infra/model/json/VisualizationDecorator.js
 @@ -3,7 +3,7 @@
	sap.ui.define([
	    './JsonEntity',
	    '../../utils/LibRegistry'
	],function(JsonEntity, LibRegistry) {
	], function (JsonEntity, LibRegistry) {
	    const _ = LibRegistry.getLib("lodash");
	    let normalPath;
	
 @@ -12,7 +12,7 @@ sap.ui.define([
	        "cdm/texts/cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info"
	    ];
	
	    function newStaticAppLauncher(sInboundId) {
	    function newStaticAppLauncher(sInboundId, vizParameters) {
	        return {
	            "RandomURL-Launcher": {
	                "vizType": "sap.ushell.StaticAppLauncher",
 @@ -23,24 +23,22 @@ sap.ui.define([
	                        }
	                    },
	                    "sap.app": {
	                        //    "title": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|title}}",
	                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	                    },
	                    "sap.flp": {
	                        "target": {
	                            "type": "IBN",
	                            "inboundId": sInboundId,
	                            "parameters": {
	                            }
	                            "parameters": vizParameters
	                        }
	                    }
	                }
	            }
	        };
	    }
	    
	    function newDynamicAppLauncher(sInboundId) {
	
	    function newDynamicAppLauncher(sInboundId, vizParameters) {
	        return {
	            "RandomURL-Launcher": {
	                "vizType": "sap.ushell.DynamicAppLauncher",
 @@ -51,16 +49,14 @@ sap.ui.define([
	                        }
	                    },
	                    "sap.app": {
	                        //    "title": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|title}}",
	                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	                    },
	                    "sap.flp": {
	                        "target": {
	                            "type": "IBN",
	                            "inboundId": sInboundId,
	                            "parameters": {
	                            }
	                            "parameters": vizParameters
	                        },
	                        "indicatorDataSource": {
	                            "path": "",
 @@ -72,24 +68,28 @@ sap.ui.define([
	        };
	    }
	
	    function getInboundIdFromCrossNavigation (json) {
	    function getInboundIdFromCrossNavigation(json) {
	        const oInbounds = _.get(json, normalPath("cdm/payload/targetAppConfig/sap.app/crossNavigation/inbounds"));
	        return (oInbounds && typeof oInbounds === 'object' && Object.keys(oInbounds).length > 0) ? Object.keys(oInbounds)[0] : "";
	    }
	
	    const vizSwitcher = {
	        "sap.ushell.StaticAppLauncher": function (json) {
	           let sInboundId = getInboundIdFromCrossNavigation(json);
	            _.set(json, normalPath("cdm/payload/visualizations") , newStaticAppLauncher(sInboundId));
	            let sInboundId = getInboundIdFromCrossNavigation(json);
	            const vizParameters = _.get(json, normalPath("cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters"));
	
	            _.set(json, normalPath("cdm/payload/visualizations"), newStaticAppLauncher(sInboundId, vizParameters));
	            _.set(json, normalPath("cdm/payload/defaultViz"), "RandomURL-Launcher");
	        },
	        "sap.ushell.DynamicAppLauncher": function (json) {
	            let sInboundId = getInboundIdFromCrossNavigation(json);
	            _.set(json, normalPath("cdm/payload/visualizations") , newDynamicAppLauncher(sInboundId));
	            const vizParameters = _.get(json, normalPath("cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters"));
	
	            _.set(json, normalPath("cdm/payload/visualizations"), newDynamicAppLauncher(sInboundId, vizParameters));
	            _.set(json, normalPath("cdm/payload/defaultViz"), "RandomURL-Launcher");
	        },
	        "sap.ushell.None": function (json) {
	            _.set(json, normalPath("cdm/payload/visualizations") , {});
	            _.set(json, normalPath("cdm/payload/visualizations"), {});
	            _.unset(json, normalPath("cdm/payload/defaultViz"));
	            translatedValues.forEach(function (key) {
	                _.unset(json, normalPath(key));
 @@ -116,6 +116,34 @@ sap.ui.define([
	                vizSwitcher[val] && vizSwitcher[val](json);
	            }
	        };
	
	        this.properties.visualizationParameters = function (trap, json, val) {
	            const vizParametersPath = "cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters";
	            if (trap === "get") {
	                let vizParametersValue = _.get(json, normalPath(vizParametersPath, true), {});
	                let paramsObj = {};
	                Object
	                    .keys(vizParametersValue)
	                    .forEach(function (key) {
	                        paramsObj[key] = vizParametersValue[key].value.value;
	                    });
	                return paramsObj;
	            } else if (trap === "set") {
	                let paramsObj = {};
	                Object
	                    .keys(val)
	                    .forEach(function (key) {
	                        const value = val[key];
	                        paramsObj[key] = {
	                            value: {
	                                value: value,
	                                format: "plain"
	                            }
	                        };
	                    });
	                _.set(json, normalPath(vizParametersPath), paramsObj);
	            }
	        };
	    }
	
	    return VisualizationDecorator;
Copy path View file      
1  static-resources/infra/test/sap/ushell/services/designer/infra/unit/allTests.js
 @@ -27,5 +27,6 @@ sap.ui.define([
	    "sap/ushell/services/designer/infra/test/unit/utils/SemanticServiceUtils.qunit",
	    "sap/ushell/services/designer/infra/test/unit/model/json/VisualizationDecorator.qunit",
	    "sap/ushell/services/designer/infra/test/unit/services/RoleCollectionService.qunit",
	    "sap/ushell/services/designer/infra/test/unit/model/json/InboundParametersDecorator.qunit",
	    "sap/ushell/services/designer/infra/test/unit/services/designTime/DestinationService.qunit"
	]); 
Copy path View file      
216 ...st/sap/ushell/services/designer/infra/unit/model/json/InboundParametersDecorator.qunit.js
@@ -0,0 +1,216 @@
	sap.ui.define([
	    "sap/ushell/services/designer/infra/model/json/InboundParametersDecorator",
	    "sap/ushell/services/designer/infra/utils/LibRegistry",
	    "mock/JsonEntityTestUtils",
	    "sap/ui/thirdparty/sinon",
	
	], function (InboundParametersDecorator, LibRegistry, JsonEntityTestUtils, sinon) {
	    "use strict";
	
	    let _;
	    let inboundParametersDecorator;
	    let getStub;
	    let setStub;
	    let unsetStub;
	    let normalPathStub;
	    let businessAppEntityMock;
	
	    QUnit.module("sap.ushell.services.designer.infra.main.model.json.InboundParametersDecorator test", {
	        beforeEach: function (assert) {
	            _ = LibRegistry.getLib("lodash");
	
	            normalPathStub = sinon.stub();
	
	            inboundParametersDecorator = {};
	            inboundParametersDecorator._normalPath = normalPathStub;
	            inboundParametersDecorator.properties = {};
	            InboundParametersDecorator.call(inboundParametersDecorator);
	
	            getStub = sinon.stub(_, "get").returns({});
	            setStub = sinon.stub(_, "set");
	            unsetStub = sinon.stub(_, "unset");
	
	            businessAppEntityMock = {
	                "cdm": {
	                    "_version": "3.0",
	                    "identification": {
	                        "id": "my_dummy_app2",
	                        "title": "{{cdm|identification|title}}",
	                        "entityType": "businessapp",
	                        "description": "{{cdm|identification|description}}"
	                    },
	                    "payload": {
	                        "targetAppConfig": {
	                            "_version": "1.13.0",
	                            "sap.app": {
	                                "crossNavigation": {
	                                    "inbounds": {
	                                        "GenericURL-Launch": {},
	                                        "signature": {
	                                            "parameters": {
	                                                "paramFirstRow": {
	                                                    "required": true,
	                                                    "renameTo": "intentForParamFirstRow",
	                                                    "default": {
	                                                        "value": "aValueForParamFirstRow",
	                                                        "format": "plain"
	                                                    }
	                                                }
	                                            }
	                                        },
	                                        "additionalParameters": "allowed"
	                                    }
	                                },
	                                "tags": {
	                                    "keywords": []
	                                }
	                            },
	                            "sap.integration": {
	                                "urlTemplateId": "templateGenericURL",
	                                "urlTemplateParams": {
	                                    "url": "https://www.sap2.com",
	                                    "query": {
	                                        "a": "AAA",
	                                        "b": "BBB"
	                                    }
	                                }
	                            }
	                        },
	                        "visualizations": {
	                            "RandomURL-Launcher": {
	                                "target": {
	                                    "inboundId": "RandomURL-Launcher"
	                                },
	                                "vizType": "sap.ushell.StaticAppLauncher",
	                                "vizConfig": {
	                                    "sap.ui": {
	                                        "icons": {
	                                            "icon": ""
	                                        }
	                                    },
	                                    "sap.app": {
	                                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}",
	                                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"
	                                    },
	                                    "sap.flp": {
	                                        "target": {
	                                            "type": "IBN",
	                                            "inboundId": "RandomURL-Launcher",
	                                            "parameters": {}
	                                        }
	                                    }
	                                }
	                            }
	                        },
	                        "defaultViz": "RandomURL-Launcher"
	                    },
	                    "texts": {
	                        "cdm|identification|title": {
	                            "type": "XTIT",
	                            "value": {
	                                "": "My Second Dummy App"
	                            }
	                        },
	                        "cdm|identification|description": {
	                            "type": "XTIT",
	                            "value": {
	                                "": "Dummy Desc2"
	                            }
	                        },
	                        "cdm|payload|visualizations|RandomURL-Launcher|vizParams|title": {
	                            "type": "XTIT",
	                            "value": {
	                                "": "Hello URL"
	                            }
	                        }
	                    }
	                },
	                "metadata": {
	                    "createdOn": 1536476313233,
	                    "updatedOn": 1536476334444,
	                    "createdBy": "Amir Yahalom",
	                    "updatedBy": "Someone else"
	                }
	            };
	        },
	
	        afterEach: function () {
	            getStub.restore();
	            setStub.restore();
	            unsetStub.restore();
	        }
	    });
	
	    QUnit.test("InboundParametersDecorator properties size unit test", sinon.test(function (assert) {
	        assert.ok(Object.keys(inboundParametersDecorator.properties).length === 2);
	    }));
	
	    QUnit.test("InboundParametersDecorator additionalParameters get unit test", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.additionalParameters.call(inboundParametersDecorator, "get", businessAppEntityMock, "someValue");
	        assert.ok(getStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator additionalParameters set unit test - value is not empty", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.additionalParameters.call(inboundParametersDecorator, "set", businessAppEntityMock, "someValue");
	        assert.ok(setStub.calledOnce);
	        assert.ok(normalPathStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator additionalParameters set unit test - value is empty", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.additionalParameters.call(inboundParametersDecorator, "set", businessAppEntityMock, null);
	        assert.ok(setStub.calledOnce);
	        assert.ok(normalPathStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator inboundParametersTable get unit test", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.inboundParameters.call(inboundParametersDecorator, "get", businessAppEntityMock, "someValue");
	        assert.ok(getStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator inboundParametersTable get unit test - parameters is array", sinon.test(function (assert) {
	        getStub.restore();
	        getStub = this.stub(_, "get").returns({
	            "A1": {
	                renameTo: "A2",
	                required: true,
	                default: {
	                    value: "A3",
	                    format: "plain"
	                }
	            }
	        });
	        inboundParametersDecorator.properties.inboundParameters.call(inboundParametersDecorator, "get", businessAppEntityMock, "someValue");
	        assert.ok(getStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator inboundParametersTable set unit test", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.inboundParameters.call(inboundParametersDecorator, "set", businessAppEntityMock, []);
	        assert.ok(setStub.calledOnce);
	        assert.ok(normalPathStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator inboundParametersTable set unit test - value is array", sinon.test(function (assert) {
	        inboundParametersDecorator.properties.inboundParameters.call(inboundParametersDecorator, "set", businessAppEntityMock, [{
	            name: "A1",
	            renameTo: "A2",
	            defaultValue: "A3",
	            required: true
	        }]);
	        assert.ok(setStub.calledOnce);
	        assert.ok(normalPathStub.calledTwice);
	    }));
	
	    QUnit.test("InboundParametersDecorator inboundParametersTable set unit test with invalid input", sinon.test(function (assert) {
	        const message = "Inbound Parameters expected an array";
	        assert.throws(
	            function () {
	                inboundParametersDecorator.properties.inboundParameters.call(inboundParametersDecorator, "set", businessAppEntityMock, "someValue");
	            },
	            function (err) {
	                return err.toString() === message;
	            }
	        );
	    }));
	
	});
	
Copy path View file      
91 ...a/test/sap/ushell/services/designer/infra/unit/model/json/VisualizationDecorator.qunit.js
 @@ -4,11 +4,10 @@ sap.ui.define([
	    "mock/JsonEntityTestUtils",
	    "sap/ui/thirdparty/sinon",
	    'sap/ushell/services/designer/infra/utils/EntityUtils'
	
	], function (VisualizationDecorator, LibRegistry, JsonEntityTestUtils, sinon, EntityUtils) {
	    "use strict";
	
	    var _;
	    let _;
	    let visualizationDecorator;
	    let getStub;
	    let setStub;
 @@ -52,7 +51,7 @@ sap.ui.define([
	    }));
	
	    QUnit.test("subtitle unit test", sinon.test(function (assert) {
	        visualizationDecorator.properties.subTitle.call(visualizationDecorator, "get", { cdm: "gil" }, "value1");
	        visualizationDecorator.properties.subTitle.call(visualizationDecorator, "get", {cdm: "gil"}, "value1");
	        assert.ok(translatedFieldPropertyStub.calledOnce);
	        assert.ok(translatedFieldPropertyStub.getCall(0).args[0] === "get");
	        assert.ok(translatedFieldPropertyStub.getCall(0).args[1].cdm === "gil");
 @@ -61,7 +60,7 @@ sap.ui.define([
	    }));
	
	    QUnit.test("information unit test", sinon.test(function (assert) {
	        visualizationDecorator.properties.information.call(visualizationDecorator, "get", { cdm: "gil" }, "value1");
	        visualizationDecorator.properties.information.call(visualizationDecorator, "get", {cdm: "gil"}, "value1");
	        assert.ok(translatedFieldPropertyStub.calledOnce);
	        assert.ok(translatedFieldPropertyStub.getCall(0).args[0] === "get");
	        assert.ok(translatedFieldPropertyStub.getCall(0).args[1].cdm === "gil");
 @@ -70,42 +69,42 @@ sap.ui.define([
	    }));
	
	    QUnit.test("viz unit test get", sinon.test(function (assert) {
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "get", { cdm: "gil" }, "value1");
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "get", {cdm: "gil"}, "value1");
	        assert.ok(getStub.calledOnce);
	        assert.ok(getStub.getCall(0).args[0].cdm === "gil");
	        assert.ok(getStub.getCall(0).args[2] === "sap.ushell.None");
	    }));
	
	    QUnit.test("viz unit test set sap.ushell.StaticAppLauncher", sinon.test(function (assert) {
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", { cdm: "gil" }, "sap.ushell.StaticAppLauncher");
	        assert.ok(normalPathStub.calledThrice);
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", {cdm: "gil"}, "sap.ushell.StaticAppLauncher");
	        assert.equal(normalPathStub.callCount, 4);
	        assert.ok(setStub.calledTwice);
	        assert.ok(getStub.calledOnce);
	        assert.ok(getStub.calledTwice);
	        assert.ok(getStub.getCall(0).args[0].cdm === "gil");
	        assert.ok(normalPathStub.getCall(0).args[0] === "cdm/payload/targetAppConfig/sap.app/crossNavigation/inbounds");
	        assert.ok(normalPathStub.getCall(1).args[0] === "cdm/payload/visualizations");
	        assert.ok(normalPathStub.getCall(2).args[0] === "cdm/payload/defaultViz");
	        assert.ok(normalPathStub.getCall(1).args[0] === "cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters");
	        assert.ok(normalPathStub.getCall(2).args[0] === "cdm/payload/visualizations");
	        assert.ok(setStub.getCall(0).args[0].cdm === "gil");
	        assert.ok(setStub.getCall(1).args[0].cdm === "gil");
	        assert.ok(setStub.getCall(1).args[2] === "RandomURL-Launcher");
	    }));
	
	    QUnit.test("viz unit test set sap.ushell.DynamicAppLauncher", sinon.test(function (assert) {
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", { cdm: "gil" }, "sap.ushell.DynamicAppLauncher");
	        assert.ok(normalPathStub.calledThrice);
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", {cdm: "gil"}, "sap.ushell.DynamicAppLauncher");
	        assert.equal(normalPathStub.callCount, 4);
	        assert.ok(setStub.calledTwice);
	        assert.ok(getStub.calledOnce);
	        assert.ok(getStub.calledTwice);
	        assert.ok(getStub.getCall(0).args[0].cdm === "gil");
	        assert.ok(normalPathStub.getCall(0).args[0] === "cdm/payload/targetAppConfig/sap.app/crossNavigation/inbounds");
	        assert.ok(normalPathStub.getCall(1).args[0] === "cdm/payload/visualizations");
	        assert.ok(normalPathStub.getCall(2).args[0] === "cdm/payload/defaultViz");
	        assert.ok(normalPathStub.getCall(1).args[0] === "cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters");
	        assert.ok(normalPathStub.getCall(2).args[0] === "cdm/payload/visualizations");
	        assert.ok(setStub.getCall(0).args[0].cdm === "gil");
	        assert.ok(setStub.getCall(1).args[0].cdm === "gil");
	        assert.ok(setStub.getCall(1).args[2] === "RandomURL-Launcher");
	    }));
	
	    QUnit.test("viz unit test set sap.ushell.None", sinon.test(function (assert) {
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", { cdm: "gil" }, "sap.ushell.None");
	        visualizationDecorator.properties.vizType.call(visualizationDecorator, "set", {cdm: "gil"}, "sap.ushell.None");
	        assert.ok(setStub.calledOnce);
	        assert.ok(unsetStub.getCalls().length >= 1);
	        assert.ok(getStub.notCalled);
 @@ -114,4 +113,64 @@ sap.ui.define([
	        assert.ok(normalPathStub.getCall(1).args[0] === "cdm/payload/defaultViz");
	    }));
	
	    QUnit.test("visualizationParameters setter", sinon.test(function (assert) {
	        visualizationDecorator.properties.visualizationParameters.call(visualizationDecorator, "set", {cdm: "cdm"}, [{
	            name: "A1",
	            renameTo: "A2",
	            format: "plain",
	            require: true
	        }]);
	
	        assert.ok(normalPathStub.calledOnce);
	        assert.ok(setStub.calledOnce);
	        assert.ok(normalPathStub.getCall(0).args[0] === "cdm/payload/visualizations/RandomURL-Launcher/vizConfig/sap.flp/target/parameters");
	        assert.ok(setStub.getCall(0).args[0].cdm === "cdm");
	    }));
	
	    QUnit.test("visualizationParameters getter", sinon.test(function (assert) {
	        getStub.restore();
	        getStub = this.stub(_, "get").returns({
	            name: {value: {value: "A1"}},
	            renameTo: {value: {value: "A2"}},
	            format: {value: {value: "plain"}},
	            require: {value: {value: true}}
	        });
	
	        let entity = {
	            cdm: {
	                payload: {
	                    visualizations: {
	                        "RandomURL-Launcher": {
	                            vizConfig: {
	                                "sap.flp": {
	                                    target: {
	                                        parameters: {
	                                            "A1": {
	                                                name: "A1",
	                                                renameTo: "A2",
	                                                format: "plain",
	                                                require: true
	                                            },
	                                            "A2": {
	                                                name: "A2",
	                                                renameTo: "A1",
	                                                format: "plain",
	                                                require: true
	                                            }
	                                        }
	                                    }
	                                }
	                            }
	                        }
	                    }
	                }
	            }
	        };
	
	        visualizationDecorator.properties.visualizationParameters.call(visualizationDecorator, "get", entity, "value");
	
	        assert.ok(getStub.calledOnce);
	        assert.deepEqual(getStub.getCall(0).args[0].cdm, entity.cdm);
	    }));
	
	}); 
Copy path View file      
3 ...infra/test/sap/ushell/services/designer/infra/unit/services/cdm/CdmEntityManager.qunit.js
 @@ -48,10 +48,12 @@ sap.ui.define([
	
	    const entityMockProxy = {data: {id: entityId, entityType: ENTITY_TYPE}};
	    const fetchEntityMock = {
	        "additionalParameters": true,
	        "description": "B",
	        "entityType": cdmEntityMock.cdm.identification.entityType,
	        "icon": undefined,
	        "id": cdmEntityMock.cdm.identification.id,
	        "inboundParameters": [],
	        "information": undefined,
	        "inbounds": {
	            "MySemanticObject-MyAction": {
 @@ -105,6 +107,7 @@ sap.ui.define([
	            "query": [],
	            "url": ""
	        },
	        "visualizationParameters": {},
	        "vizType": "sap.ushell.None"
	    };
	
 ProTip! Use n and p to navigate between commits in a pull request.
© 2019 GitHub, Inc.
Help
Support
API
Training
Blog
About
GitHub Enterprise Server 2.16.4
Press h to open a hovercard with more details.

        1.9.8


    1.10 sap_everyone role


        1.10.1 general
Tasks-Breakdown:

        1.10.2 links
BLI: 
JIRA: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1738  
Design-Document:
Test-Scope:

        1.10.3 Design

        1.10.4 Code
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/199


        1.10.5

    1.11 [Eng] API Integration Tests for Semantic Service - Research & POC - aka automtion tests, fs-automation 
	
        1.11.1 commitment
·         Research which tool can be used for API integration tests in Semantic Service.
·         Utilize Yaron's framework for API Integration tests in Semantic Service
·         or
·         Research for different tools (Postman?)
·         POC - write and execute API integration test
Sync with Yaron (KT session) – 1PD
Infra for test execution / project structure – 3PDs
Connect to CI – 3PD
APIs to test -
Write tests – 5PD
Wiki – How to – 1PD
 
13PDs

        1.11.2 Planing

Hi,

Meeting summary.

•	Project name (no fs)
New repo + npm in nexus. Owner: @Pdut, Yaron
•	Project structure. Separate by tool, UIVeri5, Axios etc.
Move E2E tests (UIVeri5) to different repo. Owner: @Pdut, Yaron
everyone contributes test under dedicated folder Test/dt-semantic, fs-semantic …
•	How to consume by (nodejs) services – NA, write in ts
•	Define any outstanding gap for making the tool infra – as above 
•	Plan for adding DT semantic tests to CI. Owner: @Izaq, Yosi
Add tests in three stages: 
Initial PoC stage: Create site, Get site, update site, Delete site
Stage 2: create app, role, catalog and group. Get, Update and delete all
Stage 3: Add assignments. Add Business app tech and translation
•	Define technical Debt. Known limitations, bugs etc. 
RT/DT code duplication. Will be investigated in future.

Thanks!
Yosi 

        1.11.3 Getting started
a. Dockerfile 
[i500695@C02X632CJGH6:2019-05-13 10:02:36:~/work/SAP/git/portal-cf-fs-automation:]891$ cat Dockerfile 
FROM node:8
WORKDIR /Users/i355599/git/git.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
COPY . ./
ENV DEBUG=*
ENV TEST_USER=teamuser1234@gmail.com
ENV TEST_PASSWORD=QWE11asd
ENV TEST_URL=https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com
RUN npm config set registry  "http://nexus.wdf.sap.corp:8081/nexus/content/groups/build.releases.npm/"
RUN npm install
CMD [ "npm", "test" ]

b.  docker build -t automation .

c. docker run  automation 
[i500695@C02X632CJGH6:2019-05-13 10:01:33:~/work/SAP/git/portal-cf-fs-automation:]889$ docker run  automation 

> portal-cf-cs-automation@0.0.1 test /Users/i355599/git/git.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
> mocha -r ts-node/register --reporter=xunit --reporter-options output=target/TEST-mocha.xml ./test/**/*.spec.ts 

2019-05-13T07:01:40.070Z mocha:suite bail undefined
2019-05-13T07:01:40.073Z mocha:suite enableTimeouts true
2019-05-13T07:01:40.078Z mocha:suite bail undefined
2019-05-13T07:01:42.398Z mocha:suite timeout 2000
2019-05-13T07:01:42.398Z mocha:suite retries -1
2019-05-13T07:01:42.398Z mocha:suite enableTimeouts true
2019-05-13T07:01:42.399Z mocha:suite slow 75
2019-05-13T07:01:42.399Z mocha:suite bail undefined
2019-05-13T07:01:42.401Z mocha:suite timeout 2000
2019-05-13T07:01:42.401Z mocha:suite retries -1
2019-05-13T07:01:42.401Z mocha:suite enableTimeouts true
2019-05-13T07:01:42.401Z mocha:suite slow 75
2019-05-13T07:01:42.401Z mocha:suite bail undefined
2019-05-13T07:01:42.402Z mocha:suite timeout 10000
2019-05-13T07:01:42.403Z mocha:runnable timeout 10000
2019-05-13T07:01:42.404Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.404Z mocha:runnable slow 75
2019-05-13T07:01:42.405Z mocha:runnable timeout 10000
2019-05-13T07:01:42.405Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.405Z mocha:runnable slow 75
2019-05-13T07:01:42.405Z mocha:runnable timeout 10000
2019-05-13T07:01:42.406Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.406Z mocha:runnable slow 75
2019-05-13T07:01:42.406Z mocha:runnable timeout 10000
2019-05-13T07:01:42.406Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.406Z mocha:runnable slow 75
2019-05-13T07:01:42.407Z mocha:runnable timeout 10000
2019-05-13T07:01:42.407Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.407Z mocha:runnable slow 75
2019-05-13T07:01:42.407Z mocha:runnable timeout 10000
2019-05-13T07:01:42.407Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.407Z mocha:runnable slow 75
2019-05-13T07:01:42.407Z mocha:runnable timeout 10000
2019-05-13T07:01:42.407Z mocha:runnable enableTimeouts true
2019-05-13T07:01:42.407Z mocha:runnable slow 75
2019-05-13T07:01:42.409Z mocha:runner grep /.*/
2019-05-13T07:01:42.411Z mocha:runner globals ["console","global","process","Buffer","clearImmediate","clearInterval","clearTimeout","setImmediate","setInterval","setTimeout","before","after","beforeEach","afterEach","run","context","describe","xcontext","xdescribe","specify","it","xspecify","xit","XMLHttpRequest","Date"]
2019-05-13T07:01:42.412Z mocha:runner globals []
2019-05-13T07:01:42.413Z mocha:runner start
2019-05-13T07:01:42.414Z mocha:runner run suite 
2019-05-13T07:01:42.417Z mocha:runner run suite Basic Flow
2019-05-13T07:01:42.418Z mocha:runner run suite Basic Flow Basic Flow
2019-05-13T07:01:42.419Z basic.spec ******************************************************************************************
2019-05-13T07:01:42.419Z basic.spec https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com
2019-05-13T07:01:42.419Z basic.spec teamuser1234@gmail.com
2019-05-13T07:01:42.419Z basic.spec ******************************************************************************************
2019-05-13T07:01:42.426Z portal-api --> login From environment variables: URL { href: 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/', origin: 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com', protocol: 'https:', username: '', password: '', host: 'flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com', hostname: 'flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com', port: '', pathname: '/', search: '', searchParams: URLSearchParams {}, hash: '' }
2019-05-13T07:01:42.427Z portal-api >>>> login 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com'
2019-05-13T07:01:42.427Z portal-api --> initial login attempt (no session cookie)
2019-05-13T07:01:42.428Z portal-api 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com'
2019-05-13T07:01:42.832Z portal-api ***>> uaaRedirectionAddress 'https://flpdevelop.authentication.sap.hana.ondemand.com/oauth/authorize?response_type=code&client_id=sb-portal-cf-dt-approuter-lkg!t63&redirect_uri=https%3A%2F%2Fflpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com%2Flogin%2Fcallback'
2019-05-13T07:01:43.127Z portal-api ***>> uaa_authorize location 'https://flpdevelop.authentication.sap.hana.ondemand.com/login'
2019-05-13T07:01:43.128Z portal-api idp_authenticate
2019-05-13T07:01:43.128Z portal-api loginUrl: 'https://flpdevelop.authentication.sap.hana.ondemand.com/login'
2019-05-13T07:01:43.426Z portal-api idp_user_credentials 'https://flpdevelop.authentication.sap.hana.ondemand.com/login.do'
2019-05-13T07:01:44.022Z portal-api oauth1
2019-05-13T07:01:44.549Z portal-api *****>> oauth1
2019-05-13T07:01:44.549Z portal-api location: 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/login/callback?code=ZbC9Y8F8Vh'
2019-05-13T07:01:44.550Z portal-api address4cookie: 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com'
2019-05-13T07:01:44.551Z portal-api CookieJar {
  store: { idx: { 'flpdevelop.authentication.sap.hana.ondemand.com': 
   { '/': 
      { 'X-Uaa-Csrf': Cookie="X-Uaa-Csrf=TS0UmeNGORBTZu130tAdoc; Expires=Tue, 14 May 2019 07:01:44 GMT; Max-Age=86400; Path=/; Secure; HttpOnly; hostOnly=true; aAge=3ms; cAge=1425ms",
        JSESSIONID: Cookie="JSESSIONID=3B49708292D67B4E9A39EE047CCC0F43; Path=/; Secure; HttpOnly; hostOnly=true; aAge=527ms; cAge=1425ms",
        __VCAP_ID__: Cookie="__VCAP_ID__=f8c41bbf-bdd3-4b03-4b9a-a268; Path=/; Secure; HttpOnly; hostOnly=true; aAge=527ms; cAge=1425ms" } },
  'flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com': 
   { '/': 
      { signature: Cookie="signature=5nLfB2z5yHtPy%2FdL1tbygCJJ%2Bns%3D; Path=/; hostOnly=true; aAge=1ms; cAge=1ms",
        locationAfterLogin: Cookie="locationAfterLogin=/sitedirectory; Path=/; hostOnly=true; aAge=1ms; cAge=1ms" } } } } }
2019-05-13T07:01:45.165Z portal-api https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/login/callback?code=ZbC9Y8F8Vh
2019-05-13T07:01:45.168Z basic.spec create site: site id -> 'f66fff10-754c-11e9-9515-39aa203d9c35'
2019-05-13T07:01:47.256Z basic.spec create site done
2019-05-13T07:01:47.258Z basic.spec retrieve page templates list
2019-05-13T07:01:47.701Z semantic-service.ts [ { providerId: 'OOTB', templateId: 'OOTBMTAR', artifactId: 'anchorNavPageapp', title: 'Anchor Navigation', thumbnail: 'AnchorNavigationPreview.png' }, { providerId: 'OOTB', templateId: 'OOTBMTAR', artifactId: 'blankPagePageapp', title: 'Starter Page', thumbnail: 'BlankPreview.png' }, { providerId: 'OOTB', templateId: 'OOTBMTAR', artifactId: 'headerFooterPageapp', title: 'Header and Footer', thumbnail: 'HeaderFooterPreview.png' }, { providerId: 'OOTB', templateId: 'OOTBMTAR', artifactId: 'tallHeaderPageapp', title: 'Header Only', thumbnail: 'TallHeaderPreview.png' } ]
2019-05-13T07:01:47.702Z basic.spec retrieve anchorNavPageapp template
2019-05-13T07:01:49.744Z semantic-service.ts loading widget metadata from '../test/resources/createSite.widget.json'
2019-05-13T07:01:51.158Z basic.spec delete page: data -> { context: 'f66fff10-754c-11e9-9515-39aa203d9c35', pageAppId: 'ba606c5f-469e-4efb-8716-f1ec7d16b0aa', layoutId: '6f168265-fa3f-4cc1-9ceb-c2bd15350f5f' }
2019-05-13T07:01:51.158Z semantic-service.ts loading widget metadata from { context: 'f66fff10-754c-11e9-9515-39aa203d9c35', pageAppId: 'ba606c5f-469e-4efb-8716-f1ec7d16b0aa', layoutId: '6f168265-fa3f-4cc1-9ceb-c2bd15350f5f' }
2019-05-13T07:01:51.159Z portal-api delete csrf: 21b30955a8d8fad9-h87ezDTg3w49CkukFm0ISK7jj40
2019-05-13T07:01:52.255Z portal-api response: 200 OK
2019-05-13T07:01:52.257Z portal-api delete csrf: 21b30955a8d8fad9-h87ezDTg3w49CkukFm0ISK7jj40
2019-05-13T07:01:53.030Z portal-api response: 200 OK
2019-05-13T07:01:53.032Z mocha:runner finished running
2019-05-13T07:01:53.034Z mocha:runner end
[i500695@C02X632CJGH6:2019-05-13 10:01:53:~/work/SAP/git/portal-cf-fs-automation:]890$ vi Dockerfile 
[i500695@C02X632CJGH6:2019-05-13 10:02:36:~/work/SAP/git/portal-cf-fs-automation:]891$ cat Dockerfile 
FROM node:8
WORKDIR /Users/i355599/git/git.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
COPY . ./
ENV DEBUG=*
ENV TEST_USER=teamuser1234@gmail.com
ENV TEST_PASSWORD=QWE11asd
ENV TEST_URL=https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com
RUN npm config set registry  "http://nexus.wdf.sap.corp:8081/nexus/content/groups/build.releases.npm/"
RUN npm install
CMD [ "npm", "test" ]

d. build .ts code
  npm run-script build

e.
-> run w/o docker on lkg
export DEBUG=* && export TEST_USER=teamuser1234@gmail.com && export TEST_PASSWORD=QWE11asd && export TEST_URL=https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com && npm run-script test


-> run w/o docker on on yosi03 provider from SaaS account
export DEBUG=* && export TEST_USER=teamuser1234@gmail.com && export TEST_PASSWORD=QWE11asd && export TEST_URL=https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com && npm run-script test_sem

-> run on superb
export DEBUG=* && export TEST_USER=teamuser1234@gmail.com && export TEST_PASSWORD=QWE11asd && export TEST_URL=https://site-manager-saas-dt-cpp-superb-i308036.cfapps.sap.hana.ondemand.com && npm run-script test_sem

Note that package.json should be updated. e.g.
[i500695@C02X632CJGH6:2019-09-19 14:30:04:~/work/SAP/git/portal-cf-fs-automation/test/portal-cf-site-semantic-service:]2039$ grep test_sem ../../package.json 
    "test_sem": "./node_modules/.bin/mocha -r ts-node/register --reporter list --reporter-options output=target/TEST-mocha.xml ./test/portal-cf-site-semantic-service/*.spec.ts",

->
        1.11.4 Run vs a provider dev space
a. obtain portal login url.
Go to space, copy dt-approuter url 
Edit Dockerfile URL accordingly.
E.g. 
[i500695@C02X632CJGH6:2019-05-21 17:39:45:~/temp:]1550$ cat Dockerfile 
FROM node:8
WORKDIR /Users/i355599/git/git.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
COPY . ./
ENV DEBUG=*
ENV TEST_USER=teamuser1234@gmail.com
ENV TEST_PASSWORD=QWE11asd
ENV TEST_URL=https://site-manager.site-manager-dt-cpp-borisl-i349897.cfapps.sap.hana.ondemand.com
RUN npm config set registry  "http://nexus.wdf.sap.corp:8081/nexus/content/groups/build.releases.npm/"
RUN npm install
CMD [ "npm", "test" ]

b. Add test user to space members

c. At subaccount level (e.g. site-manager, security, trust configurations (SAP ID service), add user email, show assignments, add super admin role (e.g. BorisAdmin) 

d. run tests

        1.11.5 Nightly job

        1.11.6 E2E integration test
        https://gkenewflpcf.jaas-gcp.cloud.sap.corp/job/CFLP-E2E-INTEGRATION-TEST/

runs on LKG from flptest subaccount
automation consumer sub-account. https://flptest.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Site-Directory

runs every hour

        1.11.7 Nightly tests on LKG
https://gkeportalcf.jaas-gcp.cloud.sap.corp/view/DEVELOPER%20CORNER/job/end2endTestJobs/job/FS-E2E-INTEGRATION-TEST/

        1.11.8 Puppeteer tests
        code
        https://github.wdf.sap.corp/Portal-CF/perf-puppeteer.git

        Shirly PR (import)
        https://github.wdf.sap.corp/Portal-CF/perf-puppeteer/pull/149

        1.11.9
    1.12 MaaS retry mechanism

        1.12.1 commitment 
    Goal: use a retry mechanism for MaaS reporting to make sure we are not "avoiding" usage due to different failures
·         Scope:
·         We are not blocking the retry for RT
·         Validate that there are no double reporting to MaaS
·         Contact: Tal & Sascha 
 
Sync with Assaf K – 1PD
Design – 2PDs
Sync with MaaS (status code) – 1PD
Tests – 3PD
Retry config – 3PDs
 
10PDs

        1.12.2 Links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1743

Motivation
Use a retry mechanism for MaaS reporting to make sure we are not "avoiding" usage due to different failures 
User Story
Provide proper handling for calls to MaaS, including retries, based on the recommendations provided by MaaS. Not handling this will result in non-counted visits. 
Acceptance Criteria
In case Metering service is not accepting the call, a retry mechanism will be applied. 
Only in case of failure to report the visit to the metering service - the error should be logged for tracking purposes.  
Contacts
Tal & Sascha for guidance of the retry mechanism 

Sascha (Alexander Kravchik) reliability blog:
https://github.wdf.sap.corp/pages/Portal-CF/sre_blog/sre/2019/04/21/go-robust.html



        1.12.3 code

            1.12.3.1 shared lib reliability code

shared lib retry mechanism 
    a. circuit breaker. /Users/i500695/work/SAP/git/portal-cf-shared-lib/src/common/breaker.js

        a1. code
'use strict';

const
    cfLogger = require('../logs/cf-logger'),
    logger = cfLogger.initLogger('portal-cf-shared-lib/common/breaker.js'),
    URL = require('url').URL,
    circuitBreaker = require('opossum');

const
    breakers = {},
    defaultBreakerConfig = {
        timeout: 30000, // If our function takes longer than 30 seconds, trigger a failure
        errorThresholdPercentage: 80, // When 80% of requests fail, trip the circuit (rollingWindow = 10 sec)
        rollingCountTimeout: 10000, //rolling window = 10 sec
        resetTimeout: 10000, // After 10 seconds, try again.
        internalServerCall: false
    };

//gets a circuit breaker object per breakerKey
function getBreakerObject(loggerCtx, func, breakerKey, breakerConfig) {

    //use existing breaker or create one if not accessed yet
    if (!breakers[breakerKey]) {
        let breakerOptions = Object.assign({}, defaultBreakerConfig, breakerConfig);

        let breaker = circuitBreaker(func, breakerOptions);
        breaker.on('timeout ', () => {
            logger.logMessage('error', 'CircuitBreaker timeout on circuit key %s', breakerKey);
        });
        breaker.on('failure  ', () => {
            logger.logMessage('error', 'CircuitBreaker failure on circuit key %s', breakerKey);
        });
        breakers[breakerKey] = breaker;
    }

    logger.logRequestMessage(loggerCtx, 'info', 'DEBUG getBreaker -  breakerKey %s', breakerKey);
    return breakers[breakerKey];
}

class Breaker {

    //returns wrapped request function with circuit breaker
    getBreakerForUrl(loggerCtx, func, url, internalServiceCall, breakerConfig) {
        let breakerKey = this.getKeyForUrl(loggerCtx, url, internalServiceCall);
        return this.getBreaker(loggerCtx, func, breakerKey, breakerConfig);
    }

    //returns wrapped function with circuit breaker
    getBreaker(loggerCtx, func, breakerKey, breakerConfig) {
        if ((!func && typeof func === "function") || !breakerKey || !breakerConfig) {
            throw new Error('Invalid params');
        }
        logger.logRequestMessage(loggerCtx, 'info', 'getBreaker - func %s breakerKey %s breakerConfig %s', func.name, breakerKey, logger.printObject(breakerConfig));

        let funcWithBreaker = async (loggerCtx, ...params) => {
            const breaker = getBreakerObject(loggerCtx, func, breakerKey, breakerConfig);
            return await breaker.fire(loggerCtx, ...params);
        };
        return funcWithBreaker;
    }

    //helper method for getting circuit breaker key according to microservice url: if internal use the microservice route path, if external - use the host name.
    getKeyForUrl(loggerCtx, url, internalServiceCall = false) {
        logger.logRequestMessage(loggerCtx, 'info', 'getKeyForUrl - internalServiceCall %s url %s', internalServiceCall, url);

        //if internal call host name is same - save the 2nd parameter as the url key, otherwise use host as url key
        let breakerKey;
        if (internalServiceCall) {
            breakerKey = new URL(url).pathname.substring(1).split('/', 1)[0];
        } else {
            breakerKey = new URL(url).host;
        }
        logger.logRequestMessage(loggerCtx, 'debug', 'getKeyForUrl - url %s internalServiceCall %s breakerKey %s', url, internalServiceCall, logger.printObject(breakerKey));

        return breakerKey;
    }
}

module.exports = new Breaker();

        a2.  breaker lib. opossum

    b. retry lib. 

        b1. code
/Users/i500695/work/SAP/git/portal-cf-shared-lib/src/common/retry.js
'use strict';

const
    cfLogger = require('../logs/cf-logger'),
    logger = cfLogger.initLogger('portal-cf-shared-lib/common/retry.js'),
    axios = require('axios'),
    rax = require('retry-axios');

const
    retryAxiosInstance = axios.create(),
    defaultRetryConfig = {
        retry: 0,
        noResponseRetries: 0,
        retryDelay: 100,
        httpMethodsToRetry: ['GET', 'DELETE', 'PUT', 'POST'],
        instance: retryAxiosInstance,
        statusCodesToRetry: [[100, 199], [429, 429], [400, 404], [501, 599]],
        onRetryAttempt: (err) => {
            const retryConfig = rax.getConfig(err);
            logger.logRequestMessage(retryConfig.loggerCtx, 'warning', 'onRetryAttempt - name %s currentRetryAttempt %s', retryConfig.name, retryConfig.currentRetryAttempt);
        }
    };

rax.attach(retryAxiosInstance);

class Retry {
    getRetryAxios(loggerCtx, cfg, requestOptions = {}) {
        logger.logRequestMessage(loggerCtx, 'info', 'getRetryAxios - config %s', logger.printObject(cfg));

        let retryConfig = Object.assign({}, defaultRetryConfig, cfg);
        retryConfig.loggerCtx = loggerCtx; //store loggerCtx on retry, to be used later
        requestOptions.raxConfig = retryConfig;

        return retryAxiosInstance;
    }
}

module.exports = new Retry();

        b2. axios-retry lib

        b3. observations.
The Retry class getRetryAxios() returns retryAxiosInstance which is singelton

    c.
            1.12.3.2 Usage of retry and breaker 

                1.12.3.2.1 shared lib infrastructure 


breaker and retry:

a. shared lib send request service:
/Users/i500695/work/SAP/git/portal-cf-site-service/node_modules/portal-cf-shared-lib/src/common/service-request.js, sendRequest()

- requires:
    breaker = require('../common/breaker'),
    retry = require('../common/retry'),
    monitoring = require('../perf/monitoring');

- actual request func, private
async function performRequest(loggerCtx, {formData, serviceMethod, url, requestOptions, requestOptionsForTrace, internalServiceCall, axiosInstance}) {
    logger.logRequestMessage(loggerCtx, 'silly', 'performRequest - url %s, serviceMethod %s, internalServiceCall %s, formData %s, requestOptions %s', url, serviceMethod, internalServiceCall, logger.printObject(formData), logger.printObject(requestOptionsForTrace));

    let response = null;
    try {
        if (formData && (serviceMethod === serviceMethods.POST || serviceMethod === serviceMethods.PUT)) {
            logger.logRequestMessage(loggerCtx, 'silly', 'performRequest - request performed with form data');
            response = await axiosInstance[serviceMethod](url, formData, requestOptions);
        } else {
            logge.logRequestMessage(loggerCtx, 'silly', 'performRequest - request performed without form data');
            requestOptions.url = url;
            requestOptions.method = serviceMethod;
            response = await axiosInstance(requestOptions);
            logger.logRequestMessage(loggerCtx, 'debug', 'DEBUG performRequest succeeded to url %s', url);
        }
    } catch (err) {
        logger.logRequestMessage(loggerCtx, 'error', 'performRequest - failed to perform request. url  %s, retries %s', url, _.get(requestOptions, 'raxConfig.currentRetryAttempt', 0));

        throw err;
    }

    return response;
}

- public, request(), sendRequest()
class ServiceRequest {
    static async request(loggerCtx, serviceAbsoluteUrl, serviceRelativeUrl, serviceMethod, token, options, formData, printResponse) {
        return await this.sendRequest(
            loggerCtx,
            {
                serviceAbsoluteUrl: serviceAbsoluteUrl,
                serviceRelativeUrl: serviceRelativeUrl,
                serviceMethod: serviceMethod,
                token: token,
                options: options,
                formData: formData,
                printResponse: printResponse
            });
    }
    ...
    static async sendRequest(loggerCtx, {serviceAbsoluteUrl, serviceRelativeUrl, serviceMethod, token, options, formData, printResponse, circuitBreakerConfig, retryConfig}) {
        options = options || {};
        let secure = options.secure;

        logger.logRequestMessage(loggerCtx, 'info', 'sendRequest - serviceAbsoluteUrl %s, serviceRelativeUrl %s, serviceMethod %s, options %s', serviceAbsoluteUrl, serviceRelativeUrl, serviceMethod, logger.printObject(secure ? 'SECURE' : options));

        let customHeaders = options.headers || {};
        let customBody = options.body;
        let customParams = options.params;
        let responseType = options.responseType;
        let timeout = options.timeout || DEFAULT_TIMEOUT;
        let fullResponse = options.fullResponse;
        let internalServiceCall = false;

        if (loggerCtx) {
            customHeaders['X-CorrelationID'] = loggerCtx.getCorrelationId();
        }

        if (!serviceAbsoluteUrl) {
            let portalUrlConfig;
            try {
                portalUrlConfig = env.cfServiceCredentials('portal-cf-general-configuration');
            } catch (err) {
                logger.logRequestMessage(loggerCtx, 'error', 'sendRequest - failed to get service credentials %s', logger.printObject(err));
                throw err;
            }
            if (!portalUrlConfig) {
                let msg = 'Unable to get portal url config';
                logger.logRequestMessage(loggerCtx, 'error', 'sendRequest - %s', msg);
                throw new Error(msg);
            }
            serviceAbsoluteUrl = portalUrlConfig.portalServiceUrl;
            internalServiceCall = true;
        }

        let serviceUrl = {href: serviceAbsoluteUrl};
        if (serviceRelativeUrl) {
            try {
                if (!/^(?:f|ht)tps?:\/\//.test(serviceAbsoluteUrl)) {
                    serviceAbsoluteUrl = "https://" + serviceAbsoluteUrl;
                }
                serviceUrl = new URL(serviceRelativeUrl, serviceAbsoluteUrl);
            } catch (err) {
                logger.logRequestMessage(loggerCtx, 'error', 'sendRequest - Invalid url serviceAbsoluteUrl: %s, serviceRelativeUrl: %s, %s', serviceAbsoluteUrl, serviceRelativeUrl, logger.printObject(err));
                throw err;
            }
        }
        logger.logRequestMessage(loggerCtx, 'silly', 'sendRequest - serviceUrl %s', logger.printObject(serviceUrl));

        let requestOptions = {
            headers: customHeaders,
            timeout: timeout
        };

        if (customBody) {
            requestOptions.data = customBody;
        }

        if (customParams) {
            requestOptions.params = customParams;
        }

        if (responseType) {
            requestOptions.responseType = responseType;
        }

        let requestOptionsForTrace = null;

        // clone requestOptions for traces
        if (process.env.DEV_ENV_TRACES !== 'true') {
            if (secure) {
                requestOptionsForTrace = 'SECURE';
            } else {
                requestOptionsForTrace = JSON.parse(JSON.stringify(requestOptions));
            }
        }

        if (token) {
            requestOptions.headers.Authorization = `bearer ${token}`;
        }

        if (process.env.DEV_ENV_TRACES === 'true') {
            requestOptionsForTrace = requestOptions;
        }

        logger.logRequestMessage(loggerCtx, 'debug', 'sendRequest - Service request url %s, serviceMethod %s, formData %s, requestOptions %s', serviceUrl.href, serviceMethod, logger.printObject(formData), logger.printObject(requestOptionsForTrace));
        try {
            let response, performRequestFunc = performRequest, axiosInstance = defaultAxiosInstance;

            //if Retry - use axios-retry instance
            if (retryConfig) {
                logger.logRequestMessage(loggerCtx, 'debug', 'sendRequest - using retry for url %s', serviceUrl.href);
                axiosInstance = retry.getRetryAxios(loggerCtx, retryConfig, requestOptions);
            }

            //if Breaker = wrap request internal method with breaker
            if (circuitBreakerConfig) {
                logger.logRequestMessage(loggerCtx, 'debug', 'sendRequest - using breaker for url %s', serviceUrl.href);
                performRequestFunc = breaker.getBreakerForUrl(loggerCtx, performRequestFunc, serviceUrl.href, internalServiceCall, circuitBreakerConfig);
            }
            let startTime = monitoring.getStartTime();
            response = await performRequestFunc(
                loggerCtx,
                {
                    url: serviceUrl.href,
                    serviceMethod: serviceMethod,
                    formData: formData,
                    requestOptions: requestOptions,
                    internalServiceCall: internalServiceCall,
                    axiosInstance: axiosInstance,
                    requestOptionsForTrace: requestOptionsForTrace
                }
            );

            if (printResponse === false) {
                logger.logRequestMessage(loggerCtx, 'info', 'sendRequest - Request to %s succeeded', serviceUrl.href);
            } else {
                logger.logRequestMessage(loggerCtx, 'info', 'sendRequest - Request to %s succeeded, response data: %s', serviceUrl.href, logger.printObject(response.data));
            }

            //monitoring
            if (monitoring.isMonitoringEnabled()) {
                let ms = monitoring.endTime(startTime);
                monitoring.pushCustomMetrics(loggerCtx, {
                    url: serviceUrl.href,
                    internalServiceCall: internalServiceCall,
                    metrics: [
                        {
                            metricType: 'responseTime',
                            unit: 'ms',
                            value: ms
                        },
                        {
                            metricType: 'retries',
                            unit: 'count',
                            value: _.get(requestOptions, 'raxConfig.currentRetryAttempt', 0)
                        }
                    ]
                }).catch(err => {
                    logger.logMessage( 'error', 'sendRequest - failed to push custom metrics serviceAbsoluteUrl %s, serviceRelativeUrl %s, serviceMethod %s', serviceAbsoluteUrl, serviceRelativeUrl,serviceMethod);
                });
            }

            // full response including headers or only the data
            return (fullResponse ? response : response.data);
        } catch (err) {
            let responseError =
                {
                    err: {
                        error: err.message,
                        stack: err.stack
                    },
                    config: {
                        url: err.config && err.config.url,
                        method: err.config && err.config.method,
                        data: err.config && err.config.data
                    },
                    response: {
                        status: err.response && err.response.status,
                        statusText: err.response && err.response.statusText,
                        data: err.response && err.response.data
                    }
                };
            logger.logRequestMessage(loggerCtx, 'error', 'sendRequest - Request to service %s failed,  circuitBreakerConfig %s, retryConfig %s, error: %s',
                serviceUrl.href, logger.printObject(circuitBreakerConfig), logger.printObject(retryConfig), logger.printObject(responseError));

            //monitoring
            if (monitoring.isMonitoringEnabled()) {
                let errorMetricType = (err.message === 'Breaker is open') ? 'failedBreakerOpened' : (err.code === 'ECONNABORTED') ? 'failedTimeout' : 'failedError';
                monitoring.pushCustomMetrics(loggerCtx, {
                    url: serviceUrl.href,
                    internalServiceCall: internalServiceCall,
                    metrics: [
                        {
                            metricType: errorMetricType,
                            unit: 'count',
                            value: 1
                        },
                        {
                            metricType: 'retries',
                            unit: 'count',
                            value: _.get(requestOptions, 'raxConfig.currentRetryAttempt', 0)
                        }
                    ]
                }).catch(err => {
                    logger.logMessage('error', 'sendRequest - failed to push custom metrics serviceAbsoluteUrl %s, serviceRelativeUrl %s, serviceMethod %s', serviceAbsoluteUrl, serviceRelativeUrl,serviceMethod);
                });
            }

            throw responseError;
        }
    }

                1.12.3.2.2 configuration and usage
/Users/i500695/work/SAP/git/portal-cf-site-service/src/utils/content-unit-utils.js
    CDM_STORE_CONFIG = process.env.CF_CDM_STORE_CONFIG ? JSON.parse(process.env.CF_CDM_STORE_CONFIG) : {},
    CDM_STORE_TIMEOUT = CDM_STORE_CONFIG.timeout || 800,
    CDM_STORE_RETRY_CONFIG = CDM_STORE_CONFIG.retry,
    CDM_STORE_BREAKER_CONFIG = CDM_STORE_CONFIG.circuitBreaker,

/Users/i500695/work/SAP/git/portal-cf-site-service/manifest.yml
      CF_CDM_STORE_CONFIG: '{ "timeout": 2500, "retry": { "retry": 3, "noResponseRetries": 0, "name": "cdm_store" }, "circuitBreaker": { "timeout": 2500, "errorThresholdPercentage": 90,  "rollingCountTimeout": 30, "resetTimeout": 20 } }'

c.


        1.12.4 suggested retry policy
retry ever 1h, 12 retries in all.

reasoning. MaaS call is asynch and not mission critical (in the context of get site/s).
The important thing is to make sure that at the end it succeeds 
If not warn logs are required per retry and error when gives up

configure retry-axios to retryDelay of 1h

        1.12.5 implementation

a. maas

    a1.  /Users/i500695/work/SAP/git/maas-client/src/maas.js
const MAAS_CLIENT_CONFIG = process.env.CF_MAAS_CLIENT_CONFIG ? JSON.parse(process.env.CF_MAAS_CLIENT_CONFIG) : {},
    MAAS_CLIENT_TIMEOUT = MAAS_CLIENT_CONFIG.timeout || 800,
    MAAS_CLIENT_RETRY_CONFIG = MAAS_CLIENT_CONFIG.retry;

async function report(username, usage, loggerCtx) {
    const meteringUrl = getCredentials().metering_url + reportPath;
    const token = await getAccessToken(loggerCtx);
    const encryptedName = encryptUsername(username, loggerCtx);
    const body = getRequestBody(encryptedName, usage);

    try {
        return await AsyncRequest.sendRequest(loggerCtx, {
            serviceAbsoluteUrl: null,
            serviceRelativeUrl: meteringUrl,
            serviceMethod: httpMethods.PUT,
            token: token,
            options: {...options, body},
            printResponse: false,
            circuitBreakerConfig: null,
            retryConfig: MAAS_CLIENT_RETRY_CONFIG
        });

    } catch (error) {
        logger.logRequestMessage(loggerCtx, 'error', 'Failed to report to MaaS');
        throw error;
    }
}

    a2.  /Users/i500695/work/SAP/git/maas-client/test/unit/maas.spec.js

-> config
    process.env.MAAS_CLIENT_CONFIG = '{ "timeout": 2500, "retry": { "retry": 3, "noResponseRetries": 3, "name": "metering", retryDelay: 60000}, "circuitBreaker": undefined}';
    const MAAS_CLIENT_CONFIG = process.env.CF_MAAS_CLIENT_CONFIG ? JSON.parse(process.env.CF_MAAS_CLIENT_CONFIG) : {},
        MAAS_CLIENT_RETRY_CONFIG = MAAS_CLIENT_CONFIG.retry,
        MAAS_CLIENT_TIMEOUT = MAAS_CLIENT_CONFIG.timeout || 800;
...
        const options = {
            headers: {
                "Content-Type": "application/json",
                "Accept": "application/json"
            },
            body: dummyFinalUsage,
            secure: 'SECURE',
            timeout: MAAS_CLIENT_TIMEOUT,
            fullResponse: true
        };

-> Tests
        it('should call functions with correct arguments and return the promise from sendRequest', sinonTest(async function () {
            const getAccessTokenStub = this.stub().resolves(dummyToken);
            const encryptUsernameStub = this.stub().returns(dummyEncryptedUser);
            const getRequestBodyStub = this.stub().returns(dummyFinalUsage);
            const AsyncRequestStub = this.stub().resolves(dummyResponse);

            maas.__set__('getAccessToken', getAccessTokenStub);
            maas.__set__('encryptUsername', encryptUsernameStub);
            maas.__set__('getRequestBody', getRequestBodyStub);
            maas.__set__('AsyncRequest.sendRequest', AsyncRequestStub);

            const result = await maas.report(dummyUsername, dummyInputUsage, dummyLoggerCtx);

            sinon.assert.calledWithExactly(getAccessTokenStub, dummyLoggerCtx);
            sinon.assert.calledWithExactly(encryptUsernameStub, dummyUsername, dummyLoggerCtx);
            sinon.assert.calledWithExactly(getRequestBodyStub, dummyEncryptedUser, dummyInputUsage);
            sinon.assert.calledWithExactly(AsyncRequestStub, dummyLoggerCtx, {
                serviceAbsoluteUrl: null,
                serviceRelativeUrl: dummyUrl + reportPath,
                serviceMethod: httpMethods.PUT,
                token: dummyToken,
                options: {...options},
                printResponse: false,
                circuitBreakerConfig: null,
                retryConfig: MAAS_CLIENT_RETRY_CONFIG
            });
            assert.equal(result, dummyResponse);
        }));
...
        it('should fail upon sendRequest error', sinonTest(async function () {
            const getAccessTokenStub = this.stub().resolves(dummyToken);
            const encryptUsernameStub = this.stub().returns(dummyEncryptedUser);
            const getRequestBodyStub = this.stub().returns(dummyFinalUsage);
            const AsyncRequestStub = this.stub().rejects(dummyError);

            maas.__set__('getAccessToken', getAccessTokenStub);
            maas.__set__('encryptUsername', encryptUsernameStub);
            maas.__set__('getRequestBody', getRequestBodyStub);
            maas.__set__('AsyncRequest.sendRequest', AsyncRequestStub);

            const promise = maas.report(dummyUsername, dummyInputUsage, dummyLoggerCtx);

            return assert.isRejected(promise, Error, errMsg);
        }));

->
    a3.

b. semantic
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/manifest.yml

  env:
    MAAS_CLIENT_CONFIG: '{ "timeout": 2500, "retry": { "retry": 3, "noResponseRetries": 3, "name": "metering", retryDelay: 60000}, "circuitBreaker": undefined}'
        1.12.6 E2E manual tests

            1.12.6.1  Performance tests infra

                1.12.6.1.1  https://github.wdf.sap.corp/Portal-CF/monkey-proxy
/Users/i500695/work/SAP/git/monkey-proxy

                    1.12.6.1.1.1  code

[i500695@C02X632CJGH6:2019-05-30 13:45:34:~/work/SAP/git/monkey-proxy:]1685$ cat manifest.yml 
---
applications:
  - name: proxy-service
    stack: cflinuxfs3
    memory: 4096M
    buildpacks:
      - https://github.com/cloudfoundry/nodejs-buildpack/releases/download/v1.6.39/nodejs-buildpack-cflinuxfs3-v1.6.39.zip
    routes:
      - route:  monkey.cfapps.sap.hana.ondemand.com
    env:
      CDM_STORE_DELAY: 0
      PORTAL_PERSONALIZATION_DELAY: 0
      UAA_DELAY: 0
      SITE_CONFIGURATION_DELAY: 0
      UAA_HOST: perflab.authentication.sap.hana.ondemand.com
      PORTAL_HOST: portal-service-perf02-i048692.cfapps.sap.hana.ondemand.com


[i500695@C02X632CJGH6:2019-05-30 13:45:44:~/work/SAP/git/monkey-proxy:]1686$ cat retry.js 
'use strict';

const
   // cfLogger = require('../logs/cf-logger'),
    //logger = cfLogger.initLogger('portal-cf-shared-lib/common/retry.js'),
    axios = require('axios'),
    rax = require('retry-axios');

const
    retryAxiosInstance = axios.create(),
    defaultRetryConfig = {
        retry: 0,
        noResponseRetries: 0,
        retryDelay: 100,
        httpMethodsToRetry: ['GET', 'DELETE', 'PUT', 'POST'],
        instance: retryAxiosInstance,
        statusCodesToRetry: [[100, 199], [429, 429], [400, 404], [501, 599]],
        onRetryAttempt: (err) => {
            const retryConfig = rax.getConfig(err);
            console.log('retry:'+retryConfig.currentRetryAttempt);
           // logger.logRequestMessage(retryConfig.loggerCtx, 'warning', 'onRetryAttempt - name %s currentRetryAttempt %s', retryConfig.name, retryConfig.currentRetryAttempt);
        }
    };

rax.attach(retryAxiosInstance);

class Retry {
    getRetryAxios(loggerCtx, cfg, requestOptions = {}) {
        //logger.logRequestMessage(loggerCtx, 'info', 'getRetryAxios - config %s', logger.printObject(cfg));

        let retryConfig = Object.assign({}, defaultRetryConfig, cfg);
        retryConfig.loggerCtx = loggerCtx; //store loggerCtx on retry, to be used later
        requestOptions.raxConfig = retryConfig;

        return retryAxiosInstance;
    }
}

module.exports = new Retry();[i500695@C02X632CJGH6:2019-05-30 13:46:28:~/work/SAP/git/monkey-proxy:]1687$ cat breaker.js 
'use strict';

const
    //cfLogger = require('../logs/cf-logger'),
    //logger = cfLogger.initLogger('portal-cf-shared-lib/common/breaker.js'),
    URL = require('url').URL,
    circuitBreaker = require('opossum');

const
    breakers = {},
    defaultBreakerConfig = {
        timeout: 30000, // If our function takes longer than 30 seconds, trigger a failure
        errorThresholdPercentage: 80, // When 80% of requests fail, trip the circuit (rollingWindow = 10 sec)
        rollingCountTimeout: 10000, //rolling window = 10 sec
        resetTimeout: 10000, // After 10 seconds, try again.
        internalServerCall: false
    };

//gets a circuit breaker object per breakerKey
function getBreakerObject(loggerCtx, func, breakerKey, breakerConfig) {

    //use existing breaker or create one if not accessed yet
    if (!breakers[breakerKey]) {
        let breakerOptions = Object.assign({}, defaultBreakerConfig, breakerConfig);

        let breaker = circuitBreaker(func, breakerOptions);
        breaker.on('timeout ', () => {
      //      logger.logMessage('error', 'CircuitBreaker timeout on circuit key %s', breakerKey);
        });
        breaker.on('failure  ', () => {
        //    logger.logMessage('error', 'CircuitBreaker failure on circuit key %s', breakerKey);
        });
        breakers[breakerKey] = breaker;
    }

    //logger.logRequestMessage(loggerCtx, 'info', 'DEBUG getBreaker -  breakerKey %s', breakerKey);
    return breakers[breakerKey];
}

class Breaker {

    //returns wrapped request function with circuit breaker
    getBreakerForUrl(loggerCtx, func, url, internalServiceCall, breakerConfig) {
        let breakerKey = this.getKeyForUrl(loggerCtx, url, internalServiceCall);
        return this.getBreaker(loggerCtx, func, breakerKey, breakerConfig);
    }

    //returns wrapped function with circuit breaker
    getBreaker(loggerCtx, func, breakerKey, breakerConfig) {
        if ((!func && typeof func === "function") || !breakerKey || !breakerConfig) {
            throw new Error('Invalid params');
        }
      //  logger.logRequestMessage(loggerCtx, 'info', 'getBreaker - func %s breakerKey %s breakerConfig %s', func.name, breakerKey, logger.printObject(breakerConfig));

        let funcWithBreaker = async (loggerCtx, ...params) => {
            const breaker = getBreakerObject(loggerCtx, func, breakerKey, breakerConfig);
            return await breaker.fire(loggerCtx, ...params);
        };
        return funcWithBreaker;
    }

    //helper method for getting circuit breaker key according to microservice url: if internal use the microservice route path, if external - use the host name.
    getKeyForUrl(loggerCtx, url, internalServiceCall = false) {
        //logger.logRequestMessage(loggerCtx, 'info', 'getKeyForUrl - internalServiceCall %s url %s', internalServiceCall, url);

        //if internal call host name is same - save the 2nd parameter as the url key, otherwise use host as url key
        let breakerKey;
        if (internalServiceCall) {
            breakerKey = new URL(url).pathname.substring(1).split('/', 1)[0];
        } else {
            breakerKey = new URL(url).host;
        }
        //logger.logRequestMessage(loggerCtx, 'debug', 'getKeyForUrl - url %s internalServiceCall %s breakerKey %s', url, internalServiceCall, logger.printObject(breakerKey));

        return breakerKey;
    }
}

module.exports = new Breaker();

[i500695@C02X632CJGH6:2019-05-30 13:47:24:~/work/SAP/git/monkey-proxy:]1691$ cat dummy/dummy.js 
const express = require('express'),
    //request = require('request'),
    proxy = require('express-http-proxy'),
    bodyParser = require('body-parser'),
    app = express();

app.use(bodyParser.json({limit: "50mb"}));
app.use(bodyParser.urlencoded({limit: "50mb", extended: false}));


app.use('/', (req, res, next) => {
        console.log('dummy' + req.url);
       res.header("Cache-Control", "no-cache, no-store, must-revalidate");
       console.log('dummy local headers='+JSON.stringify(req.headers));
       res.status(200).send('haha! ' + req.url);
    }
);





const port = process.env.PORT || 7777;

app.listen(port, () => {
    console.log('Proxy app listening on port ' + port);
});

/*
app.use('/site_service',proxy('localhost:9000', {
    proxyReqPathResolver: (req) => {
        return '/site_service' + req.url;
    }
}));
app.use(express.urlencoded({ extended: true }));
app.use('/', (req, res) => {
    console.log('url = ' +req.url);
    var url = req.url;
    if (req.path.startsWith('/site_service/'))  {
        url =  "http://localhost:9000" + req.url;
    }
	else if (req.path.startsWith('/activation_service/')){
		url =  "http://localhost:8000" + req.url;
	}

    console.log('rewriting url ' + req.url + ', to: ' + url);
    req.pipe(request(url)).pipe(res);
})
*/[i500695@C02X632CJGH6:2019-05-30 13:47:31:~/work/SAP/git/monkey-proxy:]1692$ cat dummy/dummy.yml 
---
applications:
  - name: dummy-service
    stack: cflinuxfs3
    buildpacks:
      - https://github.com/cloudfoundry/nodejs-buildpack/releases/download/v1.6.39/nodejs-buildpack-cflinuxfs3-v1.6.39.zip
    routes:
      - route:  dummy-service-i026028.cfapps.sap.hana.ondemand.com


[i500695@C02X632CJGH6:2019-05-30 13:48:42:~/work/SAP/git/monkey-proxy:]1694$ cat localProxy.js 
const express = require('express'),
    proxy = require('express-http-proxy'),
    bodyParser = require('body-parser'),
    app = express();

console.log(process.env);

let SETTINGS = {

    PORTAL_HOST: process.env.PORTAL_HOST || 'portal-service-perf02-i026028.cfapps.sap.hana.ondemand.com',
    UAA_HOST: process.env.UAA_HOST || 'perflab.authentication.sap.hana.ondemand.com',
    UAA_DELAY: process.env.UAA_DELAY || 0,
    PORTAL_PERSONALIZATION_DELAY: process.env.PORTAL_PERSONALIZATION_DELAY || 0,
    CDM_STORE_DELAY: process.env.CDM_STORE_DELAY || 0,
    SITE_CONFIGURATION_DELAY: process.env.SITE_CONFIGURATION_DELAY || 0
};

app.use(bodyParser.json({limit: "50mb"}));
app.use(bodyParser.urlencoded({limit: "50mb", extended: false}));

app.post('/settings', (req, res) => {
    console.log(req.body);
    SETTINGS.PORTAL_HOST = req.body.PORTAL_HOST || SETTINGS.PORTAL_HOST;
    SETTINGS.UAA_HOST = req.body.UAA_HOST || SETTINGS.UAA_HOST;
    SETTINGS.UAA_DELAY = req.body.UAA_DELAY || SETTINGS.UAA_DELAY;
    SETTINGS.PORTAL_PERSONALIZATION_DELAY = req.body.PORTAL_PERSONALIZATION_DELAY || SETTINGS.PORTAL_PERSONALIZATION_DELAY;
    SETTINGS.CDM_STORE_DELAY = req.body.CDM_STORE_DELAY || SETTINGS.CDM_STORE_DELAY;
    SETTINGS.SITE_CONFIGURATION_DELAY = req.body.SITE_CONFIGURATION_DELAY || SETTINGS.SITE_CONFIGURATION_DELAY;
    res.status(200).send(SETTINGS);
});

app.get('/settings', (req, res) => {
    res.status(200).send(SETTINGS)
});

app.use('/Users',
    proxy(SETTINGS.UAA_HOST, {
        proxyReqOptDecorator: function (proxyReqOpts, srcReq) {
            console.log('headers=' + JSON.stringify(proxyReqOpts.headers));

            return proxyReqOpts;
        },
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8');
                    console.log('res =' + data);
                    resolve(proxyResData);
                }, SETTINGS.UAA_DELAY || 0);
            });
        },
        proxyReqPathResolver: (req) => {
            console.log('routing to ' + `https://${SETTINGS.UAA_HOST}/Users` + req.url);
            return '/Users' + req.url;
        },
        memoizeHost: false,
        https: true
    })
);

app.use('/oauth',
    proxy(SETTINGS.UAA_HOST, {
        proxyReqOptDecorator: function (proxyReqOpts, srcReq) {
            console.log('headers=' + JSON.stringify(proxyReqOpts.headers));

            return proxyReqOpts;
        },
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8');
                    console.log('res =' + data);
                    resolve(proxyResData);
                }, SETTINGS.UAA_DELAY || 0);
            });
        },
        proxyReqPathResolver: (req) => {
            console.log('routing to ' + `https://${SETTINGS.UAA_HOST}/oauth` + req.url);
            return '/oauth' + req.url;
        },
        memoizeHost: false,
        https: true
    })
);

app.use('/portal_personalization',
    proxy(SETTINGS.PORTAL_HOST, {
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8');
                    resolve(proxyResData);
                }, SETTINGS.PORTAL_PERSONALIZATION_DELAY || 0);
            });
        },
        proxyReqPathResolver: (req) => {
            console.log('routing to ' + `https://${SETTINGS.PORTAL_HOST}/portal_personalization` + req.url);
            return '/portal_personalization' + req.url;
        },
        memoizeHost: false
    })
);

app.use('/cdm_store_service',
    proxy(SETTINGS.PORTAL_HOST, {
        proxyReqOptDecorator: function (proxyReqOpts, srcReq) {
            console.log('headers=' + JSON.stringify(proxyReqOpts.headers));
            proxyReqOpts.method = 'POST';
            return proxyReqOpts;
        },
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8')
                    resolve(proxyResData);
                }, SETTINGS.CDM_STORE_DELAY || 0);
            });
        },
        proxyReqPathResolver: (req) => {
            console.log('routing to ' + `https://${SETTINGS.PORTAL_HOST}/cdm_store_service` + req.url);
            return '/cdm_store_service' + req.url;
        },
        memoizeHost: false,
        https: true
    })
);

app.use('/site_configuration',
    proxy(SETTINGS.PORTAL_HOST, {
        proxyReqOptDecorator: function (proxyReqOpts, srcReq) {
            console.log('headers=' + JSON.stringify(proxyReqOpts.headers));
            return proxyReqOpts;
        },
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8')
                    resolve(proxyResData);
                }, SETTINGS.SITE_CONFIGURATION_DELAY || 0);
            });
        },
        proxyReqPathResolver: (req) => {
            console.log('routing to ' + `https://${SETTINGS.PORTAL_HOST}/site_configuration` + req.url);
            return '/site_configuration' + req.url;
        },
        memoizeHost: false,
        https: true
    })
);

app.use('/',
    proxy(SETTINGS.PORTAL_HOST)
);

/*
app.use('/test',
    proxy('dummy-service-i026028.cfapps.sap.hana.ondemand.com', {
        proxyReqOptDecorator: function (proxyReqOpts, srcReq) {
            console.log('headers=' + JSON.stringify(proxyReqOpts.headers));
            proxyReqOpts.method = 'POST';
            return proxyReqOpts;
        },
        proxyReqPathResolver: (req) => {
            return '/test' + req.url;
        },
        userResDecorator: function (proxyRes, proxyResData, userReq, userRes) {
            return new Promise(function (resolve) {
                setTimeout(function () {
                    let data = proxyResData.toString('utf8')
                    resolve(data);
                }, 0);
            });
        },
        https: true

    }));
*/
const port = process.env.PORT || 8888;

app.listen(port, () => {
    console.log('Proxy app listening on port ' + port);
});

/*
app.use('/site_service',proxy('localhost:9000', {
    proxyReqPathResolver: (req) => {
        return '/site_service' + req.url;
    }
}));
app.use(express.urlencoded({ extended: true }));
app.use('/', (req, res) => {
    console.log('url = ' +req.url);
    var url = req.url;
    if (req.path.startsWith('/site_service/'))  {
        url =  "http://localhost:9000" + req.url;
    }
	else if (req.path.startsWith('/activation_service/')){
		url =  "http://localhost:8000" + req.url;
	}

    console.log('rewriting url ' + req.url + ', to: ' + url);
    req.pipe(request(url)).pipe(res);
})
*/

                    1.12.6.1.1.2 usage
How-to:
https://github.wdf.sap.corp/Portal-CF/monkey-proxy
 
The monkey can be controlled by http ,
You can use POSTMAN to reconfigure it on the fly
 
POST /settings HTTP/1.1
Host: monkey.cfapps.sap.hana.ondemand.com
Content-Type: application/json
cache-control: no-cache
 
{
    "PORTAL_HOST": "portal-service-perf02-i048692.cfapps.sap.hana.ondemand.com",
    "UAA_HOST": "perflab.authentication.sap.hana.ondemand.com",
    "UAA_DELAY": "0",
    "PORTAL_PERSONALIZATION_DELAY": "0",
    "CDM_STORE_DELAY": "0",
    "SITE_CONFIGURATION_DELAY": "0"
}


a-z guide.
a. loging to space
[i500695@C02X632CJGH6:2019-06-02 16:16:31:~/work/SAP/CF_LocAL/myDev_Tools/dev-tools:]1982$ cf t -o site-manager -s universe
api endpoint:   https://api.cf.sap.hana.ondemand.com
api version:    2.135.0
user:           I500695
org:            site-manager
space:          universe

b.  or $ cf login -a https://api.cf.sap.hana.ondemand.com


                1.12.6.1.2 git repositories

                    1.12.6.1.2.1 https://github.wdf.sap.corp/Portal-CF/cf-gatling/

                        1.12.6.1.2.1.1 performance PRs
Jawad max page size: https://github.wdf.sap.corp/Portal-CF/cf-gatling/pull/145/files

                        1.12.6.1.2.1.2
                    1.12.6.1.2.2
                1.12.6.1.3
            1.12.6.2 Transport service manual tests

Setup: LTS
Cf t -o mainsub -s lts

API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.93.0
user:           yosi.izaq@sap.com
org:            mainsub
space:          lts

Provider app cockpit: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/c7076a1c-fa1f-4274-a64b-9a6f15676027/org/c45e1c2b-b218-416d-945e-04e2941593e9/space/ecde9397-fafa-4431-83e7-553dbe0215e1/applications

DT: https://saartest.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites#Site-Directory
you can use teamuser1234@gmail.com
QWE11asd

Consumer cockpit: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/1ae3150a-3252-4e45-977e-99f2842f0541/saasApplications

                1.12.6.2.1 transport

                    1.12.6.2.1.1 basic transport flow
a. go to provider manager. https://saartest.lts.dt.launchpad.cfapps.sap.hana.ondemand.com/sites#Provider-Manage?sap-app-origin-hint=
b. create a new provider. click new. 
c. Fill in all details.
note. design-time-destination: uyzclint200basicdt, runtime-destination: uyzclint200basicrt
keep default. manual addition. Don't create role collections.
d. save
e. should be created successfully
f. click report. should display.
Provider: yosi_prov
Created successfully/total
    Total -
    911/911
    Role -
    9/9
    App -
    777/777
    Group -
    45/45
    Catalog -
    80/80
Detailed failures
No data

g. cherry pick roles. go to site dt (https://saartest.lts.dt.launchpad.cfapps.sap.hana.ondemand.com/sites#Content-Manage?sap-app-origin-hint=)
click explore.
click yosi_prov tile
select a role. say Purchaser.
click add to my contnt
h. create a new site. (https://saartest.lts.dt.launchpad.cfapps.sap.hana.ondemand.com/sites#Site-Directory?sap-app-origin-hint=)
click create
i. add the cherry-pick role. click edit. Assign items. click + for Purchaser from yosi_prov. save
j. go to Consumer-cockpit, security->Trust-configuration->SAP-ID-Service
enter email, teamuser1234@gmail.com, show assignments, assign-role-collection, start writing ~yosi (will complete to ~yosi_prov_SAP_BR_PURCHASER)
k. navigate to RT. click top right corner go to site button. (e.g. https://saartest.lts.launchpad.cfapps.sap.hana.ondemand.com/site?siteId=8d301972-d229-4f36-8120-c22b74f429a3)
verify all app tiles apear correctly. Click one, say manager Purchase Contacts, verify access to real backend

                    1.12.6.2.1.2
                1.12.6.2.2 export

                    1.12.6.2.2.1  export site
a. site DT manager. (https://saartest.lts.dt.launchpad.cfapps.sap.hana.ondemand.com/sites#Site-Directory?sap-app-origin-hint=)
b. click a site's three dots. export site. 
c. verify content.
zip name should be e.g.  SiteTransport_8d301972-d229-4f36-8120-c22b74f429a3_20210408_130007.zip
unzip. e.g.
$ unzip SiteTransport_8d301972-d229-4f36-8120-c22b74f429a3_20210408_130007.zip 
Archive:  SiteTransport_8d301972-d229-4f36-8120-c22b74f429a3_20210408_130007.zip
  inflating: site/8d301972-d229-4f36-8120-c22b74f429a3/menu/menu1.json  
  inflating: sub_account/SUB_ACCOUNT/role/role1.json  
  inflating: site/8d301972-d229-4f36-8120-c22b74f429a3/role/role1.json  
  inflating: site/8d301972-d229-4f36-8120-c22b74f429a3/pageapp/pageapp1.json  
  inflating: site/8d301972-d229-4f36-8120-c22b74f429a3/sitereferences/sitereferences1.json  
  inflating: site/8d301972-d229-4f36-8120-c22b74f429a3/site/site1.json  
  inflating: export_data             

check report:
cat export_data 
{"time":"Thu Apr 08 2021 10:00:07 GMT+0000 (Coordinated Universal Time)","size":6,"chunkSize":1000,"transportServiceVersion":"2.26.0-20210407203216","exportedContentVersion":"0","productName":"LAUNCHPAD","username":"teamuser1234@gmail.com","providerIds":["yosi_prov"]}

verify cherry-pick role:
verify site role assignment :
[i500695@C02X632CJGH6:2021-04-08 13:02:32:~/temp:]2007$ cat site/8d301972-d229-4f36-8120-c22b74f429a3/role/role1.json 
[{"metadata":{"updatedOn":1617867536000,"updatedBy":"user team123","createdBy":"user team123","createdOn":1617867536000,"context":{"id":"8d301972-d229-4f36-8120-c22b74f429a3","contextType":"site","tenantId":"02f588210b38c2cca281cabcd2adeb19","identityZoneId":"1ae3150a-3252-4e45-977e-99f2842f0541","instanceId":"1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b"}},"cdm":{"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"Everyone"}},"cdm|identification|description":{"type":"XTIT","value":{"":"Content assigned to this role is visible to all users"}}},"payload":{"apps":[],"groups":[],"catalogs":[]},"_version":"3.0.0","identification":{"id":"sap_everyone","title":"{{cdm|identification|title}}","entityType":"role","description":"{{cdm|identification|description}}"}}}]

$ cat  sub_account/SUB_ACCOUNT/role/role1.json 
[{"metadata":{"updatedOn":1617867488000,"updatedBy":"user team123","createdBy":"user team123","createdOn":1617867488000,"context":{"id":"SUB_ACCOUNT","contextType":"sub_account","tenantId":"02f588210b38c2cca281cabcd2adeb19","identityZoneId":"1ae3150a-3252-4e45-977e-99f2842f0541","instanceId":"1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b"}},"cdm":{"texts":{},"payload":{},"_version":"3.0","relations":{"apps":[],"base":[{"label":"extends","target":{"id":"~yosi_prov_SAP_BR_PURCHASER","context":{"id":"yosi_prov","type":"SNAPSHOT"},"entityType":"role"}}]},"identification":{"id":"~yosi_prov_SAP_BR_PURCHASER","entityType":"role","providerId":"yosi_prov"}}}]

d. go to import site
                    1.12.6.2.2.2 export granularity

                    1.12.6.2.2.3
                1.12.6.2.3 import

                    1.12.6.2.3.1 import site

                    1.12.6.2.3.2 import content granularity

                1.12.6.2.4
            1.12.6.3
        1.12.7

    1.13 [Shared Content] Site references (aka Collection) entity creation in Site creation

        1.13.1 general 
Goal: an entity for managing default assignment of pages in a site entity
·         Scope:
·         On site creation, create a Site Collection entity in the site be default
·         At this point, on site delete no changes in the flow
·         Wiki: Shared Content - HL Architecture
·         Contact: Orly
Subtasks :
sync with Tal H / Nuri about activation
Mini – Design + test scope: 1PD
Site Collection object in CDM Schema (https://github.wdf.sap.corp/Portal-CF/cdm-schema/tree/master/examples/designtime/3.0/site-default-entities) – 2PD
semantic consume site collection from cdm-schema
create on site creation – 1PD
delete on site deletion – 1PD
tests (API integration test) – 1PD

BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1867
Design Doc: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Semantic+Site+Creation+and+Deletion+-+Design+Document
Test Scope:

        1.13.2 websequence

            1.13.2.1 Positive site create

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: CreateSite (contextId, JWT token) 
Semantic->Store: Create 
note left of Store
Created entities are: 
{site, menu, flp page, site-references)
end note
activate Store
note right of Store
Site is created 
It has a default site-references
end note
Store->Semantic: Create OK
deactivate Store
Semantic->Client: Create OK

        1.13.3 Tests
a. $ updateManifestSemUniverse
b. cf push -f manifest-dev.yml 
c. https://site-manager-dt-cpp-universe-i000545.cfapps.sap.hana.ondemand.com/sitedirectory/
d.  create new site while running ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2017$ loggySemantic
...
[2019-06-12T19:17:33.25+0300] [DEBUG] [26d57500-0b91-44b9-5057-44bc3e7a9103] [{'location': 'portal-cf-site-semantic-service/routes/sites.js:38'}] [portal-cf-site-semantic-service/routes/sites.js:38 - method: POST, body: { id: '83eeee07-9c12-4db1-9b2d-1b6326c810b6', name: 'yosi' }]
[2019-06-12T19:17:33.25+0300] [DEBUG] [26d57500-0b91-44b9-5057-44bc3e7a9103] [{'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:35'}] [portal-cf-site-semantic-service/controllers/site-entity-controller.js:35 - SiteEntityController:createAndActivate(language: en-us, siteId: 83eeee07-9c12-4db1-9b2d-1b6326c810b6, name: yosi)]
[2019-06-12T19:17:33.25+0300] [DEBUG] [26d57500-0b91-44b9-5057-44bc3e7a9103] [{'location': 'portal-cf-site-semantic-service/services/store/store-client.js:83'}] [portal-cf-site-semantic-service/services/store/store-client.js:83 - StoreClient:createSite(language: en-us, siteId: 83eeee07-9c12-4db1-9b2d-1b6326c810b6, name: yosi)]
[2019-06-12T19:17:33.25+0300] [DEBUG] [correlationId not found] [{'location': 'portal-cf-site-semantic-service/services/store/store-request-builder.js:152'}] [portal-cf-site-semantic-service/services/store/store-request-builder.js:152 - StoreRequestBuilder::StoreRequestBuilder() batch=[
    {
        "metadata": {
            "operation": "CREATE"
        },
        "cdm": {
            "_version": "3.0",
            "identification": {
                "id": "83eeee07-9c12-4db1-9b2d-1b6326c810b6",
                "title": "yosi",
                "entityType": "site"
            },
            "payload": {
                "config": {
                    "ushellConfig": {
                        "renderers": {
                            "fiori2": {
                                "componentData": {
                                    "config": {
                                        "enableActionModeFloatingButton": true,
                                        "enableActionModeMenuButton": true,
                                        "enableHideGroups": true,
                                        "enablePersonalization": true,
                                        "enableRecentActivity": false,
                                        "enableSearch": true,
                                        "enableSetLanguage": true,
                                        "enableTilesOpacity": false,
                                        "enableUserDefaultParameters": true,
                                        "enableUserThemes": true,
                                        "rootIntent": "Shell-home",
                                        "applications": {
                                            "Shell-home": {
                                                "enableEasyAccess": false
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "modulePaths": {
                            "sap.ushell.apps.menuPlugin": "/freestyle/sap/ushell/apps/menuPlugin"
                        },
                        "bootstrapPlugins": {
                            "menuplugin": {
                                "component": "sap.ushell.apps.menuPlugin"
                            }
                        },
                        "services": {
                            "AllMyApps": {
                                "config": {
                                    "enabled": true
                                }
                            }
                        }
                    }
                },
                "groupsOrder": [],
                "sap.cloud.portal": {
                    "_version": "1.2.0",
                    "locales": {
                        "available": [
                            "",
                            "en"
                        ]
                    },
                    "availablePageTemplates": [],
                    "config": {
                        "icon": "portalsitetemplates/flp/preview.png",
                        "theme.id": "sap_fiori_3",
                        "theme.active": [
                            "sap_fiori_3",
                            "sap_belize_hcb",
                            "sap_belize_hcw"
                        ],
                        "menu": {
                            "alignment": "left",
                            "availableDesktop": true,
                            "availableMobile": true,
                            "height": "s",
                            "version": "2.0",
                            "width": "full"
                        }
                    }
                }
            }
        }
    },
    {
        "metadata": {
            "operation": "CREATE"
        },
        "cdm": {
            "_version": "3.0",
            "identification": {
                "id": "957d4390-8d2d-11e9-83b3-75c761af1c76",
                "entityType": "menu",
                "title": "{{menuTitle}}"
            },
            "payload": {
                "entities": []
            },
            "texts": {}
        }
    },
    {
        "metadata": {
            "operation": "CREATE"
        },
        "cdm": {
            "_version": "3.0",
            "identification": {
                "id": "flp_pageapp",
                "entityType": "pageapp",
                "title": "{{title}}"
            },
            "payload": {
                "targetAppConfig": {
                    "sap.app": {
                        "crossNavigation": {
                            "inbounds": {
                                "Shell-home": {}
                            }
                        }
                    }
                },
                "pageConfig": {
                    "type": "flp",
                    "layout": {
                        "groupsOrder": []
                    }
                }
            },
            "texts": {
                "title": {
                    "value": {
                        "": "Launchpad"
                    }
                }
            }
        }
    },
    {
        "metadata": {
            "operation": "CREATE"
        },
        "cdm": {
            "_version": "3.0",
            "identification": {
                "id": "sap_everyone",
                "entityType": "role",
                "title": "{{cdm|identification|title}}",
                "description": "{{cdm|identification|description}}"
            },
            "payload": {
                "catalogs": [],
                "groups": [],
                "apps": []
            },
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "Everyone"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "Content assigned to this role is visible to all users"
                    }
                }
            }
        }
    },
    {
        "metadata": {
            "operation": "CREATE"
        },
        "cdm": {
            "_version": "3.0",
            "identification": {
                "id": "957d4391-8d2d-11e9-83b3-75c761af1c76",
                "entityType": "sitereferences"
            },
            "payload": {},
            "relations": []
        }
    }
]]

    1.14 EUXTEAMGUYM-1883, Use new filter to Destination Service (BFF) API

        1.14.1 general

   Goal: App Editor should only allow selection of destinations of type HTTP/S
·         Scope:
·         Use Destination Service (BFF) API that enable filtering by destination type
·         Call API with the desired filter value (HTTP) to fetch destinations for type HTTP/S - for technical details discuss with Yaron
·         Validate there are no regressions
·         Validate that the expected destinations list is returned (no destination of other type than HTTP)
·         Contact: Yaron
3PD

BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1883 
Design-Doc: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Filter+Destination+by+HTTP+type+only
Test-Scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/New+filter+to+Destination+Service+%28BFF%29+API+Test+Scope

[i500695@C02X632CJGH6:2019-06-13 13:48:13:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2019$ Ag bff
static-resources/infra/src/sap/ushell/services/designer/infra/services/designTime/DestinationService.js
14:                prod: "/bff/graphql"

        1.14.2 code
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/infra/src/sap/ushell/services/designer/infra/services/designTime/DestinationService.js
    class defenition

static-resources/infra/test/sap/ushell/services/designer/infra/unit/allTests.js|33| "sap/ushell/services/designer/infra/test/unit/services/designTime/DestinationService.qunit"
static-resources/contentManager/webapp/test/unit/controller/app/AppPropertiesContent.controller.qunit.js|4| 'sap/ushell/services/designer/infra/services/designTime/DestinationService'
static-resources/contentManager/webapp/test/unit/Component.qunit.js|11| function (Env, SemanticService, AssignmentPanelPublisher, RoleCollectionService, DestinationService, Component, sinon) {
static-resources/contentManager/webapp/controller/app/AppPropertiesContent.controller.js|8| 'sap/ushell/services/designer/infra/services/designTime/DestinationService'
        usage:
                loadDestinations: function () {
            return DestinationService.getDestinations();

$ resume_edit ~/work/vim_sessions/sap/destinations         },



        1.14.3 backend service, bff
[i500695@C02X632CJGH6:2019-06-13 16:16:09:~/work/SAP/git:]2004$ git clone https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-bff.git
Cloning into 'portal-cf-dt-bff'...
remote: Enumerating objects: 712, done.
remote: Total 712 (delta 0), reused 0 (delta 0), pack-reused 712
Receiving objects: 100% (712/712), 87.12 KiB | 304.00 KiB/s, done.
Resolving deltas: 100% (408/408), done.
[i500695@C02X632CJGH6:2019-06-13 16:16:18:~/work/SAP/git:]2005$ cd portal-cf-dt-bff/
[i500695@C02X632CJGH6:2019-06-13 16:16:27:~/work/SAP/git/portal-cf-dt-bff:]2006$ 

        1.14.4


    1.15 Shared content

        1.15.1  EUXTEAMGUYM-1805, shared content
https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1805
User Story
As an admin I would like to use the content entities created in my sub-account in different sites in order to make use of the content I create and avoid duplicating content pieces.
General \ Technical Information
 https://wiki.wdf.sap.corp/wiki/display/CPPortals/Manage+Sites+in+Site+Manager
Acceptance Criteria
Semantic API should support "crawling" (top-down: assignments in role \ catalog \ group...)
Semantic API should support "where used" (bottom-up: app to roles...)
Adjustments:
Content manager
Semantic service (client), Semantic service?
Content editor component
Toggle (KT from Yaron). New branch according to your needs
Migration?
Dependencies
Nili`s team - Gilady, Noam
Contacts
Orly

 https://wiki.wdf.sap.corp/wiki/x/qK9jfQ

 main changes for semantic:
 a.  batch operations
In [156]: pprint(json.dumps(batchreq))                                                                                                               
('{"BATCH": [{"metadata": {"operation": "CREATE"}, "cdm": {"_version": "3.0", '
 '"identification": {"id": "f5d20403-3eb1-460f-ae4e-7217df08112c", "title": '
 '"{{cdm|identification|title}}", "description": '
 '"{{cdm|identification|description}}", "entityType": "businessapp"}, '
 '"payload": {"targetAppConfig": {"_version": "1.13.0", "sap.app": '
 '{"crossNavigation": {"inbounds": {"GenericURL-f5d204033eb1460f": {}}}, '
 '"tags": {"keywords": []}}, "sap.integration": {"urlTemplateId": '
 '"templateGenericURL", "urlTemplateParams": {"url": "https://testapp.com", '
 '"query": {}}, "navMode": "inplace"}}, "visualizations": '
 '{"RandomURL-Launcher": {"target": {"inboundId": '
 '"GenericURL-f5d204033eb1460f"}, "vizType": "sap.ushell.StaticAppLauncher", '
 '"vizConfig": {"sap.ui": {"icons": {"icon": ""}}, "sap.app": {"subtitle": '
 '"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle}}", '
 '"info": '
 '"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"}, '
 '"sap.flp": {"target": {"type": "IBN", "inboundId": '
 '"GenericURL-f5d204033eb1460f", "parameters": {}}}}}}, "defaultViz": '
 '"RandomURL-Launcher"}, "texts": {"cdm|identification|title": {"type": '
 '"XTIT", "value": {"": "app1"}}, "cdm|identification|description": {"type": '
 '"XTIT", "value": {"": ""}}, '
 '"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle": '
 '{"type": "XTIT", "value": {"": ""}}, '
 '"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": '
 '{"type": "XTIT", "value": {"": ""}}}}}]}')

 for subaccount context pass id (e.g. 'subaccount) and also pass context ('subaccount' / 'site')  '"identification": {"id": "f5d20403-3eb1-460f-ae4e-7217df08112c", "title": '
 '"{{cdm|identification|title}}", "description": '


 b. Site activation
    b1. get dependant entities (those that point to the to be changed entity) for delete and update operations

    b2. perform operation. 

    b3. if b3 succeeds, update rt service of dependant entities and change

 c. other routes/apis
 get context ID and type?

        1.15.2 task breakdown
[Shared Content] - Semantic service – Server side @Izaq, Yosi
·         Scope:
Content manager – CRUD to support subaccount and site context in a generic way
 
design + test scope – 2PD
adjust all relevant APIs to support subaccount and site context in a generic way – 4PDs
    activate:
        NA for now (until activation design)
    batch.js
        before:
        router.post('/', validateRequest, (req, res, next) => {
            let batchRequests = req.body.BATCH;
            let contextId = req.query.contextId;
            logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: POST, batchRequests: %o contextId: %s', batchRequests, contextId);

            MainController.batchAndActivate(logger.getLoggerCtx(req), req.language, contextId, batchRequests, req.authInfo)
                .then(data => res.status(data.status).json(data.data), next);
        });
        after:
        router.post('/', validateRequest, (req, res, next) => {
            let batchRequests = req.body.BATCH;
            let contextId = req.query.contextId;
            let contextType = req.query.contextType ? req.query.contextType  : "SUBACCOUNT" ;
            logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: POST, batchRequests: %o contextId: %s contextType: %s', batchRequests, contextId, contextType);

            MainController.batchAndActivate(logger.getLoggerCtx(req), req.language, {contextId, contextType}, batchRequests, req.authInfo)
                .then(data => res.status(data.status).json(data.data), next);
        });
        all the rest, update the ones who use contextId

type: SUBACCOUNT
id: SUBACCOUNT
swagger – 1PD
    schemas
        raw schemas:
            to support both new and old create schemas1_0 and schemas 2_0 dir
            use oneOf operator for either ID only or ID+Type 
            ( ex:
"oneOf": [
                                {
                                    "$ref": "#/components/schemas/SingleEntity"
                                },
                                {
                                    "$ref": "#/components/schemas/EntityList"
                                }
                            ]
            )
            batch,
                add cdm.relations array in addition to payload
                add cdm.identification.contextType 
            cdm
                add identification.contextType 
            entity-list 
                add contextType as required field
            id
                add contextType (or settle for simple string w/o validation)
            single-entity
                add cdm.identification.contextType 
            theme-request
                no change
        API/Route schemas
            
            
        store-request-builder
           pass contextType parameter and set its value instead of "SITE"

toggle -> Env var FT_SHARED_CONTENT
    change manifest-dev.yml and manifest.yml accordingly
    If we decide that when contextType query param is missing it defaults to "SITE" then toggle is not required

tests -
api – 1PD
unit – 2PD
    keep the contextId only tests
    add {contextId, contextType} tests

e2e integration – 1PD
 
Adjust call to activate pending ‘Assctivations BLI’
Groups Order?!?!?
11PDs


        1.15.3 code
[i500695@C02X632CJGH6:2019-06-24 16:34:19:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2030$ Ag contextType
test/resources/store-vars.js
80:                    contextType: "SITE"
96:                        "contextType": "SITE"
229:                contextType: "SITE"
237:                contextType: "SITE"
295:                        "contextType": "site",

test/api/search.spec.js
125:            describe('contextType', () => {
126:                it('should return an error result (contextType is not a string)', sinonTest(function() {
128:                    bodyClone.metadata.context.contextType = 1;
133:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.body.metadata.context.contextType should be string'})
137:                it('should successfully return (no contextType)', sinonTest(function() {
140:                    delete bodyClone.metadata.context.contextType;

src/swagger/schemas/search-request.json
15:                        "contextType": {

src/services/store/store-request-builder.js
59:     * @returns search json {} for search post request body: {{metadata: {context: {contextType: string, id: *}, page: {number: number, size: number}}, match: Array, return: {"/cdm/texts/cdm|identification|description": {alias: string}, "/cdm/identification/id": {alias: string}, "/cdm/texts/cdm|identification|title": {alias: string}}}}
92:                    contextType: "SITE"
169:                contextType: "SITE"


[i500695@C02X632CJGH6:2019-06-24 16:35:34:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2031$ Ag contextId
test/unit/controllers/main-controller.spec.js
19:    let contextId = StoreVars.contextId;
32:            let promise = MainController.readAllContentRelatedEntities(loggerCtx, language, contextId, authInfo);
35:            sinon.assert.calledWith(clientReadAllStub, StoreVars.desiredEntityTypes, language, contextId, reqContext);
41:            let promise = MainController.readAllContentRelatedEntities(loggerCtx, language, contextId, authInfo);
51:            let promise = MainController.read(loggerCtx, entityType, language, contextId, entityId, authInfo);
54:            sinon.assert.calledWith(readOneStub, entityType, entityId, contextId, reqContext);
60:            let promise = MainController.read(loggerCtx, entityType, language, contextId, null, authInfo);
63:            sinon.assert.calledWith(readAllStub, entityType, language, contextId, reqContext);
69:            let promise = MainController.read(loggerCtx, entityType, language, contextId, entityId, authInfo);
76:            let promise = MainController.read(loggerCtx, entityType, language, contextId, null, authInfo);
86:            let promise = MainController.batchAndActivate(loggerCtx, language, contextId, batchRequests, authInfo);
89:            sinon.assert.calledWith(clientBatchStub, language, contextId, batchRequests, reqContext);
90:            sinon.assert.calledWith(activateStub, language, contextId, reqContext);
96:            let promise = MainController.batchAndActivate(loggerCtx, language, contextId, batchRequests, authInfo);
104:            let promise = MainController.batchAndActivate(loggerCtx, language, contextId, batchRequests, authInfo);

test/unit/controllers/app-entity-controller.spec.js
17:    let contextId = StoreVars.contextId;
48:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, entityId, true);
51:            sinon.assert.calledWith(readWithAppIdStub, language, contextId, loggerCtx, authInfo, entityId, true);
58:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, undefined, false, entityId);
62:            sinon.assert.calledWith(readWithoutAppIdStub, language, contextId, loggerCtx, authInfo, entityId, 'catalog');
69:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, undefined, false, undefined, entityId);
73:            sinon.assert.calledWith(readWithoutAppIdStub, language, contextId, loggerCtx, authInfo, entityId, 'group');
80:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, undefined, false);
84:            sinon.assert.calledWith(readWithoutAppIdStub, language, contextId, loggerCtx, authInfo, null, null);
90:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, entityId, true);
98:            let promise = AppEntityController.readApps(language, contextId, loggerCtx, authInfo, undefined, true);
107:            let promise = AppEntityController.readWithAppId(language, contextId, loggerCtx, authInfo, entityId, true);
110:            sinon.assert.calledWith(readAppAndRelatedEntitiesStub, language, contextId, reqContext, entityId);
116:            let promise = AppEntityController.readWithAppId(language, contextId, loggerCtx, authInfo, entityId, false);
119:            sinon.assert.calledWith(readOneStub, 'businessapp', entityId, contextId, reqContext);
125:            let promise = AppEntityController.readWithAppId(language, contextId, loggerCtx, authInfo, entityId, true);
132:            let promise = AppEntityController.readWithAppId(language, contextId, loggerCtx, authInfo, entityId, false);
142:            let promise = AppEntityController.readWithoutAppId(language, contextId, loggerCtx, authInfo, entityId, entityType);
145:            sinon.assert.calledWith(readAppsAssignedToEntityStub, language, contextId, reqContext, entityId, entityType);
151:            let promise = AppEntityController.readWithoutAppId(language, contextId, loggerCtx, authInfo, entityId, null);
154:            sinon.assert.calledWith(readAllStub, 'businessapp', language, contextId, reqContext);
160:            let promise = AppEntityController.readWithoutAppId(language, contextId, loggerCtx, authInfo, entityId, 'catalog');
167:            let promise = AppEntityController.readWithoutAppId(language, contextId, loggerCtx, authInfo, entityId, null);

test/unit/controllers/site-entity-controller.spec.js
23:    let contextId = StoreVars.contextId;
75:            let promise = SiteEntityController.createAndActivate(loggerCtx, language, contextId, authInfo, name);
78:            sinon.assert.calledWith(createSiteStub, language, contextId, reqContext, name);
79:            sinon.assert.calledWith(activateStub, loggerCtx, language, contextId, authInfo);
85:            let promise = SiteEntityController.createAndActivate(loggerCtx, language, contextId, authInfo, name);
93:            let promise = SiteEntityController.createAndActivate(loggerCtx, language, contextId, authInfo, name);
109:            let promise = SiteEntityController.updateThemeAndActivate(loggerCtx, language, contextId, StoreVars.themeReqUpdate["theme.id"], StoreVars.themeReqUpdate["theme.active"], authInfo);
115:            sinon.assert.calledWith(updateThemeStub, language, contextId, StoreVars.siteEntity, reqContext);
116:            sinon.assert.calledWith(activateStub, language, contextId, reqContext);
117:            sinon.assert.calledWith(readOneStub, 'site', contextId, contextId, reqContext);
129:            let promise = SiteEntityController.updateThemeAndActivate(loggerCtx, language, contextId, StoreVars.themeReqUpdate["theme.id"], StoreVars.themeReqUpdate["theme.active"], authInfo);
141:            let promise = SiteEntityController.updateThemeAndActivate(loggerCtx, language, contextId, StoreVars.themeReqUpdate["theme.id"], StoreVars.themeReqUpdate["theme.active"], authInfo);
148:            let promise = SiteEntityController.updateThemeAndActivate(loggerCtx, language, contextId, StoreVars.themeReqUpdate["theme.id"], StoreVars.themeReqUpdate["theme.active"], authInfo);
157:            let promise = SiteEntityController.activate(loggerCtx, language, contextId, authInfo);
160:            sinon.assert.calledWith(activateStub, language, contextId, reqContext);
166:            let promise = SiteEntityController.activate(loggerCtx, language, contextId, authInfo);
176:            let promise = SiteEntityController.delete(loggerCtx, language, contextId, authInfo);
179:            sinon.assert.calledWith(deleteStub, language, contextId, reqContext);
180:            sinon.assert.calledWith(deleteSiteStub, language, contextId, reqContext);
186:            let promise = SiteEntityController.delete(loggerCtx, language, contextId, authInfo);
194:            let promise = SiteEntityController.delete(loggerCtx, language, contextId, authInfo);

test/unit/routes/entities.spec.js
14:    let contextId = StoreVars.contextId;
37:                .get(`/semantic/entity?contextId=${contextId}`)
40:                .expect(() => sinon.assert.calledWithMatch(readStub, sinon.match.typeOf('object'), language, contextId, authInfo))
49:                .get(`/semantic/entity?contextId=${contextId}`)

test/unit/routes/businessapp.spec.js
16:    let contextId = StoreVars.contextId;
39:                .get(`/semantic/entity/businessapp?id=${entityId}&contextId=${contextId}`)
42:                .expect(() => sinon.assert.calledWithMatch(readAppsStub, language, contextId, sinon.match.typeOf('object'), authInfo, entityId, false, undefined, undefined))
51:                .get(`/semantic/entity/businessapp?id=${entityId}&contextId=${contextId}&expand=true`)
54:                .expect(() => sinon.assert.calledWithMatch(readAppsStub, language, contextId, sinon.match.typeOf('object'), authInfo, entityId, true, undefined, undefined))
63:                .get(`/semantic/entity/businessapp?contextId=${contextId}&catalogId=${validId}`)
66:                .expect(() => sinon.assert.calledWithMatch(readAppsStub, language, contextId, sinon.match.typeOf('object'), authInfo, undefined, false, validId, undefined))
75:                .get(`/semantic/entity/businessapp?contextId=${contextId}&groupId=${validId}`)
78:                .expect(() => sinon.assert.calledWithMatch(reareadAppsStubStub, language, contextId, sinon.match.typeOf('object'), authInfo, undefined, false, undefined, validId))
87:                .get(`/semantic/entity/businessapp?id=${entityId}&contextId=${contextId}`)
100:                .get(`/semantic/entity/businessapp/${entityId}?contextId=${contextId}`)
103:                .expect(() => sinon.assert.calledWithMatch(readWithAppIdStub, language, contextId, sinon.match.typeOf('object'), authInfo, entityId, false))
112:                .get(`/semantic/entity/businessapp/${entityId}?contextId=${contextId}&expand=true`)
115:                .expect(() => sinon.assert.calledWithMatch(readWithAppIdStub, language, contextId, sinon.match.typeOf('object'), authInfo, entityId, true))
124:                .get(`/semantic/entity/businessapp/${entityId}?contextId=${contextId}`)

test/unit/routes/batch.spec.js
38:            .post(`/semantic/batch?contextId=${id}`)
51:            .post(`/semantic/batch?contextId=${id}`)

test/api/businessapp.spec.js
44:                .get(`/semantic/entity/businessapp/?id=${queryId}&contextId=${validId}`)
53:                .get(`/semantic/entity/businessapp/?id=${queryId}&contextId=${validId}`)
63:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&expand=true`)
72:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&expand=true`)
81:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&expand=false`)
88:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&groupId=${groupId}`)
95:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&catalogId=${catalogId}`)
105:                        .get(`/semantic/entity/businessapp?id=&contextId=${validId}`)
112:                        .get(`/semantic/entity/businessapp?id=${veryLongId}&contextId=${validId}`)
119:                        .get(`/semantic/entity/businessapp?id=${moderatelyLongId}&contextId=${validId}`)
126:                        .get(`/semantic/entity/businessapp?id=${invalidId}&contextId=${validId}`)
135:                        .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&expand=`)
142:                        .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}&expand=yes`)
172:                    .get(`/semantic/entity/businessapp?id=${queryId}&contextId=${validId}`)
185:                    .get(`/semantic/entity/businessapp?id=${invalidId}&contextId=${queryId}`)
199:                .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}`)
208:                .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}`)
218:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&expand=true`)
227:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&expand=true`)
236:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&expand=false`)
243:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&groupId=${groupId}`)
250:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&catalogId=${catalogId}`)
257:                    .get(`/semantic/entity/businessapp/${paramId}?id=${validId}&contextId=${queryId}`)
265:                it('should return an error (missing contextId)', sinonTest(function() {
268:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
272:                it('should return an error (empty contextId)', sinonTest(function() {
274:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=`)
275:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
281:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=${veryLongId}`)
282:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
288:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=${moderatelyLongId}`)
289:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
293:                it('should return an error (invalid contextId)', sinonTest(function() {
295:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=${invalidId}`)
296:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})
304:                        .get(`/semantic/entity/businessapp/${veryLongId}?contextId=${queryId}`)
311:                        .get(`/semantic/entity/businessapp/${moderatelyLongId}?contextId=${queryId}`)
318:                        .get(`/semantic/entity/businessapp/${invalidId}?contextId=${queryId}`)
327:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&expand=1`)
334:                        .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}&expand=yes`)
364:                    .get(`/semantic/entity/businessapp/${paramId}?contextId=${queryId}`)
377:                    .get(`/semantic/entity/businessapp/${invalidId}?contextId=${queryId}`)
389:                .get(`/semantic/entity/businessapp?contextId=${queryId}`)
398:                .get(`/semantic/entity/businessapp?contextId=${queryId}`)
408:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=${catalogId}`)
417:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=${catalogId}`)
426:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${groupId}`)
435:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${groupId}`)
442:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&expand=true`)
449:                    .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${groupId}&catalogId=${catalogId}`)
457:                it('should return an error (missing contextId)', sinonTest(function() {
460:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
464:                it('should return an error (empty contextId)', sinonTest(function() {
466:                        .get('/semantic/entity/businessapp?contextId=')
467:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
473:                        .get(`/semantic/entity/businessapp?contextId=${veryLongId}`)
474:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
480:                        .get(`/semantic/entity/businessapp?contextId=${moderatelyLongId}`)
481:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
485:                it('should return an error (invalid contextId)', sinonTest(function() {
487:                        .get(`/semantic/entity/businessapp?contextId=${invalidId}`)
488:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})
496:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=`)
503:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=${veryLongId}`)
510:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=${moderatelyLongId}`)
517:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&catalogId=${invalidId}`)
526:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=`)
533:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${veryLongId}`)
540:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${moderatelyLongId}`)
547:                        .get(`/semantic/entity/businessapp?contextId=${queryId}&groupId=${invalidId}`)

test/unit/services/activation/activation-client.spec.js
21:    let contextId = StoreVars.contextId;
40:            ActivationClient.activate(language, contextId, reqContext);
41:            sinon.assert.calledWith(sendRequestStub, reqContext, `/activate/site?siteId=${contextId}`, contextId, language, "post");
48:            ActivationClient.delete(language, contextId, reqContext);
49:            sinon.assert.calledWith(sendRequestStub, reqContext, `/delete/site`, contextId, language, "delete");
60:            await ActivationClient.sendRequest(reqContext, path, contextId, language, 'post');
62:            sinon.assert.calledWith(getTokenStub, reqContext, {siteId: contextId, clientToken: StoreVars.mockToken});
74:            await ActivationClient.sendRequest(reqContext, path, contextId, null, 'delete');
76:            sinon.assert.calledWith(getTokenStub, reqContext, {siteId: contextId, clientToken: StoreVars.mockToken});
84:            let promise = ActivationClient.sendRequest(reqContext, path, contextId, null, 'get');
90:            let promise = ActivationClient.sendRequest(reqContext, path, contextId, null, 'post');

test/unit/services/store/store-client.spec.js
25:    const contextId = StoreVars.contextId;
100:            let readOnePromise = StoreClient.readOne(entityType, entityId, contextId, reqContext);
102:            sinon.assert.calledWith(getStub, reqContext, `/entity/${entityType}/id/${entityId}?context=${contextId}`);
108:            let readOnePromise = StoreClient.readOne(entityType, entityId, contextId, reqContext);
120:            let readAppAndRelatedEntitiesPromise = StoreClient.readAppAndRelatedEntities(language, contextId, reqContext, appId);
122:            sinon.assert.calledWith(buildAppRelatedEntitiesSearchStub, contextId, appId);
132:                StoreClient.readAppAndRelatedEntities(language, contextId, reqContext, appId);
143:            let readAppAndRelatedEntitiesPromise = StoreClient.readAppAndRelatedEntities(language, contextId, reqContext, appId);
144:            sinon.assert.calledWith(buildAppRelatedEntitiesSearchStub, contextId, appId);
155:            let readAppAndRelatedEntitiesPromise = StoreClient.readAppAndRelatedEntities(language, contextId, reqContext, appId);
156:            sinon.assert.calledWith(buildAppRelatedEntitiesSearchStub, contextId, appId);
170:            let readAppsAssignedToEntityPromise = StoreClient.readAppsAssignedToEntity(language, contextId, reqContext, entityId, entityType);
172:            sinon.assert.calledWith(buildAppsAssignedToEntitySearchStub, contextId, entityId, entityType);
183:                StoreClient.readAppsAssignedToEntity(language, contextId, reqContext, appId);
192:            let readAppsAssignedToEntityPromise = StoreClient.readAppsAssignedToEntity(language, contextId, reqContext, entityId, entityType);
193:            sinon.assert.calledWith(buildAppsAssignedToEntitySearchStub, contextId, entityId, entityType);
203:            let readAppsAssignedToEntityPromise = StoreClient.readAppsAssignedToEntity(language, contextId, reqContext, appId);
204:            sinon.assert.calledWith(buildAppsAssignedToEntitySearchStub, contextId, appId);
314:            let readAllPromise = StoreClient.readAll(StoreVars.desiredEntityTypes, language, contextId, reqContext);
316:            sinon.assert.calledWith(buildSearchStub, contextId, StoreVars.desiredEntityTypes, null, null, StoreVars.pageNum, StoreVars.pageSize);
326:            let readAllPromise = StoreClient.readAll(StoreVars.desiredEntityTypes, language, contextId, reqContext, 2, 100);
328:            sinon.assert.calledWith(buildSearchStub, contextId, StoreVars.desiredEntityTypes, null, null, 2, 100);
337:            let readAllPromise = StoreClient.readAll(entityType, language, contextId, reqContext);
338:            sinon.assert.calledWith(buildSearchStub, contextId, entityType, null, null, StoreVars.pageNum, StoreVars.pageSize);
347:                StoreClient.readAll(entityType, language, contextId, reqContext);
357:            let readAllPromise = StoreClient.readAll(entityType, language, contextId, reqContext);
358:            sinon.assert.calledWith(buildSearchStub, contextId, entityType, null, null, StoreVars.pageNum, StoreVars.pageSize);
469:            let batchPromise = StoreClient.batch(language, contextId, batchRequests, reqContext);
471:            sinon.assert.calledWith(preBatchStub, contextId, batchRequests, reqContext);
472:            sinon.assert.calledWith(buildBatchStub, contextId, batchRequests);
483:            let batchPromise = StoreClient.batch(language, contextId, batchRequests, reqContext);
485:            sinon.assert.calledWith(preBatchStub, contextId, batchRequests, reqContext);
486:            sinon.assert.calledWith(buildBatchStub, contextId, batchRequests);
497:            let batchPromise = StoreClient.batch(language, contextId, batchRequests, reqContext);
686:            let getEntitiesForPreBatchPromise = StoreClient.getEntitiesForPreBatch(contextId, reqContext);
688:            sinon.assert.calledWith(readOneStub, 'pageapp', "flp_pageapp", contextId, reqContext);
694:            let getEntitiesForPreBatchPromise = StoreClient.getEntitiesForPreBatch(contextId, reqContext);
695:            sinon.assert.calledWith(readOneStub, 'pageapp', "flp_pageapp", contextId, reqContext);
800:                let preBatchPromise = StoreClient.preBatch(contextId, createBatchReq, reqContext);
803:                sinon.assert.calledWith(getEntitiesForPreBatchStub, contextId, reqContext);
814:                let preBatchPromise = StoreClient.preBatch(contextId, createBatchReq, reqContext);
816:                sinon.assert.calledWith(getEntitiesForPreBatchStub, contextId, reqContext);
828:                let preBatchPromise = StoreClient.preBatch(contextId, createBatchReq, reqContext);
831:                sinon.assert.calledWith(getEntitiesForPreBatchStub, contextId, reqContext);
845:                let preBatchPromise = StoreClient.preBatch(contextId, createBatchReq, reqContext);
848:                sinon.assert.calledWith(getEntitiesForPreBatchStub, contextId, reqContext);
860:            let themeUpdatePromise = StoreClient.updateTheme(language, contextId, StoreVars.siteEntity, reqContext);
864:            sinon.assert.calledWith(buildUpdateThemeStub, contextId, StoreVars.siteEntity);
873:            let themeUpdatePromise = StoreClient.updateTheme(language, contextId, StoreVars.siteEntity, reqContext);
876:            sinon.assert.calledWith(buildUpdateThemeStub, contextId, StoreVars.siteEntity);

test/unit/services/store/store-request-builder.spec.js
15:    let contextId = StoreVars.contextId;
82:            StoreRequestBuilder.buildAppRelatedEntitiesSearch(contextId, entityId);
83:            sinon.assert.calledWith(buildSearchSpy, contextId, 'businessapp', match);
138:            StoreRequestBuilder.buildAppsAssignedToEntitySearch(contextId, entityId, entityType);
139:            sinon.assert.calledWith(buildSearchSpy, contextId, entityType, match, projection);
145:            let searchReq = StoreRequestBuilder.buildSearch(contextId, entityType);
150:            let searchReq = StoreRequestBuilder.buildSearch(contextId, StoreVars.desiredEntityTypes);
167:            let searchReq = StoreRequestBuilder.buildSearch(contextId, entityType, customMatch, customProjection);
318:                    id: contextId
322:            StoreRequestBuilder.buildSiteDeletionBatch(contextId);
323:            sinon.assert.calledWith(buildBatchSpy, contextId, batchRequests);
330:            let batchReq = StoreRequestBuilder.buildBatch(contextId, batchRequests);
337:            let batchReq = StoreRequestBuilder.buildUpdateTheme(contextId, StoreVars.siteEntity);

test/resources/store-vars.js
9:        this.contextId = "101";
79:                    id: this.contextId,
228:                id: this.contextId,
236:                id: this.contextId,

test/unit/routes/read.spec.js
16:    let contextId = StoreVars.contextId;
39:                .get(`/semantic/entity/${entityType}?id=${entityId}&contextId=${contextId}`)
42:                .expect(() => sinon.assert.calledWithMatch(readStub, sinon.match.typeOf('object'), entityType, language, contextId, entityId, authInfo))
51:                .get(`/semantic/entity/${entityType}?id=${entityId}&contextId=${contextId}`)
64:                .get(`/semantic/entity/${entityType}/${entityId}?contextId=${contextId}`)
67:                .expect(() => sinon.assert.calledWithMatch(readStub, sinon.match.typeOf('object'), entityType, language, contextId, entityId, authInfo))
76:                .get(`/semantic/entity/${entityType}/${entityId}?contextId=${contextId}`)

src/swagger/app/app-id.json
9:                "name": "contextId",

test/api/entities.spec.js
41:                .get(`/semantic/entity/?contextId=${queryId}`)
50:                .get(`/semantic/entity/?contextId=${queryId}`)
62:                        message: 'Error while validating request: request.query should have required property \'contextId\''
69:                    .get(`/semantic/entity/?contextId=`)
73:                        message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'
80:                    .get(`/semantic/entity/?contextId=${veryLongId}`)
84:                        message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'
91:                    .get(`/semantic/entity/?contextId=${moderatelyLongId}`)
95:                        message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'
102:                    .get(`/semantic/entity/?contextId=${invalidId}`)
106:                        message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'
135:                    .get(`/semantic/entity/?contextId=${queryId}`)
140:            it('should return an error without a message when getting invalid contextId', sinonTest(function () {
148:                    .get(`/semantic/entity/?contextId=${invalidId}`)

test/api/batch.spec.js
46:                .post(`/semantic/batch?contextId=${queryId}`)
59:                    .post(`/semantic/batch?contextId=${queryId}`)
71:                    .post(`/semantic/batch?contextId=${queryId}`)
83:                    .post(`/semantic/batch?contextId=${queryId}`)
95:                    .post(`/semantic/batch?contextId=${queryId}`)
107:                    .post(`/semantic/batch?contextId=${queryId}`)
121:                    .post(`/semantic/batch?contextId=${queryId}`)
135:                    .post(`/semantic/batch?contextId=${queryId}`)
147:                    .post(`/semantic/batch?contextId=${queryId}`)
159:                    .post(`/semantic/batch?contextId=${queryId}`)
171:                    .post(`/semantic/batch?contextId=${queryId}`)
183:                    .post(`/semantic/batch?contextId=${queryId}`)
195:                    .post(`/semantic/batch?contextId=${queryId}`)
207:                    .post(`/semantic/batch?contextId=${queryId}`)
219:                    .post(`/semantic/batch?contextId=${queryId}`)
233:                    .post(`/semantic/batch?contextId=${queryId}`)
247:            .post(`/semantic/batch?contextId=${queryId}`)
258:            .post(`/semantic/batch?contextId=${queryId}`)
270:            .post(`/semantic/batch?contextId=${queryId}`)
283:                .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
291:                .post('/semantic/batch?contextId=')
293:                .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
301:                .post(`/semantic/batch?contextId=${veryLongId}`)
303:                .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
310:                .post(`/semantic/batch?contextId=${moderatelyLongId}`)
312:                .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
320:                .post(`/semantic/batch?contextId=${invalidId}`)
322:                .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})
330:                .post(`/semantic/batch?contextId=${queryId}`)
339:                .post(`/semantic/batch?contextId=${queryId}`)
349:                .post(`/semantic/batch?contextId=${queryId}`)
359:                .post(`/semantic/batch?contextId=${queryId}`)
373:                .post(`/semantic/batch?contextId=${queryId}`)
383:                .post(`/semantic/batch?contextId=${queryId}`)
393:                .post(`/semantic/batch?contextId=${queryId}`)
411:                    .post(`/semantic/batch?contextId=${queryId}`)
424:                        .post(`/semantic/batch?contextId=${queryId}`)
436:                        .post(`/semantic/batch?contextId=${queryId}`)
448:                        .post(`/semantic/batch?contextId=${queryId}`)
460:                        .post(`/semantic/batch?contextId=${queryId}`)
472:                        .post(`/semantic/batch?contextId=${queryId}`)
486:                        .post(`/semantic/batch?contextId=${queryId}`)
520:                .post(`/semantic/batch?contextId=${queryId}`)
536:                .post(`/semantic/batch?contextId=${queryId}`)

test/api/read.spec.js
43:                .get(`/semantic/entity/${entityType}?contextId=${queryId}`)
53:                    .get(`/semantic/entity/role?contextId=${queryId}`)
62:                    .get(`/semantic/entity/catalog?contextId=${queryId}`)
71:                    .get(`/semantic/entity/group?contextId=${queryId}`)
80:                    .get(`/semantic/entity/urltemplate?contextId=${queryId}`)
89:                    .get(`/semantic/entity/viztype?contextId=${queryId}`)
98:                    .get(`/semantic/entity/pageapp?contextId=${queryId}`)
107:                    .get(`/semantic/entity/menu?contextId=${queryId}`)
116:                    .get(`/semantic/entity/invalid?contextId=${queryId}`)
127:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
133:                    .get(`/semantic/entity/${entityType}?contextId=`)
134:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
140:                    .get(`/semantic/entity/${entityType}?contextId=${veryLongId}`)
141:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'})
147:                    .get(`/semantic/entity/${entityType}?contextId=${moderatelyLongId}`)
148:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'})
154:                    .get(`/semantic/entity/${entityType}?contextId=${invalidId}`)
155:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})
183:                    .get(`/semantic/entity/${entityType}?contextId=${queryId}`)
196:                    .get(`/semantic/entity/${entityType}?contextId=${invalidId}`)
209:                .get(`/semantic/entity/${entityType}?id=${queryId}&contextId=${validId}`)
217:                    .get(`/semantic/entity/${entityType}?id=&contextId=${queryId}`)
224:                    .get(`/semantic/entity/${entityType}?contextId=${queryId}&id=${veryLongId}`)
231:                    .get(`/semantic/entity/${entityType}?contextId=${queryId}&id=${moderatelyLongId}`)
238:                    .get(`/semantic/entity/${entityType}?contextId=${queryId}&id=${invalidId}`)
250:                .get(`/semantic/entity/${entityType}/${paramId}?contextId=${queryId}`)
259:                .get(`/semantic/entity/${entityType}/${paramId}?contextId=${queryId}`)
269:                    .get(`/semantic/entity/role/${paramId}?contextId=${queryId}`)
278:                    .get(`/semantic/entity/catalog/${paramId}?contextId=${queryId}`)
287:                    .get(`/semantic/entity/group/${paramId}?contextId=${queryId}`)
296:                    .get(`/semantic/entity/urltemplate/${paramId}?contextId=${queryId}`)
305:                    .get(`/semantic/entity/viztype/${paramId}?contextId=${queryId}`)
314:                    .get(`/semantic/entity/pageapp/${paramId}?contextId=${queryId}`)
323:                    .get(`/semantic/entity/menu/${paramId}?contextId=${queryId}`)
332:                    .get(`/semantic/entity/invalid/${paramId}?contextId=${queryId}`)
341:                    .get(`/semantic/entity/${entityType}/${veryLongId}?contextId=${queryId}`)
348:                    .get(`/semantic/entity/${entityType}/${moderatelyLongId}?contextId=${queryId}`)
355:                    .get(`/semantic/entity/${entityType}/${invalidId}?contextId=${queryId}`)
365:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
371:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=`)
372:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
378:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=${veryLongId}`)
379:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'})
385:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=${moderatelyLongId}`)
386:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than ' + StoreVars.IdMaxLen + ' characters'})
392:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=${invalidId}`)
393:                    .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})
421:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=${queryId}`)
434:                    .get(`/semantic/entity/${entityType}/${paramId}?contextId=${invalidId}`)

src/swagger/app/app.json
9:                "name": "contextId",

test/api/theme.spec.js
47:                    .post(`/semantic/theme?contextId=${queryId}`)
59:                    .post(`/semantic/theme?contextId=${queryId}`)
92:                        .post(`/semantic/theme?contextId=${queryId}`)
108:                        .post(`/semantic/theme?contextId=${queryId}`)
120:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query should have required property \'contextId\''})
126:                        .post('/semantic/theme?contextId=')
128:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be shorter than 1 characters'})
134:                        .post(`/semantic/theme?contextId=${veryLongId}`)
136:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
142:                        .post(`/semantic/theme?contextId=${moderatelyLongId}`)
144:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should NOT be longer than '+StoreVars.IdMaxLen+' characters'})
150:                        .post(`/semantic/theme?contextId=${invalidId}`)
152:                        .expect({status: 400, originOfError: 'Unknown', message: 'Error while validating request: request.query.contextId should match pattern "^[\\w-:@+~./]+$"'})

src/swagger/read/entity-type-id.json
36:                "name": "contextId",

src/swagger/read/entity-type.json
27:                "name": "contextId",

src/swagger/theme/theme.json
9:                "name": "contextId",

src/swagger/batch/batch.json
9:                "name": "contextId",

src/swagger/entities/entities.json
9:        "name": "contextId",

src/controllers/app-entity-controller.js
21:    readApps(language, contextId, loggerCtx, authInfo, appId, expand, catalogId, groupId) {
23:            'AppEntityController:readApps(language: %s, contextId: %s, appId: %s, expand: %s, catalogId: %s, groupId: %s)',
24:            language, contextId, appId, expand, catalogId, groupId);
27:            return this.readWithAppId(language, contextId, loggerCtx, authInfo, appId, expand);
30:            return this.readWithoutAppId(language, contextId, loggerCtx, authInfo, entity.entityId, entity.entityType);
34:    readWithAppId(language, contextId, loggerCtx, authInfo, appId, expand) {
36:            'AppEntityController::readWithAppId(language: %s, contextId: %s, appId: %s, expand: %s)',
37:            language, contextId, appId, expand);
40:            return StoreClient.readAppAndRelatedEntities(language, contextId, {logger: loggerCtx, authInfo: authInfo}, appId);
42:            return StoreClient.readOne('businessapp', appId, contextId, {logger: loggerCtx, authInfo: authInfo});
46:    readWithoutAppId(language, contextId, loggerCtx, authInfo, entityId, entityType) {
48:            'AppEntityController::readWithoutAppId(language: %s, contextId: %s, entityId: %s, entityType: %s)',
49:            language, contextId, entityId, entityType);
52:            return StoreClient.readAppsAssignedToEntity(language, contextId, {logger: loggerCtx, authInfo: authInfo}, entityId, entityType);
54:            return StoreClient.readAll('businessapp', language, contextId, {logger: loggerCtx, authInfo: authInfo});

src/controllers/site-entity-controller.js
43:    async updateThemeAndActivate(loggerCtx, language, contextId, themeId, themeActiveList, authInfo) {
45:            'SiteEntityController:updateThemeAndActivate(language: %s, contextId: %s, themeId: %o, themeActiveList: %o)',
46:            language, contextId, themeId, themeActiveList);
48:        let entity = await StoreClient.readOne('site', contextId, contextId, {logger: loggerCtx, authInfo: authInfo});
52:        await StoreClient.updateTheme(language, contextId, entity.data.cdm, {logger: loggerCtx, authInfo: authInfo});
53:        return ActivationClient.activate(language, contextId, {logger: loggerCtx, authInfo: authInfo});
56:    activate(loggerCtx, language, contextId, authInfo) {
58:            'SiteEntityController:activate(language: %s, contextId: %s)',
59:            language, contextId);
61:        return ActivationClient.activate(language, contextId, {logger: loggerCtx, authInfo: authInfo});

src/controllers/main-controller.js
10:    readAllContentRelatedEntities(loggerCtx, language, contextId, authInfo) {
12:            'MainController:readAllContentRelatedEntities(language: %s, contextId: %s)', language, contextId);
16:        return StoreClient.readAll(desiredEntityTypes, language, contextId, {
22:    read(loggerCtx, entityType, language, contextId, entityId, authInfo) {
24:            'MainController:read(entityType: %s, language: %s, contextId: %s, entityId: %s)',
25:            entityType, language, contextId, entityId);
28:            return StoreClient.readOne(entityType, entityId, contextId, {logger: loggerCtx, authInfo: authInfo});
31:        return StoreClient.readAll(entityType, language, contextId, {logger: loggerCtx, authInfo: authInfo});
34:    async batchAndActivate(loggerCtx, language, contextId, batchRequests, authInfo) {
36:            'MainController:batchAndActivate(language: %s, contextId: %s, batchRequests: %o)',
37:            language, contextId, batchRequests);
39:        await StoreClient.batch(language, contextId, batchRequests, {logger: loggerCtx, authInfo: authInfo});
40:        return ActivationClient.activate(language, contextId, {logger: loggerCtx, authInfo: authInfo});

src/routes/batch.js
22:        let contextId = req.query.contextId;
23:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: POST, batchRequests: %o contextId: %s', batchRequests, contextId);
25:        MainController.batchAndActivate(logger.getLoggerCtx(req), req.language, contextId, batchRequests, req.authInfo)

src/routes/businessapp.js
43:        let contextId = req.query.contextId;
44:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: GET, appId: %s contextId: %s', appId, contextId);
46:        AppEntityController.readApps(req.language, contextId, logger.getLoggerCtx(req), req.authInfo, appId, req.expand, req.query.catalogId, req.query.groupId)
52:        let contextId = req.query.contextId;
53:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: GET, appId: %s contextId: %s', appId, contextId);
55:        AppEntityController.readWithAppId(req.language, contextId, logger.getLoggerCtx(req), req.authInfo, appId, req.expand)

src/routes/theme.js
23:        let contextId = req.query.contextId;
25:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: POST, themeId: %o themeActiveList: %o contextId: %s', themeId, themeActiveList, contextId);
27:        SiteController.updateThemeAndActivate(logger.getLoggerCtx(req), req.language, contextId, themeId, themeActiveList, req.authInfo)

src/routes/entities.js
21:        let contextId = req.query.contextId;
22:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: GET, contextId: %s', contextId);
24:        MainController.readAllContentRelatedEntities(logger.getLoggerCtx(req), req.language, contextId, req.authInfo)

src/routes/read.js
23:        let contextId = req.query.contextId;
24:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: GET, entityId: %s entityType: %s contextId: %s', entityId, entityType, contextId);
26:        MainController.read(logger.getLoggerCtx(req), entityType, req.language, contextId, entityId, req.authInfo)
33:        let contextId = req.query.contextId;
34:        logger.logRequestMessage(logger.getLoggerCtx(req), 'debug', 'method: GET, entityId: %s entityType: %s contextId: %s', entityId, entityType, contextId);
36:        MainController.read(logger.getLoggerCtx(req), entityType, req.language, contextId, entityId, req.authInfo)

src/services/store/store-request-builder.js
11:    buildAppRelatedEntitiesSearch(contextId, appId) {
23:        return this.buildSearch(contextId, 'businessapp', match);
40:    buildAppsAssignedToEntitySearch(contextId, entityId, entityType) {
48:        return this.buildSearch(contextId, entityType, match, projection);
53:     * @param contextId, aka site ID.
61:    buildSearch(contextId, entityTypes, customMatch, customProjection, pageNum = 1, pageSize = 10000) {
63:        logger.logMessage('debug', 'StoreRequestBuilder::buildSearch() called with params. contextId=%s, ' +
65:            contextId, entityTypes, customMatch, customProjection, pageNum, pageSize);
91:                    id: contextId,
165:    buildBatch(contextId, batchRequests) {
168:                id: contextId,
175:    buildUpdateTheme(contextId, cdm) {
183:        return this.buildBatch(contextId, updateThemeRequest);

src/services/store/store-client.js
24:    readOne(entityType, entityId, contextId, reqContext) {
26:            'StoreClient:readOne(entityType: %s, entityId: %s, contextId: %s)',
27:            entityType, entityId, contextId);
29:        return this.get(reqContext, `/entity/${entityType}/id/${entityId}?context=${contextId}`);
32:    readAppAndRelatedEntities(language, contextId, reqContext, appId) {
34:            'StoreClient:readAppAndRelatedEntities(language: %s, contextId: %s, appId: %s)',
35:            language, contextId, appId);
37:        return this.post(language, '/search', StoreRequestBuilder.buildAppRelatedEntitiesSearch(contextId, appId), reqContext)
41:    readAppsAssignedToEntity(language, contextId, reqContext, entityId, entityType) {
43:            'StoreClient:readAppsAssignedToEntity(language: %s, contextId: %s, entityId: %s, entityType: %s)',
44:            language, contextId, entityId, entityType);
46:        return this.post(language, '/search', StoreRequestBuilder.buildAppsAssignedToEntitySearch(contextId, entityId, entityType), reqContext)
59:    readAll(entityTypes, language, contextId, reqContext, pageNum = 1, pageSize = 10000) {
61:            'StoreClient:search(entityTypes: %s, language: %s, contextId: %s)',
62:            entityTypes, language, contextId);
65:            StoreRequestBuilder.buildSearch(contextId, entityTypes, null, null, pageNum, pageSize),
130:     * @param contextId, aka site id
134:    async getEntitiesForPreBatch(contextId, reqContext) {
138:        logger.logRequestMessage(reqContext.logger, 'debug', 'getEntitiesForPreBatch() method: GET, entityId: %s entityType: %s contextId: %s', this.flpPageID, localEntityType, contextId);
140:        let flpPage = await this.readOne(localEntityType, this.flpPageID, contextId, reqContext);
201:     * @param contextId, aka site id
206:    async preBatch(contextId, batchRequests, reqContext) {
209:        let flpPage = await this.getEntitiesForPreBatch(contextId, reqContext);
217:    async batch(language, contextId, batchRequests, reqContext) {
219:            'StoreClient:batch(language: %s, contextId: %s, batchRequests: %o)', language, contextId, batchRequests);
226:            await this.preBatch(contextId, batchRequests, reqContext);
232:        return this.post(language, '/entities', StoreRequestBuilder.buildBatch(contextId, batchRequests), reqContext);
235:    async updateTheme(language, contextId, siteEntityCdm, reqContext) {
237:            'StoreClient:updateTheme(language: %s, contextId: %s, siteEntityCdm: %o)', language, contextId, siteEntityCdm);
239:        return this.post(language, '/entities', StoreRequestBuilder.buildUpdateTheme(contextId, siteEntityCdm), reqContext);

        1.15.4 links
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Shared+Content+Semantic+Service+-+Design+Document

https://wiki.wdf.sap.corp/wiki/display/CPPortals/Shared+Content+Semantic+Service+-+Test+Scope


        1.15.5 diagrams

            1.15.5.1 websequence

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "Activation Service" as Activation
participant "CDM Store" as Store
Client->Semantic: /semantic/<endpoint> (contextId, contextType?, JWT token) 
activate Semantic
note right of Semantic
Check if sites query activate can be avoided
end note
deactivate Semantic
alt activation required
Semantic->Store: Referencing-Sites query
Store->Semantic: Referencing-Sites 
else no activation required
end
Semantic->Store:  CRUD (contextId, contextType)
note left of Store
When both contextId and contextType values are 'SUBACCOUNT'
- CRUD in context of sub-account
end note
activate Store
note right of Store
Perform CRUD operation in provided context
end note
Store->Semantic: Operation OK
deactivate Store
alt activation required
Semantic->Activation: activate Referencing-Site1
Activation->Semantic: activation ok
Semantic->Activation: activate Referencing-Site2
Activation->Semantic: activation ok
note right of Semantic
and ...
end note
Semantic->Activation: activate Referencing-SiteN
Activation->Semantic: activation ok
else no activation required
end
Semantic->Client: Operation OK


            1.15.5.2 graphviz
[i500695@C02X632CJGH6:2019-07-02 14:13:12:~/work/code/graphviz/sap:]2051$ cat sharedContent.dot 
digraph d {
 Site1 [label="Site1" fillcolor=red shape=circle fontcolor=blue]
 Site2 [label="Site2" fillcolor=red shape=circle fontcolor=blue]
 Site3 [label="Site3" fillcolor=red shape=circle fontcolor=blue]
 SiteRef1 [label="Site-References1" fillcolor=red shape=ellipse fontcolor=blue]
 SiteRef2 [label="Site-References2" fillcolor=red shape=ellipse fontcolor=blue]
 SiteRef3 [label="Site-References3" fillcolor=red shape=ellipse fontcolor=blue]
 Role1 [label="Role1" fillcolor=red shape=ellipse fontcolor=red]
 Role2 [label="Role2" fillcolor=red shape=ellipse fontcolor=red]
 Catalog1 [label="Catalog1" fillcolor=red shape=ellipse fontcolor=green]
 Catalog2 [label="Catalog2" fillcolor=red shape=ellipse fontcolor=green]
 Group1 [label="Group1" fillcolor=red shape=ellipse fontcolor=green]
 Group2 [label="Group2" fillcolor=red shape=ellipse fontcolor=green]
 BussinessApp1 [label="BussinessApp1" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp2 [label="BussinessApp2" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp3 [label="BussinessApp3" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp4 [label="BussinessApp4" fillcolor=red shape=ellipse fontcolor=red]
 Site1 -> {SiteRef1} [style = dotted label="contextId"] 
 Site2 -> {SiteRef2} [style = dotted label="contextId"]
 Site3 -> {SiteRef3} [style = dotted label="contextId"]
 SiteRef1 -> {Role1} [label="relation"]
 SiteRef2 -> {Role1} [label="relation"]
 SiteRef3 -> {Role2} [label="relation"]
 Role1 -> {BussinessApp1} [label="relation"]
 Role1 -> {BussinessApp2} [label="relation"]
 Role2 -> {BussinessApp2} [label="relation"]
 Role2 -> {BussinessApp3} [label="relation"]
 Role2 -> {BussinessApp4} [label="relation"]
 Catalog1 -> {BussinessApp1} [label="relation"]
 Catalog1 -> {BussinessApp2} [label="relation"]
 Group2 -> {BussinessApp3} [label="relation"]
 Group2 -> {BussinessApp4} [label="relation"]
}

$ dot -T png -O sharedContent.dot  && open sharedContent.dot.png


            1.15.5.3 Design 

                1.15.5.3.1 APIs

                    1.15.5.3.1.1 /semantic/batch	post	
contextId only → default contextType = 'SITE', or

contextId+ contextType = 'SUBACCOUNT'


200, batch ops completed successfully	



                    1.15.5.3.1.2 /semantic/entity/	get	
contextId only → default contextType = 'SITE', or

contextId+ contextType = 'SUBACCOUNT'


200, get entities successful	

                    1.15.5.3.1.3 /semantic/entity/{entityType}	get	
contextId only → default contextType = 'SITE', or

contextId+ contextType = 'SUBACCOUNT'


                    1.15.5.3.1.4 200, read entity	
/semantic/search	post	
contextId only → default contextType = 'SITE', or

contextId+ contextType = 'SUBACCOUNT'


200, search successful	

                    1.15.5.3.1.5

                1.15.5.3.2 implementation notes
Additional Points Raised during DR:
Support several CONTEXT types during same batch operations. FUTURE
When Deleting Role or App. 
Before role delete check which site-references contain this role and delete the reference for that role
Before app delete check which roles/groups/catalogs contains a relation to this app and then delete the relations to that app. ACCEPTED
Optimize the queries to CDM. Will be implemented if performance measurements will show that it is required. PENDING
For delete it is required to query effected site IDs before the operation (since after delete its not possible to query) 
For update it is required to query effected site IDs after the operation (since the update may change the effected sites)
The two queries results will be joined w/o duplicates
ACCEPTED
Activation failures error handling in a separate BLI. FUTURE
site-references id. Should Set site-references id to match the site id?
pros: in some contexts it may be "easier" to get from a site to its site references

cons: redundant since a query for enclosing context ID will yield the site ID.

ACCEPTEDset site-references id to a hard coded string as it is currently.


All effectd routes, optional query param contextType
All controllers check if contextType then pass it else set to 'SITE'
All clients that change drastically, separate to siteCtxtClient and globCtxtClient

                1.15.5.3.3
            1.15.5.4
        1.15.4 Pull requests, PRs
Shared Content preparation: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/230
Env Var toggle: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/237/files
Activation API to get site IDs: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/244/files
Activation fixes: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/252
Add site-references to Swagger: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/245/files
graph search API (for getting site entities from SUBACCOUNT context)
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/246, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/251
Delete site + assets:
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/247, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/255/files


        1.15.5 related BLIs
-> Delete site
https://sapjira.wdf.sap.corp/browse/EUXTEAMNILI-3377

->

        1.15.6 delete site and its assets

            1.15.6.1 integration test logs

                1.15.6.1.1 Wed Jul 31 15:29:23 IDT 2019
Test flow:
Use SaaS account registered to site-manager yosi03 PaaS account.
Deploy to Paas:
[i500695@C02X632CJGH6:2019-07-31 15:31:35:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2062$ cf t
api endpoint:   https://api.cf.sap.hana.ondemand.com
api version:    2.137.0
user:           I500695
org:            site-manager
space:          yosi03
$ cf push -f manifest-dev.yml 

Go to SaaS site-manager: https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/sitedirectory#Site-Directory
create site, add a page, add an image (asset) to page.
delete site, verify log of portal-cf-assets-service :
   2019-07-31T15:26:01.68+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.681Z asst:s3Objectstore Number of objects to remove:  1
   2019-07-31T15:26:01.68+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.682Z asst:s3Objectstore *** DELETING: [ { Key: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg/master/headerimagewithlinks.jpg' } ]


                    1.15.6.1.1.1 portal-cf-assets-service:
   2019-07-31T15:25:22.36+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31.157fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.368Z","written_ts":612927118099017,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/common/service-request.js:174 - sendRequest - Request to https://malware-scanner.cfapps.sap.hana.ondemand.com/scan succeeded, response data: { malwareDetected: false,\n  encryptedContentDetected: false,\n  scanSize: 78908,\n  mimeType: 'application/octet-stream',\n  SHA256:\n   '1f4ecfb2d5c21b9b7c53e3eb65d2794c6087b0197edd0f1677360d272db189dc' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/common/service-request.js:174"}}
   2019-07-31T15:25:22.36+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.368Z","written_ts":612927118373798,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/security/malware-scan.js:61 - scanMalwareFile - scanResponse: { malwareDetected: false,\n  encryptedContentDetected: false,\n  scanSize: 78908,\n  mimeType: 'application/octet-stream',\n  SHA256:\n   '1f4ecfb2d5c21b9b7c53e3eb65d2794c6087b0197edd0f1677360d272db189dc' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/security/malware-scan.js:61"}}
   2019-07-31T15:25:22.36+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.368Z","written_ts":612927118512077,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/security/malware-scan.js:76 - checkForMalware - No malware in file","type":"log","custom_fields":{"location":"portal-cf-shared-lib/security/malware-scan.js:76"}}
   2019-07-31T15:25:22.36+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.368Z","written_ts":612927118628112,"level":"debug","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"asst:add:117 - \"malware detection finished {\"context\":\"b86b22a0-bbae-4687-897c-e86fd30c47f7\",\"assetId\":\"headerimagewithlinks.jpg\",\"locale\":\"master\"}","type":"log","custom_fields":{"location":"asst:add:117"}}
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.376Z","written_ts":612927126542429,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/logs/audit-logger.js:91 - configurationChange - conf { configurationChange:\n   { type: 'Add asset',\n     id:\n      { key:\n         'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg' } },\n  attribute:\n   { name:\n      'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg',\n     locale: 'master',\n     old: 'Old',\n     new: 'New' },\n  by: 'yosi.izaq@sap.com',\n  tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:91"}}
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.377Z","written_ts":612927127017802,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/logs/audit-logger.js:111 - configurationChange - message ConfigurationChangeMessage {\n  _content:\n   { object:\n      { type: 'Add asset',\n        id:\n         { key:\n            'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg' } },\n     attributes:\n      [ { name:\n           'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg',\n          locale: 'master',\n          old: 'Old',\n          new: 'New' } ],\n     user: 'yosi.izaq@sap.com',\n     tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50' },\n  _transport: ConsoleTransport {},\n  _endpoint: 'configuration-changes' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:111"}}
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT { object:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT    { type: 'Add asset',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT      id:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT       { key:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT          'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg' } },
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   attributes:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT    [ { name:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT         'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        locale: 'master',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        old: 'Old',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        new: 'New' } ],
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   user: 'yosi.izaq@sap.com',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   uuid: '2ABE9568138BFA02A75EE0C21B3E914C',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   time: '2019-07-31T12:25:22.377Z' }
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT { object:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT    { type: 'Add asset',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT      id:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT       { key:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT          'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg' } },
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   attributes:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT    [ { name:
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT         'b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        locale: 'master',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        old: 'Old',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT        new: 'New' } ],
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   user: 'yosi.izaq@sap.com',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   uuid: 'E0998344FC2B3DF94474B1CE11926F7E',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   time: '2019-07-31T12:25:22.377Z',
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT   success: true }
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.377Z","written_ts":612927127560175,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"portal-cf-shared-lib/logs/audit-logger.js:74 - _printStatus - logSuccess, successfully printed to the audit log","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:74"}}
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.377Z","written_ts":612927127692157,"level":"info","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","msg":"asst:add:49 - /upload - OK 83e8bcf2-a53b-4fd8-b96e-67391c0f6a50 {\"context\":\"b86b22a0-bbae-4687-897c-e86fd30c47f7\",\"assetId\":\"headerimagewithlinks.jpg\",\"locale\":\"master\"}","type":"log","custom_fields":{"location":"asst:add:49"}}
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:22 GMT compression no compression: size below threshold
   2019-07-31T15:25:22.37+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:22.128Z","written_ts":612926878171509,"request_id":"f5ebfaff-9a09-4edc-4676-eb30134d27e1","request_size_b":"79141","type":"request","request":"/assets/upload","method":"POST","remote_user":"-","direction":"IN","x_forwarded_for":"redacted","response_time_ms":250,"referer":"-","correlation_id":"a8a63e7c-aa3d-463c-ab9d-c53438a8707f","tenant_id":"-","level":"info","remote_host":"redacted","remote_port":"redacted","protocol":"HTTP/1.1","remote_ip":"redacted","request_received_at":"2019-07-31T12:25:22.128Z","response_status":200,"response_size_b":-1,"response_content_type":"application/json; charset=utf-8","response_sent_at":"2019-07-31T12:25:22.378Z"}
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router dispatching GET /assets/portal_api/is_alive
   2019-07-31T15:25:24.75+0300 [RTR/4] OUT portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com - [2019-07-31T12:25:24.751+0000] "GET /assets/portal_api/is_alive HTTP/1.1" 200 0 22 "https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/portal/preview_site?siteId=b86b22a0-bbae-4687-897c-e86fd30c47f7&siteMode=draftPreview&sap-language=" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0" "-" "10.0.75.221:61042" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"78864377-f6fe-4c02-79c7-122f6811cb7f" response_time:0.00512346 app_id:"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe" app_index:"0" x_correlationid:"0d78e490-b37b-4263-634e-7e838d01af8d" tenantid:"-" x_b3_traceid:"0c31ab686d312823" x_b3_spanid:"0c31ab686d312823" x_b3_parentspanid:"-" b3:"0c31ab686d312823-0c31ab686d312823"
   2019-07-31T15:25:24.75+0300 [RTR/4] OUT 
   2019-07-31T15:25:24.95+0300 [RTR/9] OUT portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com - [2019-07-31T12:25:24.840+0000] "GET /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg HTTP/1.1" 200 0 78707 "https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/portal/preview_site?siteId=b86b22a0-bbae-4687-897c-e86fd30c47f7&siteMode=draftPreview&sap-language=" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0" "-" "10.0.75.221:61042" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"5b2327d2-d9c3-4036-7259-c0f8f1d7e558" response_time:0.112469367 app_id:"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe" app_index:"0" x_correlationid:"285188f5-55e7-496b-631f-f6852f95092a" tenantid:"-" x_b3_traceid:"9ca9f25c63a6eea6" x_b3_spanid:"9ca9f25c63a6eea6" x_b3_parentspanid:"-" b3:"9ca9f25c63a6eea6-9ca9f25c63a6eea6"
   2019-07-31T15:25:24.95+0300 [RTR/9] OUT 
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router query  : /assets/portal_api/is_alive
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router expressInit  : /assets/portal_api/is_alive
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router <anonymous>  : /assets/portal_api/is_alive
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:24.755Z","written_ts":612929505529155,"level":"info","correlation_id":"0d78e490-b37b-4263-634e-7e838d01af8d","tenant_id":"-","request_id":"78864377-f6fe-4c02-79c7-122f6811cb7f","msg":"portal-cf-shared-lib/common/portal-api.js:44 - isAlive","type":"log","custom_fields":{"location":"portal-cf-shared-lib/common/portal-api.js:44"}}
   2019-07-31T15:25:24.75+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:24.755Z","written_ts":612929504964496,"request_id":"78864377-f6fe-4c02-79c7-122f6811cb7f","request_size_b":-1,"type":"request","request":"/assets/portal_api/is_alive","method":"GET","remote_user":"-","direction":"IN","x_forwarded_for":"redacted","response_time_ms":1,"referer":"redacted","correlation_id":"0d78e490-b37b-4263-634e-7e838d01af8d","tenant_id":"-","level":"info","remote_host":"redacted","remote_port":"redacted","protocol":"HTTP/1.1","remote_ip":"redacted","request_received_at":"2019-07-31T12:25:24.755Z","response_status":200,"response_size_b":"22","response_content_type":"application/json; charset=utf-8","response_sent_at":"2019-07-31T12:25:24.756Z"}
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router dispatching GET /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router query  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router expressInit  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router <anonymous>  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router initialize  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router authenticate  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.842Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Configuration (note: clientsecret might be contained but is not traced): {
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "tenantmode": "dedicated",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "sburl": "https://internal-xsuaa.authentication.sap.hana.ondemand.com",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "clientid": "sb-portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "xsappname": "portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "url": "https://site-manager.authentication.sap.hana.ondemand.com",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "uaadomain": "authentication.sap.hana.ondemand.com",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "trustedclientidsuffix": "|portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "verificationkey": "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "apiurl": "https://api.authentication.sap.hana.ondemand.com",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "identityzone": "site-manager",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "identityzoneid": "c87ade1a-5a38-4801-bc19-a15062b7c501",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "tenantid": "c87ade1a-5a38-4801-bc19-a15062b7c501"
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT }
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.842Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Identity zone of token issuer: site-manager-saas
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.842Z xssec:keycache Looking for key with keyID: "key-id-1" in cache.
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.842Z xssec:keycache Key with keyID: "key-id-1" found in cache. Returning key "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----".
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.842Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Client Id "sb-58359416-2a58-426e-90e7-b0a7b4868935!b4219|portal-cf-service-yosi03-i500695!b4219" of the access token allows consumption by the Client Id "sb-portal-cf-service-yosi03-i500695!b4219" of the current application
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Application received a token of grant type "user_token".
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Obtained logon name: yosi.izaq@sap.com
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained given name: Yosi
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained family name: Izaq
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained email: yosi.izaq@sap.com
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Obtained attributes: {}
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Obtained attributes: no additional authentication attributes in JWT token available.
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT Obtained subdomain: site-manager-saas
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained serviceinstanceid: 58359416-2a58-426e-90e7-b0a7b4868935
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained origin: ldap
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:25:24.843Z xssec:securitycontext Obtained scopes: [
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "xs_authorization.read",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "portal-cf-service-yosi03-i500695!b4219.SuperAdmin",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "openid",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "portal-cf-service-yosi03-i500695!b4219.ThemeAdmin",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "xs_authorization.write",
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT     "uaa.user"
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT ]
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router jsonParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT body-parser:json skip empty body
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router cookieParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router compression  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router <anonymous>  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT express:router urlencodedParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT body-parser:urlencoded skip empty body
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.844Z asst:get * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.844Z asst:get ------------------------------------------ G E T  A S S E T ----------------------------------------
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.844Z asst:get * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.844Z asst:get ==> Parameters: tenant=83e8bcf2-a53b-4fd8-b96e-67391c0f6a50 ID=headerimagewithlinks.jpg CTX=b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:24.845Z","written_ts":612929594999693,"level":"info","correlation_id":"285188f5-55e7-496b-631f-f6852f95092a","tenant_id":"-","request_id":"5b2327d2-d9c3-4036-7259-c0f8f1d7e558","msg":"get:21 - /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg","type":"log","custom_fields":{"location":"get:21"}}
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.845Z asst:get getAssetService ==> GET 83e8bcf2-a53b-4fd8-b96e-67391c0f6a50:b86b22a0-bbae-4687-897c-e86fd30c47f7:headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.845Z asst:localCache getAssetPath: 83e8bcf2-a53b-4fd8-b96e-67391c0f6a50 : b86b22a0-bbae-4687-897c-e86fd30c47f7 : headerimagewithlinks.jpg
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.845Z asst:localCache ******************** local cache *************************
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.845Z asst:localCache fileName: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg/master/headerimagewithlinks.jpg'
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.846Z asst:localCache hashedFileName: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg'
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.847Z asst:localCache localFileName: '/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg'
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.847Z asst:localCache localMd5FileName '/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg.md5'
   2019-07-31T15:25:24.84+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.847Z asst:localCache *********************************************************
   2019-07-31T15:25:24.88+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.884Z asst:localCache Asset not in local cache. Retrieving it
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.924Z asst:get localFileName ==> '/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg'
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.925Z asst:get image/jpeg
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.925Z asst:get sending file '/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg'
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT send stat "/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg"
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT send pipe "/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg"
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT send accept ranges
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT send modified Wed, 31 Jul 2019 12:25:24 GMT
   2019-07-31T15:25:24.92+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT send etag W/"13373-16c47fe02b9"
   2019-07-31T15:25:24.95+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT compression image/jpeg not compressible
   2019-07-31T15:25:24.95+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:25:24 GMT compression no compression: filtered
   2019-07-31T15:25:24.95+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:25:24.952Z asst:get Sent: '/home/vcap/tmp/83e8bcf2-a53b-4fd8-b96e-67391c0f6a50_b86b22a0-bbae-4687-897c-e86fd30c47f7_headerimagewithlinks.jpg_master_headerimagewithlinks.jpg'
   2019-07-31T15:25:24.95+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:25:24.841Z","written_ts":612929591536864,"request_id":"5b2327d2-d9c3-4036-7259-c0f8f1d7e558","request_size_b":-1,"type":"request","request":"/assets/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg","method":"GET","remote_user":"-","direction":"IN","x_forwarded_for":"redacted","response_time_ms":111,"referer":"redacted","correlation_id":"285188f5-55e7-496b-631f-f6852f95092a","tenant_id":"-","level":"info","remote_host":"redacted","remote_port":"redacted","protocol":"HTTP/1.1","remote_ip":"redacted","request_received_at":"2019-07-31T12:25:24.841Z","response_status":200,"response_size_b":78707,"response_content_type":"image/jpeg","response_sent_at":"2019-07-31T12:25:24.952Z"}
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router dispatching DELETE /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.71+0300 [RTR/10] OUT portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com - [2019-07-31T12:26:01.638+0000] "DELETE /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7 HTTP/1.1" 200 2 41 "-" "axios/0.18.1" "-" "10.0.75.221:61042" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"504a4cf3-5188-4d74-4df6-0bb3cab61261" response_time:0.072321417 app_id:"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe" app_index:"0" x_correlationid:"cb487125-570b-4f57-5036-47d0b403904c" tenantid:"-" x_b3_traceid:"b9673c037d60b231" x_b3_spanid:"b9673c037d60b231" x_b3_parentspanid:"-" b3:"b9673c037d60b231-b9673c037d60b231"
   2019-07-31T15:26:01.71+0300 [RTR/10] OUT 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router query  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router expressInit  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router <anonymous>  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router initialize  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router authenticate  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.640Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Configuration (note: clientsecret might be contained but is not traced): {
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "tenantmode": "dedicated",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "sburl": "https://internal-xsuaa.authentication.sap.hana.ondemand.com",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "clientid": "sb-portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "xsappname": "portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "url": "https://site-manager.authentication.sap.hana.ondemand.com",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "uaadomain": "authentication.sap.hana.ondemand.com",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "trustedclientidsuffix": "|portal-cf-service-yosi03-i500695!b4219",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "verificationkey": "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "apiurl": "https://api.authentication.sap.hana.ondemand.com",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "identityzone": "site-manager",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "identityzoneid": "c87ade1a-5a38-4801-bc19-a15062b7c501",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "tenantid": "c87ade1a-5a38-4801-bc19-a15062b7c501"
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT }
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Identity zone of token issuer: site-manager-saas
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:keycache Looking for key with keyID: "key-id-1" in cache.
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:keycache Key with keyID: "key-id-1" found in cache. Returning key "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx/jN5v1mp/TVn9nTQoYVIUfCsUDHa3Upr5tDZC7mzlTrN2PnwruzyS7w1Jd+StqwW4/vn87ua2YlZzU8Ob0jR4lbOPCKaHIi0kyNtJXQvQ7LZPG8epQLbx0IIP/WLVVVtB8bL5OWuHma3pUnibbmATtbOh5LksQ2zLMngEjUF52JQyzTpjoQkahp0BNe/drlAqO253keiY63FL6belKjJGmSqdnotSXxB2ym+HQ0ShaNvTFLEvi2+ObkyjGWgFpQaoCcGq0KX0y0mPzOvdFsNT+rBFdkHiK+Jl638Sbim1z9fItFbH9hiVwY37R9rLtH1YKi3PuATMjf/DJ7mUluDQIDAQAB-----END PUBLIC KEY-----".
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Client Id "sb-58359416-2a58-426e-90e7-b0a7b4868935!b4219|portal-cf-service-yosi03-i500695!b4219" of the access token allows consumption by the Client Id "sb-portal-cf-service-yosi03-i500695!b4219" of the current application
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Application received a token of grant type "user_token".
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Obtained logon name: yosi.izaq@sap.com
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext Obtained given name: Yosi
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext Obtained family name: Izaq
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.641Z xssec:securitycontext Obtained email: yosi.izaq@sap.com
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Obtained attributes: {}
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Obtained attributes: no additional authentication attributes in JWT token available.
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT Obtained subdomain: site-manager-saas
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext Obtained serviceinstanceid: 58359416-2a58-426e-90e7-b0a7b4868935
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext Obtained origin: ldap
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.642Z xssec:securitycontext Obtained scopes: [
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "xs_authorization.read",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "portal-cf-service-yosi03-i500695!b4219.SuperAdmin",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "openid",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "portal-cf-service-yosi03-i500695!b4219.ThemeAdmin",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "xs_authorization.write",
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT     "uaa.user"
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT ]
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router jsonParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:json content-type "application/json; charset=utf-8"
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:json content-encoding "identity"
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:json read body
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:json parse body
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:json parse json
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router cookieParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router compression  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router <anonymous>  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT express:router urlencodedParser  : /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT body-parser:urlencoded body already parsed
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.643Z asst:delTenant >>>>>>>> D E L E T E  C O N T E X T
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.644Z","written_ts":612966393900451,"level":"info","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","msg":"asst:del:17 - /assets/context DEL b86b22a0-bbae-4687-897c-e86fd30c47f7 83e8bcf2-a53b-4fd8-b96e-67391c0f6a50","type":"log","custom_fields":{"location":"asst:del:17"}}
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT 2019-07-31T12:26:01.644Z xssec:securitycontext 
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT The access token contains no additional authentication attributes.
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.644Z asst:s3Objectstore Removing Objects:  83e8bcf2-a53b-4fd8-b96e-67391c0f6a50/b86b22a0-bbae-4687-897c-e86fd30c47f7
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.647Z","written_ts":612966397755036,"level":"info","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","msg":"portal-cf-shared-lib/logs/audit-logger.js:91 - configurationChange - conf { configurationChange:\n   { type: 'Delete asset',\n     id: { key: 'b86b22a0-bbae-4687-897c-e86fd30c47f7' } },\n  attribute:\n   { name: 'b86b22a0-bbae-4687-897c-e86fd30c47f7',\n     old: 'Old',\n     new: 'New' },\n  by: 'yosi.izaq@sap.com',\n  tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:91"}}
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.648Z","written_ts":612966398146582,"level":"info","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","msg":"portal-cf-shared-lib/logs/audit-logger.js:111 - configurationChange - message ConfigurationChangeMessage {\n  _content:\n   { object:\n      { type: 'Delete asset',\n        id: { key: 'b86b22a0-bbae-4687-897c-e86fd30c47f7' } },\n     attributes:\n      [ { name: 'b86b22a0-bbae-4687-897c-e86fd30c47f7',\n          old: 'Old',\n          new: 'New' } ],\n     user: 'yosi.izaq@sap.com',\n     tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50' },\n  _transport: ConsoleTransport {},\n  _endpoint: 'configuration-changes' }","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:111"}}
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT { object:
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT    { type: 'Delete asset',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT      id: { key: 'b86b22a0-bbae-4687-897c-e86fd30c47f7' } },
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT   attributes:
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT    [ { name: 'b86b22a0-bbae-4687-897c-e86fd30c47f7',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT        old: 'Old',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT        new: 'New' } ],
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT   user: 'yosi.izaq@sap.com',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT   tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT   uuid: 'CC226E17F23CE82501B8E4AD95395B5D',
   2019-07-31T15:26:01.64+0300 [APP/PROC/WEB/0] OUT   time: '2019-07-31T12:26:01.648Z' }
   2019-07-31T15:26:01.68+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.681Z asst:s3Objectstore Number of objects to remove:  1
   2019-07-31T15:26:01.68+0300 [APP/PROC/WEB/0] ERR 2019-07-31T12:26:01.682Z asst:s3Objectstore *** DELETING: [ { Key: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50/b86b22a0-bbae-4687-897c-e86fd30c47f7/headerimagewithlinks.jpg/master/headerimagewithlinks.jpg' } ]
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT { object:
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT    { type: 'Delete asset',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT      id: { key: 'b86b22a0-bbae-4687-897c-e86fd30c47f7' } },
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   attributes:
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT    [ { name: 'b86b22a0-bbae-4687-897c-e86fd30c47f7',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT        old: 'Old',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT        new: 'New' } ],
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   user: 'yosi.izaq@sap.com',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   tenant: '83e8bcf2-a53b-4fd8-b96e-67391c0f6a50',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   uuid: '7F19237CD90F1E14DA912413FA44D1B8',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   time: '2019-07-31T12:26:01.708Z',
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT   success: true }
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.708Z","written_ts":612966458823202,"level":"info","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","msg":"portal-cf-shared-lib/logs/audit-logger.js:74 - _printStatus - logSuccess, successfully printed to the audit log","type":"log","custom_fields":{"location":"portal-cf-shared-lib/logs/audit-logger.js:74"}}
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.709Z","written_ts":612966458978366,"level":"info","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","msg":"asst:del:27 - /assets/context DEL b86b22a0-bbae-4687-897c-e86fd30c47f7 83e8bcf2-a53b-4fd8-b96e-67391c0f6a50 - deleted","type":"log","custom_fields":{"location":"asst:del:27"}}
   2019-07-31T15:26:01.70+0300 [APP/PROC/WEB/0] ERR Wed, 31 Jul 2019 12:26:01 GMT compression no compression: size below threshold
   2019-07-31T15:26:01.71+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"65e039f7-c6ad-4bcd-bc8a-cd5e31d137fe","component_name":"portal-cf-assets","component_instance":0,"layer":"[NODEJS]","organization_id":"-","organization_name":"-","space_name":"yosi03","space_id":"9896fbd5-7bb5-4a27-abe3-604e40d9f394","container_id":"10.0.75.221","logger":"nodejs-logger","source_instance":0,"written_at":"2019-07-31T12:26:01.640Z","written_ts":612966390286614,"request_id":"504a4cf3-5188-4d74-4df6-0bb3cab61261","request_size_b":"2","type":"request","request":"/assets/b86b22a0-bbae-4687-897c-e86fd30c47f7","method":"DELETE","remote_user":"-","direction":"IN","x_forwarded_for":"redacted","response_time_ms":69,"referer":"-","correlation_id":"cb487125-570b-4f57-5036-47d0b403904c","tenant_id":"-","level":"info","remote_host":"redacted","remote_port":"redacted","protocol":"HTTP/1.1","remote_ip":"redacted","request_received_at":"2019-07-31T12:26:01.640Z","response_status":200,"response_size_b":"41","response_content_type":"application/json; charset=utf-8","response_sent_at":"2019-07-31T12:26:01.709Z"}

                    1.15.6.1.1.2 portal-cf-site-semantic-service
019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:107'} b'portal-cf-shared-lib/utils/technical-token.js:107 - isTechnicalUser'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:20'} b'portal-cf-shared-lib/utils/technical-token.js:20 - initClientId'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:34'} b'portal-cf-shared-lib/utils/technical-token.js:34 - initIdentityZoneId'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:111'} b'portal-cf-shared-lib/utils/technical-token.js:111 - isTechnicalUser - client id sb-portal-cf-service-yosi03-i500695!b4219, tenant id c87ade1a-5a38-4801-bc19-a15062b7c501 '
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:115'} b'portal-cf-shared-lib/utils/technical-token.js:115 - isTechnicalUser - false'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/config/config-utils.js:31'} b'portal-cf-shared-lib/utils/config/config-utils.js:31 - isClpScenario'
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/routes/index.js:67'} b'portal-cf-site-semantic-service/routes/index.js:67 - tokenValidation: token identified as valid user token'
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/routes/sites.js:46'} b'portal-cf-site-semantic-service/routes/sites.js:46 - method: DELETE, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7'
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:72'} b'portal-cf-site-semantic-service/controllers/site-entity-controller.js:72 - SiteEntityController:delete(language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7)'
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/services/activation/activation-client.js:28'} b'portal-cf-site-semantic-service/services/activation/activation-client.js:28 - ActivationClient:delete(language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7)'
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/services/activation/activation-client.js:36'} b'portal-cf-site-semantic-service/services/activation/activation-client.js:36 - ActivationClient:sendRequest(path: /delete/site, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7, language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6, method: delete)'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:64'} b'portal-cf-shared-lib/utils/technical-token.js:64 - requestAccessToken - Reqs token at https://site-manager.authentication.sap.hana.ondemand.com/oauth/token'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:73'} b'portal-cf-shared-lib/utils/technical-token.js:73 - requestAccessToken - add additional attributes SECURE'
2019-07-31T15:26:01.08+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:60'} b"portal-cf-shared-lib/common/service-request.js:60 - sendRequest - serviceAbsoluteUrl https://site-manager.authentication.sap.hana.ondemand.com/oauth/token, serviceRelativeUrl null, serviceMethod post, options 'SECURE'"
2019-07-31T15:26:01.08+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:142'} b"portal-cf-shared-lib/common/service-request.js:142 - sendRequest - Service request url https://site-manager.authentication.sap.hana.ondemand.com/oauth/token, serviceMethod post, formData 'SECURE', requestOptions 'SECURE'"
2019-07-31T15:26:01.12+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:30'} b'portal-cf-shared-lib/common/service-request.js:30 - DEBUG performRequest succeeded to url https://site-manager.authentication.sap.hana.ondemand.com/oauth/token'
2019-07-31T15:26:01.12+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:172'} b'portal-cf-shared-lib/common/service-request.js:172 - sendRequest - Request to https://site-manager.authentication.sap.hana.ondemand.com/oauth/token succeeded'
2019-07-31T15:26:01.12+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:60'} b"portal-cf-shared-lib/common/service-request.js:60 - sendRequest - serviceAbsoluteUrl null, serviceRelativeUrl /activation_service/delete/site, serviceMethod delete, options 'SECURE'"
2019-07-31T15:26:01.12+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:142'} b"portal-cf-shared-lib/common/service-request.js:142 - sendRequest - Service request url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/activation_service/delete/site, serviceMethod delete, formData 'SECURE', requestOptions 'SECURE'"
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:30'} b'portal-cf-shared-lib/common/service-request.js:30 - DEBUG performRequest succeeded to url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/activation_service/delete/site'
2019-07-31T15:26:01.61+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:172'} b'portal-cf-shared-lib/common/service-request.js:172 - sendRequest - Request to https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/activation_service/delete/site succeeded'
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/services/store/store-client.js:101'} b'portal-cf-site-semantic-service/services/store/store-client.js:101 - StoreClient:deleteSite(language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7)'
2019-07-31T15:26:01.61+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:64'} b'portal-cf-shared-lib/utils/technical-token.js:64 - requestAccessToken - Reqs token at https://site-manager.authentication.sap.hana.ondemand.com/oauth/token'
2019-07-31T15:26:01.61+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/utils/technical-token.js:73'} b'portal-cf-shared-lib/utils/technical-token.js:73 - requestAccessToken - add additional attributes SECURE'
2019-07-31T15:26:01.61+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:60'} b"portal-cf-shared-lib/common/service-request.js:60 - sendRequest - serviceAbsoluteUrl https://site-manager.authentication.sap.hana.ondemand.com/oauth/token, serviceRelativeUrl null, serviceMethod post, options 'SECURE'"
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:142'} b"portal-cf-shared-lib/common/service-request.js:142 - sendRequest - Service request url https://site-manager.authentication.sap.hana.ondemand.com/oauth/token, serviceMethod post, formData 'SECURE', requestOptions 'SECURE'"
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/services/assets/assets-client.js:19'} b'portal-cf-site-semantic-service/services/assets/assets-client.js:19 - AssetsClient:delete(siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7)'
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/services/assets/assets-client.js:25'} b'portal-cf-site-semantic-service/services/assets/assets-client.js:25 - AssetsClient:sendRequest(path: /b86b22a0-bbae-4687-897c-e86fd30c47f7, siteId: b86b22a0-bbae-4687-897c-e86fd30c47f7, method: delete)'
2019-07-31T15:26:01.61+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:60'} b"portal-cf-shared-lib/common/service-request.js:60 - sendRequest - serviceAbsoluteUrl null, serviceRelativeUrl /assets/b86b22a0-bbae-4687-897c-e86fd30c47f7, serviceMethod delete, options 'SECURE'"
2019-07-31T15:26:01.61+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:142'} b"portal-cf-shared-lib/common/service-request.js:142 - sendRequest - Service request url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/assets/b86b22a0-bbae-4687-897c-e86fd30c47f7, serviceMethod delete, formData 'SECURE', requestOptions 'SECURE'"
2019-07-31T15:26:01.71+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:30'} b'portal-cf-shared-lib/common/service-request.js:30 - DEBUG performRequest succeeded to url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/assets/b86b22a0-bbae-4687-897c-e86fd30c47f7'
2019-07-31T15:26:01.71+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:172'} b'portal-cf-shared-lib/common/service-request.js:172 - sendRequest - Request to https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/assets/b86b22a0-bbae-4687-897c-e86fd30c47f7 succeeded'
2019-07-31T15:26:01.75+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:30'} b'portal-cf-shared-lib/common/service-request.js:30 - DEBUG performRequest succeeded to url https://site-manager.authentication.sap.hana.ondemand.com/oauth/token'
2019-07-31T15:26:01.75+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:172'} b'portal-cf-shared-lib/common/service-request.js:172 - sendRequest - Request to https://site-manager.authentication.sap.hana.ondemand.com/oauth/token succeeded'
2019-07-31T15:26:01.75+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:60'} b"portal-cf-shared-lib/common/service-request.js:60 - sendRequest - serviceAbsoluteUrl null, serviceRelativeUrl /cdm_store_service/cdm/entities, serviceMethod post, options 'SECURE'"
2019-07-31T15:26:01.75+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:142'} b"portal-cf-shared-lib/common/service-request.js:142 - sendRequest - Service request url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities, serviceMethod post, formData 'SECURE', requestOptions 'SECURE'"
2019-07-31T15:26:01.86+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:30'} b'portal-cf-shared-lib/common/service-request.js:30 - DEBUG performRequest succeeded to url https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities'
2019-07-31T15:26:01.86+0300 INFO cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-shared-lib/common/service-request.js:172'} b'portal-cf-shared-lib/common/service-request.js:172 - sendRequest - Request to https://portal-service-yosi03-i500695.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities succeeded'
2019-07-31T15:26:01.86+0300 DEBUG cb487125-570b-4f57-5036-47d0b403904c {'location': 'portal-cf-site-semantic-service/controllers/site-entity-controller.js:84'} b"portal-cf-site-semantic-service/controllers/site-entity-controller.js:84 - SiteEntityController:delete() Delete site promises results:  [ { status: 'resolved',\n    result: \n     { status: 200,\n       statusText: 'OK',\n       headers: [Object],\n       config: [Object],\n       request: [Object],\n       data: '' } },\n  { status: 'resolved',\n    result: \n     { status: 200,\n       statusText: 'OK',\n       headers: [Object],\n       config: [Object],\n       request: [Object],\n       data: [Object] } } ]"
                    1.15.6.1.1.3
                1.15.6.1.2

            1.15.6.2

        1.15.7 assets-client w/ map of functions
'use strict';

const TechnicalToken = require('../../utils/technical-token');
const cfLogger = require('portal-cf-shared-lib/src/logs/cf-logger');

const HttpClient = require('../../utils/http-client');
const AssetsServiceError = require('../../errors/assets-service-error');
const InternalServerError = require('../../errors/internal-server-error');

const logger = cfLogger.initLogger('portal-cf-site-semantic-service/services/assets/assets-client.js');

class AssetsClient {

    constructor() {
        logger.logMessage('info', 'AssetsClient::constructor()');
        this.basePath = '/assets';
        this.supportedHttpMethods = {
            'delete': async (httpClient, path) => {
                return await httpClient.delete(path);
            },
            'post': async (httpClient, path) => {
                return await httpClient.post(path);
            }
        };
    }

    delete(siteId, reqContext) {
        logger.logRequestMessage(reqContext.logger, 'debug', 'AssetsClient:delete(siteId: %s)', siteId);

        return this.sendRequest(reqContext, '/' + siteId, siteId, 'delete');
    }

    async sendRequest(reqContext, path, siteId, method) {
        logger.logRequestMessage(reqContext.logger, 'debug',
            'AssetsClient:sendRequest(path: %s, siteId: %s, method: %s)',
            path, siteId, method);

        if (!this.supportedHttpMethods.hasOwnProperty(method)) {
            logger.logRequestMessage(reqContext.logger, "error", `Assets service method: ${method} is not supported`);
            return Promise.reject(new InternalServerError('Assets service method not supported'));
        }

        try {
            let userToken = (reqContext.authInfo && typeof reqContext.authInfo.getAppToken === 'function' ? reqContext.authInfo.getAppToken() : null);
            let token = await TechnicalToken.getToken(reqContext, {siteId: siteId, clientToken: userToken});
            let httpClient = new HttpClient(reqContext.logger, token)
                .addHeader("Content-Type", "application/json; charset=utf-8");

            let httpResult = this.supportedHttpMethods[method](httpClient, this.basePath + path);
            logger.logRequestMessage(reqContext.logger, 'debug', 'AssetsClient:sendRequest() http request result: ', httpResult);
            return httpResult;
        } catch (err) {
            logger.logRequestMessage(reqContext.logger, 'error', 'AssetsClient::sendRequest() - Failed to send request');
            return Promise.reject(new AssetsServiceError(err.response));
        }
    }
}

module.exports = new AssetsClient();

        1.15.8 Tests
Prep:
If you want to see the new admin shell (for shared content) use the following URL:
https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory?sharedContent=true#Site-Directory
https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/sitedirectory?sharedContent=true#Site-Directory

If you want to see the Content Manager in sub-account level:
https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory?sharedContent=true#Content-Manage
https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/sitedirectory?sharedContent=true#Content-Manage

Update provider space, run init job
https://gkei066861portalcf.jaas-gcp.cloud.sap.corp/view/DEVELOPER%20CORNER/job/deployOrchestratorDevJobs/job/INIT-ENVIRONMENT/build?delay=0sec
 	ORG	site-manager
 	SPACE	yosi03

In case of failures b/c of memory issues increase memory to 512M

First, run sanity, https://wiki.wdf.sap.corp/wiki/display/CPPortals/Manual+FLP+Acceptance+test

Then, set sharedContent to true

cat ~/temp/app
portal-cf-rt-approuter
portal-cf-service-broker 
portal-cf-site-configuration-db 
portal-cf-site-service-db  
portal-cf-design-time-service
portal-cf-dt-approuter 
portal-cf-service-broker-db
portal-cf-freestyle-semantic-service 
portal-cf-activation-service 
portal-cf-site-service 
portal-cf-assets 
portal-cf-provisioning-service
portal-cf-site-semantic-service
portal-cf-site-configuration
portal-cf-cdm-store-service

[i500695@C02X632CJGH6:2019-08-01
11:42:10:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2039$ for app in $(cat ~/temp/app); do echo "setting sharedContent true for $app"; cf set-env $app sharedContent true; done
11:42:10:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2039$ for app in $(cat ~/temp/app); do echo "restage $app"; cf restage $app ; done



        1.15.9 entities search APIs
GET /semantic/site_entity/{entityType}

POST /semantic/search - search in pre postgress DB (non shared content) 

POST /semantic/search/graph -  search in shared content postgress DB.
contextId - site ID 
{
    "direction": "DOWN",
    "level":10,
    "search": {
      "metadata":{
          "context":{
            "id": "SUB_ACCOUNT",
            "contextType": "SUB_ACCOUNT"
          }
      },
      "return":
      { "/cdm/identification/id": { "alias": "id" },
          "/cdm/identification/entityType": { "alias": "type" },
          "/cdm/texts/cdm|identification|title": { "alias": "title" },
          "/cdm/texts/cdm|identification|description": { "alias": "description" },
          "/cdm/texts": {"alias": "texts"},
          "/cdm/payload/targetAppConfig/sap.app/crossNavigation/inbounds": {"alias": "inbounds"}
      },
      "match":
      [{ "/cdm/identification/entityType": "businessapp" }]
    }
}

        1.15.10 [Shared Content] Cleanup of 'sharedContent' "toggle" dependencies - semantic-service
		https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2091

        1.15.11
    1.16 Federation

        1.16.1 EUXTEAMGUYM-1886, [Federation] Snapshot and Cherry-pick 

            1.16.1.1 general
jira: https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=3073&view=detail&selectedIssue=EUXTEAMGUYM-2076
bli: https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-1886
CDM design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+CDM+Store+Support+Cherry+picked+Entities
Federation
[Federation] Snapshot and Cherry-pick - design + impl Server
 
T08 A + B
 
Design – 4PDs
Create cherry pick
Cherry life cycle
Provider life cycle
Get all provider cherry picked entities
 
 
 New create cherry pick API – 5PDs
Tenant id (consumer)
Provider id (cf)
Schema adjustment (support relations of business app / new entity????) @Dagan, Saar
tests
 
Unpick – (delete cherry pick entity) / effected sites (validate)
 
 
@Blechman, Dean / @Izaq, Yosi / @Lipmanovich, Boris / @Asaf Maman
18PDs

Goal: Admin can cherry-pick content entities from the Content Providers snapshot in his sub-account, through Site Manager
Scope:
Design and implementation
Support Cherry-pick of content entities so that they are available for assignment
create the reference of a cherry-picked item
Yahalom, Amir - finalize the variant model\format
Moskovich, Guy elaborate on the technical requirement
cover resolving of cherry-picked entity
Contact: Tsafrir
Dependencies:

            1.16.1.2 diagrams

                1.16.1.2.1 websequence


participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: /semantic/provider/<Provider ID>/snapshot (contextId, contextType, tenant ID, JWT token) 
Semantic->Store:  /search (get snapshot entities, contextType='snapshot', contextId=<providerID>)
activate Store
note left of Store
Search for all entities of provider snapshot
end note
alt get snapshot entities
Store->Semantic: Operation OK
    Semantic->Store:  /cdm_store_service/cdm/entities/extensions (targetContextType='SNAPSHOT', contextId=<provider ID>)
    alt get sub-account cherry-picked entities
        Store->Semantic: Operation OK 
        deactivate Store
        activate Semantic
        note left of Semantic
        merge cherry-picked entities information with snapshot entities list
        end note
        Semantic->Client: Operation OK, [ { ...{snapshot entity}, CherryPickID: <Cherry pick entity ID> }, ...]
        deactivate Semantic
    else get sub-account cherry-picked entities failed
        Store->Semantic: Operation FAILED
        Semantic->Client: Operation FAILED
    end
else get snapshot entities failed
    Store->Semantic: Operation FAILED
    Semantic->Client: Operation FAILED
end

participant "Client Side \nSite Directory" as Client
participant "Semantic Service" as Semantic
participant "CDM Store" as Store
Client->Semantic: /semantic/provider/<Provider ID>/snapshot (contextId, contextType, tenant ID, JWT token) 
Semantic->Store:  /search (get snapshot entities, contextType='snapshot', contextId=<providerID>)
activate Store
note left of Store
Search for all entities of provider snapshot
end note
alt get snapshot entities
Store->Semantic: Operation OK
    Semantic->Store:  CDMStoreClient.getCherryPickedEntities(providerTenantId, providerId)
    alt get sub-account cherry-picked entities
        Store->Semantic: Operation OK 
        deactivate Store
        activate Semantic
        note left of Semantic
        merge cherry-picked entities information with snapshot entities list
        end note
        Semantic->Client: Operation OK, [ { ...{snapshot entity}, CherryPickID: <Cherry pick entity ID> }, ...]
        deactivate Semantic
    else get sub-account cherry-picked entities failed
        Store->Semantic: Operation FAILED
        Semantic->Client: Operation FAILED
    end
else get snapshot entities failed
    Store->Semantic: Operation FAILED
    Semantic->Client: Operation FAILED
end





            1.16.1.3 pull requests
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/276
don't send request if tenants are empty, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/273
added swagger to the explore API, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/269
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/263

fix providerId /semantic/entity/provider/${providerId}/snapshot?tenantId=${veryLongId}, https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/268
EUXTEAMGUYM-1886 implement cherrypick logic in snapshot - commented out , https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/265
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/264

            1.16.1.4
        1.16.2
    1.17 takt9 2019.t9 1909

        1.17.1[Eng] Cross teams integration test  https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2065
Cross_teams_integration_test

            1.17.1 Possible Automation Flow:
Supper admin user:

Call createSite(name)
Call addApplication X5 (Static URL, WD-ABAP, SAP-GUI, UI5 – Apollo, Filtered)
Call addPage X2
Call addMenu with the structure
Call addRole X2 (R1, R2)
Call assignAppsToRole(Static URL, WD-ABAP -> Role1)
Call assignAppsToRole(Static URL Filtered -> Role2)
Call assignAppsToRole(SAP-GUI, UI5 – Apollo -> Everyone)
Call addPageToRole
Call createGroup
Call assignAppsToGroup (all apps -> group)
Call assignPageToRole (Page1 -> Role1)   
Call assignPageToRole (Page2_Filtered -> Role2)   
Assign Role1 -> endUser
endUser:

Access Site with endUser (Veri5?)
Check that the filtered content is not available
Check runtime works for all available applications *problem – SSO currently not working, need to resolve this in T5 in order to support the automations
Supper admin user:

Delete the 3 roles (Role1, Role2, Everyone)
Call DeleteSite
 
Future enhancements:

Call subscribe at the beginning of the flow, unsubscribe at the end of the flow
Test languages/Themes
Use SSO/Super Domain (if it’s not possible to begin with)

            1.17.2 tasks
These are the subtasks:
 
Create 2 tests one for freestyle and cFLP
Freestyle – @Kozel, Reuven
                                                               i.      Refactor functions inside spec to utils/assert file
                                                             ii.      Mocha-steps
cFLP – @Aharoni, Nitai @Kozel, Reuven
                                                               i.      On a new branch cFLP_automation
                                                             ii.      Create new spec for cFLP
                                                           iii.      Work by this flow - https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2065
                                                           iv.      Generify src files (building blocks functions)
                                                             v.      Create newApps Jsons according to (app-technologies content)
                                                           vi.      Create a new Jenkins file for cFLP job
Provide App-Technologies content @Izaq, Yosi @Avrahami, Olga
                                                               i.      Static URL
                                                             ii.      WD-ABAP
                                                           iii.      SAP-GUI
                                                           iv.      UI5 – Apollo
                                                             v.      Filtered
Create a runtime Veri5 test - @Eini, Niv @Aharoni, Nitai
Create orchestrator Jenkins job
Make sure that on stage fail, don’t fail the whole job

            1.17.3 My task - prepare environment
Here is a link to app config - https://wiki.wdf.sap.corp/wiki/display/CPPortals/cFLP+Test+Content
To create apps manually: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Manual+FLP+Acceptance+test
 
Link to manual tests env (with destinations) - https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/cf1f8b5d-9ae4-4559-80c5-725a1fadf1b5/destinations
 
automation consumer sub-account. https://flptest.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Site-Directory
provider lkg
Note, Olga: I renamed the sub-account for automation test from 'E2E Consumer' to 'E2E Automation' (FYI)
https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/09a6c9f0-8729-4634-a801-2c65eed44da1/details
 
Org name remained the same, so DT and RT URL's weren't changed.

system. NCP_NO_ON_PREM.

                1.17.3.1 examples, from flpdevelop...
static-url, simple just run console when creating...

                    1.17.3.1.1 SAP-GUI
                    https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Content-Manage&/entityEditor/businessapp/a0a80032-6cdd-4750-97f6-7860d7e37bc2/display/Local
   update batch:
curl 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=SUB_ACCOUNT&contextType=SUB_ACCOUNT' -H 'Sec-Fetch-Mode: cors' -H 'X-XHR-Logon: accept="iframe,strict-window,window"' -H 'Origin: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com' -H 'Accept-Encoding: gzip, deflate, br' -H 'X-CSRF-Token: 090439df3a20503d-HzdoW0wCqiKg5JLyD5HzVdaA6H4' -H 'Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: JSESSIONID=s%3AojEADIxNfdQD9YTheI0vCtd9d46pXpB5.vf1jbGz2khIvrgc0b1dsrKhP7XWo5mkklQxRRfJhjLo; __VCAP_ID__=1513d90e-2a94-4b69-5b94-abb2' -H 'Connection: keep-alive' -H 'Pragma: no-cache' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Content-Type: application/json; charset=UTF-8' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'Cache-Control: no-cache' -H 'Referer: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory' -H 'Sec-Fetch-Site: same-origin' --data-binary '{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"texts":{"cdm|identification|title":{"value":{"":"Olga - GUI for HTML","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"App Technology = SAP GUI for HTML","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"value":{"":"","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle":{"value":{"":"","en":""},"type":"XTIT"}},"payload":{"defaultViz":"RandomURL-Launcher","visualizations":{"RandomURL-Launcher":{"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}","subTitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"GUI_EPMProduct-manage","parameters":{}}}}}},"commonAppConfig":{"sap.app":{"dataSources":{"NCP_NO_ON_PREM":{"uri":"/portal/sap/backend/NCP_NO_ON_PREM","type":"JSON"}}}},"targetAppConfig":{"sap.app":{"tags":{"keywords":[]},"destination":"NCP_NO_ON_PREM","crossNavigation":{"inbounds":{"GUI_EPMProduct-manage":{"action":"manage","signature":{"parameters":{}},"semanticObject":"GUI_EPMProduct"}}}},"_version":"1.13.0","sap.integration":{"navMode":"inplace","urlTemplateId":"urltemplate.gui","urlTemplateParams":{"transaction":"SEPM_PD"}}}},"_version":"3.0","identification":{"id":"a0a80032-6cdd-4750-97f6-7860d7e37bc2","title":"{{cdm|identification|title}}","entityType":"businessapp","description":"{{cdm|identification|description}}"}}}]}' --compressed ;
curl 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/~950fe5ce719f920b56ae469435b5d64abbe67517~/contentManager/resources/images/app-app.editor.png' -H 'Pragma: no-cache' -H 'Sec-Fetch-Site: same-origin' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Sec-Fetch-Mode: no-cors' -H 'Accept: image/webp,image/apng,image/*,*/*;q=0.8' -H 'Cache-Control: no-cache' -H 'Referer: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory' -H 'Cookie: JSESSIONID=s%3AojEADIxNfdQD9YTheI0vCtd9d46pXpB5.vf1jbGz2khIvrgc0b1dsrKhP7XWo5mkklQxRRfJhjLo; __VCAP_ID__=1513d90e-2a94-4b69-5b94-abb2' -H 'Connection: keep-alive' --compressed

json: 
{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "Olga - GUI for HTML",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "App Technology = SAP GUI for HTML",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "payload": {
          "defaultViz": "RandomURL-Launcher",
          "visualizations": {
            "RandomURL-Launcher": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.ui": {
                  "icons": {
                    "icon": ""
                  }
                },
                "sap.app": {
                  "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                  "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                },
                "sap.flp": {
                  "target": {
                    "type": "IBN",
                    "inboundId": "GUI_EPMProduct-manage",
                    "parameters": {}
                  }
                }
              }
            }
          },
          "commonAppConfig": {
            "sap.app": {
              "dataSources": {
                "NCP_NO_ON_PREM": {
                  "uri": "/portal/sap/backend/NCP_NO_ON_PREM",
                  "type": "JSON"
                }
              }
            }
          },
          "targetAppConfig": {
            "sap.app": {
              "tags": {
                "keywords": []
              },
              "destination": "NCP_NO_ON_PREM",
              "crossNavigation": {
                "inbounds": {
                  "GUI_EPMProduct-manage": {
                    "action": "manage",
                    "signature": {
                      "parameters": {}
                    },
                    "semanticObject": "GUI_EPMProduct"
                  }
                }
              }
            },
            "_version": "1.13.0",
            "sap.integration": {
              "navMode": "inplace",
              "urlTemplateId": "urltemplate.gui",
              "urlTemplateParams": {
                "transaction": "SEPM_PD"
              }
            }
          }
        },
        "_version": "3.0",
        "identification": {
          "id": "a0a80032-6cdd-4750-97f6-7860d7e37bc2",
          "title": "{{cdm|identification|title}}",
          "entityType": "businessapp",
          "description": "{{cdm|identification|description}}"
        }
      }
    }
  ]
}

                    1.17.3.1.2 SAP-UI5 , Apollo
https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Content-Manage&/entityEditor/businessapp/b59142f3-8126-491a-94aa-74d95226fdd9/display/Local

curl 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=SUB_ACCOUNT&contextType=SUB_ACCOUNT' -H 'Sec-Fetch-Mode: cors' -H 'X-XHR-Logon: accept="iframe,strict-window,window"' -H 'Origin: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com' -H 'Accept-Encoding: gzip, deflate, br' -H 'X-CSRF-Token: be4f46e1681bedb2-hzLCNeLuRbwyJfleuGtzsPI5R2g' -H 'Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: __VCAP_ID__=aacbc796-87cb-4fb2-61df-5f80; JSESSIONID=s%3Af5-wAYtUN82ogBQ8mWTEvtlQ0nJ1-bm6.PbKihzUvX2YVm10M138AS3HqpEGKExcsVrEEwq8SQ6k' -H 'Connection: keep-alive' -H 'Pragma: no-cache' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Content-Type: application/json; charset=UTF-8' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'Cache-Control: no-cache' -H 'Referer: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory' -H 'Sec-Fetch-Site: same-origin' --data-binary '{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"texts":{"cdm|identification|title":{"value":{"":"Olga - SAPUI5","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"SAPUI5 on Prem","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"value":{"":"","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle":{"value":{"":"","en":""},"type":"XTIT"}},"payload":{"defaultViz":"RandomURL-Launcher","visualizations":{"RandomURL-Launcher":{"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}","subTitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"EPMProduct-manage","parameters":{}}}}}},"commonAppConfig":{"sap.app":{"dataSources":{"NCP_NO_ON_PREM":{"uri":"/portal/sap/backend/NCP_NO_ON_PREM","type":"JSON"}}}},"targetAppConfig":{"sap.app":{"tags":{"keywords":[]},"destination":"NCP_NO_ON_PREM","crossNavigation":{"inbounds":{"EPMProduct-manage":{"action":"manage","signature":{"parameters":{}},"semanticObject":"EPMProduct"}}}},"_version":"1.13.0","sap.integration":{"navMode":"inplace","urlTemplateId":"urltemplate.fiori","urlTemplateParams":{"appId":"nw.epm.refapps.products.manage"}}}},"_version":"3.0","identification":{"id":"b59142f3-8126-491a-94aa-74d95226fdd9","title":"{{cdm|identification|title}}","entityType":"businessapp","description":"{{cdm|identification|description}}"}}}]}' --compressed

{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "Olga - SAPUI5",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "SAPUI5 on Prem",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "payload": {
          "defaultViz": "RandomURL-Launcher",
          "visualizations": {
            "RandomURL-Launcher": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.ui": {
                  "icons": {
                    "icon": ""
                  }
                },
                "sap.app": {
                  "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                  "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                },
                "sap.flp": {
                  "target": {
                    "type": "IBN",
                    "inboundId": "EPMProduct-manage",
                    "parameters": {}
                  }
                }
              }
            }
          },
          "commonAppConfig": {
            "sap.app": {
              "dataSources": {
                "NCP_NO_ON_PREM": {
                  "uri": "/portal/sap/backend/NCP_NO_ON_PREM",
                  "type": "JSON"
                }
              }
            }
          },
          "targetAppConfig": {
            "sap.app": {
              "tags": {
                "keywords": []
              },
              "destination": "NCP_NO_ON_PREM",
              "crossNavigation": {
                "inbounds": {
                  "EPMProduct-manage": {
                    "action": "manage",
                    "signature": {
                      "parameters": {}
                    },
                    "semanticObject": "EPMProduct"
                  }
                }
              }
            },
            "_version": "1.13.0",
            "sap.integration": {
              "navMode": "inplace",
              "urlTemplateId": "urltemplate.fiori",
              "urlTemplateParams": {
                "appId": "nw.epm.refapps.products.manage"
              }
            }
          }
        },
        "_version": "3.0",
        "identification": {
          "id": "b59142f3-8126-491a-94aa-74d95226fdd9",
          "title": "{{cdm|identification|title}}",
          "entityType": "businessapp",
          "description": "{{cdm|identification|description}}"
        }
      }
    }
  ]
}
                    1.17.3.1.3 WDA
https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Content-Manage&/entityEditor/businessapp/a5a88f9d-cf34-4d5f-b893-e648821fa154/display/Local

curl 'https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=SUB_ACCOUNT&contextType=SUB_ACCOUNT' -H 'Sec-Fetch-Mode: cors' -H 'X-XHR-Logon: accept="iframe,strict-window,window"' -H 'Origin: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com' -H 'Accept-Encoding: gzip, deflate, br' -H 'X-CSRF-Token: 56bb0ecc577fb528-GOvsYizj_f6B-XodLBHrwnLZjRA' -H 'Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: __VCAP_ID__=aacbc796-87cb-4fb2-61df-5f80; JSESSIONID=s%3A1r_Ku19gSgx1xTX0JV0SLWLn6BZJBTa0.OOdeHF41O451s%2FVff7tznr7GiaxhXZp9ojS%2FID920jU' -H 'Connection: keep-alive' -H 'Pragma: no-cache' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36' -H 'Content-Type: application/json; charset=UTF-8' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'Cache-Control: no-cache' -H 'Referer: https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory' -H 'Sec-Fetch-Site: same-origin' --data-binary '{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"texts":{"cdm|identification|title":{"value":{"":"Olga - WDA","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"Web Dynpro ABAP","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"value":{"":"","en":""},"type":"XTIT"},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle":{"value":{"":"","en":""},"type":"XTIT"}},"payload":{"defaultViz":"RandomURL-Launcher","visualizations":{"RandomURL-Launcher":{"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}","subTitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"WDA_EPMBusniessPartner-display","parameters":{}}}}}},"commonAppConfig":{"sap.app":{"dataSources":{"NCP_NO_ON_PREM":{"uri":"/portal/sap/backend/NCP_NO_ON_PREM","type":"JSON"}}}},"targetAppConfig":{"sap.app":{"tags":{"keywords":[]},"destination":"NCP_NO_ON_PREM","crossNavigation":{"inbounds":{"WDA_EPMBusniessPartner-display":{"action":"display","signature":{"parameters":{}},"semanticObject":"WDA_EPMBusniessPartner"}}}},"_version":"1.13.0","sap.integration":{"navMode":"inplace","urlTemplateId":"urltemplate.wda","urlTemplateParams":{"wdaAppId":"s_epm_ux_bp","wdaConfigId":""}}}},"_version":"3.0","identification":{"id":"a5a88f9d-cf34-4d5f-b893-e648821fa154","title":"{{cdm|identification|title}}","entityType":"businessapp","description":"{{cdm|identification|description}}"}}}]}' --compressed

{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "Olga - WDA",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "Web Dynpro ABAP",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "payload": {
          "defaultViz": "RandomURL-Launcher",
          "visualizations": {
            "RandomURL-Launcher": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.ui": {
                  "icons": {
                    "icon": ""
                  }
                },
                "sap.app": {
                  "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                  "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                },
                "sap.flp": {
                  "target": {
                    "type": "IBN",
                    "inboundId": "WDA_EPMBusniessPartner-display",
                    "parameters": {}
                  }
                }
              }
            }
          },
          "commonAppConfig": {
            "sap.app": {
              "dataSources": {
                "NCP_NO_ON_PREM": {
                  "uri": "/portal/sap/backend/NCP_NO_ON_PREM",
                  "type": "JSON"
                }
              }
            }
          },
          "targetAppConfig": {
            "sap.app": {
              "tags": {
                "keywords": []
              },
              "destination": "NCP_NO_ON_PREM",
              "crossNavigation": {
                "inbounds": {
                  "WDA_EPMBusniessPartner-display": {
                    "action": "display",
                    "signature": {
                      "parameters": {}
                    },
                    "semanticObject": "WDA_EPMBusniessPartner"
                  }
                }
              }
            },
            "_version": "1.13.0",
            "sap.integration": {
              "navMode": "inplace",
              "urlTemplateId": "urltemplate.wda",
              "urlTemplateParams": {
                "wdaAppId": "s_epm_ux_bp",
                "wdaConfigId": ""
              }
            }
          }
        },
        "_version": "3.0",
        "identification": {
          "id": "a5a88f9d-cf34-4d5f-b893-e648821fa154",
          "title": "{{cdm|identification|title}}",
          "entityType": "businessapp",
          "description": "{{cdm|identification|description}}"
        }
      }
    }
  ]
}
                1.17.3.2 Jenkins
               https://gkenewflpcf.jaas-gcp.cloud.sap.corp/job/CFLP-E2E-INTEGRATION-TEST/ 

 
                1.17.3.3 Cross-team cflp tests coverage

                    1.17.3.3.1  Summary, fs-automation jenkins
groovy /Users/i500695/work/SAP/git/portal-cf-fs-automation/CFLP-E2E-INTEGRATION-TEST

( code:
#!groovy
@Library(['piper-lib', 'ci-tools-library']) _
import com.sap.pcf.jenkins.*
import com.sap.icd.jenkins.*

def sitecreated,
    recipients = "" + env.RECIPIENTS,
    docker_image_mocha = "docker.wdf.sap.corp:50000/piper/node:latest",
    docker_image_veri5 = "docker.wdf.sap.corp:51089/cf/selenium-uiveri5:78",
    credentialsId = 'CFLP_CREDENTIALS',
    UUID = UUID.randomUUID().toString().substring(0, 13)

node {
    deleteDir()
    withCredentials([usernamePassword(credentialsId: credentialsId, passwordVariable: 'password', usernameVariable: 'user')]) {
        env.UUID = UUID
        env.TEST_URL = "https://flptest.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/";
        env.TEST_USER = user
        env.TEST_PASSWORD = password

        git branch: 'cFLP_automation', changelog: false, poll: false, url: 'https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation'

        stage("Create Site") {
            executeDocker(dockerImage: docker_image_mocha, dockerEnvVars: ["user": user, "password": password]) {
                try {
                    log.info("env UUID: ${env.UUID}")
                    log.info("env TEST_USER: ${env.TEST_USER}")
                    log.info("env TEST_PASSWORD: ${env.TEST_PASSWORD}")
                    log.info("env TEST_URL: ${env.TEST_URL}")
                    sh 'npm i'
                    sitecreated = sh(script: "npm run createflp", returnStatus: true)
                    log.info("sitecreated: ${sitecreated}")
                    if (sitecreated != 0) {
                    }
                } catch (Exception e) {
                    log.error("Error: ${e.toString()}")
                }
            }
        }

        if (sitecreated == 0) {
            stage("Run Veri5") {
                executeDocker(dockerImage: docker_image_veri5, dockerEnvVars: ["user": user, "password": password]) {
                    try {
                        def veri5 = sh(script: "npm run veri5flp", returnStatus: true)
                        publishTestResults html: [name: 'uiveri5 report', archive: true, file: 'report.html', path: 'Uiveri5/Specs/cFLP/target/report/screenshots/', allowEmptyResults: true]
                        if (veri5 != 0) {
                        }
                    } catch (Exception e) {
                        log.error("Error: ${e.toString()}")
                    }
                }
            }
        }

        stage("Delete Site") {
            executeDocker(dockerImage: docker_image_mocha, dockerEnvVars: ["user": user, "password": password]) {
                try {
                    def sitedeleted = sh(script: "npm run deleteflp", returnStatus: true)
                    log.info("sitedeleted: ${sitedeleted}")
                    if (sitedeleted != 0) {
                    }
                } catch (Exception e) {
                    log.info("Error: ${e.toString()}")
                }
            }
        }
    }
}
)

It runs:
sh: /Users/i500695/work/SAP/git/portal-cf-fs-automation/cFLP.sh

a. create cflp
> portal-cf-cs-automation@0.0.1 createflp /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
> _mocha -r ts-node/register --reporter-options output=target/create-cflp-mocha.xml ./test/cFLP/create-cflp.spec.ts
  cFLP flow
    Create site, group, catalog, role
      ✓ should create a new site (3272ms)
      ✓ should add a new catalog (1454ms)
      ✓ should add a new group (978ms)
      ✓ should add a new role (742ms)
    Create apps
      ✓ should add a new app_static_url (790ms)
      ✓ should add a new app_sap_gui (759ms)
      ✓ should add a new app_sap_ui5 (810ms)
      ✓ should add a new app_wd_abap (817ms)
    Assign apps
      1) should assign app_static_url
      2) should assign app_sap_gui
      3) should assign app_sap_ui5
      4) should assign app_wd_abap
      ✓ should assign role to site (1346ms)
    Test RT
      5) should go to rt and include all of dt
      
b. delete cflp

> portal-cf-cs-automation@0.0.1 deleteflp /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
> _mocha -r ts-node/register --reporter-options output=target/delete-cflp-mocha.xml ./test/cFLP/delete-cflp.spec.ts



  cFLP flow
    Delete created content
      Delete apps
        ✓ should delete app_static_url (1787ms)
        ✓ should delete app_sap_gui (1312ms)
        ✓ should delete app_sap_ui5 (4842ms)
        ✓ should delete app_wd_abap (1155ms)
      Delete group, catalog, role
        ✓ should delete catalog (876ms)
        ✓ should delete group (863ms)
        ✓ should delete role (800ms)
      Delete site
        ✓ should delete the created site (607ms)

c. uiveri5
/Users/i500695/work/SAP/git/portal-cf-fs-automation/Uiveri5/Specs/cFLP/cflp.spec.js


                    1.17.3.3.2  Full console


Started by timer
Checking out git https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation.git into /jenkinsdata/CFLP-E2E-INTEGRATION-TEST/workspace@script to read CFLP-E2E-INTEGRATION-TEST
No credentials specified
 > git rev-parse --is-inside-work-tree # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation.git # timeout=10
Fetching upstream changes from https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation.git
 > git --version # timeout=10
 > git fetch --tags --progress -- https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation.git +refs/heads/*:refs/remotes/origin/*
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
 > git rev-parse refs/remotes/origin/origin/master^{commit} # timeout=10
Checking out Revision 6cd4c0557b3a3347d384a8866308ff84c93a5303 (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 6cd4c0557b3a3347d384a8866308ff84c93a5303
Commit message: "Merge pull request #46 from Portal-CF/I066595/set-as-home-button-timeout-fix"
 > git rev-list --no-walk 6cd4c0557b3a3347d384a8866308ff84c93a5303 # timeout=10
Running in Durability level: MAX_SURVIVABILITY
Loading library piper-lib@master
Attempting to resolve master from remote references...
 > git --version # timeout=10
 > git ls-remote -h -- https://github.wdf.sap.corp/ContinuousDelivery/piper-library.git # timeout=10
Found match: refs/heads/master revision dd5d33734cf9e52d4236dd5aca6bc6a72c4f1247
No credentials specified
 > git rev-parse --is-inside-work-tree # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.wdf.sap.corp/ContinuousDelivery/piper-library.git # timeout=10
Fetching without tags
Fetching upstream changes from https://github.wdf.sap.corp/ContinuousDelivery/piper-library.git
 > git --version # timeout=10
 > git fetch --no-tags --progress -- https://github.wdf.sap.corp/ContinuousDelivery/piper-library.git +refs/heads/*:refs/remotes/origin/*
Checking out Revision dd5d33734cf9e52d4236dd5aca6bc6a72c4f1247 (master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f dd5d33734cf9e52d4236dd5aca6bc6a72c4f1247
Commit message: "Switch to branch specific container names (#2343)"
 > git rev-list --no-walk dd5d33734cf9e52d4236dd5aca6bc6a72c4f1247 # timeout=10
Loading library ci-tools-library@master
Examining Portal-CF/ci-tools-library
Attempting to resolve master as a branch
Resolved master as branch master at revision 69e2f123e040015c85ee1c072fd18471c5329447
No credentials specified
 > git rev-parse --is-inside-work-tree # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.wdf.sap.corp/Portal-CF/ci-tools-library.git # timeout=10
Fetching without tags
Fetching upstream changes from https://github.wdf.sap.corp/Portal-CF/ci-tools-library.git
 > git --version # timeout=10
 > git fetch --no-tags --progress -- https://github.wdf.sap.corp/Portal-CF/ci-tools-library.git +refs/heads/master:refs/remotes/origin/master
Checking out Revision 69e2f123e040015c85ee1c072fd18471c5329447 (master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 69e2f123e040015c85ee1c072fd18471c5329447
Commit message: "enhance getLandscapesApps (#329)"
 > git rev-list --no-walk 69e2f123e040015c85ee1c072fd18471c5329447 # timeout=10
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /jenkinsdata/CFLP-E2E-INTEGRATION-TEST/workspace
[Pipeline] {
[Pipeline] deleteDir
[Pipeline] withCredentials
Masking supported pattern matches of $user or $password
[Pipeline] {
[Pipeline] git
No credentials specified
Cloning the remote Git repository
Cloning repository https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
 > git init /jenkinsdata/CFLP-E2E-INTEGRATION-TEST/workspace # timeout=10
Fetching upstream changes from https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
 > git --version # timeout=10
 > git fetch --tags --progress -- https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation +refs/heads/*:refs/remotes/origin/*
 > git config remote.origin.url https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation # timeout=10
Fetching upstream changes from https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation
 > git fetch --tags --progress -- https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation +refs/heads/*:refs/remotes/origin/*
 > git rev-parse refs/remotes/origin/cFLP_automation^{commit} # timeout=10
 > git rev-parse refs/remotes/origin/origin/cFLP_automation^{commit} # timeout=10
Checking out Revision 47267f8a3287048cc75c84bfdc523bf0b06741d8 (refs/remotes/origin/cFLP_automation)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 47267f8a3287048cc75c84bfdc523bf0b06741d8
 > git branch -a -v --no-abbrev # timeout=10
 > git checkout -b cFLP_automation 47267f8a3287048cc75c84bfdc523bf0b06741d8
Commit message: "jenkins file update"
[Pipeline] stage
[Pipeline] { (Create Site)
[Pipeline] echo
Loading library configuration file 'piper-defaults.yml'
[Pipeline] libraryResource
[Pipeline] readYaml
[Pipeline] echo
--- BEGIN LIBRARY STEP: executeDocker.groovy ---
[Pipeline] timeout
Timeout set to expire in 10 sec
[Pipeline] {
[Pipeline] httpRequest
[Pipeline] }
[Pipeline] // timeout
[Pipeline] echo
[WARNING] No reference to surrounding script provided with key 'script', e.g. 'script: this'. In future versions of piper-lib the build will fail. (piper-lib/executeDocker)
[Pipeline] echo
Parameters: dindImage: null, dockerEnvVars: [user:****password:****], dockerImage: docker.wdf.sap.corp:50000/piper/node:latest, dockerOptions: null, dockerVolumeBind: null, dockerWorkspace: null, stashBackConfig: [excludes:nohup.out], skipStashBack: null, stashContent: []
[Pipeline] timeout
Timeout set to expire in 10 sec
[Pipeline] {
[Pipeline] httpRequest
[Pipeline] }
[Pipeline] // timeout
[Pipeline] sh
+ chmod -R u+w .
[Pipeline] stash
Stashed 166 file(s)
[Pipeline] podTemplate
[Pipeline] {
[Pipeline] node
Still waiting to schedule task
‘i355539-jaas-mg4rh-p52gv’ is offline
Agent i355539-jaas-mg4rh-p52gv is provisioned from template Kubernetes Pod Template
---
apiVersion: "v1"
kind: "Pod"
metadata:
  annotations:
    buildUrl: "https://gkenewflpcf.jaas-gcp.cloud.sap.corp/job/CFLP-E2E-INTEGRATION-TEST/2558/"
  labels:
    jenkins: "slave"
    jenkins/56740518-b132-4242-ad3a-936bebea671e: "true"
  name: "i355539-jaas-mg4rh-p52gv"
spec:
  containers:
  - command:
    - "/usr/bin/tail"
    - "-f"
    - "/dev/null"
    env:
    - name: "password"
      value: "****"
    - name: "user"
      value: "****"
    image: "docker.wdf.sap.corp:50000/piper/node:latest"
    imagePullPolicy: "Always"
    name: "container-exec"
    resources:
      limits: {}
      requests: {}
    securityContext:
      privileged: false
    tty: false
    volumeMounts:
    - mountPath: "/home/jenkins/agent"
      name: "workspace-volume"
      readOnly: false
  - args:
    - "********"
    - "i355539-jaas-mg4rh-p52gv"
    env:
    - name: "JENKINS_SECRET"
      value: "********"
    - name: "JENKINS_AGENT_NAME"
      value: "i355539-jaas-mg4rh-p52gv"
    - name: "JENKINS_NAME"
      value: "i355539-jaas-mg4rh-p52gv"
    - name: "JENKINS_AGENT_WORKDIR"
      value: "/home/jenkins/agent"
    - name: "JENKINS_URL"
      value: "https://gkenewflpcf.jaas-gcp.cloud.sap.corp/"
    image: "docker.wdf.sap.corp:50001/sap-production/jnlp-alpine:3.26.1-sap-02"
    imagePullPolicy: "IfNotPresent"
    name: "jnlp"
    resources:
      limits: {}
      requests: {}
    securityContext:
      privileged: false
    tty: false
    volumeMounts:
    - mountPath: "/home/jenkins/agent"
      name: "workspace-volume"
      readOnly: false
  nodeSelector: {}
  restartPolicy: "Never"
  volumes:
  - emptyDir: {}
    name: "workspace-volume"

Running on i355539-jaas-mg4rh-p52gv in /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
[Pipeline] {
[Pipeline] echo
Execute container content in Kubernetes pod
[Pipeline] echo
Unstash content: workspace-56740518-b132-4242-ad3a-936bebea671e
[Pipeline] unstash
[Pipeline] container
[Pipeline] {
[Pipeline] echo
INFO: --- -- env UUID: faf94fe1-6f2e
[Pipeline] echo
INFO: --- -- env TEST_USER: ****
[Pipeline] echo
INFO: --- -- env TEST_PASSWORD: ****
[Pipeline] echo
INFO: --- -- env TEST_URL: https://flptest.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/
[Pipeline] sh
+ npm i
npm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:
npm WARN deprecated   npm i nyc
npm WARN deprecated Visit https://istanbul.js.org/integrations for other alternatives.
npm WARN deprecated superagent@3.8.3: Please note that v5.0.1+ of superagent removes User-Agent header by default, therefore you may need to add it yourself (e.g. GitHub blocks requests without a User-Agent header).  This notice will go away with v5.0.2+ once it is released.
npm WARN portal-cf-cs-automation@0.0.1 No license field.

added 627 packages in 18.576s
[Pipeline] sh
+ npm run createflp

> portal-cf-cs-automation@0.0.1 createflp /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
> _mocha -r ts-node/register --reporter-options output=target/create-cflp-mocha.xml ./test/cFLP/create-cflp.spec.ts

creat-cflp UUID: faf94fe1-6f2e


  cFLP flow
    Create site, group, catalog, role
      ✓ should create a new site (3272ms)
      ✓ should add a new catalog (1454ms)
      ✓ should add a new group (978ms)
      ✓ should add a new role (742ms)
    Create apps
      ✓ should add a new app_static_url (790ms)
      ✓ should add a new app_sap_gui (759ms)
      ✓ should add a new app_sap_ui5 (810ms)
      ✓ should add a new app_wd_abap (817ms)
    Assign apps
      1) should assign app_static_url
      2) should assign app_sap_gui
      3) should assign app_sap_ui5
      4) should assign app_wd_abap
      ✓ should assign role to site (1346ms)
    Test RT
      5) should go to rt and include all of dt


  9 passing (48s)
  5 failing

  1) cFLP flow
       Assign apps
         should assign app_static_url:
     AssertionError: Error while assigning app to content: Error: Request failed with status code 500
      at Utils.assignAppToContent (src/utils.ts:304:20)
      at <anonymous>
      at process._tickCallback (internal/process/next_tick.js:188:7)

  2) cFLP flow
       Assign apps
         should assign app_sap_gui:
     AssertionError: Error while assigning app to content: Error: Request failed with status code 500
      at Utils.assignAppToContent (src/utils.ts:304:20)
      at <anonymous>
      at process._tickCallback (internal/process/next_tick.js:188:7)

  3) cFLP flow
       Assign apps
         should assign app_sap_ui5:
     AssertionError: Error while assigning app to content: Error: Request failed with status code 500
      at Utils.assignAppToContent (src/utils.ts:304:20)
      at <anonymous>
      at process._tickCallback (internal/process/next_tick.js:188:7)

  4) cFLP flow
       Assign apps
         should assign app_wd_abap:
     AssertionError: Error while assigning app to content: Error: Request failed with status code 500
      at Utils.assignAppToContent (src/utils.ts:304:20)
      at <anonymous>
      at process._tickCallback (internal/process/next_tick.js:188:7)

  5) cFLP flow
       Test RT
         should go to rt and include all of dt:
     AssertionError: Error while comparing runtime with designtime: AssertionError: expected {} to contain keys 'app_static_url_faf94fe1-6f2e', 'app_sap_gui_faf94fe1-6f2e', 'app_sap_ui5_faf94fe1-6f2e', and 'app_wd_abap_faf94fe1-6f2e'
      at Utils.testRuntime (src/utils.ts:367:20)
      at <anonymous>
      at process._tickCallback (internal/process/next_tick.js:188:7)



npm ERR! code ELIFECYCLE
npm ERR! errno 5
npm ERR! portal-cf-cs-automation@0.0.1 createflp: `_mocha -r ts-node/register --reporter-options output=target/create-cflp-mocha.xml ./test/cFLP/create-cflp.spec.ts`
npm ERR! Exit status 5
npm ERR! 
npm ERR! Failed at the portal-cf-cs-automation@0.0.1 createflp script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /home/piper/.npm/_logs/2019-11-13T08_35_15_180Z-debug.log
[Pipeline] echo
INFO: --- -- sitecreated: 5
[Pipeline] }
[Pipeline] // container
[Pipeline] stash
Stashed 15297 file(s)
[Pipeline] }
[Pipeline] // node
[Pipeline] }
[Pipeline] // podTemplate
[Pipeline] unstash
[Pipeline] echo
--- END LIBRARY STEP: executeDocker.groovy ---
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Delete Site)
[Pipeline] echo
--- BEGIN LIBRARY STEP: executeDocker.groovy ---
[Pipeline] timeout
Timeout set to expire in 10 sec
[Pipeline] {
[Pipeline] httpRequest
[Pipeline] }
[Pipeline] // timeout
[Pipeline] echo
[WARNING] No reference to surrounding script provided with key 'script', e.g. 'script: this'. In future versions of piper-lib the build will fail. (piper-lib/executeDocker)
[Pipeline] echo
Parameters: dindImage: null, dockerEnvVars: [user:****password:****], dockerImage: docker.wdf.sap.corp:50000/piper/node:latest, dockerOptions: null, dockerVolumeBind: null, dockerWorkspace: null, stashBackConfig: [excludes:nohup.out], skipStashBack: null, stashContent: []
[Pipeline] timeout
Timeout set to expire in 10 sec
[Pipeline] {
[Pipeline] httpRequest
[Pipeline] }
[Pipeline] // timeout
[Pipeline] sh
+ chmod -R u+w .
[Pipeline] stash
Stashed 15345 file(s)
[Pipeline] podTemplate
[Pipeline] {
[Pipeline] node
Still waiting to schedule task
‘Jenkins’ doesn’t have label ‘811e16e2-1aee-4322-8365-abb8e4f6a256’
Agent i355539-jaas-r34ls-pqvfm is provisioned from template Kubernetes Pod Template
---
apiVersion: "v1"
kind: "Pod"
metadata:
  annotations:
    buildUrl: "https://gkenewflpcf.jaas-gcp.cloud.sap.corp/job/CFLP-E2E-INTEGRATION-TEST/2558/"
  labels:
    jenkins: "slave"
    jenkins/811e16e2-1aee-4322-8365-abb8e4f6a256: "true"
  name: "i355539-jaas-r34ls-pqvfm"
spec:
  containers:
  - command:
    - "/usr/bin/tail"
    - "-f"
    - "/dev/null"
    env:
    - name: "password"
      value: "****"
    - name: "user"
      value: "****"
    image: "docker.wdf.sap.corp:50000/piper/node:latest"
    imagePullPolicy: "Always"
    name: "container-exec"
    resources:
      limits: {}
      requests: {}
    securityContext:
      privileged: false
    tty: false
    volumeMounts:
    - mountPath: "/home/jenkins/agent"
      name: "workspace-volume"
      readOnly: false
  - args:
    - "********"
    - "i355539-jaas-r34ls-pqvfm"
    env:
    - name: "JENKINS_SECRET"
      value: "********"
    - name: "JENKINS_AGENT_NAME"
      value: "i355539-jaas-r34ls-pqvfm"
    - name: "JENKINS_NAME"
      value: "i355539-jaas-r34ls-pqvfm"
    - name: "JENKINS_AGENT_WORKDIR"
      value: "/home/jenkins/agent"
    - name: "JENKINS_URL"
      value: "https://gkenewflpcf.jaas-gcp.cloud.sap.corp/"
    image: "docker.wdf.sap.corp:50001/sap-production/jnlp-alpine:3.26.1-sap-02"
    imagePullPolicy: "IfNotPresent"
    name: "jnlp"
    resources:
      limits: {}
      requests: {}
    securityContext:
      privileged: false
    tty: false
    volumeMounts:
    - mountPath: "/home/jenkins/agent"
      name: "workspace-volume"
      readOnly: false
  nodeSelector: {}
  restartPolicy: "Never"
  volumes:
  - emptyDir: {}
    name: "workspace-volume"

Running on i355539-jaas-r34ls-pqvfm in /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
[Pipeline] {
[Pipeline] echo
Execute container content in Kubernetes pod
[Pipeline] echo
Unstash content: workspace-811e16e2-1aee-4322-8365-abb8e4f6a256
[Pipeline] unstash
[Pipeline] container
[Pipeline] {
[Pipeline] sh
+ npm run deleteflp

> portal-cf-cs-automation@0.0.1 deleteflp /home/jenkins/agent/workspace/CFLP-E2E-INTEGRATION-TEST
> _mocha -r ts-node/register --reporter-options output=target/delete-cflp-mocha.xml ./test/cFLP/delete-cflp.spec.ts



  cFLP flow
    Delete created content
      Delete apps
        ✓ should delete app_static_url (1787ms)
        ✓ should delete app_sap_gui (1312ms)
        ✓ should delete app_sap_ui5 (4842ms)
        ✓ should delete app_wd_abap (1155ms)
      Delete group, catalog, role
        ✓ should delete catalog (876ms)
        ✓ should delete group (863ms)
        ✓ should delete role (800ms)
      Delete site
        ✓ should delete the created site (607ms)


  8 passing (14s)

[Pipeline] echo
INFO: --- -- sitedeleted: 0
[Pipeline] }
[Pipeline] // container
[Pipeline] stash
Stashed 15297 file(s)
[Pipeline] }
[Pipeline] // node
[Pipeline] }
[Pipeline] // podTemplate
[Pipeline] unstash
[Pipeline] echo
--- END LIBRARY STEP: executeDocker.groovy ---
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withCredentials
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
            1.17.1.4
                1.17.1.2 adapt APIs to shared content

            1.17.2	Finish cherry-pick BLI integration with cdm-store-client
EUXTEAMGUYM-1886, [Federation] Snapshot and Cherry-pick 

https://github.wdf.sap.corp/Portal-CF/cdm-store-client

install dependency
[i500695@C02X632CJGH6:2019-09-04 14:38:25:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2012$ npmise cdm-store-client
npm WARN read-shrinkwrap This version of npm is compatible with lockfileVersion@1, but npm-shrinkwrap.json was generated for lockfileVersion@0. I'll try to do my best with it!

> @sap/node-jwt@1.6.3 install /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/node_modules/cdm-store-client/node_modules/portal-cf-shared-lib/node_modules/@sap/node-jwt
> node ./build.js

`darwin-x64-v8-7.0` exists; testing
Binary is fine; exiting
npm WARN ajv-keywords@2.1.1 requires a peer of ajv@^5.0.0 but none is installed. You must install peer dependencies yourself.

+ cdm-store-client@1.0.0-20190903111617
added 169 packages from 97 contributors in 18.83s



            1.17.3	EUXTEAMGUYM-2146 [Eng] UIVeri5 - parallel tests execution 
https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2146

Motivation:
As a developer i would like to merge mcode to master ASAP (following successful tests execution)

Today- every PR in dt-approuter takes ~1 hour due to sequential UIVeri5 tests execution.

This is significantly slowing down development and delivery time.

 

Scope:
Investigation + POC for parallel tests execution 

        1.17.4 [Federation] CF Provider synchronization - design https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2130

            1.17.4.1 Motivation:
Currently when snapshot is updated: the whole snapshot is deleted and then recreated 
Extensions ("cherry-picked" apps\roles) will loose their "parent" (source object) due to this delete\recreate... 
We must find a way to keep extensions in sync...
General \ Technical Information
Design for a sync mechanism that will keep federated content un-harmed and updated (if needed)  
We should be in-sync with Dagan, Saar and Nuri, Nadav as there is design in Saar's team and required implementation and integration on Nadav's team
Scope:
For Internal providers, in every content change, followed by a deployment of the FLP Module, the Integration Content (Snapshot) should be updated in cFLP and the runtime sites accessed by the End-Users should be updated accordingly
Design should consider also External providers
Work with Nadav's and Saar's teams to plan implementation of the required changed to support automatic activation of all effected sites when a provider is changed

            1.17.4.2

        1.17.5 [Federation] S/4 on-prem - Design to support federation of external providers https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-2143

            1.17.5.1 general
Next step of the federation topic is to enable federation of S/4 Hana on-prem content.

General \ Technical Information
Design for a external provider federation enablement, focusing on S/4 HANA on prem system.
We should be in-sync with Dagan, Saar as there is a design planed for this topic on their side as well to enable snapshot creation for external providers: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1211


            1.17.5.2
        1.17.6 EUXTEAMGUYM-2141 [Federation] ABAP Content Federation Service POC 

            1.17.6.1  General


Motivation:
Next step of the federation topic is to enable federation of S/4 Hana on-prem content.
The goal is to get an End2End S/4 hana on-prem federation scenario as proof of concept
More details can be found in the following document https://sap.sharepoint.com/:p:/r/teams/S4HANAFLPABAP/Shared%20Documents/Planning/2002/cFLP_Integration_Roadmap_and_Scope_2002.pptx?d=wccff4348c2aa4a9ca306238e8ca093f5&csf=1&e=oLaGfJ
Technical details / guidelines
Saar's team will take over the PoC to integrate the API provided by Marek's team with the transport service
As part of the PoC, a snapshot of the S/4 content will be created and in order to have a RT flow working the content will be stored in the CDM service.
As the content will be stored in CDM, it will be possible to create a DT site with the content and get to a working RT flow.
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2036850460
Scope:
Work together with Saar's team to get the PoC working


Request Access:
https://ldciuss.wdf.sap.corp:44355/sap/bc/webdynpro/sap/grfn_service_map?sap-language=EN&sap-wd-configId=ZMIT_GRAC_FPM_AC_LPD_HOME_USS#
 
Wiki:
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2036850460
 
clone cdm-schema
npm i
npm link
npm run build
 
How to validate:
cdm validate <path2jsons>/catalog.json

            1.17.6.2 schemas
portal - ~/work/SAP/git/cdm-schema: 
flp - ~/work/SAP/git/flpSchema/cdm-schema
install, build & validate:
 $  npm i
 $  npm run build
 $  npm i -g
 $  ls examples/designtime/3.0/group.json 
 $  cdm validate examples/designtime/3.0/group.json 

 since both flp and portal cdm-schema install exactly the same its required to
 use symlink for toggling between the both
[i500695@C02X632CJGH6:2019-09-08 14:17:22:/usr/local/lib/node_modules/cdm-schema/bin:]2047$ ls
cli*	index
[i500695@C02X632CJGH6:2019-09-08 14:17:23:/usr/local/lib/node_modules/cdm-schema/bin:]2048$ cp cli  flpCli
[i500695@C02X632CJGH6:2019-09-08 14:17:39:/usr/local/lib/node_modules/cdm-schema/bin:]2049$ ls
cli*	flpCli*	index
[i500695@C02X632CJGH6:2019-09-08 14:17:40:/usr/local/lib/node_modules/cdm-schema/bin:]2050$ rm cli
[i500695@C02X632CJGH6:2019-09-08 14:17:44:/usr/local/lib/node_modules/cdm-schema/bin:]2051$ ln -s flpCli cli
[i500695@C02X632CJGH6:2019-09-08 14:17:49:/usr/local/lib/node_modules/cdm-schema/bin:]2052$ lt
total 16
-rw-r--r--  1 i500695  staff    82B Sep  8 10:54 index
-rwxr-xr-x  1 i500695  staff   2.0K Sep  8 14:17 flpCli*
lrwxr-xr-x  1 i500695  staff     6B Sep  8 14:17 cli@ -> flpCli

ln -s ~/work/SAP/git/cdm-schema/bin/cli /usr/local/bin/cdm_portal
[i500695@C02X632CJGH6:2019-09-08 14:33:57:~/work/SAP/git/cdm-schema:]2035$ cdm_portal validate examples/designtime/3.0/businessapp/businessapp.dynamic-viz.json


            1.17.6.3 Entities

s4 urls: The URLs are still maintained here: https://wiki.wdf.sap.corp/wik/x/HN9neQ

~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2045$ lt
total 20176
-rw-r--r--@ 1 i500695  staff   1.2K Sep  9 12:28 cdm-entities-split.py
-rw-r--r--@ 1 i500695  staff   710B Sep  9 12:28 cdm-dir-validate.py
-rw-r--r--@ 1 i500695  staff   113K Sep  9 14:21 u1y_120_entities_all.zip
-rw-r--r--@ 1 i500695  staff   9.7M Sep  9 14:33 uyr_210_entities_all.zip

-> helges scripts:
[i500695@C02X632CJGH6:2019-09-09 15:23:15:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2043$ cat cdm-entities-split.py 
import argparse
import json
import os

# Parse Arguments
parser = argparse.ArgumentParser(description='Split a CDM Entities JSON into multiple Entity Files')
parser.add_argument( 'file', help='CDM entities JSON')

args = parser.parse_args()
file_fullname = args.file
file_dir = os.path.dirname(file_fullname)
file_basename = os.path.basename(file_fullname)
file_name = os.path.splitext(file_basename)[0]

# Read File
with open(file_fullname, 'r',  encoding="utf8" ) as file:
    file_content = file.read( ) #.replace('\n', '')

file_json = json.loads(file_content)

# Make Entity Folder
entity_folder_path = os.path.join(file_dir,"entities")
if not os.path.exists(entity_folder_path):
    os.mkdir(os.path.join(file_dir,"entities"))

# Write Entity Jsons
print('Processing ' + str(len(file_json)) + " entities...")
for entity in file_json:
    entity_file_name = entity["identification"]["entityType"] + "." + entity["identification"]["id"].replace('/','_') + ".json"
    entity_file_path = os.path.join(entity_folder_path, entity_file_name)
    entity_file_content = json.dumps( entity , indent = 4 )
    print(entity_file_path)
    with open(entity_file_path,"w+") as file:
        file.write(entity_file_content)[i500695@C02X632CJGH6:2019-09-09 15:23:19:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2044$ cat cdm-dir-validate.py 
import argparse
import os
import sys


# Parse Arguments
parser = argparse.ArgumentParser(description='Validate all CDM Entities in a folder')
parser.add_argument( 'dir', help='Directory with CDM Entity Files', default = '.')

args = parser.parse_args()
dir_fullname = args.dir

if not os.path.isdir(dir_fullname):
    print(dir_fullname + " is not directory")
    sys.exit()

command_validate_base = 'cdm validate'
for file in os.listdir(dir_fullname):
    if file.endswith(".json"):
        print("Handling File " + file + "...")
        file_path = os.path.join(dir_fullname,file)
        command_validate = command_validate_base + ' ' + file_path
        os.system( command_validate )


-> extract Entities
[i500695@C02X632CJGH6:2019-09-09 15:56:38:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2068$ ../cdm-entities-split.py entities_all.json
file_fullname=entities_all.json, file_dir=, file_basename=entities_all.json, file_name=entities_all
Processing 858 entities...
saving enity role._UI2_SAP_KPIFRW5_TCR_S.json 
enity content={
    "_version": "3.0",
    "identification": {
        "id": "/UI2/SAP_KPIFRW5_TCR_S",
        "entityType": "role"
    },
    "payload": {
        "apps": [],
        "catalogs": [
            {
                "id": "/UI2/SAP_KPIFRW5_TC_S"
            }
        ]
    }
}
saving enity role._UI2_SAP_KPIMOD_TCR_S.json 
enity content={
...
[i500695@C02X632CJGH6:2019-09-09 15:56:31:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2067$ lt entities/ | wc -l
     859
[i500695@C02X632CJGH6:2019-09-09 15:56:38:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2068$ lt entities/ | tail
-rw-r--r--  1 i500695  staff   3.8K Sep  9 15:56 businessapp.FAD3E77DF6AF2DAE39C42C6656DA2C90.json
-rw-r--r--  1 i500695  staff   3.2K Sep  9 15:56 businessapp.FB21270434DDC8B3D76D35340970A97E.json
-rw-r--r--  1 i500695  staff   3.7K Sep  9 15:56 businessapp.FBB512FE6EFCA15EC52A64DFE3D585FB.json
-rw-r--r--  1 i500695  staff   1.7K Sep  9 15:56 businessapp.FC4A2004D515B79082475B9061D0EC58.json
-rw-r--r--  1 i500695  staff   3.7K Sep  9 15:56 businessapp.FD03F13440A0DB48D8C24B11C225F3AF.json
-rw-r--r--  1 i500695  staff   1.8K Sep  9 15:56 businessapp.FD9CD8F35C053A02BB2D5BBEBD8BC5B5.json
-rw-r--r--  1 i500695  staff   2.1K Sep  9 15:56 businessapp.FEA6B09122EC9EA1FBD9E988CBD1009E.json
-rw-r--r--  1 i500695  staff   4.0K Sep  9 15:56 businessapp.FEE188C2F0098F9200A96FDDD958BC33.json
-rw-r--r--  1 i500695  staff   3.8K Sep  9 15:56 businessapp.FF1C67B04A4DDC916B597B475CD36168.json
-rw-r--r--  1 i500695  staff   3.5K Sep  9 15:56 businessapp.FFCE430375A71616BB4FEA65CC9F6317.json

[i500695@C02X632CJGH6:2019-09-09 16:04:37:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uyr_210_entities_all:]2077$ ../cdm-entities-split.py entities_all.json 
...
[i500695@C02X632CJGH6:2019-09-09 16:04:24:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uyr_210_entities_all:]2076$ lt entities/ | wc -l
   10056

-> u1y flp validation:
    -->
~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all/u1y_flp_validation_report
all valid except:

[i500695@C02X632CJGH6:2019-09-10 16:14:22:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2088$ cdm validate entities/businessapp.F1B6E6229AE0119A14F513CBAEFA2BE8.json
cmd/cli >> 
CDM validation results:#1 	(1) {"keyword":"additionalProperties","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target.parameters","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/additionalProperties","params":{"additionalProperty":"#Action-tosu01"},"message":"should NOT have additional properties"}
	(2) {"keyword":"additionalProperties","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/additionalProperties","params":{"additionalProperty":"inboundId"},"message":"should NOT have additional properties"}
	(3) {"keyword":"enum","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target.type","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/type/enum","params":{"allowedValues":["URL"]},"message":"should be equal to one of the allowed values"}
	(4) {"keyword":"required","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/required","params":{"missingProperty":"url"},"message":"should have required property 'url'"}
	(5) {"keyword":"type","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target.parameters['#Action-tosu01']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should be string"}
	(6) {"keyword":"oneOf","dataPath":".payload.visualizations['756879BDEBE65010960DE0888233123F'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf","params":{"passingSchemas":null},"message":"should match exactly one schema in oneOf"}

[i500695@C02X632CJGH6:2019-09-10 16:15:03:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2089$ cat !$
cat entities/businessapp.F1B6E6229AE0119A14F513CBAEFA2BE8.json
{
    "_version": "3.0",
    "identification": {
        "id": "F1B6E6229AE0119A14F513CBAEFA2BE8",
        "entityType": "businessapp",
        "title": "{{title}}"
    },
    "payload": {
        "visualizations": {
            "756879BDEBE65010960DE0888233123F": {
                "vizType": "sap.ushell.StaticAppLauncher",
                "vizConfig": {
                    "sap.app": {
                        "title": "{{viz.756879BDEBE65010960DE0888233123F.title}}",
                        "subTitle": "{{viz.756879BDEBE65010960DE0888233123F.subTitle}}"
                    },
                    "sap.flp": {
                        "target": {
                            "type": "IBN",
                            "inboundId": "13B9B73343D510C26D8D1965C48BFF8C",
                            "parameters": {
                                "#Action-tosu01": {
                                    "format": "plain",
                                    "value": ""
                                }
                            }
                        }
                    }
                }
            }
        },
        "defaultViz": "756879BDEBE65010960DE0888233123F",
        "targetAppConfig": {
            "sap.integration": {
                "urlTemplateParams": {
                    "transaction": "SU01"
                },
                "urlTemplateId": "template.gui"
            },
            "sap.app": {
                "crossNavigation": {
                    "inbounds": {
                        "13B9B73343D510C26D8D1965C48BFF8C": {
                            "action": "toUserProfileGUI",
                            "semanticObject": "Action",
                            "signature": {
                                "parameters": {
                                    "sap-language": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-language",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-theme": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-theme",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-theme-name": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-theme-name",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-theme-NWBC": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-theme-NWBC",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-statistics": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-statistics",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-accessibility": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-accessibility",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-ui-legacy-date-format": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-ui-legacy-date-format",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-ui-legacy-number-format": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-ui-legacy-number-format",
                                            "format": "reference"
                                        }
                                    },
                                    "sap-ui-legacy-time-format": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "User.env.sap-ui-legacy-time-format",
                                            "format": "reference"
                                        }
                                    }
                                },
                                "additionalParameters": "allowed"
                            },
                            "deviceTypes": {
                                "desktop": true,
                                "tablet": true,
                                "phone": true
                            },
                            "title": "{{inbound.13B9B73343D510C26D8D1965C48BFF8C.title}}"
                        }
                    }
                }
            }
        },
        "commonAppConfig": {}
    },
    "text": [
        {
            "locale": "",
            "textDictionary": {
                "title": "User Profile Parameters for GUI - SAP GUI HTML",
                "viz.756879BDEBE65010960DE0888233123F.title": "User Profile Parameters for GUI",
                "viz.756879BDEBE65010960DE0888233123F.subTitle": "SAP GUI HTML",
                "inbound.13B9B73343D510C26D8D1965C48BFF8C.title": "tosu01"
            }
        },
        {
            "locale": "de",
            "textDictionary": {
                "viz.756879BDEBE65010960DE0888233123F.title": "Benutzerprofilparameter f\u00fcr GUI",
                "viz.756879BDEBE65010960DE0888233123F.subTitle": "SAP GUI for HTML"
            }
        },
        {
            "locale": "en",
            "textDictionary": {
                "viz.756879BDEBE65010960DE0888233123F.title": "User Profile Parameters for GUI",
                "viz.756879BDEBE65010960DE0888233123F.subTitle": "SAP GUI HTML"
            }
        }
    ]
}

    --> portal validation on flp valid businessapp
[i500695@C02X632CJGH6:2019-09-10 18:57:36:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2101$ ../cdm-dir-validate.py entities | tee validation_results 




[i500695@C02X632CJGH6:2019-09-10 16:32:18:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2086$ cdm_portal validate entities/businessapp.000353CDFA1F8C866CFF2F05B545162F.json 
cmd/cli >> 
CDM validation results:#1 	(1) {"keyword":"additionalProperties","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target.parameters['sap-ui-tech-hint']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/patternProperties/%5E%5B%5Cw%5C.%5C-%5C~1%5D%2B%24/additionalProperties","params":{"additionalProperty":"format"},"message":"should NOT have additional properties"}
	(2) {"keyword":"type","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target.parameters['sap-ui-tech-hint'].value","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/patternProperties/%5E%5B%5Cw%5C.%5C-%5C~1%5D%2B%24/properties/value/type","params":{"type":"object"},"message":"should be object"}
	(3) {"keyword":"oneOf","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target.parameters['sap-ui-tech-hint'].value","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/patternProperties/%5E%5B%5Cw%5C.%5C-%5C~1%5D%2B%24/properties/value/oneOf","params":{"passingSchemas":[0,1]},"message":"should match exactly one schema in oneOf"}
	(4) {"keyword":"additionalProperties","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/additionalProperties","params":{"additionalProperty":"inboundId"},"message":"should NOT have additional properties"}
	(5) {"keyword":"enum","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target.type","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/type/enum","params":{"allowedValues":["URL"]},"message":"should be equal to one of the allowed values"}
	(6) {"keyword":"required","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/required","params":{"missingProperty":"url"},"message":"should have required property 'url'"}
	(7) {"keyword":"type","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target.parameters['sap-ui-tech-hint']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should be string"}
	(8) {"keyword":"oneOf","dataPath":".payload.visualizations['32E772EB1F3DD6C51CFB9DDEF4991B44'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf","params":{"passingSchemas":null},"message":"should match exactly one schema in oneOf"}

    --> role and catalog validation
[i500695@C02X632CJGH6:2019-09-10 16:32:24:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2087$ cdm_portal validate entities/catalog.NWEPM_HANA_FIORI_CATALOG.json 
cmd/cli >> 
CDM validation results:#1 valid

[i500695@C02X632CJGH6:2019-09-10 16:33:46:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/u1y_120_entities_all:]2088$ cdm_portal validate entities/role.SAP_BW_WORKSPACE_QRY_DESIGNER.json 
cmd/cli >> 
CDM validation results:#1 valid
    -->
-> uyr validation
[i500695@C02X632CJGH6:2019-09-11 14:57:59:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uyr_210_entities_all:]2106$ ../cdm-dir-validate.py entities | tee validation_results 

[i500695@C02X632CJGH6:2019-09-11 14:57:46:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uyr_210_entities_all:]2105$ lt
total 234808
-rw-r--r--@     1 i500695  staff    64M Sep  9 13:24 entities_all.json
drwxr-xr-x  10057 i500695  staff   314K Sep  9 16:04 entities/
-rw-r--r--      1 i500695  staff   645K Sep 10 17:39 uyr_210_entities_all
-rw-r--r--      1 i500695  staff    49M Sep 11 12:29 validation_results

-> emails
Thanks Silke!

 

Today I looked at uyr 210 entities.

I have found the following:

Out of 100056 entities 8506 apps are ok 😎👍🏼. One is not ☹
Most if not all catalogs have errors such as:
"keyword":"required","dataPath":".payload.viz[0]","schemaPath":"#/properties/payload/properties/viz/items/required","params":{"missingProperty":"vizId"},"message":"should '

 'have required property \\\'vizId\\\'"

 

"keyword":"required","dataPath":".payload.viz[1]","schemaPath":"#/properties/payload/properties/viz/items/required","params":{"missingProperty":"vizId"},"message":"should '

 'have required property \\\'vizId\\\'"

 

…

The app w/ errors:
$ cdm validate entities/businessapp.B4A80924991DFE866FF786D8A57597DF.json

cmd/cli >>

CDM validation results:#1             (1) {"keyword":"additionalProperties","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target.parameters","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/additionalProperties","params":{"additionalProperty":""},"message":"should NOT have additional properties"}

                (2) {"keyword":"additionalProperties","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/additionalProperties","params":{"additionalProperty":"inboundId"},"message":"should NOT have additional properties"}

                (3) {"keyword":"enum","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target.type","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/type/enum","params":{"allowedValues":["URL"]},"message":"should be equal to one of the allowed values"}

                (4) {"keyword":"required","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/required","params":{"missingProperty":"url"},"message":"should have required property 'url'"}

                (5) {"keyword":"type","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target.parameters['']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should be string"}

                (6) {"keyword":"type","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target.parameters['sap-fiori-id']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should be string"}

                (7) {"keyword":"type","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target.parameters['sap-ach']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should be string"}

                (8) {"keyword":"oneOf","dataPath":".payload.visualizations['C7808DBE3241C02EC8E998C877D22983'].vizConfig['sap.flp'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf","params":{"passingSchemas":null},"message":"should match exactly one schema in oneOf"}

 

Can you plz look into this?

 

BTW, I’ve tweaked Helge’s (excellent!) scripts a bit so that they produce a report of errors to entities mapping and vice versa. It’s quite large but I can share if it helps.

 

Thanks!

Yosi

-> schemas

->
            1.17.6.4 Import apps PoC
a. configure cockpit w/ WDA/GUI destinations
Took config from Ariel.
Import to cockpit. site-manager-saas subaccount cockpit -> destinations ->
import
[i500695@C02X632CJGH6:2019-09-19 15:03:58:~:]2003$ lt ~/Downloads/ | tail -1
-rw-r--r--@ 1 i500695  staff        242B Sep 19 14:53 S4Frontend_UYR_210 (3)

[i500695@C02X632CJGH6:2019-09-19 15:04:02:~:]2004$ cat  ~/Downloads/S4Frontend_UYR_210\ \(3\) 
#
#Thu Aug 01 08:10:57 UTC 2019
sap-platform=ABAP
URL=https\://uyr210-qm7910.wdf.sap.corp
Name=S4Frontend_UYR_210
ProxyType=Internet
Type=HTTP
sap-client=210
Authentication=NoAuthentication
Description=Frontend for QM7/910 sInfinty Main Test

b. build script that fire batches (or use fs-automation) on PoC space
used fs-automation.
cat /Users/i500695/work/SAP/git/portal-cf-fs-automation/test/portal-cf-site-semantic-service/create-content.spec.ts



c. the batches should have destinations added into them


{"metadata":{"updatedOn":1568641804000,"updatedBy":"Ariel Guy","createdBy":"Ariel Guy","createdOn":1568641804000,"context":{"id":"SUB_ACCOUNT","contextType":"sub_account","tenantId":"e157a5edd3ee1c0f2c13251867ab9f7d","identityZoneId":"cf1f8b5d-9ae4-4559-80c5-725a1fadf1b5","instanceId":"bfdf4747-b446-485a-af2c-f8746da94f45"}},"cdm":{"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"Ariel-EPM Business Partner","en":""}},"cdm|identification|description":{"type":"XTIT","value":{"":"WDA NCP","en":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"type":"XTIT","value":{"":"NCP","en":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle":{"type":"XTIT","value":{"":"WDA","en":""}}},"payload":{"defaultViz":"RandomURL-Launcher","visualizations":{"RandomURL-Launcher":{"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":"sap-icon://pdf-attachment"}},"sap.app":{"info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}","subTitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"WDA_EPMBusniessPartner-display","parameters":{}}}}}},"commonAppConfig":{"sap.app":{"dataSources":{"NCP_NO_ON_PREM":{"uri":"/portal/sap/backend/NCP_NO_ON_PREM","type":"JSON"}}}},"targetAppConfig":{"sap.app":{"tags":{"keywords":[]},"destination":"NCP_NO_ON_PREM","crossNavigation":{"inbounds":{"WDA_EPMBusniessPartner-display":{"action":"display","signature":{"parameters":{}},"semanticObject":"WDA_EPMBusniessPartner"}}}},"_version":"1.13.0","sap.integration":{"navMode":"inplace","urlTemplateId":"urltemplate.wda","urlTemplateParams":{"wdaAppId":"s_epm_ux_bp","wdaConfigId":""}}}},"_version":"3.0","identification":{"id":"820a278e-a4ad-4ba6-a2ed-8a4b5bf2e5df","title":"{{cdm|identification|title}}","entityType":"businessapp","description":"{{cdm|identification|description}}"}}}
{
  "metadata": {
    "updatedOn": 1568641804000,
    "updatedBy": "Ariel Guy",
    "createdBy": "Ariel Guy",
    "createdOn": 1568641804000,
    "context": {
      "id": "SUB_ACCOUNT",
      "contextType": "sub_account",
      "tenantId": "e157a5edd3ee1c0f2c13251867ab9f7d",
      "identityZoneId": "cf1f8b5d-9ae4-4559-80c5-725a1fadf1b5",
      "instanceId": "bfdf4747-b446-485a-af2c-f8746da94f45"
    }
  },
  "cdm": {
    "texts": {
      "cdm|identification|title": {
        "type": "XTIT",
        "value": {
          "": "Ariel-EPM Business Partner",
          "en": ""
        }
      },
      "cdm|identification|description": {
        "type": "XTIT",
        "value": {
          "": "WDA NCP",
          "en": ""
        }
      },
      "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
        "type": "XTIT",
        "value": {
          "": "NCP",
          "en": ""
        }
      },
      "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
        "type": "XTIT",
        "value": {
          "": "WDA",
          "en": ""
        }
      }
    },
    "payload": {
      "defaultViz": "RandomURL-Launcher",
      "visualizations": {
        "RandomURL-Launcher": {
          "vizType": "sap.ushell.StaticAppLauncher",
          "vizConfig": {
            "sap.ui": {
              "icons": {
                "icon": "sap-icon://pdf-attachment"
              }
            },
            "sap.app": {
              "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
              "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
            },
            "sap.flp": {
              "target": {
                "type": "IBN",
                "inboundId": "WDA_EPMBusniessPartner-display",
                "parameters": {}
              }
            }
          }
        }
      },
      "commonAppConfig": {
        "sap.app": {
          "dataSources": {
            "NCP_NO_ON_PREM": {
              "uri": "/portal/sap/backend/NCP_NO_ON_PREM",
              "type": "JSON"
            }
          }
        }
      },
      "targetAppConfig": {
        "sap.app": {
          "tags": {
            "keywords": []
          },
          "destination": "NCP_NO_ON_PREM",
          "crossNavigation": {
            "inbounds": {
              "WDA_EPMBusniessPartner-display": {
                "action": "display",
                "signature": {
                  "parameters": {}
                },
                "semanticObject": "WDA_EPMBusniessPartner"
              }
            }
          }
        },
        "_version": "1.13.0",
        "sap.integration": {
          "navMode": "inplace",
          "urlTemplateId": "urltemplate.wda",
          "urlTemplateParams": {
            "wdaAppId": "s_epm_ux_bp",
            "wdaConfigId": ""
          }
        }
      }
    },
    "_version": "3.0",
    "identification": {
      "id": "820a278e-a4ad-4ba6-a2ed-8a4b5bf2e5df",
      "title": "{{cdm|identification|title}}",
      "entityType": "businessapp",
      "description": "{{cdm|identification|description}}"
    }
  }
}

            1.17.6.5 emails re. PoC prep
It would be great to add more apps (just in case it is not a huge effort now).
Do we already have group\catalog\role from S4 that we can create and show?
 
(if you don`t need all other apps, it would assist to remove them ;-))
 
Have a great day,
Shani
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Sunday, September 22, 2019 10:54 AM
To: Limor, Shani <shani.limor@sap.com>
Cc: Dagan, Saar <saar.dagan@sap.com>; Moskovich, Guy <guy.moskovich@sap.com>
Subject: Re: [cFLP] S/4 Content Federation PoC - status update
 
PaaS is only used for portal app. I don’t think you’ll need that permission.
 
Just this app is from S4. I can put a few more if you want and/or remove the rest. Just LMK.
 
Thx!
From: "Limor, Shani" <shani.limor@sap.com>
Date: Sunday, 22 September 2019 at 10:39
To: "Izaq, Yosi" <yosi.izaq@sap.com>
Cc: "Dagan, Saar" <saar.dagan@sap.com>, "Moskovich, Guy" <guy.moskovich@sap.com>
Subject: RE: [cFLP] S/4 Content Federation PoC - status update
 
Thanks Yosi!
What is the PaaS used for?
In addition, are all available entities in the account sent coming from S4 or only this app?
 
Have a great day,
Shani
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Sunday, September 22, 2019 10:33 AM
To: Limor, Shani <shani.limor@sap.com>
Cc: Gilady, Noam <noam.gilady@sap.com>; Kolner, Tamar <tamar.kolner@sap.com>; Tito, Meni <meni.tito@sap.com>; Dagan, Saar <saar.dagan@sap.com>; Sklarski, Tsafrir <tsafrir.sklarski@sap.com>; Moskovich, Guy <guy.moskovich@sap.com>; Sarfati, Dana <dana.sarfati@sap.com>
Subject: Re: [cFLP] S/4 Content Federation PoC - status update
 
Sure Shani!
 
Links:
Content manager
App
Permissions on SaaS are set.
On PaaS I can’t set the admin role collection for your user (I get an error message). Do you think you’ll need this?
 
Thanks!
Yosi
From: "Limor, Shani" <shani.limor@sap.com>
Date: Sunday, 22 September 2019 at 10:17
To: "Izaq, Yosi" <yosi.izaq@sap.com>
Cc: "Gilady, Noam" <noam.gilady@sap.com>, "Kolner, Tamar" <tamar.kolner@sap.com>, "Tito, Meni" <meni.tito@sap.com>, "Dagan, Saar" <saar.dagan@sap.com>, "Sklarski, Tsafrir" <tsafrir.sklarski@sap.com>, "Moskovich, Guy" <guy.moskovich@sap.com>, "Sarfati, Dana" <dana.sarfati@sap.com>
Subject: RE: [cFLP] S/4 Content Federation PoC - status update
 
Hi Yosi,
 
Great progress!
Andreas asked that we present the progress in the our product meeting tomorrow.
Can you pleas send me a link to the system where I can show this (+ permissions) and update me tomorrow by noon on the open points identified?
 
Have a great day,
Shani
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Thursday, September 19, 2019 5:42 PM
To: Gilady, Noam <noam.gilady@sap.com>; Kolner, Tamar <tamar.kolner@sap.com>; Limor, Shani <shani.limor@sap.com>; Tito, Meni <meni.tito@sap.com>; Dagan, Saar <saar.dagan@sap.com>; Sklarski, Tsafrir <tsafrir.sklarski@sap.com>; Moskovich, Guy <guy.moskovich@sap.com>
Subject: [cFLP] S/4 Content Federation PoC - status update
 
Hi,
 
I wanted to update re. the PoC. A first S4 application was successfully imported to consumer sub-account 😊
It was imported programmatically directly into sub-account context. See screen shot:
 

 
 
 
Please note that there are still following gaps:
Destination injection into the app is still not working
The s4 apps have wrong texts key (‘text’ instead of ‘texts’). Validation doesn’t find this error. As a result the apps have empty title/desc.
The s4 apps have semantic objects w/ more than 30 chars (while our app editor has a limit of 30)
 
I will update again once RT is actually working.
Thanks!
Yosi
 
 
 
            1.17.6.6 issues with client editors 

apparently our editor adds RandomURL-Launcher object to CDM entity but is not
putting vizType

identified issues.
a. in update. RandomURL-Launcher is added. No need for that
b. Semantic object has 30 chars limit. increase.
c. targetAppConfig->sap.app->crossNavigation->inbounds key is a concatenation
of semanticObject and action. This is not the way s4 apps keys are created.
d. original semanticObject is overrun.
c+d together turns this:
        "targetAppConfig": {
            "sap.app": {
                "crossNavigation": {
                    "inbounds": {
                        "E5D7C7ACF33E756B3E3076374654C179": {
                            "action": "classifyWithCommodityCodes",
                            "semanticObject": "Product",
                            "signature": {
                                "parameters": {},
                                "additionalParameters": "allowed"
                            },

into this:
          "targetAppConfig": {
            "sap.app": {
              "crossNavigation": {
                "inbounds": {
                  "E5D7C7ACF33E756B3E3076374654C1-aa": {
                    "semanticObject": "E5D7C7ACF33E756B3E3076374654C1",
                    "action": "aa",
                    "signature": {
                      "parameters": {}
                    }

e. in update a target viz is added w/o vizType.
see:
            "RandomURL-Launcher": {
              "vizConfig": {
                "sap.flp": {
                  "target": {
                    "inboundId": "aa-bb"
                  }
                }
              }
            }


f. Run time of imported app doesn't work.

references:

-> Proper update from flpdevelop (LKG SaaS)
{
    "BATCH": [
        {
            "metadata": {
                "operation": "UPDATE"
            },
            "cdm": {
                "texts": {
                    "cdm|identification|description": {
                        "type": "XTIT",
                        "value": {
                            "": "WDA NCP",
                            "en": ""
                        }
                    },
                    "cdm|identification|title": {
                        "type": "XTIT",
                        "value": {
                            "": "Ariel-EPM Business Partner",
                            "en": ""
                        }
                    },
                    "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
                        "type": "XTIT",
                        "value": {
                            "": "NCP",
                            "en": ""
                        }
                    },
                    "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
                        "type": "XTIT",
                        "value": {
                            "": "WDA",
                            "en": ""
                        }
                    }
                },
                "_version": "3.0",
                "identification": {
                    "description": "{{cdm|identification|description}}",
                    "entityType": "businessapp",
                    "id": "820a278e-a4ad-4ba6-a2ed-8a4b5bf2e5df",
                    "title": "{{cdm|identification|title}}"
                },
                "payload": {
                    "commonAppConfig": {
                        "sap.app": {
                            "dataSources": {
                                "NCP_NO_ON_PREM": {
                                    "type": "JSON",
                                    "uri": "/portal/sap/backend/NCP_NO_ON_PREM"
                                }
                            }
                        }
                    },
                    "defaultViz": "RandomURL-Launcher",
                    "targetAppConfig": {
                        "_version": "1.13.0",
                        "sap.app": {
                            "crossNavigation": {
                                "inbounds": {
                                    "WDA_EPMBusniessPartner-display": {
                                        "action": "display",
                                        "semanticObject": "WDA_EPMBusniessPartner",
                                        "signature": {
                                            "parameters": {}
                                        }
                                    }
                                }
                            },
                            "destination": "NCP_NO_ON_PREM",
                            "tags": {
                                "keywords": []
                            }
                        },
                        "sap.integration": {
                            "navMode": "inplace",
                            "urlTemplateId": "urltemplate.wda",
                            "urlTemplateParams": {
                                "wdaAppId": "s_epm_ux_bp",
                                "wdaConfigId": ""
                            }
                        }
                    },
                    "visualizations": {
                        "RandomURL-Launcher": {
                            "vizConfig": {
                                "sap.app": {
                                    "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                                    "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                                },
                                "sap.flp": {
                                    "target": {
                                        "inboundId": "WDA_EPMBusniessPartner-display",
                                        "parameters": {},
                                        "type": "IBN"
                                    }
                                },
                                "sap.ui": {
                                    "icons": {
                                        "icon": "sap-icon://pdf-attachment"
                                    }
                                }
                            },
                            "vizType": "sap.ushell.StaticAppLauncher"
                        }
                    }
                },
            },
        }
    ]
}
-> Update With problems
{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "texts": [
          {
            "locale": "",
            "textDictionary": {
              "title": "Classify Products - Commodity Codes",
              "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
              "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
              "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
            }
          },
          {
            "locale": "en",
            "textDictionary": {
              "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes"
            }
          }
        ],
        "payload": {
          "defaultViz": "BE7FA3083CB6BD047096B69169334459",
          "visualizations": {
            "BE7FA3083CB6BD047096B69169334459": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.ui": {
                  "icons": {
                    "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-material"
                  }
                },
                "sap.app": {
                  "title": "{{viz.BE7FA3083CB6BD047096B69169334459.title}}",
                  "subTitle": "{{viz.BE7FA3083CB6BD047096B69169334459.subTitle}}"
                },
                "sap.flp": {
                  "target": {
                    "type": "IBN",
                    "inboundId": "E5D7C7ACF33E756B3E3076374654C179"
                  }
                }
              }
            },
            "RandomURL-Launcher": {
              "vizConfig": {
                "sap.flp": {
                  "target": {
                    "inboundId": "aa-bb"
                  }
                }
              }
            }
          },
          "targetAppConfig": {
            "sap.app": {
              "crossNavigation": {
                "inbounds": {
                  "aa-bb": {
                    "semanticObject": "aa",
                    "action": "bb",
                    "signature": {
                      "parameters": {}
                    }
                  }
                }
              }
            },
            "destination": "S4Frontend_UYR_210",
            "sap.integration": {
              "urlTemplateId": "urltemplate.fiori",
              "urlTemplateParams": {
                "appId": "fcg.sll.prodcmdtycd.clsfys1"
              }
            }
          }
        },
        "_version": "3.0",
        "identification": {
          "id": "DE8DEF64701E03B54B429C63B868CB8D",
          "title": "{{title}}",
          "entityType": "businessapp"
        }
      }
    }
  ]
}

-> Original app. valid.
{
    "_version": "3.0",
    "identification": {
        "id": "DE8DEF64701E03B54B429C63B868CB8D",
        "entityType": "businessapp",
        "title": "{{title}}"
    },
    "payload": {
        "visualizations": {
            "BE7FA3083CB6BD047096B69169334459": {
                "vizType": "sap.ushell.StaticAppLauncher",
                "vizConfig": {
                    "sap.app": {
                        "title": "{{viz.BE7FA3083CB6BD047096B69169334459.title}}",
                        "subTitle": "{{viz.BE7FA3083CB6BD047096B69169334459.subTitle}}"
                    },
                    "sap.flp": {
                        "target": {
                            "type": "IBN",
                            "inboundId": "E5D7C7ACF33E756B3E3076374654C179"
                        }
                    },
                    "sap.ui": {
                        "icons": {
                            "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-material"
                        }
                    }
                }
            }
        },
        "defaultViz": "BE7FA3083CB6BD047096B69169334459",
        "targetAppConfig": {
            "sap.app": {
                "crossNavigation": {
                    "inbounds": {
                        "E5D7C7ACF33E756B3E3076374654C179": {
                            "action": "classifyWithCommodityCodes",
                            "semanticObject": "Product",
                            "signature": {
                                "parameters": {},
                                "additionalParameters": "allowed"
                            },
                            "deviceTypes": {
                                "desktop": true,
                                "tablet": true,
                                "phone": false
                            },
                            "title": "{{inbound.E5D7C7ACF33E756B3E3076374654C179.title}}"
                        }
                    }
                }
            },
            "sap.integration": {
                "urlTemplateParams": {
                    "appId": "fcg.sll.prodcmdtycd.clsfys1"
                },
                "urlTemplateId": "urltemplate.fiori"
            }
        },
        "commonAppConfig": {
            "sap.app": {
                "ach": "SLL-ITR-CLS"
            },
            "sap.fiori": {
                "registrationIds": [
                    "F2151"
                ]
            }
        }
    },
    "texts": [
        {
            "locale": "",
            "textDictionary": {
                "title": "Classify Products - Commodity Codes",
                "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
                "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
                "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
            }
        },
        {
            "locale": "en",
            "textDictionary": {
                "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
                "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
                "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
            }
        }
    ]
}
-> get entity response. valid.
{
  "metadata": {
    "updatedOn": 1569149039000,
    "updatedBy": "user team123",
    "createdBy": "user team123",
    "createdOn": 1569149039000,
    "context": {
      "id": "SUB_ACCOUNT",
      "contextType": "sub_account",
      "tenantId": "0db042bc36e9c9b806b95dc3bdd1f625",
      "identityZoneId": "83e8bcf2-a53b-4fd8-b96e-67391c0f6a50",
      "instanceId": "58359416-2a58-426e-90e7-b0a7b4868935"
    }
  },
  "cdm": {
    "texts": [
      {
        "locale": "",
        "textDictionary": {
          "title": "Classify Products - Commodity Codes",
          "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
          "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
          "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
        }
      },
      {
        "locale": "en",
        "textDictionary": {
          "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
          "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
          "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
        }
      }
    ],
    "payload": {
      "defaultViz": "BE7FA3083CB6BD047096B69169334459",
      "visualizations": {
        "BE7FA3083CB6BD047096B69169334459": {
          "vizType": "sap.ushell.StaticAppLauncher",
          "vizConfig": {
            "sap.ui": {
              "icons": {
                "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-material"
              }
            },
            "sap.app": {
              "title": "{{viz.BE7FA3083CB6BD047096B69169334459.title}}",
              "subTitle": "{{viz.BE7FA3083CB6BD047096B69169334459.subTitle}}"
            },
            "sap.flp": {
              "target": {
                "type": "IBN",
                "inboundId": "E5D7C7ACF33E756B3E3076374654C179"
              }
            }
          }
        }
      },
      "commonAppConfig": {
        "sap.app": {
          "ach": "SLL-ITR-CLS"
        },
        "sap.fiori": {
          "registrationIds": [
            "F2151"
          ]
        }
      },
      "targetAppConfig": {
        "sap.app": {
          "crossNavigation": {
            "inbounds": {
              "E5D7C7ACF33E756B3E3076374654C179": {
                "title": "{{inbound.E5D7C7ACF33E756B3E3076374654C179.title}}",
                "action": "classifyWithCommodityCodes",
                "signature": {
                  "parameters": {},
                  "additionalParameters": "allowed"
                },
                "deviceTypes": {
                  "phone": false,
                  "tablet": true,
                  "desktop": true
                },
                "semanticObject": "Product"
              }
            }
          }
        },
        "destination": "S4Frontend_UYR_210",
        "sap.integration": {
          "urlTemplateId": "urltemplate.fiori",
          "urlTemplateParams": {
            "appId": "fcg.sll.prodcmdtycd.clsfys1"
          }
        }
      }
    },
    "_version": "3.0",
    "identification": {
      "id": "DE8DEF64701E03B54B429C63B868CB8D",
      "title": "{{title}}",
      "entityType": "businessapp"
    }
  }
}
-> Fixed manually
{
        "texts": [
          {
            "locale": "",
            "textDictionary": {
              "title": "Classify Products - Commodity Codes",
              "viz.BE7FA3083CB6BD047096B69169334459.title": "Classify Products",
              "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes",
              "inbound.E5D7C7ACF33E756B3E3076374654C179.title": "Classify Products - Commodity Codes"
            }
          },
          {
            "locale": "en",
            "textDictionary": {
              "viz.BE7FA3083CB6BD047096B69169334459.subTitle": "Commodity Codes"
            }
          }
        ],
        "payload": {
          "defaultViz": "BE7FA3083CB6BD047096B69169334459",
          "visualizations": {
            "BE7FA3083CB6BD047096B69169334459": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.ui": {
                  "icons": {
                    "icon": "sap-icon://BusinessSuiteInAppSymbols/icon-material"
                  }
                },
                "sap.app": {
                  "title": "{{viz.BE7FA3083CB6BD047096B69169334459.title}}",
                  "subTitle": "{{viz.BE7FA3083CB6BD047096B69169334459.subTitle}}"
                },
                "sap.flp": {
                  "target": {
                    "type": "IBN",
                    "inboundId": "E5D7C7ACF33E756B3E3076374654C179"
                  }
                }
              }
            },
            "RandomURL-Launcher": {
              "vizType": "sap.ushell.StaticAppLauncher",
              "vizConfig": {
                "sap.flp": {
                  "target": {
                    "inboundId": "aa-bb"
                  }
                }
              }
            }
          },
          "targetAppConfig": {
            "sap.app": {
              "crossNavigation": {
                "inbounds": {
                  "aa-bb": {
                    "semanticObject": "aa",
                    "action": "bb",
                    "signature": {
                      "parameters": {}
                    }
                  }
                }
              }
            },
            "destination": "S4Frontend_UYR_210",
            "sap.integration": {
              "urlTemplateId": "urltemplate.fiori",
              "urlTemplateParams": {
                "appId": "fcg.sll.prodcmdtycd.clsfys1"
              }
            }
          }
        },
        "_version": "3.0",
        "identification": {
          "id": "DE8DEF64701E03B54B429C63B868CB8D",
          "title": "{{title}}",
          "entityType": "businessapp"
        }
      }
 
 
            1.17.6.7 role, catalog, group jsons

-> role, sap_subaccount_everyone, update
{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"texts":{"cdm|identification|title":{"value":{"":"Everyone","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"Content assigned to this role is visible to all users","en":""},"type":"XTIT"}},"payload":{"apps":[]},"_version":"3.0","relations":{"apps":[{"target":{"id":"DE8DEF64701E03B54B429C63B868CB8D","entityType":"businessapp","context":{"id":"SUB_ACCOUNT","type":"SUB_ACCOUNT"}},"label":"ref"}]},"identification":{"id":"sap_subaccount_everyone","title":"{{cdm|identification|title}}","entityType":"role","description":"{{cdm|identification|description}}"}}}]}
{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "Everyone",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "Content assigned to this role is visible to all users",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "payload": {
          "apps": []
        },
        "_version": "3.0",
        "relations": {
          "apps": [
            {
              "target": {
                "id": "DE8DEF64701E03B54B429C63B868CB8D",
                "entityType": "businessapp",
                "context": {
                  "id": "SUB_ACCOUNT",
                  "type": "SUB_ACCOUNT"
                }
              },
              "label": "ref"
            }
          ]
        },
        "identification": {
          "id": "sap_subaccount_everyone",
          "title": "{{cdm|identification|title}}",
          "entityType": "role",
          "description": "{{cdm|identification|description}}"
        }
      }
    }
  ]
}

-> catalog, create
{"BATCH":[{"metadata":{"operation":"CREATE"},"cdm":{"_version":"3.0","identification":{"id":"b3a06620-907a-40c8-b680-33b18a0f8781","entityType":"catalog","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"viz":[]},"texts":{"cdm|identification|title":{"value":{"":"s4cat","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"","en":""},"type":"XTIT"}},"relations":{"viz":[{"target":{"id":"DE8DEF64701E03B54B429C63B868CB8D","entityType":"businessapp","context":{"id":"SUB_ACCOUNT","type":"SUB_ACCOUNT"},"properties":{"vizId":"RandomURL-Launcher"}},"label":"ref"}]}}}]}
{
  "BATCH": [
    {
      "metadata": {
        "operation": "CREATE"
      },
      "cdm": {
        "_version": "3.0",
        "identification": {
          "id": "b3a06620-907a-40c8-b680-33b18a0f8781",
          "entityType": "catalog",
          "title": "{{cdm|identification|title}}",
          "description": "{{cdm|identification|description}}"
        },
        "payload": {
          "viz": []
        },
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "s4cat",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "relations": {
          "viz": [
            {
              "target": {
                "id": "DE8DEF64701E03B54B429C63B868CB8D",
                "entityType": "businessapp",
                "context": {
                  "id": "SUB_ACCOUNT",
                  "type": "SUB_ACCOUNT"
                },
                "properties": {
                  "vizId": "RandomURL-Launcher"
                }
              },
              "label": "ref"
            }
          ]
        }
      }
    }
  ]
}

-> group, update
{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"_version":"3.0","identification":{"id":"78287cdc-1893-412d-8840-634d5a368b32","entityType":"group","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"tiles":[]},"texts":{"cdm|identification|title":{"value":{"":"s4group","en":""},"type":"XTIT"},"cdm|identification|description":{"value":{"":"","en":""},"type":"XTIT"}},"relations":{"viz":[{"target":{"id":"DE8DEF64701E03B54B429C63B868CB8D","entityType":"businessapp","context":{"id":"SUB_ACCOUNT","type":"SUB_ACCOUNT"},"properties":{"vizId":"RandomURL-Launcher"}},"label":"ref"}]}}}]}
{
  "BATCH": [
    {
      "metadata": {
        "operation": "UPDATE"
      },
      "cdm": {
        "_version": "3.0",
        "identification": {
          "id": "78287cdc-1893-412d-8840-634d5a368b32",
          "entityType": "group",
          "title": "{{cdm|identification|title}}",
          "description": "{{cdm|identification|description}}"
        },
        "payload": {
          "tiles": []
        },
        "texts": {
          "cdm|identification|title": {
            "value": {
              "": "s4group",
              "en": ""
            },
            "type": "XTIT"
          },
          "cdm|identification|description": {
            "value": {
              "": "",
              "en": ""
            },
            "type": "XTIT"
          }
        },
        "relations": {
          "viz": [
            {
              "target": {
                "id": "DE8DEF64701E03B54B429C63B868CB8D",
                "entityType": "businessapp",
                "context": {
                  "id": "SUB_ACCOUNT",
                  "type": "SUB_ACCOUNT"
                },
                "properties": {
                  "vizId": "RandomURL-Launcher"
                }
              },
              "label": "ref"
            }
          ]
        }
      }
    }
  ]
}
->
            1.17.6.8 email from Shani
Hi,
 
First, thank you Yosi for enabling to demo the status to Andreas today!
This topic is in very high attention by Andreas.
The purpose of the POC is to show that S4 content federation in cFLP is indeed possible E2E (DT to RT) and identify gaps\areas we will need to handle (identify the required BLIs J). 
It`s ok to have shortcuts and some hacks in the POC, but to a certain limit.
 
POC scope for 2002 (T11A including) is:
Bring the S4 CDM to Site Manager shared content layer – currently done via batch request with a specific content entity every time, while the CDM is taken from a zip. 
We should aim to call the CDM directly using a destination (without using the transport service) - @Sklarski, Tsafrir, @Dagan, Saar – what is required to do this?
Site Manager`s App\Group\Catalog\Role editors should render the entities correctly (without edit support), including presenting assignments in the side panel.
S4 Roles are assigned to a Site created in the Site Manager
Site is rendering the Apps\Catalogs\Groups associated through the assigned role correctly
Navigation to Apps is working correctly
 
Open topics:
Apps and Roles have wrong texts key (‘text’ instead of ‘texts’). CDM Schema validation doesn’t find this error. As a result the apps/roles have empty title/desc. (the apps that show up were manually changed by Yosi) – Yosi discussed with Helge to fix, @Yahalom, Amir – please make sure the CDM Schema validation is corrected.
App editor messes the navigation intent (the original json is ok) - under investigation by Yosi
Roles don’t have title and description in the CDM provided, so they are created but not usable (since can’t click title) – Yosi discussed with Helge to fix
Can’t create catalog - under investigation by Yosi
Activation/RT of imported apps is not working - under investigation by Yosi
No group entities were provided – very important for our validation, will be discussed in the weekly call.
Helge is interested to be able to create content directly on a space – Yosi will discuss the options with him tomorrow
Update\Edit of entities is not working – this is not in the POC scope (not even in GA scope). Nevertheless, any gap\issue we find now will help us later, thus I've requested Yosi to avoid testing Update\Edit, but to document the findings he encounters for future use.
Site Manager: Content manager
 
@Izaq, Yosi – please add anything if I forgot 🙏
 
Thanks,
Shani

            1.17.6.9 Validate urz entities

# of entities - 7429
portal valid entities - 7052.
Observed errors:
a. \ in id 
 '{"keyword":"pattern","dataPath":".payload.catalogs[0].id","schemaPath":"#/properties/payload/properties/catalogs/items/properties/id/pattern","params":{"pattern":"^[\\\\\\\\w\\\\\\\\-:@+~.#]+$"},"message":"should '
 'match pattern \\\\"^[\\\\\\\\w\\\\\\\\-:@+~.#]+$\\\\""}\': '

example:
        "catalogs": [
            {
                "id": "/UI2/FLP_AUTOTEST_CAT_CDM_EXPORT"
            },
/ not allowed

b. "" and inboundId keys not allowed

error:
 '{"keyword":"additionalProperties","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target.parameters","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/0/properties/parameters/additionalProperties","params":{"additionalProperty":""},"message":"should '
 'NOT have additional properties"}\': '
 '{"keyword":"additionalProperties","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/additionalProperties","params":{"additionalProperty":"inboundId"},"message":"should '
 'NOT have additional properties"}\': '
 "{'businessapp.996F848654FF83EAB3065ACD212D67E9.json'}, '(3) "

example:
                    "sap.flp": {
                        "target": {
                            "type": "IBN",
                            "inboundId": "A5BEB3BC3BE76EA18DB9EA8803EBF8BE",
                            "parameters": {
                                "sap-ushell-innerAppRoute": {
                                    "value": {
                                        "format": "plain",
                                        "value": "viewName=CustomObject"
                                    }

c. missing url property
error:
 '{"keyword":"required","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/required","params":{"missingProperty":"url"},"message":"should '
 'have required property \\\'url\\\'"}\': '

d. type not allowed value 
 '{"keyword":"enum","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target.type","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/type/enum","params":{"allowedValues":["URL"]},"message":"should '
 'be equal to one of the allowed values"}\': '

exmample of both c and d:
                    "sap.flp": {
                        "target": {
                            "type": "IBN",
                            "inboundId": "A5BEB3BC3BE76EA18DB9EA8803EBF8BE",
                            "parameters": {
                                "sap-ushell-innerAppRoute": {
                                    "value": {
                                        "format": "plain",
                                        "value": "viewName=CustomObject"
                                    }
                                },
                                "": {
                                    "value": {
                                        "format": "plain",
                                        "value": ""
                                    }
                                }
                            }
                        }
                    },

e. sap-ushell-innerAppRoute should be string
error:
 '{"keyword":"type","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target.parameters[\\\'sap-ushell-innerAppRoute\\\']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should '
 'be string"}\': {\'businessapp.996F848654FF83EAB3065ACD212D67E9.json\'}, '

example:
                                "sap-ushell-innerAppRoute": {
                                    "value": {
                                        "format": "plain",
                                        "value": "viewName=CustomObject"
                                    }

f.
 '{"keyword":"type","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target.parameters[\\\'\\\']","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf/1/properties/parameters/patternProperties/%5E(.*)%24/type","params":{"type":"string"},"message":"should '
 'be string"}\': {\'businessapp.996F848654FF83EAB3065ACD212D67E9.json\'}, '

g.
 '{"keyword":"oneOf","dataPath":".payload.visualizations[\\\'3A8EED05DE0D74B81846F575614BB836\\\'].vizConfig[\\\'sap.flp\\\'].target","schemaPath":"#/properties/payload/properties/visualizations/patternProperties/%5E(.*)%24/properties/vizConfig/allOf/1/properties/sap.flp/properties/target/oneOf","params":{"passingSchemas":null},"message":"should '
 'match exactly one schema in oneOf"}\': '
 "{'businessapp.996F848654FF83EAB3065ACD212D67E9.json'}}")

The problematic entity:
{
    "_version": "3.0",
    "identification": {
        "id": "996F848654FF83EAB3065ACD212D67E9",
        "entityType": "businessapp",
        "title": "{{title}}"
    },
    "payload": {
        "visualizations": {
            "3A8EED05DE0D74B81846F575614BB836": {
                "vizType": "sap.ushell.StaticAppLauncher",
                "vizConfig": {
                    "sap.app": {
                        "title": "{{viz.3A8EED05DE0D74B81846F575614BB836.title}}"
                    },
                    "sap.flp": {
                        "target": {
                            "type": "IBN",
                            "inboundId": "A5BEB3BC3BE76EA18DB9EA8803EBF8BE",
                            "parameters": {
                                "sap-ushell-innerAppRoute": {
                                    "value": {
                                        "format": "plain",
                                        "value": "viewName=CustomObject"
                                    }
                                },
                                "": {
                                    "value": {
                                        "format": "plain",
                                        "value": ""
                                    }
                                }
                            }
                        }
                    },
                    "sap.ui": {
                        "icons": {
                            "icon": "sap-icon://wrench"
                        }
                    }
                }
            }
        },
        "defaultViz": "3A8EED05DE0D74B81846F575614BB836",
        "targetAppConfig": {
            "sap.integration": {
                "urlTemplateParams": {
                    "appId": "mdm.cmd.cmpconfcos1"
                },
                "urlTemplateId": "urltemplate.fiori"
            },
            "sap.app": {
                "crossNavigation": {
                    "inbounds": {
                        "A5BEB3BC3BE76EA18DB9EA8803EBF8BE": {
                            "action": "createObjectType",
                            "semanticObject": "MasterData",
                            "signature": {
                                "parameters": {},
                                "additionalParameters": "allowed"
                            },
                            "deviceTypes": {
                                "desktop": true,
                                "tablet": true,
                                "phone": false
                            },
                            "title": "{{inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title}}",
                            "info": "{{inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.info}}"
                        }
                    }
                }
            }
        },
        "commonAppConfig": {
            "sap.app": {
                "ach": "CA-MDG-CMP-FIO"
            },
            "sap.fiori": {
                "registrationIds": [
                    "F2226"
                ]
            }
        }
    },
    "texts": [
        {
            "locale": "",
            "textDictionary": {
                "title": "Configure Custom Objects",
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configure Custom Objects",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Target Mapping for Custom Objects",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.info": "Target Mapping for Custom Objects"
            }
        },
        {
            "locale": "zh-CN",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u914d\u7f6e\u81ea\u5b9a\u4e49\u5bf9\u8c61",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u81ea\u5b9a\u4e49\u5bf9\u8c61\u7684\u76ee\u6807\u6620\u5c04"
            }
        },
        {
            "locale": "th",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u0e01\u0e33\u0e2b\u0e19\u0e14\u0e23\u0e39\u0e1b\u0e41\u0e1a\u0e1a\u0e2d\u0e2d\u0e1a\u0e40\u0e08\u0e04\u0e17\u0e35\u0e48\u0e1b\u0e23\u0e31\u0e1a\u0e41\u0e15\u0e48\u0e07\u0e44\u0e14\u0e49",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0e01\u0e32\u0e23\u0e41\u0e21\u0e47\u0e1b\u0e40\u0e1b\u0e49\u0e32\u0e2b\u0e21\u0e32\u0e22\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e2d\u0e2d\u0e1a\u0e40\u0e08\u0e04\u0e17\u0e35\u0e48\u0e1b\u0e23\u0e31\u0e1a\u0e41\u0e15\u0e48\u0e07\u0e44\u0e14\u0e49"
            }
        },
        {
            "locale": "ko",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\uc0ac\uc6a9\uc790 \uc815\uc758 \uc624\ube0c\uc81d\ud2b8 \uad6c\uc131",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\uc0ac\uc6a9\uc790 \uc815\uc758 \uc624\ube0c\uc81d\ud2b8\uc758 \ub300\uc0c1 \ub9e4\ud551"
            }
        },
        {
            "locale": "ro",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configurare obiecte customizate",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Mapare \u0163int\u0103 pt.obiecte personalizate"
            }
        },
        {
            "locale": "sl",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfiguriraj objekte po meri",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Ciljna preslikava za objekte po meri"
            }
        },
        {
            "locale": "hr",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfiguriraj korisni\u010dki definirane objekte",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Ciljno mapiranje za korisni\u010dki definirane objekte"
            }
        },
        {
            "locale": "ms",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigurasikan Objek Tersuai",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Pemetaan Sasaran untuk Objek Tersuai"
            }
        },
        {
            "locale": "uk",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u041a\u043e\u043d\u0444\u0456\u0433\u0443\u0440\u0443\u0432\u0430\u0442\u0438 \u043a\u043b\u0456\u0454\u043d\u0442\u0441\u044c\u043a\u0456 \u043e\u0431'\u0454\u043a\u0442\u0438",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0426\u0456\u043b\u044c\u043e\u0432\u0438\u0439 \u043c\u0435\u043f\u043f\u0456\u043d\u0433 \u0434\u043b\u044f \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0446\u044c\u043a\u0438\u0445 \u043e\u0431'\u0454\u043a\u0442\u0456\u0432"
            }
        },
        {
            "locale": "et",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigureeri kohandatud objektid",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Kohandatud objektide sihtvastendus"
            }
        },
        {
            "locale": "ar",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u062a\u0643\u0648\u064a\u0646 \u0627\u0644\u0643\u0627\u0626\u0646\u0627\u062a \u0627\u0644\u0645\u062e\u0635\u0635\u0629",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0627\u0644\u0631\u0628\u0637 \u0627\u0644\u0645\u0633\u062a\u0647\u062f\u0641 \u0644\u0644\u0643\u0627\u0626\u0646\u0627\u062a \u0627\u0644\u0645\u062e\u0635\u0635\u0629"
            }
        },
        {
            "locale": "he",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u05e7\u05d1\u05e2 \u05ea\u05e6\u05d5\u05e8\u05d4 \u05e9\u05dc \u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd \u05de\u05d5\u05ea\u05d0\u05de\u05d9\u05dd \u05d0\u05d9\u05e9\u05d9\u05ea",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u05de\u05d9\u05e4\u05d5\u05d9 \u05d9\u05e2\u05d3 \u05e2\u05d1\u05d5\u05e8 \u05d0\u05d5\u05d1\u05d9\u05d9\u05e7\u05d8\u05d9\u05dd \u05de\u05d5\u05ea\u05d0\u05de\u05d9\u05dd \u05d0\u05d9\u05e9\u05d9\u05ea"
            }
        },
        {
            "locale": "cs",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigurovat vlastn\u00ed objekty",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "C\u00edlov\u00e9 mapov\u00e1n\u00ed pro vlastn\u00ed objekty"
            }
        },
        {
            "locale": "de",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Selbst definierte Objekte konfigurieren",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Zielzuordnung f\u00fcr selbst definierte Objekte"
            }
        },
        {
            "locale": "en",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configure Custom Objects",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Target Mapping for Custom Objects"
            }
        },
        {
            "locale": "fr",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configurer objets personnalis\u00e9s",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Mappage cible pour objets personnalis\u00e9s"
            }
        },
        {
            "locale": "el",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u0394\u03b9\u03b1\u03bc\u03cc\u03c1\u03c6\u03c9\u03c3\u03b7 \u03a0\u03b1\u03c1\u03b1\u03bc\u03b5\u03c4\u03c1\u03bf\u03c0.\u0391\u03bd\u03c4\u03b9\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03c9\u03bd",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u03a4\u03b5\u03bb\u03b9\u03ba\u03ae \u0391\u03c0\u03b5\u03b9\u03ba\u03cc\u03bd\u03b9\u03c3\u03b7 \u03b3\u03b9\u03b1 \u0391\u03bd\u03c4\u03b9\u03ba\u03b5\u03af\u03bc\u03b5\u03bd\u03b1 \u03a0\u03b1\u03c1\u03b1\u03bc\u03b5\u03c4/\u03c3\u03b7\u03c2"
            }
        },
        {
            "locale": "hu",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Egyedi objektumok konfigur\u00e1l\u00e1sa",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Egyedi objektumok c\u00e9lhozz\u00e1rendel\u00e9se"
            }
        },
        {
            "locale": "it",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configura oggetti personalizzati",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Mappaggio di destinazione per oggetti personalizzati"
            }
        },
        {
            "locale": "ja",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u30ab\u30b9\u30bf\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u30ab\u30b9\u30bf\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\u30de\u30c3\u30d4\u30f3\u30b0"
            }
        },
        {
            "locale": "da",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigurer brugerdefinerede objekter",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "M\u00e5lallokering for brugerdefinerede objekter"
            }
        },
        {
            "locale": "pl",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfiguracja obiekt\u00f3w niestandardowych",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Mapowanie celu dla obiekt\u00f3w niestandardowych"
            }
        },
        {
            "locale": "zh-TW",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u7d44\u614b\u81ea\u8a02\u7269\u4ef6",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u81ea\u8a02\u7269\u4ef6\u7684\u76ee\u6a19\u5c0d\u6620"
            }
        },
        {
            "locale": "nl",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Zelfgedefinieerde objecten configureren",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Doelmapping voor zelfgedefinieerde objecten"
            }
        },
        {
            "locale": "no",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigurer egendefinerte objekter",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "M\u00e5ltilordning for egendefinerte objekter"
            }
        },
        {
            "locale": "pt",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configurar objetos personalizados",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Mapeamento de destino para objetos personalizados"
            }
        },
        {
            "locale": "sk",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigur\u00e1cia z\u00e1kazn\u00edckych objektov",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Cie\u013eov\u00e9 mapovanie pre z\u00e1kazn\u00edcke objekty"
            }
        },
        {
            "locale": "ru",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u0421\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u043a\u043b\u0438\u0435\u043d\u0442\u0430",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u043c\u044d\u043f\u043f\u0438\u043d\u0433 \u0434\u043b\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u043a\u043b\u0438\u0435\u043d\u0442\u0430"
            }
        },
        {
            "locale": "es",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configurar objetos personalizados",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Asignaci\u00f3n de destino para objetos personalizados"
            }
        },
        {
            "locale": "tr",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Kullan\u0131c\u0131 tan\u0131ml\u0131 nesneleri konfig\u00fcre et",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Kullan\u0131c\u0131ya tan\u0131ml\u0131 nesneler i\u00e7in hedef e\u015fleme"
            }
        },
        {
            "locale": "fi",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfiguroi itse m\u00e4\u00e4ritetyt objektit",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Kohteen kohdistus itse m\u00e4\u00e4ritettyj\u00e4 objekteja varten"
            }
        },
        {
            "locale": "sv",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigurera anv\u00e4ndardefinierade objekt",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "M\u00e5lallokering f\u00f6r anv\u00e4ndardefinierade objekt"
            }
        },
        {
            "locale": "bg",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u043e\u0431\u0435\u043a\u0442\u0438, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438 \u043e\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0426\u0435\u043b\u0435\u0432\u043e \u043c\u0430\u043f\u0438\u0440\u0430\u043d\u0435 \u0437\u0430 \u043e\u0431\u0435\u043a\u0442\u0438, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438 \u043e\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b"
            }
        },
        {
            "locale": "lt",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfig\u016bruoti pasirinktinius objektus",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Pasirinktini\u0173 objekt\u0173 tikslinis susiejimas"
            }
        },
        {
            "locale": "lv",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfigur\u0113t piel\u0101gotos objektus",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Piel\u0101goto objektu m\u0113r\u0137a kart\u0113\u0161ana"
            }
        },
        {
            "locale": "ca",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Configurar objectes personalitzats",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Assignaci\u00f3 de destinaci\u00f3 per a objectes personalitzats"
            }
        },
        {
            "locale": "sr-Latn",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "Konfiguri\u0161i korisni\u010dki definisane objekte",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "Ciljno preslikavanje za korisni\u010dki definisane objekte"
            }
        },
        {
            "locale": "hi",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u0915\u0938\u094d\u091f\u092e \u0911\u092c\u094d\u091c\u0947\u0915\u094d\u091f \u0915\u0949\u0928\u094d\u095e\u093f\u0917\u0930 \u0915\u0930\u0947\u0902",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0915\u0938\u094d\u091f\u092e \u0911\u092c\u094d\u091c\u0947\u0915\u094d\u091f \u0939\u0947\u0924\u0941 \u0932\u0915\u094d\u0937 \u092e\u0948\u092a\u093f\u0902\u0917"
            }
        },
        {
            "locale": "kk",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "\u0420\u0435\u0442\u0442\u0435\u043b\u043c\u0435\u043b\u0456 \u043d\u044b\u0441\u0430\u043d\u0434\u0430\u0440\u0434\u044b \u0442\u0435\u04a3\u0448\u0435\u0443",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "\u0420\u0435\u0442\u0442\u0435\u043b\u043c\u0435\u043b\u0456 \u043d\u044b\u0441\u0430\u043d\u0434\u0430\u0440\u0493\u0430 \u0430\u0440\u043d\u0430\u043b\u0493\u0430\u043d \u043c\u0430\u049b\u0441\u0430\u0442\u0442\u044b \u043c\u044d\u043f\u043f\u0438\u043d\u0433"
            }
        },
        {
            "locale": "vi",
            "textDictionary": {
                "viz.3A8EED05DE0D74B81846F575614BB836.title": "C\u00e2\u0301u hi\u0300nh \u0111\u00f4\u0301i t\u01b0\u01a1\u0323ng tu\u0300y chi\u0309nh",
                "inbound.A5BEB3BC3BE76EA18DB9EA8803EBF8BE.title": "A\u0301nh xa\u0323 mu\u0323c ti\u00eau cho \u0111\u00f4\u0301i t\u01b0\u01a1\u0323ng tu\u0300y chi\u0309nh"
            }
        }
    ]
}


-> copy entities to fs-automation for adding to yosi03 saas

    --> dispatch script
run: ~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2043$ ./cdmDispatchEntitiesToAutomationResources.py
code: ~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2043$ cat cdmDispatchEntitiesToAutomationResources.py
#!/usr/local/bin/python3

#import json
import os
import sys
from shutil import *

automationResPath=r'/Users/i500695/work/SAP/git/portal-cf-fs-automation/test/portal-cf-site-semantic-service/resources/'
srcEntitiesPath=r'/Users/i500695/work/SAP/CF/PoC/s4_integration_to_FLP_portal/entities_all_v4/entities'

entityList = [ 'businessapp.98AD113667862849590E0C4F0E450CAA.json',
 'businessapp.26FFB427771B75B6C49D7A0E7F5EFE7C.json', 
 'businessapp.263368FBB7CD09F30EFAA25657DA75D1.json', 
 ...
]

def dispatchEntities(srcPath, dstPath, entities): 
    print('dispatchEntities(srcPath={}, dstPath={}, entities=<not printed>'.format(srcPath, dstPath) )
    for filename in entities:
        if filename.startswith('businessapp'):
            print('will copy file {} from {} to {}'.format(filename, srcPath, os.path.join(dstPath, 'apps')))
            copy2(os.path.join(srcPath, filename), os.path.join(dstPath, 'apps'))
        elif filename.startswith('catalog'):
            print('will copy file {} from {} to {}'.format(filename, srcPath, os.path.join(dstPath, 'catalogs')))
            copy2(os.path.join(srcPath, filename), os.path.join(dstPath, 'catalogs'))
        elif filename.startswith('role'):
            print('will copy file {} from {} to {}'.format(filename, srcPath, os.path.join(dstPath, 'roles')))
            copy2(os.path.join(srcPath, filename), os.path.join(dstPath, 'roles'))
        else:
            print('File is not app/role/catalog. skip')


if __name__ == '__main__': 
     dispatchEntities(srcEntitiesPath, automationResPath, entityList)

    --> fs-automation copy code
add to /Users/i500695/work/SAP/git/portal-cf-fs-automation/src/semantic-service.ts
	async addS4App( appPath, destinationName ){
        const s4appFile = fs.readFileSync(appPath, 'utf8');
        let s4AppEntity = JSON.parse(s4appFile);
        s4AppEntity.payload.targetAppConfig.destination = destinationName;
        debug('read file ', appPath);
        debug(JSON.stringify(s4AppEntity, null, 4));
        const response = await this.batchRequestGlobal([{
            metadata: {operation: "CREATE"},
            cdm: s4AppEntity
        }]);
        //debug('create app response: ', response);
		debug('create app response: %s', JSON.stringify(response, null, 4));
	}

	async addS4Entity( entityPath){
        const fileContent = fs.readFileSync(entityPath, 'utf8');
        let s4Entity = JSON.parse(fileContent);
        debug('read entity ', entityPath);
        debug(JSON.stringify(s4Entity, null, 4));
        const response = await this.batchRequestGlobal([{
            metadata: {operation: "CREATE"},
            cdm: s4Entity
        }]);
        debug('create entity response: %s', JSON.stringify(response, null, 4));
    }

    async addS4AppsFromDir(appsDirPath, destinationName){
        fs.readdirSync(appsDirPath).forEach(file => {
            debug('processing file ', file);
            this.addS4Entity(path.join(appsDirPath, file));
        });
    }

    async addS4EntitiesFromDir(entitiesDirPath){
        fs.readdirSync(entitiesDirPath).forEach(file => {
            debug('processing file ', file);
            this.addS4Entity(path.join(entitiesDirPath, file));
        });
    }

    async deleteAllEntitiesInDir(dirPath){
        fs.readdirSync(dirPath).forEach(file => {
            debug('processing file ', file);
            const fileContent = fs.readFileSync(path.join(dirPath, file), 'utf8');
            const entity = JSON.parse(fileContent);
            const entityId = entity.identification.id;
            const entityType = entity.identification.entityType;

            this.deleteContent(entityId, entityType);
    });
    }

add
/Users/i500695/work/SAP/git/portal-cf-fs-automation/test/portal-cf-site-semantic-service/create-content.spec.ts
import {assert} from 'chai';
import * as Debug from 'debug';
import * as fs from 'fs';
import * as path from 'path';


const debug = Debug('basic.spec');
const resourcesPath: string = './resources/';
import * as uuidv1 from 'uuid/v1';
import {PortalApi} from '../../src';
import {SemanticService} from '../../src';

describe('Content Creation tests', async () => {

    const api: PortalApi = new PortalApi();
    let semanticService: SemanticService;
    let siteRecord: any;
    let generatedSiteIDs: string[] = [];

    describe('businessApps lifecycle', async function () {
        this.timeout(30000);

        before(async () => {
            debug('******************************************************************************************');
            debug('businessApps lifecycle, before() called');
            debug('Test URL: ' + process.env.TEST_URL);
            debug('Test user: ' + process.env.TEST_USER);
            debug('******************************************************************************************');
            assert.notEqual(process.env.TEST_URL, undefined);
            assert.isDefined(process.env.TEST_URL, 'TEST_URL is not defined');
            assert.isDefined(process.env.TEST_USER, 'TEST_USER is not defined');
            assert.isDefined(process.env.TEST_PASSWORD, 'TEST_PASSWORD is not defined');

            debug('performing login to CF portal');
            const result = await api.loginFromEnv();
            if (!result) {
                debug('*** => login failure');
                throw (new Error('Cannot login to portal'));
            }
            semanticService = new SemanticService(api);
        });

        after(async () => {
            debug('******************************************************************************************');
            debug('businessApps lifecycle, after() called');
            if (generatedSiteIDs.length > 0) {
                for (let id of generatedSiteIDs) {
                    debug('after() deleting site %s', id);
                    await semanticService.deleteSite(id);
                }
                generatedSiteIDs.length = 0;
            }
            debug('******************************************************************************************');
        });

        it('should create an S/4 app', async () => {
            debug('******************************************************************************************');
            try {
                await semanticService.addS4App(path.join(__dirname, resourcesPath, 'apps', 'businessapp.DE8DEF64701E03B54B429C63B868CB8D.json'), "S4Frontend_UYR_210");
            } catch (e) {
                debug('create app encountered and error, ', e);
            }
            debug('******************************************************************************************');
        });

        it('should delete an S/4 app', async () => {
            debug('******************************************************************************************');
            try {
                await semanticService.deleteContent('DE8DEF64701E03B54B429C63B868CB8D', "businessapp");
            } catch (e) {
                debug('delete app encountered and error, ', e);
            }
            debug('******************************************************************************************');
        });

        it.only('should create some S/4 apps', async () => {
            debug('******************************************************************************************');

            try {
                await semanticService.addS4AppsFromDir(path.join(__dirname, resourcesPath, 'apps'), "S4Frontend_UYR_210");
            } catch (e) {
                debug('create app encountered an error, ', e);
            }

            try {
                await semanticService.addS4EntitiesFromDir(path.join(__dirname, resourcesPath,  'catalogs'));
            } catch (e) {
                debug('create catalog encountered an error, ', e);
            }

            try {
                await semanticService.addS4EntitiesFromDir(path.join(__dirname, resourcesPath, 'roles'));
            } catch (e) {
                debug('create role encountered an error, ', e);
            }

            debug('******************************************************************************************');
        });

        it('should delete all S/4 apps', async () => {
            debug('******************************************************************************************');
            try {
                await semanticService.deleteAllEntitiesInDir(path.join(__dirname, resourcesPath, 'apps'));
            } catch (e) {
                debug('delete entity encountered and error, ', e);
            }
            debug('******************************************************************************************');
        });

        it.skip('should delete all S/4 content', async () => {
            debug('******************************************************************************************');
            fs.readdirSync(path.join(__dirname, resourcesPath)).forEach(file => {
                debug('processing file ', file);
                const s4appFile = fs.readFileSync(path.join(__dirname, resourcesPath, 'apps', file), 'utf8');
                let s4AppEntity = JSON.parse(s4appFile);
                s4AppEntity.payload.targetAppConfig.destination = "S4Frontend_UYR_210";
                semanticService.batchRequestGlobal([{
                    metadata: {
                        operation: "DELETE",
                        id: s4AppEntity.identification.id,
                        entityType: "businessapp"
                    }
                }]).then(response => {
                    debug('delete app response: ', response);
                });
                debug('******************************************************************************************');
            });
        });
    });
});
    -->
->

            1.17.6.10 CFLP Test setup
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2132421065
cFLP test user	 E-mail: teamuser1234@gmail.com
Password: QWE11asd

Design Time site:

Site manager
FE user ( XTO381)	
TST_CFLP/Abcd1234

Runtime site	cFLP site

-> Projected Entities:
[{"id":"0c528d6b-4f49-4929-91d3-bdad0b2a4bd5","entityType":"businessapp","title":"Display Scorecards","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"10ca3568-c896-4107-9d22-b6fbcffee82a","entityType":"businessapp","title":"Manage Purchasing Categories","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"211dcfbb-10b9-4a53-9fdc-c1a2b1363c5a","entityType":"businessapp","title":"Manage Purchase Orders","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"2e6aa715-a957-4b87-bcc9-f2845665817d","entityType":"businessapp","title":"Manage Questionnaires","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"3d4818bb-9740-43e7-a043-3337708aed44","entityType":"businessapp","title":"Manage Questionnaires-Evaluation","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"44415dd2-7125-455e-9bfc-04bb42bdff77","entityType":"businessapp","title":"Display Scorecards","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"45f6d32e-c280-494d-94bb-da8c95700515","entityType":"businessapp","title":"My Paystubs-View my paystubs","description":"WMT - Ui5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"47ace48b-8e60-4e38-be29-e76710cb1d3e","entityType":"catalog","title":"UI5 1.60 (WMT)","description":"UI5 1.60 (WMT)","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"48653d99-bb90-4599-a251-80078df514f7","entityType":"businessapp","title":"Manage Questionnaires","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"4b0b95ca-2cd1-404b-a66b-bf54f7f51fd7","entityType":"businessapp","title":"Display Line Items in General Ledger","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"4b5b5544-eb1b-4884-9610-6344f3bb1424","entityType":"catalog","title":"UI5 Master (UYR)","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"4e1c62a7-e0e3-4de3-ab8c-78a543467cdc","entityType":"businessapp","title":"Display Suppliers","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"50f55835-7421-4815-a4f1-ec07757b434d","entityType":"businessapp","title":"Mass Changes to Purchase Orders","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"5b53c9f5-16e1-414f-8a59-93b2a6be5fee","entityType":"group","title":"UI5 1.60 (WMT)","description":"UI5 1.60 (WMT)","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"5f90269e-f519-4556-bc01-233db049d06f","entityType":"businessapp","title":"My Paystubs-View my paystubs","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"7a7ea13b-bb13-4cd5-b916-1f8f3c3e9089","entityType":"businessapp","title":"Display Line Items in General Ledger","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"80523244-ee35-40ad-9785-97c3d564bcf8","entityType":"businessapp","title":"My Paystubs-View my paystubs","description":"XTO - Ui5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"959a0c54-243e-4178-bbec-8df340f9e2e0","entityType":"catalog","title":"UI5 1.65 (XTO)","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"a23574de-33a1-4988-8206-b4ff86e13db4","entityType":"group","title":"Group1","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"a497b952-b641-41cb-9303-49f5efd50449","entityType":"businessapp","title":"Mass Changes to Purchase Orders","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"a90cbb14-66a8-43d5-9b5c-59edc15e03ae","entityType":"group","title":"UI5 Master (UYR)","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"aa577d99-f681-4b9f-8e58-c8b8942dc122","entityType":"businessapp","title":"Display Suppliers","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"ac701413-3a8b-4697-b10c-fe44bee83689","entityType":"businessapp","title":"Display Scorecards","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"b823c6a7-5f17-4fe6-9b39-a2eb8cadaf2d","entityType":"businessapp","title":"Manage Purchasing Categories","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"bb902862-987a-415c-862d-60298657f80a","entityType":"businessapp","title":"Display Suppliers","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"cbf672a7-1669-4d80-8aeb-0dd75c507ce5","entityType":"businessapp","title":"Manage Questionnaires-Evaluation","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"ce5896ae-92c4-449d-8a3a-99967b23a683","entityType":"businessapp","title":"Manage Purchase Orders","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"dfd88d56-16d7-4c66-a646-f30579351498","entityType":"businessapp","title":"Mass Changes to Purchase Orders","description":"XTO - UI5 1.65","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"e4e7988e-1c4a-43df-94d6-130dfdc77e85","entityType":"businessapp","title":"Manage Purchasing Categories","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"e8049296-d40d-4fc5-8d9b-6bb70b1ae920","entityType":"businessapp","title":"Manage Questionnaires-Evaluation","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"e9aad2f7-28eb-4b9f-bd40-1f38d23836c1","entityType":"catalog","title":"MyCatalog","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"eab435eb-77af-472d-922d-29fecfbb2b2d","entityType":"businessapp","title":"Display Line Items in General Ledger","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"f072f83f-0e77-4e78-8761-4a1e49ea6fb3","entityType":"group","title":"UI5 1.65 (XTO)","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"f6739609-ffe7-4b57-98f4-14f83ae06607","entityType":"businessapp","title":"Manage Questionnaires","description":"UYR - UI5 master","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"fa8eadbe-9a19-41e3-ac95-baf949c680d7","entityType":"businessapp","title":"Manage Purchase Orders","description":"WMT - UI5 1.60","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"KSTestRole1","entityType":"role","title":"KSTestRole1","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"MyRole_id","entityType":"role","title":"MyRole","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"role_test","entityType":"role","title":"role test","description":"","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null},{"id":"sap_subaccount_everyone","entityType":"role","title":"Everyone","description":"Everyone","context":{"id":"SUB_ACCOUNT","contextType":"sub_account"},"base":null}]

-> one entity
{
  "id": "0c528d6b-4f49-4929-91d3-bdad0b2a4bd5",
  "entityType": "businessapp",
  "title": "Display Scorecards",
  "description": "XTO - UI5 1.65",
  "context": {
    "id": "SUB_ACCOUNT",
    "contextType": "sub_account"
  },
  "base": null
}

-> full:
{
    "cdm": {
        "_version": "3.0",
        "identification": {
            "description": "{{cdm|identification|description}}",
            "entityType": "businessapp",
            "id": "4b0b95ca-2cd1-404b-a66b-bf54f7f51fd7",
            "title": "{{cdm|identification|title}}"
        },
        "payload": {
            "commonAppConfig": {
                "sap.app": {
                    "dataSources": {
                        "S4Frontend_XTO_381": {
                            "type": "JSON",
                            "uri": "/portal/sap/backend/S4Frontend_XTO_381"
                        }
                    }
                }
            },
            "defaultViz": "RandomURL-Launcher",
            "targetAppConfig": {
                "_version": "1.13.0",
                "sap.app": {
                    "crossNavigation": {
                        "inbounds": {
                            "GLAccount-displayGLLineItemReportingView": {
                                "action": "displayGLLineItemReportingView",
                                "semanticObject": "GLAccount",
                                "signature": {
                                    "parameters": {
                                        "AccountingDocumentCategory": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "AccountingDocumentType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "AssetTransactionType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "AssignmentReference": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "BusinessTransactionType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "ClearingAccountingDocument": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "ClearingDate": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "CompanyCode": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "CostCenter": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "CostCenterActivityType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "Customer": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "FinancialTransactionType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "FiscalYear": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "FiscalYearPeriod": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "FixedAsset": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "FunctionalArea": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "GLAccount": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "Ledger": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "LedgerFiscalYear": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "MasterFixedAsset": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "OffsettingAccount": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "OffsettingAccountType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "P_FromPostingDate": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "P_ToPostingDate": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "PostingDate": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "PostingKey": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "ProfitCenter": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "PurchasingDocument": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "SalesDocument": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "Segment": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "ServiceDocument": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "ServiceDocumentType": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "Supplier": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": ""
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "sap-hide-intent-link": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": "true"
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "sap-navigation-scope": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": "F2217"
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "sap-navigation-scope-filter": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": "F0996"
                                            },
                                            "renameTo": "",
                                            "required": false
                                        },
                                        "sap-priority": {
                                            "defaultValue": {
                                                "format": "plain",
                                                "value": "10"
                                            },
                                            "renameTo": "",
                                            "required": false
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "destination": "S4Frontend_XTO_381",
                    "tags": {
                        "keywords": []
                    }
                },
                "sap.integration": {
                    "navMode": "inplace",
                    "urlTemplateId": "urltemplate.fiori",
                    "urlTemplateParams": {
                        "appId": "fin.gl.glview.display"
                    }
                }
            },
            "visualizations": {
                "RandomURL-Launcher": {
                    "vizConfig": {
                        "sap.app": {
                            "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                            "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                        },
                        "sap.flp": {
                            "target": {
                                "inboundId": "GLAccount-displayGLLineItemReportingView",
                                "parameters": {},
                                "type": "IBN"
                            }
                        },
                        "sap.ui": {
                            "icons": {
                                "icon": ""
                            }
                        }
                    },
                    "vizType": "sap.ushell.StaticAppLauncher"
                }
            }
        },
        "texts": {
            "cdm|identification|description": {
                "type": "XTIT",
                "value": {
                    "": "XTO - UI5 1.65",
                    "en": ""
                }
            },
            "cdm|identification|title": {
                "type": "XTIT",
                "value": {
                    "": "Display Line Items in General Ledger",
                    "en": ""
                }
            },
            "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": {
                "type": "XTIT",
                "value": {
                    "": "XTO - UI5 1.65",
                    "en": ""
                }
            },
            "cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle": {
                "type": "XTIT",
                "value": {
                    "": "",
                    "en": ""
                }
            }
        }
    },
    "metadata": {
        "context": {
            "contextType": "sub_account",
            "id": "SUB_ACCOUNT",
            "identityZoneId": "e7cd2545-4f9e-4662-8801-19377413b618",
            "instanceId": "4bdf1347-cedf-46fe-b268-df97a119167f",
            "tenantId": "9b3c80490ffda0ecd34c843b8ea88896"
        },
        "createdBy": "Matan Taranto",
        "createdOn": 1565093049000,
        "updatedBy": "Matan Taranto",
        "updatedOn": 1565093078000
    }
}


---
-> Try manual massage to s4 entity:
[i500695@C02X632CJGH6:2019-10-03 11:50:11:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/entities_all_v4/entities:]2053$ diff !$  businessapp.085EFFE171C591750910EA328E977F5B.json
diff businessapp.085EFFE171C591750910EA328E977F5B.mod.json  businessapp.085EFFE171C591750910EA328E977F5B.json
9,32c9,10
<         "visualizations": {
<             "RandomURL-Launcher": {
<                 "vizConfig": {
<                     "sap.app": {
<                         "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
<                         "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
<                     },
<                     "sap.flp": {
<                         "target": {
<                             "inboundId": "95111F5D88A945CFA9FA434BF7324D9C",
<                             "parameters": {},
<                             "type": "IBN"
<                         }
<                     },
<                     "sap.ui": {
<                         "icons": {
<                             "icon": ""
<                         }
<                     }
<                 },
<                 "vizType": "sap.ushell.StaticAppLauncher"
<             }
<         },
<         "defaultViz": "RandomURL-Launcher",
---
>         "visualizations": {},
>         "defaultViz": "",
335c313
< }
---
> }

->
            1.17.6.11 Gaps in portal editors
S4 PoC gaps wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation%5D+S4+POChttps://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation%5D+S4+POC

a. payload.defaultViz must have a value "RandomURL-Launcher"
b. There must be a "RandomURL-Launcher" viz. ex:
        "visualizations": {
            "RandomURL-Launcher": {
                "vizConfig": {
                    "sap.app": {
                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                    },
                    "sap.flp": {
                        "target": {
                            "inboundId": "95111F5D88A945CFA9FA434BF7324D9C",
                            "parameters": {},
                            "type": "IBN"
                        }
                    },
                    "sap.ui": {
                        "icons": {
                            "icon": ""
                        }
                    }
                },
                "vizType": "sap.ushell.StaticAppLauncher"
            }
        },

c. inboundParameters defaultValue 
cdm.js:504 Uncaught TypeError: Cannot read property 'value' of undefined
    at eval (InboundParametersDecorator.js?eval:formatted:24)

looks like it expects a defaultValue that’s not there in the inboundParametersDecorator getter…

example, check bupa_role :
            "sap.app": {
                "destination": "S4PRC",
                "crossNavigation": {
                    "inbounds": {
                        "95111F5D88A945CFA9FA434BF7324D9C": {
                            "action": "changeSupplier",
                            "semanticObject": "Supplier",
                            "signature": {
                                "parameters": {
                                    "change_mode": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "EDIT",
                                            "format": "plain"
                                        }
                                    },
                                    "wdconfigurationid": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "/SRMSMC/WDAC_I_BP_SUPPLIER",
                                            "format": "plain"
                                        }
                                    },
                                    "fpm_hide_close": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "X",
                                            "format": "plain"
                                        }
                                    },
                                    "bupa_role": {
                                        "required": false
                                    },
                                    "bupa_number": {
                                        "required": false
                                    }
                                },
                                "additionalParameters": "allowed"
                            },
                            "deviceTypes": {
                                "desktop": true,
                                "tablet": false,
                                "phone": false
                            },
                            "title": "{{inbound.95111F5D88A945CFA9FA434BF7324D9C.title}}"
                        }
                    }
                }
            }

-> Email thread w/ Daniel
Latest Additions:
 
Somewhere within Semantic or CdmStore there is a bug with “getEntityByType” call.
While getAllEntities returns a list of entities that includes all relevant data required for displaying the main manager table,
When executing “getEntityByType” the resulting data has a missing title key:val, resulting in the entity not appearing in the assignmentPanel and making it impossible to assign this entity to any role or other entity (group / catalog)
 
Daniel
 
From: "Turin, Daniel" <daniel.turin@sap.com>
Date: Monday, 7 October 2019 at 9:37
To: "Izaq, Yosi" <yosi.izaq@sap.com>, "Yahalom, Amir" <amir.yahalom@sap.com>, "Moskovich, Guy" <guy.moskovich@sap.com>
Subject: Re: Intent is corrupted by editor
 
Comments order is aligned with the message below:
The defaultViz should actually be the intent. “RandomURL-Launcher” is a hardcoded default value that we create when creating content from 0 in design-time. With Internal provider content (CF) for example, we had to fix a bug so that we’d take the correct value (intent) as the defaultViz as opposed to overwriting it with the “RandomURL-Laucher” value (this bug prevented from the tile appearing in RT).
I believe this does not have to be “RandomURL-Launcher” but a different value – possibly the intent (@Yahalom, Amir / @Moskovich, Guy?)
 
From: "Izaq, Yosi" <yosi.izaq@sap.com>
Date: Sunday, 6 October 2019 at 16:35
To: "Turin, Daniel" <daniel.turin@sap.com>
Subject: Re: Intent is corrupted by editor
 
Awesome summary!! Thanks!
 
Also, all of these points are valid even after ur fixes.
 
a. payload.defaultViz must have a value "RandomURL-Launcher"
b. There must be a "RandomURL-Launcher" viz. ex:
        "visualizations": {
            "RandomURL-Launcher": {
                "vizConfig": {
                    "sap.app": {
                        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
                        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
                    },
                    "sap.flp": {
                        "target": {
                            "inboundId": "95111F5D88A945CFA9FA434BF7324D9C",
                            "parameters": {},
                            "type": "IBN"
                        }
                    },
                    "sap.ui": {
                        "icons": {
                            "icon": ""
                        }
                    }
                },
                "vizType": "sap.ushell.StaticAppLauncher"
            }
        },
 
c. inboundParameters defaultValue
cdm.js:504 Uncaught TypeError: Cannot read property 'value' of undefined
    at eval (InboundParametersDecorator.js?eval:formatted:24)
 
looks like it expects a defaultValue that’s not there in the inboundParametersDecorator getter…
 
example, check bupa_role :
            "sap.app": {
                "destination": "S4PRC",
                "crossNavigation": {
                    "inbounds": {
                        "95111F5D88A945CFA9FA434BF7324D9C": {
                            "action": "changeSupplier",
                            "semanticObject": "Supplier",
                            "signature": {
                                "parameters": {
                                    "change_mode": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "EDIT",
                                            "format": "plain"
                                        }
                                    },
                                    "wdconfigurationid": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "/SRMSMC/WDAC_I_BP_SUPPLIER",
                                            "format": "plain"
                                        }
                                    },
                                    "fpm_hide_close": {
                                        "required": false,
                                        "defaultValue": {
                                            "value": "X",
                                            "format": "plain"
                                        }
                                    },
                                    "bupa_role": {
                                        "required": false
                                    },
                                    "bupa_number": {
                                        "required": false
                                    }
                                },
                                "additionalParameters": "allowed"
                            },
                            "deviceTypes": {
                                "desktop": true,
                                "tablet": false,
                                "phone": false
                            },
                            "title": "{{inbound.95111F5D88A945CFA9FA434BF7324D9C.title}}"
                        }
                    }
                }
            }
 
 
From: "Turin, Daniel" <daniel.turin@sap.com>
Date: Sunday, 6 October 2019 at 15:22
To: "Izaq, Yosi" <yosi.izaq@sap.com>
Subject: Intent is corrupted by editor
 
Hi,
Lets add the following item to the client todo list:
 
Issue:
Our clientside code (AppNavigationInbounds.controller.js) relies on the corssNavigation.inbounds key, in a manner which ruins our support and compatibility with external provider content.
 
Elaboration:
Up until now, the inbounds key was always formed of “SemanticObj-Action”, and since we had this correlation, we allowed our logic to rely on this – in certain events we parse this key (using ‘-‘ as delimiter).
 
Result:
In external provider content we’ve seen that this key is infact a UUID and contains the correct semantic object and action, however our code takes this key, over-writes the semantic object with the key’s value and leaves the action empty (since the UUID does not contain the delimiter).
 
Action Item:
We must alter our client code such that it no longer relies on the value of this key, no longer parses the key in order to get the semantic object and action, thus fixing the corruption and preventing us from overwriting the intent with false values.
 
Best Regards,
Daniel

-> Odata system
https://ldai1uyr.wdf.sap.corp:44300/sap/bc/ui2/poc_cdm3/entities?sap-client=200&useRA=true
Username : COHENADA
Password: k8h2VUsY

-> my odata client
[i500695@C02X632CJGH6:2019-10-07 16:32:55:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uyr_200_odata:]2085$ cat get_all.js 
process.env["NODE_TLS_REJECT_UNAUTHORIZED"] = 0
const request = require('request')
var username = 'COHENADA'
var password = 'k8h2VUsY'
var options = {
  url: 'https://ldai1uyr.wdf.sap.corp:44300/sap/bc/ui2/poc_cdm3/entities?sap-client=200&useRA=true',
  auth: {
    user: username,
    password: password
  }
}

request(options, function (err, res, body) {
  if (err) {
    console.dir(err)
    return
  }
  console.dir('headers', res.headers)
  console.dir('status code', res.statusCode)
  console.dir(body)
})

-> $ node get_all.js > entities_all.json

            1.17.6.12 Demo 16/10/19 13:41:24  
a. entities source: https://ldai1uyr.wdf.sap.corp:44300/sap/bc/ui2/poc_cdm3/entities?sap-client=200&useRA=true
b. entities pass validation via python scripts
c. some known, but not yet fixed, DT editor limitations are fixed via python
script
d. An automatic API injection tool is used to inject those entities to the
setup, which consists of a
e. consumer account (subscribed to FLP portal provider account) with content
that was imported from S4 (uyr)
f. 

 
            1.17.6.13 uxt system integration

                1.17.6.13.1  S4 setup
initial creds:
var user = 'IZAQ'
var password = 'Walldorf01'
change password GUI: https://ldciuxt.wdf.sap.corp:44311/sap/bc/gui/sap/its/webgui?sap-client=928
new pwd:
var password = 'Raanana03'

odata for getting content: https://ldciuxt.wdf.sap.corp:44311/sap/bc/ui2/cdm3/entities?sap-client=928


            1.17.6.14 script for adapting s4 json entities
[i500695@C02X632CJGH6:2019-10-29 16:31:50:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2113$ echo $MEJSRCPATH $MEJSRTDEST
/Users/i500695/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3 uxt_928
[i500695@C02X632CJGH6:2019-10-29 16:32:15:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2114$ ../massageEntitiesJson.py 

[i500695@C02X632CJGH6:2019-10-29 16:32:15:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2114$ cat ../massageEntitiesJson.py 
#!/usr/local/bin/python3

import json
import glob
import os

class constants:
    visualizations = 'visualizations'
    random_url_launcher = 'RandomURL-Launcher'
    app_config = 'targetAppConfig'
    payload = 'payload'
    viz_config = 'vizConfig'
    params = 'parameters'
    sap_ui_tech = 'sap-ui-tech-hint'
    relations = 'relations'
    base_path = "/Users/i500695/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3"
    base_path_env_var_name = 'MEJSRCPATH' 
    if (base_path_env_var_name in os.environ):
        base_path = os.environ[base_path_env_var_name]
        print('using base path env var {}={}'.format(base_path_env_var_name, base_path))

    rt_dest_env_var_name = 'MEJSRTDEST'
    #rt_dest =  "S4Frontend_UYR_210"
    rt_dest =  "uxt_928"
    if (rt_dest_env_var_name in os.environ):
        rt_dest = os.environ[rt_dest_env_var_name]
        print('using RT destination env var {}={}'.format(rt_dest_env_var_name, rt_dest))
    source_dir = base_path + os.sep+ 'entities'
    target_dir = base_path + os.sep+ 'entities4FLP'
    random_url_launcher_str = """
{
    "vizConfig": {
      "sap.app": {
        "info": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}",
        "subTitle": "{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subTitle}}"
      },
      "sap.flp": {
        "target": {
          "inboundId": "95111F5D88A945CFA9FA434BF7324D9C",
          "parameters": {},
          "type": "IBN"
        }
      },
      "sap.ui": {
        "icons": {
          "icon": ""
        }
      }
    },
    "vizType": "sap.ushell.StaticAppLauncher"

}
    """


consts = constants()

def checkIfBussinessAppModNeeded(json_data):
    if consts.random_url_launcher in (list(json_data[consts.payload][consts.visualizations].keys())):
        return False

    return True


def checkIfRoleModNeeded(json_data):
    if consts.relations in (list(json_data.keys())) :
        return False

    return True


def checkIfCatalogModNeeded(json_data):
    if consts.relations in (list(json_data.keys())):
        return False

    return True


def getCatalogAppidFromViz(json_data):
    appsid = []

    for app in json_data[consts.payload]['viz']:
        appsid.append((app['appId'], app['vizId']))

    return appsid


def getSubstringBetweenChars(between_char, word):
    word = word[word.find(between_char)+1: ]
    return word[ :word.find(between_char)]


def getAllJsonFilesNames():
    print('getAllJsonFilesNames reading from dir {}'.format(consts.source_dir+os.sep+"*.json"))
    files =  glob.glob(consts.source_dir+os.sep+"*.json")
    ret_files = []
    for file in files:
        ret_files.append(file.split('/')[-1])
    return ret_files


def modifyBusinessAppEntity(json_data, json_file_name):
    urlLauncher = json.loads(consts.random_url_launcher_str)
    # add the random url launcher field
    json_data[consts.payload][consts.visualizations][consts.random_url_launcher] = urlLauncher
    # fit the inbound id to the one which appears in the 'inbounds' field
    inbounds_json = json_data[consts.payload][consts.app_config]['sap.app']['crossNavigation']['inbounds']
    inbound_id = list(inbounds_json.keys())[0]
    json_data[consts.payload][consts.visualizations][consts.random_url_launcher][consts.viz_config]['sap.flp']['target']['inboundId'] = inbound_id
    json_data[consts.payload]['targetAppConfig']['sap.app']['destination'] = constants.rt_dest
    if json_data[consts.payload]['defaultViz'] == '':
        json_data[consts.payload]['defaultViz'] = list(json_data[consts.payload][consts.visualizations].keys())[0] 
    

    # fix the 'value' object in 'parameters' problem

    try:
        parameters_key = list(json_data[consts.payload][consts.visualizations].keys())[0]
        parameters = json_data[consts.payload][consts.visualizations][parameters_key][consts.viz_config]['sap.flp']['target'][consts.params]
        for parameter in parameters:
            data = {'value': {}}
            for key in parameters[parameter]:
                data['value'][key] = parameters[parameter][key]
            parameters[parameter] = data

        json_data[consts.payload][consts.visualizations][parameters_key][consts.viz_config]['sap.flp']['target'][consts.params] = parameters

    except KeyError:
        print('visualization empty')

    print('---------\n writing json {} \nto file {} \n---------'.format(json_data, consts.target_dir+os.sep+json_file_name))
    writeJsonDataToFIle(json_data, consts.target_dir+os.sep+json_file_name)


def writeJsonDataToFIle(json_data, json_file_name):
    # write the change
    print('writing modified JSON {} \n to file {}'.format(json_data, json_file_name))
    with open(json_file_name, 'w', encoding='utf-8') as outfile:
        json.dump(json_data, outfile, ensure_ascii=False)


def generateAppTemplate(elem):
    appId = elem[0]
    vizId = elem[1]
    data = {
        "label": "ref",
        "target": {
            "properties": {
                "vizId": vizId
                },
            "context": {
                "id": "SUB_ACCOUNT",
                "type": "SUB_ACCOUNT"
                },
            "entityType": "businessapp",
            "id": appId
        }
    }

    return data


##########################################################################################################################################################


def modifyRoleEntity(json_data, file_name):
    json_data['relations'] = {
        "apps": []
    }
    try:
        apps_list = json_data['payload']['apps']

        for appid in apps_list:
            data = generateAppTemplate(appid)
            json_data['relations']['apps'].append(data)

        json_data['payload']['apps'] = []
        writeJsonDataToFIle(json_data, consts.target_dir+os.sep+file_name)

    except KeyError:
        print('key error in role')
        return ''


def modifyCatalogEntity(json_data, file_name):
    json_data['relations'] = {
        "viz": []
    }
    try:
        appsid_list = getCatalogAppidFromViz(json_data) #app,viz ids tuple

        for elem in appsid_list:
            data = generateAppTemplate(elem)
            json_data['relations']['viz'].append(data)

        writeJsonDataToFIle(json_data, consts.target_dir+os.sep+file_name)

    except KeyError:
        print('key error in catalog')
        return ''

def modifyJsonFiles(json_files_list):
    for json_file_name in json_files_list:
        print('modifyJsonFiles(), handling file {}'.format(json_file_name))
        full_json_file_name = consts.source_dir+os.sep+json_file_name 
        print(full_json_file_name)
        json_data = json.load(open(full_json_file_name))
        json_data_type = json_data['identification']['entityType']
        if json_data_type == 'businessapp' and checkIfBussinessAppModNeeded(json_data):
            modifyBusinessAppEntity(json_data, json_file_name)
        elif json_data_type == 'role' and checkIfRoleModNeeded(json_data):
            modifyRoleEntity(json_data, json_file_name)
        elif json_data_type == 'catalog' and checkIfCatalogModNeeded(json_data):
            modifyCatalogEntity(json_data, json_file_name)



def main():
    print('running massage entitites with base path {}'.format(consts.base_path))
    json_files_list = getAllJsonFilesNames()
    if not os.path.exists(consts.target_dir):
        os.mkdir(consts.target_dir)
    modifyJsonFiles(json_files_list)


main()

            1.17.6.15 apps w/ same title
            [i500695@C02X632CJGH6:2019-10-31 14:43:16:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2067$ ../massageEntitiesJson.py 
...
titlesAppsDict = defaultdict(<class 'list'>, {'Manage Templates - Evaluation': ['businessapp.C897DD810EFB0AEC172E4EF7C8A60858.json'], 'Translate Evaluation Questionnaire': ['businessapp.7930398B9A4A4816145B130BD9F1D098.json'], 'Copy Supplier Evaluation Tempate': ['businessapp.8C003C6BF75621625186A684E19281AA.json'], 'Create Supplier Evaluation Request': ['businessapp.7A07AE9B14DCA51CE8C157727D1A95E9.json'], 'Material Price Variance': ['businessapp.328D54F785B514D85A9B8CEC4B523B35.json'], 'Display Supplier Evaluation Request': ['businessapp.4CBB4EF5DFB28B63CA0DF99895D927F7.json'], 'Invoice Price Variance': ['businessapp.9053644F5EE44777C8933AE167D19E7F.json'], 'Create Purchasing Category': ['businessapp.14F0BF2214F573CE95D8680A9CC770CA.json'], 'Supplier Evaluation Score History': ['businessapp.CEE0247C872C30572657840EA881EFF4.json'], 'Change Supplier Evaluation Template': ['businessapp.B40677F0D966DB2E51E5598788E91F14.json'], 'Procurement Overview': ['businessapp.E6A0BCE73837F69573D3B2F11250DDC8.json'], 'Display Supplier Evaluation Scorecard': ['businessapp.ED51656061AF568FF3AC50FC0C3D05FD.json'], 'Translate Questions - Evaluation': ['businessapp.CFEF88F47D573B51ECCC09809CD22749.json'], 'Display Supplier Evaluation Questionnaire': ['businessapp.A6964AC471EA1862FF02C5EF466E670C.json'], 'Create Template - Group-Based Evaluation': ['businessapp.CED89782B0FA500384EF11006AFD18A3.json'], 'Display Suppliers - Procurement': ['businessapp.3A5944BAA9B06B34C437E12C80333538.json'], 'Supplier': ['businessapp.5D075792EED47E249BE082372A40D4C2.json', 'businessapp.4D152DD14C23A7CB59E42C697DD936A6.json'], 'Purchase Order Value - Trend': ['businessapp.334E8FCF286D073EC3E74FD27A1EBDB3.json'], 'Change Activity': ['businessapp.8B43F44D6D2CAE0C316896D3CB18A49A.json'], 'Monitor Responses - Evaluation': ['businessapp.F3421A9627A0C91E1301DEF587392AEC.json'], 'Display Supplier Portfolio': ['businessapp.6BF3FFE4011ACF2207ED80017D29856B.json'], 'Display Task': ['businessapp.27A8F987702F7F40C09B79332ABF11D2.json'], 'Analyze KPI Details': ['businessapp.09F20D07563087C9AED8D76E0CD5025A.json'], 'Display Response': ['businessapp.156F30E220DE4C41B3C4F6334982C87D.json'], 'Non-Managed Spend - By Supplier': ['businessapp.85B929E9966C5A559455F48EE8094085.json'], 'Overall Supplier Evaluation - Score vs Spend': ['businessapp.FB8911EFF79005EBC69A03732874D4A5.json'], 'Manage Activities - Procurement / Open Activities': ['businessapp.F515172D25A42DD9476B834B1116C350.json'], 'Purchasing Category': ['businessapp.7DA7D230291A386DABF2655EBD257A60.json'], 'Create Task': ['businessapp.922CFA101A5C1166BDA7A8CA31A313EF.json'], 'Procurement-Related Activity QV': ['businessapp.23DD16DB0E3012391F1FD1D090B97DDC.json'], 'Operational Supplier Evaluation - By Supplier': ['businessapp.AFF6BBC411D6524A1E376F7CEA3676AD.json'], 'Supplier Evaluation Weighting and Scoring': ['businessapp.6231B41EBFFC60747A575E7585AFD8BD.json'], 'Operational Supplier Evaluation - Trend': ['businessapp.A92DBF8F3D5159E794B67BC2E280A618.json'], 'Off-Contract Spend - By Supplier': ['businessapp.D15368333A0C0006051B3F766B8FC133.json'], 'Change Supplier Evaluation Questionnaire': ['businessapp.5558326F481C02A8D67D07A560740BC7.json'], 'Translate Templates - Evaluation': ['businessapp.0D3DD649E4DE6B79D2AF02C3D904A3AF.json'], 'Manage Questionnaires - Evaluation': ['businessapp.9763DC4E4762B0DC8BE4BD5D3F74B3F2.json'], 'Copy Activity': ['businessapp.DA6E963AB2CB1F22C4DA1CFF9FBDF331.json'], 'Create Questionnaire - Evaluation': ['businessapp.AE22BFBACAF85E9A82CED569E6C4432F.json'], 'Purchase Requisition Item Types - By Purchasing Group': ['businessapp.5F1FB6DB76E5BA249B305A71967201BB.json'], 'Service Spend - Report / Accessible': ['businessapp.4C36F809BF96537B6601D334CD802614.json'], 'Purchasing Spend - Report / Accessible': ['businessapp.5F39AEBC47A7C09AB42072130FDFB730.json'], 'Copy Supplier Evaluation Questionnaire': ['businessapp.949137695CD2C458BCD94CC43DE4A7D8.json'], 'Product': ['businessapp.2F6744D44C0E9DE2DE3A80A7DF61CEEE.json'], 'Purchase Order Value - By Material Group': ['businessapp.9E18464FFA4344A413D1E4E3FC8AB297.json'], 'Service Spend - Report': ['businessapp.6D6D44E82A1A5CA7D9AF5134EF7B8FDF.json'], 'Translate Questionnaire Names - Evaluation': ['businessapp.B88C2E069DF76E8CA5C28D9508419665.json'], 'Manage Product Master Data': ['businessapp.29DECB0DA04BF3B28185F633BD946E92.json'], 'Procurement-Related Activity': ['businessapp.17A1B79397AB9B55B2FB94000E71E5E2.json'], 'Purchasing Spend - Report': ['businessapp.25D6066DFD1C85EE927A2A356270575F.json'], 'Display Activity': ['businessapp.66C2F76EC166D99E6A99703B504A7193.json'], 'Manage User-Defined Criteria for Supplier Evaluation': ['businessapp.6D4574D5A186CF7B69EAF6CD27B52B65.json'], 'Change Task': ['businessapp.0F20152359ED9BB08A585B830F6C12B8.json'], 'Purchase Requisition No Touch Rate - By Purchasing Group': ['businessapp.30A6CC30022136ED27466CCA4947A2DC.json'], 'Change Supplier Portfolio': ['businessapp.085EFFE171C591750910EA328E977F5B.json'], 'Manage Purchasing Categories': ['businessapp.6520803F8496438F4255BBDEFA73152F.json'], 'Display Purchasing Category': ['businessapp.ABBA1531A715517A071128C9155655D0.json'], 'Translate Purchasing Categories': ['businessapp.E60F27D5B073D2A72C390D7C66DA039A.json'], 'Non-Managed Spend - By Material Group': ['businessapp.97A979B49051B32380FEA0683A3C580D.json'], 'Translate Purchasing Category': ['businessapp.B5DA9F0F968989F9E84BBBE6AB43BC1F.json'], 'Change Purchasing Category': ['businessapp.380652A34A1B9E6A9D3AA9C144AEAA39.json'], 'Off-Contract Spend - By Material Group': ['businessapp.C1902CD80197F093A4B38B6832FAE6AA.json'], 'Manage Questions - Evaluation': ['businessapp.3AFE0E5CFC02E3522971D80C0C4CC011.json'], 'Adjust Operational Supplier Evaluation Score': ['businessapp.64CACDF279AEDAF5526F798829F9F358.json'], 'Create Activity - Procurement': ['businessapp.4ABD2C40D7EB17B60116024AA42D4978.json'], 'Translate Evaluation Template': ['businessapp.838C37F085177A9AE28987AF3E28D9D3.json'], 'Monitor Tasks - Procurement': ['businessapp.EDB23ED95BE3C01AABCDC6DBF86041A0.json'], 'Purchase Order Value - By Supplier': ['businessapp.3A5E3FD5A67BD05DA9A96BEA5ACBF555.json'], 'Display Scorecards - Evaluation Questionnaires': ['businessapp.E71988710C44F50C153E4994F50AA4EC.json']})
Title Supplier is same for apps ['businessapp.5D075792EED47E249BE082372A40D4C2.json', 'businessapp.4D152DD14C23A7CB59E42C697DD936A6.json']

[i500695@C02X632CJGH6:2019-10-31 14:22:20:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2062$ grep Supplier entities/businessapp.5D075792EED47E249BE082372A40D4C2.json
                            "semanticObject": "Supplier",
                "title": "Supplier",
                "inbound.3AA0757665595412F96E215D5FC8BDEC.title": "Supplier"
[i500695@C02X632CJGH6:2019-10-31 14:22:43:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal/uxt928_3:]2063$ grep Supplier entities/businessapp.4D152DD14C23A7CB59E42C697DD936A6.json
                            "semanticObject": "Supplier",
                "title": "Supplier",
                "inbound.FC4B3090C6135F9A2A07E54A4ECAC3B3.title": "Supplier"

 
            1.17.6.16 Create user for ert system

                1.17.6.16.1 email from wini
 
I checked the problem below. It looks like you don’t have a user (any more?) in ER9, Client 001. This is where the gateway tries to connect to. 
Please apply for a user using DLM tool: https://dlm/systemcockpit/portal/#/systemdetails/ABAPSystem/8077/A/false
Enter ER9 in the search, go to User/Authorization tab and apply for a user.

Just found out, you need also a user in Client 003
 

                1.17.6.16.2 my users
system: ER9, client 001


Please logon with the following data. 
User-ID: IZAQ 
Password: 3xz7bwRz

system: ER9, client 003


Please logon with the following data. 
User-ID: IZAQ 
Password: Mwf53ZaB
Must change password. New pwd: 1q2w3e$R

                1.17.6.16.3
            1.17.6.17 Navigation to WDA apps
problem:
URL:
https://ldciuxt.wdf.sap.corp:44311/sap/bc/webdynpro/sap/%2Fsapsdm%2Fts_dc_hello_world?sap-wd-configId=&sap-ushell-defaultedParameterNames=%5B%22sap-ushell-navmode%22%5D&sap-client=928&sap-language=en&sap-shell=FLP1.71.4&sap-density=cozy&sap-theme=sap_belize
 
Correct URL should be https://ldciuxt.wdf.sap.corp:44311/sap/bc/webdynpro/sapsdm/ts_dc_hello_world ....

For fix
have to distinguish two cases:
a. no path, e.g.
 
"defaultViz": "60FB7374F1C3B6FE3F7CE5371FC56FA2",
    "targetAppConfig": {
      "sap.integration": {
        "urlTemplateParams": {
          "wdaAppId": "MM_PUR_FPM_ANA_IPCC1",
          "wdaConfigId": "MM_PUR_FPM_ANA_IPCC1"
        },
        "urlTemplateId": "urltemplate.wda"
      },
      "sap.app": {
        "destination": "S4PRC",
        "crossNavigation": {
 
Here we have to add the /sap/
 
While for
b. path included like
 
"visualizations": {},
    "defaultViz": "",
    "targetAppConfig": {
      "sap.integration": {
        "urlTemplateParams": {
          "wdaAppId": "/SRMSMC/WDA_PUC"
        },
        "urlTemplateId": "urltemplate.wda"
      },
      "sap.app": {
        "destination": "S4PRC",
 
The /sap/ prefix is obsolete.

Amir's fix: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/129/files
--- a/examples/designtime/3.0/urltemplate/urltemplate.base.json
+++ b/examples/designtime/3.0/urltemplate/urltemplate.base.json
@@ -56,9 +56,11 @@
           "renameTo": "sap-ui-debug",
           "value": "{if({&env:isDebugMode}) &env:isDebugMode}"
         },
+        "_contentDensity": "{or &env:contentDensity,'cozy'}",
+        "_sapDensityIsCozy": "{match(^cozy$) &_contentDensity}",
         "sapDensity": {
-          "renameTo": "sap-density",
-          "value": "{if({&env:contentDensity}) &env:contentDensity}"
+          "renameTo": "sap-touch",
+          "value": "{if({&_sapDensityIsCozy}) '1','0'}"
         }
       }
     }
diff --git a/examples/designtime/3.0/urltemplate/urltemplate.wda.json b/examples/designtime/3.0/urltemplate/urltemplate.wda.json
index 7cf19ed..c037c43 100644
--- a/examples/designtime/3.0/urltemplate/urltemplate.wda.json
+++ b/examples/designtime/3.0/urltemplate/urltemplate.wda.json
@@ -6,7 +6,7 @@
     "title": "{{title}}"
   },
   "payload": {
-    "urlTemplate": "{+_baseUrl}/webdynpro/sap/{wdaAppId}{?wdaConfigId,_defaultParameterNames,startupParameters*,sapClient,sapLanguage,sapShell,sapDensity}{+sapThemeFull}",
+    "urlTemplate": "{+_baseUrl}/webdynpro{+wdaAppIdFormatted}{?wdaConfigId,_defaultParameterNames,startupParameters*,sapClient,sapLanguage,sapShell,sapDensity}{+sapThemeFull}",
     "parameters": {
       "mergeWith": ["/urlTemplates/urltemplate.base/payload/parameters/names"],
       "names": {
@@ -21,6 +21,9 @@
           "value": "{join 'FLP',&ui5Version}"
         },
         "wdaAppId": "{./sap.integration/urlTemplateParams/wdaAppId}",
+        "_wdaAppIdHasPrefix": "{match(^(/)) &wdaAppId}",
+        "_wdaAppIdPrefix": "{if({&_wdaAppIdHasPrefix}) '','/sap/'}",
+        "wdaAppIdFormatted": "{join &_wdaAppIdPrefix,&wdaAppId}",
         "wdaConfigId": {
           "renameTo": "sap-wd-configId",
           "value": "{./sap.integration/urlTemplateParams/wdaConfigId}"


Fix in console. break at
https://site-manager-saas-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/portal/~090eb94fb4b9665fd9e47f7857facbf79b3caa9e~/sap/cf/adapters/CommonDataModelAdapter-dbg.js?eval
 //handle url templates (TODO: temporary until ui5 has implementation)
                        sap.cf.adapters.CommonDataModelAdapter.handleUrlTemplateApps(nonPageApps);

then in console run:

$ oSiteWithoutPers.urlTemplates["urltemplate.wda"].payload.urlTemplate = "{+_baseUrl}/webdynpro{+wdaAppIdFormatted}{?wdaConfigId,_defaultParameterNames,startupParameters*,sapClient,sapLanguage,sapShell,sapDensity}{+sapThemeFull}"

"{+_baseUrl}/webdynpro{+wdaAppIdFormatted}{?wdaConfigId,_defaultParameterNames,startupParameters*,sapClient,sapLanguage,sapShell,sapDensity}{+sapThemeFull}"

$ oSiteWithoutPers.urlTemplates["urltemplate.wda"].payload.parameters.names["_wdaAppIdHasPrefix"] = "{match(^(/)) &wdaAppId}";
oSiteWithoutPers.urlTemplates["urltemplate.wda"].payload.parameters.names["_wdaAppIdPrefix"] = "{if({&_wdaAppIdHasPrefix}) '','/sap/'}";
oSiteWithoutPers.urlTemplates["urltemplate.wda"].payload.parameters.names["wdaAppIdFormatted"] = "{join &_wdaAppIdPrefix,&wdaAppId}"

"{join &_wdaAppIdPrefix,&wdaAppId}"

break at
https://sapui5.hana.ondemand.com/1.71.4/resources/sap/ushell/ApplicationType-dbg.js?eval
, line 246

        var sURL = URLTemplateProcessor.expand(
            oTemplateContext.payload,
            oTemplateContext.site,
            oRuntime,
            oTemplateContext.siteAppSection,
            "startupParameter"
        );

print
sURL
"https://ldcier9.wdf.sap.corp:44300/sap/bc/webdynpro/SRMSMC/WDA_I_QNR_OVP?sap-wd-configId=&sap-ushell-defaultedParameterNames=%5B%22sap-ushell-navmode%22%5D&sap-client=001&sap-language=en&sap-shell=FLP1.71.4&sap-theme=sap_fiori_3"
            1.17.6.18
        1.17.7
    1.18 Move to saar team, new jira
https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=8499

    1.19 Transport service, https://sapjira.wdf.sap.corp/secure/RapidBoard.jspa?rapidView=8499&view=detail&selectedIssue=EUXTEAMSAAR-1283

        1.19.1  general

            1.19.1.1  run locally

                1.19.1.1.1  Connect to PG docker
<url:#r=__runpostgresdocker__>
                    1.19.1.1.1.1   cat src/config/local.config.ts 
import {Inject, Injectable} from '@nestjs/common';
import {DBConnectionDto, IConfigurationDto} from './interfaces/configuration.dto';
import {IDBConfiguration} from './interfaces/configuration';
import {ILoggerFactory} from '../interfaces/logger-factory.interface';
import {Logger} from '../utils/logger';

@Injectable()
export class LocalDBConfiguration implements IDBConfiguration {

    private readonly logger: Logger;

    constructor(@Inject('ILoggerFactory') private readonly loggerFactory: ILoggerFactory) {
        this.logger = loggerFactory.getLogger(LocalDBConfiguration.name);
    }

    public getConfiguration(): IConfigurationDto {
        const config = {
            db: {
                type: 'postgres',
                hostname: 'localhost',
                username: process.env.PGUSER ?? 'postgres',
                password: process.env.PGPWD ?? 'postgres',
                synchronize: false,
                dbname: 'postgres',
                port: 5432,
                migrationsRun: true
            } as DBConnectionDto
        };
        this.logger.debug(`${LocalDBConfiguration.name}::${this.getConfiguration.name}() config object = { %s }`, config);
        return config;
    }
}

                    1.19.1.1.1.2

                1.19.1.1.2 start dev
$ npm run start:dev

                1.19.1.1.3
            1.19.1.2 intro

Acceptance Criteria
New API in Transport Service for Snapshot creation from the DCM API of the relevant Blue-Box (S/4 on-premise):
Call API and import S\4 on-premise content into sub-account 'sShared Content
Call API and import S\4 on-premise content into sub-account's Snapshot
Moskovich, Guy - will provide the information about the provider\PoC
Identify the errors and return the reason to Federation  (align with Moskovich, Guy)

Jawad's design, https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2145346234#id-[Federation][S/4HANAOnPrem]External/InternalSnapshotupdate-Implementationpoints.1


API design doc: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Transport+Services+API
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Transport+Service+API


            1.19.1.1  sequence diagrams

title Import content from external provider
participant "Semantic Service" as sem
participant "Transport Service" as trans
participant "Destination Service" as dest
participant "Connectivity Service" as conn
participant "CDM Store" as store
sem -> trans: [PUT]   /transports/{transport-type}/start
activate trans
trans->trans: check job status in redis
alt found running job
trans->sem: return 208
else new job or job canceled/failed
trans->sem: return 202
end alt
note right of trans
transport checks that state != CANCELED and running TTL not expired before every action.
If either condition is met then the job is canceled and decommited
end note
trans->trans: state->RUNNING
trans ->dest: get Destination Details
alt destination exists
dest ->trans: return destination data
trans->conn: connect to destination
alt connection establishment successful
conn->trans: connection established
note right of trans
transport expect to get entity counts from the external provider
This data should be added to each page
end note
opt pages 1...n (n can be 1)
conn->trans: return oData page_1
trans->CDM Store: import page_1
CDM Store->trans: return 200
trans->trans: update redis progress status
note right of trans
...
end note
conn->trans: return oData page_n
trans->CDM Store: import page_n
CDM Store->trans: return 200
trans->trans: update redis progress status
end
trans->store: Commit snapshot
alt commit successful
store->trans: return 200
trans->trans: State=SUCCEDED
else commit error
store->trans: return 4xx/5xx
trans->store: decommit snapshot
store->trans: return 200
trans->trans: state=FAILED
end alt
else connection establishment error
conn->trans: connection error
trans->trans: state=FAILED
end alt
else destination doesn't exists
dest ->trans: return error
trans->trans: state=FAILED
end alt
deactivate trans



title get status of all external provider content imports
participant "Semantic Service" as sem
participant "Transport Service" as trans
sem ->trans: [GET]  /transports/{transport-type}/status
trans -> trans: get status from redis
trans ->sem: return 200 and status list

title get filtered status of external provider content imports
participant "Semantic Service" as sem
participant "Transport Service" as trans
sem ->trans: [GET]  /transports/{transport-type}/status?filter=<contextType>:<contextId>
trans -> trans: get status of filtered import jobs from redis
trans ->sem: return 200 and status list


title cancel import job
participant "Semantic Service" as sem
participant "Transport Service" as trans
participant "CDM Store" as store
sem -> trans: [Post, body has list of providers]  /transports/{transport-type}/cancel
trans ->trans: If provider1 state is "RUNNING" set to "CANCELED" 
trans ->store: decommit provider1 import
store->trans: return 200
trans ->trans: If provider2 state is "RUNNING" set to "CANCELED" 
trans ->store: decommit provider2 import
store->trans: return 200
note right of trans
...
end note
trans ->trans: If providerN state is "RUNNING" set to "CANCELED" 
trans ->store: decommit providerN import
store->trans: return 200
trans -> sem: Return 200

            1.19.1.2 state machine

                1.19.1.2.1 s4 on-prem import job state machine


[i500695@C02X632CJGH6:2019-12-03 16:41:07:~/work/code/graphviz/sap:]965$ cat transport_state_machine1.gv 
digraph finite_state_machine {
    rankdir=LR;
    size="800,500"

    node [shape = doublecircle]; RUNNING;
    node [shape = point ]; qi

    node [shape = circle];
    qi -> RUNNING [ label = "got /start; ret 202" ];
    RUNNING  -> SUCCEDED [ label = "full content commited" ];
    RUNNING  -> PARTIAL [ label = "partial content commited" ];
    RUNNING  -> RUNNING  [ label = "got /start; ret 208" ];
    SUCCEDED  -> RUNNING  [ label = "got /start; ret 200" ];
    PARTIAL  -> RUNNING  [ label = "got /start; ret 200" ];
    RUNNING  -> FAILED [ label = "internal error, no backend connectivity" ];
    FAILED  -> RUNNING  [ label = "got /start; ret 200" ];
    RUNNING  -> CANCELED [ label = "got /cancel; ret 200, or running ttl expired" ];
    CANCELED  -> RUNNING  [ label = "got /start; ret 200" ];
}
 dot -T png -O transport_state_machine1.gv && open transport_state_machine1.gv.png  

id=export_site_content_state_machine

                1.19.1.2.2 export site content state machine
                cat export_state_machine.gv 
                [i500695@C02X632CJGH6:2020-02-04 16:15:12:~/work/code/graphviz/sap:]2012$  dot -T png -O export_state_machine.gv 
[i500695@C02X632CJGH6:2020-02-04 16:16:09:~/work/code/graphviz/sap:]2013$ open export_state_machine.gv.png 

                1.19.1.2.3
            1.19.1.3


        1.19.2 connectivity
SAP help: https://help.sap.com/docs/Launchpad_Service/8c8e1958338140699bd4811b37b82ece/37bd3f5c677a49c4a778ada12ee35ef0.html?q=clientcred
wiki, https://wiki.wdf.sap.corp/wiki/display/CPPortals/Transport+Service+Connectivity

links:

            1.19.2.1  Proxy
https://github.wdf.sap.corp/CentralInvgit completion, oices/cloud-system-proxy/blob/ff3266343de970986b1a79f77ddde0c097beba7d/cloud-system-proxy/srv/ProxyService.js

This is just a proxy to destination. No odata impl.

            1.19.2.2 https://blogs.sap.com/2019/03/28/announcing-the-sap-s4hana-cloud-sdk-for-javascript/

-> Tuturial: https://developers.sap.com/tutorials/s4sdkjs-getting-started.html
https://developers.sap.com/tutorials/s4sdkjs-odata-service-cloud-foundry.html

-> git
SAP/git/connectivity                                                                                                                                                        
▶ lt
total 0
drwxr-xr-x  3 i500695  staff   96 Nov 14 15:00 CentralInvoices
drwxr-xr-x  7 i500695  staff  224 Nov 18 15:58 scc-connector
drwxr-xr-x  3 i500695  staff   96 Nov 18 15:59 SAPCloudSDK

git clone --single-branch --branch scaffolding-ts --origin scaffolding https://github.com/SAP/cloud-s4-sdk-examples.git 
npm run init odataClient
npm run start:local

Step 1: Set up a local mock server or get access to the API Business Hub sandbox (optional)
Note: If you have access to an SAP S/4HANA Cloud system with a technical user, you can skip this part.

In order to make a call to an OData service, there needs to be a service to call. You can setup a local mock server that mimics the business partner and a custom service by following the instructions here. This mock server does not support all the features of the actual OData services, but it suffices to try it out locally.

Once it is up and running you should see the list of services at http://localhost:3000/.

Alternatively, many APIs can also be tested using the sandbox of the SAP API Business Hub. To use the sandbox, you need an an API key. Go to https://api.sap.com and click “Log On” in the top right corner. If you do not have an account, you will need to register first. When you are logged in, click on “Hi ” in the top right corner and then click on “Preferences” in the dropdown menu that just opened. On the preferences page, click on “Show API Key”.

Step 2: Add a custom route
Initially, the app only contains the index and hello-world routes. We will add another route for business-parters that will simply list all available business partners.

First, create a new file business-partner-route.ts in the src/ directory and add an implementation for this route, like so:

JavaScript / TypeScriptCopy
import { Request, Response } from 'express';

export function businessPartners(req: Request, res: Response) {
  res.status(200).send('We will implement this in a minute');
}
The businessPartners function is a callback function that we will register for a specific route. It writes the status 200 and a placeholder message to the response.

Then, add this route to the routes of your application in application.ts (see // add the following line to your code):

JavaScript / TypeScriptCopy
private routes(): void {
  const router = express.Router();

  router.get('/', indexRoute);
  router.get('/hello', helloWorld);
  // add the following line to your code
  router.get('/business-partners', businessPartners);
  this.app.use('/', router);
}
Should your editor not offer you to automatically add the correct import, add the following line to your import statements:

JavaScript / TypeScriptCopy
import { businessPartners } from './business-partner-route';
You can start your application by running npm run start:local. Now, calling http://localhost:8080/business-partners should return our placeholder string.

Step 3: Import service entities
In order to use the SAP Cloud SDK for JavaScript to make a call to an OData service add the virtual data model (VDM) for this service to your dependencies. For this tutorial we are using the VDM for the business partner service. Install it with the following:

ShellCopy
npm install @sap/cloud-sdk-vdm-business-partner-service
Import the entity you want to make a call to into your application. In this tutorial we are importing the business partner entity of the business partner service. Add the following line to the top of the business-partner-route.ts.

JavaScript / TypeScriptCopy
import { BusinessPartner } from '@sap/cloud-sdk-vdm-business-partner-service';
Now the BusinessPartner entity is available for you to be used.

Side-note: The SAP Cloud SDK for JavaScript offers packages for each OData service exposed by SAP S/4HANA Cloud. You can find a list of these services in the SAP API Business Hub and a list of the corresponding packages in our documentation.

Step 4: Execute an OData request
In the business-partner-route create a function getAllBusinessPartners and implement it as follows:

JavaScript / TypeScriptCopy
function getAllBusinessPartners(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      url: 'http://localhost:3000'
    });
}
In line 1, we are creating a request builder for the business partner entity.
Line 2 indicates, that we want to create a request to get all the business partners.
Line 3 ff. takes care of the execution and sends a request to a url based on the given destination url.
In the code snippet above we assume that you have a mock server running locally. If you are using an actual SAP S/4HANA Cloud system, you can replace the third line with a different destination configuration:

JavaScript / TypeScriptCopy
.execute({
  url: '<URI of your SAP S/4HANA Cloud System>',
  username: '<USERNAME>',
  password: '<PASSWORD>'
})
To use the SAP API Business Hub sandbox for your requests, you will need to pass the API key to the VDM requests using the withCustomHeaders method, and you will need to add the correct URL to your destinations. Checkout the following example:

JavaScript / TypeScriptCopy
return BusinessPartner.requestBuilder()
  .getAll()
  .withCustomHeaders({ APIKey: '<YOUR-API-KEY>'})
  .execute({
    url: 'https://sandbox.api.sap.com/s4hanacloud'
  });
}
As network requests are asynchronous by nature, the return value of this function is a Promise to a list of Business Partners (Promise<BusinessPartner[]>).

Let’s add the execution of this request to the callback for our business-partners route by making the callback async and writing the resolved return value of the getAllBusinessPartners function to the response:

JavaScript / TypeScriptCopy
export async function businessPartners(req: Request, res: Response) {
  getAllBusinessPartners()
    .then(businessPartners => res.status(200).send(businessPartners))
    .catch(error => res.status(500).send(error));
}
Here is what your business-partner-route.ts should look like, if you are using the mock server:

JavaScript / TypeScriptCopy
import { BusinessPartner } from "@sap/cloud-sdk-vdm-business-partner-service";
import { Request, Response } from "express";

export async function businessPartners(req: Request, res: Response) {
  getAllBusinessPartners()
    .then(businessPartners => res.status(200).send(businessPartners))
    .catch(error => res.status(500).send(error));
}

function getAllBusinessPartners(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      url: 'http://localhost:3000'
    });
}
Now restart your server and reload the http://localhost:8080/business-partners url to retrieve a list of business partners.


Step 5: Manage destinations centrally (optional)
In order to not repeat your destination configuration for every request execution, you can set a destinations environment variable to manage your destinations. If you prefer, you can set system wide environment variables. However, we will show you how to set them non-invasively for one project only.

We will use the dotenv npm module to facilitate setting environment variables on a node process.

# install dotenv as a devDependency
npm install --save-dev dotenv
Then create a .env file in the root directory of your project and define your a destinations environment variable as follows:

destinations=[{"name": "<DESTINATIONNAME>", "url": "<URL to your system>", "username": "<USERNAME>", "password": "<PASSWORD>"}]
This is what it would look like for the mock server:

destinations=[{"name": "MockServer", "url": "http://localhost:3000"}]
Now to reference a destination in the request execution, simply replace the url with a destinationName - MockServer in our example:

JavaScript / TypeScriptCopy
function getAllBusinessPartners(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      destinationName: 'MockServer'
    });
}
Note, that every environment variable in the .env file has to be defined on one line. You can add more destinations to the array.

In order to register the .env file in your node process, adjust the "start:local" script in the package.json as follows:

"start:local": "npx ts-node -r dotenv/config src/"
Now, when you execute npm run start:local and call localhost:8080/business-partners, you can also use your remote destination locally.

                1.19.2.2.1  deploy destination connector to CF


https://developers.sap.com/tutorials/s4sdkjs-deploy-application-cloud-foundry.html
-> transpile
npm run ci-build && npm run ci-package

[i500695@C02X632CJGH6:2019-11-18 18:18:02:~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-examples:]194$ cat manifest.yml 
applications:
  - name: odataClient
    path: deployment/
    buildpacks:
      - nodejs_buildpack
    memory: 256M
    command: cd dist/ && node index.js
    random-route: true
    services:
        - portal-destination
        - my-xsuaa

[i500695@C02X632CJGH6:2019-11-18 18:18:07:~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-examples:]195$ cat xs-security.json 
{
  "xsappname": "odataClient",
  "tenant-mode": "shared"
}

-> note, binding to portal-destination, if this doesn't work create destination
service.
cf create-service destination lite my-destination

-> create xsuaa 
cf create-service xsuaa application my-xsuaa -c xs-security.json

-> reuse xsuaa

->  adapt the getAllBusinessPartners function in business-partner-route.ts to use the destination defined in the Cloud Platform Cockpit.
function getAllBusinessPartners(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      destinationName: 'BusinessPartnerService'
    });
}

~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-examples:]201$ cat !$
cat src/business-partner-route.ts
import { Request, Response } from 'express';
import { BusinessPartner } from '@sap/cloud-sdk-vdm-business-partner-service';

export async function businessPartners(req: Request, res: Response) {
  getAllBusinessPartners()
    .then(businessPartners => res.status(200).send(businessPartners))
    .catch(error => res.status(500).send(error));
}


//This is for local version
function getAllBusinessPartners_local(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      url: 'http://localhost:3000'
//        username: '<USERNAME>',
//  password: '<PASSWORD>'
    });
}

//This is for CF version
function getAllBusinessPartners(): Promise<BusinessPartner[]> {
  return BusinessPartner.requestBuilder()
    .getAll()
    .execute({
      destinationName: 'uxt_928'
    });
}

$ npm run ci-build && npm run ci-package && cf push



            1.19.2.3 local mock odata server

                1.19.2.3.1 by hacking an existing app

https://sap.github.io/cloud-s4-sdk-book/pages/mock-odata.html

git: https://github.com/SAP/cloud-s4-sdk-book
git clone https://github.com/SAP/cloud-s4-sdk-book.git
gitcoNewLocalTrackingBr mock-server    

git pull                                   
    fatal: refusing to merge unrelated histories
git pull origin master --allow-unrelated-histories


~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-book-mock-server  mv ~/Downloads/API_BUSINESS_PARTNER.edmx business-partner 

 i500695@C02X632CJGH6  ~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-book-mock-server  npm i                                                    ✔  251  16:34:53
npm WARN bupa-mock-odata@1.0.0 No repository field.

added 49 packages from 50 contributors and audited 119 packages in 0.923s
found 2 moderate severity vulnerabilities
  run `npm audit fix` to fix them, or `npm audit` for details
 i500695@C02X632CJGH6  ~/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-book-mock-server  npm start                                                ✔  252  16:34:58

> bupa-mock-odata@1.0.0 start /Users/i500695/work/SAP/git/connectivity/SAPCloudSDK/cloud-s4-sdk-book-mock-server
> node app.js

Mock server started on port 3000 after 75 ms, running - stop with CTRL+C (or CMD+C)...
Request: GET /sap/opu/odata/sap/API_BUSINESS_PARTNER
Request: GET /favicon.ico

GET http://localhost:3000/sap/opu/odata/sap/API_BUSINESS_PARTNER


                1.19.2.3.2 By using a simple http server app, Asaf mock provider
                id=__Asaf_destination__mock_provider__

                    1.19.2.3.2.1 Asaf destination mosko team old mock provider, tags: Asaf destination mosko team old mock provider
S4 mock http servier 

Git: https://github.wdf.sap.corp/Portal-CF/portal-cf-dev-utils-service
~/work/SAP/git:]2003$ git clone https://github.wdf.sap.corp/Portal-CF/portal-cf-dev-utils-service.git
cdguydevutils

Copy json to public

Deploy app to PaaS launchpad provider
Example route, 
      - route: portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils
Example manifest:
cat /Users/i500695/work/SAP/CF/Manifests/portal-cf-dev-utils-service/manifest_i500695p.yml | pbcopy
---
applications:
  - name: portal-cf-dev-utils-service
    memory: 1G
    stack: cflinuxfs3
    routes:
      #- route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/devutils
      - route: portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils
      # ex:
      #- route: portal-service-asafma-i500553.cfapps.sap.hana.ondemand.com/devutils
    buildpacks:
      - https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.16
    command: npm install && npm start
    instances: 1
    services:
      - portal-xsuaa-broker


Add destination to consumer SaaS account

Set path to app. eg:
https://portal-service-devservice-asaf-i500553.cfapps.sap.hana.ondemand.com/devutils/static/uyz1.json

content-prov- mock content app:
My Saar global account launchpad SaaS account: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/destinations

i310019launchpad https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/52fe6583-1cff-4ab1-93d7-e5c0055b0005/subaccount/0af65570-fe15-453e-a785-3dcf264c8c9d/org/5196aecc-9114-4176-83a0-0f81d8f2cb58/space/c675069b-9fc5-472b-8774-9e54de3cdcd1/applications

exisiting content:
 ls public/
entities_max_payload_length_exceeded.json	uyz.json					uyz1_with_custom_tile_with_smb.json
spaces_pages.json				uyz1.json
uyz-missing-app.json				uyz1_with_custom_tile.json

                    1.19.2.3.2.2 add x509 support

certificates: <url:/Users/i500695/work/KB/nodejsKB#r=__prepare_x509_certs_node__>
                        1.19.2.3.2.2.1 branch: yosi_03_12_20__11_59
add env var to control x509 connection, default plain auth
$ grep AUTH manifest.yml 
      AUTH_TYPE: 'x509'

add certificates
x509 dir

add toggled x509 server code

When not toggled connection will fail. see:
[i500695@C02X632CJGH6:2021-02-02 16:01:30:~/work/code/nodejs/net/x509server:]2016$ node axio_client.js 
ECONNREFUSED
[i500695@C02X632CJGH6:2021-02-02 16:01:33:~/work/code/nodejs/net/x509server:]2017$ openssl s_client -CAfile x509/server-ca-crt.pem -cert x509/client-crt.pem -key x509/client-key.pem -connect localhost:3000 < /dev/null
CONNECTED(00000005)
4563086848:error:1408F10B:SSL routines:ssl3_get_record:wrong version number:ssl/record/ssl3_record.c:332:
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 5 bytes and written 293 bytes
Verification: OK
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---

toggle x509 auth

export AUTH_TYPE=x509

-- Diffs
diff --git a/manifest.yml b/manifest.yml
index 55aaf68..4598c75 100644
--- a/manifest.yml
+++ b/manifest.yml
@@ -11,5 +11,7 @@ applications:
       - https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.16
     command: npm install && npm start
     instances: 1
+    env:
+      AUTH_TYPE: 'x509'
     services:
       - portal-xsuaa-broker
diff --git a/src/app.js b/src/app.js
index 4db0338..0374585 100644
--- a/src/app.js
+++ b/src/app.js
@@ -2,13 +2,47 @@
 
 const express = require('express');
 const http = require('http');
+const https = require('https');
+const fs = require('fs');
 const app = express();
 const helmet = require('helmet');
 const log = require('cf-nodejs-logging-support');
 
+const x509_options = {
+    key: fs.readFileSync(appRoot+'/../x509/server-key.pem'),
+    cert: fs.readFileSync(appRoot+'/../x509/server-crt.pem'),
+    ca: fs.readFileSync(appRoot+'/../x509/client-ca-crt.pem'),
+    requestCert: true,
+    rejectUnauthorized: true,
+};
+
+const isHttps = (process.env.AUTH_TYPE === 'x509')
+
+app.use(function (req, res, next) {
+    console.log(req.url);
+    next();
+});
 app.use(helmet());
 
-const server = http.createServer(app);
+let server;
+if (isHttps) {
+    app.use(function (req, res, next) {
+        log.info('X509 ATN/ATZ middleware activated');
+        if (! req.client.authorized) {
+            log.info('ATZ failed');
+            return res.status(401).send('User is not authorized');
+        }
+        log.info('checking peer certificate');
+        const cert = req.socket.getPeerCertificate();
+        if (cert.subject) {
+            log.info('cert subject', cert.subject.CN);
+        }
+        next();
+    });
+    server = https.createServer(x509_options, app);
+} else {
+    server = http.createServer(app); 
+}
 
 log.setLoggingLevel('info');
 app.use(log.logNetwork);
diff --git a/src/index.js b/src/index.js
index eb5e74f..9e7c15d 100644
--- a/src/index.js
+++ b/src/index.js
@@ -1,7 +1,10 @@
 'use strict';
 
+const path = require('path');
+global.appRoot = path.resolve(__dirname);
+
 const log = require('cf-nodejs-logging-support');
 const PORT = process.env.PORT || 3000;
 const app = require('../src/app');
 
-app.listen(PORT, () => log.info(`Server running at port : ${PORT}`));
+app.listen(PORT, () => log.info(`Server running at port : ${app.address().port}`));

-- axios client
[i500695@C02X632CJGH6:2021-02-02 17:49:28:~/work/code/nodejs/net/x509server:]2033$ cat axio_client.js  |pbcopy
const fs = require('fs');
const https = require('https');
const axios = require('axios');

// use for my demo x509 server
// const port = '4433';
// const urlpath= ''

// use for my mock provider  x509 server
const port = '3000';
let urlpath= '/devutils/static/uyz.json'

const httpsAgent = new https.Agent({
    cert: fs.readFileSync(__dirname + '/x509/client-crt.pem'),
    key: fs.readFileSync(__dirname + '/x509/client-key.pem'),
    rejectUnauthorized: false, // required to prevent UNABLE_TO_VERIFY_LEAF_SIGNATURE error
    passphrase: '1234',
    // pfx: fs.readFileSync(__dirname + '/x509/client-crt.pfx'),
    // ca: [fs.readFileSync(__dirname + '/x509/server-ca-crt.pem')],
    // maxVersion: 'TLSv1.3',
    // minVersion: 'TLSv1.3',
     ca: fs.readFileSync('x509/server-ca-crt.pem'),
});

urlpath='https://localhost'+':'+port+urlpath;
console.log('url: ', urlpath);
axios.get(urlpath, { httpsAgent }).then((response) => {
    console.log(response.data);
}, (error) => {
    console.log(error.code);
});



                        1.19.2.3.2.2.2 test locally
    --- server
    cd ~/work/SAP/git/portal-cf-dev-utils-service

 export AUTH_TYPE=x509
 node src/index.js 

    --- client
    [i500695@C02X632CJGH6:2021-02-02 17:49:43:~/work/code/nodejs/net/x509server:]2034$ node axio_client.js 

-- 

                        1.19.2.3.2.2.3 Deploy x509 mock provider
Go to SaaS destinations:, ex, My Saar global account launchpad SaaS account: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/destinations

copy from x509 the client pfx + server CA to Downloads
cd ~/work/code/nodejs/net/x509server
[i500695@C02X632CJGH6:2021-02-04 11:30:06:~/work/code/nodejs/net/x509server:]2005$ cp x509/client-crt.pfx  ~/Downloads/
[i500695@C02X632CJGH6:2021-02-04 11:30:33:~/work/code/nodejs/net/x509server:]2006$ cp x509/server-ca-crt.pem  ~/Downloads/
Upload to new destination configuration
https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/destinations -> Upload and Delete Certificates

for self signed Certificates uncheck "Use default JDK truststore", upload server ca cert
note pem not supported so convert to der

current status.
works locally.
On CF fails on 502 bad gateway

                        1.19.2.3.2.2.3
                    1.19.2.3.2.3 Mock provider returning always 500 (test retry strategy)

                        1.19.2.3.2.3.1 code
branch: yosi_return_500
code:
[i500695@C02X632CJGH6:2021-03-29 17:50:48:~/work/SAP/git/portal-cf-dev-utils-service:]2030$ gitd
diff --git a/manifest.yml b/manifest.yml
index 3601b05..4e79f65 100644
--- a/manifest.yml
+++ b/manifest.yml
@@ -4,8 +4,8 @@ applications:
     memory: 1G
     stack: cflinuxfs3
     routes:
-      - route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/devutils
-      - route: portal-service-mock-provider.cfapps.sap.hana.ondemand.com/devutils
+      #- route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/devutils
+      - route: portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils
       # ex:
       #- route: portal-service-asafma-i500553.cfapps.sap.hana.ondemand.com/devutils
     buildpacks:
diff --git a/src/routes.js b/src/routes.js
index 8c677bc..fcc42ce 100644
--- a/src/routes.js
+++ b/src/routes.js
@@ -9,14 +9,15 @@ module.exports = (app) => {
      * DeltaLink in the body
      */
     app.get('/devutils/static/:filename', async function (req, res) {
-        try {
-            const data = await fs.readFile(`./entities/${req.params.filename}`, 'utf8');
-            res.setHeader('Preference-Applied', 'odata.track-changes');
-            res.status(200).json(JSON.parse(data));
-        } catch (err) {
-            console.log(err);
-            res.status(500).json(err);
-        }
+        res.status(500).json("");
+        // try {
+        //     const data = await fs.readFile(`./entities/${req.params.filename}`, 'utf8');
+        //     res.setHeader('Preference-Applied', 'odata.track-changes');
+        //     res.status(200).json(JSON.parse(data));
+        // } catch (err) {
+        //     console.log(err);
+        //     res.status(500).json(err);
                        1.19.2.3.2.3.2 deploy and configure
[i500695@C02X632CJGH6:2021-03-29 17:57:35:~/work/SAP/git/portal-cf-dev-utils-service:]2032$ cf push

configure.
a. SaaS consumer destinations:
https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/destinations

b. configure. e.g.
#
#Mon Mar 29 15:00:30 UTC 2021
URL=https\://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/uyz.json
Name=yosi_mock_provider
ProxyType=Internet
Type=HTTP
Authentication=NoAuthentication
Description=A mock provider set for mass content exceeding size limit

id=__retry_strat_transport_change__
                        1.19.2.3.2.3.3 test
provider-manager (https://i500695launchpad-dt-launchpad-launchpadi500695p.cfapps.sap.hana.ondemand.com/sites#Provider-Manage?sap-app-origin-hint=)
add provider. (+new)
set designtime-destination and runtime-destination to yosi_mock_provider

                        1.19.2.3.2.3.4 logs
2021-03-29T17:56:35.42+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ODataProxyAsyncIterable:103 ODataProxyAsyncIterable::addSapClientQueryParamToUrl() called
2021-03-29T17:56:35.42+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ODataProxyAsyncIterable:103 odata generator. using subdomain "i500695launchpad"
2021-03-29T17:56:35.42+0300  6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService::request() starting connectivity request
2021-03-29T17:56:35.42+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 Internet request
2021-03-29T17:56:35.42+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 connectivity service requestInfo = "{\"authentication\":{},\"method\":\"GET\",\"url\":\"https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/uyz.json\",\"userToken\":\"eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vaTUwMDY5NWxhdW5jaHBhZC5hdXRoZW50aWNhdGlvbi5zYXAuaGFuYS5vbmRlbWFuZC5jb20vdG9rZW5fa2V5cyIsImtpZCI6ImRlZmF1bHQtand0LWtleS0tMTE1OTI4MDY4NCIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI1MzYxMGJiYWMwNWE0OGNhOWRlOWFkZTA4MTdlYzI0MCIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJzdWJhY2NvdW50aWQiOiI0NzJhYmRlZS1jN2E0LTQzNTctODBlZC0zYTQ5MGNjOTQ2MjIiLCJ6ZG4iOiJpNTAwNjk1bGF1bmNocGFkIiwic2VydmljZWluc3RhbmNlaWQiOiIyOWEyMTRmMS02YTg5LTRkMzgtOWUwZS1kNzYyNTcxMzkxY2MifSwieHMuc3lzdGVtLmF0dHJpYnV0ZXMiOnsieHMucm9sZWNvbGxlY3Rpb25zIjpbIkxhdW5jaHBhZF9BZG1pbi1sYXVuY2hwYWRpNTAwNjk1cCIsIlBvcnRhbF9BZG1pbi1sYXVuY2hwYWRpNTAwNjk1cCIsIldvcmt6b25lX0FkbWluLWxhdW5jaHBhZGk1MDA2OTVwIiwiV29ya2Zsb3dfQWRtaW4tbGF1bmNocGFkaTUwMDY5NXAiXX0sImdpdmVuX25hbWUiOiJZb3NpIiwieHMudXNlci5hdHRyaWJ1dGVzIjp7fSwiZmFtaWx5X25hbWUiOiJJemFxIiwic3ViIjoiMjFlYjc1MDctOTQ3My00ZjZlLWJmMzctZWQxNWY0YTMzMGFjIiwic2NvcGUiOlsicG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwLlRoZW1lQWRtaW4iLCJvcGVuaWQiLCJ4c19hdXRob3JpemF0aW9uLndyaXRlIiwidWFhLnVzZXIiLCJ4c19hdXRob3JpemF0aW9uLnJlYWQiLCJwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpNTAwNjk1cCFiMTQ0MDAuU3VwZXJBZG1pbiJdLCJjbGllbnRfaWQiOiJzYi0yOWEyMTRmMS02YTg5LTRkMzgtOWUwZS1kNzYyNTcxMzkxY2MhYjE0NDAwfHBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGk1MDA2OTVwIWIxNDQwMCIsImNpZCI6InNiLTI5YTIxNGYxLTZhODktNGQzOC05ZTBlLWQ3NjI1NzEzOTFjYyFiMTQ0MDB8cG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiYXpwIjoic2ItMjlhMjE0ZjEtNmE4OS00ZDM4LTllMGUtZDc2MjU3MTM5MWNjIWIxNDQwMHxwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpNTAwNjk1cCFiMTQ0MDAiLCJncmFudF90eXBlIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmdyYW50LXR5cGU6and0LWJlYXJlciIsInVzZXJfaWQiOiIyMWViNzUwNy05NDczLTRmNmUtYmYzNy1lZDE1ZjRhMzMwYWMiLCJvcmlnaW4iOiJzYXAuY3VzdG9tIiwidXNlcl9uYW1lIjoieW9zaS5pemFxQHNhcC5jb20iLCJlbWFpbCI6Inlvc2kuaXphcUBzYXAuY29tIiwicmV2X3NpZyI6IjQ3OGIzM2FmIiwiaWF0IjoxNjE3MDI5NjY2LCJleHAiOjE2MTcwNzI4NjYsImlzcyI6Imh0dHBzOi8vaTUwMDY5NWxhdW5jaHBhZC5hdXRoZW50aWNhdGlvbi5zYXAuaGFuYS5vbmRlbWFuZC5jb20vb2F1dGgvdG9rZW4iLCJ6aWQiOiI0NzJhYmRlZS1jN2E0LTQzNTctODBlZC0zYTQ5MGNjOTQ2MjIiLCJhdWQiOlsidWFhIiwib3BlbmlkIiwicG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwic2ItMjlhMjE0ZjEtNmE4OS00ZDM4LTllMGUtZDc2MjU3MTM5MWNjIWIxNDQwMHxwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpNTAwNjk1cCFiMTQ0MDAiLCJ4c19hdXRob3JpemF0aW9uIl19.e4fbFiZjUUmc9WWc4UnHr7_F6P2V-1OaAzTGKjXZdMOs5m336QxYB-5e05SPYmGqHSeexoTMJqpystie4RADuTss-to0txS5e17noOObrzLcs5z_7_r8wl3dRca3A922P6G15pvOSgwNgNiN11388cDS-c8kK8unYxm6E3aNYhfPjQcg-2t6-DUQqFNbK0Fk4Q1pvr58FoHXuIXfDHJB883w1ERGo6L1tZ9irPBk7RnSkM4UXGhweeYzun4dslyQBeY3qkPovlrsKEhwTc6yEgRNPwPFbhk6li7NKki5iqZG-35dkYXyb9pbgiHNlV-TcVayw2YLlUjDqMuT8dw_Sg\",\"subDomain\":\"i500695launchpad\",\"path\":\"\",\"proxyType\":\"Internet\",\"headers\":{}}"
2021-03-29T17:56:35.42+0300  6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService::sendRequest() sending request to, base url https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/uyz.json, url https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/uyz.json
2021-03-29T17:56:35.42+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 connectivity service config = "{\"timeout\":30000,\"method\":\"GET\",\"baseURL\":\"https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/uyz.json\",\"url\":\"\",\"headers\":{\"Prefer\":\"odata.track-changes, maxpagesize=200\"},\"raxConfig\":{\"retry\":10}}"
2021-03-29T17:56:35.48+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#1
2021-03-29T17:56:35.49+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#2
2021-03-29T17:56:36.02+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#3
2021-03-29T17:56:37.54+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#4
2021-03-29T17:56:41.08+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#5
2021-03-29T17:56:48.65+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#6
2021-03-29T17:57:04.18+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#7
2021-03-29T17:57:35.71+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#8
2021-03-29T17:58:39.26+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#9
2021-03-29T18:00:46.79+0300 DEBUG 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 ConnectivityService: request without proxy retry attempt#10
2021-03-29T18:05:02.34+0300 ERROR 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 request ended with errors : Error: Request failed with status code 500, error response : undefined. stack trace = Error: Error: Request failed with status code 500
    at ConnectivityService.sendRequest (/home/vcap/app/dist/proxy/connectivity/connectivity.service.js:192:23)
    at processTicksAndRejections (internal/process/task_queues.js:93:5)
    at async ConnectivityService.request (/home/vcap/app/dist/proxy/connectivity/connectivity.service.js:87:35)
2021-03-29T18:05:02.34+0300 ERROR 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ODataProxyAsyncIterable:103 ODataProxyAsyncIterable::asyncIterator() encountered an error fetching page . error = { Error: Request failed with status code 500 }
2021-03-29T18:05:02.34+0300 ERROR 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  TransportJob:103 TransportJob::startTransport() error while transporting dcm content. error = Error: Request failed with status code 500. stack trace = Error: Error: Request failed with status code 500
    at ConnectivityService.request (/home/vcap/app/dist/proxy/connectivity/connectivity.service.js:95:23)
    at processTicksAndRejections (internal/process/task_queues.js:93:5)
2021-03-29T18:05:02.34+0300  6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  TransportJob:103 TransportJob::decommitJob() decommiting job with key : {"contextId":"test7","contextType":"SNAPSHOT","tenantId":"472abdee-c7a4-4357-80ed-3a490cc94622","instanceId":"29a214f1-6a89-4d38-9e0e-d762571391cc","transportId":"7c009309-af7a-4d15-8714-43d414dc90ee"}
2021-03-29T18:05:02.34+0300  6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  CdmClientService:103 CdmClientService::decommit() decommitting job with params =  {"transactionParams":[{"context":{"contextId":"test7","contextType":"SNAPSHOT","tenantId":"472abdee-c7a4-4357-80ed-3a490cc94622","instanceId":"29a214f1-6a89-4d38-9e0e-d762571391cc","transportId":"7c009309-af7a-4d15-8714-43d414dc90ee"}}]}
2021-03-29T18:05:02.34+0300    CdmStoreClientImportHandler:113 - CdmStoreClientTransportHandler::decommit(): decommitting on contexts =  [ { contextType: 'SNAPSHOT', contextId: 'test7' } ]

retry backoff times:
2021-03-29T17:56:35.48+0300 retry attempt#1, 
2021-03-29T17:56:35.49+0300 retry attempt#2, 100 ms
2021-03-29T17:56:36.02+0300 retry attempt#3, 710 ms
2021-03-29T17:56:37.54+0300 retry attempt#4, 1520 ms
2021-03-29T17:56:41.08+0300 retry attempt#5, 3520 ms
2021-03-29T17:56:48.65+0300 retry attempt#6, 8570 ms
2021-03-29T17:57:04.18+0300 retry attempt#7, ~ 12 sec
2021-03-29T17:57:35.71+0300 retry attempt#8, ~ 31 sec
2021-03-29T17:58:39.26+0300 retry attempt#9, ~ 64 sec
2021-03-29T18:00:46.79+0300 retry attempt#10, 120 sec
2021-03-29T18:05:02.34+0300 ERROR 6d82e227-1ef2-4cd4-7582-5dc9fcd13b4e  ConnectivityService:103 request ended with errors : Error: Request failed with status code 500, error response : undefined. stack trace = Error: Error: Request failed with status code 500, 256 sec

                        1.19.2.3.2.3.5
                    1.19.2.3.2.4
                1.19.2.3.3
            1.19.2.4
        1.19.3
                    1.19.2.3.2.4
                1.19.2.3.3
            1.19.2.4
        1.19.3 generate odata client: https://developers.sap.com/tutorials/cloudsdk-js-generator.html
SAP sdk git, https://github.wdf.sap.corp/MA/sdk-js/issues
-> Init 
~/work/SAP/git/connectivity/SAPCloudSDK/sapVDM_OdataClient  npm init                                                            ✔  633  14:09:19
This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.

See `npm help json` for definitive documentation on these fields
and exactly what they do.

Use `npm install <pkg>` afterwards to install a package and
save it as a dependency in the package.json file.

Press ^C at any time to quit.
package name: (sapvdm_odataclient) 
version: (1.0.0) 
description: S4 Odata Client using SAP VDM libs
entry point: (index.js) 
test command: test
git repository: 
keywords: 
author: Yosi Izaq
license: (ISC) 
About to write to /Users/i500695/work/SAP/git/connectivity/SAPCloudSDK/sapVDM_OdataClient/package.json:

{
  "name": "sapvdm_odataclient",
  "version": "1.0.0",
  "description": "S4 Odata Client using SAP VDM libs",
  "main": "index.js",
  "scripts": {
    "test": "test"
  },
  "author": "Yosi Izaq",
  "license": "ISC"
}


Is this OK? (yes) 
 i500695@C02X632CJGH6  ~/work/SAP/git/connectivity/SAPCloudSDK/sapVDM_OdataClient  vi .npmrc    
cat .npmrc                                                SIGINT(2) ↵  635  14:12:00
@sap:registry=https://npm.sap.com

npm install --save-dev @sap/cloud-sdk-generator

Download the service specification file from the SAP API Business Hub. In the aforementioned Candidate service navigate to Details and press Download Specification. Choose EDMX to download a file called RCMCandidate.edmx. Don’t close this page yet, because you will still need it in one of the next steps.

 mv ~/Downloads/RCMCandidate.edmx .
  npx generate-odata-client --inputDir service-specifications --outputDir odata-client

This will leave you with the following comment:

No service path could be determined from available metadata! To avoid this in the future, you can provide the correct value in “service-mapping.json”. By default, the “service-mapping.json” file will be saved to and read from the input directory. You can supply a custom path using the -s/--serviceMapping flag.

Some service specifications do not specify a service path. The service path is the part of the URL that points to a service. As we do not want to assume any paths, the value will therefore be set to "VALUE_IS_UNDEFINED" and has to be replaced manually. You can add a service path in the service.mapping.json that was created in your input directory.

Replace the value for servicePath with the one for your service. The SAP SuccessFactors services that are available on the SAP API Business Hub have the service path '/odata/v2'.
so in file
/Users/i500695/work/SAP/git/connectivity/SAPCloudSDK/sapVDM_OdataClient/service-specifications/service-mapping.json,
change line:
    "servicePath": "VALUE_IS_UNDEFINED",

to 
    "servicePath": "/odata/v2",

rerun generation with --forceOverwrite
npx generate-odata-client --inputDir service-specifications --outputDir odata-client --forceOverwrite

Create a source file get-candidates.ts in the src directory and import the Candidate entity from the sfo-data-service module.
Now use this entity to create a getAll request while selecting the properties FIRST_NAME and LAST_NAME and execute it against a destination. You can connect to the SAP API Business Hub SuccessFactors services by using the URL https://sandbox.api.sap.com/successfactors.

You will also need to provide your API Key. You can find it on the top of the SAP API Business Hub page. Simply click on Show API Key and then Copy Key and Close. Add the key as a custom header, using the withCustomHeaders function.

For further information on how to configure a destination check our previous tutorials on how to create an app using SAP Cloud SDK for JavaScript and on how to build an application with the Virtual Data Model.

// get-candidates.ts

import { Candidate } from './odata-client/sfo-data-service';

export function getCandidates(): Promise<Candidate[]> {
  return Candidate.requestBuilder()
    .getAll()
    .top(20) // look at the top 20 candidates only
    .select(Candidate.FIRST_NAME, Candidate.LAST_NAME)
    .withCustomHeaders({
      apikey: '<YOUR-API-KEY>'
    })
    .execute({
      url: 'https://sandbox.api.sap.com/successfactors'
    });
}

        1.19.4 Cloud connector and S/4HANA OnPrem backend system, Noboru Ora blog
https://blogs.sap.com/2019/04/02/a-do-it-yourself-at-home-guide-how-to-connect-a-node.js-app-on-sap-cloud-platform-for-the-cloud-foundry-to-an-s4hana-on-premise-system-securely-via-cloud-connector/


            1.19.4.1 blog
Manually define your destination in your subaccount
Manually define services instances (destination service, connectivity service, and UAA service) in your space, skipping binding and other optional steps
Use CLI to upload your app – this automatically binds your apps to service instances

Destination
Note that destinations are defined at a different level than the other “instances of services”.
(To complicate things for a beginner, it seems you can define a destination specific to an instance of destination service, but you can forget this for now).

The URL needs to be identical with the one you set in your Cloud Connector
Note the Authentication field, and user/password…

S4H_MM is a dialog user with SAP_ALL authorization. Not ideal for security. But this would probably work as a proof of concept, or even for a development environment (if you at least replaced the user with a system or service user).

Instances of Destination Service, Connectivity Service, and UAA Service
After you defined your destination, move down to your “dev” space. That’s where you find the Services and Service Marketplace to define instances of destination service, and other services.

Note that all the service instances have “None” in the Referencing Applications. If you have done differently, you might already have “bound” (bind) some apps. This is fine. You can manually bind apps to service instances in this web interface, or you can also do this in a file in the source of your app you upload. In the case of latter, the system will automatically bind your apps to service instances as instructed in the source code file – you will see it in my source code of the Node.js app.

app-router. use our dt-approuter

node.js app
Interactions among diy-app, SCP, and Cloud Connector
Most of my efforts went into making of ConnectSCC.js.  It is the one that deals with what’s needed for diy-app deployed on the CF environment of SCP to interact with Cloud Connector.

The key is, once understood, simple. You need to construct the HTTP header correctly, as required by SCP to connect to Cloud Connector with proxy host. I will let the source code explain.

ConnectSCC.js has two heritages:

Bert Deterd’s npm package, scc-connector: https://github.com/bertdeterd/scc-connector
Ralph Oliveira’s tutorial/sample code where it handles destination services (Destination.js and Utils.js)This is introduced by Maria Trinidad MARTINEZ GEA in her blog
 

My ConnectSCC.js is essentially a fork of scc-connector. You can see that the basic ways of handling Express.js middleware and axios are the same.

I could not get Bert’s original scc-connector working. I enhanced it with some elements I borrowed from Ralpth’s code. His code handles destination services well. This way, you can also handle basic authentication to the S/4HANA on-premise system, which scc-connector does not.

            1.19.4.2 code

            1.19.4.3 my tests

            1.19.4.4 Use the Application Router in Cloud Foundry to Connect to ABAP System

            https://developers.sap.com/tutorials/cp-connectivity-consume-odata-service-approuter.html

        1.19.5 destination service

        1.19.6 connectivity service
        
            1.19.6.1 documentation


        https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/SA0225001210/subaccount/c87ade1a-5a38-4801-bc19-a15062b7c501/org/30a2b668-3401-4514-8853-2a9bb77c6fa2/space/9896fbd5-7bb5-4a27-abe3-604e40d9f394/app/7134bf9d-6202-4fb9-8733-e726fa3cba51/overview

                1.19.6.1.1 On S4 on-prem side, install and configure cloud connector
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/57ae3d62f63440f7952e57bfcef948d3.html

tar -xzof sapcc-<version>-linux-x64.tar.gz 
service scc_daemon stop|restart|start|status

configure
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/db9170a7d97610148537d5a84bf79ba2.html


                1.19.6.1.2 Cloud-Platform side

Prerequisites

You must be a Global Account member to connect through the Connectivity service with the Cloud Connector. See Add Members to Your Global Account [AWS, Azure, or GCP Regions].

Also Security Administrators (which must be either Global Account members or Cloud Foundry Organization/Space members) can do it. See Security Administrators in Your Subaccount [AWS, Azure, or GCP Regions].
Note
To connect a Cloud Connector to your subaccount, you must currently be a Security Administrator.

You have installed and configured a Cloud Connector in your on-premise landscape for to the scenario you want to use. See Installation and Configuration.
You have deployed an application in a landscape of the Cloud Foundry environment that complies with the Business Application Pattern.
Your application is secured as described in Configuring Authentication for Java API Using Spring Security.
The Connectivity service is a regular service in the Cloud Foundry environment. Therefore, to consume the Connectivity service from an application, you must create a service instance and bind it to the application. See Create and Bind a Connectivity Service Instance.
To get the required authorization for making on-premise calls through the connected Cloud Connector, the application must be bound to an instance of the xsuaa service using the service plan 'application'. The xsuaa service instance acts as an OAuth 2.0 client and grants user access to the bound application. See also: Create a Service Instance from the xsuaa Service and Bind the xsuaa Service Instance to the Application. Make sure you set the xsappname property to the name of the application when creating the instance. Find a detailed guide for this procedure in section 3. Creation of the Authorization & Trust Management Instance (aka XSUAA) of the SCN blog How to use SAP Cloud Platform Connectivity and Cloud Connector in the Cloud Foundry environmentInformation published on SAP site.
Note
Currently, the only supported protocol for connecting the Cloud Foundry environment to an on-premise system is HTTP. HTTPS is not needed, since the tunnel used by the Cloud Connector is TLS-encrypted.

                    1.19.6.1.2.1 Create and Bind a Connectivity Service InstanceUse the following CLI commands to create a service instance and bind it to an application:
-> cli
cf marketplace
cf create-service connectivity <service-plan> <service-name>
cf bind-service <app-name> <service-name>
Back to Procedure

Example
To bind an instance of the Connectivity service "lite" plan to application "myapp", use following commands on the Cloud Foundry command line:

cf create-service connectivity lite myinstance

cf bind-service myapp myinstance


-> GUI
Create and Bind a Service Instance from the Cockpit
Note
For the Beta version, the cloud cockpit is not yet available. Use the corresponding CLI commands instead.
Assuming that you have already deployed your application to the platform, follow these steps to create a service instance and bind it to an application:

In the SAP Cloud Platform Cockpit, navigate to your application.
From the left navigation menu, choose Service Bindings.
Choose the Bind Service button.
The Bind Service wizard appears.
Select the service from the catalog radio button, then choose Next.
From the list of available services, select connectivity, then choose Next.

On the next page of the wizard, select the Create new instance radio button.
From the drop-down box, select a service plan, then choose Next.
The next page is used for specifying user-provided parameters in JSON format. If you do not want to do that, skip this step by choosing Next.
In the <Instance Name> textbox, enter an unique name for your service instance, for example, conn-lite.
Choose Finish.


-> Result
When the binding is created, the application gets the corresponding connectivity credentials in its environment variables:

Sample Code
"VCAP_SERVICES": {
 "connectivity": [
 {
 "credentials": {
 "onpremise_proxy_host": "10.0.85.1",
 "onpremise_proxy_port": "20003",
 "clientid": "sb-connectivity-app",
 "clientsecret": "KXqObiN6d9gLA4cS2rOVAahPCX0=",
 },
 "label": "connectivity",
 "name": "conn-lite",
 "plan": "default",
 "provider": null,
 "syslog_drain_url": null,
 "tags": [
 "connectivity",
 "conn",
 "connsvc"
 ],
 "volume_mounts": []
 }
 ],

                    1.19.6.1.2.2 Read environment variables
Read Credentials from the Environment Variables

Consuming the Connectivity service requires credentials from the xsuaa and Connectivity service instances which are bound to the application. By binding the application to service instances of the xsuaa and Connectivity service as described in the prerequisites, these credentials become part of the environment variables of the application. You can access them as follows:

Sample Code
JSONObject jsonObj = new JSONObject(System.getenv("VCAP_SERVICES"));
JSONArray jsonArr = jsonObj.getJSONArray("<service name, not the instance name>");
JSONObject credentials = jsonArr.getJSONObject(0).getJSONObject("credentials");
Note
If you have multiple instances of the same service bound to the application, you must perform additional filtering to extract the correct credential from jsonArr. You must go through the elements of jsonArr and find the one matching the correct instance name.
This code stores a JSON object in the credentials variable. Additional parsing is required to extract the value for a specific key.

Note
We refer to the result of the above code block as connectivityCredentials, when called for connectivity, and xsuaaCredentials for xsuaa.

                    1.19.6.1.2.3 Get destination from destination service

                        1.19.6.1.2.3.1 Configure HTTP destination
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/42a0e6b966924f2e902090bdf435e1b2.html

Destination Levels
The runtime tries to resolve a destination in the order: Subaccount Level → Service Instance Level.

Proxy Types
The proxy types supported by the Connectivity service are:

Internet - The application can connect to an external REST or SOAP service on the Internet.
OnPremise - The application can connect to an on-premise back-end system through the Cloud Connector.
The proxy type used for a destination is specified by the destination property ProxyType. The default value is Internet.

Proxy Settings for Your Local Runtime
If you work in your local development environment behind a proxy server and want to use a service from the Internet, you need to configure your proxy settings on JVM level. To do this, proceed as follows:

On the Servers view, double-click the added server and choose Overview to open the editor.
Click the Open Launch Configuration link.
Choose the (x)=Arguments tab page.
In the VM Arguments box, add the following row:
-Dhttp.proxyHost=yourproxyHost -Dhttp.proxyPort=yourProxyPort -Dhttps.proxyHost=yourproxyHost -Dhttps.proxyPort=yourProxyPort

Choose OK.
Start or restart your SAP HANA Cloud local runtime.
Configuring Authentication
When creating an HTTP destination, you can use different authentication types for access control:

Server Certificate Authentication

SAP Assertion SSO Authentication

Principal Propagation Authentication

SAML Bearer Assertion Authentication

Client Authentication Types for HTTP Destinations - https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/4e13a04147314e8e9e54321f25d93fdc.html
no auth, basic (user/pwd) and certificate based auth

OAuth Client Credentials Authentication

OAuth User Token Exchange Authentication

                        1.19.6.1.2.3.2 consume destination service

https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/7e306250e08340f89d6c103e28840f30.html

The Destination service lets you find the destination information that is required to access a remote service or system from your Cloud Foundry application.

For the connection to an on-premise system, you can optionally use this service, together with (i.e. in addition to) the Connectivity service, see Consuming the Connectivity Service.
For the connection to any other Web application (remote service), you can use the Destination service without the Connectivity service.
Consuming the Destination Service includes user authorization via a JSON Web Token (JWT) that is provided by the xsuaa service.

Prerequisites

To manage destinations and certificates on service instance level (all CRUD operations), you must be assigned to one of the following roles: OrgManager, SpaceManager or SpaceDeveloper.
Note
The role SpaceAuditor has only Read permission for destinations and certificates.
To consume the Destination service from an application, you must create a service instance and bind it to the application. See Create and Bind a Destination Service Instance.
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/9fdad3cad92e4b63b73d5772014b380e.html
Create and Bind a Service Instance from the CLI
Use the following CLI commands to create a service instance and bind it to an application:

cf marketplace
cf create-service destination <service-plan> <service-name>
cf bind-service <app-name> <service-name>
Back to Procedure

Create and Bind a Service Instance from the Cockpit
Note
For the Beta version, the cloud cockpit is not yet available. Use the corresponding CLI commands instead.
Assuming that you have already deployed your application to the platform, follow these steps to create a service instance and bind it to an application:

In the SAP Cloud Platform cockpit, navigate to your application.
From the left navigation menu, choose Service Bindings.
Choose the Bind Service button.
The Bind Service wizard appears.
Select the service from the catalog radio button, then choose Next.
From the list of available services, select destination, then choose Next.

On the next page of the wizard, select the Create new instance radio button.
From the drop-down box, select a service plan, then choose Next.
The next page is used for specifying user-provided parameters in JSON format. If you do not want to do that, skip this step by choosing Next.
In the <Instance Name> textbox, enter an unique name for your service instance, for example, dest-lite.
Choose Finish.

Result
When the binding is created, the application gets the corresponding destination credentials in its environment variables:

Sample Code
"VCAP_SERVICES": {
"destination": [
{
"credentials": {
...
"uri": "https://destination-configuration.cfapps.<region host>",
...
},
"syslog_drain_url": null,
"volume_mounts": [],
"label": "destination",
"provider": null,
"plan": "lite",
"name": "dest-lite",
"tags": [
"destination",
"document"
]
}
],


To generate the required JSON Web Token (JWT), you must bind the application to an instance of the xsuaa service using the service plan 'application'. The xsuaa service instance acts as an OAuth 2.0 client and grants user access to the bound application. See also: Create a Service Instance from the xsuaa Service and Bind the xsuaa Service Instance to the Application. Make sure that you set the xsappname property when creating the instance. Find a detailed guide for this procedure in section 3. Creation of the Authorization & Trust Management Instance (aka XSUAA) of the SCN blog How to use SAP Cloud Platform Connectivity and Cloud Connector in the Cloud Foundry environmentInformation published on SAP site.
You need at least one configured destination, otherwise there will be nothing to retrieve via the service.
To access the Destinations editor in the cockpit, follow the steps in Access the Destinations Editor.

To manage destinations via REST API, see Destination Service REST API.

-> Create a Service Instance from the xsuaa Service
Create a service instance from the xsuaa service using the service broker.

Context
If you want to grant users access to an application, you must create a service instance (acting as OAuth 2.0 client) for this application.

Procedure
Go to the folder where the xs-security.json file is stored.
Create a service instance based on the xsuaa service and the service plan using the security descriptors in the xs-security.json file.
cf create-service <service_name> <service_plan> <service_instance_name> -c xs-security.json

Example
cf create-service xsuaa application authorizationtest-uaa -c xs-security.json

-> cf bind-service hello-world xsuaa

-> Now finally we can consume the destination programmatically
    -> Read Credentials from the Environment Variables

The Destination service stores its credentials in the environment variables. To consume the service, you require the following information:

The value of clientid, clientsecret and uri from the Destination service credentials.
The values of url from the xsuaa credentials.
You can access this information as follows:

From the CLI, the following command lists the environment variables of <app-name>:
cf env <app-name> 
From within the application, the service credential can be accessed as described in Consuming the Connectivity Service.
Note
Below, we refer to the JSONObjects, containing the instance credentials as destinationCredentials (for the Destination service) and xsuaaCredentials (for xsuaa).
Back to Tasks

    -> Generate a JSON Web Token (JWT)

Your application must create an OAuth client using the attributes clientid and clientsecret, which are provided by the Destination service instance. Then, you must retrieve a new JWT from UAA and pass it in the Authorization HTTP header.

Two examples how to achieve this (Java and cURL):

Java:

Sample Code
// get value of "clientid" and "clientsecret" from the environment variables
String clientid = destinationCredentials.getString("clientid");
String clientsecret = destinationCredentials.getString("clientsecret");
  
// get the URL to xsuaa from the environment variables
URI xsuaaUrl = new URI(xsuaaCredentials.getString("url"));
   
// Make request to UAA to retrieve JWT
UaaContextFactory factory = UaaContextFactory.factory(xsuaaUrl);
TokenRequest tokenRequest = factory.tokenRequest();
tokenRequest.setGrantType(GrantType.CLIENT_CREDENTIALS);
tokenRequest.setClientId(clientId);
tokenRequest.setClientSecret(clientSecret);
   
UaaContext xsUaaContext = factory.authenticate(tokenRequest);
jwtToken = xsUaaContext.getToken();
cURL:

Sample Code
curl -X POST \
  <xsuaa-url>/oauth/token \
  -H 'authorization: Basic <<clientid>:<clientsecret> encoded with Base64>' \
  -H 'content-type: application/x-www-form-urlencoded' \
  -d 'client_id=<clientid>&grant_type=client_credentials'

    -> Call the Destination Service

When calling the Destination service, use the uri attribute, provided in VCAP_SERVICES, to build the request URLs.

Read a Destination by only Specifying its Name ("Find Destination")

Read a Destination Associated with a Subaccount

Get All Destinations Associated with a Subaccount

    -> Response Codes

Read a Destination by only Specifying its Name ("Find Destination")

This lets you provide simply a name of the destination while the service will search for it. First, the service searches the destinations that are associated with the service instance. If none of the destinations match the requested name, the service searches the destinations that are associated with the subaccount.

Path: /destination-configuration/v1/destinations/<destination-name>
Example of a call (cURL):
Sample Code
curl "<uri>/destination-configuration/v1/destinations/<destination-name>" \
-X GET \
-H "Authorization: Bearer <jwtToken>"
Example of a response (this is a destination found when going through the subaccount destinations):

    -> Sample Code
{
"owner":
{
"SubaccountId":<id>,
"InstanceId":null
},
"destinationConfiguration":
{
"Name": "demo-internet-destination",
"URL": "http://www.google.com",
"ProxyType": "Internet",
"Type": "HTTP",
"Authentication": "NoAuthentication"
}
}
Note
The response from this type of call contains not only the configuration of the requested destination, but also some additional data. See "Find Destination" Response Structure.
Back to Call the Destination Service

    -> Read a Destination Associated with a Subaccount

This lets you retrieve the configurations of a destination that is defined within a subaccount, by providing the name of the destination.

Path: /destination-configuration/v1/subaccountDestinations/<destination-name>
Example of a call (cURL):
Sample Code
curl "<uri>/destination-configuration/v1/subaccountDestinations/<destination name>" \
-X GET \
-H "Authorization: Bearer <jwtToken>"
Example of a response:

Sample Code
{
"Name": "demo-internet-destination",
"URL": "http://www.google.com",
"ProxyType": "Internet",
"Type": "HTTP",
"Authentication": "NoAuthentication"
}
Back to Call the Destination Service

    -> Get All Destinations Associated with a Subaccount

This lets you retrieve the configurations of all destinations that are defined within a subaccount.

Path: /destination-configuration/v1/subaccountDestinations
Example of a call (cURL):
Sample Code
curl "<uri>/destination-configuration/v1/subaccountDestinations" \
-X GET \
-H "Authorization: Bearer <jwtToken>"
Example of a response:

Sample Code
[
{
"Name": "demo-onpremise-destination1",
"URL": "http:/virtualhost:1234",
"ProxyType": "OnPremise",
"Type": "HTTP",
"Authentication": "NoAuthentication"
},
{
"Name": "demo-onpremise-destination2",
"URL": "http:/virtualhost:4321",
"ProxyType": "OnPremise",
"Type": "HTTP",
"Authentication": "BasicAuthentication",
"User": "myname123",
"Password": "123456"
}
]

    -> Response Codes

When calling the Destination service, you may get the following response codes:

200: OK (Json of Destination)
401: Unauthorized (Authentication Failed)
403: Forbidden (Authorization Failed)
404: The requested destination could not be found (not applicable to 'get all destinations associated with a subaccount')
500: Internal Server Error
Back to Call the Destination Service


    -> Destination Configuration Attributes

The JSON object that serves as the response of a successful request (value of the destinationConfiguration property for "Find destination") can have different attributes, depending on the authentication type and proxy type of the corresponding destination. See HTTP Destinations.

->

                    1.19.6.1.2.4 Get HTTP proxy and create oauth access token using connectivity and XSUAA services
Set up the HTTP Proxy for On-Premise Connectivity

Proxy Setup

The Connectivity service provides a standard HTTP proxy for on-premise connectivity that is accessible by any application. Proxy host and port are available as the environment variables <onpremise_proxy_host> and <onpremise_proxy_port>. You can set up the on-premise HTTP proxy like this:

Sample Code
// get value of "onpremise_proxy_host" and "onpremise_proxy_port" from the environment variables
// and create on-premise HTTP proxy
String connProxyHost = connectivityCredentials.getString("onpremise_proxy_host");
int connProxyPort = Integer.parseInt(credentials.getString("onpremise_proxy_port"));
Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(connProxyHost, connProxyPort));
 
 
 
// create URL to the remote endpoint you like to call:
// virtualhost:1234 is defined as an endpoint in the Cloud Connector, as described in the Required Information section
URL url = new URL("http://virtualhost:1234");
 
 
// create the connection object to the endpoint using the proxy
// this does not open a connection but only creates a connection object, which can be modified later, before actually connecting
urlConnection = (HttpURLConnection) url.openConnection(proxy);


                    1.19.6.1.2.5 From your application access on-prem system (via TLS tunnel to cloud connector)

                1.19.6.1.3
            1.19.6.2 our implementations
src/proxy/odata.proxy.async.iterable.ts
import {DestinationDataDto} from './destination/dto/destination-data.dto';
import {DestinationService} from './destination/destination.service';
import {IConnectivityService} from './connectivity/interfaces/connectivity-service.interface';
import {IDestinationRequestInfo} from './interfaces/destination.request.info.interface';
import {IProxyAsyncIterable} from './interfaces/proxy.async.iterable.interface';
import {AuthenticationService} from './authentications/authentication.service';

export class ODataProxyAsyncIterable implements IProxyAsyncIterable {
    private destinationData: DestinationDataDto;
    private deltaLink: string;
    private static readonly SAP_CLIENT: string = 'sap-client';
    private static readonly MAX_PAGE_SIZE: number = 200;

    constructor(private destinationRequestInfo: IDestinationRequestInfo,
                private destinationService: DestinationService,
                private connectivityService: IConnectivityService,
                private authenticationService: AuthenticationService) {}

    async *[Symbol.asyncIterator]() {
        if(this.destinationData == null) {
            this.destinationData = await this.destinationService.getDestination(this.destinationRequestInfo.authInfo,
                this.destinationRequestInfo.destinationId);
        }

        const firstUrl = new URL(this.destinationData.URL);

        this.addSapClientQueryParamToUrl(firstUrl);

        let nextLink: string = '';
        const headers = new Set<[string, string]>([['Prefer', `maxpagesize=${ODataProxyAsyncIterable.MAX_PAGE_SIZE}`]]);
        do {
            const url = nextLink?.length > 0 ? new URL(nextLink, this.destinationData.URL) : firstUrl;
            this.addSapClientQueryParamToUrl(url);
            const data = await this.connectivityService.request({
                authentication: this.authenticationService.createAuthenticationTypeFrom(this.destinationData),
                method: 'GET',
                url: url.href,
                userToken: this.destinationRequestInfo.authInfo.token,
                path: '',
                headers: headers,
            });
            nextLink = data['@odata.nextLink'];
            this.deltaLink = data['@odata.deltaLink'];
            yield data;
        } while (nextLink?.length > 0);
    }

    private addSapClientQueryParamToUrl(url: URL) {
        if(this.destinationData[ODataProxyAsyncIterable.SAP_CLIENT] &&
            !url.searchParams.get(ODataProxyAsyncIterable.SAP_CLIENT)) {
            url.searchParams.append(ODataProxyAsyncIterable.SAP_CLIENT, this.destinationData[ODataProxyAsyncIterable.SAP_CLIENT]);
        }
    }

    public get DeltaLink() {
        return this.deltaLink;
    }
}

            1.19.6.3
        1.19.7 transport PRs  

            1.19.7.1 Adam, Destinations 
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/15

            1.19.7.2 Hadar, skeleton
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/12/files

            1.19.7.3

        1.19.8 manually create and bind services during development
[i500695@C02X632CJGH6:2019-12-25 12:21:16:~:]2005$ cf cs connectivity lite portal-connectivity 
Creating service instance portal-connectivity in org backbone / space yosib3 as I500695...
OK
$ cf bs portal-cf-transport-service portal-connectivity 
Binding service portal-connectivity to app portal-cf-transport-service in org backbone / space yosib3 as I500695...
OK

        1.19.9 Transports to s4 Federation Embedded and hub subaccount 

a. get credentials for access token request:
[i500695@C02X632CJGH6:2020-01-27 14:13:21:~/work/SAP/git/cdm-schema:]2061$ printCFAUTHENV4DTAPPRTR 
print CF auth params for app portal-cf-dt-approuter
clientid=xxx
clientsecret=xxx
url=https://messi.authentication.sap.hana.ondemand.com

b.  run transport to two subaccounts

    b1.  QKY on s4 fed-Emb E2E validation-transport

account: https://s4validation.authentication.sap.hana.ondemand.com/login
cockpit: https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/b01ca157-959e-4702-a8f6-0b1a855bc81d/saasApplications
token req. url: https://s4validation.authentication.sap.hana.ondemand.com/oauth/token
site-manager: https://s4validation.lkg.dt.cpp.cfapps.sap.hana.ondemand.com

refresh token url: 
https://s4validation.authentication.sap.hana.ondemand.com/oauth/token?grant_type=user_token&response_type=token&client_id=sb-bfdf4747-b446-485a-af2c-f8746da94f45!b63|portal-cf-service-lkg!b6


start transport
https://portal-service-lkg.cfapps.sap.hana.ondemand.com/transport_service/transports/external/start
body
{
  "dcm": {
    "source": { 
    "destinationId": "qkyclnt120"
    },
    "context": {
      "id": "SUB_ACCOUNT",
      "type": "sub_account"
    }
  }
}

status 
https://portal-service-lkg.cfapps.sap.hana.ondemand.com/transport_service/transports/external/status?contextType=sub_account&contextId=SUB_ACCOUNT

    b2.  UYZ: s4 fed-HUB E2E validation-transport
cockpit: https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/6cb3e9ba-7e99-4eba-9d21-28b24cdaff85/subscription/PortalAdminCockpit-lkg-default-test/overview 

https://s4fedhubtransport.authentication.sap.hana.ondemand.com/login 
https://s4fedhubtransport.authentication.sap.hana.ondemand.com/oauth/token
site-manager: https://s4fedhubtransport.lkg.dt.cpp.cfapps.sap.hana.ondemand.com

start transport
https://portal-service-lkg.cfapps.sap.hana.ondemand.com/transport_service/transports/external/start
status
https://portal-service-lkg.cfapps.sap.hana.ondemand.com/transport_service/transports/external/status?contextType=sub_account&contextId=SUB_ACCOUNT

        1.19.10 Transport service swagger

    main.ts snip:
    const transportDocument = SwaggerModule.createDocument(app, options, {
        include: [TransportModule],
    });
    SwaggerModule.setup('transport_service/api/transports', app, transportDocument);
    const exportDocument = SwaggerModule.createDocument(app, options, {
        include: [ExportModule],
    });
    SwaggerModule.setup('transport_service/api/exports', app, exportDocument);

url: https://portal-service-yosib3-i500695.cfapps.sap.hana.ondemand.com/transport_service/api/exports/
https://portal-service-yosib3-i500695.cfapps.sap.hana.ondemand.com/transport_service/api/transports/

        1.19.11 docker-compose

            1.19.11.1 PR https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/152
From 1603431a1034fd57723ccc39bfa8dfe7330c162b Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Thu, 5 Mar 2020 23:23:09 +0200
Subject: [PATCH 01/22] docker-compose

---
 Dockerfile         |  3 +++
 docker-compose.yml | 30 ++++++++++++++++++++++++++++++
 2 files changed, 33 insertions(+)
 create mode 100644 Dockerfile
 create mode 100644 docker-compose.yml

diff --git a/Dockerfile b/Dockerfile
new file mode 100644
index 0000000..3600557
--- /dev/null
+++ b/Dockerfile
@@ -0,0 +1,3 @@
+FROM node:12.13-alpine
+WORKDIR /usr/src/transport-service
+COPY . /usr/src/transport-service
\ No newline at end of file
diff --git a/docker-compose.yml b/docker-compose.yml
new file mode 100644
index 0000000..ca85355
--- /dev/null
+++ b/docker-compose.yml
@@ -0,0 +1,30 @@
+version: '3.7'
+services:
+  redis:
+    container_name: redis
+    image: "redis:4.0"
+    expose:
+      - 6379
+
+  tranport-service:
+    build: .
+    container_name: transport-service
+    command:
+      sh -c 'npm run start:debug'
+    environment:
+      NODE_ENV: dev
+    ports:
+      - 3003:3000
+    tty: true
+    volumes:
+      - ./:/usr/src/transport-service
+    deploy:
+      resources:
+        limits:
+          cpus: '0.50'
+          memory: 512M
+        reservations:
+          cpus: '0.25'
+          memory: 256M
+    depends_on:
+      - redis
\ No newline at end of file

From f1e2cba485bf395e50eb19b7e626ba67b3616596 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Thu, 5 Mar 2020 23:55:08 +0200
Subject: [PATCH 02/22] Mock auth info middlware for e2e docker-compose testing

---
 src/app/app.module.ts                        |  4 +++
 src/middlewares/mock/auth-info.middleware.ts | 33 ++++++++++++++++++++
 2 files changed, 37 insertions(+)
 create mode 100644 src/middlewares/mock/auth-info.middleware.ts

diff --git a/src/app/app.module.ts b/src/app/app.module.ts
index 37e45c0..a869220 100644
--- a/src/app/app.module.ts
+++ b/src/app/app.module.ts
@@ -15,6 +15,7 @@ import {LoggerFactory} from '../utils/logger-factory';
 import {AppService} from './app.service';
 import {ExportController} from '../export/export.controller';
 import {ExportModule} from '../export/export.module';
+import {AuthInfoMockMiddleware} from '../middlewares/mock/auth-info.middleware';
 
 @Global()
 @Module({
@@ -36,6 +37,9 @@ export class AppModule implements NestModule {
             consumer
                 .apply(passport.initialize(), passport.authenticate('JWT', {session: false}), AuthenticationMiddleware)
                 .forRoutes(ImportController, TransportController, ExportController)
+        } else {
+            consumer.apply(AuthInfoMockMiddleware)
+                .forRoutes(ImportController, TransportController, ExportController)
         }
         consumer.apply(SessionMiddleware)
             .forRoutes({
diff --git a/src/middlewares/mock/auth-info.middleware.ts b/src/middlewares/mock/auth-info.middleware.ts
new file mode 100644
index 0000000..225b85c
--- /dev/null
+++ b/src/middlewares/mock/auth-info.middleware.ts
@@ -0,0 +1,33 @@
+import {Injectable, NestMiddleware, UnauthorizedException} from '@nestjs/common';
+import {Request} from '@sap/xssec';
+import {Response} from 'express';
+
+@Injectable()
+export class AuthInfoMockMiddleware implements NestMiddleware {
+    use(req: Request, res: Response, next: Function) {
+        req.authInfo = {
+            checkLocalScope(scope: string): boolean {
+                return true;
+            }, checkScope(scope: string): boolean {
+                return true;
+            }, getAppToken(): string {
+                return 'jwt_token';
+            }, getCloneServiceInstanceId(): string {
+                return 'default_instance';
+            }, getEmail(): string {
+                return 'teamuser@sap.com';
+            }, getGrantType(): string {
+                return 'user_token';
+            }, getLogonName(): string {
+                return 'team user';
+            }, getSubaccountId(): string {
+                return 'default_tenant';
+            }, getSubdomain(): string {
+                return 'tenant_subdomain';
+            }, getUserName(): string {
+                return 'teamuser@sap.com';
+            }
+        };
+        return next();
+    }
+}
\ No newline at end of file

From 3b527393e1265409f9ad3a5d96f8947a3890fb09 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 11:11:27 +0200
Subject: [PATCH 03/22] update reamme | docker service typo

---
 Dockerfile                        |   3 ++-
 README.md                         |  30 ++++++++++++++++++++++++------
 assets/debug-nestjs-container.png | Bin 0 -> 235004 bytes
 docker-compose.yml                |   5 +++--
 package.json                      |   3 ++-
 5 files changed, 31 insertions(+), 10 deletions(-)
 create mode 100644 assets/debug-nestjs-container.png

-## Description
+### Description
 
 [Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.
 
-## Installation
+### Installation
 
 ```bash
 $ npm install
 ```
 
-## Running the app
+### Running the app
 
 ```bash
 # development
@@ -41,7 +41,7 @@ $ npm run start:dev
 $ npm run start:prod
 ```
 
-## Redis
+### Redis
 
 portal-cf-transport-service is uses Redis.  
 so when running portal-cf-transport-service locally, we would like to connect to a local Redis instance.
@@ -58,7 +58,7 @@ in order to start and stop it run the following command:
 $ docker start/stop local-redis
 ```
 
-#####connect to redis in the cloud(container)
+### connect to Redis in the cloud (container)
 
 in order to connect to redis in the cloud do the following:
 
@@ -70,7 +70,25 @@ in order to connect to redis in the cloud do the following:
 (you can use any redis client). 
 
 medis is a redis client you can use to connect to redis, it's an open-source and you can follow the instructions in the link to install and run it.
-https://github.com/luin/medis  
+https://github.com/luin/medis
+
+### Using docker-compose.yml
+
+```shell script
+npm install
+```
+to create and start containers:
+```shell script
+docker-compose up -d
+```
+
+If you did a code changes in transport-service run
+```shell script
+docker-compose up -d --no-deps --build transport-service
+```
+
+for debugging
+![debugging](assets/debug-nestjs-container.png)
 
 ## Test
 
literal 0
HcmV?d00001

diff --git a/docker-compose.yml b/docker-compose.yml
index ca85355..ff5923a 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -6,15 +6,16 @@ services:
     expose:
       - 6379
 
-  tranport-service:
+  transport-service:
     build: .
     container_name: transport-service
     command:
-      sh -c 'npm run start:debug'
+      sh -c 'npm run start:debug --require ts-node/register'
     environment:
       NODE_ENV: dev
     ports:
       - 3003:3000
+      - 9229:9229
     tty: true
     volumes:
       - ./:/usr/src/transport-service
diff --git a/package.json b/package.json
index 5ecca84..2e050c3 100644
--- a/package.json
+++ b/package.json
@@ -11,7 +11,7 @@
         "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
         "start": "ts-node -r tsconfig-paths/register src/main.ts",
         "start:dev": "tsc-watch -p tsconfig.build.json --onSuccess \"node dist/main.js\"",
-        "start:debug": "node --inspect dist/main.js",
+        "start:debug": "nest start --debug 0.0.0.0:9229",
         "start:prod": "node dist/main.js",
         "lint": "tslint -p tsconfig.json -c tslint.json",
         "test": "node_modules/.bin/grunt",
@@ -49,6 +49,7 @@
         "bfj": "6.1.1"
     },
     "devDependencies": {
+        "@nestjs/cli": "^6.14.2",
         "@nestjs/testing": "6.1.1",
         "@types/chai": "^4.2.0",
         "@types/chai-as-promised": "^7.1.2",

From ce9468fcf11e0e60b569a490c1151bbba1038250 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 11:22:53 +0200
Subject: [PATCH 04/22] update readme

---
 README.md | 24 +++++++-----------------
 1 file changed, 7 insertions(+), 17 deletions(-)

diff --git a/README.md b/README.md
index 5945d80..4032259 100644
--- a/README.md
+++ b/README.md
@@ -2,25 +2,14 @@
 
 [![Build Status](https://gkeportalcf.jaas-gcp.cloud.sap.corp/buildStatus/icon?job=portal-cf-transport-service/master)](https://gkeportalcf.jaas-gcp.cloud.sap.corp/job/portal-cf-transport-service/job/master/)
 
-### Important message from DevOps:
-
-*Welcome!* for any new repository there are few further steps require in order to deliver its code to production.
-Please notify devOps team once the code is ready in order to join the required step
-
-| **Step** | **job** | **Status** |
-| ---- | --- | --- |
-| Initialization | create and restrict main branches master/rc/live | **Not Done** |
-| Development | Create CI Pipeline | **Not Done** |
-| Release | Copy from master to rc/live branches | **Not Done** |
-| Internal Delivery | Deploy to (Dev/Nightly/CI-create-space) | **Not Done** |
-| External Delivery | Deploy to val / validation /Internal production / Live | **Not Done** |
-
-Please update devOps on ongoing changes (add/remove dependencies, manifest.yml, changes in dependencies, etc )
-
-
 ### Description
 
-[Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.
+The transport service is responsible for import/export content from/to CDM-Store.
+it also supports importing from on-premise external content from different integrated products (blue-boxes/content providers).
+communication between the cFLP, the integrated products will be based on contracts that
+are defined by the cFLP and are to be adopted by the integrated products.
+
+for more info about the contract see: [CDM APIs](https://github.wdf.sap.corp/FLP/cdm-api#bluebox-cdm-replication-api)
 
 ### Installation
 
@@ -94,6 +83,7 @@ for debugging
 
 ```bash
 # unit tests
+$ npm run test:local
 $ npm run test
 
 # e2e tests

From 048d2cfbe09ec7918c7370724ef46b70140d7dc6 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 12:15:24 +0200
Subject: [PATCH 05/22] watch mode

---
 README.md          | 5 ++++-
 docker-compose.yml | 1 +
 package.json       | 6 +++---
 3 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/README.md b/README.md
index 4032259..523b1f8 100644
--- a/README.md
+++ b/README.md
@@ -71,11 +71,14 @@ to create and start containers:
 docker-compose up -d
 ```
 
-If you did a code changes in transport-service run
+to rebuild the service:
 ```shell script
 docker-compose up -d --no-deps --build transport-service
 ```
 
+** *NOTE* Code changes are reflected instantly in transport-service container. **
+
+
 for debugging
 ![debugging](assets/debug-nestjs-container.png)
 
diff --git a/docker-compose.yml b/docker-compose.yml
index ff5923a..e0831c2 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -13,6 +13,7 @@ services:
       sh -c 'npm run start:debug --require ts-node/register'
     environment:
       NODE_ENV: dev
+      TS_NODE_TRANSPILE_ONLY: 'true'
     ports:
       - 3003:3000
       - 9229:9229
diff --git a/package.json b/package.json
index 2e050c3..27d1a50 100644
--- a/package.json
+++ b/package.json
@@ -11,7 +11,7 @@
         "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
         "start": "ts-node -r tsconfig-paths/register src/main.ts",
         "start:dev": "tsc-watch -p tsconfig.build.json --onSuccess \"node dist/main.js\"",
-        "start:debug": "nest start --debug 0.0.0.0:9229",
+        "start:debug": "nest start --debug 0.0.0.0:9229 --watch",
         "start:prod": "node dist/main.js",
         "lint": "tslint -p tsconfig.json -c tslint.json",
         "test": "node_modules/.bin/grunt",
@@ -80,8 +80,8 @@
         "sinon-chai": "3.3.0",
         "sinon-test": "2.4.1",
         "supertest": "4.0.2",
-        "ts-node": "8.0.2",
-        "tsc-watch": "2.2.1",
+        "ts-node": "8.6.2",
+        "tsc-watch": "2.4.0",
         "tsconfig-paths": "3.8.0",
         "tslint": "5.16.0",
         "tslint-config-prettier": "^1.18.0",

From 5beb207360f14002db348eca05d5706e36e6b0a2 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 12:25:18 +0200
Subject: [PATCH 06/22] docker-compose change

---
 docker-compose.yml | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/docker-compose.yml b/docker-compose.yml
index e0831c2..da45645 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -14,6 +14,8 @@ services:
     environment:
       NODE_ENV: dev
       TS_NODE_TRANSPILE_ONLY: 'true'
+      TS_NODE_FILES: 'true'
+      # https://github.com/TypeStrong/ts-node/issues/754
     ports:
       - 3003:3000
       - 9229:9229

From bba2193a6da43402165a0c905debde54fb849cea Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 12:32:30 +0200
Subject: [PATCH 07/22] update ts version

---
 package.json | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 27d1a50..c12fb29 100644
--- a/package.json
+++ b/package.json
@@ -86,7 +86,7 @@
         "tslint": "5.16.0",
         "tslint-config-prettier": "^1.18.0",
         "tslint-config-standard": "^8.0.1",
-        "typescript": "3.7.3",
+        "typescript": "3.8.3",
         "ts-mockito": "2.5.0"
     }
 }

From 54eae903c8ddc45bc14c910224720d9bb252d7cb Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 18:42:30 +0200
Subject: [PATCH 08/22] DestinationMockService

---
 docker-compose.yml                                  |  4 ++--
 src/import/import.module.ts                         |  5 ++++-
 src/import/import.service.ts                        |  4 ++--
 .../destination/mock/destination-mock.service.ts    | 11 +++++++++++
 src/proxy/odata.proxy.async.iterable.ts             |  4 ++--
 src/proxy/proxy.module.ts                           | 13 ++++++++++---
 src/proxy/proxy.service.ts                          |  3 ++-
 7 files changed, 33 insertions(+), 11 deletions(-)
 create mode 100644 src/proxy/destination/mock/destination-mock.service.ts

diff --git a/docker-compose.yml b/docker-compose.yml
index da45645..a3bf7a8 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -3,8 +3,8 @@ services:
   redis:
     container_name: redis
     image: "redis:4.0"
-    expose:
-      - 6379
+    ports:
+      - 6379:6379
 
   transport-service:
     build: .
diff --git a/src/import/import.module.ts b/src/import/import.module.ts
index 6af1e1e..dea9e2f 100644
--- a/src/import/import.module.ts
+++ b/src/import/import.module.ts
@@ -5,7 +5,10 @@ import {DestinationService} from '../proxy/destination/destination.service';
 
 @Module({
     controllers: [ImportController],
-    providers: [DestinationService,ImportService],
+    providers: [{
+        provide: 'IDestinationService',
+        useClass: DestinationService
+    }, ImportService],
     exports: [ImportService]
 })
 export class ImportModule {
diff --git a/src/import/import.service.ts b/src/import/import.service.ts
index 1eef5b4..7bb4bed 100644
--- a/src/import/import.service.ts
+++ b/src/import/import.service.ts
@@ -1,14 +1,14 @@
 import {Inject, Injectable} from '@nestjs/common';
-import {DestinationService} from '../proxy/destination/destination.service';
 import {Logger} from '../utils/logger';
 import {ILoggerFactory} from '../interfaces/logger-factory.interface';
+import {IDestinationService} from '../proxy/destination/interfaces/destination.service.interface';
 
 
 @Injectable()
 export class ImportService {
     private logger: Logger;
 
-    constructor(private destinationService: DestinationService, @Inject('ILoggerFactory') loggerFactory: ILoggerFactory) {
+    constructor(@Inject('IDestinationService') private destinationService: IDestinationService, @Inject('ILoggerFactory') loggerFactory: ILoggerFactory) {
         this.logger = loggerFactory.getLogger(ImportService.name);
     }
 
diff --git a/src/proxy/destination/mock/destination-mock.service.ts b/src/proxy/destination/mock/destination-mock.service.ts
new file mode 100644
index 0000000..e008f6d
--- /dev/null
+++ b/src/proxy/destination/mock/destination-mock.service.ts
@@ -0,0 +1,11 @@
+import {Injectable} from '@nestjs/common';
+import {IDestinationService} from '../interfaces/destination.service.interface';
+import {DestinationDataDto} from '../dto/destination-data.dto';
+
+@Injectable()
+export class DestinationMockService implements IDestinationService {
+
+    getDestination(authInfo: any, destination: any): Promise<DestinationDataDto> {
+        return undefined;
+    }
+}
\ No newline at end of file
diff --git a/src/proxy/odata.proxy.async.iterable.ts b/src/proxy/odata.proxy.async.iterable.ts
index f869d56..865adff 100644
--- a/src/proxy/odata.proxy.async.iterable.ts
+++ b/src/proxy/odata.proxy.async.iterable.ts
@@ -1,10 +1,10 @@
 import {DestinationDataDto} from './destination/dto/destination-data.dto';
-import {DestinationService} from './destination/destination.service';
 import {IConnectivityService} from './connectivity/interfaces/connectivity-service.interface';
 import {IDestinationRequestInfo} from './interfaces/destination.request.info.interface';
 import {IProxyAsyncIterable} from './interfaces/proxy.async.iterable.interface';
 import {AuthenticationService} from './authentications/authentication.service';
 import {isNil} from '@nestjs/common/utils/shared.utils';
+import {IDestinationService} from './destination/interfaces/destination.service.interface';
 
 export class ODataProxyAsyncIterable implements IProxyAsyncIterable {
     private destinationData: DestinationDataDto;
@@ -13,7 +13,7 @@ export class ODataProxyAsyncIterable implements IProxyAsyncIterable {
     private static readonly MAX_PAGE_SIZE: number = 200;
 
     constructor(private destinationRequestInfo: IDestinationRequestInfo,
-                private destinationService: DestinationService,
+                private destinationService: IDestinationService,
                 private connectivityService: IConnectivityService,
                 private authenticationService: AuthenticationService) {
     }
diff --git a/src/proxy/proxy.module.ts b/src/proxy/proxy.module.ts
index b5a1429..8b31c5e 100644
--- a/src/proxy/proxy.module.ts
+++ b/src/proxy/proxy.module.ts
@@ -1,16 +1,23 @@
-import { Module } from '@nestjs/common';
+import {Module} from '@nestjs/common';
 import {DestinationService} from './destination/destination.service';
 import {ConnectivityService} from './connectivity/connectivity.service';
 import {ProxyService} from './proxy.service';
 import {AuthenticationService} from './authentications/authentication.service';
+import {Environment} from '../app/environment';
+import {DestinationMockService} from './destination/mock/destination-mock.service';
 
 @Module({
-    providers: [DestinationService, {
+    providers: [{
+        provide: 'IDestinationService',
+        useClass: Environment.isCloud() ?
+            DestinationService : DestinationMockService,
+    }, {
         provide: 'IConnectivityService',
         useClass: ConnectivityService,
     }, ProxyService, AuthenticationService],
     exports: [ProxyService],
 })
-export class ProxyModule {}
+export class ProxyModule {
+}
 
 
diff --git a/src/proxy/proxy.service.ts b/src/proxy/proxy.service.ts
index 3275089..21ef494 100644
--- a/src/proxy/proxy.service.ts
+++ b/src/proxy/proxy.service.ts
@@ -5,10 +5,11 @@ import {IDestinationRequestInfo} from './interfaces/destination.request.info.int
 import {IProxyAsyncIterable} from './interfaces/proxy.async.iterable.interface';
 import {ODataProxyAsyncIterable} from './odata.proxy.async.iterable';
 import {AuthenticationService} from './authentications/authentication.service';
+import {IDestinationService} from './destination/interfaces/destination.service.interface';
 
 @Injectable()
 export class ProxyService {
-    constructor(private destinationService: DestinationService,
+    constructor(@Inject('IDestinationService') private destinationService: IDestinationService,
                 @Inject('IConnectivityService') private connectivityService: IConnectivityService,
                 private authenticationService: AuthenticationService) {}
 

From 27bb35ae2ca519b1b07b247015f16686617c83bf Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 18:56:26 +0200
Subject: [PATCH 09/22] return a mock destination if not env=cloud

---
 .../mock/destination-mock.service.ts           | 18 ++++++++++++++++--
 1 file changed, 16 insertions(+), 2 deletions(-)

diff --git a/src/proxy/destination/mock/destination-mock.service.ts b/src/proxy/destination/mock/destination-mock.service.ts
index e008f6d..cd9151c 100644
--- a/src/proxy/destination/mock/destination-mock.service.ts
+++ b/src/proxy/destination/mock/destination-mock.service.ts
@@ -1,11 +1,25 @@
 import {Injectable} from '@nestjs/common';
 import {IDestinationService} from '../interfaces/destination.service.interface';
 import {DestinationDataDto} from '../dto/destination-data.dto';
+import {DestinationType} from '../enums/destination.type.enum';
+import {AuthenticationType} from '../../authentications/enums/authentication-type.enum';
+import {DestinationProxyType} from '../enums/destination.proxy.type.enum';
 
 @Injectable()
 export class DestinationMockService implements IDestinationService {
 
-    getDestination(authInfo: any, destination: any): Promise<DestinationDataDto> {
-        return undefined;
+    public async getDestination(authInfo: any, destination: any): Promise<DestinationDataDto> {
+        let destinationDto: DestinationDataDto = {
+            'sap-client': '120',
+            Type: DestinationType.HTTP,
+            Name: 's4_backend',
+            Description: 'S4 backend exposure report system',
+            URL: 'http://localhost:4000',
+            Authentication: AuthenticationType.NO_AUTHENTICATION,
+            User: 'teamUser',
+            Password: 'Abcd1234',
+            ProxyType: DestinationProxyType.INTERNET
+        };
+        return destinationDto;
     }
 }
\ No newline at end of file

From 9ff9ca5221709735303c090426148ae837a99fc0 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 23:18:17 +0200
Subject: [PATCH 10/22] redis connect docker fixes

---
 docker-compose.yml                            | 24 ++++++++++----
 package.json                                  |  2 +-
 src/app/app.controller.ts                     | 32 ++++++++++++++++++-
 src/app/app.service.ts                        |  1 +
 .../mock/destination-mock.service.ts          |  2 +-
 .../redis.local.configuration.provider.ts     |  2 +-
 src/redis/redis.service.ts                    | 16 ++++------
 tsconfig.build.json                           |  2 +-
 8 files changed, 60 insertions(+), 21 deletions(-)

diff --git a/docker-compose.yml b/docker-compose.yml
index a3bf7a8..366c943 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -3,18 +3,17 @@ services:
   redis:
     container_name: redis
     image: "redis:4.0"
-    ports:
-      - 6379:6379
 
   transport-service:
     build: .
     container_name: transport-service
     command:
-      sh -c 'npm run start:debug --require ts-node/register'
+      sh -c 'npm run start:debug'
     environment:
-      NODE_ENV: dev
-      TS_NODE_TRANSPILE_ONLY: 'true'
-      TS_NODE_FILES: 'true'
+      - NODE_ENV=dev
+      - TS_NODE_TRANSPILE_ONLY=true
+      - TS_NODE_FILES=true
+      - REDIS_HOST=redis
       # https://github.com/TypeStrong/ts-node/issues/754
     ports:
       - 3003:3000
@@ -31,4 +30,15 @@ services:
           cpus: '0.25'
           memory: 256M
     depends_on:
-      - redis
\ No newline at end of file
+      - redis
+
+  dcm-backend:
+    container_name: dcm-backend
+    build: e2e-test/dcm-backend
+    command:
+      sh -c 'npm run start:dev'
+    ports:
+      - 4000:4000
+    tty: true
+    volumes:
+      - ./e2e-test/dcm-backend:/usr/src/dcm-backend
\ No newline at end of file
diff --git a/package.json b/package.json
index c12fb29..29b449b 100644
--- a/package.json
+++ b/package.json
@@ -11,7 +11,7 @@
         "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
         "start": "ts-node -r tsconfig-paths/register src/main.ts",
         "start:dev": "tsc-watch -p tsconfig.build.json --onSuccess \"node dist/main.js\"",
-        "start:debug": "nest start --debug 0.0.0.0:9229 --watch",
+        "start:debug": "nest start --debug 0.0.0.0:9229",
         "start:prod": "node dist/main.js",
         "lint": "tslint -p tsconfig.json -c tslint.json",
         "test": "node_modules/.bin/grunt",
diff --git a/src/app/app.controller.ts b/src/app/app.controller.ts
index 2fddb7e..8cce9bc 100644
--- a/src/app/app.controller.ts
+++ b/src/app/app.controller.ts
@@ -1,10 +1,40 @@
 import {Controller, Get, HttpStatus, Res} from '@nestjs/common';
-
+import * as ioRedis from 'ioredis';
 @Controller()
 export class AppController {
 
   @Get('/is_alive')
   async healthCheck(@Res() res) {
+
+    // let redis = new ioRedis(process.env.REDIS_HOST);
+    // (async () => {
+    //   // All of the usual redis commands are available, and return promises.
+    //   await redis.set('foo', 'bar');
+    //
+    //   const result = await redis.get('foo');
+    //   console.log(result)
+    //
+    //   redis.lpush('list', [
+    //     'New York',
+    //     'London',
+    //     'LA',
+    //     'Hong Kong'
+    //   ]);
+    //
+    //   const cities = await redis.lrange('list', 0, -1);
+    //   console.log(cities)
+    //
+    //   // You can combine multiple commands and send them to the server as a batch to improve performance.
+    //   const hash = await redis
+    //       .pipeline()
+    //       .hset('hash', 'key1', 'value1')
+    //       .hset('hash', 'key2', 'value2')
+    //       .hgetall('hash')
+    //       .exec();
+    //
+    //   console.log(hash);
+    // })();
+
     res.status(HttpStatus.OK).send({ status: 'alive' });
   }
 }
diff --git a/src/app/app.service.ts b/src/app/app.service.ts
index 986954b..1e729f1 100644
--- a/src/app/app.service.ts
+++ b/src/app/app.service.ts
@@ -10,6 +10,7 @@ export class AppService {
             if (Environment.isCloud()) {
                 throw(error);
             }
+            console.log('**** Redis connection could not be established ****');
         });
     }
 }
diff --git a/src/proxy/destination/mock/destination-mock.service.ts b/src/proxy/destination/mock/destination-mock.service.ts
index cd9151c..47a6622 100644
--- a/src/proxy/destination/mock/destination-mock.service.ts
+++ b/src/proxy/destination/mock/destination-mock.service.ts
@@ -14,7 +14,7 @@ export class DestinationMockService implements IDestinationService {
             Type: DestinationType.HTTP,
             Name: 's4_backend',
             Description: 'S4 backend exposure report system',
-            URL: 'http://localhost:4000',
+            URL: 'http://dcm-backend:4000/sap/bc/ui2/cdm3/entities',
             Authentication: AuthenticationType.NO_AUTHENTICATION,
             User: 'teamUser',
             Password: 'Abcd1234',
diff --git a/src/redis/configurations/redis.local.configuration.provider.ts b/src/redis/configurations/redis.local.configuration.provider.ts
index 9ca11c1..9291518 100644
--- a/src/redis/configurations/redis.local.configuration.provider.ts
+++ b/src/redis/configurations/redis.local.configuration.provider.ts
@@ -7,7 +7,7 @@ export class RedisLocalConfigurationProvider implements IRedisConfigurationProvi
 
     public getConfiguration(): IRedisConfiguration {
         return {
-            hostname: 'localhost',
+            hostname: process.env.REDIS_HOST || 'localhost',
             port: 6379,
             ca_base64: false,
         };
diff --git a/src/redis/redis.service.ts b/src/redis/redis.service.ts
index 07a1179..358b869 100644
--- a/src/redis/redis.service.ts
+++ b/src/redis/redis.service.ts
@@ -4,7 +4,7 @@ import {IRedisConfiguration} from './configurations/interfaces/redis.configurati
 import {IRedisConfigurationProvider} from './configurations/interfaces/redis.configuration.provider';
 import {ILoggerFactory} from '../interfaces/logger-factory.interface';
 import {Logger} from '../utils/logger';
-import { Environment } from '../app/environment';
+import {Environment} from '../app/environment';
 import {TransportConstants} from '../constants/transport.constants';
 
 @Injectable()
@@ -22,8 +22,7 @@ export class RedisService {
     }
 
     public initializeRedisClient(): Promise<void> {
-        this.logger.debug('RedisService::initializeRedisClient()');
-
+        this.logger.info('RedisService::initializeRedisClient()');
         if (this.redisClient) {
             this.redisClient.disconnect();
             this.redisClient = null;
@@ -34,16 +33,15 @@ export class RedisService {
             const configuration = this.redisConfigurationProvider.getConfiguration();
             this.redisClient = configuration.ca_base64 ? new ioRedis(configuration.uri, redisOptions) :
                 new ioRedis(redisOptions);
-
             this.redisClient.on('connect', () => {
                 // emits when a connection is established to the Redis server.
                 this.didConnectedOnInit = this.connected = true;
-                this.logger.debug('RedisService::initializeRedisClient(), connected to Redis');
+                this.logger.info('RedisService::initializeRedisClient(), connected to Redis');
                 res();
             }).on('error', (args) => {
                 // emits when an error occurs while connecting.
                 if (!this.didConnectedOnInit) {
-                    this.logger.debug('RedisService::initializeRedisClient(), failed ' +
+                    this.logger.info('RedisService::initializeRedisClient(), failed ' +
                         'to connect to Redis');
                     rej();
                 }
@@ -51,7 +49,7 @@ export class RedisService {
                 // emits after close when no more reconnections will be made,
                 // or the connection is failed to establish
                 this.connected = false;
-                this.logger.debug('RedisService::initializeRedisClient(), disconnected from Redis');
+                this.logger.info('RedisService::initializeRedisClient(), disconnected from Redis');
             });
         });
     }
@@ -239,8 +237,8 @@ function reconnect(target: Object, propertyKey: string, descriptor: TypedPropert
 
     const originalMethod = descriptor.value;
 
-    descriptor.value = async function(...args: any[]) {
-        if(!this.connected) {
+    descriptor.value = async function (...args: any[]) {
+        if (!this.connected) {
             await this.redisClient.connect();
         }
         return originalMethod.apply(this, args);
diff --git a/tsconfig.build.json b/tsconfig.build.json
index b07f73c..e28f561 100644
--- a/tsconfig.build.json
+++ b/tsconfig.build.json
@@ -1,4 +1,4 @@
 {
   "extends": "./tsconfig.json",
-  "exclude": ["node_modules","test", "dist"]
+  "exclude": ["node_modules","test", "dist", "e2e-test"]
 }

From b64f51c263c2c60e0ff9c30e4a2279c39d51809f Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 23:27:23 +0200
Subject: [PATCH 11/22] dcm_backend application

---
 .gitignore                                  |  5 +-
 e2e-tests/dcm-backend/.eslintrc.js          | 24 +++++++
 e2e-tests/dcm-backend/.prettierrc           |  4 ++
 e2e-tests/dcm-backend/Dockerfile            |  6 ++
 e2e-tests/dcm-backend/README.md             | 75 +++++++++++++++++++++
 e2e-tests/dcm-backend/nest-cli.json         |  4 ++
 e2e-tests/dcm-backend/package.json          | 66 ++++++++++++++++++
 e2e-tests/dcm-backend/src/app.controller.ts | 13 ++++
 e2e-tests/dcm-backend/src/app.module.ts     | 11 +++
 e2e-tests/dcm-backend/src/app.service.ts    | 15 +++++
 e2e-tests/dcm-backend/src/main.ts           |  9 +++
 e2e-tests/dcm-backend/tsconfig.build.json   |  4 ++
 e2e-tests/dcm-backend/tsconfig.json         | 15 +++++
 13 files changed, 250 insertions(+), 1 deletion(-)
 create mode 100644 e2e-tests/dcm-backend/.eslintrc.js
 create mode 100644 e2e-tests/dcm-backend/.prettierrc
 create mode 100644 e2e-tests/dcm-backend/Dockerfile
 create mode 100644 e2e-tests/dcm-backend/README.md
 create mode 100644 e2e-tests/dcm-backend/nest-cli.json
 create mode 100644 e2e-tests/dcm-backend/package.json
 create mode 100644 e2e-tests/dcm-backend/src/app.controller.ts
 create mode 100644 e2e-tests/dcm-backend/src/app.module.ts
 create mode 100644 e2e-tests/dcm-backend/src/app.service.ts
 create mode 100644 e2e-tests/dcm-backend/src/main.ts
 create mode 100644 e2e-tests/dcm-backend/tsconfig.build.json
 create mode 100644 e2e-tests/dcm-backend/tsconfig.json

diff --git a/.gitignore b/.gitignore
index db2250e..f0060cc 100644
--- a/.gitignore
+++ b/.gitignore
@@ -66,4 +66,7 @@ default-env.json
 
 /dist
 .vscode/
-.tscache/
\ No newline at end of file
+.tscache/
+
+/e2e-tests/dcm-backend/dist
+/e2e-tests/dcm-backend/node_modules
\ No newline at end of file
diff --git a/e2e-tests/dcm-backend/.eslintrc.js b/e2e-tests/dcm-backend/.eslintrc.js
new file mode 100644
index 0000000..0ae17ca
--- /dev/null
+++ b/e2e-tests/dcm-backend/.eslintrc.js
@@ -0,0 +1,24 @@
+module.exports = {
+  parser: '@typescript-eslint/parser',
+  parserOptions: {
+    project: 'tsconfig.json',
+    sourceType: 'module',
+  },
+  plugins: ['@typescript-eslint/eslint-plugin'],
+  extends: [
+    'plugin:@typescript-eslint/eslint-recommended',
+    'plugin:@typescript-eslint/recommended',
+    'prettier',
+    'prettier/@typescript-eslint',
+  ],
+  root: true,
+  env: {
+    node: true,
+    jest: true,
+  },
+  rules: {
+    '@typescript-eslint/interface-name-prefix': 'off',
+    '@typescript-eslint/explicit-function-return-type': 'off',
+    '@typescript-eslint/no-explicit-any': 'off',
+  },
+};
diff --git a/e2e-tests/dcm-backend/.prettierrc b/e2e-tests/dcm-backend/.prettierrc
new file mode 100644
index 0000000..dcb7279
--- /dev/null
+++ b/e2e-tests/dcm-backend/.prettierrc
@@ -0,0 +1,4 @@
+{
+  "singleQuote": true,
+  "trailingComma": "all"
+}
\ No newline at end of file
diff --git a/e2e-tests/dcm-backend/Dockerfile b/e2e-tests/dcm-backend/Dockerfile
new file mode 100644
index 0000000..1e8706c
--- /dev/null
+++ b/e2e-tests/dcm-backend/Dockerfile
@@ -0,0 +1,6 @@
+FROM node:12.13-alpine
+WORKDIR /usr/src/dcm-backend
+COPY package.json ./
+RUN npm i
+COPY . /usr/src/dcm-backend
+CMD [ "npm", "run", "build" ]
diff --git a/e2e-tests/dcm-backend/README.md b/e2e-tests/dcm-backend/README.md
new file mode 100644
index 0000000..a59ef92
--- /dev/null
+++ b/e2e-tests/dcm-backend/README.md
@@ -0,0 +1,75 @@
+<p align="center">
+  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
+</p>
+
+[travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
+[travis-url]: https://travis-ci.org/nestjs/nest
+[linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
+[linux-url]: https://travis-ci.org/nestjs/nest
+  
+  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
+    <p align="center">
+<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
+<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
+<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/dm/@nestjs/core.svg" alt="NPM Downloads" /></a>
+<a href="https://travis-ci.org/nestjs/nest"><img src="https://api.travis-ci.org/nestjs/nest.svg?branch=master" alt="Travis" /></a>
+<a href="https://travis-ci.org/nestjs/nest"><img src="https://img.shields.io/travis/nestjs/nest/master.svg?label=linux" alt="Linux" /></a>
+<a href="https://coveralls.io/github/nestjs/nest?branch=master"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#5" alt="Coverage" /></a>
+<a href="https://gitter.im/nestjs/nestjs?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=body_badge"><img src="https://badges.gitter.im/nestjs/nestjs.svg" alt="Gitter" /></a>
+<a href="https://opencollective.com/nest#backer"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
+<a href="https://opencollective.com/nest#sponsor"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
+  <a href="https://paypal.me/kamilmysliwiec"><img src="https://img.shields.io/badge/Donate-PayPal-dc3d53.svg"/></a>
+  <a href="https://twitter.com/nestframework"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow"></a>
+</p>
+  <!--[![Backers on Open Collective](https://opencollective.com/nest/backers/badge.svg)](https://opencollective.com/nest#backer)
+  [![Sponsors on Open Collective](https://opencollective.com/nest/sponsors/badge.svg)](https://opencollective.com/nest#sponsor)-->
+
+## Description
+
+[Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.
+
+## Installation
+
+```bash
+$ npm install
+```
+
+## Running the app
+
+```bash
+# development
+$ npm run start
+
+# watch mode
+$ npm run start:dev
+
+# production mode
+$ npm run start:prod
+```
+
+## Test
+
+```bash
+# unit tests
+$ npm run test
+
+# e2e tests
+$ npm run test:e2e
+
+# test coverage
+$ npm run test:cov
+```
+
+## Support
+
+Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
+
+## Stay in touch
+
+- Author - [Kamil Myśliwiec](https://kamilmysliwiec.com)
+- Website - [https://nestjs.com](https://nestjs.com/)
+- Twitter - [@nestframework](https://twitter.com/nestframework)
+
+## License
+
+  Nest is [MIT licensed](LICENSE).
diff --git a/e2e-tests/dcm-backend/nest-cli.json b/e2e-tests/dcm-backend/nest-cli.json
new file mode 100644
index 0000000..56167b3
--- /dev/null
+++ b/e2e-tests/dcm-backend/nest-cli.json
@@ -0,0 +1,4 @@
+{
+  "collection": "@nestjs/schematics",
+  "sourceRoot": "src"
+}
diff --git a/e2e-tests/dcm-backend/package.json b/e2e-tests/dcm-backend/package.json
new file mode 100644
index 0000000..c053fc4
--- /dev/null
+++ b/e2e-tests/dcm-backend/package.json
@@ -0,0 +1,66 @@
+{
+  "name": "dcm-backend",
+  "version": "0.0.1",
+  "description": "",
+  "author": "",
+  "license": "MIT",
+  "scripts": {
+    "prebuild": "rimraf dist",
+    "build": "nest build",
+    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
+    "start": "nest start",
+    "start:dev": "nest start --watch",
+    "start:debug": "nest start --debug --watch",
+    "start:prod": "node dist/main",
+    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
+    "test": "jest",
+    "test:watch": "jest --watch",
+    "test:cov": "jest --coverage",
+    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
+    "test:e2e": "jest --config ./test/jest-e2e.json"
+  },
+  "dependencies": {
+    "@nestjs/common": "^6.10.14",
+    "@nestjs/core": "^6.10.14",
+    "@nestjs/platform-express": "^6.10.14",
+    "reflect-metadata": "^0.1.13",
+    "rimraf": "^3.0.0",
+    "rxjs": "^6.5.4"
+  },
+  "devDependencies": {
+    "@nestjs/cli": "^6.13.2",
+    "@nestjs/schematics": "^6.8.1",
+    "@nestjs/testing": "^6.10.14",
+    "@types/express": "^4.17.2",
+    "@types/jest": "25.1.2",
+    "@types/node": "^13.1.6",
+    "@types/supertest": "^2.0.8",
+    "@typescript-eslint/eslint-plugin": "^2.12.0",
+    "@typescript-eslint/parser": "^2.12.0",
+    "eslint": "^6.7.2",
+    "eslint-config-prettier": "^6.7.0",
+    "eslint-plugin-import": "^2.19.1",
+    "jest": "^24.9.0",
+    "prettier": "^1.18.2",
+    "supertest": "^4.0.2",
+    "ts-jest": "25.2.0",
+    "ts-loader": "^6.2.1",
+    "ts-node": "^8.6.0",
+    "tsconfig-paths": "^3.9.0",
+    "typescript": "^3.7.4"
+  },
+  "jest": {
+    "moduleFileExtensions": [
+      "js",
+      "json",
+      "ts"
+    ],
+    "rootDir": "src",
+    "testRegex": ".spec.ts$",
+    "transform": {
+      "^.+\\.(t|j)s$": "ts-jest"
+    },
+    "coverageDirectory": "../coverage",
+    "testEnvironment": "node"
+  }
+}
diff --git a/e2e-tests/dcm-backend/src/app.controller.ts b/e2e-tests/dcm-backend/src/app.controller.ts
new file mode 100644
index 0000000..7a54154
--- /dev/null
+++ b/e2e-tests/dcm-backend/src/app.controller.ts
@@ -0,0 +1,13 @@
+import {Controller, Get} from '@nestjs/common';
+import {AppService} from './app.service';
+
+@Controller()
+export class AppController {
+    constructor(private readonly appService: AppService) {
+    }
+
+    @Get('/sap/bc/ui2/cdm3/entities')
+    async getDcmContent(): Promise<any> {
+        return this.appService.getDcmContent();
+    }
+}
diff --git a/e2e-tests/dcm-backend/src/app.module.ts b/e2e-tests/dcm-backend/src/app.module.ts
new file mode 100644
index 0000000..05c3adf
--- /dev/null
+++ b/e2e-tests/dcm-backend/src/app.module.ts
@@ -0,0 +1,11 @@
+import {Module} from '@nestjs/common';
+import {AppController} from './app.controller';
+import {AppService} from './app.service';
+
+@Module({
+    imports: [],
+    controllers: [AppController],
+    providers: [AppService],
+})
+export class AppModule {
+}
diff --git a/e2e-tests/dcm-backend/src/app.service.ts b/e2e-tests/dcm-backend/src/app.service.ts
new file mode 100644
index 0000000..b6d4a85
--- /dev/null
+++ b/e2e-tests/dcm-backend/src/app.service.ts
@@ -0,0 +1,15 @@
+import {Injectable} from '@nestjs/common';
+
+@Injectable()
+export class AppService {
+    async getDcmContent(): Promise<any> {
+        return {
+            cdm: {
+                identification: {
+                    id: '123',
+                    entityType: 'businessapp'
+                }
+            }
+        };
+    }
+}
diff --git a/e2e-tests/dcm-backend/src/main.ts b/e2e-tests/dcm-backend/src/main.ts
new file mode 100644
index 0000000..297bdd8
--- /dev/null
+++ b/e2e-tests/dcm-backend/src/main.ts
@@ -0,0 +1,9 @@
+import {NestFactory} from '@nestjs/core';
+import {AppModule} from './app.module';
+
+async function bootstrap() {
+    const app = await NestFactory.create(AppModule);
+    await app.listen(4000);
+}
+
+bootstrap();
diff --git a/e2e-tests/dcm-backend/tsconfig.build.json b/e2e-tests/dcm-backend/tsconfig.build.json
new file mode 100644
index 0000000..64f86c6
--- /dev/null
+++ b/e2e-tests/dcm-backend/tsconfig.build.json
@@ -0,0 +1,4 @@
+{
+  "extends": "./tsconfig.json",
+  "exclude": ["node_modules", "test", "dist", "**/*spec.ts"]
+}
diff --git a/e2e-tests/dcm-backend/tsconfig.json b/e2e-tests/dcm-backend/tsconfig.json
new file mode 100644
index 0000000..69f185f
--- /dev/null
+++ b/e2e-tests/dcm-backend/tsconfig.json
@@ -0,0 +1,15 @@
+{
+  "compilerOptions": {
+    "module": "commonjs",
+    "declaration": true,
+    "removeComments": true,
+    "emitDecoratorMetadata": true,
+    "experimentalDecorators": true,
+    "target": "es2017",
+    "sourceMap": true,
+    "outDir": "./dist",
+    "baseUrl": "./",
+    "incremental": true
+  },
+  "exclude": ["node_modules", "dist"]
+}

From 2997c131a8caa29ce17fbad7f95a810f640d13d4 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Fri, 6 Mar 2020 23:33:56 +0200
Subject: [PATCH 12/22] readme update

---
 e2e-tests/dcm-backend/README.md | 56 +--------------------------------
 1 file changed, 1 insertion(+), 55 deletions(-)

diff --git a/e2e-tests/dcm-backend/README.md b/e2e-tests/dcm-backend/README.md
index a59ef92..43ebcc1 100644
--- a/e2e-tests/dcm-backend/README.md
+++ b/e2e-tests/dcm-backend/README.md
@@ -1,32 +1,5 @@
-<p align="center">
-  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo_text.svg" width="320" alt="Nest Logo" /></a>
-</p>
-
-[travis-image]: https://api.travis-ci.org/nestjs/nest.svg?branch=master
-[travis-url]: https://travis-ci.org/nestjs/nest
-[linux-image]: https://img.shields.io/travis/nestjs/nest/master.svg?label=linux
-[linux-url]: https://travis-ci.org/nestjs/nest
-  
-  <p align="center">A progressive <a href="http://nodejs.org" target="blank">Node.js</a> framework for building efficient and scalable server-side applications, heavily inspired by <a href="https://angular.io" target="blank">Angular</a>.</p>
-    <p align="center">
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
-<a href="https://www.npmjs.com/~nestjscore"><img src="https://img.shields.io/npm/dm/@nestjs/core.svg" alt="NPM Downloads" /></a>
-<a href="https://travis-ci.org/nestjs/nest"><img src="https://api.travis-ci.org/nestjs/nest.svg?branch=master" alt="Travis" /></a>
-<a href="https://travis-ci.org/nestjs/nest"><img src="https://img.shields.io/travis/nestjs/nest/master.svg?label=linux" alt="Linux" /></a>
-<a href="https://coveralls.io/github/nestjs/nest?branch=master"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#5" alt="Coverage" /></a>
-<a href="https://gitter.im/nestjs/nestjs?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=body_badge"><img src="https://badges.gitter.im/nestjs/nestjs.svg" alt="Gitter" /></a>
-<a href="https://opencollective.com/nest#backer"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
-<a href="https://opencollective.com/nest#sponsor"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
-  <a href="https://paypal.me/kamilmysliwiec"><img src="https://img.shields.io/badge/Donate-PayPal-dc3d53.svg"/></a>
-  <a href="https://twitter.com/nestframework"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow"></a>
-</p>
-  <!--[![Backers on Open Collective](https://opencollective.com/nest/backers/badge.svg)](https://opencollective.com/nest#backer)
-  [![Sponsors on Open Collective](https://opencollective.com/nest/sponsors/badge.svg)](https://opencollective.com/nest#sponsor)-->
-
 ## Description
-
-[Nest](https://github.com/nestjs/nest) framework TypeScript starter repository.
+Just another application, simulates a dcm backend system for e2e testing.
 
 ## Installation
 
@@ -46,30 +19,3 @@ $ npm run start:dev
 # production mode
 $ npm run start:prod
 ```
-
-## Test
-
-```bash
-# unit tests
-$ npm run test
-
-# e2e tests
-$ npm run test:e2e
-
-# test coverage
-$ npm run test:cov
-```
-
-## Support
-
-Nest is an MIT-licensed open source project. It can grow thanks to the sponsors and support by the amazing backers. If you'd like to join them, please [read more here](https://docs.nestjs.com/support).
-
-## Stay in touch
-
-- Author - [Kamil Myśliwiec](https://kamilmysliwiec.com)
-- Website - [https://nestjs.com](https://nestjs.com/)
-- Twitter - [@nestframework](https://twitter.com/nestframework)
-
-## License
-
-  Nest is [MIT licensed](LICENSE).

From ec911256690599ad264c539c8d0b2870f67d3888 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Sat, 7 Mar 2020 00:05:31 +0200
Subject: [PATCH 13/22] add env to docker compose

---
 docker-compose.yml | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/docker-compose.yml b/docker-compose.yml
index 366c943..f0ed9ee 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -34,11 +34,14 @@ services:
 
   dcm-backend:
     container_name: dcm-backend
-    build: e2e-test/dcm-backend
+    build: e2e-tests/dcm-backend
     command:
-      sh -c 'npm run start:dev'
+      sh -c 'npm i && npm run build && npm run start:dev'
+    environment:
+      - TS_NODE_TRANSPILE_ONLY=true
+      - TS_NODE_FILES=true
     ports:
       - 4000:4000
     tty: true
     volumes:
-      - ./e2e-test/dcm-backend:/usr/src/dcm-backend
\ No newline at end of file
+      - ./e2e-tests/dcm-backend:/usr/src/dcm-backend
\ No newline at end of file

From 11d5770d4c1b41c8dd4b20200a6a87fc8d7e35a3 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Sun, 8 Mar 2020 17:33:48 +0200
Subject: [PATCH 14/22] delete dcm-backend app

---
 docker-compose.yml                          | 16 +----
 e2e-tests/dcm-backend/.eslintrc.js          | 24 --------
 e2e-tests/dcm-backend/.prettierrc           |  4 --
 e2e-tests/dcm-backend/Dockerfile            |  6 --
 e2e-tests/dcm-backend/README.md             | 21 -------
 e2e-tests/dcm-backend/nest-cli.json         |  4 --
 e2e-tests/dcm-backend/package.json          | 66 ---------------------
 e2e-tests/dcm-backend/src/app.controller.ts | 13 ----
 e2e-tests/dcm-backend/src/app.module.ts     | 11 ----
 e2e-tests/dcm-backend/src/app.service.ts    | 15 -----
 e2e-tests/dcm-backend/src/main.ts           |  9 ---
 e2e-tests/dcm-backend/tsconfig.build.json   |  4 --
 e2e-tests/dcm-backend/tsconfig.json         | 15 -----
 13 files changed, 1 insertion(+), 207 deletions(-)
 delete mode 100644 e2e-tests/dcm-backend/.eslintrc.js
 delete mode 100644 e2e-tests/dcm-backend/.prettierrc
 delete mode 100644 e2e-tests/dcm-backend/Dockerfile
 delete mode 100644 e2e-tests/dcm-backend/README.md
 delete mode 100644 e2e-tests/dcm-backend/nest-cli.json
 delete mode 100644 e2e-tests/dcm-backend/package.json
 delete mode 100644 e2e-tests/dcm-backend/src/app.controller.ts
 delete mode 100644 e2e-tests/dcm-backend/src/app.module.ts
 delete mode 100644 e2e-tests/dcm-backend/src/app.service.ts
 delete mode 100644 e2e-tests/dcm-backend/src/main.ts
 delete mode 100644 e2e-tests/dcm-backend/tsconfig.build.json
 delete mode 100644 e2e-tests/dcm-backend/tsconfig.json

diff --git a/docker-compose.yml b/docker-compose.yml
index f0ed9ee..d8ceba1 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -30,18 +30,4 @@ services:
           cpus: '0.25'
           memory: 256M
     depends_on:
-      - redis
-
-  dcm-backend:
-    container_name: dcm-backend
-    build: e2e-tests/dcm-backend
-    command:
-      sh -c 'npm i && npm run build && npm run start:dev'
-    environment:
-      - TS_NODE_TRANSPILE_ONLY=true
-      - TS_NODE_FILES=true
-    ports:
-      - 4000:4000
-    tty: true
-    volumes:
-      - ./e2e-tests/dcm-backend:/usr/src/dcm-backend
\ No newline at end of file
+      - redis
\ No newline at end of file
diff --git a/e2e-tests/dcm-backend/.eslintrc.js b/e2e-tests/dcm-backend/.eslintrc.js
deleted file mode 100644
index 0ae17ca..0000000
--- a/e2e-tests/dcm-backend/.eslintrc.js
+++ /dev/null
@@ -1,24 +0,0 @@
-module.exports = {
-  parser: '@typescript-eslint/parser',
-  parserOptions: {
-    project: 'tsconfig.json',
-    sourceType: 'module',
-  },
-  plugins: ['@typescript-eslint/eslint-plugin'],
-  extends: [
-    'plugin:@typescript-eslint/eslint-recommended',
-    'plugin:@typescript-eslint/recommended',
-    'prettier',
-    'prettier/@typescript-eslint',
-  ],
-  root: true,
-  env: {
-    node: true,
-    jest: true,
-  },
-  rules: {
-    '@typescript-eslint/interface-name-prefix': 'off',
-    '@typescript-eslint/explicit-function-return-type': 'off',
-    '@typescript-eslint/no-explicit-any': 'off',
-  },
-};
diff --git a/e2e-tests/dcm-backend/.prettierrc b/e2e-tests/dcm-backend/.prettierrc
deleted file mode 100644
index dcb7279..0000000
--- a/e2e-tests/dcm-backend/.prettierrc
+++ /dev/null
@@ -1,4 +0,0 @@
-{
-  "singleQuote": true,
-  "trailingComma": "all"
-}
\ No newline at end of file
diff --git a/e2e-tests/dcm-backend/Dockerfile b/e2e-tests/dcm-backend/Dockerfile
deleted file mode 100644
index 1e8706c..0000000
--- a/e2e-tests/dcm-backend/Dockerfile
+++ /dev/null
@@ -1,6 +0,0 @@
-FROM node:12.13-alpine
-WORKDIR /usr/src/dcm-backend
-COPY package.json ./
-RUN npm i
-COPY . /usr/src/dcm-backend
-CMD [ "npm", "run", "build" ]
diff --git a/e2e-tests/dcm-backend/README.md b/e2e-tests/dcm-backend/README.md
deleted file mode 100644
index 43ebcc1..0000000
--- a/e2e-tests/dcm-backend/README.md
+++ /dev/null
@@ -1,21 +0,0 @@
-## Description
-Just another application, simulates a dcm backend system for e2e testing.
-
-## Installation
-
-```bash
-$ npm install
-```
-
-## Running the app
-
-```bash
-# development
-$ npm run start
-
-# watch mode
-$ npm run start:dev
-
-# production mode
-$ npm run start:prod
-```
diff --git a/e2e-tests/dcm-backend/nest-cli.json b/e2e-tests/dcm-backend/nest-cli.json
deleted file mode 100644
index 56167b3..0000000
--- a/e2e-tests/dcm-backend/nest-cli.json
+++ /dev/null
@@ -1,4 +0,0 @@
-{
-  "collection": "@nestjs/schematics",
-  "sourceRoot": "src"
-}
diff --git a/e2e-tests/dcm-backend/package.json b/e2e-tests/dcm-backend/package.json
deleted file mode 100644
index c053fc4..0000000
--- a/e2e-tests/dcm-backend/package.json
+++ /dev/null
@@ -1,66 +0,0 @@
-{
-  "name": "dcm-backend",
-  "version": "0.0.1",
-  "description": "",
-  "author": "",
-  "license": "MIT",
-  "scripts": {
-    "prebuild": "rimraf dist",
-    "build": "nest build",
-    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
-    "start": "nest start",
-    "start:dev": "nest start --watch",
-    "start:debug": "nest start --debug --watch",
-    "start:prod": "node dist/main",
-    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
-    "test": "jest",
-    "test:watch": "jest --watch",
-    "test:cov": "jest --coverage",
-    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
-    "test:e2e": "jest --config ./test/jest-e2e.json"
-  },
-  "dependencies": {
-    "@nestjs/common": "^6.10.14",
-    "@nestjs/core": "^6.10.14",
-    "@nestjs/platform-express": "^6.10.14",
-    "reflect-metadata": "^0.1.13",
-    "rimraf": "^3.0.0",
-    "rxjs": "^6.5.4"
-  },
-  "devDependencies": {
-    "@nestjs/cli": "^6.13.2",
-    "@nestjs/schematics": "^6.8.1",
-    "@nestjs/testing": "^6.10.14",
-    "@types/express": "^4.17.2",
-    "@types/jest": "25.1.2",
-    "@types/node": "^13.1.6",
-    "@types/supertest": "^2.0.8",
-    "@typescript-eslint/eslint-plugin": "^2.12.0",
-    "@typescript-eslint/parser": "^2.12.0",
-    "eslint": "^6.7.2",
-    "eslint-config-prettier": "^6.7.0",
-    "eslint-plugin-import": "^2.19.1",
-    "jest": "^24.9.0",
-    "prettier": "^1.18.2",
-    "supertest": "^4.0.2",
-    "ts-jest": "25.2.0",
-    "ts-loader": "^6.2.1",
-    "ts-node": "^8.6.0",
-    "tsconfig-paths": "^3.9.0",
-    "typescript": "^3.7.4"
-  },
-  "jest": {
-    "moduleFileExtensions": [
-      "js",
-      "json",
-      "ts"
-    ],
-    "rootDir": "src",
-    "testRegex": ".spec.ts$",
-    "transform": {
-      "^.+\\.(t|j)s$": "ts-jest"
-    },
-    "coverageDirectory": "../coverage",
-    "testEnvironment": "node"
-  }
-}
diff --git a/e2e-tests/dcm-backend/src/app.controller.ts b/e2e-tests/dcm-backend/src/app.controller.ts
deleted file mode 100644
index 7a54154..0000000
--- a/e2e-tests/dcm-backend/src/app.controller.ts
+++ /dev/null
@@ -1,13 +0,0 @@
-import {Controller, Get} from '@nestjs/common';
-import {AppService} from './app.service';
-
-@Controller()
-export class AppController {
-    constructor(private readonly appService: AppService) {
-    }
-
-    @Get('/sap/bc/ui2/cdm3/entities')
-    async getDcmContent(): Promise<any> {
-        return this.appService.getDcmContent();
-    }
-}
diff --git a/e2e-tests/dcm-backend/src/app.module.ts b/e2e-tests/dcm-backend/src/app.module.ts
deleted file mode 100644
index 05c3adf..0000000
--- a/e2e-tests/dcm-backend/src/app.module.ts
+++ /dev/null
@@ -1,11 +0,0 @@
-import {Module} from '@nestjs/common';
-import {AppController} from './app.controller';
-import {AppService} from './app.service';
-
-@Module({
-    imports: [],
-    controllers: [AppController],
-    providers: [AppService],
-})
-export class AppModule {
-}
diff --git a/e2e-tests/dcm-backend/src/app.service.ts b/e2e-tests/dcm-backend/src/app.service.ts
deleted file mode 100644
index b6d4a85..0000000
--- a/e2e-tests/dcm-backend/src/app.service.ts
+++ /dev/null
@@ -1,15 +0,0 @@
-import {Injectable} from '@nestjs/common';
-
-@Injectable()
-export class AppService {
-    async getDcmContent(): Promise<any> {
-        return {
-            cdm: {
-                identification: {
-                    id: '123',
-                    entityType: 'businessapp'
-                }
-            }
-        };
-    }
-}
diff --git a/e2e-tests/dcm-backend/src/main.ts b/e2e-tests/dcm-backend/src/main.ts
deleted file mode 100644
index 297bdd8..0000000
--- a/e2e-tests/dcm-backend/src/main.ts
+++ /dev/null
@@ -1,9 +0,0 @@
-import {NestFactory} from '@nestjs/core';
-import {AppModule} from './app.module';
-
-async function bootstrap() {
-    const app = await NestFactory.create(AppModule);
-    await app.listen(4000);
-}
-
-bootstrap();
diff --git a/e2e-tests/dcm-backend/tsconfig.build.json b/e2e-tests/dcm-backend/tsconfig.build.json
deleted file mode 100644
index 64f86c6..0000000
--- a/e2e-tests/dcm-backend/tsconfig.build.json
+++ /dev/null
@@ -1,4 +0,0 @@
-{
-  "extends": "./tsconfig.json",
-  "exclude": ["node_modules", "test", "dist", "**/*spec.ts"]
-}
diff --git a/e2e-tests/dcm-backend/tsconfig.json b/e2e-tests/dcm-backend/tsconfig.json
deleted file mode 100644
index 69f185f..0000000
--- a/e2e-tests/dcm-backend/tsconfig.json
+++ /dev/null
@@ -1,15 +0,0 @@
-{
-  "compilerOptions": {
-    "module": "commonjs",
-    "declaration": true,
-    "removeComments": true,
-    "emitDecoratorMetadata": true,
-    "experimentalDecorators": true,
-    "target": "es2017",
-    "sourceMap": true,
-    "outDir": "./dist",
-    "baseUrl": "./",
-    "incremental": true
-  },
-  "exclude": ["node_modules", "dist"]
-}

From 4dadd33c39e8195f40cfe8d97897ee969bce66fe Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Sun, 8 Mar 2020 23:27:56 +0200
Subject: [PATCH 15/22] adding cdm-store-service and postgresql

---
 docker-compose.yml        | 37 +++++++++++++++++++++++++++++++++++--
 src/app/app.controller.ts | 31 -------------------------------
 2 files changed, 35 insertions(+), 33 deletions(-)

diff --git a/docker-compose.yml b/docker-compose.yml
index d8ceba1..98b3b3f 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -1,8 +1,22 @@
 version: '3.7'
 services:
+
   redis:
     container_name: redis
-    image: "redis:4.0"
+    image: redis:4.0
+
+  postgres:
+    image: postgres:9.6
+    container_name: postgres
+    volumes:
+      - postgres-data:/var/lib/postgresql/data
+    expose:
+      - 5432
+    ports:
+      - 5432:5432
+    environment:
+      - POSTGRES_USER=I324180
+      - POSTGRES_PASSWORD=Abcd1234
 
   transport-service:
     build: .
@@ -30,4 +44,23 @@ services:
           cpus: '0.25'
           memory: 256M
     depends_on:
-      - redis
\ No newline at end of file
+      - redis
+
+  cdm-store-service:
+    build:
+      context: ../portal-cf-cdm-store-service
+      args:
+        db_username: I324180
+        db_password: Abcd1234
+    container_name: cdm-store-service
+    expose:
+      - 8082
+    ports:
+      - 8082:8082
+    restart: unless-stopped
+    depends_on:
+      - postgres
+
+volumes:
+  postgres-data:
+    driver: local
\ No newline at end of file
diff --git a/src/app/app.controller.ts b/src/app/app.controller.ts
index 8cce9bc..ea23a29 100644
--- a/src/app/app.controller.ts
+++ b/src/app/app.controller.ts
@@ -1,40 +1,9 @@
 import {Controller, Get, HttpStatus, Res} from '@nestjs/common';
-import * as ioRedis from 'ioredis';
 @Controller()
 export class AppController {
 
   @Get('/is_alive')
   async healthCheck(@Res() res) {
-
-    // let redis = new ioRedis(process.env.REDIS_HOST);
-    // (async () => {
-    //   // All of the usual redis commands are available, and return promises.
-    //   await redis.set('foo', 'bar');
-    //
-    //   const result = await redis.get('foo');
-    //   console.log(result)
-    //
-    //   redis.lpush('list', [
-    //     'New York',
-    //     'London',
-    //     'LA',
-    //     'Hong Kong'
-    //   ]);
-    //
-    //   const cities = await redis.lrange('list', 0, -1);
-    //   console.log(cities)
-    //
-    //   // You can combine multiple commands and send them to the server as a batch to improve performance.
-    //   const hash = await redis
-    //       .pipeline()
-    //       .hset('hash', 'key1', 'value1')
-    //       .hset('hash', 'key2', 'value2')
-    //       .hgetall('hash')
-    //       .exec();
-    //
-    //   console.log(hash);
-    // })();
-
     res.status(HttpStatus.OK).send({ status: 'alive' });
   }
 }

From 23d19d06943961c0d7bd6126d8737d21440ab40b Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Sun, 8 Mar 2020 23:33:16 +0200
Subject: [PATCH 16/22] destination mock modify - docker-compose - gitignore

---
 .gitignore                                             | 5 +----
 docker-compose.yml                                     | 2 +-
 src/proxy/destination/mock/destination-mock.service.ts | 4 ++--
 3 files changed, 4 insertions(+), 7 deletions(-)

diff --git a/.gitignore b/.gitignore
index f0060cc..db2250e 100644
--- a/.gitignore
+++ b/.gitignore
@@ -66,7 +66,4 @@ default-env.json
 
 /dist
 .vscode/
-.tscache/
-
-/e2e-tests/dcm-backend/dist
-/e2e-tests/dcm-backend/node_modules
\ No newline at end of file
+.tscache/
\ No newline at end of file
diff --git a/docker-compose.yml b/docker-compose.yml
index 98b3b3f..f973356 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -50,7 +50,7 @@ services:
     build:
       context: ../portal-cf-cdm-store-service
       args:
-        db_username: I324180
+        db_username: portal_user
         db_password: Abcd1234
     container_name: cdm-store-service
     expose:
diff --git a/src/proxy/destination/mock/destination-mock.service.ts b/src/proxy/destination/mock/destination-mock.service.ts
index 47a6622..49318cc 100644
--- a/src/proxy/destination/mock/destination-mock.service.ts
+++ b/src/proxy/destination/mock/destination-mock.service.ts
@@ -14,9 +14,9 @@ export class DestinationMockService implements IDestinationService {
             Type: DestinationType.HTTP,
             Name: 's4_backend',
             Description: 'S4 backend exposure report system',
-            URL: 'http://dcm-backend:4000/sap/bc/ui2/cdm3/entities',
+            URL: 'http://transport-service:3000/sap/bc/ui2/cdm3/entities',
             Authentication: AuthenticationType.NO_AUTHENTICATION,
-            User: 'teamUser',
+            User: 'portalUser',
             Password: 'Abcd1234',
             ProxyType: DestinationProxyType.INTERNET
         };

From c8670254662bf676870f7af1892df01c72b25c2f Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 9 Mar 2020 13:38:31 +0200
Subject: [PATCH 17/22] docker compose changes

---
 docker-compose.yml | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/docker-compose.yml b/docker-compose.yml
index f973356..aa689ef 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -15,7 +15,7 @@ services:
     ports:
       - 5432:5432
     environment:
-      - POSTGRES_USER=I324180
+      - POSTGRES_USER=portal_user
       - POSTGRES_PASSWORD=Abcd1234
 
   transport-service:
@@ -52,12 +52,13 @@ services:
       args:
         db_username: portal_user
         db_password: Abcd1234
+        db_host: postgres
     container_name: cdm-store-service
     expose:
       - 8082
     ports:
       - 8082:8082
-    restart: unless-stopped
+   # restart: unless-stopped
     depends_on:
       - postgres
 

From 5c417f6aca7584fb928154d3cdaa01f43856b2f9 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 9 Mar 2020 14:46:55 +0200
Subject: [PATCH 18/22] compose depends_on

---
 docker-compose.yml | 1 +
 1 file changed, 1 insertion(+)

diff --git a/docker-compose.yml b/docker-compose.yml
index aa689ef..f59e782 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -45,6 +45,7 @@ services:
           memory: 256M
     depends_on:
       - redis
+      - cdm-store-service
 
   cdm-store-service:
     build:

From 24063a68081e43f3311865f49c0f586abed49d15 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 9 Mar 2020 14:50:02 +0200
Subject: [PATCH 19/22] remove console

---
 src/app/app.service.ts | 1 -
 1 file changed, 1 deletion(-)

diff --git a/src/app/app.service.ts b/src/app/app.service.ts
index 1e729f1..986954b 100644
--- a/src/app/app.service.ts
+++ b/src/app/app.service.ts
@@ -10,7 +10,6 @@ export class AppService {
             if (Environment.isCloud()) {
                 throw(error);
             }
-            console.log('**** Redis connection could not be established ****');
         });
     }
 }

From 2c6845f8f002847ee297da84177e02900b4d569e Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 9 Mar 2020 14:57:07 +0200
Subject: [PATCH 20/22] deployment yaml

---
 .deployment/deployment.yml | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/.deployment/deployment.yml b/.deployment/deployment.yml
index 53460bb..babff14 100644
--- a/.deployment/deployment.yml
+++ b/.deployment/deployment.yml
@@ -1,3 +1,8 @@
+# general configurations
+general:
+  buildTool: npm
+  skipBuild: false
+  scanType: npm
 
 component: node-services
 requires:

From 84d21e837e450c8b5394fd8b46ce2a0824c42fc8 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 9 Mar 2020 15:00:24 +0200
Subject: [PATCH 21/22] deployment yaml

---
 .deployment/deployment.yml | 6 ------
 1 file changed, 6 deletions(-)

diff --git a/.deployment/deployment.yml b/.deployment/deployment.yml
index babff14..177ffd3 100644
--- a/.deployment/deployment.yml
+++ b/.deployment/deployment.yml
@@ -1,9 +1,3 @@
-# general configurations
-general:
-  buildTool: npm
-  skipBuild: false
-  scanType: npm
-
 component: node-services
 requires:
   - portal_config: portal-config

From eb2d4c84bb3aef41d053adb1407afc4e72fdcd39 Mon Sep 17 00:00:00 2001
From: Erez Neiderman <erez.neiderman@sap.com>
Date: Mon, 9 Mar 2020 15:21:12 +0200
Subject: [PATCH 22/22] Update .xmake.cfg

---
 .xmake.cfg | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.xmake.cfg b/.xmake.cfg
index e6ebe52..489ceeb 100644
--- a/.xmake.cfg
+++ b/.xmake.cfg
@@ -1,4 +1,5 @@
 [buildplugin] 
+name=node
 node-version=10.17.0
 bundle=true
 make-shrinkwrap=true

            1.19.11.2 run docker-compose
npm i
docker-compose up -d

            1.19.11.3
        1.19.12 Mock external (s4) content provider
expose API in transport service. https://portal-service-yosib4-i310019.cfapps.sap.hana.ondemand.com/transport_service/return_content
configure destination. see note "Yosib4 space"

PR w/ code.         https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/210
code:
https://github.wdf.sap.corp/raw/Portal-CF/portal-cf-transport-service/pull/210.patch

From fb19151f8e427f47535016a52c40f2fae2fec1d8 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Sun, 3 May 2020 16:53:11 +0300
Subject: [PATCH 1/4] get content api

---
 src/app/app.controller.ts                     |   34 +-
 .../resources/entities_spaces_and_pages1.json | 5451 +++++++++++++++++
 2 files changed, 5473 insertions(+), 12 deletions(-)
 create mode 100644 src/app/resources/entities_spaces_and_pages1.json

diff --git a/src/app/app.controller.ts b/src/app/app.controller.ts
index 7bd324b..686fce5 100644
--- a/src/app/app.controller.ts
+++ b/src/app/app.controller.ts
@@ -1,7 +1,10 @@
 import {Controller, Get, HttpStatus, Next, Req, Res} from '@nestjs/common';
-import {join} from 'path';
+// import {join} from 'path';
 import {Response, NextFunction, Request} from 'express';
 
+import * as fs from 'fs';
+import * as path from 'path';
+
 @Controller()
 export class AppController {
 
@@ -9,17 +12,24 @@ export class AppController {
     async healthCheck(@Res() res) {
         res.status(HttpStatus.OK).send({status: 'alive'});
     }
+    //
+    // @Get('/client/lib/:filename')
+    // async getStaticFile(@Res() res: Response, @Next() next: NextFunction, @Req() req: Request) {
+    //     const options = {
+    //         root: join(process.cwd(), 'client/lib/'),
+    //         dotfiles: 'deny',
+    //         headers: {
+    //             'x-timestamp': Date.now(),
+    //             'x-sent': true
+    //         }
+    //     };
+    //     res.sendFile(req.params.filename, options);
+    // }
+
+    @Get('/return_content')
+    async pagesAndSpacesContent(@Res() res) {
+        const filedata = fs.readFileSync(path.resolve(__dirname, 'resources/entities_spaces_and_pages1.json'), "UTF-8");
 
-    @Get('/client/lib/:filename')
-    async getStaticFile(@Res() res: Response, @Next() next: NextFunction, @Req() req: Request) {
-        const options = {
-            root: join(process.cwd(), 'client/lib/'),
-            dotfiles: 'deny',
-            headers: {
-                'x-timestamp': Date.now(),
-                'x-sent': true
-            }
-        };
-        res.sendFile(req.params.filename, options);
+        res.status(HttpStatus.OK).send(filedata);
     }
 }
diff --git a/src/app/resources/entities_spaces_and_pages1.json b/src/app/resources/entities_spaces_and_pages1.json
(large file)
diff --git a/package.json b/package.json
index 97ddb00..803231f 100644
--- a/package.json
+++ b/package.json
@@ -6,7 +6,7 @@
     "license": "MIT",
     "scripts": {
         "prebuild": "rimraf dist",
-        "build": "tsc -p tsconfig.build.json",
+        "build": "tsc -p tsconfig.build.json && copyfiles -u 1 ./src/**/*.json ./dist",
         "build:browser": "tsc ./src/zip/transport-zip.module.ts --outDir ./client/lib -m commonjs -t ES5 && grunt browser-build",
         "postinstall": "npm run build",
         "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
@@ -37,31 +37,32 @@
         "@sap/xssec": "2.2.5",
         "@types/express": "4.16.1",
         "@types/node": "12.7.8",
+        "archiver": "3.0.3",
+        "axios": "0.19.1",
+        "bfj": "6.1.1",
+        "cdm-schema": "3.0.0-20200419144534",
         "cdm-store-client": "1.20.0-20200421073506",
+        "cf-nodejs-logging-support": "6.0.1",
         "class-transformer": "0.2.3",
         "class-validator": "0.11.0",
         "cls-hooked": "4.2.2",
         "ioredis": "4.14.1",
+        "jszip": "3.2.2",
         "lodash": "4.17.15",
+        "multer": "1.4.2",
         "passport": "0.4.0",
         "portal-cf-shared-lib": "4.2.0-20200420120718",
         "reflect-metadata": "0.1.13",
-        "rxjs": "6.5.3",
-        "swagger-ui-express": "4.1.2",
-        "uuid": "3.3.3",
-        "cf-nodejs-logging-support": "6.0.1",
-        "archiver": "3.0.3",
-        "jszip": "3.2.2",
-        "cdm-schema": "3.0.0-20200419144534",
-        "axios": "0.19.1",
         "retry-axios": "2.1.1",
-        "bfj": "6.1.1",
-        "multer": "1.4.2",
         "rimraf": "3.0.0",
+        "rxjs": "6.5.3",
+        "swagger-ui-express": "4.1.2",
         "ts-node": "8.6.2",
-        "typescript": "3.7.3"
+        "typescript": "^3.7.3",
+        "uuid": "3.3.3"
     },
     "devDependencies": {
+        "copyfiles": "2.2.0",
         "@nestjs/cli": "^6.14.2",
         "@nestjs/testing": "6.1.1",
         "@types/archiver": "3.0.0",



        1.19.13 Integration-Tests

            1.19.13.1 how to run

                1.19.13.1.1 run redis
 docker run --name local-redis -d -p 6379:6379 redis:4.0

 verify it is up
  docker ps -all
  CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
d623d12848f8        redis:4.0           "docker-entrypoint.s…"   About an hour ago   Up About an hour    0.0.0.0:6379->6379/tcp   local-redis

if its only stopped. run $ docker start local-redis

id=__runpostgresdocker__
                1.19.13.1.2 run postgres docker, tags: docker postgres pg
docker run --name local-postgres -e POSTGRES_USER=i500695 -e POSTGRES_PASSWORD=Abcd1234 -d -p 5432:5432 postgres:9.6

Note that the acual local connection setting are in
/src/config/local.config.ts b/src/config/local.config.ts
+                username: process.env.PGUSER ?? 'postgres',
+                password: process.env.PGPWD ?? 'postgres',

set env accordingly.
 export PGUSER='i500695'
 export PGPWD='Abcd1234'

or just pull the correct config settings.
vimdiff src/config/local.config.ts  /Users/i500695/work/SAP/CF/Manifests/transport/local.config.ts

                1.19.13.1.3 run tests
verify dockers are running.
$ docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS          PORTS                    NAMES
d623d12848f8   redis:4.0      "docker-entrypoint.s…"   4 months ago    Up 8 minutes    0.0.0.0:6379->6379/tcp   local-redis
2cdc03fe0488   postgres:9.6   "docker-entrypoint.s…"   11 months ago   Up 29 minutes   0.0.0.0:5432->5432/tcp   local-postgres

run
  npm run test:integration:local

                1.19.13.1.4

            1.19.13.2
        1.19.14 transport import

            1.19.14.1 build browser side
- For production it is triggered by xmake
after_install=build:browser
see:
$ cat .xmake.cfg 
[buildplugin] 
name=node
node-version=12.13.0
bundle=true
make-shrinkwrap=true
package-shrinkwrap=true
shrinkwrap-arguments=--production
after_install=build:browser
before_publish=prepareRelease
publish-arguments=--production
[env_all]
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true

- For cf push to dev space must manually trigger
$ npm run build:browser
- if it is missing import will fail.
ex: go to content manager,
https://i310019launchpad-dt-launchpad-launchpadi310019p.cfapps.sap.hana.ondemand.com/sites#Site-Directory, 
in dev tools you'll see
FileUtils.js?eval:1 GET https://i310019launchpad-dt-launchpad-launchpadi310019p.cfapps.sap.hana.ondemand.com/transport/client/lib/transport-zip.min.js net::ERR_ABORTED 500 (Internal Server Error)

w/o this lib import will fail.

import site
get error: "import process was stopped due to an error"

-
            1.19.14.2

        1.19.15 delta link
CRUD commands odata 
        delete
/Users/i500695/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/src/test/resources/com/sap/portal/cdm/store/service/cdmEntitiesWithOdataDeltaLinkDelete.json
{
    "@odata.context": "#Entities/$deletedEntity",
    "reason": "deleted",
    "id": "SAP_PRC_BC_PRC_OVP",
    "entityType": "catalog"
  },
  {
    "@odata.context": "#Entities/$deletedEntity",
    "reason": "deleted",
    "id": "368507d0-9637-4df7-b2c4-92712fed0995",
    "entityType": "businessapp"
 }

 update
 https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/master/cdm.store.service/src/test/resources/com/sap/portal/cdm/store/service/CdmEntitiesDeltaUpdateBusinessapps.json
 which is actually just rewrite


        1.19.16 Troubelshooting

            1.19.16.1 Build

                1.19.16.1.1 Subsequent variable declarations must have the same type.  Variable 'WebGL2RenderingContext'
To fix, align package types. run
 npm i @types/webgl2 -D
more details:   https://stackoverflow.com/questions/57775444/ts2403-subsequent-variable-declarations-must-have-the-same-type-in-react

                1.19.16.1.2 error TS2307: Cannot find module './node_modules/tapable' or its corresponding type declarations.
https://stackoverflow.com/questions/66809411/webpack-typescript-errors-on-fresh-nestjs-app
you could ignore this using "skipLibCheck": true in your tsconfig.json under "compilerOptions" tho

looks like they fix that in @nestjs/cli@7.6.0

                1.19.16.1.3
            1.19.16.2

        1.19.17 CDM content generation

            1.19.17.1 Jawad's mock provider (cdm content generator), tags: Jawad mock provider cdm content generator
git: https://github.wdf.sap.corp/i324180/cdm-mock-provider 
local clone: /Users/i500695/git/cdm-mock-provider 
wiki: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2745659805

                1.19.17.1.1 Readme.md
## Description

[Nest](https://github.com/nestjs/nest) application that exposes a configurable mock cdm provider backend.
currently supports roles, applications, groups, catalogs, spaces, pages, sections and workspaces.

## Installation
Clone the repository.
```bash
$ npm install
```

## Running the app

```bash
# development
$ npm run start
```

## Generate Mock content
CDM mock content is created in an asynchronous manner once the application is deployed and after the application is started.
the reason for that is to keep the application light-weight when deploying it to your environment.

There is an option to create the content locally, and deploy the application with ```env = DISABLE_CREATE_CONTENT = true```  
### Configure cdm content size and relations
The content size can be configured in ```src/config/configuration.ts```

### Translations
Entities are generated with 40 translations.

#### Example
The below configuration generates:
- 10K Roles
  - each role has 50-100 relations to businessapps while 10 roles are restricted to have 3K businessapps.
  -  each role has 10-20 relations to workspaces
- 0 Catalogs.
- 1 Groups - with 3K applications.
- 15K applications.
- backend chunk size is 400 entities per page.
```json
        {
  "generatorConfig": {
    "role": {
      "quantity": 10000,
      "relations": {
        "businessapp": {
          "min": 50,
          "max": 100,
          "restrict": {
            "quantity": 10,
            "relations": 3000
          }
        },
        "workspace": {
          "min": 10,
          "max": 20
        }
      }
    },
    "catalog": {
      "quantity": 0,
      "relations": {
        "businessapp": {
          "min": 10,
          "max": 150
        }
      }
    },
    "group": {
      "quantity": 1,
      "relations": {
        "businessapp": {
          "min": 10,
          "max": 30,
          "restrict": {
            "quantity": 1,
            "relations": 3000
          }
        }
      }
    },
    "businessapp": {
      "quantity": 15000
    }
  },
  "odataConfig": {
    "maxChunkSize": 400
  }
}
```

### Generate content locally

#### JSON format
```bash
npm run generate-content-json
```

#### JSON format compressed using
```bash
npm run generate-content-compressed
```

### Generate content package
```bash
npm run generate-content-package
```

### generated content & content packages output directory
Generated content & content packages can be found in ```src/output_content/```

## Build and Deploy the mock provider

```bash
$ npm run build
$ cf push -f manifest-dev.yml
$ cf logs mock-provider # wait until content created successfully! is written to log.
```

### NOTE
You can always create you content locally using one of the scripts mentioned above, and deploy the mock-provider with
the env: ```DISABLE_CREATE_CONTENT: true``` that way you would have a full control over the content.
This assures that content is not re-generated when the mock-provider is restarted or deployed again.

## Create a destination for the mock provider
import ```mock-provider.destination``` to your destinations in the consumer subaccount.
or create a new destination with the following properties:
- URL=https://<host_name>.cfapps.sap.hana.ondemand.com/mock_provider/backend/sap/bc/ui2/cdm3/entities
- Name: mock-provider
- ProxyType: Internet
- Type: HTTP
- Authentication: No Authentication

## Tasks
Besides the configurable cdm content mock creation, the application exposes tasks that can be executed through REST API.


### (1) Roles to site assigner task
Assigns roles to site task.


```js
POST /mock_provider/tasks/ASSIGN_ROLES_TO_SITE
```

#### Payload
```json
{
    "siteId": "<siteId - the site Id to assign the roles to.>",
    "roles": {
        "number": "<exact numbers of roles that need to be assigned to the site.>"
    },
  "instanceId": "<Portal/Launchpad/WorkZone Instance ID depends on which product you're subscribed to.>",
  "tenantId": "<The consumer Zone ID>"
}
```

----------------------------------------------------------------------------------------------------------------

### (2) Populate generated cdm content to the local content task
Populates the content to the local content in the SUB_ACCOUNT using BATCH requests to the cdm-store-service

```js
POST /mock_provider/tasks/POPULATE_LOCAL_CONTENT
```

#### Payload
```json
{
  "instanceId": "<Portal/Launchpad/WorkZone Instance ID depends on which product you're subscribed to.>",
  "tenantId": "<The consumer Zone ID>",
  "batchSize": "<the batch size when calling the cdm-store-service - default is 50>"
}
```

----------------------------------------------------------------------------------------------------------------

### Get All Tasks
```js
GET /mock_provider/tasks
```

### Get Task status by Uuid
```js
GET /mock_provider/tasks/:uuid
```


## App Environment Variables
Some taks requires environment variables, it is recommended to always provide these variables if you want to run any of
the tasks that the application exposes.
```js
DISABLE_CREATE_CONTENT: false // used to disable mock content creatin upon application deployment.
PORTAL_SERVICE_URL: 'https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com' // taken from the general configuration ups.
```

                1.19.17.1.2 Tasks CLI

                    1.19.17.1.2.1 Example postman
POST: https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/mock_provider/tasks/POPULATE_LOCAL_CONTENT
{"batchSize": 50,"instanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2","tenantId": "9fc76aae-fa55-4657-b360-41659cf6521e"}
Note. tenantId is Obtained from Consumer-Subaccount cockpit Overview page 'Tenant Id' property
Note to obtain instanceId, cf login to provider space and read from VCAP.
e.g.
[I500695@C02ZR8BSMD6N:2022-01-04 16:02:33:/Users/i500695/git/cdm-mock-provider:]2275$  cf env portal-cf-transport-service | grep InstanceI
        "clpInstanceId": "2891f649-d3b5-49fb-bf78-f114b8673107",
        "launchpadInstanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2",
        "portalInstanceId": "2891f649-d3b5-49fb-bf78-f114b8673107",
        "workzoneInstanceId": "2d4e6502-4f94-4e4a-8337-bb9d76f09480"

POST: https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/mock_provider/tasks/ASSIGN_ROLES_TO_SITE
{"siteId": "dd7ee9d5-f55f-4a41-9579-5b5bed7f6732","roles": {"number": "500"},"instanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2","tenantId": "9fc76aae-fa55-4657-b360-41659cf6521e"}


                    1.19.17.1.2.2 The python raw requests
- POPULATE_LOCAL_CONTENT 
import requests
import json

url = "https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/mock_provider/tasks/POPULATE_LOCAL_CONTENT"

payload = json.dumps({
  "batchSize": 50,
  "instanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2",
  "tenantId": "9fc76aae-fa55-4657-b360-41659cf6521e"
})
headers = {
  'Content-Type': 'application/json'
}

response = requests.request("POST", url, headers=headers, data=payload)

print(response.text)


- ASSIGN_ROLES_TO_SITE (todo, add)
import requests
import json

url = "https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/mock_provider/tasks/ASSIGN_ROLES_TO_SITE"

payload = json.dumps({
  "siteId": "dd7ee9d5-f55f-4a41-9579-5b5bed7f6732",
  "roles": {
    "number": "500"
  },
  "instanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2",
  "tenantId": "9fc76aae-fa55-4657-b360-41659cf6521e"
})
headers = {
  'Content-Type': 'application/json'
}

response = requests.request("POST", url, headers=headers, data=payload)

print(response.text)

- 

                    1.19.17.1.2.3 The CLI skeleton
three env vars. 
INSTANCE_ID, TENANT_ID, BASE_URL (https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/)

local git:
[I500695@C02ZR8BSMD6N:2022-01-04 19:16:49:/Users/i500695/git/cdm-mock-provider/tasks_cli:]2287$ gits
On branch tasks_cli
Changes to be committed:
  (use "git restore --staged <file>..." to unstage)
	new file:   README.md

- need high level parser (for tasks) and subparser per task. see: https://stackoverflow.com/questions/17909294/python-argparse-mutual-exclusive-group

export INSTANCE_ID=02241b30-8d09-41c2-8207-d3303a6d26a2 && export TENANT_ID=9fc76aae-fa55-4657-b360-41659cf6521e && export BASE_URL=https://portal-service-launchpadi324180p.cfapps.sap.hana.ondemand.com/

                    1.19.17.1.2.4
                1.19.17.1.3
            1.19.17.2


        1.19.18
    1.20 2020

        1.20.1   T01

            1.20.1.1   [Eng.] Better and readable errors regarding schema issues 
Goal: Improve our errors on CDM Schema issues
Scope:
Change the schema validation library we are using in CDM store
This is in order to provide better and more readable errors regarding schema issues and also the alternatives seems to be faster.

JIRA: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1339
wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Improve+CDM+Schema+validation+error+report

https://json-schema.org/implementations.html#validator-java
JSON SchemaJSON Schema
Implementations
The home of JSON Schema


                1.20.1.1.1   Performance test 

                    1.20.1.1.1.1   Internal code


                        1.20.1.1.1.1.1   Our branch
                        https://github.wdf.sap.corp/i500695/JsonSchemaValidatorPerfTest

                        1.20.1.1.1.1.2 TCP json validation server
[i500695@C02X632CJGH6:2020-02-05 18:00:56:~/work/SAP/git/cdm-schema:]2025$ gitb
* JsonValidationTCPServer

	new file:   bin/validation-service.js
    $ cat bin/validation-service.js
#!/usr/bin/env node

const Logger = require('../src/utils/logger');
Logger.setSeverity(Logger.Severity.info);
const logger = Logger("cmd/cli");
let cli = require('commander');
const cdm = require('../src/index');
const migrate = require('../src/cmd/migrate');
const ioUtils = require('../src/utils/io-utils');
const net = require('net');

Array.prototype.forEachAsync = async function (fn) {
    for (let t of this) { await fn(t) }
}

let validateJson = async (args, files) => {
    try {
        //if (args.schema) {
        //    args.schema = await ioUtils.readSchema(args.schema);
        //}
        if (!args.schema) {
            cdm.setDefaultSchema();
            args.schema = cdm.schema;
        }
        //console.log('schema ', args.schema);
        //console.log('json ', files);

        //// code for parsing array of objects
        //const objArray = JSON.parse(files);
        //objArray.forEachAsync( async  (elem, idx, arr) => {
        //    let results = await cdm.validate(JSON.parse(elem), args.schema, args.namespace);
        //    logger.log("\nCDM validation results:" + getFormattedResults(results).join("\n") + "\n");
        //});

        //let results = await cdm.validate(files, args.schema, args.namespace);

        let results = '';
        files = JSON.parse(files);
        //ToDo, prep all validate promisses in an array and run promisAll...
        // This should dramatically improve perf
        if (files.value && Array.isArray(files.value) ) {
            const results_lst = await files.value.reduce( async (prevProm , file) => {
                const results_lst = await prevProm;
                results = await cdm.validate(file, args.schema, args.namespace);
                results = getFormattedResults(results).join("\n");
                if (results) {
                   results = file.identification.entityType+ ', '+ file.identification.id + ', '+ results;
                    results_lst.push(results);
                }
                return results_lst;
            }, Promise.resolve([]));

            //let results_lst = [];
            //for (let i = 0; i < files.value.size; i++) {
            //    const result = await cdm.validate(files.value[i], args.schema, args.namespace);
            //    results_lst.

            //}
            return results_lst;
        }
        else {
            results = await cdm.validate(files, args.schema, args.namespace);
            return getFormattedResults(results).join("\n");
        }
      //logger.log("\nCDM validation results:" + getFormattedResults(results).join("\n") + "\n");
  } catch(e) {
      logger.error("error during validation");
        throw e;
    }
};

cli.version('3.1.0', '-v, --version');

cli.command(('server'))
    .description('loads a TCP validation server.')
    .action( async  function (args) {
        const  server = net.createServer();

        server.on('close',function(){
            console.log('Validation Server closed');
        });
        server.on('connection',function(socket){

            //ToDo, remove logs
            console.log('Buffer size : ' + socket.bufferSize);
            console.log('---------server details -----------------');
            const address = server.address();
            const port = address.port;
            const family = address.family;
            const ipaddr = address.address;
            console.log('Server is listening at port' + port);
            console.log('Server ip :' + ipaddr);
            console.log('Server is IP4/IP6 : ' + family);
            const lport = socket.localPort;
            const laddr = socket.localAddress;
            console.log('Server is listening at LOCAL port' + lport);
            console.log('Server LOCAL ip :' + laddr);

            console.log('------------remote client info --------------');
            const rport = socket.remotePort;
            const raddr = socket.remoteAddress;
            const rfamily = socket.remoteFamily;
            console.log('REMOTE Socket is listening at port' + rport);
            console.log('REMOTE Socket ip :' + raddr);
            console.log('REMOTE Socket is IP4/IP6 : ' + rfamily);

            console.log('--------------------------------------------')
            server.getConnections(function(error,count){
                console.log('Number of concurrent connections to the server : ' + count);
            });

            socket.setEncoding('utf8');

            socket.setTimeout(800000,function(){
                console.log('Socket timed out');
            });


            socket.on('data',function(data){
                let bread = socket.bytesRead;
                let bwrite = socket.bytesWritten;
                this.totalLen = this.totalLen || bread;

                console.log('Bytes read : ' + bread);
                console.log('Bytes written : ' + bwrite);
                console.log('Data sent to server : ' + data);

                //This works for small entities. large ones are partitioned to chunks so either client sends length
                // or special end token. ToDo, implement that...

                ////work w/ binary (process chunks)
                //if ( ! this.length) {//expect 32bit len as first 4 bytes
                //    headerBuf = Buffer.from(data.slice(0,4));
                //    this.length = headerBuf.readUInt32BE(0, 4);
                //    this._data = data.slice(4, bread).toString();
                //}
                //else {
                //    if (this.totalLen + bread < this.length) {
                //       console.log(`read ${this.totalLen + bread } of ${this.length} bytes`)
                //        this._data += data.toString();
                //    }
                //    else if(this.totalLen + bread >= this.length)  {
                //        console.log(`last chunk. read ${this.totalLen + bread } of ${this.length} bytes`)
                //        validateJson(args, data).then( res => {
                //            //console.log('finished validation. res: ', res)
                //            //echo data
                //            var is_kernel_buffer_full = socket.write('Validation ::' + res);
                //            if(is_kernel_buffer_full){
                //                //console.log('Data was flushed successfully from kernel buffer i.e written successfully!');
                //            }else{
                //                socket.pause();
                //            }
                //        }) ;

                //    }

                //}

                //use '\n' as end of message signal
                this._data = this._data ? this._data : '';
                this._data += data.toString();
                let full = this._data.split('\n\n\n');
                if (full.length > 1) { validateJson(args, full[0]).then( res => {
                        //console.log('finished validation. res: ', res)
                         //echo data
                        let is_kernel_buffer_full;
                        if (Array.isArray(res)){
                            is_kernel_buffer_full = socket.write(res.join("\n"));
                        }
                        else {
                            is_kernel_buffer_full = socket.write(res);
                        }
                         if(is_kernel_buffer_full){
                             //console.log('Data was flushed successfully from kernel buffer i.e written successfully!');
                         }else{
                             socket.pause();
                         }
                    }) ;

                }//found /n


                ////Work w/ no chunks
                //this._data += data.toString();
                //console.log('data so far ', this._data);

               //validateJson(args, data).then( res => {
               //    //console.log('finished validation. res: ', res)
               //     //echo data
               //     var is_kernel_buffer_full = socket.write('Validation ::' + res);
               //     if(is_kernel_buffer_full){
               //         //console.log('Data was flushed successfully from kernel buffer i.e written successfully!');
               //     }else{
               //         socket.pause();
               //     }
               //}) ;

               // //echo data
               // var is_kernel_buffer_full = socket.write('Data ::' + data);
               // if(is_kernel_buffer_full){
               //     console.log('Data was flushed successfully from kernel buffer i.e written successfully!');
               // }else{
               //     socket.pause();
               // }

            });

            socket.on('drain',function(){
                console.log('write buffer is empty now .. u can resume the writable stream');
                socket.resume();
            });

            socket.on('error',function(error){
                console.log('Error : ' + error);
            });

            socket.on('timeout',function(){
                console.log('Socket timed out !');
                socket.end('Timed out!');
                // can call socket.destroy() here too.
            });

            socket.on('end',function(data){
                console.log('Socket ended from other end!');
                console.log('End data : ' + data);
            });

            socket.on('close',function(error){
                var bread = socket.bytesRead;
                var bwrite = socket.bytesWritten;
                console.log('Bytes read : ' + bread);
                console.log('Bytes written : ' + bwrite);
                console.log('Socket closed!');
                if(error){
                    console.log('Socket was closed coz of transmission error');
                }
            });

            setTimeout(function(){
                var isdestroyed = socket.destroyed;
                console.log('Socket destroyed:' + isdestroyed);
                socket.destroy();
            },1200000);

        });

        server.on('error',function(error){
            console.log('Error: ' + error);
        });

        server.on('listening',function(){
            console.log('Server is listening!');
        });

        server.maxConnections = 10;

        server.listen(2222);

        if(server.listening){
            console.log('Server is listening');
        }else{
            console.log('Server is not listening');
        }

    });

cli.command('validate [files...]')
    .description('validate json files with JSON Schema of CDM. it will recognize the entity type according to the given content')
    .option('-r, --root [root]', 'Configuring root folder of files (not applied on schema)')
    .option('-s, --schema [schema]', 'The schema to validate with')
    .option('-n, --namespace [namespace]', 'The namespace path (in json schema) to the entities container')
    // .option('-v, --version [version]', 'The cdm version to run validate')
    .action(async function (files, args) {
        args = args || {}; // args.config and args.version holds the provided parameters
        if (!files || files.length === 0) {
            return logger.error("Please provide files to validate");
        }
        files = await ioUtils.getJsonsFromFiles(files, args);
        try {
            if (args.schema) {
                args.schema = await ioUtils.readSchema(args.schema);
            }
            if (!args.schema) {
                cdm.setDefaultSchema();
                args.schema = cdm.schema;
            }
            console.log('schema ', args.schema);
            console.log('json ', files);

            let results = await cdm.validate(files, args.schema, args.namespace);
            logger.log("\nCDM validation results:" +
                getFormattedResults(results).join("\n") +
                "\n");
        } catch(e) {
            logger.error("error during validation");
            throw e;
        }
    });

cli.command('migrate [files...]') .description('migrate CDM json files.')
    .option('-d, --dir [dir]', 'A folder of files to migrate')
    .option('-v, --version [version]', 'The cdm version to run validate')
    .action(async function (files, {dir, version}) {
        if ((!files || files.length === 0) && !dir) {
            logger.log('no dir or files were provided.. migrating default location (designtime examples)')
        }
        try {
            let results = await migrate({files, dir});
            logger.log(`${results.length} files were migrated`);
        } catch(e) {
            logger.error("error during migration:", e);
            throw e;
        }
    });

// invoking the process
cli.parse(process.argv);


// Private helper functions

function getFormattedResults(results) {
    return results
        .map((result) => {
            if (!result.valid) {
                let errCount = 0;
                return "\t" + result.errors.map((error) => "(" + (++errCount) + ") " + JSON.stringify(error)).join("\n\t");
            }
            return "valid";
        }).map((resultRow, i) => {
            return "#" + (i + 1) + " " + resultRow;
        });
}

                        1.20.1.1.1.1.3 TCP json validation client
[i500695@C02X632CJGH6:2020-02-05 18:09:59:~/work/code/nodejs/net:]2032$ cat client1.js 
const net = require('net')
const fs = require('fs')

const filename='exposure_report';
//const filename='businessapp.0212427E3EAE45D2A7648092A2F2FE88.json';

const filedata=fs.readFileSync(filename);
//NOTE:--> all the events of the socket are applicable here..in client...


// -----------------creating client using net.connect instead of custom socket-------

// server creation using net.connect --->
// u can also => write the below code in seperate js file
// open new node instance => and run it...


const clients = net.connect({port: 2222}, () => {

    // 'connect' listener
    console.log('connected to server!');
    //clients.write('world!\r\n');

    ////send non binary
    clients.write(filedata+'\n\n\n');

    //send non binary 
    msg_len = Buffer.byteLength(filedata+3);
    
    ////send binary
    ////send_buf = Buffer.from(filedata, "utf-8");
    //send_buf = new Buffer( 4 + msg_len);
    //send_buf.writeUInt32BE(msg_len, 0);
    //send_buf.write(filedata+'\n\n\n', 4); 
    //console.log('sending data to server!');
    //clients.write(send_buf);
    
    console.log('data sent to server!');
});

//on data read from server
clients.on('data', (data) => {
  console.log('got data: %s\n', data.toString());
  

  //clients.write(filedata);
  clients.end();
});

//on tcp fin
clients.on('end', () => {
  console.log('disconnected from server');
});
                        1.20.1.1.1.1.4
                    1.20.1.1.1.2 external code

original https://github.com/networknt/json-schema-validator-perftest
git clone https://github.com/erosb/json-schema-perftest.git
cd json-schema-validator-perftest/
mvn clean install -Pdist

fails due to old java
change pom.xml, add plugin to plugins:

    cat pom.xml
    <?xml version="1.0" encoding="UTF-8"?>
<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://maven.apache.org/POM/4.0.0"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <groupId>perftest</groupId>
    <artifactId>perftest</artifactId>
    <version>0.1.0</version>

    <packaging>jar</packaging>

    <properties>
    <maven.compiler.source>1.9</maven.compiler.source>
    <maven.compiler.target>1.9</maven.compiler.target>
        <java.version>1.8</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <version.json-schema-validator>0.1.12</version.json-schema-validator>
        <version.everit>1.5.1</version.everit>
        <argLine>-Xmx512m -XX:MaxPermSize=256m</argLine>
    </properties>


    <dependencies>
        <dependency>
            <groupId>org.everit.json</groupId>
            <artifactId>org.everit.json.schema</artifactId>
            <version>${version.everit}</version>
        </dependency>
        <dependency>
            <groupId>com.networknt</groupId>
            <artifactId>json-schema-validator</artifactId>
            <version>${version.json-schema-validator}</version>
        </dependency>
        <dependency>
            <groupId>com.github.java-json-tools</groupId>
            <artifactId>json-schema-validator</artifactId>
            <version>2.2.8</version>
        </dependency>
    </dependencies>


    <profiles>
        <profile>
            <id>dist</id>
            <activation>
                <activeByDefault>false</activeByDefault>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-assembly-plugin</artifactId>
                        <configuration>
            <source>1.9</source>
            <target>1.9</target>

                            <descriptorRefs>
                                <descriptorRef>jar-with-dependencies</descriptorRef>
                            </descriptorRefs>
                            <finalName>perftest</finalName>
                            <appendAssemblyId>false</appendAssemblyId>
                            <archive>
                                <manifest>
                                    <mainClass>com.networknt.schema.perftest.Runner</mainClass>
                                </manifest>
                            </archive>
                        </configuration>
                        <executions>
                            <execution>
                                <id>dist</id>
                                <phase>package</phase>
                                <goals>
                                    <goal>single</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>

</project>

[i500695@C02X632CJGH6:2020-01-20 11:30:32:~/work/SAP/gitexternal/json-schema-validator-perftest:]2135$ java -cp target/perftest-0.1.0.jar com.networknt.schema.perftest.Runner

results using file perftest.json (2k size) and schema schema-draft4.json (150
lines) 500 iterations:

fge: 4397 ms
networknt: 322 ms

everit explodes on loading schema-draft4 and schema-draft7. It faild to handle
refs

networknt explodes on schema-draft7

CDM schema tests, using qky exposure:
a. everit
14 ms

b. fge
explodes, ~/work/SAP/gitexternal/json-schema-validator-perftest/fge_cdm_schema_qky.log

c. networknt
explodes. only support schema 4.
see:
/Library/Java/JavaVirtualMachines/jdk-10.0.2.jdk/Contents/Home/bin/java "-javaagent:/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar=60701:/Applications/IntelliJ IDEA.app/Contents/bin" -Dfile.encoding=UTF-8 -classpath /Users/i500695/work/SAP/gitexternal/json-schema-validator-perftest/target/classes:/Users/i500695/.m2/repository/org/everit/json/org.everit.json.schema/1.5.1/org.everit.json.schema-1.5.1.jar:/Users/i500695/.m2/repository/org/json/json/20160810/json-20160810.jar:/Users/i500695/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/Users/i500695/.m2/repository/commons-validator/commons-validator/1.5.1/commons-validator-1.5.1.jar:/Users/i500695/.m2/repository/commons-beanutils/commons-beanutils/1.9.2/commons-beanutils-1.9.2.jar:/Users/i500695/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/Users/i500695/.m2/repository/commons-logging/commons-logging/1.2/commons-logging-1.2.jar:/Users/i500695/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/Users/i500695/.m2/repository/com/networknt/json-schema-validator/0.1.12/json-schema-validator-0.1.12.jar:/Users/i500695/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.8.7/jackson-databind-2.8.7.jar:/Users/i500695/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.8.0/jackson-annotations-2.8.0.jar:/Users/i500695/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.8.7/jackson-core-2.8.7.jar:/Users/i500695/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar:/Users/i500695/.m2/repository/org/slf4j/slf4j-ext/1.7.25/slf4j-ext-1.7.25.jar:/Users/i500695/.m2/repository/org/apache/commons/commons-lang3/3.5/commons-lang3-3.5.jar:/Users/i500695/.m2/repository/com/github/java-json-tools/json-schema-validator/2.2.8/json-schema-validator-2.2.8.jar:/Users/i500695/.m2/repository/com/github/java-json-tools/json-schema-core/1.2.8/json-schema-core-1.2.8.jar:/Users/i500695/.m2/repository/org/mozilla/rhino/1.7R4/rhino-1.7R4.jar:/Users/i500695/.m2/repository/com/github/fge/jackson-coreutils/1.8/jackson-coreutils-1.8.jar:/Users/i500695/.m2/repository/com/github/fge/msg-simple/1.1/msg-simple-1.1.jar:/Users/i500695/.m2/repository/com/github/fge/btf/1.2/btf-1.2.jar:/Users/i500695/.m2/repository/com/github/fge/uri-template/0.9/uri-template-0.9.jar:/Users/i500695/.m2/repository/javax/mail/mailapi/1.4.3/mailapi-1.4.3.jar:/Users/i500695/.m2/repository/javax/activation/activation/1.1/activation-1.1.jar:/Users/i500695/.m2/repository/joda-time/joda-time/2.9.7/joda-time-2.9.7.jar:/Users/i500695/.m2/repository/com/googlecode/libphonenumber/libphonenumber/8.0.0/libphonenumber-8.0.0.jar:/Users/i500695/.m2/repository/com/google/code/findbugs/jsr305/3.0.1/jsr305-3.0.1.jar:/Users/i500695/.m2/repository/net/sf/jopt-simple/jopt-simple/5.0.3/jopt-simple-5.0.3.jar:/Users/i500695/.m2/repository/org/jetbrains/annotations/16.0.2/annotations-16.0.2.jar com.networknt.schema.perftest.NetworkntPerf
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Exception in thread "main" java.lang.ExceptionInInitializerError
	at com.networknt.schema.perftest.NetworkntPerf.<clinit>(NetworkntPerf.java:28)
Caused by: com.networknt.schema.JsonSchemaException: Unknown Metaschema: http://json-schema.org/draft-07/schema#
	at com.networknt.schema.JsonSchemaFactory.findMetaSchemaForSchema(JsonSchemaFactory.java:157)
	at com.networknt.schema.JsonSchemaFactory.createValidationContext(JsonSchemaFactory.java:148)
	at com.networknt.schema.JsonSchemaFactory.newJsonSchema(JsonSchemaFactory.java:143)
	at com.networknt.schema.JsonSchemaFactory.getSchema(JsonSchemaFactory.java:175)
	at com.networknt.schema.perftest.NetworkntPerf.<clinit>(NetworkntPerf.java:25)




                1.20.1.1.2 readability

        1.20.2 [Export_Import] Export of cFLP site with content-Server side - Design + Implementation 

        Motivation
We must give our customers an ability to export and import them content and allow them LCM (Dev-Test-Prod). Today our customer can not be productive without this basic transport capability
The first phase is to provide the customers ability to export/Import site + content from sub account to sub account.
Second phase will be the give ability to export and import content with different granularity via content manager.

User Story
As an Admin I would like to be able to export site with content from one sub account and import it to another sub account (regardless of the data center) to allow me Life Cycle Management systems Dev-Test-Prod

General \ Technical Information
This is design & implementation for server side of Export only, import in different BLI <https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1347>
Export of full site + Content (zip creation)
UX - Sync Export/Import - the UI is blocked till the export is done- Basic export window pop-up with in progress indication "..." (DT notification service integration) - in the future integration with notification and then add progress bar instead of progress indication like dots or others.
Export of full site and content:
Content - all CDM entities (with translations)
Keep relations
URL templates
Site settings
active languages
Cherry picked content should be exported, only cherry picked. and not merged (original entity).
UX file://iltlvg101.tlv.global.corp.sap/DEV_P_EP/Projects/ODP/UX%20and%20Visuals/2019T13/(Lev)%20Transport/Transport%20v4_Basic%20UX_Site%20&%20Content%20Export%20&%20Import.pdf
Performance relevance - as the UI is blocked once he does export or import
Take into account that in next phase we plan to give ability export based on content granularity (ability to select entities from content manager and add them to content export "package")
Export/Import for portal service only, no need to alter relations
Client (UX) is in a different BLI

Acceptance Criteria
Design server side
Implementation server side
Api should return a zip file of the exported site with all site content:
Content - all CDM entities with translations
Keep relations
URL templates ?
Site settings ?
active languages ?
Cherry picked content should be exported, only cherry picked. and not merged (original entity).
Performance measurements - time for export

            1.20.2.1 Links
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1346

design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Export+Site+API

            1.20.2.2 Design

                1.20.2.2.1 synchronous service
sequence diagrams:
participant "Semantic Service" as Sem
participant "Transport Service" as Transp
participant "CDM Store" as Store
Semantic -> Transp : POST /transports/export/start/ {export payload}
note left of Transp
{export payload} structure:
{
"siteId": "mysite",
"entityTypes": ["businessapp"],
"chunkSize": 500 
}
end note
Transp -> Store : POST /cdm/entities/search search for site entities
Store -> Transp: 200, {site entities}
activate Transp
note right of Transp
deactivate Transp

with default group
and catalog
end note
#Store->Store: Create the site with the default-group and default-catalog
Store->Semantic: Create OK
deactivate Store
Semantic->Client: Create OK



state machine= <URL:#r=export_site_content_state_machine>

                1.20.2.2.1 asynchronous service


sequence diagrams:

state machine= <URL:#r=export_site_content_state_machine>

            1.20.2.3 Tests
                1.20.2.3.1 synchronous service

                1.20.2.3.1 asynchronous service

            1.20.2.4 Tasks
                1.20.2.4.1 synchronous service

                1.20.2.4.1 asynchronous service

            1.20.2.5 pull requests

                1.20.2.5.1 export job integration #3 

https://github.wdf.sap.corp/raw/Portal-CF/portal-cf-transport-service/pull/131.patch
From 914dd53a0173aea1706718147589066910a04113 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 23 Feb 2020 18:38:26 +0200
Subject: [PATCH 1/3] export job integration #3"

---
 src/constants/export.constants.ts         |  3 +
 src/export/dto/export-job-info.dto.ts     |  1 +
 src/export/dto/manifest-generation-dto.ts |  9 +++
 src/export/export.controller.ts           | 10 ++-
 src/export/export.job.ts                  | 74 +++++++++++++++++------
 src/export/export.manifest.ts             |  9 +++
 src/interfaces/export.job.interface.ts    |  4 +-
 src/interfaces/start.export.job.info.ts   |  6 ++
 8 files changed, 94 insertions(+), 22 deletions(-)
 create mode 100644 src/export/dto/manifest-generation-dto.ts
 create mode 100644 src/export/export.manifest.ts
 create mode 100644 src/interfaces/start.export.job.info.ts

diff --git a/src/constants/export.constants.ts b/src/constants/export.constants.ts
index 354df61..4e97a41 100644
--- a/src/constants/export.constants.ts
+++ b/src/constants/export.constants.ts
@@ -1,5 +1,8 @@
 export class ExportConstants {
     public static readonly sortTypePath: string[] = ['identification','id'];
     public static readonly chunkSize: number = 1000;
+    public static readonly excludedContextTypes: string[] = ['SNAPSHOT'];
+    public static readonly chunkFileSuffix: string = '.zip';
+    public static readonly manifestFileName: string = 'export_data';
 }
 
diff --git a/src/export/dto/export-job-info.dto.ts b/src/export/dto/export-job-info.dto.ts
index f9bb73a..0680fe0 100644
--- a/src/export/dto/export-job-info.dto.ts
+++ b/src/export/dto/export-job-info.dto.ts
@@ -6,4 +6,5 @@ export class ExportJobInfoDto {
     entityTypes?: object[];
     entityIds?: string[];
     chunkSize?: number;
+    username: string;
 }
diff --git a/src/export/dto/manifest-generation-dto.ts b/src/export/dto/manifest-generation-dto.ts
new file mode 100644
index 0000000..0eecc30
--- /dev/null
+++ b/src/export/dto/manifest-generation-dto.ts
@@ -0,0 +1,9 @@
+import {ExportConstants} from '../../constants/export.constants';
+
+export class ManifestGenerationDto {
+   size: number;
+   chunkSize?: number = ExportConstants.chunkSize;
+   transportServiceVer?: string =  process.env.npm_package_version;
+   cdmStoreServiceVer?: string;
+   username: string;
+}
diff --git a/src/export/export.controller.ts b/src/export/export.controller.ts
index 310b5bb..8f19a54 100644
--- a/src/export/export.controller.ts
+++ b/src/export/export.controller.ts
@@ -38,14 +38,20 @@ export class ExportController {
         }
         const jobInfoDto: ExportJobInfoDto = ExportController.createJobInfoDto(exportPayloadDto, authInfo);
 
-        this.exportJob.start(jobInfoDto);
+        this.exportJob.start({startJobInfo: jobInfoDto, writeStream: res});
         res.status(200).send();
     }
 
     private static createJobInfoDto(exportPayload: ExportPayloadDto, authInfo: AuthInfo): ExportJobInfoDto {
         const tenantId: string = authInfo.getSubaccountId();
 
-        return  {tenantId: tenantId, siteId: exportPayload.siteId, entityIds: exportPayload.entityIds, entityTypes: exportPayload.entityTypes, chunkSize: exportPayload.chunkSize};
+        return  {tenantId: tenantId,
+            siteId: exportPayload.siteId,
+            entityIds: exportPayload.entityIds,
+            entityTypes: exportPayload.entityTypes,
+            chunkSize: exportPayload.chunkSize,
+            username: authInfo.getLogonName()
+        };
     }
 }
 
diff --git a/src/export/export.job.ts b/src/export/export.job.ts
index 5fda4f3..3669210 100644
--- a/src/export/export.job.ts
+++ b/src/export/export.job.ts
@@ -9,33 +9,63 @@ import {ExportConstants} from '../constants/export.constants';
 import {ExportError} from './errors/export.errror';
 import {IArchive} from '../archive/interfaces/archive.interface';
 import {IArchiveService} from '../archive/interfaces/archive.service.interface';
+import * as path from 'path';
+import {ManifestGenerationDto} from './dto/manifest-generation-dto';
+import {ExportManifest} from './export.manifest';
+import {ArchiveService} from '../archive/archive.service';
+import {StartExportJobInfo} from '../interfaces/start.export.job.info';
 
 @Injectable()
 export class ExportJob implements IExportJob {
     private logger: Logger;
 
     constructor(@Inject('ICdmClientService') private cdmClientService: ICdmClientService,
-                @Inject('IArchiveService') private archiveService: IArchiveService ,
+                @Inject('IArchiveService') private archiveService: IArchiveService,
                 @Inject('ILoggerFactory') loggerFactory: ILoggerFactory) {
         this.logger = loggerFactory.getLogger(ExportJob.name);
     }
 
-    async start(jobInfo: ExportJobInfoDto): Promise<any> {
+    async start(startExportJobInfo: StartExportJobInfo): Promise<any> {
+        const {jobInfo, writeStream} = startExportJobInfo;
         this.logger.debug(`${ExportJob.name}::${this.start.name}() Got export job info: `, JSON.stringify(jobInfo, null, 4));
 
-        const  {tenantId, siteId, entityTypes, entityIds, chunkSize } = jobInfo;
+        const {tenantId, siteId, entityTypes, entityIds, chunkSize, username} = jobInfo;
         try {
-            const siteContent: object[] = await this.cdmClientService.getSiteEntities(siteId, false);
+            let siteContent: any[] = await this.cdmClientService.getSiteEntities(siteId, false);
+            siteContent = siteContent.filter(elem => ExportConstants.excludedContextTypes.indexOf(elem.context.contextType));
 
-        const eca: EntityChunkAggregator  = new EntityChunkAggregator(ExportConstants.sortTypePath, ExportConstants.chunkSize );
-        for (const entity of siteContent) {
-            eca.addOne(entity);
-        }
-        const data: Map<string, Array<Array<object>>> = eca.getData();
+            const eca: EntityChunkAggregator = new EntityChunkAggregator(ExportConstants.sortTypePath, ExportConstants.chunkSize);
+            for (const entity of siteContent) {
+                eca.addOne(entity);
+            }
+            // use data map of type to chunk arrays to construct the final zip
+            const data: Map<string, Array<Array<object>>> = eca.getData();
+
+            const archive = new ArchiveService().createArchive(writeStream, {archiveType: 'zip', compressionLevel: 9});
+            let totalSize: number = 0;
 
-        // use data map of type to chunk arrays to construct the final zip
-        //     // ToDo, return zip file, when empty indicates problem, exceptions
-        //     // thrown up to HttpExceptionFilter global filter
+            for (const [k, v] of data) {
+                this.logger.debug(`${ExportJob.name}::${this.start.name}() add ${k} type chunks`);
+                let chunkCount = 0;
+                let chunkFileFolder =  path.join(path.sep + k);
+                for (const chunk of v) {
+                    chunkCount++;
+                    totalSize += chunk.length;
+                    const chunkFilename = path.join(chunkFileFolder, path.sep + k + chunkCount.toString() + ExportConstants.chunkFileSuffix);
+                    this.logger.debug(`${ExportJob.name}::${this.start.name}() adding chunk ${chunkFilename}`);
+                    archive.append(chunk, chunkFilename);
+                }
+            }
+
+            // Add manifest file to archive: ExportConstants.manifestFileName
+            archive.append(ExportJob.genMetadataFile({
+                size: totalSize,
+                chunkSize: ExportConstants.chunkSize,
+                transportServiceVer: process.env.npm_package_version,
+                username: username,
+            }), ExportConstants.manifestFileName);
+            archive.finalize();
+            archive.close();
         } catch (e) {
             this.logger.error(`${ExportJob.name}::${this.start.name}() encountered error: `, e.message);
             throw new ExportError(e);
@@ -43,12 +73,18 @@ export class ExportJob implements IExportJob {
         return;
     }
 
-    // private packContent(data: Map<string, Array<Array<object>>>): Promise<IArchiveFile> {
-    //     const retArchive: IArchiveFile = this.archiveService.createArchive();
-    //     // create folders and zip files and add to retArchive
-    //     data.forEach( (k,v) => {
+    private static genMetadataFile(manifestGenDto: ManifestGenerationDto): ExportManifest {
+        const {size, chunkSize, transportServiceVer, cdmStoreServiceVer, username} = manifestGenDto;
+        const exportTime: string = new Date().toString();
+        const transportServiceVersion = transportServiceVer ?? process.env.npm_package_version;
+        return {
+            'time': exportTime,
+            'size': size,
+            'chunkSize': chunkSize,
+            'transportServiceVersion': transportServiceVersion,
+            // 'cdmStoreServiceVersion': 'ToDo, support in the future',
+            'username': username
+        };
+    }
 
-    //     });
-    //     return retArchive;
-    // }
 }
diff --git a/src/export/export.manifest.ts b/src/export/export.manifest.ts
new file mode 100644
index 0000000..6f95446
--- /dev/null
+++ b/src/export/export.manifest.ts
@@ -0,0 +1,9 @@
+export interface ExportManifest {
+   time: string;
+   size: number;
+   chunkSize: number;
+   transportServiceVersion?: string;
+   cdmStoreServiceVersion?: string;
+   username: string;
+}
+    
diff --git a/src/interfaces/export.job.interface.ts b/src/interfaces/export.job.interface.ts
index e61e00b..d62a774 100644
--- a/src/interfaces/export.job.interface.ts
+++ b/src/interfaces/export.job.interface.ts
@@ -1,5 +1,7 @@
 import {IJob} from './job.interface';
+import {ExportJobInfoDto} from '../export/dto/export-job-info.dto';
+import {StartExportJobInfo} from './start.export.job.info';
 
 export interface IExportJob extends IJob{
-
+    start(starExportJobInfo: StartExportJobInfo): Promise<any> ;
 }
diff --git a/src/interfaces/start.export.job.info.ts b/src/interfaces/start.export.job.info.ts
new file mode 100644
index 0000000..73fdcd5
--- /dev/null
+++ b/src/interfaces/start.export.job.info.ts
@@ -0,0 +1,6 @@
+import {ExportJobInfoDto} from '../export/dto/export-job-info.dto';
+
+export interface StartExportJobInfo {
+    jobInfo: ExportJobInfoDto,
+    writeStream: any
+}

From 0a6a78632aea1872e5a47f5be3c047b3d5a881e6 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 23 Feb 2020 19:23:34 +0200
Subject: [PATCH 2/3] export job integration #3"

---
 src/interfaces/start.export.job.info.ts | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/interfaces/start.export.job.info.ts b/src/interfaces/start.export.job.info.ts
index 73fdcd5..37ec049 100644
--- a/src/interfaces/start.export.job.info.ts
+++ b/src/interfaces/start.export.job.info.ts
@@ -1,6 +1,7 @@
 import {ExportJobInfoDto} from '../export/dto/export-job-info.dto';
+import * as fs from 'fs';
 
 export interface StartExportJobInfo {
     jobInfo: ExportJobInfoDto,
-    writeStream: any
+    writeStream: fs.WriteStream
 }

From d37f23c92eadb0a041f7c1a06b88cfa0715def84 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 24 Feb 2020 11:20:00 +0200
Subject: [PATCH 3/3] export job integration #3"

---
 src/constants/export.constants.ts |  4 +++-
 src/export/export.controller.ts   |  2 ++
 src/export/export.job.ts          | 10 +++++-----
 3 files changed, 10 insertions(+), 6 deletions(-)

diff --git a/src/constants/export.constants.ts b/src/constants/export.constants.ts
index 4e97a41..33c948b 100644
--- a/src/constants/export.constants.ts
+++ b/src/constants/export.constants.ts
@@ -2,7 +2,9 @@ export class ExportConstants {
     public static readonly sortTypePath: string[] = ['identification','id'];
     public static readonly chunkSize: number = 1000;
     public static readonly excludedContextTypes: string[] = ['SNAPSHOT'];
-    public static readonly chunkFileSuffix: string = '.zip';
+    public static readonly zipFileSuffix: string = '.zip';
     public static readonly manifestFileName: string = 'export_data';
+    public static readonly exportFileNamePrefix: string = 'site_';
+    public static readonly exportFileNameSuffix: string = 'export.zip';
 }
 
diff --git a/src/export/export.controller.ts b/src/export/export.controller.ts
index 8f19a54..330b037 100644
--- a/src/export/export.controller.ts
+++ b/src/export/export.controller.ts
@@ -7,6 +7,7 @@ import {ExportPayloadDtoValidationPipe} from '../pipes/export-payload-dto-valida
 import {LoggerFactory} from '../utils/logger-factory';
 import {AuthInfo} from '@sap/xssec';
 import {ExportJobInfoDto} from './dto/export-job-info.dto';
+import {ExportConstants} from '../constants/export.constants';
 
 @Controller('/exports')
 export class ExportController {
@@ -38,6 +39,7 @@ export class ExportController {
         }
         const jobInfoDto: ExportJobInfoDto = ExportController.createJobInfoDto(exportPayloadDto, authInfo);
 
+        // res.attach( ExportConstants.exportFileNamePrefix+ exportPayloadDto.siteId + ExportConstants.exportFileNameSuffix);
         this.exportJob.start({startJobInfo: jobInfoDto, writeStream: res});
         res.status(200).send();
     }
diff --git a/src/export/export.job.ts b/src/export/export.job.ts
index 3669210..43419e6 100644
--- a/src/export/export.job.ts
+++ b/src/export/export.job.ts
@@ -44,14 +44,14 @@ export class ExportJob implements IExportJob {
             const archive = new ArchiveService().createArchive(writeStream, {archiveType: 'zip', compressionLevel: 9});
             let totalSize: number = 0;
 
-            for (const [k, v] of data) {
-                this.logger.debug(`${ExportJob.name}::${this.start.name}() add ${k} type chunks`);
+            for (const [key, value] of data) {
+                this.logger.debug(`${ExportJob.name}::${this.start.name}() add ${key} type chunks`);
                 let chunkCount = 0;
-                let chunkFileFolder =  path.join(path.sep + k);
-                for (const chunk of v) {
+                let chunkFileFolder =  path.join(path.sep + key);
+                for (const chunk of value) {
                     chunkCount++;
                     totalSize += chunk.length;
-                    const chunkFilename = path.join(chunkFileFolder, path.sep + k + chunkCount.toString() + ExportConstants.chunkFileSuffix);
+                    const chunkFilename = path.join(chunkFileFolder, path.sep + key + chunkCount.toString() + ExportConstants.zipFileSuffix);
                     this.logger.debug(`${ExportJob.name}::${this.start.name}() adding chunk ${chunkFilename}`);
                     archive.append(chunk, chunkFilename);
                 }

                1.20.2.5.2
            1.20.2.6 E2E tests
postman
post: https://portal-service-yosib3-i500695.cfapps.sap.hana.ondemand.com/transport_service/exports/start
body: {
"siteId": "mysite",
"entityTypes": ["businessapp"],
"chunkSize": 500 
}

token, oath2.0 access token, get from getMyToken()

python requst code:
import requests

url = "https://portal-service-yosib3-i500695.cfapps.sap.hana.ondemand.com/transport_service/exports/start"

payload = "{\n\"siteId\": \"mysite\",\n\"entityTypes\": [\"businessapp\"],\n\"chunkSize\": 500 \n}"
headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer <my token>'
}

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))

            1.20.2.7 chunk aggregator tree
cd ~/work/code/graphviz/sap
 dot -T png -O export_entityChunkAggregatorTree.gv && open export_entityChunkAggregatorTree.gv.png  

[i500695@C02X632CJGH6:2020-02-26 18:37:50:~/work/code/graphviz/sap:]2009$ cat export_entityChunkAggregatorTree.gv 
digraph entityAggregatorTree {
    rankdir=TB;
    size="800,500"


    node [color=goldenrod2, style=filled, shape = circle];
    root  -> site [ label = "context type layer" ];
    root  -> SUBACCOUNT [ label = "context type layer" ];
    site -> site1 [ label = "context id layer" ]
    site1 -> s1_pageapp [ label = "entity type layer" ]
    s1_pageapp -> s1pa_chunks_array [ label = "chunks of entities" ]
    site1 -> s1_menu [ label = "entity type layer" ]
    s1_menu -> s1me_chunks_array [ label = "chunks of entities" ]
    subaccount -> roles [ label = "entity type layer" ]
    roles -> roles_chunks_array [ label = "chunks of entities" ]
    SUBACCOUNT -> subaccount [ label = "context id layer" ] 
    subaccount -> apps [ label = "entity type layer" ]
    apps -> apps_chunks_array [ label = "chunks of entities" ]
    subaccount -> groups [ label = "entity type layer" ]
    groups -> groups_chunks_array [ label = "chunks of entities" ]
    subaccount -> catalogs [ label = "entity type layer" ]
    catalogs -> catalogs_chunks_array [ label = "chunks of entities" ]
}
 

            1.20.2.8 CTMS, , tags: CTMS, export import
step by step guide: https://blogs.sap.com/2021/09/12/transport-fiori-launchpad-sites-on-sap-btp-using-sap-cloud-transport-management-service/
SAP CTMS Documentation: https://help.sap.com/docs/cloud-transport-management

            1.20.2.9
        1.20.3 spaces-and-pages   https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1368 / EUXTEAMSAAR-1369 [S4 Federation] Support Spaces & Pages as CDM entity - Design/Implementation

Motivation
Allow Content Providers to have spces and pages imported to cFLP via federation.
Spaces and Pages are alternative of groups with mass tiles and give user spaces as menu per business role of a user

User Story
As End user I want to see my spaces and pages in cFLP

General \ Technical Information
Support Spaces and Pages as CDM entities (for RT usage only ) S4 Federation content
S4 Spaces and Pages CDM entities, from S4.
Schema validation changes
Transport:
Generate needed relations
Space relate to Role
Page relate to Space
In design only, weak relation app>page>space (for future editor needs)
Yahalom, Amir - relations points between app>page>space>role
Call activation - with those entities
*Not in scope" -
No DT representation for spaces and pages in site manager for 2008.
E2E validation & Integration - Nadav's; Perry's team support
Dependencies for validation and integration:
Implementation of BE Enabelment team; Nadav's team BLI linked
Validation support BE Enabelment team + Nadav's Team
Wiki: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2160500233
PR - https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/176
Concept - https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FIORITECHP1-13278.md
Space and pages in UX - https://jam4.sapjam.com/blogs/show/VKqonRQbVZV1BZoUeZFWnw
Acceptance Criteria
Implementation based on Design
Space and Pages are importing and saved in the snapshot and running in RT in cFLP
No support in Design Time
Contacts, tsafrir, amir

            1.20.3.1 Links
jira: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1369

design:  https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2235311169
Test-Scope: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2238778287

            1.20.3.2 Design
                   
                1.20.3.2.1 relations diagram
pwd && cat spacesAngPagesContent.dot
/Users/i500695/work/code/graphviz/sap
digraph d {
 Site1 [label="Site1" fillcolor=red shape=circle fontcolor=blue]
 Site2 [label="Site2" fillcolor=red shape=circle fontcolor=blue]
 SiteRef1 [label="Site-References1" fillcolor=red shape=ellipse fontcolor=blue]
 SiteRef2 [label="Site-References2" fillcolor=red shape=ellipse fontcolor=blue]
 Role1 [label="Role1" fillcolor=red shape=ellipse fontcolor=red]
 Role2 [label="Role2" fillcolor=red shape=ellipse fontcolor=red]
 Space1 [label="Space1" fillcolor=red shape=ellipse fontcolor=green]
 Space2 [label="Space2" fillcolor=red shape=ellipse fontcolor=green]
 page1 [label="page1" fillcolor=red shape=ellipse fontcolor=green]
 page2 [label="page2" fillcolor=red shape=ellipse fontcolor=green]
 page3 [label="page3" fillcolor=red shape=ellipse fontcolor=green]
 page4 [label="page4" fillcolor=red shape=ellipse fontcolor=green]
 page5 [label="page5" fillcolor=red shape=ellipse fontcolor=green]
 Catalog1 [label="Catalog1" fillcolor=red shape=ellipse fontcolor=green]
 Group2 [label="Group2" fillcolor=red shape=ellipse fontcolor=green]
 BussinessApp1 [label="BussinessApp1" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp2 [label="BussinessApp2" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp3 [label="BussinessApp3" fillcolor=red shape=ellipse fontcolor=red]
 BussinessApp4 [label="BussinessApp4" fillcolor=red shape=ellipse fontcolor=red]
 Site1 -> {SiteRef1} [style = dotted label="contextId"] 
 Site2 -> {SiteRef2} [style = dotted label="contextId"]
 SiteRef1 -> {Role1} [label="ref"]
 SiteRef2 -> {Role2} [label="ref"]
 Role1 -> {BussinessApp1} [label="ref"]
 Role1 -> {BussinessApp3} [label="ref"]
 Role1 -> {BussinessApp2} [label="ref"]
 Role2 -> {BussinessApp2} [label="ref"]
 Role2 -> {BussinessApp3} [label="ref"]
 Role2 -> {BussinessApp4} [label="ref"]
 Role1 -> {Space1} [label="ref"]
 Role1 -> {Space2} [label="ref"]
 Space1 -> {page1} [label="ref"]
 Space1 -> {page2} [label="ref"]
 Space1 -> {page3} [label="ref"]
 Space2 -> {page4} [label="ref"]
 Space2 -> {page5} [label="ref"]
 Catalog1 -> {BussinessApp1} [label="ref"]
 Catalog1 -> {BussinessApp2} [label="ref"]
 Group2 -> {BussinessApp3} [label="ref"]
 Group2 -> {BussinessApp4} [label="ref"]
 page1 -> {BussinessApp3} [label="ref"]
 page1 -> {BussinessApp4} [label="ref"]
 page2 -> {BussinessApp3} [label="ref"]
 page2 -> {BussinessApp4} [label="ref"]
 page3 -> {BussinessApp3} [label="ref"]
 page3 -> {BussinessApp4} [label="ref"]
 page4 -> {BussinessApp3} [label="ref"]
 page4 -> {BussinessApp4} [label="ref"]
}

▶ dot -T png -O  spacesAngPagesContent.dot                                      

code/graphviz/sap                                                                                                                                     
▶ open spacesAngPagesContent.dot.png

dot -T png -O  spacesAngPagesContent.dot     &&open spacesAngPagesContent.dot.png
                1.20.3.2.2 my proposal 
Hi,
 
Today we had a great discussion!
As follow up It would like to start a discussion re. the DB impl. Of relations.
 
Lets examine the solution of apps having relations to groups/catalogs.
This is a good solution for current requirements,  getting site shared content entities, since it basically turns groups/catalogs to leaves and allows for “down” directed search from site-ref to find all content w/o crossing “line” to other sites.
The problem is that these relations are inverse to the ones in the real data. This creates an inconsistency and like all inconsistencies its only a matter of time until they become a liability. Given the pace of new requirements it might be wise to prepare a more future proof solution.
 
I suggest the following concept as a starting point for discussion.
How about we model the relations graph as undirected graph. In such a graph there’s no real root. All depends on where search starts. But that doesn’t mean that we can’t have an arbitrary search stop condition. If we support a stop condition we can answer any requirement.
Example:
We want only site shared content entities. We do a search from site-ref w/ stop condition on entities type in {group,catalog,page} and viola, we will find all site shared content entities connected to the site but w/o crossing the “line” to other sites.
Here we pass the responsibility of knowing the data modeling and crafting an appropriate search to our clients so any kind of search is supported w/o changes to cdm store.
 
Hope we can cont. the good discussion 😊
Thanks!
Yosi
                1.20.3.2.3

            1.20.3.3 Tests
                   
            1.20.3.4 Implementation Tasks

                1.20.3.4.1 CDM-Store client expose methods w/ stop condition

                    1.20.3.4.1.1 list current search methods

                        1.20.3.4.1.1.1 CDM store methods
getEntityWithRelation - POST, endpoint "/entity/{entityType}/id/{entityId:.+}" , search direction as param
getEntitiesWithRelation - POST,"/entities/search" , down search
getEntitiesWithRelation - GET, "/entities", down search
getEntitiesByTargetContext - GET,"/entities/sources"  , up search

check controller (/Users/i500695/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/webaccess/CdmController.java) for endpoints. note that parent is cdm so endpoint is "/cdm/entities..."

                        1.20.3.4.1.1.2 CDM store client methods
CdmStoreClient::getEntity()->CdmStoreClientHandler::getEntity() -POST> getEntityWithRelation - , endpoint "/entity/{entityType}/id/{entityId:.+}" - no need stop condition. No change

CdmStoreClient::getEntitiesWithSearch()->CdmStoreClientHandler::getEntitiesWithSearch() -POST> getEntitiesWithRelation - POST,"/entities/search" 
note optional query param withRelationTypes  in cdmStoreClient passing value extends - No change

CdmStoreClient::getEntitiesWithSearch()->CdmStoreClientHandler::getSiteEntitiesWithSearch() -POST> getEntitiesWithRelation - POST,"/entities/search"  ,
note optional query param withRelationTypes (default false), in cdmStoreClient passing value extends - no need for stop condition (stop is for 'ref' type)


CdmStoreClient::getEntitiesWithConfig()->CdmStoreClientHandler::getEntities() -GET> getEntitiesWithRelation - GET, "/entities"
note optional query param withRelationTypes (default false), in cdmStoreClient passing value extends - no need for stop condition (stop is for 'ref' type)

CdmStoreClient::getSiteEntities()->CdmStoreClientHandler::getSiteEntities() -GET> getEntitiesWithRelation - GET, "/entities"


not exposed: getEntitiesByTargetContext - GET,"/entities/sources" 
check direct calls, provisioning, and
transport, after commit get effected sites
provisioning, SaaS unsubscribe CF provider, delete all cherry-picked entities. search from provider snapshot up and into sub-accounts 
semantic calls for activation, get effected sites


a. CdmStoreClient::getSiteEntitiesWithSearch()->CdmStoreClientHandler::getEntitiesWithSearch() -POST> getEntitiesWithRelation - POST,"/entities/search" 
pass 'extends' relation. 


Need stop condition:
getSiteEntities() and getSiteEntitiesWithSearch()
note optional query param withRelationTypes  in cdmStoreClient passing value ref, extends - need stop condition 
b. not exposed: getEntitiesByTargetContext - GET,"/entities/sources" 
check direct calls, provisioning, and
transport, after commit get effected sites
semantic calls for activation, get effected sites

Force clients 2 send additionalAttributes with Search body

                        1.20.3.4.1.1.3 Usage in semantic service
- getEntity
    -- src/services/store/store-client.js, readOne()
47:        return cdmStoreClient.getEntity(baseCdmEntity, true, tenantId);

This is about to change. Search for role and assigned apps. 

used in:
MainController::readEntity() - general, read one entity type -> specific entity doesn't requires stop condition

All read provider, does not require stop condition:
ProviderController::isNewProvider()
ProviderController::notification()
ProviderController::syncExternalProvider()

read site, does not require stop condition:
SiteEntityController::readSite()
updateThemeAndActivate::readSite()
    --

- getSiteEntitiesWithSearch, 
    -- src/services/store/store-client.js, readOne() , single entity read. need stop condition? 
    

    -- StoreClient::readSiteEntities()
MainController::readSiteEntities() - stop condition not required?- 
consider cherry-picked roles only 4 external provider. For CF Provider no spaces & pages
    --

- getEntitiesWithSearch, search 'extends' relation. doesn't require stop condition
    -- StoreClient::readAll()

    -- StoreClient::getAllContentRelatedEntities()
MainController::readAllContentRelatedEntities()
MainController::readEntities()

- getEntitiesWithConfig. no used

- GET /entities/sources
  cdmStoreClient:getAffectedSitesByProvider() - CF provider scenario. Technically does not require stop condition 
    async getAffectedSitesByProvider(contextId, reqContext, token) {
        logger.logRequestMessage(reqContext.logger, 'debug', 'StoreClient::getAffectedSitesByProvider() - retrieving the list of sites affected by changes to a provider. context id: %s', contextId);
        return this.sendRequest(null, `/entities/sources?targetContextId=${contextId}&targetContextType=${contextTypes.SNAPSHOT}&entityTypes=${entityTypes.SITEREFERENCES}`, null, reqContext, token);
    }
  


                        1.20.3.4.1.1.4 Usage in activation service:
- getEntity, not used

- getSiteEntitiesWithSearch, not used

- getEntitiesWithSearch, not used

- getEntitiesWithConfig, not used

CDM store is used directly.
/Users/i500695/work/SAP/git/portal-cf-activation-service/src/utils/cdmStoreUtils.js
calling 
getEntitiesWithRelation - GET, "/entities", down search
deleteContentUnits() - ask Uri 


                        1.20.3.4.1.1.5 Usage in provisioning service
                        summary. page-app search stop condition not required.
- getEntity, not used

- getSiteEntitiesWithSearch, not used

- getEntitiesWithSearch, not used

- getEntitiesWithConfig, not used

CDM store is used directly.
tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
- createEveryoneRoleForTenant()
152:            ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities",
create everyone role. no need for stop condition.

- getEntitiesByTargetContext()
                serviceCallResponse = serviceRequest.callService("/cdm_store_service/cdm/entities/sources?targetContextId=" + targetContextId + "&targetContextType=SNAPSHOT&entityTypes=sitereferences,businessapp", RequestMethod.GET, null, null, additionalAttributes, null);

called by unsubscribeCFProviderByContextId() which in turn delete cherry-picked apps of an unsubscribed CF provider.
No need for stop condition since spaces-and-pages are not relevant to internal-CF-Provider scenario

280:                serviceCallResponse = serviceRequest.callService("/cdm_store_service/cdm/entities/sources?targetContextId=" + targetContextId + "&targetContextType=SNAPSHOT&entityTypes=sitereferences,businessapp", RequestMethod.GET, null, null, additionalAttributes, null);
same as above 

- performBatchDeleteEntities()
324:        ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);

                        1.20.3.4.1.1.6 Usage in transport service
- getEntity, not used

- getSiteEntitiesWithSearch, not used

- getEntitiesWithSearch, 
called by getUrlTemplatesFromDB()->getEntitiesIdsByContext(). search 'extends' relation no need for stop condition 

- getEntitiesWithConfig, not used

- startTransport() calls
            affectedEntities = await this.commitJob(keyDto, !isNil(deltaLink), token);
which calls
        return this.cdmClientService.commit(contextId, contextType, isDeltaUpdate, token);

which calls cdmStoreClient which calls CDM store
src/client/cdm-store-client-transport-handler.ts
  public async commit(contextId: string, contextType: string, isDeltaUpdate: boolean): Promise<object[]> {
    this.logger.verbose("CdmStoreClientTransportHandler::commit(): contextId = ${contextId}, contextType = ${contextType}");
    this.validateContext(contextId, contextType);
    let response;
      try {
        response = await this.serviceRequestBuilder
          .createRequest()
          .addParam(CdmStoreClientConstants.CONTEXT_ID, contextId)
          .addParam(CdmStoreClientConstants.CONTEXT_TYPE, contextType)
          .addParam(CdmStoreClientConstants.DELTA_UPDATE, String(isDeltaUpdate))
          .post('/transport/commit');

 check endpoint '/transport/commit'
 src/main/java/com/sap/portal/cdm/store/webaccess/TransportController.java
    @PostMapping(value = "/commit", produces = {"application/json"})
    @ApiOperation(value = "Commits import changes - changes temporary context to the original context.", response = String.class)
    public ResponseEntity commit(@RequestParam("contextId")
calls
            affectedSites = entityService.getEntitiesByTargetContext(contextId, contextType, Arrays.asList("sitereferences"));
...
calls
src/main/java/com/sap/portal/cdm/store/dao/ContextOperationsDao.java::getEntitiesByTargetContext()
which calls:
            IReadStatementByTenant<String> queryDetails = new SelectEntitiesByTargetContext(targetContextId, targetContextType, entityTypesToFilter);
            return jdbcTemplate.query(queryDetails, queryDetails::extractFromResultSet);
note the query has both relation types
    private final List<String> relationTypesArgs = Arrays.asList("extends", "ref");

now the actual query will end up calling this: src/main/java/com/sap/portal/cdm/store/dao/statements/context/SelectEntitiesByTargetContext.java
    public void addTenantAwareness(String tenant) {
        this.statementArgs = new ArrayList<>();
        this.statementArgs.addAll(Arrays.asList(
                this.targetContextId,
                this.targetContextType,
                10, "UP",
                tenant
        ));
        this.statementArgs.add(this.relationTypesArgs.stream().toArray(String[]::new));
        this.statementArgs.addAll(Arrays.asList(tenant, this.targetContextId, this.targetContextType));

        if(this.entityTypesToFilter != null && this.entityTypesToFilter.size() > 0) {
            this.statementArgs.addAll(this.entityTypesToFilter);
        }
    }
Note that adds 'ref,extends' relations so requires stop condition!

- export
CdmStoreClient::getSiteEntities()->CdmStoreClientHandler::getSiteEntities() -GET> getSiteEntities - GET, "/entities"
cherry-picked roles only 4 external provider. For CF Provider no spaces & pages




                        1.20.3.4.1.1.7 summary emails
- Spaces&pages in transport and provisioning
Hi,
 
We want to share our current understanding to get your feedback.
 
Transport is affected as follows:
 
Import, commit also returns affected sites.
Page<->App stop cond. Applies.
 
Export: it gets site entities from shared content (sub-account) not merged.
So for external provider roles only are cherry-picked.
For CF Provider, apps are cherry-picked but there are no spaces & pages
Page<->App stop cond. Doesn’t Apply.
 
 
URL templates: actual search is on ‘extends’ relations (getUrlTemplatesFromDB()->getEntitiesIdsByContext() calls client method getEntitiesWithSearch() which searches ‘extends’ relations).
Page<->App stop cond. Doesn’t Apply.
 
Provisioning.
a. everyone role.  createEveryoneRoleForTenant()
create everyone role.
Page<->App stop cond. Doesn’t Apply.
 
b. unsubscribe CF provider
( getEntitiesByTargetContext(), performBatchDeleteEntities() )
unsubscribeCFProviderByContextId() gets and deletes cherry-picked apps of an unsubscribed CF provider.
No need for stop condition since spaces-and-pages are not relevant to internal-CF-Provider scenario
Page<->App stop cond. Doesn’t Apply.
 
Thx!
Shirly & Yosi

- Semantic adaption to spaces&pages new page<->app search stop condition
Hi,
 
Meeting summary.
TLDR. Currently semantic is not affected.
 
Details. Breakdown of all possibly affected calls:
 
a. readOne()
calls cdmStoreClient.getEntity(baseCdmEntity, true, tenantId);
This is about to change. Search for role and assigned apps. Search down two levels. Page apps are three levels down.
No change.
 
b. MainController::readEntity()
general, read one entity type+id. specific entity doesn't requires stop condition
No change.
 
 
C. provider reads.
ProviderController::isNewProvider()
ProviderController::notification()
ProviderController::syncExternalProvider()
No change.
 
d. read site
SiteEntityController::readSite()
updateThemeAndActivate::readSite()
getSiteEntitiesWithSearch,
 StoreClient::readSiteEntities()
MainController::readSiteEntities() - stop condition technically required. But, consider cherry-picked roles only 4 external provider. For CF Provider no spaces & pages. So here also
No change
 
e.  StoreClient::readAll()
StoreClient::getAllContentRelatedEntities()
MainController::readAllContentRelatedEntities()
MainController::readEntities()
 
All call getEntitiesWithSearch, which searches 'extends' relation. doesn't require stop condition
No change
 
f. cdmStoreClient::getAffectedSitesByProvider()
CDM store GET ‘/entities/sources’
This is CF provider scenario. Until spaces&pages are supported it does not require stop condition
No change
 
Thx!
Shirly & Yosi
From: yosi.izaq@sap.com
When: 14:30 - 15:00 26 March 2020 
Subject: Semantic adaption to spaces&pages
 
 
Agenda. Talk API usage:
 
- getSiteEntitiesWithSearch, 
    -- src/services/store/store-client.js, readOne() , single entity read. need stop condition? 
    
 
    -- StoreClient::readSiteEntities()
MainController::readSiteEntities() - stop condition not required?- cherry-picked roles only 4 external provider
For CF Provider no spaces & pages
 
--   cdmStoreClient:getAffectedSitesByProvider() - require stop condition ?
    async getAffectedSitesByProvider(contextId, reqContext, token) {
        logger.logRequestMessage(reqContext.logger, 'debug', 'StoreClient::getAffectedSitesByProvider() - retrieving the list of sites affected by changes to a provider. context id: %s', contextId);
        return this.sendRequest(null, `/entities/sources?targetContextId=${contextId}&targetContextType=${contextTypes.SNAPSHOT}&entityTypes=${entityTypes.SITEREFERENCES}`, null, reqContext, token);
    }
 



                        1.20.3.4.1.1.8

                    1.20.3.4.1.2 Implementation initial thoughts
a.  public async getEntity(baseCdmEntity: BaseCdmEntity, merged: boolean, readFromTenant: string = ""): Promise<FullCdmEntity | null> {

change all args to interface...
add excludePageAppFromSearch bool

b. StopCondJsonBuilder, similar to SearchJsonBuilder

c. 
                    1.20.3.4.1.3

                1.20.3.4.2

            1.20.3.5 PRs

                1.20.3.5.1 CDM store
API: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/461

                1.20.3.5.2 CDM store client
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/90
                https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/91
                https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/92

                1.20.3.5.3 transport
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/206/files

diffs, <URL:/Users/i500695/work/SAP/PRs/transport/spacesNpages_sectionCreators>

                1.20.3.5.4 cdm-schema
https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/194/files
                1.20.3.5.5

            1.20.3.6 Followup

                1.20.3.6.1  pages and sections apps ids missing providerid prefix 
jira: https://sapjira.wdf.sap.corp/browse/DWPBUGS-450

Problem:
Uri:
When collecting the entities from cdm-store store, the id's of the applications under the businesssapp entities type and under the pages and the section entities types are a bit different. In the businessapps entities types, a prefix of the provider id is being added (I guess for uniquness). Because of this difference – site service filters the pages (because it can't find a reference for the applications inside the page). Example of the cdm-store response (my provider id is "s4_provider"):

Me:
Transport will update page id to be: <provider id>+’_’+<page id>
Transport will update sections app ids under payload.viz and relations to be: <provider id>+’_’+<app id>
The sections and apps should not be taken from pages payload. Instead they should be taken from the sections. Uri will make this change.

Fix:

Verification:
                1.20.3.6.2 Fix
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/261/files
<URL:/Users/i500695/work/SAP/PRs/transport/spacesNpages_fixIdPrefixBug>

E2E test logs:
<url:/Users/i500695/work/SAP/logs/spaces-and-pages/transport_spacesNpages.log>

            1.20.3.7
        1.20.4  upgrade spring version https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1373

PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/449?_pjax=%23js-repo-pjax-container
main changes:
a. phosphor version change
     <groupId>com.sap.sgs</groupId>
     <artifactId>security-patched-spring-boot-starter</artifactId>
-    <version>2.1.13.RELEASE-sap-01</version>
+    <version>2.2.5.RELEASE-sap-03</version>

b. flyway version change to flyway 6.0.8

c. flyway configure change
     public Flyway postgresFlyway() {
-        FluentConfiguration flywayConfiguration = Flyway.configure().dataSource(flywayDataSource).schemas("cdm").validateOnMigrate(true).locations("classpath:db/migration/postgres");
-        Flyway flyway = new Flyway(flywayConfiguration);
+        Flyway flyway = Flyway.configure().dataSource(flywayDataSource)
+                                            .locations("classpath:db/migration/postgres")
+                                            .schemas("cdm").validateOnMigrate(true).load();
         logger.info("Starting postgres flyway migration..");

diff:

From 5b0fa3958f4f0f1ce3da2572cecb14dfe666e494 Mon Sep 17 00:00:00 2001
From: Gil Shikva <gil.shikva@sap.com>
Date: Sun, 15 Mar 2020 17:30:10 +0200
Subject: [PATCH] upgrading to <groupId>com.sap.sgs</groupId>                 
 <artifactId>security-patched-spring-boot-starter</artifactId>                
  <version>2.2.5.RELEASE-sap-03</version> and flyway 6.0.8

---
 cdm.store.service/pom.xml                         |  3 +--
 .../cf/database/config/DataSourceConfig.java      |  5 +++--
 .../cf/database/config/LocalDataSourceConfig.java |  6 ++++--
 manifest-dev.yml                                  |  3 ++-
 pom.xml                                           |  4 ++--
 vulas-custom.properties                           | 15 ---------------
 6 files changed, 12 insertions(+), 24 deletions(-)

diff --git a/cdm.store.service/pom.xml b/cdm.store.service/pom.xml
index e3f0d0fb0..8d5b91cb9 100644
--- a/cdm.store.service/pom.xml
+++ b/cdm.store.service/pom.xml
@@ -5,7 +5,7 @@
   <parent>
     <groupId>com.sap.cloud.cf.portal</groupId>
     <artifactId>cdm-store-service-parent</artifactId>
-    <version>2.0.0-SNAPSHOT</version>
+    <version>1.34.0-SNAPSHOT</version>
   </parent>
   <artifactId>cdm.store.service</artifactId>
   <dependencies>
@@ -112,7 +112,6 @@
     <dependency>
       <groupId>org.flywaydb</groupId>
       <artifactId>flyway-core</artifactId>
-      <version>5.2.4</version>
     </dependency>
     <dependency>
       <groupId>net.jodah</groupId>
diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/DataSourceConfig.java b/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/DataSourceConfig.java
index 6f05d1c80..e7d09e762 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/DataSourceConfig.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/DataSourceConfig.java
@@ -64,8 +64,9 @@ public JdbcTemplate migrationJdbcTemplate() {
 
     @Bean
     public Flyway postgresFlyway() {
-        FluentConfiguration flywayConfiguration = Flyway.configure().dataSource(flywayDataSource).schemas("cdm").validateOnMigrate(true).locations("classpath:db/migration/postgres");
-        Flyway flyway = new Flyway(flywayConfiguration);
+        Flyway flyway = Flyway.configure().dataSource(flywayDataSource)
+                                            .locations("classpath:db/migration/postgres")
+                                            .schemas("cdm").validateOnMigrate(true).load();
         logger.info("Starting postgres flyway migration..");
         try {
             int migrationsNumber = flyway.migrate();
diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/LocalDataSourceConfig.java b/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/LocalDataSourceConfig.java
index bdf6834b0..04880d32c 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/LocalDataSourceConfig.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/database/config/LocalDataSourceConfig.java
@@ -59,8 +59,10 @@ public JdbcTemplate migrationJdbcTemplate() {
     @Bean
     public Flyway flyway() {
         logger.info("Starting postgres flyway migration..");
-        FluentConfiguration flywayConfiguration = Flyway.configure().dataSource(postgresDataSource).schemas("cdm").validateOnMigrate(true).locations("classpath:db/migration/postgres");
-        Flyway flyway = new Flyway(flywayConfiguration);
+        Flyway flyway = Flyway.configure().dataSource(postgresDataSource)
+                .locations("classpath:db/migration/postgres")
+                .schemas("cdm")
+                .validateOnMigrate(true).load();
         try {
             int migrationsNumber = flyway.migrate();
             logger.info("Flyway migration passed with " + migrationsNumber + " successfully applied migrations.");
diff --git a/manifest-dev.yml b/manifest-dev.yml
index f0a88e4b8..79d63bf6e 100644
--- a/manifest-dev.yml
+++ b/manifest-dev.yml
@@ -8,7 +8,8 @@ applications:
   memory: 1024MB
   path: <pathToFile>
   instances: 1
-  buildpack: sap_java_buildpack
+  buildpacks:
+    - sap_java_buildpack
   timeout: 600
   env:
     TARGET_RUNTIME: tomee
diff --git a/pom.xml b/pom.xml
index ad17c95bb..8898aa94d 100644
--- a/pom.xml
+++ b/pom.xml
@@ -5,11 +5,11 @@
   <parent>
     <groupId>com.sap.sgs</groupId>
     <artifactId>security-patched-spring-boot-starter</artifactId>
-    <version>2.1.13.RELEASE-sap-01</version>
+    <version>2.2.5.RELEASE-sap-03</version>
   </parent>
   <groupId>com.sap.cloud.cf.portal</groupId>
   <artifactId>cdm-store-service-parent</artifactId>
-  <version>2.0.0-SNAPSHOT</version>
+  <version>1.34.0-SNAPSHOT</version>
   <packaging>pom</packaging>
   <modules>
     <module>cdm.store.service</module>
diff --git a/vulas-custom.properties b/vulas-custom.properties
index 655401591..118a28c7e 100644
--- a/vulas-custom.properties
+++ b/vulas-custom.properties
@@ -13,18 +13,3 @@ vulas.maven.ignorePoms = false
 vulas.report.exceptionExcludeBugs=CVE-2012-5783-3x
 vulas.report.exceptionExcludeBugs.CVE-2012-5783-3x = Not exploitable because we do only internal communication, i.e. inside space
 
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-8840
-vulas.report.exceptionExcludeBugs.CVE-2020-8840 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9548
-vulas.report.exceptionExcludeBugs.CVE-2020-9548 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9547
-vulas.report.exceptionExcludeBugs.CVE-2020-9547 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9546
-vulas.report.exceptionExcludeBugs.CVE-2020-9546 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don


portal-cf-provisioning-service PR:
main changes:
a. phosphor version
     <artifactId>security-patched-spring-boot-starter</artifactId>
-    <version>2.1.13.RELEASE-sap-01</version>
+    <version>2.1.13.RELEASE-sap-02</version>

b.
https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/142

diff:
From 6ecf8cfeeead097a8b33b3b713356a2e0b81539d Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Sun, 15 Mar 2020 16:23:07 +0200
Subject: [PATCH] update spring version and fix provisioning deployment issue

---
 pom.xml                     | 14 ++------------
 tenant.provisioning/pom.xml |  5 -----
 vulas-custom.properties     | 20 --------------------
 3 files changed, 2 insertions(+), 37 deletions(-)

diff --git a/pom.xml b/pom.xml
index 3625a3fb..46d0646a 100644
--- a/pom.xml
+++ b/pom.xml
@@ -5,7 +5,7 @@
   <parent>
     <groupId>com.sap.sgs</groupId>
     <artifactId>security-patched-spring-boot-starter</artifactId>
-    <version>2.1.13.RELEASE-sap-01</version>
+    <version>2.1.13.RELEASE-sap-02</version>
   </parent>
   <groupId>com.sap.cloud.cf.portal</groupId>
   <artifactId>provisioning-service-parent</artifactId>
@@ -42,17 +42,7 @@
     <dependency>
       <groupId>org.springframework.boot</groupId>
       <artifactId>spring-boot-actuator</artifactId>
-        <exclusions>
-            <exclusion> 
-                <groupId>org.springframework</groupId>
-                <artifactId>spring-web</artifactId>
-                </exclusion>
-        </exclusions> 
-    </dependency>
-    <dependency>
-        <groupId>org.springframework</groupId>
-        <artifactId>spring-web</artifactId>
-        <version>5.2.4.RELEASE</version>
+      <version>2.2.5.RELEASE</version>
     </dependency>
     <dependency>
       <groupId>org.apache.tomcat</groupId>
diff --git a/tenant.provisioning/pom.xml b/tenant.provisioning/pom.xml
index f832bd6e..eb17c3a2 100644
--- a/tenant.provisioning/pom.xml
+++ b/tenant.provisioning/pom.xml
@@ -10,11 +10,6 @@
   <groupId>com.sap.cloud.cf.portal</groupId>
   <artifactId>provisioning-service</artifactId>
   <dependencies>
-    <dependency>
-      <groupId>org.springframework</groupId>
-      <artifactId>spring-web</artifactId>
-        <version>5.2.4.RELEASE</version>
-    </dependency>
     <dependency>
       <groupId>org.springframework.boot</groupId>
       <artifactId>spring-boot-starter-web</artifactId>
diff --git a/vulas-custom.properties b/vulas-custom.properties
index f69450f5..2ab131ab 100644
--- a/vulas-custom.properties
+++ b/vulas-custom.properties
@@ -25,23 +25,3 @@ vulas.report.exceptionExcludeBugs.CVE-2019-17531 = jackson databind 2.0 - 2.9.10
 
 vulas.report.exceptionExcludeBugs=CVE-2020-8840
 vulas.report.exceptionExcludeBugs.CVE-2020-8840 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-# CVE-2020-5397 spring-web-5.1.12.RELEASE.jar - No known solution yet to this issue
-vulas.report.exceptionExcludeBugs=CVE-2020-5397
-vulas.report.exceptionExcludeBugs.CVE-2020-5397 = No known solution yet to this issue.
-
-# CVE-2020-5398 spring-web-5.1.12.RELEASE.jar - No known solution yet to this issue
-vulas.report.exceptionExcludeBugs=CVE-2020-5398
-vulas.report.exceptionExcludeBugs.CVE-2020-5398 = No known solution yet to this issue.
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9548
-vulas.report.exceptionExcludeBugs.CVE-2020-9548 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9547
-vulas.report.exceptionExcludeBugs.CVE-2020-9547 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-
-#jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't
-vulas.report.exceptionExcludeBugs=CVE-2020-9546
-vulas.report.exceptionExcludeBugs.CVE-2020-9546 = jackson databind 2.0 - 2.9.10 is vulnerable only if you have in class path [comons-dbcp, p6spy] which we don't

        1.20.5   Support Helium like application in launchpad – Design &  Implementation

            1.20.5.0 general
Currently a customer can deploy apps using an MTA (a package of his apps + app router) deployer (DTS service)
the deploer will register the applications in FDC (apphostid tenant apps indexes, also supports transitive closure for application runtime dependencies)
and also create a snapshot in a given 'CF provider' subaccount 
This requires both RT approuter on using SaaS account and a dedicated approuter that was deployed from MTA on provider subaccount

In an attempt to simplify that process we want to allow deployment of apps directly to SaaS subaccount.
For this we need FDC to support a SAAS_APPROUTER apphostids for these apps.
This coupled with a new url-template type AaaS (approuter as a service) allow RT navigation for apps w/o system alias and destination.
Instead SAAS_APPROUTER is used to directly access apphostid in FDC for retrieving the application manifest and RT dependencies thus allowing to run it.

note. apphostid is a GUID for accessing app RT data.

            1.20.5.1 Links
Design - https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFIORITECHP1-15870%5D+-+Provisioning+Service
Test scope - https://wiki.wdf.sap.corp/wiki/plugins/servlet/samlconsumer

                1.20.5.1.1 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1528

Support Helium like application in launchpad – Provisioning - Design & Implementation

Motivation

Support Helium like apps deploy to html5 repo on same subaccount of Launchpad service and consume it like content provider
cFLP Customers that purchased SAP solution based (SAP Stakeolders) on FLP module will still be able to use it, However, CF custom developed applications will not use FLP Module and use the helium like application deploying to html5 repo.
SAP Stakeholder still exist and supported
Workzone, workzone HR, Launchpad
In the future will support other subaccounts as well and other global accounts , each subaccount will be an independent content provider.
Once there are helium like application in HTML5 repo it automatically will appear in content manager as content provider and explorer tab within a tile.

User Story

As an Admin I would like to be able use my developed apps (without using FLP moudle) which were deployed in html5 repo and consume them via launchpad as a contnet provider.

General \ Technical Information

Design & Implementation
A new type of internal provider (helium like apps from HTML5)
Provisioning service: Sklarski, Tsafrir add technical details:
Return current Tenant and stable instance as trusted tenant
Also here create local provider entity (as it is provider)
Snapshot will be created at our side different way (in different instance of cFLP)
Pre-req: Sit with Tsafrir for more technical details and understand the while concept
Take into account in the future - we should Support Different subaccounts, Different global accounts.
Like in CF federation but snapshot creation is different and discovery of this content provider is different.
Launchpad; Wokzone only. Not portal service.
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2264188779
Review design with Tsafrir, Dana.
Technical detailed by Tsafrir: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2264188779#id-[Launchpad/Workzone]-ApprouterasaService%22heliumlike%22consumption-TheProviderSnapshot
Acceptance Criteria

Design & Implementation (for now only in the same sub account)
Contacts

Tsafrir
UX

UX and VD expert Mazuz Kalifa, Lev & Shir

InfoDev

Definition Of Done

Item	Done/Not Done/NA
| 1. Design was written and reviewed	 
| 2. Test Scope was written, reviewed by PO and QPE and executed by the team; 0 VH/High, Up to 3 Medium bugs, 0 open Git issues	 
| 3. Automated tests were written, reviewed and executed	 
| 4. Code review was done and high priority issues were fixed	 
| 5. Code was merged to master and promoted to Nexus	 
| 6. UX design and graphics were implemented according to UX spec and were reviewed	 
| 7. Strings (UI Strings, public API names) were validated by UA after implementation, and are translatable	 
| 8. Performance tests were executed and meets KPIs	 
| 9. Documentation – HO to UA was done	 
| 10. Open sources were approved	 
| 11. Security –  all security aspects were taken into consideration and reviewed by security angel, and code is GDPR and EU only compliant	 
| 12. Accessibility requirements were taken into consideration in definition, implementation and testing	 
End Sprint Status:

=========================
more info

if the site ID does not exist - import as a new site
If the site ID does exist - Overwrite it (full site+content import)
The client will do the check of site exist and if yes, alert admin. If admin will approve to overwrite only then the client will call import.

                1.20.5.1.2 [Launchpad/Workzone] - Approuter as a Service "helium like" consumption

https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2264188779

                    1.20.5.1.2.1 CF Content consumption
https://wiki.wdf.sap.corp/wiki/display/CPPortals/CF+Content+consumption

There are 3 options to consume content from CF in cFLP:
Service Provider 
SaaS Content 
Customer Content 

Service Provider
A service provider is used to provide content such as applications and plugins that should be part of the product. For example: OneInbox, SMB tiles, etc. 
SaaS Content
A solution containing several applications that is sold to customers by either SAP or by a partner. The content contains applications, groups, catalogs and roles. Customers would like to consume this solution as is into cFLP including all relations of CDM content. 
Customer Content
A content developed by a customer in order to be consumed in cFLP. The content can include: apps, roles, plugins, custom tiles and cards. 

Content development and exposure
Service Provider
A service provider can create the content in whatever tooling it prefer. The content should be shared to all the cFLP customers or only based on entitlement. The provider should expose the content as a business service. The content should be added in the onboarding process to the customer. The content can include CDM content, Fiori applications, plugins, cards, etc. 
The service can expose oData calls. 
Content can be added also to existing customers in case a new service is added. 
SaaS Content
The SaaS solution should be developed based on the Apollo guidelines. The SaaS solution should be consumed as is with all it's CDM content, including roles, groups and catalogs.   
The content should be added to cFLP via subscription to the solution based on entitlement. 
Customer Content
A content developed by a customer in order to be consumed in cFLP. The content can include: apps, plugins, custom tiles and cards. 
The content is developed in the dev landscape and therefore it should be possible to also transport the content. It is also possible that the developer will develop the content and provide it to the administrator. 
A customer should be able to include such content by admin operations of application upload. 
The content can be in separate sub accounts and separate global accounts (SAP IT use case).  

                    1.20.5.1.2.2 user story
                    Customer want to develop a simple application, without the need for a dedicated approuter or portal content deployer.  (No need for a local Launchpad Module)
Customer would like to be able to run the application standalone, or in Launchpad / Workzone
As reference from the All Hands meeting All Hands Slides Apr2020, it seems the direction suggested to customer is to use CAP, at first we should target the "S" capabilities and in the end the "XL" capabilities:
CAP Cookbook: https://cap.cloud.sap/docs/ 
Step by Step for the customer:
Develop & Build the application / shell plugin
Deploy with MTA / Push to cf & HTML5 CLI (https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2240825113)
Go to site manager / content explorer:
Option 1: Review & select application available
Option 2: Manual creation of application - with additional information on Destination
Add application to role / group, add role to site
Navigate to the site (runtime)
Navigate to the application and see that it loads

This need to be done without breaking existing functionality of consuming apps
from providers / manual as today

                    1.20.5.1.2.3 Design

Main points taken for the architecture:
Applications will need to be in a format of a Business Service (BS) - having sap.cloud.service, and indicatorDataSource should contain the BS prefix 
FDC will be created per subaccount, this will happen during onSubscription flow in the service broker. (the app host id of FDC will be stored in tenant configuration.
Snapshots will be created for all "helium like" applications per subaccount - each subaccount will have its own dedicated "helium" provider
First phase always create all application snapshots even in update, in the future support partial updating snapshots & notifications.
At runtime a dedicated URL template will be used which has a relative path to the Launchpad / Workzone Approuter. - this solve the issues of Dynamic tiles, shell plugins, double billing etc..
To access FDC at runtime there is a need for Approuter extension that will check based on the tenant configuration to which FDC app host to access.

                1.20.5.1.3

            1.20.5.2 Design
            https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFIORITECHP1-15870%5D+-+Provisioning+Service
            Feature Details:
Created By	
Cohen, Shirly , Izaq, Yosi
BLI link to Jira	
EUXTEAMSAAR-1528 - Support Helium like application in launchpad – Provisioning - Design & Implementation IN PROGRESS
Test system ( optional)	
Client Type ( Web browser/mobile)	postman, curl, python requests
Reviewed by	
PO
QPE
ScM

DRAFT 
Feature Details:
General
Description 
High level view
Flow
Get tenant providers
Scenarios
Validate trust
Data Termination
Helium instance ID
Future
Test Scope
Tasks
General
Description 
As part of the bigger requirement for allowing customers to develop, deploy and consume HTML 5 applications without requiring an app router or portal content deployer.
Specifically this BLI focuses on enhancing provisioning service so that the list of allowed trusted providers per tenant is extended with the current subaccount ID + Helium instance ID.
More details in the high level design.
High level view


Flow
Get tenant providers
A client, CDM Store, sends GET /tenants/ids/ or /tenants/provider/ids. Provisioning service returns all authorised providers and in addition the current subaccount ID + Helium instance ID.
Note, currently semantic service also consumes this API but this will change when local provider entity BLI is complete.
CDM Store consumes this API in the following use cases.
Snapshot CRUD
Cherry pick from snapshot
subscription 
local provider entity
NOTE This API is not used for provisioning and/or onboarding process. It is used by CDM Store to determine if it has permission to access a provider snapshot.

Scenarios
current supported scenarios are.
SCENARIOS = {
    PORTAL: 'PORTAL',
    LAUNCHPAD: 'LAUNCHPAD',
    WORKZONE: 'WORKZONE',
    WORKZONEHR: 'WORKZONEHR',
    APOLLO: 'APOLLO'
};
NOTE Helium provider is returned for all scenarios. Regardless of whether its PORTAL, WORKZONE or LAUNCHPAD.


NOTEWhen preparing this design we noticed that currently own portal scenario providers are excluded from the final list. 
This is a bug and it will be tracked and fixed separately from this BLI.
Details:
Code snip
String portalInstanceId = securityService.getPortalInstanceId();
tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, portalInstanceId);
and actual select 
"SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = <Identity zone ID> AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" != "portalInstanceId" ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";

This means that portal instance ID providers (of origin sub account) are excluded.
There are two options for fix.

SELECTED option a. remove filtering by portal instance ID.
 Pros. simple. gets the job done. generic in the sense that consumer can apply whatever filtering logic suits it.
Cons. will require change if white/black list filtering will be required.

option b. Allow the consumer to exclude current instance ID using a toggle query param.
Pros. future proof.
Cons. Less separation of concerns. In general filtering logic should be done by consumer.   

Validate trust
The validate trust API. /trust/{providerTenantId} validates that there is trust for the provider tenant.
It retrieves the list of authorised provider and returns 200 with json:
{authorized: true}

 when the provider tenant is authorised.

Data Termination
So long as there's at least one subscription. Doesn't matter which, Portal, WorkZone or Launchpad, the provider entity is persisted under 

identityZoneId: <subaccountId might be the same if subscribed to both SWZ and Launchpad>
instanceId <hardcoded_instance_id>
entityType: provider
contextType: SNAPSHOT
contextId: SUB_ACCOUNT

When all of the existing instance subscriptions are deleted the local provider entities and their corresponding snapshots shall be deleted.
The only exception is Helium instance, which will not be deleted.
Example.
SaaS account is subscribed to PORTAL, LAUNCHPAD and WORKZONE.
Get Authorized providers returns all provider instances + helium instance.

unsubscribe  LAUNCHPAD and WORKZONE instances. Note still subscribed to PORTAL.
Get Authorized providers returns all provider instances + helium instance.

unsubscribe PORTAL. There are no subscriptions.
Data termination ensues.
Get Authorized providers returns helium instance only.

Helium instance ID
The helium instance ID should be known to DTS and Provisioning service. 
DTS uses it in register provider use case.

Possible example ids: SAAS_APPROUTER_HTML5_APP_REPO or HTML5_APP_REPO
CHOSEN  HTML5_APP_REPO
Helium instance ID: subaccountID + ‘HTML5_APP_REPO'

Alternative
Configurable Helium instance ID
Option a. Consume from configuration file.
pros: can be changed w/o code changes.
cons: overkill for now

SELECTEDOption b. hard coded Helium instance ID (as an enum or constant) 
pros: trivial implementation
cons: Changes require code change.

Future
Currently 'Helium' instance is on the same subaccount as launchpad/workzone scenario. 
In the future the plan is to support consumption of 'Helium' instances from other subaccount.
see diagram. Left side is current support. Right side is future support


                1.20.5.2.1 websequence diagram

participant "CDM Store" as Store
participant "Provisioning Service" as Provisioning
participant "Database" as DB
note right of Store
JWT contains Identity zone ID
end note
Store -> Provisioning: GET /tenants/provider/ids
Provisioning -> DB: query authorized tenants 
note right of Provisioning
All authorized tenants for this give identity zone are retrieved
end note
DB -> Provisioning: list of authorized tenants
activate Provisioning
note right of Provisioning
Add helium instance to tenants list
end note
deactivate Provisioning
Provisioning -> Store: list of authorized tenants including helium instance

            1.20.5.3 Tests

            1.20.5.4 Tasks

                1.20.5.4.1 GET /tenants/provider/ids
-> Controler
/Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java : 
    @ApiOperation(value = "Get all Providers tenant Ids")
    @GetMapping(value = {"/ids", "/providers/ids"}, produces = "application/json")
    @PreAuthorize("@securityService.hasGrantTypeClientCredentials()")
    public ResponseEntity getAllProvidersTenantsIds() {
        String identityZoneId = getIdentityZoneId();
        ResponseEntity response;
        try {
            logger.info("getAllProvidersTenantsIds called with identityZoneId = {}", identityZoneId);
            String portalInstanceId = securityService.getPortalInstanceId();
            List<String> tenantIds;
            tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, portalInstanceId);
            response = new ResponseEntity<>(tenantIds, OK);
        } catch (RuntimeException e) {
            logger.error(e.getMessage(), e);
            response = ResponseEntity.status(INTERNAL_SERVER_ERROR).build();
        }
        return response;
    }

-> Business-logic
/Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
    @Override
    public List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) {
        return tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId);
    }

-> DAO
/Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
    @Override
    public List<String> getAuthorizedTenantsIds(String identityZoneId, String filterByInstanceId){
        return jdbcTemplate.query(SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED, (ResultSet resultSet, int i) -> resultSet.getString("TENANT_ID"), identityZoneId, filterByInstanceId);
    }

    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" != ? ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";


                1.20.5.4.2 Data termination
-> Controler
/Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
    @ApiOperation(value = "SAAS unsubscribe")
    @DeleteMapping(value = "subscription",
            consumes = "application/json")
    @PreAuthorize("@scopeEvaluator.hasScope('" + SecurityScopes.CALLBACK + "')")
    public ResponseEntity onSaasDeProvisioning(@RequestBody String payload) {
        ResponseEntity response;
        try {
            logger.debug("onSaasDeProvisioning Payload recieved = {}", payload);
            String targetInstanceId = new ProvisioningBodyParser().getInstanceIdFromBody(payload);
            logger.debug("onSaasDeProvisioning extracted instanceId = {}", targetInstanceId);
            String consumerIdentityZoneId = new ProvisioningBodyParser().getSubscribedTenantIdFromBody(payload);
            logger.debug("onSaasDeProvisioning called with tenant Id = {}", consumerIdentityZoneId);
            String targetContextId =  new ProvisioningBodyParser().getTargetContextIdFromBody(payload);
            logger.debug("onSaasDeProvisioning called with targetContextId = {}", targetContextId);


            Scenario senario = securityService.getScenarioId(targetInstanceId);

            if (senario != SecurityUtil.Scenario.APOLLO) {
                tenantOperationsService.deleteTenant(consumerIdentityZoneId, targetInstanceId);
                response = ResponseEntity.ok().build();
            } else {
                //cf provider unsubscribe
                String tenantId = securityService.extractIdentityZoneIdFromJwt();
                UnsubscribeResponse status = tenantOperationsService.unsubscribeCFProvider(consumerIdentityZoneId, targetInstanceId, tenantId, targetContextId);
                response = ResponseEntity.status(status.getStatusCode()).build();
            }

        } catch (NoSuchFieldException | IOException | RuntimeException e) {
            logger.error("onSaasDeProvisioning error :" + e.getMessage(), e);
            response = ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();
        }
        return response;
    }

pseudo:
            if (senario != SecurityUtil.Scenario.APOLLO) {
                tenantOperationsService.deleteTenant(consumerIdentityZoneId, targetInstanceId);
                // get autorized providers (don't filter portal instance
                // Check if at least one of WORKZONE, LAUNCHPAD, PORTAL instance IDs
                // if not, fire DELETE batch to CDM store to delete
                // helium instance provider entity
                response = ResponseEntity.ok().build();
            } else {


                    1.20.5.4.2.1 Get subscribed providers
                    check w/ jawad
    /Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
    three options:
    a. check isSubscribed for PORTAL/WORKZONE/LAUNCHPAD
    @Override
    public boolean isSubscribed(String identityZoneId, String instanceId) {
       return jdbcTemplate.queryForObject(SELECT_COUNT_IS_SUBSCRIBED, new Object[] {identityZoneId, instanceId} , Integer.class) > 0 ;
    }

    private static String SELECT_COUNT_IS_SUBSCRIBED = "SELECT count(*) FROM " + TENANT_INFO_TABLE +  " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"INSTANCE_ID\" = ? AND  \"ORG_ID\" = '' AND \"SPACE_ID\" = '' ";

    to get PORTAL/WORKZONE/LAUNCHPAD instance IDs
    /Users/i500695/work/SAP/git/portal-platform-commons/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
    ...
    public static String getPortalInstanceId() {
        String portalInstanceId = getGeneralConfigurationCredentials().get(PORTAL_INSTANCE_ID).toString();
        if (portalInstanceId != null) {
            logger.debug("portalInstanceId: %s", portalInstanceId);
            return portalInstanceId;
        }
        return "";
    }
    add getWorkzoneInstanceId, getLaunchpadInstanceId
    

    b. get all subscribed tenants. check if PORTAL/WORKZONE/LAUNCHPAD. Not good, returns all internal providers (aka blue boxes)

    @Override
    public List<String> getSubscribedTenantIds(String identityZoneId, String providerInstanceId, List<String> instanceIds) {
        List<String> args = new ArrayList<>();
        args.addAll(Arrays.asList(identityZoneId, providerInstanceId, identityZoneId));
        args.addAll(instanceIds);
        return jdbcTemplate.query(getSelectSubscribedTenantsStatement(instanceIds), (ResultSet resultSet, int i) -> resultSet.getString("TENANT_ID"), args.toArray());
    }
    ...
    private String getSelectSubscribedTenantsStatement(List<String> instanceIds) {
        StringBuilder argumentQuestionMark = new StringBuilder();
        instanceIds.forEach(instanceId -> argumentQuestionMark.append("?,"));
        argumentQuestionMark.deleteCharAt(argumentQuestionMark.length() - 1);
        return SELECT_SUBSCRIBED_TENANTS_STATEMENT.replace(INSTANCE_IDS_PLACE_HOLDER, argumentQuestionMark.toString());
    }

    c. get authorized tenant providers 
    @Override
    public List<BaseTenant> getAuthorizedTenants(String identityZoneId, String filterByInstanceId){
        return jdbcTemplate.query(SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED, new BaseTenantRowMapper(), identityZoneId, filterByInstanceId);
    }
    

                    1.20.5.4.2.2 DELETE helium instance from CDM-store 
Fire a DELETE batch to CDM-store 

example: /Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
    private boolean performBatchDeleteEntities(List<Map> appIds, String contextType, String contextId, String identityZoneId, String instanceId) throws JsonProcessingException {
        boolean isBatchDeleteSuccess = false;

        ObjectMapper mapper = new ObjectMapper();
        ObjectNode rootNode = mapper.createObjectNode();
        ObjectNode contextNode = mapper.createObjectNode();

        contextNode.put("id", contextId);
        contextNode.put("contextType", contextType);
        rootNode.set("context", contextNode);

        ArrayNode operations = rootNode.arrayNode();
        for (int i = 0; i < appIds.size(); i++) {
            ObjectNode arrayNode = mapper.createObjectNode();
            ObjectNode metadata = mapper.createObjectNode();
            metadata.put("operation", "DELETE");
            metadata.put("id", appIds.get(i).get("id").toString());
            metadata.put("entityType", "businessapp");
            arrayNode.set("metadata", metadata);
            operations.add(arrayNode);
        }
        rootNode.set("operations", operations);

        String body = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(rootNode);
        Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
        ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);

        if (response.getStatusCode() == 200) {
            logger.info("Batch Delete entities succeeded");
            isBatchDeleteSuccess = true;
        } else {
            logger.error(String.format("Batch Delete entities failed - could not delete data from CDM store, response ended with status=%s", response.getStatusCode()));
        }

        return isBatchDeleteSuccess;
    }

                    1.20.5.4.2.3 add API to commons
PR: https://github.wdf.sap.corp/Portal-CF/portal-platform-commons/pull/105
diff:
From 24f498d469b113244f263dd098a4205b74ea3893 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Wed, 20 May 2020 10:32:56 +0300
Subject: [PATCH] Add API for extracting launchpad/workzone instance IDs

---
 .../commons/security/SecurityUtil.java        | 31 +++++++++++++++++--
 .../commons/security/SecurityUtilTest.java    | 21 +++++++++++++
 2 files changed, 50 insertions(+), 2 deletions(-)

diff --git a/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java b/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
index 8d4d96d..46e4f2a 100644
--- a/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
+++ b/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
@@ -39,10 +39,37 @@ public String getScenarioId() {
     public static String getPortalInstanceId() {
         String portalInstanceId = getGeneralConfigurationCredentials().get(PORTAL_INSTANCE_ID).toString();
         if (portalInstanceId != null) {
-            logger.debug("portalInstanceId: %s", portalInstanceId);
+            logger.debug(String.format("portalInstanceId: %s", portalInstanceId));
             return portalInstanceId;
         }
-        return "";
+        else {
+            logger.debug(String.format("Could not obtain portalInstanceId value when reading configuration key %s", PORTAL_INSTANCE_ID));
+            return "";
+        }
+    }
+
+    public static String getLaunchpadInstanceId() {
+        String launchpadInstanceId = getGeneralConfigurationCredentials().get(LAUNCHPAD_INSTANCE_ID).toString();
+        if (launchpadInstanceId != null) {
+            logger.debug(String.format("launchpadInstanceId: %s", launchpadInstanceId));
+            return launchpadInstanceId;
+        }
+        else {
+            logger.debug(String.format("Could not obtain launchpadInstanceId value when reading configuration key %s", LAUNCHPAD_INSTANCE_ID));
+            return "";
+        }
+    }
+
+    public static String getWorkzoneInstanceId() {
+        String workzoneInstanceId = getGeneralConfigurationCredentials().get(WORKZONE_INSTANCE_ID).toString();
+        if (workzoneInstanceId != null) {
+            logger.debug(String.format("workzoneInstanceId: %s", workzoneInstanceId));
+            return workzoneInstanceId;
+        }
+        else {
+            logger.debug(String.format("Could not obtain workzoneInstanceId value when reading configuration key %s", WORKZONE_INSTANCE_ID));
+            return "";
+        }
     }
 
     /**
diff --git a/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java b/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
index 6f7cb0c..64ca051 100644
--- a/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
+++ b/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
@@ -20,6 +20,27 @@
     public final EnvironmentVariables environmentVariables
             = new EnvironmentVariables();
 
+    @Test
+    public void getPortalInstanceId_test() throws IOException {
+        String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");
+        environmentVariables.set("VCAP_SERVICES", vcapServicesMock);
+        Assert.assertEquals("b0f01a0c-62c8-4cfb-a105-2566fb2f55ff", SecurityUtil.getPortalInstanceId());
+    }
+
+    @Test
+    public void getLaunchpadInstanceId_test() throws IOException {
+        String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");
+        environmentVariables.set("VCAP_SERVICES", vcapServicesMock);
+        Assert.assertEquals("50228b80-b7f4-4654-8fc5-3cda193fcc74", SecurityUtil.getLaunchpadInstanceId());
+    }
+
+    @Test
+    public void getWorkzoneInstanceId_test() throws IOException {
+        String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");
+        environmentVariables.set("VCAP_SERVICES", vcapServicesMock);
+        Assert.assertEquals("ce9f4ac6-27ca-4695-b461-05b5c13ff40c", SecurityUtil.getWorkzoneInstanceId());
+    }
+
     @Test
     public void isPortalScenario_test() throws IOException {
         String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");

artifact nexus location: https://nexusrel.wdf.sap.corp:8443/nexus/#nexus-search;quick~portal.platform.commons.cf
artifact. 1.0.0-20200520082857_b165efddcd6e8914ba6cd7a8623db76f015fd99e

                    1.20.5.4.2.4 Add helium provider PR
                    https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/153/files

From 6e7fd2d17577daeca23a912a32ba744aa7eea588 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Wed, 20 May 2020 15:56:49 +0300
Subject: [PATCH 1/8] add helium like provider-Provisioning impl

---
 manifest-dev.yml                              |  1 +
 .../service/TenantOperationsService.java      | 16 ++++++++++++-
 .../webaccess/TenantsControllerIT.java        | 24 ++++++++++++++++---
 .../test/resources/tenant_id_response.json    |  1 +
 .../tenant_ids_with_helium_response.json      |  1 +
 5 files changed, 39 insertions(+), 4 deletions(-)
 create mode 100644 tenant.provisioning/src/test/resources/tenant_id_response.json
 create mode 100644 tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json

diff --git a/manifest-dev.yml b/manifest-dev.yml
index 45b02a82..62867024 100644
--- a/manifest-dev.yml
+++ b/manifest-dev.yml
@@ -18,6 +18,7 @@ applications:
     APPENDER: STDOUT-JSON
     POSTGRES_INSTANCE_NAME: portal-postgres-dt
     SPRING_PROFILES_ACTIVE: cloud
+    HELIUM_LIKE_TOGGLE: true
   services:
 #    # bind application to these services
     #Services created during deployment
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 8c31fb13..5463c015 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -36,6 +36,7 @@
 
     private static final String TECHNICAL_USER = "technicalUser";
     private static final String EVERYONE_ROLE_BATCH_CREATE;
+    private static final String HELIUM_INSTANCE = "SAAS_APPROUTER_HTML5_APP_REPO";
     @Autowired
     private ITenantRepository tenantDao;
 
@@ -92,7 +93,20 @@ public void deleteTenant(String tenantId, String instanceId) {
 
     @Override
     public List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) {
-        return tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId);
+        //check feature toggle if turnned on
+        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
+            return tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId);
+        } else {
+            List<String> authorizedTenantIds = new ArrayList<>();
+            try {
+                authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
+                authorizedTenantIds.add(Utils.constructHashOf(identityZoneId, HELIUM_INSTANCE));
+
+            } catch (NoSuchAlgorithmException e) {
+                logger.error(e.getMessage(), e);
+            }
+            return authorizedTenantIds;
+        }
     }
 
     @Override
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index a2fac8b8..b78c44f1 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -123,13 +123,31 @@ public void getProvidersTenantsIDs_Test() throws Exception {
                 .content(payload))
                 .andExpect(status().isOk());
 
-        String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
-
 
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone","tenantId2").contentType(MediaType.APPLICATION_JSON));
         result1 = result1.andExpect(status().isOk());
-        result1 = result1.andExpect(content().json(payloadInDB));
+        String payloadInDB;
+        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
+            payloadInDB = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
+            result1 = result1.andExpect(content().json("[]"));
+        } else {
+            payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_with_helium_response.json"), "UTF-8");
+            result1 = result1.andExpect(content().json(payloadInDB));
+        }
+
+    }
+
+    @Test
+    public void getHeliumLikeTenantId_Test() throws Exception {
+        String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
+        ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
+        result1 = result1.andExpect(status().isOk());
 
+        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
+            result1 = result1.andExpect(content().json("[]"));
+        } else {
+             result1 = result1.andExpect(content().json(payloadInDB));
+        }
     }
 
     @Test
diff --git a/tenant.provisioning/src/test/resources/tenant_id_response.json b/tenant.provisioning/src/test/resources/tenant_id_response.json
new file mode 100644
index 00000000..c91be2ef
--- /dev/null
+++ b/tenant.provisioning/src/test/resources/tenant_id_response.json
@@ -0,0 +1 @@
+["86a7a9a7888a131bc58261e157dd3326"]
\ No newline at end of file
diff --git a/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json b/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json
new file mode 100644
index 00000000..5618a163
--- /dev/null
+++ b/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json
@@ -0,0 +1 @@
+["7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce", "86a7a9a7888a131bc58261e157dd3326"]
\ No newline at end of file

From 329b377aef6a6b7b11a383bb07cf83cf0663c985 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Thu, 21 May 2020 15:41:35 +0300
Subject: [PATCH 2/8] fix cr comments

---
 manifest-concourse.yml                        |  1 +
 manifest-dev.yml                              |  2 +-
 .../portal/tenant/provisioning/Constants.java |  6 ++++
 .../service/TenantOperationsService.java      | 30 +++++++++++--------
 .../webaccess/TenantsControllerIT.java        | 16 +++++-----
 5 files changed, 35 insertions(+), 20 deletions(-)
 create mode 100644 tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java

diff --git a/manifest-concourse.yml b/manifest-concourse.yml
index 23cbb872..25af8654 100644
--- a/manifest-concourse.yml
+++ b/manifest-concourse.yml
@@ -22,6 +22,7 @@ common_env:
   TARGET_RUNTIME: tomee
   APPENDER: STDOUT-JSON
   SPRING_PROFILES_ACTIVE: cloud
+  HTML5_APP_REPO_TOGGLE: false
   POSTGRES_INSTANCE_NAME: portal-postgres-dt
   CF_APP_LOG_LEVEL: (( valid(.context.config.cf.log_level) ? .context.config.cf.log_level :"error" ))
 dev_env:
diff --git a/manifest-dev.yml b/manifest-dev.yml
index 62867024..4c42e481 100644
--- a/manifest-dev.yml
+++ b/manifest-dev.yml
@@ -18,7 +18,7 @@ applications:
     APPENDER: STDOUT-JSON
     POSTGRES_INSTANCE_NAME: portal-postgres-dt
     SPRING_PROFILES_ACTIVE: cloud
-    HELIUM_LIKE_TOGGLE: true
+    HTML5_APP_REPO_TOGGLE: false
   services:
 #    # bind application to these services
     #Services created during deployment
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java
new file mode 100644
index 00000000..c62dc03b
--- /dev/null
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java
@@ -0,0 +1,6 @@
+package com.sap.portal.tenant.provisioning;
+
+public interface Constants {
+
+    String HTML5_APP_REPO_INSTANCE = "SAAS_APPROUTER_HTML5_APP_REPO";
+}
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 5463c015..76a9926b 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -1,5 +1,7 @@
 package com.sap.portal.tenant.provisioning.service;
 
+import com.sap.portal.tenant.provisioning.Constants;
+import org.springframework.dao.DataAccessException;
 import com.fasterxml.jackson.core.JsonProcessingException;
 import com.fasterxml.jackson.databind.ObjectMapper;
 import com.fasterxml.jackson.databind.node.ArrayNode;
@@ -36,7 +38,6 @@
 
     private static final String TECHNICAL_USER = "technicalUser";
     private static final String EVERYONE_ROLE_BATCH_CREATE;
-    private static final String HELIUM_INSTANCE = "SAAS_APPROUTER_HTML5_APP_REPO";
     @Autowired
     private ITenantRepository tenantDao;
 
@@ -93,20 +94,25 @@ public void deleteTenant(String tenantId, String instanceId) {
 
     @Override
     public List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) {
-        //check feature toggle if turnned on
-        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
-            return tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId);
-        } else {
-            List<String> authorizedTenantIds = new ArrayList<>();
-            try {
-                authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
-                authorizedTenantIds.add(Utils.constructHashOf(identityZoneId, HELIUM_INSTANCE));
+        List<String> authorizedTenantIds = new ArrayList<>();
+
+        try {
+            authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
 
-            } catch (NoSuchAlgorithmException e) {
-                logger.error(e.getMessage(), e);
+            String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
+            if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
+                logger.debug("HTML5_APP_REPO_TOGGLE feature toggle is turnned on");
+                this.addAuthorizedProvider(authorizedTenantIds, identityZoneId, Constants.HTML5_APP_REPO_INSTANCE);
             }
-            return authorizedTenantIds;
+        } catch (NoSuchAlgorithmException | DataAccessException e) {
+            logger.error(String.format("HTML5_APP_REPO tenant ID hash operation failed because of %s", e.getMessage()));
         }
+        return authorizedTenantIds;
+    }
+
+    private void addAuthorizedProvider(List<String> authorizedTenantIds, String identityZoneId, String providerTenantId) throws NoSuchAlgorithmException {
+        logger.debug("add provider instance");
+        authorizedTenantIds.add(Utils.constructHashOf(identityZoneId, providerTenantId));
     }
 
     @Override
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index b78c44f1..526fe938 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -127,12 +127,13 @@ public void getProvidersTenantsIDs_Test() throws Exception {
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone","tenantId2").contentType(MediaType.APPLICATION_JSON));
         result1 = result1.andExpect(status().isOk());
         String payloadInDB;
-        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
-            payloadInDB = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
-            result1 = result1.andExpect(content().json("[]"));
-        } else {
+
+        String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
+        if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
             payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_with_helium_response.json"), "UTF-8");
             result1 = result1.andExpect(content().json(payloadInDB));
+        } else {
+            result1 = result1.andExpect(content().json("[]"));
         }
 
     }
@@ -143,10 +144,11 @@ public void getHeliumLikeTenantId_Test() throws Exception {
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
         result1 = result1.andExpect(status().isOk());
 
-        if(System.getenv("HELIUM_LIKE_TOGGLE") != null && System.getenv("HELIUM_LIKE_TOGGLE").equals(true)) {
-            result1 = result1.andExpect(content().json("[]"));
+        String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
+        if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
+            result1 = result1.andExpect(content().json(payloadInDB));
         } else {
-             result1 = result1.andExpect(content().json(payloadInDB));
+            result1 = result1.andExpect(content().json("[]"));
         }
     }
 

From 66792724852989cec9a193daf7193dd9fa5d4706 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Thu, 21 May 2020 16:27:10 +0300
Subject: [PATCH 3/8] fix failinf test

---
 .../tenant/provisioning/webaccess/TenantsControllerIT.java       | 1 +
 1 file changed, 1 insertion(+)

diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index 526fe938..02abefd7 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -133,6 +133,7 @@ public void getProvidersTenantsIDs_Test() throws Exception {
             payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_with_helium_response.json"), "UTF-8");
             result1 = result1.andExpect(content().json(payloadInDB));
         } else {
+            payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
             result1 = result1.andExpect(content().json("[]"));
         }
 

From ed3467bf0e8bbbc4a4dba733c28c2c0a228d4b37 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Thu, 21 May 2020 16:50:40 +0300
Subject: [PATCH 4/8] fix failing test

---
 .../tenant/provisioning/webaccess/TenantsControllerIT.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index 02abefd7..e1c6848f 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -134,7 +134,7 @@ public void getProvidersTenantsIDs_Test() throws Exception {
             result1 = result1.andExpect(content().json(payloadInDB));
         } else {
             payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
-            result1 = result1.andExpect(content().json("[]"));
+            result1 = result1.andExpect(content().json(payloadInDB));
         }
 
     }

From 63fbb3152025ca9f00f7ca23622456732c90b580 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Sun, 24 May 2020 14:22:09 +0300
Subject: [PATCH 5/8] fix cr comments and add more tests

---
 manifest.yml                                  |  1 +
 tenant.provisioning/pom.xml                   | 12 +++++
 .../portal/tenant/provisioning/Constants.java |  4 +-
 .../service/TenantOperationsService.java      |  2 +-
 .../webaccess/TenantsControllerIT.java        | 44 +++++++++++--------
 5 files changed, 42 insertions(+), 21 deletions(-)

diff --git a/manifest.yml b/manifest.yml
index 9bcf85cb..d8588936 100644
--- a/manifest.yml
+++ b/manifest.yml
@@ -14,6 +14,7 @@ applications:
     TARGET_RUNTIME: tomee
     POSTGRES_INSTANCE_NAME: portal-postgres-dt
     SPRING_PROFILES_ACTIVE: cloud
+    HTML5_APP_REPO_TOGGLE: false
     # Change to STDOUT-JSON for kibana logs format
     APPENDER: STDOUT-JSON
   services:
diff --git a/tenant.provisioning/pom.xml b/tenant.provisioning/pom.xml
index a4395fc9..633ea743 100644
--- a/tenant.provisioning/pom.xml
+++ b/tenant.provisioning/pom.xml
@@ -23,6 +23,18 @@
       <groupId>org.springframework</groupId>
       <artifactId>spring-context</artifactId>
     </dependency>
+    <dependency>
+			<groupId>com.github.stefanbirkner</groupId>
+			<artifactId>system-rules</artifactId>
+			<version>1.19.0</version>
+			<scope>test</scope>
+			<exclusions>
+				<exclusion>
+					<groupId>junit</groupId>
+					<artifactId>junit-dep</artifactId>
+				</exclusion>
+			</exclusions>
+		</dependency>
     <dependency>
       <groupId>org.springframework</groupId>
       <artifactId>spring-jdbc</artifactId>
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java
index c62dc03b..156ed1ca 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/Constants.java
@@ -1,6 +1,6 @@
 package com.sap.portal.tenant.provisioning;
 
-public interface Constants {
+public final class Constants {
 
-    String HTML5_APP_REPO_INSTANCE = "SAAS_APPROUTER_HTML5_APP_REPO";
+    public final static String HTML5_APP_REPO_INSTANCE = "SAAS_APPROUTER_HTML5_APP_REPO";
 }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 76a9926b..e4eb1a58 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -100,7 +100,7 @@ public void deleteTenant(String tenantId, String instanceId) {
             authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
 
             String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
-            if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
+            if(html5AppRepoToggle != null && html5AppRepoToggle.equals("true")) {
                 logger.debug("HTML5_APP_REPO_TOGGLE feature toggle is turnned on");
                 this.addAuthorizedProvider(authorizedTenantIds, identityZoneId, Constants.HTML5_APP_REPO_INSTANCE);
             }
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index e1c6848f..40786442 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -5,6 +5,7 @@
 import org.apache.commons.io.IOUtils;
 import org.junit.Before;
 import org.junit.FixMethodOrder;
+import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.junit.runners.MethodSorters;
@@ -19,6 +20,8 @@
 import org.springframework.test.jdbc.JdbcTestUtils;
 import org.springframework.test.web.servlet.MockMvc;
 import org.springframework.test.web.servlet.ResultActions;
+import org.junit.contrib.java.lang.system.EnvironmentVariables;
+
 
 import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
 import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
@@ -44,6 +47,9 @@
     @Autowired
     private ITenantOperationsService tenantOperationsService;
 
+    @Rule
+    public final EnvironmentVariables environmentVariables = new EnvironmentVariables();
+
     @Before
     public void before() throws Exception {
 
@@ -123,34 +129,36 @@ public void getProvidersTenantsIDs_Test() throws Exception {
                 .content(payload))
                 .andExpect(status().isOk());
 
-
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "false");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone","tenantId2").contentType(MediaType.APPLICATION_JSON));
         result1 = result1.andExpect(status().isOk());
-        String payloadInDB;
-
-        String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
-        if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
-            payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_with_helium_response.json"), "UTF-8");
-            result1 = result1.andExpect(content().json(payloadInDB));
-        } else {
-            payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
-            result1 = result1.andExpect(content().json(payloadInDB));
-        }
-
+        String payloadInDB = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
+        result1.andExpect(content().json(payloadInDB));
     }
 
     @Test
     public void getHeliumLikeTenantId_Test() throws Exception {
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
+        String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
+        ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
+        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(content().json(payloadInDB));
+    }
+
+    @Test
+    public void verifyHeliumLikeFeatureToggle_Test() throws Exception {
+        //Turn on feature toggle
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
         result1 = result1.andExpect(status().isOk());
+        result1.andExpect(content().json(payloadInDB));
 
-        String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
-        if(html5AppRepoToggle != null && html5AppRepoToggle.equals(true)) {
-            result1 = result1.andExpect(content().json(payloadInDB));
-        } else {
-            result1 = result1.andExpect(content().json("[]"));
-        }
+        //Turn off feature toggle
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "false");
+        result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
+        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(content().json("[]"));
     }
 
     @Test

From 1377e3bfc62bcacf41457793b316081045e2fd92 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Sun, 24 May 2020 14:45:36 +0300
Subject: [PATCH 6/8] Remove file

---
 .../src/test/resources/tenant_ids_with_helium_response.json      | 1 -
 1 file changed, 1 deletion(-)
 delete mode 100644 tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json

diff --git a/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json b/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json
deleted file mode 100644
index 5618a163..00000000
--- a/tenant.provisioning/src/test/resources/tenant_ids_with_helium_response.json
+++ /dev/null
@@ -1 +0,0 @@
-["7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce", "86a7a9a7888a131bc58261e157dd3326"]
\ No newline at end of file

From 5b9c10855c1ee23c9443b24024569aa6fa1e359c Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Sun, 24 May 2020 17:17:25 +0300
Subject: [PATCH 7/8] two minor changes

---
 .../provisioning/service/TenantOperationsService.java     | 2 +-
 .../provisioning/webaccess/TenantsControllerIT.java       | 8 ++++----
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index e4eb1a58..e2ce3c15 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -111,7 +111,7 @@ public void deleteTenant(String tenantId, String instanceId) {
     }
 
     private void addAuthorizedProvider(List<String> authorizedTenantIds, String identityZoneId, String providerTenantId) throws NoSuchAlgorithmException {
-        logger.debug("add provider instance");
+        logger.debug(String.format("add provider %s instance", providerTenantId));
         authorizedTenantIds.add(Utils.constructHashOf(identityZoneId, providerTenantId));
     }
 
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index 40786442..d68689de 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -131,7 +131,7 @@ public void getProvidersTenantsIDs_Test() throws Exception {
 
         environmentVariables.set("HTML5_APP_REPO_TOGGLE", "false");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone","tenantId2").contentType(MediaType.APPLICATION_JSON));
-        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(status().isOk());
         String payloadInDB = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_response.json"), "UTF-8");
         result1.andExpect(content().json(payloadInDB));
     }
@@ -141,7 +141,7 @@ public void getHeliumLikeTenantId_Test() throws Exception {
         environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
-        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(status().isOk());
         result1.andExpect(content().json(payloadInDB));
     }
 
@@ -151,13 +151,13 @@ public void verifyHeliumLikeFeatureToggle_Test() throws Exception {
         environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
-        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(status().isOk());
         result1.andExpect(content().json(payloadInDB));
 
         //Turn off feature toggle
         environmentVariables.set("HTML5_APP_REPO_TOGGLE", "false");
         result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
-        result1 = result1.andExpect(status().isOk());
+        result1.andExpect(status().isOk());
         result1.andExpect(content().json("[]"));
     }
 

From 4340f98f7f6775dac4699f6687c86e9fafdf5ea8 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Sun, 24 May 2020 17:59:29 +0300
Subject: [PATCH 8/8] one more test was added

---
 .../webaccess/TenantsControllerIT.java        | 23 +++++++++++++++++++
 .../tenant_ids_withHelium_response.json       |  1 +
 2 files changed, 24 insertions(+)
 create mode 100644 tenant.provisioning/src/test/resources/tenant_ids_withHelium_response.json

diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
index d68689de..998af794 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerIT.java
@@ -138,6 +138,29 @@ public void getProvidersTenantsIDs_Test() throws Exception {
 
     @Test
     public void getHeliumLikeTenantId_Test() throws Exception {
+        //paas no ploan
+        String payload = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("paas_bind_payload_2.json"), "UTF-8");
+        mockMvc.perform(post("/provisioning_service/provisioning/tenant/bind").header("identityZone","IZ2")
+                .contentType(MediaType.APPLICATION_JSON)
+                .content(payload))
+                .andExpect(status().isOk());
+
+        // bind
+        payload = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("saas_subscription_payload_paas_2.json"), "UTF-8");
+        mockMvc.perform(post("/provisioning_service/provisioning/tenant/subscription")
+                .contentType(MediaType.APPLICATION_JSON)
+                .content(payload))
+                .andExpect(status().isOk());
+
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
+        ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone","tenantId2").contentType(MediaType.APPLICATION_JSON));
+        result1.andExpect(status().isOk());
+        String payloadInDB = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_ids_withHelium_response.json"), "UTF-8");
+        result1.andExpect(content().json(payloadInDB));
+    }
+
+    @Test
+    public void getHeliumLikeTenantIdWhenNoSubscription_Test() throws Exception {
         environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         String payloadInDB  = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("tenant_id_response.json"), "UTF-8");
         ResultActions result1 = mockMvc.perform(get("/provisioning_service/tenants/ids").header("identityZone", "tenantId2").contentType(MediaType.APPLICATION_JSON));
diff --git a/tenant.provisioning/src/test/resources/tenant_ids_withHelium_response.json b/tenant.provisioning/src/test/resources/tenant_ids_withHelium_response.json
new file mode 100644
index 00000000..c75dd233
--- /dev/null
+++ b/tenant.provisioning/src/test/resources/tenant_ids_withHelium_response.json
@@ -0,0 +1 @@
+["86a7a9a7888a131bc58261e157dd3326","41d7e68aa508ecf0296cd83aa96f67ce"]
\ No newline at end of file

                    1.20.5.4.2.5 data termination PR
https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/155

From 58e526da6476357e5e0c06e33e709e9823e0b20a Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 24 May 2020 13:28:55 +0300
Subject: [PATCH 1/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 pom.xml                                       |   2 +-
 .../config/security/ISecurityService.java     |   2 +
 .../config/security/SecurityService.java      |   8 ++
 .../security/mock/SecurityServiceMock.java    |   8 ++
 .../service/ITenantOperationsService.java     |   4 +-
 .../service/TenantOperationsService.java      | 121 ++++++++++++++++--
 .../webaccess/ProvisioningController.java     |   3 +-
 .../config/security/SecurityServiceTest.java  |  28 +++-
 .../service/TenantOperationsServiceTest.java  |  28 +++-
 .../webaccess/ProvisioningControllerTest.java |   8 +-
 10 files changed, 190 insertions(+), 22 deletions(-)

diff --git a/pom.xml b/pom.xml
index da8b7ca9..59625e92 100644
--- a/pom.xml
+++ b/pom.xml
@@ -35,7 +35,7 @@
     <failOnMissingWebXml>false</failOnMissingWebXml>
     <org.whitesource.productVersion>0.0.1</org.whitesource.productVersion>
     <vulas.shared.backend.serviceUrl>https://vulas.tools.sap/backend</vulas.shared.backend.serviceUrl>
-    <commons.platform.version>1.0.0-20200511100541_d63d6e80ee90e2a60627f7790855da8663c7d016</commons.platform.version>
+    <commons.platform.version>1.0.0-20200520082857_b165efddcd6e8914ba6cd7a8623db76f015fd99e</commons.platform.version>
     <vulas.version>3.0.16</vulas.version>
   </properties>
   <dependencies>
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/ISecurityService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/ISecurityService.java
index 9386e378..94567568 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/ISecurityService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/ISecurityService.java
@@ -9,6 +9,8 @@
     String extractIdentityZoneIdFromJwt();
     String extractInstanceIdFromJwt();
     String getPortalInstanceId();
+    String getLaunchpadInstanceId();
+    String getWorkzoneInstanceId();
     boolean isPortalScenario(String instanceId);
     boolean isLaunchpadScenario(String instanceId);
     boolean isWorkZoneScenario(String instanceId);
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/SecurityService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/SecurityService.java
index 3b509360..d71848d7 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/SecurityService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/SecurityService.java
@@ -66,6 +66,14 @@ public String getPortalInstanceId() {
         return SecurityUtil.getPortalInstanceId();
     }
 
+    public String getLaunchpadInstanceId() {
+        return SecurityUtil.getLaunchpadInstanceId();
+    }
+
+    public String getWorkzoneInstanceId() {
+        return SecurityUtil.getWorkzoneInstanceId();
+    }
+
     public boolean isPortalScenario(String instanceId) {
         return SecurityUtil.isPortalScenario(instanceId);
     }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/mock/SecurityServiceMock.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/mock/SecurityServiceMock.java
index 29999ce1..46da50be 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/mock/SecurityServiceMock.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/config/security/mock/SecurityServiceMock.java
@@ -39,6 +39,14 @@ public String getPortalInstanceId() {
         return "portalInstanceId";
     }
 
+    public String getLaunchpadInstanceId() {
+        return "launchpadInstanceId";
+    }
+
+    public String getWorkzoneInstanceId() {
+        return "workzoneInstanceId";
+    }
+
     public boolean isPortalScenario(String instanceId) {
         return isPortalScenario;
     }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
index cb32cc7f..b7ddc313 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
@@ -8,6 +8,7 @@
 public interface ITenantOperationsService {
 
     void deleteTenant(String identityZoneId, String instanceId) throws IllegalArgumentException;
+    void deleteTenantAndLocalHTML5Provider(String identityZoneId, String instanceId) throws IllegalArgumentException;
     UnsubscribeResponse unsubscribeCFProvider(String identityZone, String instanceId, String tenantId, String targetContextId) throws IllegalArgumentException;
     void createTenant(String identityZoneId, String instanceId, String plan, String orgGuid, String spaceGuid) throws IllegalArgumentException;
     Tenant retrieve(String identityZoneId, String instanceId) throws IllegalArgumentException;
@@ -17,4 +18,5 @@
     List<BaseTenant> getSubscribedTenants(String identityZoneId, String providerInstanceId, List<String> instanceIds) throws IllegalArgumentException;
     boolean validateTrust(String identityZoneId, String scenarioInstanceId, String providerTenantId);
     boolean isSubscribed(String identityZoneId, String instanceId);
-}
+
+    }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 8c31fb13..2b76a115 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -74,22 +74,50 @@ public Tenant retrieve(String identityZoneId, String instanceId) {
         return tenantDao.retrieve(tenantId);
     }
 
-    @Override
-    public void deleteTenant(String tenantId, String instanceId) {
+    private void deleteTenantImpl(String tenantId, String instanceId, boolean deleteHtml5LocalProvider) {
+        logger.debug(String.format("deleteTenantImpl(tenantId=%s, instanceId=%s, deleteHtml5LocalProvider=%b", tenantId, instanceId, deleteHtml5LocalProvider));
         ITransactionalAuditLogPortalMessage auditLogPortalMessage = null;
         try {
             auditLogPortalMessage = prepareDeleteAllTenantDataLogMessage(tenantId, instanceId);
             auditLogPortalMessage.prepare();
             deleteTenantData(tenantId, instanceId);
+            if (deleteHtml5LocalProvider) {
+                logger.debug("deleteTenantImpl() checking scenario subscription status");
+                if (!this.isSubscribedToScenario(tenantId)) {
+                    logger.debug("deleteTenantImpl() deleting Html5 Local Provider");
+                    if (this.deleteHtml5InternalProvider(tenantId, instanceId)) {
+                        logger.debug("deleteTenantImpl() Html5 Local Provider deleted");
+                    } else {
+                        logger.warn("deleteTenantImpl() Html5 Local Provider deletion has failed");
+                    }
+                }
+                else {
+                    logger.debug("deleteTenantImpl() checking scenario subscription intact. Keeping Html5 Local Provider");
+                }
+            }
             auditLogPortalMessage.logSuccess();
         } catch (AuditLoggerException e) {
-            logger.warn("Audit log is not bound or has issues!", e.getMessage());
+            logger.warn(String.format("Audit log is not bound or has issues! %s", e.getMessage()));
         } catch (RuntimeException e) {
-            auditLogPortalMessage.logFailure();
-            throw e;
+            if (auditLogPortalMessage != null) {
+                auditLogPortalMessage.logFailure();
+                throw e;
+            }
         }
     }
 
+    @Override
+    public void deleteTenantAndLocalHTML5Provider(String tenantId, String instanceId) {
+        logger.debug(String.format("deleteTenantAndLocalHTML5Provider(tenantId=%s, instanceId=%s", tenantId, instanceId));
+        deleteTenantImpl(tenantId, instanceId, true);
+    }
+
+    @Override
+    public void deleteTenant(String tenantId, String instanceId) {
+        logger.debug(String.format("deleteTenant(tenantId=%s, instanceId=%s", tenantId, instanceId));
+        deleteTenantImpl(tenantId, instanceId, false);
+    }
+
     @Override
     public List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) {
         return tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId);
@@ -117,10 +145,16 @@ public boolean validateTrust(String identityZoneId, String scenarioInstanceId, S
     }
 
     @Override
-    public boolean isSubscribed(String identityZoneId, String instanceId){
+    public boolean isSubscribed(String identityZoneId, String instanceId) {
         return tenantDao.isSubscribed(identityZoneId, instanceId);
     }
 
+    private boolean isSubscribedToScenario(String identityZoneId) {
+        return tenantDao.isSubscribed(identityZoneId, securityService.getPortalInstanceId()) ||
+                tenantDao.isSubscribed(identityZoneId, securityService.getLaunchpadInstanceId()) ||
+                tenantDao.isSubscribed(identityZoneId, securityService.getWorkzoneInstanceId());
+    }
+
     private void removeSubscription(String identityZoneId, String instanceId) {
         String tenantId = Optional.ofNullable(retrieveTenantId(identityZoneId, instanceId))
                 .orElseThrow(() -> new IllegalArgumentException("can't construct Tenant"));
@@ -190,10 +224,23 @@ private boolean deleteCdmStoreTenantData(String identityZoneId, String instanceI
         return succeeded;
     }
 
+
+    private boolean deleteHtml5InternalProvider(String identityZoneId, String instanceId) {
+        // aka delete helium like provider
+        // ToDo, take SAAS_APPROUTER_HTML5_APP_REPO from consts
+        boolean bResponse = false;
+        try {
+            bResponse = this.performBatchDeleteEntity("SAAS_APPROUTER_HTML5_APP_REPO", "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
+        } catch (JsonProcessingException jpe) {
+            logger.warn(String.format("deleteHtml5InternalProvider() exception %s", jpe.getMessage()));
+        }
+        return bResponse;
+    }
+
     @Override
     public UnsubscribeResponse unsubscribeCFProvider(String consumerIdentityZone, String targetInstanceId, String tenantId, String targetContextId) {
         ITransactionalAuditLogPortalMessage auditLogPortalMessage = null;
-        UnsubscribeResponse isUnsubscribeStatus =  UnsubscribeResponse.FAILED;
+        UnsubscribeResponse isUnsubscribeStatus = UnsubscribeResponse.FAILED;
         try {
             auditLogPortalMessage = prepareUnsubscribeCFProviderLogMessage(consumerIdentityZone, targetInstanceId, tenantId);
             auditLogPortalMessage.prepare();
@@ -211,7 +258,7 @@ public UnsubscribeResponse unsubscribeCFProvider(String consumerIdentityZone, St
         } catch (IOException e) {
             throw new RuntimeException();
         }
-         return isUnsubscribeStatus;
+        return isUnsubscribeStatus;
     }
 
     private UnsubscribeResponse unsubscribeCFProviderByContextId(String identityZoneId, String targetInstanceId, String targetContextId) throws IOException {
@@ -222,7 +269,7 @@ private UnsubscribeResponse unsubscribeCFProviderByContextId(String identityZone
         // Get entities by target context
         String response = getEntitiesByTargetContext(targetInstanceId, targetContextId);
 
-        if(response == null) {
+        if (response == null) {
             return UnsubscribeResponse.NO_CONTENT;
         }
 
@@ -301,6 +348,62 @@ private String getEntitiesByTargetContext(String targetInstanceId, String target
         return serviceCallResponse.getResponse();
     }
 
+    private ObjectNode generateJSONRoot(ObjectMapper mapper) {
+        ObjectNode rootNode = mapper.createObjectNode();
+        return rootNode;
+    }
+
+    private ObjectNode generateJSONContext(String contextType, String contextId, ObjectMapper mapper) {
+        ObjectNode contextNode = mapper.createObjectNode();
+        contextNode.put("id", contextId);
+        contextNode.put("contextType", contextType);
+        return contextNode;
+    }
+
+    private ArrayNode generateJSONOperations(String entityType, String entityId, ObjectNode rootNode, ObjectMapper mapper) {
+        ArrayNode operations = rootNode.arrayNode();
+        ObjectNode arrayNode = mapper.createObjectNode();
+        ObjectNode metadata = mapper.createObjectNode();
+        metadata.put("operation", "DELETE");
+        metadata.put("id", entityId);
+        metadata.put("entityType", entityType);
+        arrayNode.set("metadata", metadata);
+        operations.add(arrayNode);
+
+        return operations;
+    }
+
+    private boolean performBatchDeleteEntity(String entityId, String entityType, String contextType, String contextId, String identityZoneId, String instanceId) throws JsonProcessingException {
+        logger.debug(String.format("performBatchDeleteEntity(entityId=%s, entityType=%s, contextType=%s, contextId=%s, identityZoneId=%s, instanceId=%s )", entityId, entityType, contextType, contextId, identityZoneId, instanceId));
+
+        boolean isBatchDeleteSuccess = false;
+
+        //create {}
+        ObjectMapper mapper = new ObjectMapper();
+        ObjectNode rootNode = this.generateJSONRoot(mapper);
+
+        //fill { context: {} }
+        ObjectNode contextNode = this.generateJSONContext(contextType, contextId, mapper);
+        rootNode.set("context", contextNode);
+
+        //fill { operations: {} }
+        ArrayNode operations = this.generateJSONOperations(entityType, entityId, rootNode, mapper);
+        rootNode.set("operations", operations);
+
+        String body = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(rootNode);
+        Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
+        ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);
+
+        if (response.getStatusCode() == 200) {
+            logger.info("Batch Delete entities succeeded");
+            isBatchDeleteSuccess = true;
+        } else {
+            logger.error(String.format("Batch Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", entityId, entityType, response.getStatusCode()));
+        }
+
+        return isBatchDeleteSuccess;
+    }
+
     private boolean performBatchDeleteEntities(List<Map> appIds, String contextType, String contextId, String identityZoneId, String instanceId) throws JsonProcessingException {
         boolean isBatchDeleteSuccess = false;
 
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
index 4eea15b5..1d2733fd 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
@@ -84,8 +84,9 @@ public ResponseEntity onSaasDeProvisioning(@RequestBody String payload) {
 
             Scenario senario = securityService.getScenarioId(targetInstanceId);
 
+            logger.debug("onSaasDeProvisioning current scenario = {}", targetContextId);
             if (senario != SecurityUtil.Scenario.APOLLO) {
-                tenantOperationsService.deleteTenant(consumerIdentityZoneId, targetInstanceId);
+                tenantOperationsService.deleteTenantAndLocalHTML5Provider(consumerIdentityZoneId, targetInstanceId);
                 response = ResponseEntity.ok().build();
             } else {
                 //cf provider unsubscribe
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/config/security/SecurityServiceTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/config/security/SecurityServiceTest.java
index 29591088..4db78ec1 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/config/security/SecurityServiceTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/config/security/SecurityServiceTest.java
@@ -1,5 +1,6 @@
 package com.sap.portal.tenant.provisioning.config.security;
 
+import com.sap.portal.platform.commons.security.SecurityUtil;
 import com.sap.xs2.security.container.SecurityContext;
 import com.sap.xs2.security.container.UserInfo;
 import com.sap.xs2.security.container.UserInfoException;
@@ -21,7 +22,7 @@
 import static org.powermock.api.mockito.PowerMockito.when;
 
 @RunWith(PowerMockRunner.class)
-@PrepareForTest({SecurityService.class, SecurityContext.class})
+@PrepareForTest({SecurityService.class, SecurityContext.class, SecurityUtil.class})
 public class SecurityServiceTest {
 
     @Mock
@@ -40,6 +41,31 @@ public void init() throws Exception {
         when(SecurityContext.getUserInfo()).thenReturn(userInfo);
     }
 
+    @Test
+    public void getPortalInstanceId_test() {
+        final String portalInstanceId = "portalInstanceId";
+        PowerMockito.mockStatic(SecurityUtil.class);
+        when(SecurityUtil.getPortalInstanceId()).thenReturn(portalInstanceId);
+        Assert.assertEquals(securityService.getPortalInstanceId(), portalInstanceId);
+    }
+
+    @Test
+    public void getLaunchpadInstanceId_test() {
+        final String launchpadInstanceId = "launchpadInstanceId";
+        PowerMockito.mockStatic(SecurityUtil.class);
+        when(SecurityUtil.getLaunchpadInstanceId()).thenReturn(launchpadInstanceId);
+        Assert.assertEquals(securityService.getLaunchpadInstanceId(), launchpadInstanceId);
+    }
+
+    @Test
+    public void getWorkzoneInstanceId_test() {
+        final String workzoneInstanceId = "workzoneInstanceId";
+        PowerMockito.mockStatic(SecurityUtil.class);
+        when(SecurityUtil.getWorkzoneInstanceId()).thenReturn(workzoneInstanceId);
+        Assert.assertEquals(securityService.getWorkzoneInstanceId(), workzoneInstanceId);
+    }
+
+
     @Test
     public void hasGrantTypeClientCredentials_true_test() throws Exception {
         when(userInfo.getGrantType()).thenReturn(UserInfo.GRANTTYPE_CLIENTCREDENTIAL);
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/service/TenantOperationsServiceTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/service/TenantOperationsServiceTest.java
index d2a6c13d..54c33fa6 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/service/TenantOperationsServiceTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/service/TenantOperationsServiceTest.java
@@ -16,6 +16,7 @@
 import org.junit.Test;
 import org.junit.runner.RunWith;
 import org.mockito.*;
+import org.powermock.api.mockito.PowerMockito;
 import org.powermock.core.classloader.annotations.PrepareForTest;
 import org.powermock.modules.junit4.PowerMockRunner;
 import org.springframework.web.bind.annotation.RequestMethod;
@@ -53,7 +54,7 @@
     @Before
     public void before() {
         MockitoAnnotations.initMocks(this);
-        when(serviceRequest.callService(any(),any(),any(),any(),any(),any())).thenReturn(new ServiceCallResponse("OK", 200));
+        when(serviceRequest.callService(any(), any(), any(), any(), any(), any())).thenReturn(new ServiceCallResponse("OK", 200));
         Mockito.when(securityService.isPortalScenario(Mockito.anyString())).thenReturn(true);
     }
 
@@ -151,11 +152,28 @@ public void createTenant_cdmStoreFailed_verifyException() {
         String orgId = "orgId";
         String spaceId = "spaceId";
 
-        when(serviceRequest.callService(any(),any(),any(),any(),any(),any())).thenReturn(new ServiceCallResponse("Cdm store falied", 500));
+        when(serviceRequest.callService(any(), any(), any(), any(), any(), any())).thenReturn(new ServiceCallResponse("Cdm store falied", 500));
 
         tenantOperationsService.createTenant(identityZoneId, instanceId, plan, orgId, spaceId);
     }
 
+    @Test
+    public void deleteTenantAndLocalHTML5Provider_test() {
+        String identityZoneId = java.util.UUID.randomUUID().toString();
+        String instanceId = java.util.UUID.randomUUID().toString();
+        // ToDO, followup for enabling spying on private methods
+        // final TenantOperationsService spy = PowerMockito.spy((TenantOperationsService) tenantOperationsService);
+        try {
+            Mockito.when(auditLogger.createConfigurationChangeAuditMessage(any(), any(), any(), any())).thenReturn(transactionalAuditLogPortalMessage);
+            Mockito.doNothing().when(transactionalAuditLogPortalMessage).prepare();
+            // PowerMockito.doReturn("").when(spy, "deleteTenantImpl", ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyBoolean());
+            tenantOperationsService.deleteTenantAndLocalHTML5Provider(identityZoneId, instanceId);
+            // PowerMockito.verifyPrivate(spy, times(1)).invoke("deleteTenantImpl");
+        } catch (Exception e) {
+            Assert.fail(e.getMessage());
+        }
+    }
+
     @Test
     public void deleteTenantData_successNoException() {
         String identityZoneId = java.util.UUID.randomUUID().toString();
@@ -194,7 +212,7 @@ public void unsubscribeCFProvider_successNoException() {
             ServiceCallResponse response = new ServiceCallResponse(getEntitiesByTargetContextResponse, 200);
 
             when(serviceRequest.callService(eq("/cdm_store_service/cdm/entities/sources?targetContextId=snapshot_context_id_2&targetContextType=SNAPSHOT&entityTypes=sitereferences,businessapp"),
-                   any(), any(), any(), any(), any())).thenReturn(response);
+                    any(), any(), any(), any(), any())).thenReturn(response);
 
             Tenant targetTenant = new Tenant();
             targetTenant.setIdentityZoneId("default_identityZone");
@@ -264,7 +282,7 @@ public void unsubscribeCFProvider_getEntitiesBySourceFails() {
         Mockito.when(tenantRepository.getCFProviderTenantByInstanceId(targetInstanceId)).thenReturn(targetTenant);
 
         when(serviceRequest.callService(eq("/cdm_store_service/cdm/entities/sources?targetContextId=snapshot_context_id_2&targetContextType=SNAPSHOT&entityTypes=sitereferences,businessapp"),
-                any(),any(),any(),any(),any())).thenReturn(new ServiceCallResponse("ERROR", 500));
+                any(), any(), any(), any(), any())).thenReturn(new ServiceCallResponse("ERROR", 500));
 
         tenantOperationsService.unsubscribeCFProvider(identityZone, targetInstanceId, tenantId, targetContextId);
     }
@@ -288,7 +306,7 @@ public void unsubscribeCFProvider_getEntitisBySourceResponseEmpty() throws IOExc
         Mockito.when(tenantRepository.getCFProviderTenantByInstanceId(targetInstanceId)).thenReturn(targetTenant);
 
         when(serviceRequest.callService(eq("/cdm_store_service/cdm/entities/sources?targetContextId=snapshot_context_id_2&targetContextType=SNAPSHOT&entityTypes=sitereferences,businessapp"),
-                any(),any(),any(),any(),any())).thenReturn(new ServiceCallResponse("[]", 200));
+                any(), any(), any(), any(), any())).thenReturn(new ServiceCallResponse("[]", 200));
 
         tenantOperationsService.unsubscribeCFProvider(identityZone, targetInstanceId, tenantId, targetContextId);
 
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
index 6747faa6..e56a3506 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
@@ -152,7 +152,7 @@ public void onSaasDeProvisioning_expectSuccessResponse() {
                 "    \"subscribedTenantId\" : \"%s\"\n" +
                 "}", instanceId, targetContextId, tenantId);
         ResponseEntity response = provisioningController.onSaasDeProvisioning(payload);
-        verify(tenantOperationsService, times(1)).deleteTenant(tenantId, instanceId);
+        verify(tenantOperationsService, times(1)).deleteTenantAndLocalHTML5Provider(tenantId, instanceId);
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
@@ -189,11 +189,11 @@ public void onSaasDeProvisioning_expectErrorResponse() {
                 "    \"subscribedTenantId\" : \"%s\"\n" +
                 "}", instanceId, targetContextId, tenantId);
         try {
-            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).deleteTenant(tenantId, instanceId);
+            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).deleteTenantAndLocalHTML5Provider(tenantId, instanceId);
 
             ResponseEntity response = provisioningController.onSaasDeProvisioning(payload);
 
-            verify(tenantOperationsService, times(1)).deleteTenant(tenantId, instanceId);
+            verify(tenantOperationsService, times(1)).deleteTenantAndLocalHTML5Provider(tenantId, instanceId);
             Assert.assertEquals(response.getStatusCode(), HttpStatus.INTERNAL_SERVER_ERROR);
         } catch (IllegalArgumentException e) {
             Assert.fail(e.getMessage());
@@ -241,7 +241,7 @@ public void onSaasDeProvisioningInstanceWorkZone_expectSuccessResponse() {
                 "    \"subscribedTenantId\" : \"%s\"\n" +
                 "}", instanceId, targetContextId, tenantId);
         ResponseEntity response = provisioningController.onSaasDeProvisioning(payload);
-        verify(tenantOperationsService, times(1)).deleteTenant(tenantId, instanceId);
+        verify(tenantOperationsService, times(1)).deleteTenantAndLocalHTML5Provider(tenantId, instanceId);
         verify(securityService, times(0)).extractIdentityZoneIdFromJwt();
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }

From eb6724b0d934d1a6bc0c999144cadf3e5e209efa Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 24 May 2020 13:41:01 +0300
Subject: [PATCH 2/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../tenant/provisioning/service/TenantOperationsService.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 2b76a115..4bedfc04 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -395,10 +395,10 @@ private boolean performBatchDeleteEntity(String entityId, String entityType, Str
         ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);
 
         if (response.getStatusCode() == 200) {
-            logger.info("Batch Delete entities succeeded");
+            logger.info("performBatchDeleteEntity() Delete entity succeeded");
             isBatchDeleteSuccess = true;
         } else {
-            logger.error(String.format("Batch Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", entityId, entityType, response.getStatusCode()));
+            logger.error(String.format("performBatchDeleteEntity() Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", entityId, entityType, response.getStatusCode()));
         }
 
         return isBatchDeleteSuccess;

From 018e26a1e6a79a3d3c7ec07ba9d9bd58b3156703 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 24 May 2020 13:43:23 +0300
Subject: [PATCH 3/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../provisioning/webaccess/ProvisioningController.java      | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
index 1d2733fd..b8c89664 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
@@ -82,10 +82,10 @@ public ResponseEntity onSaasDeProvisioning(@RequestBody String payload) {
             logger.debug("onSaasDeProvisioning called with targetContextId = {}", targetContextId);
 
 
-            Scenario senario = securityService.getScenarioId(targetInstanceId);
+            Scenario scenario = securityService.getScenarioId(targetInstanceId);
 
-            logger.debug("onSaasDeProvisioning current scenario = {}", targetContextId);
-            if (senario != SecurityUtil.Scenario.APOLLO) {
+            logger.debug("onSaasDeProvisioning current scenario = {}", scenario);
+            if (scenario != SecurityUtil.Scenario.APOLLO) {
                 tenantOperationsService.deleteTenantAndLocalHTML5Provider(consumerIdentityZoneId, targetInstanceId);
                 response = ResponseEntity.ok().build();
             } else {

From 6aae8b73a01298f61d92bd105b4dc62e517df8ef Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 25 May 2020 11:24:23 +0300
Subject: [PATCH 4/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../service/TenantOperationsService.java      |  3 +--
 .../webaccess/ProvisioningController.java     | 10 ++++++-
 .../webaccess/ProvisioningControllerTest.java | 27 ++++++++++++++++++-
 3 files changed, 36 insertions(+), 4 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 23a5cdf6..4b89dc7f 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -247,10 +247,9 @@ private boolean deleteCdmStoreTenantData(String identityZoneId, String instanceI
 
     private boolean deleteHtml5InternalProvider(String identityZoneId, String instanceId) {
         // aka delete helium like provider
-        // ToDo, take SAAS_APPROUTER_HTML5_APP_REPO from consts
         boolean bResponse = false;
         try {
-            bResponse = this.performBatchDeleteEntity("SAAS_APPROUTER_HTML5_APP_REPO", "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
+            bResponse = this.performBatchDeleteEntity( Constants.HTML5_APP_REPO_INSTANCE , "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
         } catch (JsonProcessingException jpe) {
             logger.warn(String.format("deleteHtml5InternalProvider() exception %s", jpe.getMessage()));
         }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
index b8c89664..4fd80b39 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningController.java
@@ -86,7 +86,15 @@ public ResponseEntity onSaasDeProvisioning(@RequestBody String payload) {
 
             logger.debug("onSaasDeProvisioning current scenario = {}", scenario);
             if (scenario != SecurityUtil.Scenario.APOLLO) {
-                tenantOperationsService.deleteTenantAndLocalHTML5Provider(consumerIdentityZoneId, targetInstanceId);
+                final String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
+                if(html5AppRepoToggle != null && html5AppRepoToggle.equals("true")) {
+                    logger.debug("HTML5_APP_REPO_TOGGLE feature toggle is on");
+                    tenantOperationsService.deleteTenantAndLocalHTML5Provider(consumerIdentityZoneId, targetInstanceId);
+                }
+                else {
+                    logger.debug("HTML5_APP_REPO_TOGGLE feature toggle is off");
+                    tenantOperationsService.deleteTenant(consumerIdentityZoneId, targetInstanceId);
+                }
                 response = ResponseEntity.ok().build();
             } else {
                 //cf provider unsubscribe
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
index e56a3506..f6809b86 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/ProvisioningControllerTest.java
@@ -6,7 +6,9 @@
 import org.apache.commons.io.IOUtils;
 import org.junit.Assert;
 import org.junit.Before;
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.contrib.java.lang.system.EnvironmentVariables;
 import org.junit.runner.RunWith;
 import org.mockito.InjectMocks;
 import org.mockito.Matchers;
@@ -43,6 +45,9 @@
     @Mock
     private IAuditLogger auditLogger;
 
+    @Rule
+    public final EnvironmentVariables environmentVariables = new EnvironmentVariables();
+
     @Before
     public void before() {
         Mockito.when(securityService.extractIdentityZoneIdFromJwt()).thenReturn("someIdentityZoneId");
@@ -143,6 +148,25 @@ public void onPaasProvisioning_expectErrorResponse() {
 
     @Test
     public void onSaasDeProvisioning_expectSuccessResponse() {
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "false");
+
+        String instanceId = java.util.UUID.randomUUID().toString();
+        String tenantId = "tenant1";
+        String targetContextId = "snapshot_context_id_2";
+        String payload = String.format("{ \n" +
+                "    \"instanceId\" : \"%s\",\n" +
+                "    \"subscriptionAppName\" : \"%s\",\n" +
+                "    \"subscribedTenantId\" : \"%s\"\n" +
+                "}", instanceId, targetContextId, tenantId);
+        ResponseEntity response = provisioningController.onSaasDeProvisioning(payload);
+        verify(tenantOperationsService, times(1)).deleteTenant(tenantId, instanceId);
+        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
+    }
+
+    @Test
+    public void onSaasDeProvisioning_expectSuccessResponse_toggleOn() {
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
+
         String instanceId = java.util.UUID.randomUUID().toString();
         String tenantId = "tenant1";
         String targetContextId = "snapshot_context_id_2";
@@ -180,6 +204,7 @@ public void onPaasDeProvisioning_expectSuccessResponse() {
 
     @Test
     public void onSaasDeProvisioning_expectErrorResponse() {
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         String instanceId = java.util.UUID.randomUUID().toString();
         String tenantId = "tenant1";
         String targetContextId = "snapshot_context_id_2";
@@ -229,7 +254,7 @@ public void onPaasDeProvisioning_expectErrorResponse() {
 
     @Test
     public void onSaasDeProvisioningInstanceWorkZone_expectSuccessResponse() {
-
+        environmentVariables.set("HTML5_APP_REPO_TOGGLE", "true");
         Mockito.when(securityService.isWorkZoneScenario(Mockito.anyString())).thenReturn(true);
 
         String instanceId = java.util.UUID.randomUUID().toString();

From b73aad02a28fe1ef53d8ccb5af3a327f3e12f86d Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 25 May 2020 13:14:33 +0300
Subject: [PATCH 5/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../service/TenantOperationsService.java            | 13 ++++++-------
 1 file changed, 6 insertions(+), 7 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 4b89dc7f..2b06c85b 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -92,8 +92,7 @@ private void deleteTenantImpl(String tenantId, String instanceId, boolean delete
                     } else {
                         logger.warn("deleteTenantImpl() Html5 Local Provider deletion has failed");
                     }
-                }
-                else {
+                } else {
                     logger.debug("deleteTenantImpl() checking scenario subscription intact. Keeping Html5 Local Provider");
                 }
             }
@@ -103,8 +102,8 @@ private void deleteTenantImpl(String tenantId, String instanceId, boolean delete
         } catch (RuntimeException e) {
             if (auditLogPortalMessage != null) {
                 auditLogPortalMessage.logFailure();
-                throw e;
             }
+            throw e;
         }
     }
 
@@ -128,7 +127,7 @@ public void deleteTenant(String tenantId, String instanceId) {
             authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
 
             String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
-            if(html5AppRepoToggle != null && html5AppRepoToggle.equals("true")) {
+            if (html5AppRepoToggle != null && html5AppRepoToggle.equals("true")) {
                 logger.debug("HTML5_APP_REPO_TOGGLE feature toggle is turnned on");
                 this.addAuthorizedProvider(authorizedTenantIds, identityZoneId, Constants.HTML5_APP_REPO_INSTANCE);
             }
@@ -249,9 +248,9 @@ private boolean deleteHtml5InternalProvider(String identityZoneId, String instan
         // aka delete helium like provider
         boolean bResponse = false;
         try {
-            bResponse = this.performBatchDeleteEntity( Constants.HTML5_APP_REPO_INSTANCE , "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
+            bResponse = this.performBatchDeleteEntity(Constants.HTML5_APP_REPO_INSTANCE, "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
         } catch (JsonProcessingException jpe) {
-            logger.warn(String.format("deleteHtml5InternalProvider() exception %s", jpe.getMessage()));
+            logger.error(String.format("deleteHtml5InternalProvider() exception %s", jpe.getMessage()));
         }
         return bResponse;
     }
@@ -482,7 +481,7 @@ private boolean activateSites(List<Map> siteIds, String identityZoneId, String i
             Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
             ServiceCallResponse response = serviceRequest.callService("/activation_service/activate/sites", RequestMethod.POST, body, null, additionalAttributes, null);
 
-            if (response.getStatusCode() == 200) {
+            if (response != null && response.getStatusCode() == 200) {
                 logger.info("Activate sites succeeded");
                 isActivateSitesSuccess = true;
             } else {

From 90f2b1ebae88f4cbd98bc4f7f2b31cb0598e47a4 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 25 May 2020 13:16:32 +0300
Subject: [PATCH 6/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../tenant/provisioning/service/TenantOperationsService.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 2b06c85b..8b718075 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -412,7 +412,7 @@ private boolean performBatchDeleteEntity(String entityId, String entityType, Str
         Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
         ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);
 
-        if (response.getStatusCode() == 200) {
+        if (response != null && response.getStatusCode() == 200) {
             logger.info("performBatchDeleteEntity() Delete entity succeeded");
             isBatchDeleteSuccess = true;
         } else {

From d81db89cef57e4bf09975a424ee412334e71540f Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 25 May 2020 17:56:04 +0300
Subject: [PATCH 7/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../provisioning/service/CdmBatchDTO.java     | 20 +++++++
 .../service/TenantOperationsService.java      | 57 +++++++++++--------
 2 files changed, 53 insertions(+), 24 deletions(-)
 create mode 100644 tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/CdmBatchDTO.java

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/CdmBatchDTO.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/CdmBatchDTO.java
new file mode 100644
index 00000000..40f1974c
--- /dev/null
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/CdmBatchDTO.java
@@ -0,0 +1,20 @@
+package com.sap.portal.tenant.provisioning.service;
+
+public class CdmBatchDTO {
+    public String entityId;
+    public String entityType;
+    public String contextId;
+    public String contextType;
+    public String identityZoneId;
+    public String instanceId;
+
+    CdmBatchDTO(String entityId, String entityType, String contextId, String contextType, String identityZoneId, String instanceId) {
+        this.entityId = entityId;
+        this.entityType = entityType;
+        this.contextId = contextId;
+        this.contextType = contextType;
+        this.identityZoneId = identityZoneId;
+        this.instanceId = instanceId;
+    }
+
+}
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 8b718075..5d12e31d 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -76,26 +76,14 @@ public Tenant retrieve(String identityZoneId, String instanceId) {
         return tenantDao.retrieve(tenantId);
     }
 
-    private void deleteTenantImpl(String tenantId, String instanceId, boolean deleteHtml5LocalProvider) {
-        logger.debug(String.format("deleteTenantImpl(tenantId=%s, instanceId=%s, deleteHtml5LocalProvider=%b", tenantId, instanceId, deleteHtml5LocalProvider));
+
+    private void deleteTenantImpl(String tenantId, String instanceId) {
+        logger.debug(String.format("deleteTenantImpl(tenantId=%s, instanceId=%s", tenantId, instanceId));
         ITransactionalAuditLogPortalMessage auditLogPortalMessage = null;
         try {
             auditLogPortalMessage = prepareDeleteAllTenantDataLogMessage(tenantId, instanceId);
             auditLogPortalMessage.prepare();
             deleteTenantData(tenantId, instanceId);
-            if (deleteHtml5LocalProvider) {
-                logger.debug("deleteTenantImpl() checking scenario subscription status");
-                if (!this.isSubscribedToScenario(tenantId)) {
-                    logger.debug("deleteTenantImpl() deleting Html5 Local Provider");
-                    if (this.deleteHtml5InternalProvider(tenantId, instanceId)) {
-                        logger.debug("deleteTenantImpl() Html5 Local Provider deleted");
-                    } else {
-                        logger.warn("deleteTenantImpl() Html5 Local Provider deletion has failed");
-                    }
-                } else {
-                    logger.debug("deleteTenantImpl() checking scenario subscription intact. Keeping Html5 Local Provider");
-                }
-            }
             auditLogPortalMessage.logSuccess();
         } catch (AuditLoggerException e) {
             logger.warn(String.format("Audit log is not bound or has issues! %s", e.getMessage()));
@@ -107,16 +95,36 @@ private void deleteTenantImpl(String tenantId, String instanceId, boolean delete
         }
     }
 
+    private void deleteHtml5LocalProvider(String tenantId, String instanceId) {
+        logger.debug(String.format("deleteHtml5LocalProvider(tenantId=%s, instanceId=%s", tenantId, instanceId));
+        try {
+            logger.debug("deleteHtml5LocalProvider() checking scenario subscription status");
+            if (!this.isSubscribedToScenario(tenantId)) {
+                logger.debug("deleteHtml5LocalProvider() deleting Html5 Local Provider");
+                if (this.deleteHtml5InternalProvider(tenantId, instanceId)) {
+                    logger.debug("deleteHtml5LocalProvider() Html5 Local Provider deleted");
+                } else {
+                    logger.warn("deleteHtml5LocalProvider() Html5 Local Provider deletion has failed");
+                }
+            }
+        } catch (AuditLoggerException e) {
+            logger.warn(String.format("Audit log is not bound or has issues! %s", e.getMessage()));
+        } catch (RuntimeException e) {
+            throw e;
+        }
+    }
+
     @Override
     public void deleteTenantAndLocalHTML5Provider(String tenantId, String instanceId) {
         logger.debug(String.format("deleteTenantAndLocalHTML5Provider(tenantId=%s, instanceId=%s", tenantId, instanceId));
-        deleteTenantImpl(tenantId, instanceId, true);
+        deleteTenantImpl(tenantId, instanceId);
+        deleteHtml5InternalProvider(tenantId, instanceId);
     }
 
     @Override
     public void deleteTenant(String tenantId, String instanceId) {
         logger.debug(String.format("deleteTenant(tenantId=%s, instanceId=%s", tenantId, instanceId));
-        deleteTenantImpl(tenantId, instanceId, false);
+        deleteTenantImpl(tenantId, instanceId);
     }
 
     @Override
@@ -248,7 +256,8 @@ private boolean deleteHtml5InternalProvider(String identityZoneId, String instan
         // aka delete helium like provider
         boolean bResponse = false;
         try {
-            bResponse = this.performBatchDeleteEntity(Constants.HTML5_APP_REPO_INSTANCE, "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
+            CdmBatchDTO cdmBatchDTO = new CdmBatchDTO(Constants.HTML5_APP_REPO_INSTANCE, "provider", "SUB_ACCOUNT", "SUB_ACCOUNT", identityZoneId, instanceId);
+            bResponse = this.performBatchDeleteEntity(cdmBatchDTO);
         } catch (JsonProcessingException jpe) {
             logger.error(String.format("deleteHtml5InternalProvider() exception %s", jpe.getMessage()));
         }
@@ -391,8 +400,8 @@ private ArrayNode generateJSONOperations(String entityType, String entityId, Obj
         return operations;
     }
 
-    private boolean performBatchDeleteEntity(String entityId, String entityType, String contextType, String contextId, String identityZoneId, String instanceId) throws JsonProcessingException {
-        logger.debug(String.format("performBatchDeleteEntity(entityId=%s, entityType=%s, contextType=%s, contextId=%s, identityZoneId=%s, instanceId=%s )", entityId, entityType, contextType, contextId, identityZoneId, instanceId));
+    private boolean performBatchDeleteEntity(CdmBatchDTO cdmBatchDTO) throws JsonProcessingException {
+        logger.debug(String.format("performBatchDeleteEntity(entityId=%s, entityType=%s, contextType=%s, contextId=%s, identityZoneId=%s, instanceId=%s )", cdmBatchDTO.entityId, cdmBatchDTO.entityType, cdmBatchDTO.contextType, cdmBatchDTO.contextId, cdmBatchDTO.identityZoneId, cdmBatchDTO.instanceId));
 
         boolean isBatchDeleteSuccess = false;
 
@@ -401,22 +410,22 @@ private boolean performBatchDeleteEntity(String entityId, String entityType, Str
         ObjectNode rootNode = this.generateJSONRoot(mapper);
 
         //fill { context: {} }
-        ObjectNode contextNode = this.generateJSONContext(contextType, contextId, mapper);
+        ObjectNode contextNode = this.generateJSONContext(cdmBatchDTO.contextType, cdmBatchDTO.contextId, mapper);
         rootNode.set("context", contextNode);
 
         //fill { operations: {} }
-        ArrayNode operations = this.generateJSONOperations(entityType, entityId, rootNode, mapper);
+        ArrayNode operations = this.generateJSONOperations(cdmBatchDTO.entityType, cdmBatchDTO.entityId, rootNode, mapper);
         rootNode.set("operations", operations);
 
         String body = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(rootNode);
-        Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
+        Map<String, String> additionalAttributes = prepareAdditionalAttributes(cdmBatchDTO.identityZoneId, cdmBatchDTO.instanceId);
         ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);
 
         if (response != null && response.getStatusCode() == 200) {
             logger.info("performBatchDeleteEntity() Delete entity succeeded");
             isBatchDeleteSuccess = true;
         } else {
-            logger.error(String.format("performBatchDeleteEntity() Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", entityId, entityType, response.getStatusCode()));
+            logger.error(String.format("performBatchDeleteEntity() Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", cdmBatchDTO.entityId, cdmBatchDTO.entityType, response.getStatusCode()));
         }
 
         return isBatchDeleteSuccess;

From a82de30176b46f62aa30b001a6de0ff1f220c730 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Tue, 26 May 2020 10:29:18 +0300
Subject: [PATCH 8/8] onSaasDeProvisioning data termination delete HTML5 local
 provider

---
 .../tenant/provisioning/service/TenantOperationsService.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 5d12e31d..bc98f2b7 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -177,6 +177,7 @@ public boolean isSubscribed(String identityZoneId, String instanceId) {
     }
 
     private boolean isSubscribedToScenario(String identityZoneId) {
+        // ToDo, use Adam's get products select when ready
         return tenantDao.isSubscribed(identityZoneId, securityService.getPortalInstanceId()) ||
                 tenantDao.isSubscribed(identityZoneId, securityService.getLaunchpadInstanceId()) ||
                 tenantDao.isSubscribed(identityZoneId, securityService.getWorkzoneInstanceId());
@@ -243,7 +244,7 @@ private boolean deleteCdmStoreTenantData(String identityZoneId, String instanceI
         Map<String, String> additionalAttributes = prepareAdditionalAttributes(identityZoneId, instanceId);
         ServiceCallResponse serviceCallResponse = serviceRequest.callService("/cdm_store_service/cdm/unsubscribe", RequestMethod.DELETE, null, null, additionalAttributes, null);
         if (serviceCallResponse.getStatusCode() == 200) {
-            logger.info("Data termination succeeded - data termination succeeded");
+            logger.debug("Data termination succeeded - data termination succeeded");
             succeeded = true;
         } else {
             logger.error(String.format("Data termination failed - could not delete data from CDM store, response ended with status=%s", serviceCallResponse.getStatusCode()));
@@ -422,7 +423,7 @@ private boolean performBatchDeleteEntity(CdmBatchDTO cdmBatchDTO) throws JsonPro
         ServiceCallResponse response = serviceRequest.callService("/cdm_store_service/cdm/entities", RequestMethod.POST, body, null, additionalAttributes, null);
 
         if (response != null && response.getStatusCode() == 200) {
-            logger.info("performBatchDeleteEntity() Delete entity succeeded");
+            logger.debug("performBatchDeleteEntity() Delete entity succeeded");
             isBatchDeleteSuccess = true;
         } else {
             logger.error(String.format("performBatchDeleteEntity() Delete entity has failed - could not delete entity id=%s, type=%s from CDM-Store, response status=%s", cdmBatchDTO.entityId, cdmBatchDTO.entityType, response.getStatusCode()));

                    1.20.5.4.2.6 Adam's local provider pull-request
https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/161
                    1.20.5.4.2.7

            1.20.5.5 related bug
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1582

PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/162
https://github.wdf.sap.corp/Portal-CF/portal-platform-commons/pull/107

bug was closed:
Closing PR.
Since workzone is both PaaS and provider the final fix will break it.
For now we will not make any fixes. If any bug related to ATZ prov IDs arises will fix accordingly.


Fix by filtering out "self" solution subscribed tenants. In other words remove from ATZ providers list those whose tenant id is one of {portal, workzone, launchpad} instance ids

SELECT "IDENTITY_ZONE_ID","INSTANCE_ID","TENANT_ID"  FROM "TENANT_INFO" WHERE "INSTANCE_ID" IN (SELECT "INSTANCE_ID" FROM "TENANT_INFO" WHERE "IDENTITY_ZONE_ID" = ? AND "ORG_ID" = '' AND "SPACE_ID" = '' AND  "INSTANCE_ID" NOT IN (?) AND  "ORG_ID" != '' AND "SPACE_ID" != '' 


when not in (?)
org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar [SELECT "IDENTITY_ZONE_ID","INSTANCE_ID","TENANT_ID"  FROM "TENANT_INFO" WHERE "INSTANCE_ID" IN (SELECT "INSTANCE_ID" FROM "TENANT_INFO" WHERE "IDENTITY_ZONE_ID" = ? AND "ORG_ID" = '' AND "SPACE_ID" = '' AND  "INSTANCE_ID" NOT IN (?)  AND  "ORG_ID" != '' AND "SPACE_ID" != '' ]; nested exception is org.postgresql.util.PSQLException: ERROR: syntax error at end of input
  Position: 278

when not in ("?")
org.springframework.dao.DataIntegrityViolationException: PreparedStatementCallback; SQL [SELECT "IDENTITY_ZONE_ID","INSTANCE_ID","TENANT_ID"  FROM "TENANT_INFO" WHERE "INSTANCE_ID" IN (SELECT "INSTANCE_ID" FROM "TENANT_INFO" WHERE "IDENTITY_ZONE_ID" = ? AND "ORG_ID" = '' AND "SPACE_ID" = '' AND  "INSTANCE_ID" NOT IN ("?")  AND  "ORG_ID" != '' AND "SPACE_ID" != '' ]; The column index is out of range: 2, number of columns: 1.; nested exception is org.postgresql.util.PSQLException: The column index is out of range: 2, number of columns: 1.


md5: Portal_CLP_Provider, portalInstanceId => 4d0b8911e18efbd1fc87c0bb9e17dda7
tenantId2, 4d0b8911e18efbd1fc87c0bb9e17dda7 =>


    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " + "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' ) ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";

    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
                        "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" != ? ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";


-diff:
From 50a741a6a346a1cc62fc9d1af56cef8d15435995 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 31 May 2020 16:12:36 +0300
Subject: [PATCH 1/4] EUXTEAMSAAR-1582, get ATZ providers portal filtering

---
 .../webaccess/TenantsController.java          |  3 +-
 .../webaccess/TenantsControllerTest.java      | 28 ++-----------------
 .../test/resources/tenant_ids_response.json   |  2 +-
 3 files changed, 5 insertions(+), 28 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
index 63873661..0e11b627 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
@@ -63,9 +63,8 @@ public ResponseEntity getAllProvidersTenantsIds() {
         ResponseEntity response;
         try {
             logger.info("getAllProvidersTenantsIds called with identityZoneId = {}", identityZoneId);
-            String portalInstanceId = securityService.getPortalInstanceId();
             List<String> tenantIds;
-            tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, portalInstanceId);
+            tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, "");
             response = new ResponseEntity<>(tenantIds, OK);
         } catch (RuntimeException e) {
             logger.error(e.getMessage(), e);
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
index f71278dc..4d7f263c 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
@@ -50,28 +50,7 @@ public void before() {
     @Test
     public void onGetAllProvidersTenantsIds_expectSuccessResponse() {
         ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
-        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
-        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
-    }
-
-    @Test
-    public void onGetAllProvidersTenants_expectSuccessResponse() {
-        ResponseEntity response = tenantsController.getAllProvidersTenantsEndpoint();
-        verify(tenantOperationsService, times(1)).getAuthorizedTenants(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
-        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
-    }
-
-    @Test
-    public void onGetAllConsumersTenantIds_expectSuccessResponse() {
-        ResponseEntity response = tenantsController.getAllConsumersTenantIds();
-        verify(tenantOperationsService, times(1)).getSubscribedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.extractInstanceIdFromJwt(), Arrays.asList("portalInstanceId", "workzoneInstanceId"));
-        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
-    }
-
-    @Test
-    public void onGetAllConsumersTenants_expectSuccessResponse() {
-        ResponseEntity response = tenantsController.getAllConsumersTenants();
-        verify(tenantOperationsService, times(1)).getSubscribedTenants(securityService.extractIdentityZoneIdFromJwt(),  securityService.extractInstanceIdFromJwt(), Arrays.asList("portalInstanceId", "workzoneInstanceId"));
+        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), "");
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
@@ -81,12 +60,11 @@ public void onGetAllProvidersTenantsIds_expectErrorResponse() {
         try {
 
             String identityZone = securityService.extractIdentityZoneIdFromJwt();
-            String instanceID = securityService.getPortalInstanceId();
-            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, instanceID);
+            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, "");
 
             ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
 
-            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
+            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), "");
             Assert.assertEquals(response.getStatusCode(), HttpStatus.INTERNAL_SERVER_ERROR);
         } catch (IllegalArgumentException e) {
             Assert.fail(e.getMessage());
diff --git a/tenant.provisioning/src/test/resources/tenant_ids_response.json b/tenant.provisioning/src/test/resources/tenant_ids_response.json
index 82e1a709..bdd6d109 100644
--- a/tenant.provisioning/src/test/resources/tenant_ids_response.json
+++ b/tenant.provisioning/src/test/resources/tenant_ids_response.json
@@ -1 +1 @@
-["7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce"]
\ No newline at end of file
+["4d0b8911e18efbd1fc87c0bb9e17dda7", "7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce"]

From ffee716fc64238fde935af1349039ce1565b49f4 Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 31 May 2020 16:18:34 +0300
Subject: [PATCH 2/4] EUXTEAMSAAR-1582, get ATZ providers portal filtering

---
 .../provisioning/webaccess/TenantsControllerTest.java      | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
index 4d7f263c..cd9eeabc 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
@@ -54,6 +54,13 @@ public void onGetAllProvidersTenantsIds_expectSuccessResponse() {
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
+    @Test
+    public void onGetAllConsumersTenantIds_expectSuccessResponse() {
+        ResponseEntity response = tenantsController.getAllConsumersTenantIds();
+        verify(tenantOperationsService, times(1)).getSubscribedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.extractInstanceIdFromJwt(), Arrays.asList("portalInstanceId", "workzoneInstanceId"));
+        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
+    }
+
     @Test
     public void onGetAllProvidersTenantsIds_expectErrorResponse() {
 

From 2f1f6ed8e6be1d995485102d2145cbfb904bd6dd Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Sun, 31 May 2020 18:14:46 +0300
Subject: [PATCH 3/4] EUXTEAMSAAR-1582, get ATZ providers self solutions
 filtering

---
 .../repository/ITenantRepository.java         |  3 ++-
 .../repository/postgres/TenantRepository.java | 22 ++++++++++++++-----
 .../service/ITenantOperationsService.java     |  3 ++-
 .../service/TenantOperationsService.java      |  4 ++--
 .../webaccess/TenantsController.java          |  6 ++++-
 .../webaccess/TenantsControllerTest.java      | 21 +++++++++++++++---
 .../test/resources/tenant_ids_response.json   |  2 +-
 7 files changed, 46 insertions(+), 15 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
index c700f4d4..7cc85a48 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
@@ -3,6 +3,7 @@
 import com.sap.portal.tenant.provisioning.model.BaseTenant;
 import com.sap.portal.tenant.provisioning.model.Tenant;
 
+import java.util.ArrayList;
 import java.util.List;
 
 public interface ITenantRepository {
@@ -12,7 +13,7 @@
 
     Tenant retrieve(String tenantId);
 
-    List<String> getAuthorizedTenantsIds(String identityZoneId, String filterByInstanceId);
+    List<String> getAuthorizedTenantsIds(String identityZoneId, ArrayList<String> filterByInstanceIds);
 
     List<BaseTenant> getAuthorizedTenants(String identityZoneId, String filterByInstanceId);
 
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
index bb6f4324..ccc1d1a9 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
@@ -23,10 +23,9 @@
     private static String CREATE_TENANT_STATEMENT = "INSERT INTO " + TENANT_INFO_TABLE + " VALUES(?,?,?,?,?,?,?,now())";
     private static String SELECT_TENANT_STATEMENT = "SELECT * FROM " + TENANT_INFO_TABLE + " WHERE \"TENANT_ID\" = ?";
 
-    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
-            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" != ? ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
-
     private static String INSTANCE_IDS_PLACE_HOLDER = "%instanceIds%";
+    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
+            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" NOT IN (" + INSTANCE_IDS_PLACE_HOLDER + ") AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
     private static String SELECT_SUBSCRIBED_TENANTS_STATEMENT =  "SELECT TABLE2.\"IDENTITY_ZONE_ID\", TABLE2.\"INSTANCE_ID\", TABLE2.\"TENANT_ID\" FROM (SELECT \"IDENTITY_ZONE_ID\", \"INSTANCE_ID\", \"TENANT_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" <> ? AND \"INSTANCE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '') AS TABLE1 "
             + "INNER JOIN "
             + "(SELECT \"IDENTITY_ZONE_ID\", \"INSTANCE_ID\", \"TENANT_ID\" FROM " + TENANT_INFO_TABLE
@@ -69,8 +68,11 @@ public Tenant retrieve(String tenantId){
     }
 
     @Override
-    public List<String> getAuthorizedTenantsIds(String identityZoneId, String filterByInstanceId){
-        return jdbcTemplate.query(SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED, (ResultSet resultSet, int i) -> resultSet.getString("TENANT_ID"), identityZoneId, filterByInstanceId);
+    public List<String> getAuthorizedTenantsIds(String identityZoneId, ArrayList<String> filterByInstanceIds){
+        List<String> args = new ArrayList<>();
+        args.addAll(Arrays.asList(identityZoneId));
+        args.addAll(filterByInstanceIds);
+        return jdbcTemplate.query(getSelectAtzTenantsStatementFiltered(filterByInstanceIds), (ResultSet resultSet, int i) -> resultSet.getString("TENANT_ID"), args.toArray());
     }
 
     @Override
@@ -100,7 +102,6 @@ public boolean isSubscribed(String identityZoneId, String instanceId) {
        return jdbcTemplate.queryForObject(SELECT_COUNT_IS_SUBSCRIBED, new Object[] {identityZoneId, instanceId} , Integer.class) > 0 ;
     }
 
-
     private int deleteTenantInfo(String tenantId) {
         logger.info("DELETE_TENANT_STATEMENT = {} with tenantId = {}", DELETE_TENANT_STATEMENT, tenantId);
         return jdbcTemplate.update(DELETE_TENANT_STATEMENT, new Object[]{tenantId});
@@ -118,4 +119,13 @@ private String getSelectSubscribedTenantsStatement(List<String> instanceIds) {
         argumentQuestionMark.deleteCharAt(argumentQuestionMark.length() - 1);
         return SELECT_SUBSCRIBED_TENANTS_STATEMENT.replace(INSTANCE_IDS_PLACE_HOLDER, argumentQuestionMark.toString());
     }
+
+    private String getSelectAtzTenantsStatementFiltered(List<String> instanceIds) {
+        StringBuilder argumentQuestionMark = new StringBuilder();
+        instanceIds.forEach(instanceId -> argumentQuestionMark.append("?,"));
+        argumentQuestionMark.deleteCharAt(argumentQuestionMark.length() - 1);
+        return SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED.replace(INSTANCE_IDS_PLACE_HOLDER, argumentQuestionMark.toString());
+    }
+
+
 }
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
index b7ddc313..5545cb9f 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
@@ -3,6 +3,7 @@
 import com.sap.portal.tenant.provisioning.model.BaseTenant;
 import com.sap.portal.tenant.provisioning.model.Tenant;
 
+import java.util.ArrayList;
 import java.util.List;
 
 public interface ITenantOperationsService {
@@ -12,7 +13,7 @@
     UnsubscribeResponse unsubscribeCFProvider(String identityZone, String instanceId, String tenantId, String targetContextId) throws IllegalArgumentException;
     void createTenant(String identityZoneId, String instanceId, String plan, String orgGuid, String spaceGuid) throws IllegalArgumentException;
     Tenant retrieve(String identityZoneId, String instanceId) throws IllegalArgumentException;
-    List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) throws IllegalArgumentException;
+    List<String> getAuthorizedTenantIds(String identityZoneId, ArrayList<String> filterByInstanceIds) throws IllegalArgumentException;
     List<BaseTenant> getAuthorizedTenants(String identityZoneId, String filterByInstanceId) throws IllegalArgumentException;
     List<String> getSubscribedTenantIds(String identityZoneId, String providerInstanceId, List<String> instanceIds) throws IllegalArgumentException;
     List<BaseTenant> getSubscribedTenants(String identityZoneId, String providerInstanceId, List<String> instanceIds) throws IllegalArgumentException;
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 18120eac..45e66969 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -128,11 +128,11 @@ public void deleteTenant(String tenantId, String instanceId) {
     }
 
     @Override
-    public List<String> getAuthorizedTenantIds(String identityZoneId, String filterByInstanceId) {
+    public List<String> getAuthorizedTenantIds(String identityZoneId, ArrayList<String> filterByInstanceIds) {
         List<String> authorizedTenantIds = new ArrayList<>();
 
         try {
-            authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceId));
+            authorizedTenantIds.addAll(tenantDao.getAuthorizedTenantsIds(identityZoneId, filterByInstanceIds));
             logger.debug(String.format("Authorized Tenant Ids %s", authorizedTenantIds));
             String html5AppRepoToggle = System.getenv("HTML5_APP_REPO_TOGGLE");
             logger.debug(String.format("HTML5_APP_REPO_TOGGLE feature toggle is %s", html5AppRepoToggle));
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
index 0e11b627..dafa1e75 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/webaccess/TenantsController.java
@@ -63,8 +63,12 @@ public ResponseEntity getAllProvidersTenantsIds() {
         ResponseEntity response;
         try {
             logger.info("getAllProvidersTenantsIds called with identityZoneId = {}", identityZoneId);
+
+            // ToDo, once commons version is ready get all solutions (- Apollo) instance IDs
+            List<String> solutionInstances = new ArrayList<String>();
+            solutionInstances.add(securityService.getPortalInstanceId());
             List<String> tenantIds;
-            tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, "");
+            tenantIds = tenantOperationsService.getAuthorizedTenantIds(identityZoneId, solutionInstances);
             response = new ResponseEntity<>(tenantIds, OK);
         } catch (RuntimeException e) {
             logger.error(e.getMessage(), e);
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
index cd9eeabc..f71278dc 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
@@ -50,7 +50,14 @@ public void before() {
     @Test
     public void onGetAllProvidersTenantsIds_expectSuccessResponse() {
         ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
-        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), "");
+        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
+        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
+    }
+
+    @Test
+    public void onGetAllProvidersTenants_expectSuccessResponse() {
+        ResponseEntity response = tenantsController.getAllProvidersTenantsEndpoint();
+        verify(tenantOperationsService, times(1)).getAuthorizedTenants(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
@@ -61,17 +68,25 @@ public void onGetAllConsumersTenantIds_expectSuccessResponse() {
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
+    @Test
+    public void onGetAllConsumersTenants_expectSuccessResponse() {
+        ResponseEntity response = tenantsController.getAllConsumersTenants();
+        verify(tenantOperationsService, times(1)).getSubscribedTenants(securityService.extractIdentityZoneIdFromJwt(),  securityService.extractInstanceIdFromJwt(), Arrays.asList("portalInstanceId", "workzoneInstanceId"));
+        Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
+    }
+
     @Test
     public void onGetAllProvidersTenantsIds_expectErrorResponse() {
 
         try {
 
             String identityZone = securityService.extractIdentityZoneIdFromJwt();
-            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, "");
+            String instanceID = securityService.getPortalInstanceId();
+            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, instanceID);
 
             ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
 
-            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), "");
+            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
             Assert.assertEquals(response.getStatusCode(), HttpStatus.INTERNAL_SERVER_ERROR);
         } catch (IllegalArgumentException e) {
             Assert.fail(e.getMessage());
diff --git a/tenant.provisioning/src/test/resources/tenant_ids_response.json b/tenant.provisioning/src/test/resources/tenant_ids_response.json
index bdd6d109..34b484ea 100644
--- a/tenant.provisioning/src/test/resources/tenant_ids_response.json
+++ b/tenant.provisioning/src/test/resources/tenant_ids_response.json
@@ -1 +1 @@
-["4d0b8911e18efbd1fc87c0bb9e17dda7", "7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce"]
+["7ba5d8efe708ef8b3da2696e0f841997", "41d7e68aa508ecf0296cd83aa96f67ce"]

From b3371b373f639ecb94857b36ea1b46a734ad624f Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Mon, 1 Jun 2020 16:54:34 +0300
Subject: [PATCH 4/4] EUXTEAMSAAR-1582, get ATZ providers self solutions
 filtering

---
 .../repository/ITenantRepository.java         |  2 +-
 .../repository/postgres/TenantRepository.java | 21 +++++++++++++++----
 .../service/ITenantOperationsService.java     |  2 +-
 .../service/TenantOperationsService.java      | 13 +++++++++---
 .../webaccess/TenantsControllerTest.java      | 15 ++++++++-----
 5 files changed, 39 insertions(+), 14 deletions(-)

diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
index 7cc85a48..b4846588 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/ITenantRepository.java
@@ -13,7 +13,7 @@
 
     Tenant retrieve(String tenantId);
 
-    List<String> getAuthorizedTenantsIds(String identityZoneId, ArrayList<String> filterByInstanceIds);
+    List<String> getAuthorizedTenantsIds(String identityZoneId, List<String> filterByInstanceIds);
 
     List<BaseTenant> getAuthorizedTenants(String identityZoneId, String filterByInstanceId);
 
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
index ccc1d1a9..4dfd68c3 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/repository/postgres/TenantRepository.java
@@ -24,8 +24,20 @@
     private static String SELECT_TENANT_STATEMENT = "SELECT * FROM " + TENANT_INFO_TABLE + " WHERE \"TENANT_ID\" = ?";
 
     private static String INSTANCE_IDS_PLACE_HOLDER = "%instanceIds%";
+
+    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
+            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
+
     private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM " + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN " +
-            "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" NOT IN (" + INSTANCE_IDS_PLACE_HOLDER + ") AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
+                        "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '' AND  \"INSTANCE_ID\" != ? ) AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
+
+    private static String SELECT_AUTHORIZED_TENANTS_STATEMENT_FULL_FILTERED = "SELECT \"IDENTITY_ZONE_ID\",\"INSTANCE_ID\",\"TENANT_ID\"  FROM "
+            + TENANT_INFO_TABLE + " WHERE \"INSTANCE_ID\" IN "
+            + "(SELECT \"INSTANCE_ID\" FROM " + TENANT_INFO_TABLE
+            + " WHERE \"IDENTITY_ZONE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = ''"
+            + " AND  \"INSTANCE_ID\" NOT IN (" + INSTANCE_IDS_PLACE_HOLDER + ") )"
+            + " AND  \"ORG_ID\" != '' AND \"SPACE_ID\" != '' ";
+
     private static String SELECT_SUBSCRIBED_TENANTS_STATEMENT =  "SELECT TABLE2.\"IDENTITY_ZONE_ID\", TABLE2.\"INSTANCE_ID\", TABLE2.\"TENANT_ID\" FROM (SELECT \"IDENTITY_ZONE_ID\", \"INSTANCE_ID\", \"TENANT_ID\" FROM " + TENANT_INFO_TABLE + " WHERE \"IDENTITY_ZONE_ID\" <> ? AND \"INSTANCE_ID\" = ? AND \"ORG_ID\" = '' AND \"SPACE_ID\" = '') AS TABLE1 "
             + "INNER JOIN "
             + "(SELECT \"IDENTITY_ZONE_ID\", \"INSTANCE_ID\", \"TENANT_ID\" FROM " + TENANT_INFO_TABLE
@@ -68,9 +80,9 @@ public Tenant retrieve(String tenantId){
     }
 
     @Override
-    public List<String> getAuthorizedTenantsIds(String identityZoneId, ArrayList<String> filterByInstanceIds){
+    public List<String> getAuthorizedTenantsIds(String identityZoneId, List<String> filterByInstanceIds){
         List<String> args = new ArrayList<>();
-        args.addAll(Arrays.asList(identityZoneId));
+        args.add(identityZoneId);
         args.addAll(filterByInstanceIds);
         return jdbcTemplate.query(getSelectAtzTenantsStatementFiltered(filterByInstanceIds), (ResultSet resultSet, int i) -> resultSet.getString("TENANT_ID"), args.toArray());
     }
@@ -124,7 +136,8 @@ private String getSelectAtzTenantsStatementFiltered(List<String> instanceIds) {
         StringBuilder argumentQuestionMark = new StringBuilder();
         instanceIds.forEach(instanceId -> argumentQuestionMark.append("?,"));
         argumentQuestionMark.deleteCharAt(argumentQuestionMark.length() - 1);
-        return SELECT_AUTHORIZED_TENANTS_STATEMENT_FILTERED.replace(INSTANCE_IDS_PLACE_HOLDER, argumentQuestionMark.toString());
+        String retQuery = SELECT_AUTHORIZED_TENANTS_STATEMENT_FULL_FILTERED.replace(INSTANCE_IDS_PLACE_HOLDER, argumentQuestionMark.toString());
+        return retQuery;
     }
 
 
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
index 5545cb9f..051bfffb 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/ITenantOperationsService.java
@@ -13,7 +13,7 @@
     UnsubscribeResponse unsubscribeCFProvider(String identityZone, String instanceId, String tenantId, String targetContextId) throws IllegalArgumentException;
     void createTenant(String identityZoneId, String instanceId, String plan, String orgGuid, String spaceGuid) throws IllegalArgumentException;
     Tenant retrieve(String identityZoneId, String instanceId) throws IllegalArgumentException;
-    List<String> getAuthorizedTenantIds(String identityZoneId, ArrayList<String> filterByInstanceIds) throws IllegalArgumentException;
+    List<String> getAuthorizedTenantIds(String identityZoneId, List<String> filterByInstanceIds) throws IllegalArgumentException;
     List<BaseTenant> getAuthorizedTenants(String identityZoneId, String filterByInstanceId) throws IllegalArgumentException;
     List<String> getSubscribedTenantIds(String identityZoneId, String providerInstanceId, List<String> instanceIds) throws IllegalArgumentException;
     List<BaseTenant> getSubscribedTenants(String identityZoneId, String providerInstanceId, List<String> instanceIds) throws IllegalArgumentException;
diff --git a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
index 45e66969..f1a59214 100644
--- a/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
+++ b/tenant.provisioning/src/main/java/com/sap/portal/tenant/provisioning/service/TenantOperationsService.java
@@ -128,7 +128,7 @@ public void deleteTenant(String tenantId, String instanceId) {
     }
 
     @Override
-    public List<String> getAuthorizedTenantIds(String identityZoneId, ArrayList<String> filterByInstanceIds) {
+    public List<String> getAuthorizedTenantIds(String identityZoneId, List<String> filterByInstanceIds) {
         List<String> authorizedTenantIds = new ArrayList<>();
 
         try {
@@ -174,7 +174,9 @@ private void addAuthorizedProvider(List<String> authorizedTenantIds, String iden
 
     @Override
     public boolean validateTrust(String identityZoneId, String scenarioInstanceId, String providerTenantId) {
-        List<String> trustedTenants = this.getAuthorizedTenantIds(identityZoneId, scenarioInstanceId);
+        ArrayList<String> instances = new ArrayList<String>();
+        instances.add(providerTenantId);
+        List<String> trustedTenants = this.getAuthorizedTenantIds(identityZoneId, instances);
         return trustedTenants.contains(providerTenantId);
     }
 
@@ -531,8 +533,13 @@ private boolean activateSites(List<Map> siteIds, String identityZoneId, String i
     }
 
     private String retrieveTenantId(String identityZoneId, String instanceId) {
+        return calculateHash(identityZoneId, instanceId);
+    }
+
+    private String calculateHash(String str1, String str2) {
         try {
-            return Utils.constructHashOf(identityZoneId, instanceId);
+            String retStr = Utils.constructHashOf(str1, str2);
+            return retStr;
         } catch (NoSuchAlgorithmException e) {
             logger.error(e.getMessage(), e);
         }
diff --git a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
index f71278dc..8b323939 100644
--- a/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
+++ b/tenant.provisioning/src/test/java/com/sap/portal/tenant/provisioning/webaccess/TenantsControllerTest.java
@@ -16,7 +16,9 @@
 import org.springframework.http.ResponseEntity;
 import org.springframework.test.context.ActiveProfiles;
 
+import java.util.ArrayList;
 import java.util.Arrays;
+import java.util.List;
 
 import static org.mockito.Mockito.*;
 
@@ -25,7 +27,7 @@
 public class TenantsControllerTest {
 
     @InjectMocks
-    private TenantsController tenantsController = new TenantsController();
+    private final TenantsController tenantsController = new TenantsController();
 
     @Mock
     private ITenantOperationsService tenantOperationsService;
@@ -50,7 +52,9 @@ public void before() {
     @Test
     public void onGetAllProvidersTenantsIds_expectSuccessResponse() {
         ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
-        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
+        List<String> filterInstances = new ArrayList<String>();
+        filterInstances.add(securityService.getPortalInstanceId());
+        verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), filterInstances);
         Assert.assertEquals(response.getStatusCode(), HttpStatus.OK);
     }
 
@@ -81,12 +85,13 @@ public void onGetAllProvidersTenantsIds_expectErrorResponse() {
         try {
 
             String identityZone = securityService.extractIdentityZoneIdFromJwt();
-            String instanceID = securityService.getPortalInstanceId();
-            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, instanceID);
+            List<String> filterInstances = new ArrayList<String>();
+            filterInstances.add(securityService.getPortalInstanceId());
+            doThrow(new IllegalArgumentException("some error")).when(tenantOperationsService).getAuthorizedTenantIds(identityZone, filterInstances);
 
             ResponseEntity response = tenantsController.getAllProvidersTenantsIds();
 
-            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), securityService.getPortalInstanceId());
+            verify(tenantOperationsService, times(1)).getAuthorizedTenantIds(securityService.extractIdentityZoneIdFromJwt(), filterInstances);
             Assert.assertEquals(response.getStatusCode(), HttpStatus.INTERNAL_SERVER_ERROR);
         } catch (IllegalArgumentException e) {
             Assert.fail(e.getMessage());

commons fix dif:
From 3d3ca4e54706a1a6090b8e46723e669cc797b8c6 Mon Sep 17 00:00:00 2001
From: shirly cohen <shirly.cohen@sap.com>
Date: Mon, 1 Jun 2020 16:27:03 +0300
Subject: [PATCH] commons impl with ut

---
 .../commons/security/SecurityUtil.java        | 53 +++++++++++++------
 .../commons/security/SecurityUtilTest.java    | 16 ++++++
 2 files changed, 53 insertions(+), 16 deletions(-)

diff --git a/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java b/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
index 46e4f2a..09a0306 100644
--- a/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
+++ b/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/security/SecurityUtil.java
@@ -1,15 +1,17 @@
 package com.sap.portal.platform.commons.security;
 
-import io.pivotal.labs.cfenv.CloudFoundryEnvironment;
-import io.pivotal.labs.cfenv.CloudFoundryEnvironmentException;
-import io.pivotal.labs.cfenv.CloudFoundryService;
-
+import java.util.ArrayList;
+import java.util.List;
 import java.util.Map;
 
 import org.apache.commons.lang3.StringUtils;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import io.pivotal.labs.cfenv.CloudFoundryEnvironment;
+import io.pivotal.labs.cfenv.CloudFoundryEnvironmentException;
+import io.pivotal.labs.cfenv.CloudFoundryService;
+
 public class SecurityUtil {
 
     private static final Logger logger = LoggerFactory.getLogger(SecurityUtil.class);
@@ -78,20 +80,39 @@ public static String getWorkzoneInstanceId() {
      * @return SCENARIOS enum
      */
     public static Scenario getScenarioId(String instanceId) {
-    	Scenario scenario;
-
-    	if (isPortalScenario(instanceId)) {
-    		scenario = Scenario.PORTAL;
-    	} else if (isLaunchpadScenario(instanceId)) {
-    		scenario = Scenario.LAUNCHPAD;
-    	} else if (isWorkzoneScenario(instanceId)) {
-    		scenario = Scenario.WORKZONE;
-    	} else {
-    		scenario = Scenario.APOLLO;
-    	}
-    	return scenario;
+        Scenario scenario;
+
+        if (isPortalScenario(instanceId)) {
+            scenario = Scenario.PORTAL;
+        } else if (isLaunchpadScenario(instanceId)) {
+            scenario = Scenario.LAUNCHPAD;
+        } else if (isWorkzoneScenario(instanceId)) {
+            scenario = Scenario.WORKZONE;
+        } else {
+            scenario = Scenario.APOLLO;
+        }
+        return scenario;
     }
     
+    /**
+     * 
+     * @return list of instanceIds which aren't  apollo
+     */
+    public static List<String> getInstanceIdsNotApollo() {
+    	List <String> instanceIds = new ArrayList<String>();
+    	for (Scenario scenario : Scenario.values()) {
+    		if(scenario != Scenario.APOLLO) {
+	    		String instanceId = getGeneralConfigurationCredentials().get(scenario.getScenarioId()).toString();
+	            if (instanceId != null) {
+	                logger.debug(String.format("instanceId: %s", instanceId));
+	                instanceIds.add(instanceId);
+	            }
+    		}
+		}
+    	return instanceIds;
+    }
+    
+    
     public static String getInstanceIdByScenario(Scenario scenario) {
         String retrievedInstanceId = (String)getGeneralConfigurationCredentials().get(scenario.getScenarioId());
         if (retrievedInstanceId != null) {
diff --git a/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java b/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
index 64ca051..efd4ee5 100644
--- a/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
+++ b/portal.platform.commons.cf/src/test/java/com/sap/portal/platform/commons/security/SecurityUtilTest.java
@@ -11,6 +11,8 @@
 import org.powermock.modules.junit4.PowerMockRunner;
 
 import java.io.IOException;
+import java.util.ArrayList;
+import java.util.List;
 
 @RunWith(PowerMockRunner.class)
 @PrepareForTest({Environment.class})
@@ -83,6 +85,20 @@ public void getScenarioId_test() throws IOException {
         Assert.assertEquals(SecurityUtil.Scenario.PORTAL, SecurityUtil.getScenarioId("b0f01a0c-62c8-4cfb-a105-2566fb2f55ff"));
     }
 
+    @Test
+    public void getInstanceIdsNotApollo_test() throws IOException {
+    	String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");
+        environmentVariables.set("VCAP_SERVICES", vcapServicesMock);
+        
+        List<String> expecedResult = new ArrayList<String>();
+        expecedResult.add("b0f01a0c-62c8-4cfb-a105-2566fb2f55ff");
+        expecedResult.add("50228b80-b7f4-4654-8fc5-3cda193fcc74");
+        expecedResult.add("ce9f4ac6-27ca-4695-b461-05b5c13ff40c");
+        
+        Assert.assertEquals(expecedResult, SecurityUtil.getInstanceIdsNotApollo());
+    }
+    
+    
     @Test
     public void isTokenValid_test() throws IOException {
         String vcapServicesMock = IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("VCAP_SERVICES.json"), "UTF-8");

            1.20.5.6 demo sprint review
https://account.int.sap.hana.ondemand.com/cockpit#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/6f8bc25c-ead3-4683-bbb1-81539f05562d/subaccountusers
subscriptions -> search LKG (Portal-admin-cockpit) -> Go to application (portal app) -> 

logs
ll /Users/i500695/work/SAP/logs/heliumLikeGetATZProvidersIDs
total 4592
drwxr-xr-x  6 i500695  staff   192B Jun  4 15:11 ./
drwxr-xr-x  7 i500695  staff   224B Jun  4 15:09 ../
-rw-r--r--  1 i500695  staff   1.1M Jun  4 15:09 logs_copy_CDM_Store_FT_ON
-rw-r--r--  1 i500695  staff   1.1M Jun  4 15:11 logs_copy_CDM_Store_FT_off
-rw-r--r--  1 i500695  staff   119K Jun  4 15:11 logs_copy_Provisioning_FT_off
-rw-r--r--  1 i500695  staff    12K Jun  4 15:09 logs_copy_provisioning_FT_ON

            1.20.5.7

        1.20.6   [S4 Federation] Support mass content CDM store Pagination Design
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1592

design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2280878311


            1.20.6.1   general

                1.20.6.1.1   Sasha's bug 
                https://sapjira.wdf.sap.corp/browse/DWPBUGS-257
as required in the https://sapjira.wdf.sap.corp/browse/EUXTEAMNADAV-489 we have to support sites with 3500 apps for the s$ scenario.
 
the cdm-store crashes out of memory while we are trying to assign a role with 3500 apps to a site.
 
    __    
   2020-05-17T13:06:30.11+0300 [APP/PROC/WEB/1] OUT { "written_at":"2020-05-17T10:06:30.119Z","written_ts":291567609476347,"component_id":"71d7c9ec-317e-458b-9174-7bcfb456708f","component_name":"portal-cf-cdm-store-service","organization_name":"","component_type":"application","space_name":"perfdev","component_instance":"1","organization_id":"","tenantId":"405498bc88f0ab3f594c60a48ac2bfe5","correlation_id":"43c29692-d0ff-464d-a18a-f2471a70be6f","space_id":"8cf9b88e-8a5c-4884-9aa8-3c9aea38c983","request_id":"293b6e86-ffa5-4c8d-4138-3a6fdabe92b9","container_id":"10.0.74.1","type":"log","logger":"com.sap.portal.cf.database.postgres.PostgresDataSource","thread":"http-nio-8080-exec-7","level":"INFO","categories":[],"msg":"getConnection() getting connection from PostgresDataSource" }
2020-05-17T13:06:30.11+0300 INFO 43c29692-d0ff-464d-a18a-f2471a70be6f  b'getConnection() getting connection from PostgresDataSource'
   2020-05-17T13:06:35.34+0300 [APP/PROC/WEB/1] ERR Resource exhaustion event: the JVM was unable to allocate memory from the heap.

                    1.20.6.1.1.1 Increase memory to 4GB


Hi Sacha,
I have prepared a PR for increasing the memory to 4GB - https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/481/files
I totally agree with you that we should support paging/lazy loading.
this is not reasonable to return such amount of data in one request - and no API should allow that IMHO.
I set a meeting for tomorrow to discuss the issue.
 
Thanks,
Jawad


                    1.20.6.1.1.2 Getting heap data

                        1.20.6.1.1.2.1 Getting heap data using http actuator

                            1.20.6.1.1.2.1.1 How to



-> 
Dear Margieh, Jawad , in order to acquire a java heapdump , can you create an FB with this heapdump actuator https://docs.spring.io/spring-boot/docs/current/actuator-api/html/#heapdump. 
I'll patch the system and we'll look inside.
Another approach can be printing the entire queries and identifying the guilty one


-> 
Hi Kravchik, Alexander ,
Please use the following branch for deploying cdm-store-service
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/482
actuator can be accessed through:
/cdm_store_service/management
username: sre_user
password: 1q2W3e4R
See attached screenshot, ENJOY 

-> API for dump
/cdm_store_service/management/heapdump 

                        1.20.6.1.1.2.2 code diff
-> CDM store branch: actuator

[i500695@C02X632CJGH6:2020-06-17 12:23:08:~/work/SAP/git/portal-cf-cdm-store-service:]2017$ gitdiffToFrom master actuator > ~/temp/cdm_store_actuator_diff
[i500695@C02X632CJGH6:2020-06-17 12:23:23:~/work/SAP/git/portal-cf-cdm-store-service:]2018$ cat !$
cat ~/temp/cdm_store_actuator_diff
diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfig.java b/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfig.java
index a3ec3afe..584750bc 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfig.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfig.java
@@ -11,12 +11,12 @@ import org.springframework.context.annotation.Bean;
 import org.springframework.context.annotation.ComponentScan;
 import org.springframework.context.annotation.Configuration;
 import org.springframework.context.annotation.Profile;
+import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
 import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
 import org.springframework.security.config.annotation.web.builders.HttpSecurity;
 import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
+import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
 import org.springframework.security.config.http.SessionCreationPolicy;
-import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
-import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
 import org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter;
 
 import static org.springframework.http.HttpMethod.GET;
@@ -27,11 +27,10 @@ import static org.springframework.http.HttpMethod.GET;
  */
 @Configuration
 @EnableWebSecurity
-@EnableResourceServer
 @EnableGlobalMethodSecurity(prePostEnabled = true)
 @ComponentScan(basePackageClasses = {SecurityBasePackage.class, CommonsPlatformConfig.class})
 @Profile("cloud")
-public class WebSecurityConfig extends ResourceServerConfigurerAdapter {
+public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
 
     @Autowired
     TenantFilter tenantFilter;
@@ -53,12 +52,23 @@ public class WebSecurityConfig extends ResourceServerConfigurerAdapter {
                 .addFilterAfter(providerTenantAuthorizationFilter, CrossTenantAuthorizationFilter.class)
                 // Session is created by approuter
                 .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.NEVER).and().authorizeRequests()
-                .antMatchers(GET, "/cdm_store_service/management/**").denyAll()
+                .antMatchers("/cdm_store_service/management/**").hasRole("ACTUATOR_ROLE")
+                .and().httpBasic()
+                .and().authorizeRequests()
                 .antMatchers(GET, "/cdm_store_service/portal_api/**").permitAll()
                 .antMatchers("/cdm_store_service/cdm/**").permitAll()
                 .anyRequest().permitAll();
     }
 
+    @Autowired
+    public void configureGlobal(AuthenticationManagerBuilder auth)
+            throws Exception {
+        auth.inMemoryAuthentication()
+                .withUser("sre_user")
+                .password("{noop}1q2W3e4R")
+                .roles("ACTUATOR_ROLE");
+    }
+
     //configure offline verification which checks if any provided JWT was properly signed
     @Bean
     protected SAPOfflineTokenServicesCloud offlineTokenServices() {
diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfigMock.java b/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfigMock.java
index fd1723fa..be01bf47 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfigMock.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/security/config/WebSecurityConfigMock.java
@@ -6,15 +6,22 @@ import com.sap.portal.cf.security.filters.ProviderTenantAuthorizationFilter;
 import com.sap.portal.cf.security.filters.TenantFilter;
 import com.sap.portal.platform.commons.CommonsPlatformConfig;
 import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.context.annotation.Bean;
 import org.springframework.context.annotation.ComponentScan;
 import org.springframework.context.annotation.Configuration;
 import org.springframework.context.annotation.Profile;
+import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
 import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;
 import org.springframework.security.config.annotation.web.builders.HttpSecurity;
 import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
+import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
 import org.springframework.security.config.http.SessionCreationPolicy;
+import org.springframework.security.core.userdetails.User;
+import org.springframework.security.core.userdetails.UserDetails;
+import org.springframework.security.core.userdetails.UserDetailsService;
 import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;
 import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;
+import org.springframework.security.provisioning.InMemoryUserDetailsManager;
 import org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter;
 
 import static org.springframework.http.HttpMethod.GET;
@@ -25,11 +32,10 @@ import static org.springframework.http.HttpMethod.GET;
  */
 @Configuration
 @EnableWebSecurity
-@EnableResourceServer
 @EnableGlobalMethodSecurity(prePostEnabled = true)
 @ComponentScan(basePackageClasses = {SecurityBasePackage.class, CommonsPlatformConfig.class})
 @Profile({"dev", "test"})
-public class WebSecurityConfigMock extends ResourceServerConfigurerAdapter {
+public class WebSecurityConfigMock extends WebSecurityConfigurerAdapter {
 
     @Autowired
     TenantFilter tenantFilter;
@@ -52,9 +58,20 @@ public class WebSecurityConfigMock extends ResourceServerConfigurerAdapter {
                 .addFilterAfter(providerTenantAuthorizationFilter, CrossTenantAuthorizationFilter.class)
                 // Session is created by approuter
                 .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.NEVER).and().authorizeRequests()
-                .antMatchers(GET, "/cdm_store_service/management/**").denyAll()
+                .antMatchers("/cdm_store_service/management/**").hasRole("ACTUATOR_ROLE")
+                .and().httpBasic()
+                .and().authorizeRequests()
                 .antMatchers(GET, "/cdm_store_service/portal_api/**").permitAll()
                 .antMatchers("/cdm_store_service/cdm/**").permitAll()
                 .anyRequest().permitAll();
     }
+
+    @Autowired
+    public void configureGlobal(AuthenticationManagerBuilder auth)
+            throws Exception {
+        auth.inMemoryAuthentication()
+                .withUser("sre_user")
+                .password("{noop}1q2W3e4R")
+                .roles("ACTUATOR_ROLE");
+    }
 }
diff --git a/cdm.store.service/src/main/resources/application.properties b/cdm.store.service/src/main/resources/application.properties
index 265acf8c..1aa4bafd 100644
--- a/cdm.store.service/src/main/resources/application.properties
+++ b/cdm.store.service/src/main/resources/application.properties
@@ -2,7 +2,7 @@ spring.data.rest.default-page-size= 20
 server.servlet.context-path=/cdm_store_service
 #server.port=9090	
 #prefix for all actuator rests	
-management.endpoints.web.base-path=/cdm_store_service/management
+management.endpoints.web.base-path=/management
 # expose all endpoints:	
 management.endpoints.web.exposure.include=*
 management.cloudfoundry.enabled=true


-> also skip tenant filtering...
diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/TenantFilter.java b/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/TenantFilter.java
index 369aeae8..5919218a 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/TenantFilter.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/TenantFilter.java
@@ -17,6 +17,8 @@ public class TenantFilter implements Filter {
 
     private final ILoggerService logger = new LoggerService(this.getClass());
 
+    private final String MGMT_PATH = "/cdm_store_service/management";
+
     private final String HEALTHCHECK_PATH = "/cdm_store_service/portal_api/is_alive";
 
     private final String TOGGLE_PATH = "/cdm_store_service/cdm/setPostgresql";
@@ -37,7 +39,7 @@ public class TenantFilter implements Filter {
 
         String uri = ((HttpServletRequest) request).getRequestURI();
 
-        if (uri.startsWith(HEALTHCHECK_PATH) || uri.startsWith(TOGGLE_PATH) || uri.startsWith(TOGGLE_PATH_STATUS)) {
+        if (uri.startsWith(MGMT_PATH) || uri.startsWith(HEALTHCHECK_PATH) || uri.startsWith(TOGGLE_PATH) || uri.startsWith(TOGGLE_PATH_STATUS)) {
             filterChain.doFilter(request, response);
         } else if (tenantContext.setCurrentTenant(((HttpServletRequest) request).getHeader("mockTenantId"), ((HttpServletRequest) request).getHeader("mockIsProviderTenant"))) {
             String currentTenantId = CurrentTenantHolder.getCurrentTenant();

                        1.20.6.1.1.2.3
                    1.20.6.1.1.3
                1.20.6.1.2

we want to support several S/4 Hana systems connected to cFLP, Design time should be able to work with large amount of entities (role) coming from S4 or any other content provider
User Story
As an admin I want to have an ability to see and manage all the S4 content provider that I have connected in Design time. without any failures or crashes. 
General \ Technical Information
Support pagination in CDM store including CDM client 
Design only
Agree on APIs with our consumers (activation, Client; sematic etc...)
oData service APIs support 
Export 
Client side integration 
Wiki with Breakdown and EE 
Design Review  with all relevant consumers POs architects 
Pagination of CDM Store implementation side has to be backwards compatible since the adoption of the pagination will take us 2 waves and should be one step at a time without the need for a toggle to all services at once.
 
Acceptance Criteria
Design
Pagination of CDM Store implementation side has to be backwards compatible since the adoption of the pagination will take us 2 waves and should be one step at a time without the need for a toggle to all services at once.
Breakdown & EE 
Design review 

            1.20.6.2 Profiling cdm store java process

                1.20.6.2.1 enable JMX on CF
Java heap & CPU profiling - hprof

Generate hprof

On the fly:
map -dump:file=<file_name> <pid>



Profiling java process on cloud foundry space

https://stackoverflow.com/questions/50154815/how-to-profile-memory-of-a-spring-boot-webapp-running-on-cloud-foundry



A1.

* https://content.pivotal.io/blog/new-cloud-foundry-java-buildpack-improves-developer-diagnostic-tools
* https://community.pivotal.io/s/article/How-to-Remotely-Debug-Java-Applications-on-Cloud-Foundry
a. Run your app with JMX settings
* To test profiling on your local machine run theapp with the following JMX configuration and then go to the last step "3. VisualVM configuration": java \
* -Dcom.sun.management.jmxremote=true \
* -Djava.rmi.server.hostname=localhost \
* -Dcom.sun.management.jmxremote.port=9999 \
* -Dcom.sun.management.jmxremote.rmi.port=9999 \
* -Dcom.sun.management.jmxremote.ssl=false \
* -Dcom.sun.management.jmxremote.authenticate=false \
* -jar theapp.jar ... 
* To pass the JMX configuration to theapp in CF use the JBP_CONFIG_JMX environment variable (or JAVA_OPTS with params as above), manifest.yml: applications:
*   - name: theapp
*     buildpack: java_buildpack
*     env:
*       JBP_CONFIG_JMX: "{enabled: true, port: 9999}"
*       # JAVA_OPTS: "-Dcom.sun.management.jmxremote=true -Djava.rmi.server.hostname=localhost -Dcom.sun.management.jmxremote.port=9999 -Dcom.sun.management.jmxremote.rmi.port=9999 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false" 
b. Create SSH tunnel to theapp's container
cf ssh -N -T -L 9999:localhost:9999 theapp
c. VisualVM configuration
* Download VisualVM
https://visualvm.github.io/download.html

* Run VisualVM: visualvm --jdkhome "$JAVA_HOME"
* Add JMX connection: localhost:9999


You can also create SSH tunnel using PuTTY
* Retrieve and display theapp's guid:cf app theapp --guid
* # example: 12345678-1234-1234-1234-123456789012 
* Get a one time password for ssh clients: cf ssh-code
* # example: PolSkAjEzyKtrUdnA 
* Create PuTTY SSH connection:
    * hostname: theapp.your.cloud
    * port: 2222
    * username: cf:<app-guid>/<app-instance-index>@ssh.your.cloud
        * example: cf:12345678-1234-1234-1234-123456789012/0@ssh.your.cloud
    * password: <ssh-code>
        * example: PolSkAjEzyKtrUdnA
    * connection/ssh/tunnels/:
        * source port: 9999
        * destination: 127.0.0.1:9999




                1.20.6.2.2

            1.20.6.3 Action plan

-> baseline 
API: https://portal-service-perfdev.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/search\?isFullCdm\=true\&withRelationTypes\=ref,extends\&contextId\=b4c214a5-55d3-46c2-bada-a12cda7aba2d\&contextType\=site\&consumerIdentityZoneId\=56159c90-66d5-42e5-a865-3b61dc04a549\&instanceId\=a8c79e84-073f-4079-a224-0b6943c9f86

used 4 activation. 
1 TPS. 3.5k entities. cdm store crashes. heap exhausted

improve to return stream response.
3 TPS. no crash response time 40 sec.

Paging PoC.
->
            1.20.6.4 Sasha's Gatling system
            cf t -o  swzperf -s perfdev

-> local git repo, 
cdgatling
~/work/SAP/git/cf-gatling

-> take dumps
[i500695@C02X632CJGH6:2020-06-28 10:10:01:~:]2008$ cf v3-ssh portal-cf-cdm-store-service 
This command is in EXPERIMENTAL stage and may change without notice

vcap@534a8331-8fe4-44be-6fb6-24b5:~$ find . -name '*hprof'
./app/META-INF/.sap_java_buildpack/dynatrace_one_agent/log/memorydump/20200628071019_6/dump.hprof

 cf v3-ssh portal-cf-cdm-store-service -c 'cat /home/vcap//app/META-INF/.sap_java_buildpack/dynatrace_one_agent/log/memorydump/20200628071019_6/dump.hprof ' > dump_idle_Java11.hprof

 cf v3-ssh portal-cf-cdm-store-service -c 'cat /home/vcap/app/META-INF/.sap_java_buildpack/dynatrace_one_agent/log/memorydump/20200628071809_6/dump.hprof ' > dump_single_Java11.hprof
 
 

                1.20.6.4.1 API, get entities with relations, maas content
https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/10_S4/job/investigation-cdm-store-API-regression-gatling-ci/
gatling -> statistics

Dynatrace link: https://apm.cf.sap.hana.ondemand.com/e/a99e550a-83e2-4ec7-994f-16fd347f05b2/

select perfdev 

                1.20.6.4.2 API, get entities with relations, normal content, nightly
I've implemented the same test in my nightly without the mass content https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/1_portal-nightly/job/portal-cdm-store-API-regression-gatling-ci/

API: "/cdm_store_service/cdm/entities/search?isFullCdm=true&withRelationTypes=ref,extends&contextId=${user_prefix}-${site_id}" +
    "&contextType=site&consumerIdentityZoneId=${tenantId}&instanceId=${instanceId}"

VM params for Sasha's space:

-DUSERS=1
-DSLEEPTIME=0
-DTESTDURATION=30
-DINTERNALURL=https://portal-service-perfdev.cfapps.sap.hana.ondemand.com
-DUAAURL=https://swzperf.authentication.sap.hana.ondemand.com
-DCLIENTID=sb-portal-cf-service-perfdev!b11680
-DCLIENTSECRET=U3uOAhp8VKa7mBd9BOF19/BmirY=
-DTENANTID=56159c90-66d5-42e5-a865-3b61dc04a549
-DINSTANCEID=a8c79e84-073f-4079-a224-0b6943c9f86b
-DSITESCSV=cflp/100_sites.csv
-DLOCALPROXY=false
-DUSERSCSV=cflp/fsrt_users.csv

util alias 2 extract the values:
$ printCFAUTHENV  portal-cf-cdm-store-service
print CF auth params for app portal-cf-cdm-store-service
This command is in EXPERIMENTAL stage and may change without notice

clientid=sb-portal-cf-service-perfdev!b11680
clientsecret=U3uOAhp8VKa7mBd9BOF19/BmirY=
portalServiceUrl=https://portal-service-perfdev.cfapps.sap.hana.ondemand.com
url=https://swzperf.authentication.sap.hana.ondemand.com

Can run either via IntelliJ -> engine -> run
or CLI
mvn   gatling:test -P cdm_store_apis.Get_Entities_With_Relations_Per_Site_Executor '-DUSERS=1' '-DSLEEPTIME=0' '-DTESTDURATION=30' '-DINTERNALURL=https://portal-service-perfdev.cfapps.sap.hana.ondemand.com' '-DUAAURL=https://swzperf.authentication.sap.hana.ondemand.com' '-DCLIENTID=sb-portal-cf-service-perfdev!b11680' '-DCLIENTSECRET=U3uOAhp8VKa7mBd9BOF19/BmirY=' '-DTENANTID=56159c90-66d5-42e5-a865-3b61dc04a549' '-DINSTANCEID=a8c79e84-073f-4079-a224-0b6943c9f86b' '-DSITESCSV=cflp/100_sites.csv' '-DLOCALPROXY=false' '-DUSERSCSV=cflp/fsrt_users.csv'

Jenkins job:
https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/10_S4/job/investigation-cdm-store-API-regression-gatling-ci/

                1.20.6.4.3 a short how to  for the API load tests

                    1.20.6.4.3.1 VM values for Shlomi system 



explanation:
-DUSERS=1
-DTESTDURATION=30
-DSLEEPTIME=2
-DRAMPDURATION=2
-DUAAURL= PaaS UAA URL
-DPORTALURL= SaaS Approuter URL
-DMUENCHAUSEN=https://xsuaa-monitoring-idp.cfapps.sap.hana.ondemand.com
-DCLIENTID=shlomi
-DCLIENTSECRET=shlomi
-DINTERNALURL=direct url to service. ex: https://swzsaasperf.perfnightly.dt.cpp.cfapps.sap.hana.ondemand.com
-DASSETS_CLIENTID=shlomi
-DASSETS_CLIENTSECRET=shlomi
-DREDIRECT=/cp.portal/xs-app.json
-DUSERPREFIX=user
-DUSERSCSV=users.csv
-DPASSWORD=Abcd1234
-DROUTESPREFIX=/cp.portal
-DLOCALPROXY=false
-DTENANTID=tenant ID, cf env <service-name> | jq <parse user provided, then launchpadInstanceId/portalInstanceId/workzoneInstanceId>
-DINSTANCEID=instance ID, cockpit, go to subscriber (SaaS), subscriber id. 


                    1.20.6.4.3.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/docs/add_APIs_to_the_test_suite.md,
                also in notes

Basically you'll copy paste this https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/gatling/src/test/scala/cdm_store_apis/Get_Entities_With_Relations_Per_Site_Executor.scala

and modify here https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/gatling/src/test/scala/cdm_store_apis/Get_Entities_With_Relations_Per_Site_Executor.scala#L47

more details:
How to add your API to the test suite
This guide helps you add your APIs to the load test suite. I took portal-cf-sdm-store-service as an example

Choose relevant package

If you want your test to run as a part of one of the existing suites choose a relevant package, for instance cdm_store_apis package contains portal-cf-sdm-store-service tests:

gatling/src/test/scala/cdm_store_apis

Configure your local environment



Create a separate executor for each API

Copy the gatling/src/test/scala/cdm_store_apis/Get_Entities_With_Relations_Per_Site_Executor.scala Paste it as a new Class with a meaningful name

Configure your test

//this will appear on the report transaction name:
  val requestDisplayName: String = "Search CDM Entities with Relations"
//this is the API path, coming after the BASE_URL:
  val apiPath: String = "/cdm_store_service/cdm/entities/search?isFullCdm=true&withRelationTypes=ref,extends&contextId=${user_prefix}-${site_id}" +
    "&contextType=site&consumerIdentityZoneId=${tenantId}&instanceId=${instanceId}"
// JSON payload that you can send in the request body
  val jsonRequestPayload = "{}"
// response verification string 
  val responseValidation: String = "${user_prefix}-${site_id}"  
Give your scenario a meaningful name

val loadScenario = scenario("<your meaningful name here!>")
Change the token additional attributes if required

 val azattr: String =
    """{"az_attr":{
      |    "tenantId":"${tenantId}",
      |    "instanceId":"${instanceId}",
      |    "isProvider":"false",
      |    "userName":"Jawad"}}
    """.stripMargin
Configure / Add assertions if required

 .assertions(
      global.failedRequests.percent.lt(0.5),
      global.responseTime.mean.lt(200),
      global.responseTime.percentile4.lt(500), //%99
    )
    
Execute locally with a debugging proxy

Push to your FB, make a PR

Q&A
q: I want to create a new package, additional steps ?

a: new profile in the pom.xml

 <profile>
            <id>cdm_store_apis</id>
            <properties>
                <include>cdm_store_apis.*</include>
                <exclude>libs.*</exclude>
            </properties>
        </profile>
q: Where I see the nightly results of my tests ?

a: https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/1_portal-nightly/ , ask me to add your user

                    1.20.6.4.3.3

                1.20.6.4.4
            1.20.6.5 Additional use case. Content manager get local content
              (cherry-picked roles)
https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/semantic/entity?contextId=SUB_ACCOUNT&contextType=SUB_ACCOUNT

calls to:
    async getAllContentRelatedEntities(contextId, contextType, reqContext) {
        logger.logRequestMessage(reqContext.logger, 'debug', 'StoreClient::getAllContentRelatedEntities() - retrieving content related entities. context id: %s context type: %s', contextId, contextType);

        let customProjection = {
            "/cdm/identification/id": {"alias": "id"},
            "/cdm/identification/entityType": {"alias": "entityType"},
            "/cdm/identification/title": {"alias": "title"},
            "/cdm/identification/description": {"alias": "description"},
            "/cdm/relations/base": {"alias": "base"},
            "/cdm/payload/targetAppConfig/sap.flp/type": {"alias": "flpType"}
        };

        const cdmStoreClient = await this.getCdmStoreClient(reqContext);

        const match = [
                {
                    "/cdm/identification/entityType": entityTypes.BUSINESSAPP
                },
                {
                    "/cdm/identification/entityType": entityTypes.CATALOG
                },
                {
                    "/cdm/identification/entityType": entityTypes.GROUP
                },
                {
                    "/cdm/identification/entityType": entityTypes.ROLE
                }
            ];

        const searchConfig = StoreRequestBuilder.buildSearch(null, null, null, match, customProjection);

        return cdmStoreClient.getEntitiesWithSearch(contextId, contextType, searchConfig, {
            showBrokenEntities: false
        });
    }


calls cdm store client:
  public async getEntitiesWithSearch(contextId: string, contextType: string, search: Search, config?: Config): Promise<any[]> {
    this.logger.verbose(`${CdmStoreClientHandler.name}::${this.getEntitiesWithSearch.name}(): contextId = ${contextId}, contextType = ${contextType}, search = %s`, search);

    const customSearch: Search = this.createSearchForGetEntities(search);

    let response;
    try {
      let serviceRequest = this.serviceRequestBuilder
        .createRequest()
        .addParam("withRelationTypes", "extends")
        .addParam(CdmStoreClientConstants.CONTEXT_ID, contextId)
        .addParam(CdmStoreClientConstants.CONTEXT_TYPE, contextType);

      if (config && config?.consumerIdentityZoneId) {
        serviceRequest.addParam("consumerIdentityZoneId", config.consumerIdentityZoneId)
      }
      if (config && config?.instanceId) {
        serviceRequest.addParam("instanceId", config.instanceId)
      }

      response = await serviceRequest.post(`/cdm/entities/search`, {search: customSearch});
    } catch (err) {
      this.logger.error(`${CdmStoreClientHandler.name}::${this.getEntitiesWithSearch.name}(): error = ${err.message}. stack trace = ${err.stack}`);
      throw new CdmStoreServerErrorException(err);
    }
    let result: any[] = [];
    try {
      if (response && response?.data && !_.isEmpty(response?.data)) {
        this.logger.debug("CdmStoreClientHandler::getEntitiesWithSearch(): response from cdm-store-service = %s", response.data);
        result = this.calculateResultFromSearchReturns(search, customSearch, response, config);
      }
    } catch (err) {
      this.logger.error(`${CdmStoreClientHandler.name}::${this.getEntitiesWithSearch.name}(): error = ${err.message}. stack trace = ${err.stack} `);
      throw new CdmStoreClientException(err.message);
    }
    return result;
  }




HI All,
 
As part of Mass content S4 federation delivery please find below performance test server side + single user as define with @Sarfati, Dana
 
Scenario:
Simulate cherry-pick  of s4  content  with different number of systems which provide by QKY:
1 system = 520 Roles
2 systems = 1040 Roles
3 systems = 1560 Roles
4 systems = 2080 Roles
5 systems = 2600 Roles
Content:
Our machine (QKY) expose 520 roles and  I created 5 providers to simulate mass content.
Tested environment:
Provider : perftest (under perflabdt)
Link to the environment : https://perflabdtsubs4.perftest.dt.launchpad.cfapps.sap.hana.ondemand.com/sites#Site-Directory
Results:
 
 
Num# of Systems@S4 Num# of Roles Cherry picke-Add to my content response time Get entity - Resolving response time Navigation to content manger E2E – response time Status of cherry picked transaction
1 520 9.2 sec 1.4 sec 15 sec Failed -The content added although  we get 500
2 1040 9.4 sec 2.6 sec 16 sec Failed -The content added although  we get 500
3 1560 9 sec 3.7 sec 17 sec Pass
4 2080 8.5 sec 4.7 sec 30 sec Pass 
5 2600 7.12 sec Failed - 500 - Internal Server Error No content to view Pass
 
 
 
Triggered Cherry picked for 520 roles provided by s/4 (added to my content ) and I get on the response  500 Internal Server Error " {"status":500,"originOfError":"CDMStoreError","data":{}}"  
Although we get error (500) on the response  and notification "the content cannot added" the content eventually added to my content  - Recommended to investigate @Dagan, Saar @Moskovich, Guy – logs and report from Dynatrace will be send on demand .
As the table results there is correlation between the numbers of roles to the response time of "get entity" (server side) which include resolving process and also the response time E2E to navigation to content manger from site directory as expected.
Client side- Response time E2E start with 15 sec up to 30 sec , as you can see on image#1 the main bottleneck  is sap ui5 rendering , attached profiling file via "java script profiler" (dev tool)
Server side- "get entity" (include resolving) start with 1.4 sec up to 4.7 sec – highly recommended to integrate the request of "get entity" on the end of loading site directory so navigation to content manger will more responsive (perceived performance)  @Sarfati, Dana@Limor, Shani@Tito, Meni
With 5 system cherry picked the request to  "get entity" API response was 500 - Internal Server Error and therefor there is no content to view on content manger (image#2 and image #3).  @Moskovich, Guy @Sarfati, Dana
Select all (roles) Butten on cherry picked took ~13 sec and the add to my content Butten took ~10 sec until the request fired (on network@devtool) @Sarfati, Dana  


            1.20.6.6 

        1.20.7 EUXTEAMSAAR-1594    [Support Custom Tiles] Handle references for external providers
related - EUXTEAMSAAR-1461  [Support Custom Tiles] Add automatically global provider in provisioning service 

            1.20.7.1 Links
BLI:  https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1461
Motivation
Support custom tiles
Support custom tiles coming from S4 content providers and also CF content providers 

User Story:
As an admin I would like to get my custom tiles also in cFLP from any content provider 

General \ Technical Information
Global provider = Smart Business Tiles service (like CF provider provided by SAP or provided by customers)
Global provider should be automatically subscribe to all Launchpad customers. This provider will provide viz type for S4 business tiles (custom tiles).
Generic support custom tiles from S4 and CF federation.
Provisioning service
Handle existing customers (do we need separate BLI?)
Design and implementation 
In design what we should do with our existing customers 
https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+Custom+Tiles+Support
more detailed: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+Custom+Tiles+Support#id-[cFLP]CustomTilesSupport-TotalEffortestimations=Between2.25XLand2.7XL
HL approach https://wiki.wdf.sap.corp/wiki/display/CPPortals/Referencing+Custom+vizTypes

Acceptance Criteria
We should add automatically global provider to all cFLP customers, in provisioning
Design and implementation (generic approach)
handle existing customers based ob design (separate BLI or this one) 
Toggle off 
Provisioning service: Global provider provided by sap or by customers, should be automatically available in all products: Portal, Launchpad and SWZ (all types)

Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BcFLP%5D+Support+Custom+Tiles
Test scope:

            1.20.7.2 Design, tags: Global Provider smartbusiness 
            Business service externalize vizTypes (custom tiles).
Currently we will have one Global provider for all S4 content providers.
Take into account: That implementation should support also several Global providers.
All customers can access the global provider without subscription.

The Global provider snapshot will be created as part of the cf federation deployment as simple a cf provider.
Deploying the global provider's mtar creates this provider in the tenant info table.
When calling to getAuthorizedTenants in provisioning service, that provider will be returned as all other providers.
Important!
Don't create local provider for the global provider during getAuthorizedTenants !!!
  Each provider will have:
Provider id.
Namespace.
Tenant id.
Instance id.
Identity zone.
Namespace
Example: ssuite.smartbusiness.tiles 
Namespace is a unique identifier for the Global provider.
The global provider will have a unique namespace, which can be used by the referencing vizTypes.
The namespace is defined in the global provider's mtar.

Namespace is unique for all landscape, provider id and tenant will be change per landscape.


VizType Entity
vizType are entities supported in core and should be added in portal schema.
Currently they are referenced from a business app under visualizations.
vizType id will be composed from the global provider namespace.
Example: ssuite.smartbusiness.tiles.viz1

In order to identify the namespace of the global provider, we will take the prefix of the vizType id - until last dot.
vizType Portal schema
Update for the portal schema should be done to support vizType entity. 
After the update, CDM-STORE tests need to be run to make sure that there are no regression failure
viztype.json:

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Common data model design time - Viz Type Entity",
  "$extends": {
    "path": "cdm://core/viztype.json"
  },
  "properties": {
    "relations": {
      "type": "object",
      "properties": {
        "base": {
          "description": "reference to base viz-type",
          "type": "array",
          "items": {
            "$ref": "relation.json"
          }
        }
      }
    },
    "texts": {
      "$ref": "texts.json"
    }
  }
}
example cdm-schema/examples/portal/viztype.json
{
  "_version": "3.0.0",
  "identification": {
    "id": "ssuite.smartbusiness.tiles.viz1",
    "entityType": "viztype",
    "title": "{{title}}"
  },
  "payload": {
    "vizTypeConfig": {}
  },
  "relations": {
    "viztypes": [
      {
        "label": "extends",
        "target": {
          "id": "ssuite.smartbusiness.tiles.viz1",
          "entityType": "viztype",
          "context": {
            "id": "Context Id",
            "type": "SNAPSHOT"
          }
        }
      }
    ]
  }
}
Handle references for external providers
Phase 1: Update relations from Business app to vizType in the same context
During transport process we get the business apps from S4 content.
In the business app's payload we get the vizType.
We should add the vizType in the Relations.
This is the vizType that the business app refers to.
Important points to take care:
Add also the tenant id, because in theory another provider which isn't global provider can exist with the same id.
Check if this vizType already exists.
Business app can refer to only one vizType. - Check with Amir


Phase 2: Cross context Reference - Cherry pick creation
Create cherry pick vizType object with: entity id: ssuite.smartbusiness.tiles.viz1 and entity type: vizType
VizTypes from one consumer snapshot should reference to other viz-types from Global provider.
It is required to know the provider-id, tenant and namespace of the corresponding global provider.

How we create the reference from vizType to vizType from the Global provider?
We will create relation from the cherry picked vizType in the consumer snapshot to the vizType in the Global provider.
The relation object will include the following fields:
ContextId - the provider id of the global provider - will be taken from the global provider configuration - from the api GET /providers/{namespace}
ContextType - SNAPSHOT
Tenant - will be taken from the global provider configuration - from the api GET /providers/{namespace}.
EntityType - vizType
EntityId - namespace[.] entityId(the entity id will be the same as the vizType's entityId from the consumer snapshot).

Example:
We have the following business app from S4 content:
In the business app's payload we get the vizType.
The vizType id composed from namespace and the id.
means, the namespace is: ssuite.smartbusiness.tiles and the entity id is: ssuite.smartbusiness.tiles.numeric


{
  "_version": "3.0",
  "identification": {
    "id": "F541859F6DB4C2DFC0C9DA6A1C59261D",
    "entityType": "businessapp",
    "title": "{{title}}"
  },
  "payload": {
    "visualizations": {
      "00O2TPKTQCDUX68P4QWZYDIG9": {
        "vizType": "ssuite.smartbusiness.tiles.numeric",
        "vizConfig": {
          "sap.app": {
            "title": "{{viz.00O2TPKTQCDUX68P4QWZYDIG9.title}}",
            "subTitle": "{{viz.00O2TPKTQCDUX68P4QWZYDIG9.subTitle}}",
            "dataSources": {
              "SSB": {
                "uri": "/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV",
                "type": "OData"
              }
            }
          }
        }
      }
    }
  }
}
phase 1: create the reference from business app to the cherry pick
We need to add in the relations the referred vizType.
** The context id is the provider id that initiate the transport - NOT Global provider id!!!
"relations": {
  "viztypes": [
    {
      "label": "ref",
      "target": {
        "id": "ssuite.smartbusiness.tiles.numeric",
        "entityType": "viztype",
        "context": {
          "id": "shirly_s4",
          "type": "SNAPSHOT"
        }
      }
    }
  ]
}

phase 2: Create the cherry pick entity
{
  "_version": "3.0.0",
  "identification": {
    "id": "ssuite.smartbusiness.tiles.numeric",
    "entityType": "viztype",
    "title": "{{title}}"
  },
  "payload": {
    "vizTypeConfig": {}
  },
  "relations": {
    "viztypes": [
      {
        "label": "extends",
        "target": {
          "id": "ssuite.smartbusiness.tiles.numeric",
          "entityType": "viztype",
          "context": {
            "id": "GlobalProviderId",
            "type": "SNAPSHOT"
          }
        }
      }
    ]
  }
}

should add namespace as prefix to id to avoid collisions.

            1.20.7.3 Tests
            1.20.7.4 Tasks

                1.20.7.4.1 transport-service

                    1.20.7.4.1.0 Add vizType to Portal schema – 4 pds
                    add schema, example, template (4 consumption by transport code)

PR: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/225

Diffs: <URL:/Users/i500695/work/SAP/PRs/cdm-schema/225_viztypes>


                    1.20.7.4.1.1 Create vizType cherry pick and reference to global provider cherry pick – 7 pds
branch: yosi_30_06_20__17_05

~/work/SAP/git/cdm-schema:]2075$ cp resources/portal-cdm-templates/viztype.default.json /Users/i500695/work/SAP/git/portal-cf-transport-service/node_modules/cdm-schema/dist/resources/portal-cdm-templates/section.default.json

    if businessapp has custom-viztype create entity, plus add relation


    new IExportCreator impl class.
Note, for section we use a template in schema. 
ex:
    private readonly entityTemplatePath = 'cdm-schema/dist/resources/portal-cdm-templates/';
    private readonly sectionEntityFileName = 'section.default';

in schema. /Users/i500695/work/SAP/git/cdm-schema/resources/portal-cdm-templates/section.default.json


update files:
 src/cdm/cdm-entity-creator.service.ts, src/cdm/cdm.client.module.ts
 /Users/i500695/work/SAP/git/portal-cf-transport-service/src/cdm/creators/viztype-creator.ts
 .../resources/some_content_json.json

UT:
 test/cdm/viztype-creator.service.spec.ts 

Notes:
a. in created viztype no need for translation, config b/c its a cherry-pick entity
b. Call provisioning GET /provider/{namespace}  to get provider ID and tenant ID
check viztype id, e.g.
          "id": "ssuite.smartbusiness.tiles.numeric",
ssuite.smartbusiness.tiles part is namespace.
check is embeded provider.
If yes, create entity viztype
if no, just create relation but in the end of transport check if snapshot viztype exists. If not, report, like in URL template.
c. Send tenant ID in import, in metadata base ?? (confirm w/ Gil) 


                    1.20.7.4.1.2 Activate store client for adding viztype relations + add UT. 
                    already done by Alina
Note, custom-viztype in HTML5_APP_REPO (helium) relations are created by DTS (design-time-service)


                        1.20.7.4.1.2.1 Add viztype relations PR in store client. Alina.
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/112/files

diff: <URL:/Users/i500695/work/SAP/PRs/cdm-store-client/112_custom_viztypes>

                        1.20.7.4.1.2.2
                    1.20.7.4.1.3 Verify in sync that cherry pick vizType deleted and a new one is created – 2pds
need to create anyway. so will overrun existing if any custom-vizType . similar to sections
Just test E2E.


                    1.20.7.4.1.4 Update transport report when vizType doesn't exist in the Global provider  - 4 pds
    Create 2 searches. For the global provider and for the vizType.
    In store client / or in transport 
    Then update report in transport 
    UT client transport

                    1.20.7.4.1.5 Update transport report when vizType doesn't exist in the Global provider  - 4
getEntity() for custom-vizType
if not update report


                    1.20.7.4.1.6 Update transport report when global provider with the given namespace doesn't exist – 3 pds
    /providers/{namespace} global provider 
    response:
    {
    "tenantId": "tenant1",
    "providerId": "provider1",
    "instanceId": "instance1",
    "identityzone": "zone1"
    }
    
    if not update report

use src/provider/provider.service.ts
ultimately uses
import serviceRequest = require('portal-cf-shared-lib/src/common/service-request');
const AsyncRequest = serviceRequest.Request;
    return AsyncRequest.sendRequest(logger, {
      serviceRelativeUrl: path,
      serviceMethod: method,
      token: this.token,
      options: this.options,
      printResponse: false,
      formData: formData,
      errorMessageAndStack: true,
      circuitBreakerConfig: undefined,
      retryConfig: undefined
    });

which it turn uses axios 

                    1.20.7.4.1.7
                1.20.7.4.2

            1.20.7.5 Code
            1.20.7.6 FAQ

                1.20.7.6.1 My apps are being dropped in RT 
Ex: app is being dropped because of
"vizType": "ssuite.smartbusiness.tiles.contribution"

is missing the global provider configuration (it needs to be done manually)
To configure the global provider you need to call the following API with a client credentials token:
 
Method: POST
URL: https://<;host>.cfapps.eu10.hana.ondemand.com/provisioning_service/providers/global
BODY:
{
  namespace: 'ssuite.smartbusiness.tiles',
  providerId: <global provider id>,
  instanceId: <the portal instance id>,
  identityZoneId: <zone ID where the provider is deployed>
}



            1.20.7.7
        1.20.8  2020 T07

            1.20.8.1  Crown Jewels - Tenant Data Deletion & Validation - Cross team design and implementation
General \ Technical Information: 
Current known gaps: We need to check current persistency : CDM Store, Runtime site + Personalisation, Assets.
Potential Solution:
Manage this capability in Provisioning/DeProvisioning (unsubscribe) - identify a failed un-subscription, and create a scheduled job that picks up these failures, and deletes content.
This will only capture un-subscription failures from the time of feature deployment to live. 
Scheduling can be done via CF scheduled tasks or via Jenkins job – discuss as part of the design.
Prepare High Level Design with relevant architects, and share with teams - @Ariel Tammam +  Sklarski, Tsafrir
Start work in sprint 7A.
Cross teams design and decide on implementation BLI for Saar's team that should be done in T07 as well
Technical Requirement Wiki: https://wiki.wdf.sap.corp/wiki/display/CPC15N/Customer+Data+Termination+Project
Most implementation is in Saar, Yael, Nili and possibly Nadav teams.
This topic is led by Tsafrir and please add requirement 
Leading team is Yael

                1.20.8.1.1 Links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1651

Design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2297172270

Test scope: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2297205190

                1.20.8.1.2 Design
                https://wiki.wdf.sap.corp/wiki/display/CPPortals/NestJS+Provisioning+Service

Also in notes

                1.20.8.1.3 Tests
                1.20.8.1.4 Tasks
                1.20.8.1.5 Code

                1.20.8.1.6 Additional

            1.20.8.2  provisioning service in NestJS aka new provisioning service

                1.20.8.2.1 Links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1653

Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/NestJS+Provisioning+Service
Test scope:



                1.20.8.2.2 Design
                Mini Design -
Make sure all APIs are covered (re-think of API's).
Migrations of tables (type ORM?)
Create the repository
set the groundwork for testing (grunt etc.)
audit log


                1.20.8.2.3 Tests
                1.20.8.2.4 Tasks
                enhance lifecycle ops. add main services skeleton with responsive toy routes

- lifecycle ops (package.json scripts)
- manifests , cf push
- Tests infra and maintain 0 failures moving forward 
- resolvers skeleton
test dir structures. 

.spec coverage for all code

- entities skeleton
provider, subscriber, global.provider

- middlewares
Set security, logger contexts etc

- class validators
Add annotation 

- validation pipe
Add validation pipe and actual validations

- passport & xssec
wire passport & xssec usage to protected endpoint 

- Utils service
All utils classes will reside here

- General purpose Clients service
An axios / async request client wrapper

- local postgres. 
 consider: container? docker-compose?
- logging
Logging service/module

- dynamic logging
Infra for setting it up plus endpoints
so that it would be possible to set log level for "things of interest". Like, user ID, Tenant ID, instance ID etc.
This is enabled by shared lib support cf-logger.js which exposes a method setLoggingLevelSpecificConfig() for setting log level for user ID, Tenant ID and instance ID.
In provisioning we will need to add:
wire the logger on CLS via middleware
app.use(logger.logNetwork);
 
 
app.use((req, res, next) => {
    let loggerCtx = logger.getLoggerCtx(req);
 
    logger.setLoggingLevelSpecificConfig(loggerCtx, req.authInfo.getCloneServiceInstanceId(), req.params.userId, req.authInfo.getZoneId());
    next();
});
Expose APIs for setting log level. Ex:
router.post('/setLoggingLevelForSpecificConfig', (req, res) => {
    ...
        logger.clearLoggingLevelMaps(loggerCtx);
 
        tenantIds = req.authInfo.getAdditionalAuthAttribute('tenantId');
        instanceIds = req.authInfo.getAdditionalAuthAttribute('instanceId');
        userIds = req.authInfo.getAdditionalAuthAttribute('userId');
        loggingLevel = req.authInfo.getAdditionalAuthAttribute('loggingLevel');
 
       ...
        if (userIds) {
            for (let userId of userIds) {
                logger.setKeyAndValueInMap(loggerCtx, mapsTypes.USER_ID, userId, loggingLevel);
            }
        }
        if (instanceIds) {
            for (let instanceId of instanceIds) {
                logger.setKeyAndValueInMap(loggerCtx, mapsTypes.INSTANCE_ID, instanceId, loggingLevel);
            }
        }
        if (tenantIds) {
            for (let tenantId of tenantIds) {
                logger.setKeyAndValueInMap(loggerCtx, mapsTypes.TENANT_ID, tenantId, loggingLevel);
            }
        }
 
});

- is alive endpoint
- swagger

                1.20.8.2.5 Code

                    1.20.8.2.5.1 First steps


~/work/SAP/git/portal-cf-nest-provisioning-service/portal-cf-provisioning-service-new

nest n portal-cf-provisioning-service-new
vi tsconfig.build.json 
add line
    "skipLibCheck": true, 

npmise @nestjs/typeorm typeorm 
npmise @nestjs/swagger @sap/xsenv @sap/xssec cdm-store-client class-transformer class-validator cls-hooked ioredis lodash passport portal-cf-shared-lib reflect-metadata rxjs swagger-ui-express uuid cf-nodejs-logging-support archiver cdm-schema axios retry-axios bfj multer rimraf
[i500695@C02X632CJGH6:2020-07-19 14:12:16:~/work/SAP/git/portal-cf-nest-provisioning-service/portal-cf-provisioning-service-new:]2016$ npmise  @nestjs/graphql graphql-tools graphql

install @types to dev-dependancy
npmide @nestjs/testing @types/archiver @types/chai-as-promised @types/cls-hooked @types/ioredis @types/jszip @types/lodash @types/mocha @types/multer @types/sinon @types/sinon-chai @types/sinon-test @types/uuid chai chai-as-promised grunt grunt-browserify grunt-contrib-clean grunt-contrib-connect grunt-contrib-qunit grunt-contrib-uglify grunt-mocha-test grunt-simple-nyc grunt-ts grunt-tslint karma-coverage mocha package-json-versionify prettier qunit sinon sinon-chai sinon-test supertest ts-mockito tsc-watch tsconfig-paths tslint tslint-config-prettier tslint-config-standard prettier ts-jest ts-loader ts-node tsconfig-paths tslint typescript

  git push --set-upstream origin master
   gitfp
   gitb
   git pull origin  master
   git pull origin  master --allow-unrelated-histories
   gitmrgt 
   gits
   del_orig 
   gita .gitignore 
   gita README.md 
   git commit -m 'fix merge'
   git push --set-upstream origin master

graphql-cli
[i500695@C02X632CJGH6:2020-07-20 10:32:19:~/work/SAP/git/portal-cf-nest-provisioning-service/portal-cf-provisioning-service-new:]2113$ npmide graphql-cli@canary
...
npm WARN @nestjs/graphql@7.5.5 requires a peer of @nestjs/common@^7.0.0 but none is installed. You must install peer dependencies yourself.
npm WARN @nestjs/graphql@7.5.5 requires a peer of @nestjs/core@^7.0.0 but none is installed. You must install peer dependencies yourself.
npm WARN @nestjs/mapped-types@0.0.5 requires a peer of @nestjs/common@^7.0.8 but none is installed. You must install peer dependencies yourself.
npm WARN apollo-graphql@0.4.5 requires a peer of graphql@^14.2.1 but none is installed. You must install peer dependencies yourself.
npm WARN graphql-upload@8.1.0 requires a peer of graphql@0.13.1 - 14 but none is installed. You must install peer dependencies yourself.
npm WARN @graphql-cli/common@4.0.1-alpha-6c9351b.0 requires a peer of yargs@15.4.1 but none is installed. You must install peer dependencies yourself.
npm WARN openapi-to-graphql@2.2.4 requires a peer of graphql@^0.9.6 || ^0.10.0 || ^0.11.0 || ^0.12.0 || ^0.13.0 || ^14.0.0 but none is installed. You must install peer dependencies yourself.
npm WARN graphql-subscriptions@1.1.0 requires a peer of graphql@^0.10.5 || ^0.11.3 || ^0.12.0 || ^0.13.0 || ^14.0.0 but none is installed. You must install peer dependencies yourself.

create services controllers & modules
   nest g s subscribers 
   nest g s providers
   nest g s globalproviders
   nest g s globalproviders
   nest g co providers
   nest g co providers
   nest g co subscribers
   nest g co globalproviders
   nest g mo globalproviders
   nest g mo subscribers
   nest g mo providers

                start project
                nest n portal-cf-nest-provisioning-service
~/work/SAP/git/portal-cf-nest-provisioning-service/portal-cf-nest-provisioning-service

                 npm run start:dev
npmise @nestjs/typeorm typeorm 

npmise @nestjs/swagger @sap/xsenv @sap/xssec cdm-store-client class-transformer class-validator cls-hooked ioredis lodash passport portal-cf-shared-lib reflect-metadata rxjs swagger-ui-express uuid cf-nodejs-logging-support archiver cdm-schema axios retry-axios bfj multer rimraf

                    1.20.8.2.5.2
                1.20.8.2.6 In depth

                    1.20.8.2.6.1 graphql APIs
- import to app
  src/app.module.ts
@Module({
    imports: [
        GraphQLModule.forRoot({
            autoSchemaFile: 'schema.gql'
        }),

- schema
schema.gql

queries, mutations and inputs
type Query {
  getGlobalProviderByNamespace(searchGlobalProvider: SearchGlobalProviderInput!): GlobalProviderEntity!
  getGlobalProviderById(providerId: String!): GlobalProviderEntity!
  getAllGlobalProviders: [GlobalProviderEntity!]!
  subscriber: [Subscriber!]!
}

input SearchGlobalProviderInput {
  namespace: String!
}

type Mutation {
  createGlobalProvider(globalProviderInput: CreateGlobalProviderInput!): GlobalProviderEntity!
  deleteGlobalProvider(searchGlobalProvider: SearchGlobalProviderInput!): GlobalProviderEntity!
  paasBind(createProviderInput: CreateProviderInput!): Int!
  paasUnbind(body: DeleteProviderInput!): Int!
  subscribeSaas(subscriberInput: SubscriberInput!): Int!
  unsubscribeSaas(unsubscribeInput: UnsubscribeInputType!): Int!
}

input CreateGlobalProviderInput {
  namespace: String!
  providerId: String!
  instanceId: String!
  identityZoneId: String!
}

input CreateProviderInput {
  spaceGuid: String!
  orgGuid: String!
  planId: String!
  instanceId: String!
  identityZoneId: String!
}

- Usage example
    @Mutation(returns => Int, {name: 'paasBind'})
    async paasOnboarding(@Args('createProviderInput') createProviderInput: CreateProviderInput) {

@Query(returns => GlobalProviderEntity)
    async getGlobalProviderByNamespace(@Args('searchGlobalProvider') searchGlobalProvider: SearchGlobalProviderInput) {

- 
                    1.20.8.2.6.2

                1.20.8.2.7 run locally

                    1.20.8.2.7.1 local APIs
- is_alive: http://localhost:3000/provisioning_service/portal_api/is_alive
- swagger, 
all: http://localhost:3000/provisioning_service/api/
By module:  
http://localhost:3000/provisioning_service/api/providers/
http://localhost:3000/provisioning_service/api/globalProviders/
http://localhost:3000/provisioning_service/api/subscribers/
http://localhost:3000/provisioning_service/api/technical/
                    1.20.8.2.7.2

                1.20.8.2.8
            1.20.8.3
        1.20.9   2020 T08

            1.20.9.1    [S4 Federation] Support S4 tiles in spaces and pages visualized as links  
            Motivation
Allow Content Providers to have tiles as links imported to cFLP via federation.
Groups & Spaces and pages could contain tiles and tiles as links.
User Story
As End user I want to see my groups links as I see them in my FES FLP.

General \ Technical Information
Design & Implementation
Support Tiles Visualized as Links in Spaces & Pages (in addition to Groups) coming from S4
Tiles in spaces and pages Visualized as links as CDM entities
E2E validation & Integration
Not in scope: No DT representation
Relations should be provided from Yahalom, Amir
Yahalom, Amir please add technical guidelines into the BLI
We get links as viz collection. (no more as links collection),
We should maintain is as separate collections still, with Possibility to provide only Links (for reorder needs)
Wiki: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2160500233
PR - https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/176
Concept - https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FIORITECHP1-13278.md
Space and pages in UX - https://jam4.sapjam.com/blogs/show/VKqonRQbVZV1BZoUeZFWnw
Acceptance Criteria
Implementation based on Mini Design
S4 tiles in spaces & Pages Visualized as links rendered in cFLP as in FES FLP.
E2E validation & Integration


So, we need to do a mini design just so we implement a good solution. 1-2 PD
Possible schema change. I hope we can avoid that and assume we would but need to do small investigation on this. ? PD
I think that we have two main alternatives.
Either:
Add URL data to sections themselves . Transport service. Code, UT, manual sanity. 5-6 PD.
OR
Generate page to section relation with the URL data. CDM store client. Transport service. Code, UT, manual sanity. 5-6 PD.
 
                1.20.9.1.1 Links
BLI:  https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1742
Design: add to original. https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2235311169 

                1.20.9.1.2 relevant section: Follow ups
Support S4 tiles in spaces and pages visualized as links 
Allow Content Providers to have tiles as links imported to cFLP via federation.
Groups & Spaces and pages could contain tiles and tiles as links.
End user wants to view viz of link type as a link (URL) 
The property that controls this is displayFormatHint.
Example:
{
  "_version": "3.0",
  "identification": {
    "entityType": "section",
    "id": "SAP_PRC_BC_PRC_OVP",
    "title": "{{title}}"
  },
  "payload": {
    "apps": [
    ],
    "viz": [
      {
        "appId": "E6A0BCE73837F69573D3B2F11250DDC8",
        "vizId": "C0B60C850D41DD60E9D760A11D97D9DA",
        "displayFormatHint": "compact"
      },
      {
        "appId": "E6A0BCE73837F69573D3B2F11250DDC8",
        "vizId": "C0B60C850D41DD60E9D760A11D97D9DA"
      }
    ]
  },

The transport Service needs to extract this property from the page entity and add it to all the created sections payload.
After which link relations must contain the displayFormatHint property in properties field.
Example:
"relations": {
  "viz": [
    {
      "target": {
        "properties": {
          "vizId": "C0B60C850D41DD60E9D760A11D97D9DA"
        },
        "id": "E6A0BCE73837F69573D3B2F11250DDC8",
        "entityType": "businessapp",
        "context": {
          "id": "SUB_ACCOUNT",
          "type": "SUB_ACCOUNT"
        }
      },
      "label": "ref"
    }
  ]
}

Note that this is different from the implementation for groups in which the viz relations are split into two arrays. All the viz that have displayFormatHint compact are added to 'links' relations array. The rest, are added to 'viz' relations array.
For groups. The motivation for the two separate relations arrays. Viz and links is because the UI in RT shows two ordered collection (URLs/Tiles) separately. And its possible that DT may require reordering support. It is more convenient, readable and efficient this way.

For sections. The requirement is different and FLP RT (the consumer of this property) will handle the display according to its logic.
In this case we will add the displayFormatHint as a property in viz relations properties.


Test scope: add to original. https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2238778287

                1.20.9.1.2 Design

                    1.20.9.1.2.1 Preparatory

                        1.20.9.1.2.1.1 content
<url:/Users/i500695/work/SAP/git/portal-cf-transport-service/test/unit/cdm/resources/entities_spaces_and_pages.json>
search displayFormatHint

example:
{
        "_version": "3.1.0",
        "identification": {
            "entityType": "page",
            "id": "page-1",
            "title": "{{pageTitle}}"
        },
        "payload": {
            "sections": [
                {
                    "id": "sec1",
                    "title": "{{sec1Title}}",
                    "viz": [
                        {
                            "appId": "app1",
                            "vizId": "viz1"
                        },
                        {
                            "appId": "app2",
                            "displayFormatHint": "compact",
                            "vizId": "viz2"
                        }
                    ]
                },
                {
                    "id": "sec2"
                }
            ]
        },
        "texts": [
            {
                "locale": "",
                "textDictionary": {
                    "pageTitle": "Billing Overview",
                    "sec1Title": "Processing"
                }
            },
            {
                "locale": "en",
                "textDictionary": {
                    "pageTitle": "Billing Overview",
                    "sec1Title": "Processing"
                }
            },
            {
                "locale": "de",
                "textDictionary": {
                    "pageTitle": "Abrechnungs\u00fcbersicht",
                    "sec1Title": "Bearbeitung"
                }
            },
            {
                "locale": "es-AR",
                "textDictionary": {
                    "pageTitle": "Resumen de facturaci\u00f3n",
                    "sec1Title": "Procesando"
                }
            }
        ]
    }
                        1.20.9.1.2.1.2

                    1.20.9.1.2.2

                1.20.9.1.3 Tests
                1.20.9.1.4 Tasks
                1.20.9.1.5 Code

                    1.20.9.1.5.1 cdm-store-client
PR: https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/128/files

diffs:  <URL:/Users/i500695/work/SAP/PRs/cdm-store-client/128_sections_displayHintFormat>


                    1.20.9.1.5.2 portal-cf-transport-service

                    1.20.9.1.5.3

                1.20.9.1.6

            1.20.9.2    
            1.20.9.3   







        1.20.10  2020 t09

            1.20.10.1 Import entities per product 
                1.20.10.1.1 Links
BLIs: design https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1634 
implementation: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1789

Design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2326666057
Test scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BExport_Import%5D+Import+Entities+Per+Product+Test+scope

                1.20.10.1.2 Design

                    1.20.10.1.2.1 User story
Motivation
Each of our product should have its own relevant entities (Portal/WZ/Launchpad)
Our customer want to have a possibility to export import content cross our products  for example from Portal to WZ/Lanuchpad. 
In T07 we already implemented portal -> Launchpad filter.  
User Story
As an Admin I would like to be able to export site with content from one sub account and import it to another sub account cross our products  (regardless of the data center) to allow me Life Cycle Management systems Dev-Test-Prod
General \ Technical Information
Design only
Export/Import cross products Portal;Launchpad;WZ/WZ HR - Both ways.
Import should filter out irrelevant entities per product
Import should have a logic inside. 
In the portal -> launchpad there is a logic, in the future there might be additional need to add logic.
Export should have a information from which product I'm exporting content from. to allow comparison and logic for future needs. 
Each product(Portal/WZ/Launchpad) should declare what entity type he support and forward to import. according to the table below.
Recommended: Test scope in design should assist to make sure that we have covered all use cases.
Filter out WZ/WZ HR default content providers:
In WZ/WZ HR there are default content provider that are not relevant when transporting from WZ to WZ HR or Launchpad or portal (and admin should not be aware of them, not connect them).
We will get API from Nili that will let us know which are the default content providers (Instance ID) per product. If there is none we will get empty list. NIli's team API: will be a generic one, for all our products.
These default content providers we skip their content anyway. No ability for admin to connect them anyway.
Add section in design : Report what entities where imported. names, ID, type. to forward for the client. for future needs.
when Filter a site, we should have an option to add assignment of the imported roles to default site. default should be true. Barak, Shir - To work on UX. only when there is site filter out, if it is content only no merged should be done.
Acceptance Criteria
Design
Filtering out use scenarios per products:
From Portal(export) to Portal(import):
No Filter
From Portal to Launchpad:
FS entities (T07)
Logic: In case default FS homepage change to FLP homepage. (T07)
From Portal to WZ/WZ HR:
FS entities
Logic: In case default FS homepage change to FLP homepage.
Site
Admin will need to decide whether he want to add imported roles to site or not. Default is No.
If yes, Merge role reference site level - add imported roles to the destination default WZ site.
From Launchpad to Launchpad:
No filter
From Launchpad to Portal:
No filter
From Launchpad to WZ/WZ HR
Site
Admin will need to decide whether he want to add imported roles to site or not. Defaul is No.
If yes, Merge role reference site level - add imported roles to the destination default WZ site.
From WZ/WZ HR to WZ/WZ HR
Site
Default WZ/WZ HR content providers (Nili's team API)
Merge role reference site level - add imported roles to the destination default site. merge role is required in this specific use case. WZ/WZ HR<->WZ/WZ HR. (Dev-Test-Prod). Default is Yes.
From WZ/WZ HR to Portal:
Default WZ/WZ HR content providers (Nili's team API)
Logic: change the root intent to #Shell home (and not #workzone-home&/home )
From WZ/WZ HR to Launchpad:
Default WZ/WZ HR content providers (Nili's team API)
Logic: change the root intent to #Shell home (and not #workzone-home&/home )
Merged of roles in site option, should be only in Use cases where the site was filter out, if we export a content without any site, we should not have this merge and avoid adding teh roles to the site.
not in MVS: Part of the design should include Design & EE of total entities that were imported, type, name, ID.


                    1.20.10.1.2.2 websequence diagram

                        1.20.10.1.2.2.1 Jawads previous websequence
                        design doc, https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BExport_Import%5D+Import+of+cFLP+site+with+content+%5BServer+side%5D+-+Design+document
title Import - option #2
  
participant client (Browser)
participant transport service
participant Redis
participant provider service
participant cdm-store service
participant activation service
  
  
==Import==
client (Browser)->transport service:transport_service/entities/import/start/
activate transport service
transport service->transport service:generate jobUuid
transport service->provider service:Get All Providers\n/semantic/entity/provider/explore/
transport service<--provider service:Providers
transport service->Redis:Cache providers\ndt:ts:<tenantId>:import_providers:<jobUuid>:\n{providers: [{}]}
transport service<--Redis:OK
transport service->Redis:dt:ts:<tenantId>:import:<jobUuid>:\n{status: "IN_PROGRESS"}
transport service<--Redis:OK
client (Browser)<--transport service:201 - Header contains job: jobUuid
deactivate transport service
loop over cdm chunks in zip file (parallelising calls is possible)
client (Browser)->transport service:transport_service/entities/import/<jobUuid>\n?contextId=ctxId&contextType=ctxType
 
 
activate transport service
 
 
alt status = IN_PROGRESS
transport service->transport service:filter-out entities with\nmissing providers
transport service->provider service:Create role collections\n/semantic/rolecollections/batch
transport service->cdm-store service:/cdm_store_service/import\n?contextId=ctxId&contextType=ctxTpe
activate cdm-store service
transport service->Redis:Update contexts to be commited later\ndt:ts:<tenantId>:import:<jobUuid>:\n{status: "IN_PROGRESS", contexts: []}
transport service<--Redis:OK
cdm-store service->cdm-store service:get All providers' tenant Ids.\nDone once per chunk\n(from contextId/entityId depends Guys impl.)
cdm-store service->cdm-store service:Generate relations according\nto provider Id tenant Id
transport service<--cdm-store service:200 OK\n
deactivate cdm-store service
client (Browser)<--transport service:200 OK
deactivate transport service
client (Browser)->client (Browser):Update progress/handle failure.
else status = CANCELED then do nothing.
end
end
 
space
==Finish import==
space
 
client (Browser)->transport service:transport_service/entities/import/<jobUuid>/finish
activate client (Browser)
transport service->Redis:Get contexts to commit by jobUuid\nRedis:redis.getKey(dt:ts:<tenantId>:import:<jobUuid>)
activate transport service
transport service<--Redis:contexts to commit\n
transport service->cdm-store service:cdm_store_service/commit\nmultiple contexts commit support
activate cdm-store service
cdm-store service->cdm-store service:get affected sites\nby commited entity Ids
transport service<--cdm-store service:affectedSites
deactivate cdm-store service
transport service->activation service:Atcivate sites [ {tenantId: "", siteId: "", instanceId: ""}]
transport service->Redis:Update affectedSites and status:\ndt:ts:<tenantId>:import:<jobUuid>:\n{status: "FINISHED", contexts: [{}], affectedSites:[{}]}
transport service<--Redis:OK
deactivate transport service
client (Browser)<--transport service:{status: "FINISHED", contexts: [{}], affectedSites:[{}]}
deactivate client (Browser)
 
space
==Cancel import==
space
 
client (Browser)->transport service:/entities/import/<jobUuid>/cancel
 
transport service->Redis:dt:ts:<tenantId>:import:<jobUuid>: \n{status: CANCELED, contexts: []}
activate transport service
 
transport service<--Redis:OK
transport service->Redis:Get contexts to de-commit
transport service<--Redis:contexts to decommit
transport service->provider service:/cdm_store_service/transport/decommit/
transport service<--provider service:200 OK
deactivate transport service
 
client (Browser)<--transport service:200 OK



                        1.20.10.1.2.2.2 per product import websequence
title Per Product Import
  
participant client (Browser)
participant transport service
participant Redis
participant provider service
participant cdm-store service
participant activation service
  
  
==Import Start==
participant client (Browser)
participant transport service
participant Redis
  
client (Browser)->transport service:transport_service/entities/import/start/
activate transport service
transport service->transport service:call onBeforeTransport()
transport service->transport service:generate jobUuid
transport service->transport service:get and cache providers
transport service->Redis:dt:ts:<tenantId>:import:<jobUuid>:\n{status: "IN_PROGRESS"}
transport service->transport service:read manifest, extract source/target products 
Redis->transport service:OK
transport service -> client (Browser):201 - Header contains job: jobUuid
deactivate transport service

==General Import loop==
participant client (Browser)
participant transport service
participant Redis
participant provider service
participant cdm-store service
  
  
loop over cdm chunks in zip file
client (Browser)->transport service:transport_service/entities/import/<jobUuid>\n?contextId=ctxId&contextType=ctxType
activate transport service
alt status = IN_PROGRESS
transport service->transport service:onBeforeStore(). Execute for (task of beforeTasksMap[{source_prod, target_prod}]) {task.do()}
transport service->provider service:Create role collections\n/semantic/rolecollections/batch
transport service->cdm-store service:/cdm_store_service/import\n?contextId=ctxId&contextType=ctxTpe
activate cdm-store service
transport service->Redis:Update contexts to be commited later\ndt:ts:<tenantId>:import:<jobUuid>:\n{status: "IN_PROGRESS", contexts: []}
Redis->transport service:OK
cdm-store service->cdm-store service:get All providers' tenant Ids
cdm-store service->cdm-store service:Generate relations according\nto provider Id tenant Id
transport service->transport service:onAfterStore(). Execute for (task of afterTasksMap[{source_prod, target_prod}]) {task.do()}
cdm-store service->transport service:200 OK\n
deactivate cdm-store service
transport service->client (Browser):200 OK
deactivate transport service
client (Browser)->client (Browser):Update progress/handle failure.
else status = CANCELED then do nothing.
end
end

==Example. Portal->WZ Import loop==
participant client (Browser)
participant transport service
  
  
loop over cdm chunks in zip file
client (Browser)->transport service:transport_service/entities/import/<jobUuid>\n?contextId=ctxId&contextType=ctxType
activate transport service
alt status = IN_PROGRESS
loop Executor:onBeforeStore(): for task of beforeTasksMap[{source_prod, target_prod}]) 
transport service->transport service: FilterFreeStyleEntitiesTask::do() 
transport service->transport service: FilterSiteEntityTask::do()
end loop
transport service->transport service: unchanged import logic 
loop service:onAfterStore(): Execute for (task of beforeTasksMap[{source_prod, target_prod}]) {task.do()}
end loop
transport service->client (Browser):200 OK
deactivate transport service
client (Browser)->client (Browser):Update progress/handle failure.
else status = CANCELED then do nothing.
end
end


==Finish import==
participant client (Browser)
participant transport service
participant Redis
participant cdm-store service
participant activation service
 
client (Browser)->transport service:transport_service/entities/import/<jobUuid>/finish
activate client (Browser)
transport service->Redis:Get contexts to commit by jobUuid\nRedis:redis.getKey(dt:ts:<tenantId>:import:<jobUuid>)
activate transport service
transport service->transport service:call onBeforeCommit()
Redis->transport service:contexts to commit\n
transport service->cdm-store service:cdm_store_service/commit\nmultiple contexts commit support
activate cdm-store service
cdm-store service->cdm-store service:get affected sites\nby commited entity Ids
cdm-store service->transport service:affectedSites
deactivate cdm-store service
transport service->activation service:Atcivate sites [ {tenantId: "", siteId: "", instanceId: ""}]
transport service->Redis:Update affectedSites and status:\ndt:ts:<tenantId>:import:<jobUuid>:\n{status: "FINISHED", contexts: [{}], affectedSites:[{}]}
Redis->transport service:OK
transport service->transport service:call onAfterCommit()
loop Executor:onAfterCommit(): for task of afterCommitTasksMap[{source_prod, target_prod}]) 
transport service->transport service: createPlatformRolesTask::do() 
transport service->transport service: siteEntityAdaptationsTask::do()
end loop
deactivate transport service
transport service->client (Browser):{status: "FINISHED", contexts: [{}], affectedSites:[{}]}
deactivate client (Browser)

==Cancel import==
participant client (Browser)
participant transport service
participant Redis

client (Browser)->transport service:/entities/import/<jobUuid>/cancel
transport service->Redis:dt:ts:<tenantId>:import:<jobUuid>: \n{status: CANCELED, contexts: []}
activate transport service
Redis->transport service:OK
transport service->Redis:Get contexts to de-commit
Redis->transport service:contexts to decommit
transport service->provider service:/cdm_store_service/transport/decommit/
provider service->transport service:200 OK
deactivate transport service
 
transport service->client (Browser):200 OK


                        1.20.10.1.2.2.3
                    1.20.10.1.2.3
                1.20.10.1.3 Tests
                1.20.10.1.4 Tasks

                    1.20.10.1.4.1 Add version and product name to manifest
I think shared lib expose such capabilities - https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/master/src/utils/config/config-utils.js
method getScenarioId()
usage: https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/blob/9a887b344a169e3868f0f7fedf1a145505fe9c87/src/subscribers/subscribers.controller.ts#L48
  import {configUtils} from 'portal-cf-shared-lib';
  const scenario = configUtils.getScenarioId(loggerCtx, instanceId);

PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/285 

                    1.20.10.1.4.2 zip utils
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/289

                    1.20.10.1.4.3 CDM entity normalization
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/286

                    1.20.10.1.4.4 Tasks infra
                    PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/284
                    PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/286
                    PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/290
                    PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/304

                    1.20.10.1.4.5 Tasks planner

                    1.20.10.1.4.6
                1.20.10.1.5 Code
                1.20.10.1.6 Additional

            1.20.10.2 [Platform] Hyperscale's Postgres & Redis transition - POC & Implementation
                1.20.10.2.1 Links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1845 
Design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2337697605
Test scope: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2353188596

Motivation:
Support our product transition to work against Hyperscale's Postgres & Redis
As part of Q4 maintenance window we plan to migrate both Postgres and Redis databases to the hyper-scaler based instances. The Redis migration doesn't involve any data transfer, because it's used for caching.
The plan is to migrate only AWS DBs this year. Azure will follow early next year and then the other IaaS – GCP and AliCloud.
Therefore, until all IaaS are aligned, we need to separate them. @Benjamin, Nir, please recommend how to do this (e.g. new user provided service)
According to a first check, there is an issue related to the integration of site-service app to the new Redis instances.
Support our product transition to work against Hyperscale's Postgres & Redis
Technical Details:
Plan for transition that is targeted for T10A - https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2331918596 

Scope:
POC+ Implementation
Connect our services: provisioning, trasport and CDM store to hyperscaler instance.

How to test on dev spaces. see note "[Platform] Hyperscale's Postgres & Redis transition - POC & Implementation. Test on dev spaces"
a. update quotas. For Saar global account: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccountsEntitlements

b. update cf cli to ver 7
brew uninstall cf-cli
brew install cloudfoundry/tap/cf-cli@7

 cf cs postgres development portal-postgres-dt -c "{\"engine_version\":\"9.6\",\"locale\":\"en_US\",\"postgresql_extensions\":[\"ltree\",\"citext\",\"pg_stat_statements\",\"pgcrypto\",\"fuzzystrmatch\",\"hstore\",\"btree_gist\",\"btree_gin\",\"pg_trgm\",\"uuid-ossp\"]}"
c. create services
Run the following commands: 
cf t -o <org> -s <iUser>p
 cf cs postgresql-db development portal-postgresql-db-dt -c "{\"engine_version\":\"12\",\"locale\":\"en_US\",\"postgresql_extensions\":[\"ltree\",\"citext\",\"pg_stat_statements\",\"pgcrypto\",\"fuzzystrmatch\",\"hstore\",\"btree_gist\",\"btree_gin\",\"pg_trgm\",\"uuid-ossp\"]}"
 cf cs redis-cache development portal-redis-cache -c "{\"engine_version\":\"4.0\",\"eviction_policy\":\"allkeys-lru\"}"
[i500695@C02X632CJGH6:2020-09-30 15:56:44:~:]2008$ cf service portal-redis-cache
Showing info of service portal-redis-cache in org launchpad / space i500695p as yosi.izaq@sap.com...

name:             portal-redis-cache
service:          redis-cache
tags:             
plan:             development
description:      Redis Cache service on SAP Cloud Platform
documentation:    
dashboard:        
service broker:   sm-backing-services-broker-redis-cache-f8335877-f46f-4c12-b3b6-599b36b63ded

Showing status of last operation from service portal-redis-cache...

status:    create in progress
message:   operation in progress for instance b6a20264-ddd9-4cf7-b7fd-7e4f8a5eb27c
started:   2020-09-30T12:56:35Z
updated:   2020-09-30T12:56:38Z

[i500695@C02X632CJGH6:2020-09-30 15:57:42:~:]2009$ cf service portal-postgresql-db-rt
Showing info of service portal-postgresql-db-rt in org launchpad / space i500695p as yosi.izaq@sap.com...

name:             portal-postgresql-db-rt
service:          postgresql-db
tags:             
plan:             development
description:      PostgreSQL service on SAP Cloud Platform
documentation:    
dashboard:        
service broker:   sm-backing-services-broker-postgresql-db-0947618d-b2e9-4ff2-b357-71858d5c04ca

Showing status of last operation from service portal-postgresql-db-rt...

status:    create in progress
message:   operation in progress for instance fb383b9f-3a07-4485-a762-5839f58af00b
started:   2020-09-30T12:55:35Z
updated:   2020-09-30T12:57:38Z


d.	After the instances are created:
    * If you are using sharedLib client - update you service to the latest version and skip to #6
    * If you have a dedicated client:
        * Create a test application that is using your dedicated client, the test application should check create schema, delete, get, insert etc... so DevOps can use this application also on other IAAS to verify your client also work there. 
        * Push your test application which is bounded to the new instances
        * Verify functionality, change code untiled it work.
        * Change your services code with the revisions done in the test applications, make sure you use the env variables to determine which instance your code uses.
        * move to step #6  
e.  Push your updated services to your dev space, and switch to use the new instances e.g.:

                1.20.10.2.2 Design
                1.20.10.2.3 Tests

                    1.20.10.2.1.1 portal-cf-provisioning-service
vanilla:
cf cs postgresql-db development portal-postgresql-db-dt -c "{\"engine_version\":\"9.6\",\"locale\":\"en_US\",\"postgresql_extensions\":[\"ltree\",\"citext\",\"pg_stat_statements\",\"pgcrypto\",\"fuzzystrmatch\",\"hstore\",\"btree_gist\",\"btree_gin\",\"pg_trgm\",\"uuid-ossp\"]}"
cf cs redis-cache development portal-redis-cache -c "{\"engine_version\":\"4.0\",\"eviction_policy\":\"allkeys-lru\"}"

 cf service portal-postgresql-db-dt
 cf service portal-redis-cache

 cf bs portal-cf-provisioning-service portal-postgresql-db-dt 
 cf set-env portal-cf-provisioning-service DB_INSTANCE_NAME portal-postgresql-db-dt   
 cf rs  portal-cf-provisioning-service

[i500695@C02X632CJGH6:2020-10-01 15:15:57:~/temp/temp1:]2032$ cf service portal-postgresql-db-dt
Showing info of service portal-postgresql-db-dt in org launchpad / space i500695p as yosi.izaq@sap.com...

name:             portal-postgresql-db-dt
service:          postgresql-db
tags:             
plan:             development
description:      PostgreSQL service on SAP Cloud Platform
documentation:    
dashboard:        
service broker:   sm-backing-services-broker-postgresql-db-0947618d-b2e9-4ff2-b357-71858d5c04ca

Showing status of last operation from service portal-postgresql-db-dt...

status:    create succeeded
message:   Service instance 2871ab86-1ad7-4236-ab89-e7df28d94189 successfully provisioned
started:   2020-09-30T13:07:20Z
updated:   2020-09-30T13:18:33Z

bound apps:
name                             binding name   status             message
portal-cf-provisioning-service                  create succeeded   

Upgrades are not supported by this broker.
[i500695@C02X632CJGH6:2020-10-01 15:16:09:~/temp/temp1:]2033$ cf env portal-cf-provisioning-service  | grep DB_INS
DB_INSTANCE_NAME: portal-postgresql-db-dt

Test unsubscribe and subscribe provider.
Consumer cockpit: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/saasApplications
Subscriptions 
Search Apollo , i500695c 
Unsubscribe / subscribe 

logs: 
 i500695@C02X632CJGH6  ~/work/SAP/logs/hyperscalerTransition/provisioning pwd
/Users/i500695/work/SAP/logs/hyperscalerTransition/provisioning
 i500695@C02X632CJGH6  ~/work/SAP/logs/hyperscalerTransition/provisioning ls
logs_unsubscribe_subscribe_provider

                    1.20.10.2.1.2 portal-cf-sdm-store-service

cf bs portal-cf-cdm-store-service portal-postgresql-db-dt &&  cf set-env portal-cf-cdm-store-service DB_INSTANCE_NAME portal-postgresql-db-dt   && cf rs  portal-cf-cdm-store-service
Showing info of service portal-postgresql-db-dt in org launchpad / space i500695p as yosi.izaq@sap.com...

name:             portal-postgresql-db-dt
service:          postgresql-db
tags:             
plan:             development
description:      PostgreSQL service on SAP Cloud Platform
documentation:    
dashboard:        
service broker:   sm-backing-services-broker-postgresql-db-0947618d-b2e9-4ff2-b357-71858d5c04ca

Showing status of last operation from service portal-postgresql-db-dt...

status:    create succeeded
message:   Service instance 2871ab86-1ad7-4236-ab89-e7df28d94189 successfully provisioned
started:   2020-09-30T13:07:20Z
updated:   2020-09-30T13:18:33Z

bound apps:
name                             binding name   status             message
portal-cf-cdm-store-service                     create succeeded   
portal-cf-provisioning-service                  create succeeded   

Upgrades are not supported by this broker.
DB_INSTANCE_NAME: portal-postgresql-db-dt

[i500695@C02X632CJGH6:2020-10-04 10:15:45:~/work/SAP/logs/hyperscalerTransition/cdmstore:]2010$ ls
logs_copy

                    1.20.10.2.1.3 portal-cf-transport-service redis tests
 cf bs portal-cf-transport-service portal-redis-cache
 cf set-env portal-cf-transport-service REDIS_INSTANCE_NAME portal-redis-cache
 cf rs  portal-cf-transport-service
 cf service portal-redis-cache

verify conection has correct options. hyperscaler:
set to hyperscaler: cf set-env portal-cf-transport-service REDIS_INSTANCE_NAME portal-redis-cache  && cf restage portal-cf-transport-service
  2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.280Z","written_ts":1601993422280000000,"level":"info","msg":"RedisService:62 RedisService::initializeRedisClient() initializing redis","type":"log"}
2020-10-06T17:10:22.28+0300 INFO   RedisService:62 RedisService::initializeRedisClient() initializing redis
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). credentials are missing redis ca_base64","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). credentials are missing redis ca_base64
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). setting redis TLS options host and port","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). setting redis TLS options host and port
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  \"{\\\"hostname\\\":\\\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\\\",\\\"port\\\":1253,\\\"password\\\":\\\"VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX\\\",\\\"uri\\\":\\\"rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253\\\",\\\"tls\\\":{\\\"host\\\":\\\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\\\",\\\"port\\\":1253}}\"","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  "{\"hostname\":\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\"port\":1253,\"password\":\"VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX\",\"uri\":\"rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253\",\"tls\":{\"host\":\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\"port\":1253}}"
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). credentials are missing redis ca_base64","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). credentials are missing redis ca_base64
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). setting redis TLS options host and port","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). setting redis TLS options host and port
   2020-10-06T17:10:22.28+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.102","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:10:22.281Z","written_ts":1601993422281000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  \"{\\\"hostname\\\":\\\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\\\",\\\"port\\\":1253,\\\"password\\\":\\\"VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX\\\",\\\"uri\\\":\\\"rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253\\\",\\\"tls\\\":{\\\"host\\\":\\\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\\\",\\\"port\\\":1253}}\"","type":"log"}
2020-10-06T17:10:22.28+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  "{\"hostname\":\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\"port\":1253,\"password\":\"VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX\",\"uri\":\"rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253\",\"tls\":{\"host\":\"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\"port\":1253}}"
2020-10-06T17:10:22.28+0300 DEBUG   RedisService:37 redis init with uri="rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253", options="{\n    \"host\": \"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\n    \"port\": 1253,\n    \"password\": \"VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX\",\n    \"tls\": {\n        \"host\": \"master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com\",\n        \"port\": 1253\n    },\n    \"uri\": \"rediss://no-user-name-for-redis:VnFCJqfBoVLhquwOLBwKSKRqHzbHXkEX@master.rg-6a4a0392-ad4c-4921-ad82-42df1ee276d3.vwvwdz.euc1.cache.amazonaws.com:1253\"\n}"
   2020-10-06T17:10:22.30+0300 [APP/PROC/WEB/0] OUT [Nest] 79   - 10/06/2020, 2:10:22 PM   [NestApplication] Nest application successfully started +30ms

verify conection has correct options. service fabric:
set to service fabric:cf set-env portal-cf-transport-service REDIS_INSTANCE_NAME portal-redis  && cf restage portal-cf-transport-service
2020-10-06T17:05:33.77+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.78","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:05:33.779Z","written_ts":1601993133779000000,"level":"info","msg":"RedisService:62 RedisService::initializeRedisClient() initializing redis","type":"log"}
2020-10-06T17:05:33.77+0300 INFO   RedisService:62 RedisService::initializeRedisClient() initializing redis
   2020-10-06T17:05:33.78+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.78","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:05:33.780Z","written_ts":1601993133780000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  \"{\\\"hostname\\\":\\\"10.11.241.47\\\",\\\"port\\\":\\\"35970\\\",\\\"password\\\":\\\"JN66Q4hQJ4EY-fDv\\\"}\"","type":"log"}
2020-10-06T17:05:33.78+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  "{\"hostname\":\"10.11.241.47\",\"port\":\"35970\",\"password\":\"JN66Q4hQJ4EY-fDv\"}"
   2020-10-06T17:05:33.78+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.78","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:05:33.780Z","written_ts":1601993133780000000,"level":"debug","msg":"RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  \"{\\\"hostname\\\":\\\"10.11.241.47\\\",\\\"port\\\":\\\"35970\\\",\\\"password\\\":\\\"JN66Q4hQJ4EY-fDv\\\"}\"","type":"log"}
2020-10-06T17:05:33.78+0300 DEBUG   RedisCloudConfigurationProvider:37 RedisCloudConfigurationProvider(). returning configuration  "{\"hostname\":\"10.11.241.47\",\"port\":\"35970\",\"password\":\"JN66Q4hQJ4EY-fDv\"}"
   2020-10-06T17:05:33.78+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.78","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:05:33.781Z","written_ts":1601993133781000000,"level":"debug","msg":"RedisService:37 redis init with options=\"{\\n    \\\"host\\\": \\\"10.11.241.47\\\",\\n    \\\"port\\\": \\\"35970\\\",\\n    \\\"password\\\": \\\"JN66Q4hQJ4EY-fDv\\\"\\n}\"","type":"log"}
2020-10-06T17:05:33.78+0300 DEBUG   RedisService:37 redis init with options="{\n    \"host\": \"10.11.241.47\",\n    \"port\": \"35970\",\n    \"password\": \"JN66Q4hQJ4EY-fDv\"\n}"
   2020-10-06T17:05:33.78+0300 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"736afb35-22dc-40f2-8d1e-0492407dd0da","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"portal-prov","organization_id":"c1531c54-04e7-43e5-a076-e6ccca3ac8c0","space_name":"alma","space_id":"fbe1878b-fd08-4174-bb5c-8717b84f118e","container_id":"10.0.137.78","logger":"nodejs-logger","source_instance":0,"written_at":"2020-10-06T14:05:33.786Z","written_ts":1601993133786000000,"level":"info","msg":"RedisService:62 RedisService::initializeRedisClient(), connected to Redis","type":"log"}
2020-10-06T17:05:33.78+0300 INFO   RedisService:62 RedisService::initializeRedisClient(), connected to Redis

                    1.20.10.2.1.4 E2E
- create hyperscaler DB service
cf cs postgresql-db development portal-postgresql-db-dt -c "{\"engine_version\":\"9.6\",\"locale\":\"en_US\",\"postgresql_extensions\":[\"ltree\",\"citext\",\"pg_stat_statements\",\"pgcrypto\",\"fuzzystrmatch\",\"hstore\",\"btree_gist\",\"btree_gin\",\"pg_trgm\",\"uuid-ossp\"]}"
cf service portal-postgresql-db-dt

- bind prov + store
 cf bs portal-cf-provisioning-service portal-postgresql-db-dt  && cf set-env portal-cf-provisioning-service DB_INSTANCE_NAME portal-postgresql-db-dt  && cf rs  portal-cf-provisioning-service
cf bs portal-cf-cdm-store-service portal-postgresql-db-dt &&  cf set-env portal-cf-cdm-store-service DB_INSTANCE_NAME portal-postgresql-db-dt   && cf rs  portal-cf-cdm-store-service
cf set-env portal-cf-transport-service REDIS_INSTANCE_NAME portal-redis-cache
cf set-env portal-cf-site-semantic-service REDIS_INSTANCE_NAME portal-redis-cache

- Test new provider creation
logs:
[i500695@C02X632CJGH6:2020-10-07 11:14:56:~/work/SAP/logs/hyperscalerTransition/E2E:]2096$ pwd
/Users/i500695/work/SAP/logs/hyperscalerTransition/E2E
[i500695@C02X632CJGH6:2020-10-07 11:14:58:~/work/SAP/logs/hyperscalerTransition/E2E:]2097$ ls
logs_cdmstore		logs_provisioning	logs_transport

note: "[Platform] Hyperscale's Postgres & Redis transition - POC & Implementation. Test on dev spaces"
-
                    1.20.10.2.1.5 problems

                        1.20.10.2.1.5.1 ERROR: could not extend file \"base/16385/2658\": No space left on device

                            1.20.10.2.1.5.1.1  rc. apparently I was running on dev plan which gives 750MB only
                Login to PaaS account. e.g. my space https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/65e227fa-3e4d-42e2-84f7-d8e7fb13166e/org/c7486965-e5bd-4047-a1a1-79f702a29304/space/7e0d5a8a-30ae-4b1b-948b-cfa4914de088/service-marketplace&//detail/6db542eb-8187-4afc-8a85-e08b4a3cc24e/?layout=TwoColumnsMidExpanded

Services -> marketplace -> search postgre -> add new dt/rt services
Small plan is quite good. 600GB disk space is provided.
v9.6-small

                            1.20.10.2.1.5.1.2   try unbind + rebind services
remove indexes, restage, scale to 4g, repsush. did not fix
$ cf us portal-cf-cdm-store-service portal-postgres-dt
$ cf us portal-cf-cdm-store-service portal-postgresql-db-dt
Unbinding app portal-cf-cdm-store-service from service portal-postgresql-db-dt in org launchpad / space i500695p as yosi.izaq@sap.com...
OK
 
$ cf us portal-cf-transport-service  portal-postgres-dt
Unbinding app portal-cf-transport-service from service portal-postgres-dt in org launchpad / space i500695p as yosi.izaq@sap.com...
OK
 
$ cf us portal-cf-transport-service  portal-postgresql-db-dt
Unbinding app portal-cf-transport-service from service portal-postgresql-db-dt in org launchpad / space i500695p as yosi.izaq@sap.com...
Binding between portal-postgresql-db-dt and portal-cf-transport-service did not exist
OK

$ cf us portal-cf-transport-service  portal-postgresql-db-dt
Unbinding app portal-cf-transport-service from service portal-postgresql-db-dt in org launchpad / space i500695p as yosi.izaq@sap.com...
Binding between portal-postgresql-db-dt and portal-cf-transport-service did not exist
OK

$ cf bs portal-cf-transport-service  portal-postgresql-db-dt
Binding service portal-postgresql-db-dt to app portal-cf-transport-service in org launchpad / space i500695p as yosi.izaq@sap.com...
OK

$ cf bs portal-cf-transport-service  portal-postgres-dt
 cf bs portal-cf-cdm-store-service portal-postgresql-db-dt
 cf bs portal-cf-cdm-store-service portal-postgres-dt

- try to delete services and recreate.
#unbind all using apps
cf us content-package-store portal-postgres-dt                                
cf us content-package-store portal-postgres-dt                                
cf us portal-cf-activation-service portal-postgres-dt
cf us portal-cf-cdm-store-service portal-postgres-dt
cf us portal-cf-content-repository portal-postgres-dt
cf us portal-cf-design-time-service portal-postgres-dt
cf us portal-cf-provisioning-service portal-postgres-dt
cf us portal-cf-service-broker portal-postgres-dt
cf us portal-cf-technical-support-blue portal-postgres-dt
cf us portal-cf-technical-support-am-blue portal-postgres-dt
cf us portal-cf-transport-service portal-postgres-dt
cf us provisioning-service portal-postgres-dt
cf us portal-cf-portal-personalization portal-postgres-rt
cf us portal-cf-site-configuration portal-postgres-rt
cf us portal-cf-site-service portal-postgres-rt
cf us portal-cf-cdm-store-service portal-postgresql-db-dt                           
cf us sm-backing-services-broker-postgresql-db-0947618d-b2e9-4ff2-b357-71858d5c04ca portal-postgresql-db-dt                           

#delete postgres services
cf ds portal-postgresql-db-dt
cf ds portal-postgresql-db-rt
cf ds portal-postgresql-dt
cf ds portal-postgresql-rt

#recreate fabric pg
cf cs postgreSQL v9.6-dev portal-postgres-dt
cf cs postgreSQL v9.6-dev portal-postgres-dt
# didn't work. I created from cockpit. see note...

#bind all using apps
cf bs content-package-store portal-postgres-dt                                
cf bs content-package-store portal-postgres-dt                                
cf bs portal-cf-activation-service portal-postgres-dt
cf bs portal-cf-cdm-store-service portal-postgres-dt
cf bs portal-cf-content-repository portal-postgres-dt
cf bs portal-cf-design-time-service portal-postgres-dt
cf bs portal-cf-provisioning-service portal-postgres-dt
cf bs portal-cf-service-broker portal-postgres-dt
cf bs portal-cf-technical-support-blue portal-postgres-dt
cf bs portal-cf-technical-support-am-blue portal-postgres-dt
cf bs portal-cf-transport-service portal-postgres-dt
cf bs provisioning-service portal-postgres-dt
cf bs portal-cf-portal-personalization portal-postgres-rt
cf bs portal-cf-site-configuration portal-postgres-rt
cf bs portal-cf-site-service portal-postgres-rt
cf bs portal-cf-cdm-store-service portal-postgresql-db-dt                           

                            1.20.10.2.1.5.1.3 repro w/ small plan
- 200 entities per chunk are added to temp table
ex:
2020-11-15T12:47:17.78+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  TransportController:importJson() report = {
  "contextType": "SNAPSHOT",
  "contextId": "ep1",
  "correlationId": "d60a888d-a85e-4656-4ca4-f29bb14c0dbd",
  "overviewReport": {
    "businessapp": {
      "total": 200,
      "passed": 200,
      "failed": 0
    }
  },
  "deleted": {},
  "failures": []
}

-  local log storage overfilled / some other log related failure
Failed to retrieve logs from Log Cache: read tcp 10.16.48.93:58201->18.195.178.250:443: read: operation timed out

- relation count 0, entities 123k
write to entities table continues even after logs crash
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id" like '%ep3%' limit 1;
ep1_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3
ep2_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3

SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id"='ep1_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
select count (*) FROM cdm."CDM_ENTITIES" WHERE "id"='ep2_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
"150400"

select (select count(*) from cdm."RELATIONS") as count1, (select count (*) FROM cdm."CDM_ENTITIES" WHERE "id"='ep1_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3') as count2 ;

SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id"='ep1_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3' and "entityType" in ('catalog', 'group', 'role');
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id"='ep1_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3' and "entityType" not in ('businessapp');
0 catalog/group/role !!

- last logs pre crash
    2020-11-15T13:06:49.88+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.886Z","written_ts":298384018667941,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cdm.store.service.impl.TransportAgent","thread":"http-nio-8080-exec-6","level":"DEBUG","categories":[],"msg":"importJson() ended with context id ep1 and contextType SNAPSHOT" }
2020-11-15T13:06:49.88+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  importJson() ended with context id ep1 and contextType SNAPSHOT
   2020-11-15T13:06:49.88+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.886Z","written_ts":298384018738878,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cdm.store.service.impl.TransportAgent","thread":"http-nio-8080-exec-6","level":"DEBUG","categories":[],"msg":"importJson() with context id ep1 and contextType SNAPSHOT took: 0.716 seconds" }
2020-11-15T13:06:49.88+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  importJson() with context id ep1 and contextType SNAPSHOT took: 0.716 seconds
   2020-11-15T13:06:49.88+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.889Z","written_ts":298384021697003,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cdm.store.webaccess.TransportController","thread":"http-nio-8080-exec-6","level":"DEBUG","categories":[],"msg":"TransportController:importJson() report = {\n  \"contextType\": \"SNAPSHOT\",\n  \"contextId\": \"ep1\",\n  \"correlationId\": \"d60a888d-a85e-4656-4ca4-f29bb14c0dbd\",\n  \"overviewReport\": {\n    \"businessapp\": {\n      \"total\": 200,\n      \"passed\": 200,\n      \"failed\": 0\n    }\n  },\n  \"deleted\": {},\n  \"failures\": []\n}" }
2020-11-15T13:06:49.88+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  TransportController:importJson() report = {
  "contextType": "SNAPSHOT",
  "contextId": "ep1",
  "correlationId": "d60a888d-a85e-4656-4ca4-f29bb14c0dbd",
  "overviewReport": {
    "businessapp": {
      "total": 200,
      "passed": 200,
      "failed": 0
    }
  },
  "deleted": {},
  "failures": []
}
   2020-11-15T13:06:49.89+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.890Z","written_ts":298384022161534,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-6","level":"DEBUG","categories":[],"msg":"Removed current tenantId: 810cd5c3489a9ef95a15cdf407e6b264" }
2020-11-15T13:06:49.89+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Removed current tenantId: 810cd5c3489a9ef95a15cdf407e6b264
   2020-11-15T13:06:49.89+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.890Z","written_ts":298384022256308,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"request","request":"/cdm_store_service/transport/import?contextId=ep1&contextType=SNAPSHOT","referer":"-","response_sent_at":"2020-11-15T11:06:49.890Z","response_status":200,"method":"POST","response_size_b":197,"request_size_b":1,"remote_port":"redacted","layer":"[SERVLET]","remote_host":"redacted","x_forwarded_for":"-","remote_user":"redacted","protocol":"HTTP/1.1","remote_ip":"redacted","response_content_type":"application/json","request_received_at":"2020-11-15T11:06:49.166Z","response_time_ms":724.204661,"direction":"IN"}
2020-11-15T13:06:49.89+0200  d60a888d-a85e-4656-4ca4-f29bb14c0dbd
   2020-11-15T13:06:49.89+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:06:49.890Z","written_ts":298384022289854,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"7c13e527-a490-445c-4f93-7ad00fae2ad8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-6","level":"DEBUG","categories":[],"msg":"Removed current tenantId: 810cd5c3489a9ef95a15cdf407e6b264" }
2020-11-15T13:06:49.89+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Removed current tenantId: 810cd5c3489a9ef95a15cdf407e6b264
   2020-11-15T13:06:49.89+0200 [RTR/6] OUT portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com - [2020-11-15T11:06:49.152938726Z] "POST /cdm_store_service/transport/import?contextId=ep1&contextType=SNAPSHOT HTTP/1.1" 200 219201 197 "-" "axios/0.18.1" "-" "10.0.73.125:61218" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"7c13e527-a490-445c-4f93-7ad00fae2ad8" response_time:0.737796 gorouter_time:0.000156 app_id:"f835ba3b-dd7c-4817-adfb-feb96c4fa049" app_index:"0" x_cf_routererror:"-" x_correlationid:"d60a888d-a85e-4656-4ca4-f29bb14c0dbd" tenantid:"-" sap_passport:"-" x_scp_request_id:"bae7ec18-48d4-4c97-9480-65b3ee73eff9-5FB10BC9-9D173DD" x_cf_app_instance:"-" x_b3_traceid:"45f2df0cfdebb8b5" x_b3_spanid:"45f2df0cfdebb8b5" x_b3_parentspanid:"-" b3:"45f2df0cfdebb8b5-45f2df0cfdebb8b5"

   2020-11-15T13:06:49.89+0200 [RTR/6] OUT

   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.927Z","written_ts":298397059589034,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.cloud.security.token.validation.validators.JwtAudienceValidator","thread":"http-nio-8080-exec-5","level":"INFO","categories":[],"msg":"The audiences that are derived from the token: [uaa, portal-cf-service-launchpadi500695p!b14400, sb-portal-cf-service-launchpadi500695p!b14400]." }
2020-11-15T13:07:02.92+0200 INFO d60a888d-a85e-4656-4ca4-f29bb14c0dbd  The audiences that are derived from the token: [uaa, portal-cf-service-launchpadi500695p!b14400, sb-portal-cf-service-launchpadi500695p!b14400].
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.927Z","written_ts":298397059665841,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.cloud.security.token.SecurityContext","thread":"http-nio-8080-exec-5","level":"INFO","categories":[],"msg":"Sets token of service XSUAA to SecurityContext (thread-locally)." }
2020-11-15T13:07:02.92+0200 INFO d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Sets token of service XSUAA to SecurityContext (thread-locally).
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.927Z","written_ts":298397059700174,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.cloud.security.adapter.spring.SAPOfflineTokenServicesCloud","thread":"http-nio-8080-exec-5","level":"INFO","categories":[],"msg":"Creates OAuth2Authentication with token clientId sb-portal-cf-service-launchpadi500695p!b14400 which differs from oauth client id sb-portal-cf-service-launchpadi500695p!b14400." }
2020-11-15T13:07:02.92+0200 INFO d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Creates OAuth2Authentication with token clientId sb-portal-cf-service-launchpadi500695p!b14400 which differs from oauth client id sb-portal-cf-service-launchpadi500695p!b14400.
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.927Z","written_ts":298397059793906,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Entering TenantFilter" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Entering TenantFilter
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.927Z","written_ts":298397059819531,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.platform.commons.tenant.CloudTenantContext","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"CloudTenantContext::setCurrentTenant" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  CloudTenantContext::setCurrentTenant
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060081273,"component_type":"application","component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","space_name":"i500695p","component_name":"portal-cf-cdm-store-service","component_instance":"0","organization_id":"-","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","organization_name":"-","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.platform.commons.tenant.CloudTenantContext","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Additional Attributes: tenantId = 472abdee-c7a4-4357-80ed-3a490cc94622 instanceId = 29a214f1-6a89-4d38-9e0e-d762571391cc, userName = Hidden isProvider= true" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Additional Attributes: tenantId = 472abdee-c7a4-4357-80ed-3a490cc94622 instanceId = 29a214f1-6a89-4d38-9e0e-d762571391cc, userName = Hidden isProvider= true
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060130509,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Set current tenantId to: 810cd5c3489a9ef95a15cdf407e6b264" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Set current tenantId to: 810cd5c3489a9ef95a15cdf407e6b264
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060152974,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"890d030e-a302-454b-5f9e-0eb4b01983e2","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.CrossTenantAuthorizationFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Entering CrossTenantAuthorizationFilter" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Entering CrossTenantAuthorizationFilter
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060406353,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.CrossTenantAuthorizationFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Entering CrossTenantAuthorizationFilter" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Entering CrossTenantAuthorizationFilter
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060443420,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Entering TenantFilter" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Entering TenantFilter
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060466375,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.platform.commons.tenant.CloudTenantContext","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"CloudTenantContext::setCurrentTenant" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  CloudTenantContext::setCurrentTenant
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060657303,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.platform.commons.tenant.CloudTenantContext","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Additional Attributes: tenantId = 472abdee-c7a4-4357-80ed-3a490cc94622 instanceId = 29a214f1-6a89-4d38-9e0e-d762571391cc, userName = Hidden isProvider= true" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Additional Attributes: tenantId = 472abdee-c7a4-4357-80ed-3a490cc94622 instanceId = 29a214f1-6a89-4d38-9e0e-d762571391cc, userName = Hidden isProvider= true
   2020-11-15T13:07:02.92+0200 [APP/PROC/WEB/0] OUT { "written_at":"2020-11-15T11:07:02.928Z","written_ts":298397060684505,"component_id":"f835ba3b-dd7c-4817-adfb-feb96c4fa049","component_name":"portal-cf-cdm-store-service","organization_name":"-","component_type":"application","space_name":"i500695p","component_instance":"0","organization_id":"-","tenantId":"810cd5c3489a9ef95a15cdf407e6b264","correlation_id":"d60a888d-a85e-4656-4ca4-f29bb14c0dbd","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","request_id":"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8","container_id":"10.0.73.125","type":"log","logger":"com.sap.portal.cf.security.filters.TenantFilter","thread":"http-nio-8080-exec-5","level":"DEBUG","categories":[],"msg":"Set current tenantId to: 810cd5c3489a9ef95a15cdf407e6b264" }
2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Set current tenantId to: 810cd5c3489a9ef95a15cdf407e6b264

- real RC of bug. Both transport and CDM store crashes!!
    -- store
  2020-11-15T13:07:02.92+0200 DEBUG d60a888d-a85e-4656-4ca4-f29bb14c0dbd  Set current tenantId to: 810cd5c3489a9ef95a15cdf407e6b264
   2020-11-15T13:07:06.12+0200 [APP/PROC/WEB/0] ERR Resource exhaustion event: the JVM was unable to allocate memory from the heap.

   2020-11-15T13:07:06.12+0200 [APP/PROC/WEB/0] ERR ResourceExhausted! (1/0)

   2020-11-15T13:07:13.19+0200 [RTR/22] OUT portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com - [2020-11-15T11:07:02.914355896Z] "POST /cdm_store_service/transport/import?contextId=ep1&contextType=SNAPSHOT HTTP/1.1" 502 61697413 67 "-" "axios/0.18.1" "-" "10.0.73.125:61218" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"8d6c4792-803c-46eb-66e1-4b9e08b4fcc8" response_time:10.278609 gorouter_time:0.000319 app_id:"f835ba3b-dd7c-4817-adfb-feb96c4fa049" app_index:"0" x_cf_routererror:"endpoint_failure" x_correlationid:"d60a888d-a85e-4656-4ca4-f29bb14c0dbd" tenantid:"-" sap_passport:"-" x_scp_request_id:"769e777f-34ed-4cea-8ec2-b1484b2aa2f6-5FB10BD6-97645F6" x_cf_app_instance:"-" x_b3_traceid:"833878c960a24e59" x_b3_spanid:"833878c960a24e59" x_b3_parentspanid:"-" b3:"833878c960a24e59-833878c960a24e59"

   2020-11-15T13:07:13.19+0200 [RTR/22] OUT

   2020-11-15T13:07:13.21+0200 [APP/PROC/WEB/0] OUT Exit status 137 (out of memory)

   2020-11-15T13:07:13.22+0200 [SSH/0] OUT Remote access ended for 10.0.136.2:61682

   2020-11-15T13:07:13.22+0200 [CELL/SSHD/0] OUT Exit status 0

   2020-11-15T13:07:18.45+0200 [CELL/0] OUT Cell 258d2a0b-198a-4a25-a377-de1e94b3471f stopping instance ed633597-957d-4c97-52b1-9dfd

   2020-11-15T13:07:18.45+0200 [CELL/0] OUT Cell 258d2a0b-198a-4a25-a377-de1e94b3471f destroying container for instance ed633597-957d-4c97-52b1-9dfd

   2020-11-15T13:07:18.47+0200 [API/97] OUT Process has crashed with type: "web"

   2020-11-15T13:07:18.55+0200 [CELL/0] OUT Cell 5ba28cb5-f674-4347-8953-14f6cba1c997 creating container for instance b5641363-d459-4d96-60fd-a16e

   2020-11-15T13:07:18.67+0200 [PROXY/0] OUT Exit status 137

   2020-11-15T13:07:19.29+0200 [CELL/0] OUT Cell 258d2a0b-198a-4a25-a377-de1e94b3471f successfully destroyed container for instance ed633597-957d-4c97-52b1-9dfd

   2020-11-15T13:07:19.31+0200 [CELL/0] OUT Cell 5ba28cb5-f674-4347-8953-14f6cba1c997 successfully created container for instance b5641363-d459-4d96-60fd-a16e

   2020-11-15T13:07:19.58+0200 [CELL/0] OUT Downloading droplet...

   2020-11-15T13:07:23.03+0200 [CELL/0] OUT Downloaded droplet (115.3M)

   2020-11-15T13:07:23.03+0200 [CELL/0] OUT Starting health monitoring of container

   2020-11-15T13:07:23.44+0200 [APP/PROC/WEB/0] OUT Linked /home/vcap/app/.postgresql to /home/vcap/.postgresql

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT   .   ____          _            __ _ _

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT  /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT ( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT  \\/  ___)| |_)| | | | | || (_| |  ) ) ) )

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT   '  |____| .__|_| |_|_| |_\__, | / / / /

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT  =========|_|==============|___/=/_/_/_/

   2020-11-15T13:07:25.70+0200 [APP/PROC/WEB/0] OUT  :: Spring Boot ::        (v2.2.9.RELEASE)


    -- transport

    -- logs
~/temp/temp1:]2005$ cp logs_copy logs_copy_transport_crash
~/temp/temp2:]2005$ cp logs_copy logs_copy_store_crash
at point of crash count relations, entities:
0, 150401
    --

- decrease page size to 20
source: src/proxy/odata.proxy.async.iterable.ts (the config is generated via factory in proxy module and injected to proxy service which create the odata proxy)
const headers = new Set<[string, string]>([['Prefer', `maxpagesize=${
            this.connectivityConfig?.maxPageSize ?? ODataProxyAsyncIterable.MAX_PAGE_SIZE}`]]);

[i500695@C02X632CJGH6:2020-11-15 17:04:20:~/work/SAP/git/portal-cf-transport-service:]2003$ cf env portal-cf-transport-service | grep CONNECTIVITY_CONFIG
CONNECTIVITY_CONFIG: { "timeouts": { "proxyToken": 5000, "dataRequest": 30000 }, "maxPageSize": 200}
set env doest cut it. requires restage...
[i500695@C02X632CJGH6:2020-11-15 17:04:39:~/work/SAP/git/portal-cf-transport-service:]2004$ cf set-env portal-cf-transport-service CONNECTIVITY_CONFIG "{ \"timeouts\": { \"proxyToken\": 5000, \"dataRequest\": 30000 }, \"maxPageSize\": 200}"
so, change in manifest-dev and push
cf env portal-cf-transport-service | grep CONNECTIVITY_CONFIG
CONNECTIVITY_CONFIG: { "timeouts": { "proxyToken": 5000, "dataRequest": 30000 }, "maxPageSize": 20}


takes hours to complete:
It took around 6h to import 90k entities at 20 per chunk.

- transport mem analysis. refer to:
https://www.valentinog.com/blog/node-usage/

- add log of chunk # and size

- multi vs single row insert 
https://dba.stackexchange.com/questions/76334/multi-row-insert-vs-multiple-single-row-inserts
-

                            1.20.10.2.1.5.1.4 create composite indexes

count:
select (select count(*) from cdm."RELATIONS") as count1, (select count(*) from cdm."CDM_ENTITIES") as count2 ;

indices:
drop index idx on table cdm."CDM_ENTITIES";  
drop index contextTypex on table cdm."CDM_ENTITIES"; 
create index idx on cdm."CDM_ENTITIES" (id);
create index contextTypex on cdm."CDM_ENTITIES" ("contextType");
create index contextTypelx on cdm."CDM_ENTITIES" (lower("contextType"));
create index tenantIdx on cdm."CDM_ENTITIES" ("tenantId");


create index fromContextIdx on cdm."RELATIONS" ("fromContextId");
create index toContextIdx on cdm."RELATIONS" ("toContextId");
create index fromEntityTypex on cdm."RELATIONS" ("fromEntityType");
create index fromTenantIdx on cdm."RELATIONS" ("fromTenantId");
create index toTenantIdx on cdm."RELATIONS" ("toTenantId");
create index toContextTypelx on cdm."RELATIONS" (lower("toContextType"));
create index fromContextTypelx on cdm."RELATIONS" (lower("fromContextType"));
                        1.20.10.2.1.5.2

                    1.20.10.2.1.6 add prints to transport service 

                        1.20.10.2.1.6.1 code 
    private async startTransport(jobInfoDto: JobInfoDto): Promise<void> {
        this.logger.verbose('TransportJob::startTransport() starting job transporting');
        const {keyDto, authInfo, deltaLink} = jobInfoDto;
        const token: string = await this.getToken(authInfo);
        const errorFields: ErrorFieldsDto = {};

        let affectedEntities;
        try {
            const brokenAppsHandler: IBrokenCherryPickHandler = await this.transientServicesFactory.getBrokenAppsHandler();
            const brokenVizTypesHandler: IBrokenCherryPickHandler = await this.transientServicesFactory.getBrokenVizTypesHandler();

            await brokenVizTypesHandler.preTransportAction(jobInfoDto, token);

            await this.decommitJob(keyDto, token);
            const asyncProxyIterator: IProxyAsyncIterable = this.getAsyncProxyIterator(jobInfoDto);
            let IsSMBEntitiesFiltered:boolean = false

            const chunkNumber: number = 0;
            let chunkPrint: string;

            for await (const chunk of asyncProxyIterator) {
                if (this.chunkNotValid(chunk)) {
                    this.logger.warn('TransportJob::startTransport() transport content is empty. check backend system');
                    if(!deltaLink){
                        throw new InvalidContentError('transport content is empty. check backend system');
                    }
                    continue;
                }
                const start = process.hrtime();
                chunkPrint = `---- chunk number  ${chunkNumber} -----`;
                chunkPrint += '\n';
                chunkPrint += this.memusage();
                chunkPrint += '\n';
                // TODO - temp filter of smp content
               const chunckAfterFilterSMB =  this.filterOutSMBContent(chunk.value);
                if(Array.isArray(chunk?.value) && chunckAfterFilterSMB.length < chunk.value.length ) {
                    IsSMBEntitiesFiltered = true;
                }
                chunkPrint += this.pprintChunk(chunckAfterFilterSMB);
                chunkPrint += '\n';

                this.logger.debug(`TransportJob::startTransport() processing entity chunk of size = ${chunckAfterFilterSMB?.length}`);
                brokenAppsHandler.handleChunk(chunckAfterFilterSMB);
                brokenVizTypesHandler.handleChunk(chunckAfterFilterSMB);
                const chunkWithCreatedEntities = await this.cdmEntityCreatorService.createFromEntities(chunckAfterFilterSMB, {importJobInfo: jobInfoDto, token: token });
                // chunkWithCreatedEntities ? this.logger.debug(`TransportJob::startTransport() post entities creation size = ${chunkWithCreatedEntities?.length}`) :
                //    this.logger.debug(`TransportJob::startTransport() post entities creation size = 0`);

                const chunkAfterResolvers = await this.resolveCdmEntities(chunkWithCreatedEntities, jobInfoDto, token);
                // chunkAfterResolvers ? this.logger.debug(`TransportJob::startTransport() post entities resolving size = ${chunkAfterResolvers?.length}`) :
                //     this.logger.debug(`TransportJob::startTransport() post entities resolving size = 0`);

                await this.transportChunk(keyDto, token, chunkAfterResolvers);
                const end = process.hrtime(start);
                chunkPrint += 'Execution time (hr): '+ end[0]+'s '+ (end[1] / 1000000)+'ms';
                chunkPrint = `---- chunk number  ${chunkNumber} -----`;
                chunkPrint += '\n';
                this.logger.info(chunkPrint);
                if (!await this.shouldContinue(keyDto)) {
                    this.stopTransport(keyDto, token);
                    return;
                }
            }

            this.logger.debug(`TransportJob::startTransport() All chunks processed successfully`);
            // todo
            const brokenVizTypeApps: BrokenEntity[] = await brokenVizTypesHandler.concludeBrokenApps(jobInfoDto, token);
            errorFields.brokenVizTypeApps = brokenVizTypeApps;
            this.failIfBrokenViztypeApps(brokenVizTypeApps);
            affectedEntities = await this.commitJob(keyDto, !isNil(deltaLink), token);
            this.logger.debug(`TransportJob::startTransport() affected sites from current transport = { %s }`, affectedEntities);
            if(!IsSMBEntitiesFiltered){
                await this.modifyJobState(keyDto, TransportJobState.SUCCEEDED, false);
            }else{
                // TODO remove  -  temporary code
                await this.modifyJobState(keyDto, TransportJobState.PARTIAL, false);
            }

            const brokenApps: BrokenEntity[] = await brokenAppsHandler.concludeBrokenApps(jobInfoDto, token);
            this.logger.debug(`TransportJob::startTransport() brokenApps from current transport = { %s }`, brokenApps);
             const reportDetails: ReportDetails = { keyDto: keyDto, affectedSites: affectedEntities, brokenApps: brokenApps,
                additionalData: {deltaLink: asyncProxyIterator.DeltaLink}, brokenVizTypeApps: brokenVizTypeApps};
            await this.finalizeReport(reportDetails);
            await this.publishReport(keyDto);
        } catch (error) {
            await this.jobFailedHandler(jobInfoDto, token, error, errorFields);
        } finally {
            this.deleteJobRecordsFromMemoryStorage(keyDto);
        }
    }

...

                        private  memusage(): string {
        let memprint: string='';
        const b2mbfactor = 1024**2;
        memprint+='rss: '+process.memoryUsage().rss/(b2mbfactor)+ 'MB\n';
        memprint+= 'heap total '+process.memoryUsage().heapTotal/(b2mbfactor)+'MB\n';
        memprint+= 'heap used '+process.memoryUsage().heapUsed/(b2mbfactor)+'MB\n';
        memprint+= 'external '+process.memoryUsage().external/(b2mbfactor)+'MB\n';
        memprint+= 'buffers '+process.memoryUsage().arrayBuffers/(b2mbfactor)+'MB\n';
        return  memprint;
    }

    private pprintChunk(chunk: any): string {
        // entity by entity # rels
        let chunkPrint: string = '';
        chunkPrint+='# entities: '+chunk?.length+'\n';
        for (const ent of chunk) {
            chunkPrint+='entity '+ent?.identification?.id+' mem size: '+this.objectSize(ent)+', # rels: '+ this.relationsLen(ent)+'\n';
        }
        return chunkPrint;
    }

    private relationsLen( ent ):number {
        let num: number = 0;

        for (const k in ent?.relations) {
            num += ent.relations[k].length;
        }
        return num;
    }

    private objectSize( object:any ):number {
        // DFS for object size. keys not calculated...
        let objectList = [];
        let stack = [ object ];
        let bytes:number = 0;

        while ( stack.length ) {
            let value = stack.pop();

            if ( typeof value === 'boolean' ) {
                bytes += 4;
            }
            else if ( typeof value === 'string' ) {
                bytes += value.length * 2;
            }
            else if ( typeof value === 'number' ) {
                bytes += 8;
            }
            else if
            (
                typeof value === 'object'
                && objectList.indexOf( value ) === -1
            )
            {
                objectList.push( value );

                for( let i in value ) {
                    stack.push( value[ i ] );
                }
            }
        }
        return bytes;
    }


                        1.20.10.2.1.6.2 logs
                        1.20.10.2.1.6.3 

                        1.20.10.2.1.6.4
                    1.20.10.2.1.7
                1.20.10.2.4 Tasks
                1.20.10.2.5 Code

                    1.20.10.2.1.1 transport_service
shared lib PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/306/files 
Transport is using ioredis client. 
There are two alternatives. Test with ioredis client or switch to using shared lib redis client.
ioredis was chosen.

cluster pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/318
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/321/files


Alma&Asaf PR for redis-cache: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/582



                    1.20.10.2.1.2

                1.20.10.2.6
                1.20.10.2.1 Additional
- jtrack bug
  https://jtrack.wdf.sap.corp/browse/NGPBUG-129903

            1.20.10.3
        1.20.11 2020 t11, t10
            1.20.11.1 Adopt XSUAA changes

                1.20.11.1.1 Links
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1901

General \ Technical Information
Adopt XSUAA changes
There is no dependency between the teams (Guy, Yael, Saar)

a. java-security library [maven central] < 2.7.5 affects us directly as our java-commons that is used for both CDM Store and provisioning is using 2.7.4 we need to upgrade and fix the relevant flows.

provisioning mvn dependency:tree
[INFO] +- com.sap.cloud.portal:portal.platform.commons.cf:jar:1.0.0-20201011104922_5bbba278a71862e172e4f47f8ec8579261d00674:compile
[INFO] |  +- com.sap.cloud.security:java-security:jar:2.7.4:compile

store:
[INFO] +- com.sap.cloud.security:java-security-test:jar:2.7.4:test
[INFO] |  +- com.sap.cloud.security:java-security:jar:2.7.4:compile
not used via commons...


commons change. test prov+store. 2pd

b. "getSubaccountId vs. getIdentityZone vs. getZoneId" need to make sure we don't have anything that uses getSubaccountId anymore.
    not used

c. "Java-container-security Xsuaa client library is deprecated" - we need to review what this means as we ae using this library which is now deprecated.

commons:
[INFO] +- com.sap.cloud.security:java-security:jar:2.7.4:compile
[INFO] |  +- com.sap.cloud.security:java-api:jar:2.7.4:compile
[INFO] +- com.sap.cloud.security:java-security-test:jar:2.7.4:test

and
[INFO] +- com.sap.xs.auditlog:audit-java-client-impl:jar:2.0.6:compile
[INFO] |  +- com.sap.xs.java:xs-user-holder:jar:0.3.0:compile
[INFO] |  |  \- com.sap.xs2.security:java-container-security-api:jar:0.20.8:compile

Fix in commons.
new version of java-security, 2.7.4 -> 2.7.8 
https://nexusrel.wdf.sap.corp:8443/nexus/#nexus-search;quick~java-security

new version of audit-java-client-impl, 20.0.6 -> 2.0.16
https://nexusrel.wdf.sap.corp:8443/nexus/#nexus-search;quick~audit-java-client-impl

provisioning:
a. 
[INFO] +- com.sap.cloud.portal:portal.platform.commons.cf:jar:1.0.0-20201011104922_5bbba278a71862e172e4f47f8ec8579261d00674:compile
[INFO] |  +- com.sap.xs.auditlog:audit-java-client-impl:jar:2.0.6:compile
[INFO] |  |  +- com.sap.xs.java:xs-user-holder:jar:0.3.0:compile
[INFO] |  |  |  \- com.sap.xs2.security:java-container-security-api:jar:0.20.8:compile

b.
[INFO] +- com.sap.cloud.portal:portal.platform.commons.cf:jar:1.0.0-20201011104922_5bbba278a71862e172e4f47f8ec8579261d00674:compile
[INFO] |  +- com.sap.xs.auditlog:audit-java-client-impl:jar:2.0.6:compile
[INFO] |  |  +- com.sap.xs.java:xs-user-holder:jar:0.3.0:compile
[INFO] |  |  |  \- com.sap.xs2.security:java-container-security-api:jar:0.20.8:compile


store:
[INFO] +- com.sap.cloud.portal:portal.platform.commons.cf:jar:1.0.0-20200811101259_5bbba278a71862e172e4f47f8ec8579261d00674:compile
[INFO] |  +- com.sap.xs.auditlog:audit-java-client-impl:jar:2.0.6:compile
[INFO] |  |  +- com.sap.xs.java:xs-user-holder:jar:0.3.0:compile
[INFO] |  |  |  \- com.sap.xs2.security:java-container-security-api:jar:0.20.8:compile


Acceptance Criteria :
raise java-security library version and validate
"getSubaccountId vs. getIdentityZone vs. getZoneId" need to make sure we don't have anything that uses getSubaccountId anymore.
understand what are the implication if we use this deperecated lib.
"Java-container-security Xsuaa client library is deprecated" - we need to review what this means as we ae using this library which is now deprecated.
Dagan, Saar

Design:
Test scope:


- Update commons. 2PD
  Code change to fix compilation errors 

- Test CDM store and provisioning. 2PD

                1.20.11.1.2 Code
- commons PR: https://github.wdf.sap.corp/Portal-CF/portal-platform-commons/pull/128

- store: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/559
- provisioning: https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/230
- store require updated dependencies

[INFO] artifact org.powermock:powermock-module-junit4-legacy: checking for updates from mirror1
[INFO] The following dependencies in Dependencies have newer versions:
[INFO]   com.fasterxml.jackson.core:jackson-databind ..... 2.11.2 -> 2.12.0-rc1
[INFO]   com.sap.cloud.portal:portal.platform.commons.cf ...
[INFO]  1.0.0-20200811101259_5bbba278a71862e172e4f47f8ec8579261d00674 -> 1.0.0-20201026110000_27d9e9769f1baf6570ae13385e8f58bb4c0a09ca
[INFO]   com.sap.cloud.security:java-security-test ............. 2.7.4 -> 2.7.8
[INFO]   com.sap.cloud.security.xsuaa:spring-xsuaa ............. 2.7.4 -> 2.7.8
[INFO]   com.sap.hcp.cf.logging:cf-java-logging-support-logback ...
[INFO]                                                           2.2.2 -> 3.1.0
[INFO]   com.sap.hcp.cf.logging:cf-java-logging-support-servlet ...
[INFO]                                                           2.2.2 -> 3.1.0
[INFO]   commons-beanutils:commons-beanutils ......... 1.9.4 -> 20030211.134440
[INFO]   net.jodah:failsafe .................................... 1.0.4 -> 2.4.0
[INFO]   org.apache.commons:commons-lang3 ......................... 3.7 -> 3.11
[INFO]   org.apache.tomcat:tomcat-jdbc .................... 9.0.36 -> 10.0.0-M9
[INFO]   org.everit.json:org.everit.json.schema ................ 1.3.0 -> 1.5.1
[INFO]   org.jsoup:jsoup ..................................... 1.11.3 -> 1.13.1
[INFO]   org.mockito:mockito-core ............................. 1.9.5 -> 3.5.15
[INFO]   org.postgresql:postgresql .................... 42.2.13 -> 42.2.18.jre7
[INFO]   org.powermock:powermock-api-mockito ................... 1.6.1 -> 1.7.4
[INFO]   org.powermock:powermock-module-junit4 ................. 1.6.1 -> 2.0.7
[INFO]   org.powermock:powermock-module-junit4-legacy .......... 1.6.1 -> 2.0.7
[INFO]   org.springframework.security:spring-security-config ...
[INFO]                                                   5.3.3.RELEASE -> 5.4.1
[INFO]   org.springframework.security:spring-security-jwt ...
[INFO]                                           1.0.9.RELEASE -> 1.1.1.RELEASE
[INFO]   org.springframework.security:spring-security-oauth2-jose ...
[INFO]                                                   5.3.3.RELEASE -> 5.4.1
[INFO]   org.springframework.security:spring-security-oauth2-resource-server ...
[INFO]                                                   5.3.3.RELEASE -> 5.4.1
[INFO]   pl.pragmatists:JUnitParams ............................ 1.1.0 -> 1.1.1
[INFO] 
[INFO] The following dependencies in pluginManagement of plugins have newer versions:
[INFO]   org.springframework.boot:spring-boot-maven-plugin ...
[INFO]                                                2.2.9.RELEASE -> 2.4.0-M4
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary for cdm-store-service-parent 1.50.0-SNAPSHOT:

- provisioning require updated dependencies

            1.20.11.6 Additional


            1.20.11.2  move to node 14

                11.20.11.2.1 Links 
BLI:            https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1910

General \ Technical Information
We need to analyze and identify what should be done on each team
Cross team BLI
Identify dependencies, blockers, risk.
|  1. Review your team's dependencies and detect which ones you require in node14 to enable your microservices to upgrade to node14 (There will be also internal dependencies, like sharedlib)
|  2. Provide the list to your PO
|  Acceptance Criteria :
|  1. Review your team's dependencies and detect which ones you require in node14 to enable your microservices to upgrade to node14 (There will be also internal dependencies, like sharedlib)
|  2. Provide the list to your PO

                11.20.11.2.2 Design 

                    11.20.11.2.2.1 NodeJS14 features

                    11.20.11.2.2.2 research

                        11.20.11.2.2.2.1 pre upgrade

my local version is already 14.
[i500695@C02X632CJGH6:2020-10-27 12:23:45:~/work/SAP/git/portal-cf-transport-service:]2152$ node --version
v14.9.0
[i500695@C02X632CJGH6:2020-10-27 12:24:11:~/work/SAP/git/portal-cf-transport-service:]2153$ ts-node --version
v8.9.0
[i500695@C02X632CJGH6:2020-10-27 12:25:09:~/work/SAP/git/portal-cf-transport-service:]2154$ which ts-node
/usr/local/bin/ts-node
[i500695@C02X632CJGH6:2020-10-27 12:25:12:~/work/SAP/git/portal-cf-transport-service:]2155$ which node
/usr/local/bin/node

[i500695@C02X632CJGH6:2020-10-27 12:25:20:~/work/SAP/git/portal-cf-transport-service:]2156$ cat tsconfig.json 
{
  "compilerOptions": {
    "module": "commonjs",
    "declaration": true,
    "removeComments": true,
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "target": "es2017",
    "sourceMap": true,
    "outDir": "./dist",
    "baseUrl": "./",
    "skipLibCheck": true,
    "incremental": true
  }
}

engine set to 12. No errors/warning when running w/ NodeJS14
$ grep node -C 2 package.json 
    "engines": {
        "node": "^12.0.0",
        "npm": ">=6.0.0"

even when I set engine-strict:
$ cat .npmrc 
registry=http://nexus.wdf.sap.corp:8081/nexus/content/groups/build.releases.npm/
strict-ssl=true
engine-strict=true

                        11.20.11.2.2.2.2 ts-node impact

                            11.20.11.2.2.2.2.1 https://stackoverflow.com/questions/61305578/what-typescript-configuration-produces-output-closest-to-node-js-14-capabilities

As of Node.js 14.0.0, 100% of ES2020 is supported, and support for ES Modules has landed! If you know that you are targeting that version or newer, the optimal config would look like this:

"module": "ES2020" & "moduleResolution": "node"

Node.js 14 support loading modules instead of the old CommonJS format, we do thave to tell TypeScript that we are using Node.js's rules for resolving modules.

"allowSyntheticDefaultImports": true

To provide backwards compatibility, Node.js allows you to import CommonJS packages with a default import. This flag tells TypeScript that it's okay to use import on CommonJS modules.

"target": "ES2020"

This tells TypeScript that it's okay to output JavaScript syntax with features from ES2020. In practice, this means that it will e.g. output optional chaining operators & async/await syntax instead of embedding a polyfill.

"lib": ["ES2020"]

This tells TypeScript that it's okay to use functions and properties introduced in ES2020 or earlier. In practice, this means that you can use e.g. Promise.allSettled and BigInt.

The full config would thus be:

{
  "compilerOptions": {
    "allowSyntheticDefaultImports": true,
    "lib": ["ES2020"],
    "module": "ES2020",
    "moduleResolution": "node",
    "target": "ES2020"
  }
}
In addition to this, we also need to tell Node.js to treat .js files in this project as ES Modules. The reason for this is that Node.js had to maintain backwards compatibility with code written for older Node.js versions. This can be done by adding "type": "module" to your package.json:

{
  "type": "module"
}
Another change if you are comming from an earlier version of Node.js is that the file extension when importing files are now mandatory. This means that you must write out .js at the end of your local imports. Note that this is .js even though you are importing a TypeScript file that actually has the file extension .ts. This might seem a bit confisuing but this comment from one of the TS contributors explains why that is.

Here are some examples of how to write your import statements:

// Built-in Node.js modules
import { readFileSync } from 'fs'

// CommonJS packages from Npm
import md5File from 'md5-file'

// The local file "a.ts"
import { a } from './a.js'
If you want to stick with CommonJS for now, to avoid the caveats explained above, you can use the following config:

{
  "compilerOptions": {
    "lib": ["ES2020"],
    "module": "CommonJS",
    "target": "ES2020"
  }
}
If you are running Node.js 12 you can see my similar answer for Node.js 12 here

If you are running Node.js 10 you can see my similar answer for Node.js 10 here

If you are running Node.js 8 you can see my similar answer for Node.js 8 here

                            11.20.11.2.2.2.2.2 commonjs modules

                            11.20.11.2.2.2.2.3 push w/ node 14 build pack
Node12 buildpack:
$ Ag buildpack
manifest-dev.yml
8:    buildpacks:
9:      - https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.19

manifest.yml
7:    buildpacks:
8:      - https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.19

manifest-concourse.yml
7:    buildpacks:
8:      - https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.19

- documentation
  https://docs.cloudfoundry.org/buildpacks/node/index.html#runtime
  "
Specify a Node.js Version
To specify a Node.js version, set the engines.node in the package.json file to the semantic versioning specification (semver) range or the specific version of Node you are using.

Example showing a semver range:

"engines": {
  "node": "6.9.x"
}
Example showing a specific version:

"engines": {
  "node": "6.9.0"
}
  "

- try latest buildpack version, https://github.com/cloudfoundry/nodejs-buildpack/releases/tag/v1.7.33

- push to Shirly space
cf t -o launchpad -s i310019p
cf ssh portal-cf-transport-service
verify version:
vcap@fd448855-ca4a-4720-4e5e-b6f8:~/deps/0/node/bin$ ./node --version
./node --version
v14.14.0

                            11.20.11.2.2.2.2.4
                        11.20.11.2.2.2.3

                    11.20.11.2.2.3 open questions
A. do we want to generate and consume diagnost reports?
ex:
[i500695@C02X632CJGH6:2020-10-27 12:42:17:~/work/SAP/git/portal-cf-transport-service:]2173$ node --report-uncaught-exception --report-on-signal --report-on-fatalerror dist/main.js 

explictly generate report:
process.report.writeReport();

B.
                11.20.11.2.3 Tests 
Transport mem size 1GB:
[i500695@C02X632CJGH6:2020-11-19 10:31:47:~/work/SAP/git/portal-cf-transport-service:]2013$ cf app portal-cf-transport-service
Showing health and status for app portal-cf-transport-service in org launchpad / space i500695p as yosi.izaq@sap.com...

name:              portal-cf-transport-service
requested state:   started
routes:            portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/transport_service
last uploaded:     Wed 18 Nov 14:52:33 IST 2020
stack:             cflinuxfs3
buildpacks:
	name                                                           version   detect output   buildpack name
	https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.33   1.7.33    nodejs          nodejs

type:           web
sidecars:
instances:      1/1
memory usage:   1024M
     state     since                  cpu     memory         disk         details
#0   running   2020-11-18T12:53:14Z   12.1%   149.8M of 1G   1.2G of 4G

CDM store mem size 1GB:
[i500695@C02X632CJGH6:2020-11-19 10:33:12:~/work/SAP/git/portal-cf-cdm-store-service:]2021$ cf app portal-cf-cdm-store-service
Showing health and status for app portal-cf-cdm-store-service in org launchpad / space i500695p as yosi.izaq@sap.com...

name:              portal-cf-cdm-store-service
requested state:   started
routes:            portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service
last uploaded:     Thu 12 Nov 11:22:31 IST 2020
stack:             cflinuxfs3
buildpacks:
	name                 version   detect output   buildpack name
	sap_java_buildpack

type:           web
sidecars:
instances:      1/1
memory usage:   1024M
     state     since                  cpu    memory       disk           details
#0   running   2020-11-17T12:29:59Z   6.5%   350M of 1G   212.5M of 4G

                    11.20.11.2.3.1 logs


                        ~/work/SAP/logs/ep_content_transport_errors:]2029$ ls
store/	transp/
- transport memory <url:/Users/i500695/work/SAP/logs/ep_content_transport_errors/transp/rss_logs>

2020-11-17T11:42:06.33+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 1 mem: rss: 127.0546875MB, heap total 58.84375MB, heap used 55.05821228027344MB, external 1.9382247924804688MB, buffers 0.5401687622070312MB
2020-11-17T11:42:13.30+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 2 mem: rss: 132.33984375MB, heap total 67.98046875MB, heap used 55.42747497558594MB, external 2.3332767486572266MB, buffers 0.7233076095581055MB
2020-11-17T11:42:19.13+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 3 mem: rss: 144.4375MB, heap total 86.6484375MB, heap used 62.8985595703125MB, external 2.3462133407592773MB, buffers 0.7362957000732422MB
2020-11-17T11:42:25.18+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 4 mem: rss: 165.6640625MB, heap total 100.20703125MB, heap used 81.70816040039062MB, external 2.7865867614746094MB, buffers 0.9649524688720703MB
2020-11-17T11:42:33.73+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 5 mem: rss: 147.32421875MB, heap total 81.4765625MB, heap used 60.40086364746094MB, external 2.3460798263549805MB, buffers 0.7363071441650391MB
2020-11-17T11:42:39.72+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 6 mem: rss: 147.9140625MB, heap total 81.86328125MB, heap used 61.96907043457031MB, external 2.770730972290039MB, buffers 0.9492416381835938MB
2020-11-17T11:42:45.53+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 7 mem: rss: 152.0390625MB, heap total 86.6484375MB, heap used 57.808990478515625MB, external 2.3277359008789062MB, buffers 0.7179632186889648MB
2020-11-17T11:43:25.38+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 14 mem: rss: 167MB, heap total 99.95703125MB, heap used 66.20939636230469MB, external 2.778531074523926MB, buffers 0.9570417404174805MB
2020-11-17T11:44:29.81+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 25 mem: rss: 163.4609375MB, heap total 95MB, heap used 75.4025650024414MB, external 4.492873191833496MB, buffers 1.8245172500610352MB
2020-11-17T11:45:29.18+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 35 mem: rss: 167.078125MB, heap total 98.08984375MB, heap used 73.53939819335938MB, external 3.192869186401367MB, buffers 1.159663200378418MB
2020-11-17T11:45:40.79+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 37 mem: rss: 172.05859375MB, heap total 102.95703125MB, heap used 86.0416488647461MB, external 4.049985885620117MB, buffers 1.5933465957641602MB
2020-11-17T11:48:02.15+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 61 mem: rss: 169.51171875MB, heap total 99.671875MB, heap used 75.93643951416016MB, external 4.49131965637207MB, buffers 1.8116254806518555MB
2020-11-17T11:48:52.37+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 70 mem: rss: 178.6171875MB, heap total 108.7890625MB, heap used 76.62872314453125MB, external 2.7870969772338867MB, buffers 0.9617929458618164MB
2020-11-17T11:49:20.20+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 75 mem: rss: 180.41796875MB, heap total 110.38671875MB, heap used 83.24197387695312MB, external 4.926923751831055MB, buffers 2.033474922180176MB
2020-11-17T11:59:45.61+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 186 mem: rss: 186.76953125MB, heap total 112.14453125MB, heap used 97.2828598022461MB, external 4.125765800476074MB, buffers 1.6357765197753906MB
2020-11-17T12:02:59.06+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 220 mem: rss: 167.76171875MB, heap total 93.15625MB, heap used 70.38873291015625MB, external 2.820005416870117MB, buffers 0.9851360321044922MB
2020-11-17T12:08:30.85+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 279 mem: rss: 179.62109375MB, heap total 101.93359375MB, heap used 70.0880126953125MB, external 3.009310722351074MB, buffers 1.087876319885254MB
2020-11-17T12:09:00.40+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 284 mem: rss: 188.06640625MB, heap total 110.54296875MB, heap used 72.55558776855469MB, external 3.4528989791870117MB, buffers 1.313735008239746MB
2020-11-17T12:11:02.21+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 306 mem: rss: 185.515625MB, heap total 107.203125MB, heap used 78.44023895263672MB, external 6.152556419372559MB, buffers 2.651639938354492MB
2020-11-17T12:11:40.65+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 313 mem: rss: 187.02734375MB, heap total 108.53515625MB, heap used 88.15431213378906MB, external 4.39760684967041MB, buffers 1.785287857055664MB
2020-11-17T12:15:04.86+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 350 mem: rss: 186.28125MB, heap total 107.19140625MB, heap used 89.46094512939453MB, external 3.4535341262817383MB, buffers 1.315028190612793MB
2020-11-17T12:15:15.90+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 352 mem: rss: 175.57421875MB, heap total 96.30859375MB, heap used 65.6383285522461MB, external 2.968977928161621MB, buffers 1.0746564865112305MB
2020-11-17T12:16:22.22+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 364 mem: rss: 180.7265625MB, heap total 101.5MB, heap used 83.55825805664062MB, external 2.962848663330078MB, buffers 1.0681982040405273MB
2020-11-17T12:18:12.86+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 384 mem: rss: 186.92578125MB, heap total 107.75MB, heap used 88.37725067138672MB, external 2.9390878677368164MB, buffers 1.0459728240966797MB
2020-11-17T12:23:59.00+0200 INFO 5f1d16b4-bee3-41e7-4c6b-bd2236a536ff  TransportJob:95 ---- chunk 446 mem: rss: 186.54296875MB, heap total 106.7890625MB, heap used 71.8763656616211MB, external 2.8779382705688477MB, buffers 1.0114812850952148MB

- transport OOM
<url:/Users/i500695/work/SAP/logs/ep_content_transport_errors/repro1_catalog160krels/transp/logs_copy2>
   2020-11-17T14:29:24.88+0200 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"9f69f2fc-661a-418f-a554-d0e1a453004e","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"launchpad","organization_id":"c7486965-e5bd-4047-a1a1-79f702a29304","space_name":"i500695p","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","container_id":"10.0.74.48","logger":"nodejs-logger","source_instance":0,"written_at":"2020-11-17T12:29:24.019Z","written_ts":1605616164019000000,"level":"info","correlation_id":"81f21ec9-2788-471f-5628-bc85a8d1f52d","tenant_id":"-","request_id":"29a8901d-4b27-4a47-5783-d2dd322d8e8b","msg":"portal-cf-shared-lib/common/retry.js:29 - getRetryAxios - config { name: 'cdm-store-client' }","type":"log","location":"portal-cf-shared-lib/common/retry.js:29"}
2020-11-17T14:29:24.88+0200 [93mINFO[0m [32m81f21ec9-2788-471f-5628-bc85a8d1f52d[0m  portal-cf-shared-lib/common/retry.js:29 - getRetryAxios - config { name: 'cdm-store-client' }
   2020-11-17T14:29:37.27+0200 [APP/PROC/WEB/0] OUT {"component_type":"application","component_id":"9f69f2fc-661a-418f-a554-d0e1a453004e","component_name":"portal-cf-transport-service","component_instance":0,"layer":"[NODEJS]","organization_name":"launchpad","organization_id":"c7486965-e5bd-4047-a1a1-79f702a29304","space_name":"i500695p","space_id":"7e0d5a8a-30ae-4b1b-948b-cfa4914de088","container_id":"10.0.74.48","logger":"nodejs-logger","source_instance":0,"written_at":"2020-11-17T12:29:37.274Z","written_ts":1605616177274000000,"level":"error","correlation_id":"81f21ec9-2788-471f-5628-bc85a8d1f52d","tenant_id":"-","request_id":"29a8901d-4b27-4a47-5783-d2dd322d8e8b","msg":"portal-cf-shared-lib/common/service-request.js:49 - performRequest - failed to perform request. url  https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/transport/import, retries 0","type":"log","location":"portal-cf-shared-lib/common/service-request.js:49"}
2020-11-17T14:29:37.27+0200 [91mERROR[0m [32m81f21ec9-2788-471f-5628-bc85a8d1f52d[0m  portal-cf-shared-lib/common/service-request.js:49 - performRequest - failed to perform request. url  https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/transport/import, retries 0
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR <--- Last few GCs --->
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR [205:0x560c71f92f40]  5746850 ms: Scavenge (reduce) 510.9 (534.3) -> 510.8 (535.3) MB, 2.7 / 0.0 ms  (average mu = 0.939, current mu = 0.666) allocation failure 
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR [205:0x560c71f92f40]  5746939 ms: Mark-sweep (reduce) 512.0 (529.6) -> 511.7 (534.1) MB, 86.5 / 0.0 ms  (average mu = 0.887, current mu = 0.156) allocation failure scavenge might not succeed
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR <--- JS stacktrace --->
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR FATAL ERROR: MarkCompactCollector: young object promotion failed Allocation failed - JavaScript heap out of memory
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR  1: 0x560c6cb58a60 node::Abort() [node]
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR  2: 0x560c6cb593be node::OnFatalError(char const*, char const*) [node]
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR  3: 0x560c6ccfb882 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [node]
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR  4: 0x560c6ccfbbff v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, bool) [node]
    
   2020-11-17T14:29:38.41+0200 [APP/PROC/WEB/0] ERR  5: 0x560c6cefa885  [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR  6: 0x560c6cf3000c v8::internal::EvacuateNewSpaceVisitor::Visit(v8::internal::HeapObject, int) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR  7: 0x560c6cf37996 void v8::internal::LiveObjectVisitor::VisitBlackObjectsNoFail<v8::internal::EvacuateNewSpaceVisitor, v8::internal::MajorNonAtomicMarkingState>(v8::internal::MemoryChunk*, v8::internal::MajorNonAtomicMarkingState*, v8::internal::EvacuateNewSpaceVisitor*, v8::internal::LiveObjectVisitor::IterationMode) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR  8: 0x560c6cf3b9c4 v8::internal::FullEvacuator::RawEvacuatePage(v8::internal::MemoryChunk*, long*) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR  9: 0x560c6cf27669 v8::internal::Evacuator::EvacuatePage(v8::internal::MemoryChunk*) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 10: 0x560c6cf2794f v8::internal::PageEvacuationTask::RunInParallel(v8::internal::ItemParallelJob::Task::Runner) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 11: 0x560c6cf18cda v8::internal::ItemParallelJob::Run() [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 12: 0x560c6cf386c3 void v8::internal::MarkCompactCollectorBase::CreateAndExecuteEvacuationTasks<v8::internal::FullEvacuator, v8::internal::MarkCompactCollector>(v8::internal::MarkCompactCollector*, v8::internal::ItemParallelJob*, v8::internal::MigrationObserver*, long) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 13: 0x560c6cf3fd12 v8::internal::MarkCompactCollector::EvacuatePagesInParallel() [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 14: 0x560c6cf40946  [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 15: 0x560c6cf5c010 v8::internal::MarkCompactCollector::CollectGarbage() [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 16: 0x560c6cf0a8cd v8::internal::Heap::MarkCompact() [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 17: 0x560c6cf0b378 v8::internal::Heap::PerformGarbageCollection(v8::internal::GarbageCollector, v8::GCCallbackFlags) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 18: 0x560c6cf0b9e7 v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 19: 0x560c6cf0f43c v8::internal::Heap::AllocateRawWithRetryOrFailSlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 20: 0x560c6ced2002 v8::internal::Factory::AllocateRaw(int, v8::internal::AllocationType, v8::internal::AllocationAlignment) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 21: 0x560c6cecba84 v8::internal::FactoryBase<v8::internal::Factory>::AllocateRawWithImmortalMap(int, v8::internal::AllocationType, v8::internal::Map, v8::internal::AllocationAlignment) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 22: 0x560c6cecdf1f v8::internal::FactoryBase<v8::internal::Factory>::NewRawTwoByteString(int, v8::internal::AllocationType) [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 23: 0x560c6d3268ec v8::internal::IncrementalStringBuilder::Extend() [node]
    
   2020-11-17T14:29:38.42+0200 [APP/PROC/WEB/0] ERR 24: 0x560c6d015d73 v8::internal::JsonStringifier::SerializeString(v8::internal::Handle<v8::internal::String>) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 25: 0x560c6d0158d7 v8::internal::JsonStringifier::SerializeString(v8::internal::Handle<v8::internal::String>) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 26: 0x560c6d017f9d v8::internal::JsonStringifier::Result v8::internal::JsonStringifier::Serialize_<true>(v8::internal::Handle<v8::internal::Object>, bool, v8::internal::Handle<v8::internal::Object>) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 27: 0x560c6d01b94d v8::internal::JsonStringifier::Result v8::internal::JsonStringifier::Serialize_<false>(v8::internal::Handle<v8::internal::Object>, bool, v8::internal::Handle<v8::internal::Object>) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 28: 0x560c6d01cd7c v8::internal::JsonStringify(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 29: 0x560c6cdbf9ab v8::internal::Builtin_JsonStringify(int, unsigned long*, v8::internal::Isolate*) [node]
    
   2020-11-17T14:29:38.43+0200 [APP/PROC/WEB/0] ERR 30: 0x560c6d674579  [node]
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR Aborted
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! code ELIFECYCLE
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! errno 134
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! portal-cf-transport-service@2.17.0 start:debug: `npm run build && node --inspect dist/main.js`
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! Exit status 134
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! 
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! Failed at the portal-cf-transport-service@2.17.0 start:debug script.
    
   2020-11-17T14:29:38.47+0200 [APP/PROC/WEB/0] ERR npm ERR! This is probably not a problem with npm. There is likely additional logging output above.
    
   2020-11-17T14:29:38.48+0200 [APP/PROC/WEB/0] ERR npm ERR! A complete log of this run can be found in:
    
   2020-11-17T14:29:38.48+0200 [APP/PROC/WEB/0] ERR npm ERR!     /home/vcap/app/.npm/_logs/2020-11-17T12_29_38_478Z-debug.log
    
   2020-11-17T14:29:38.52+0200 [APP/PROC/WEB/0] OUT Exit status 134
    

- store OOM
   2020-11-17T14:29:30.09+0200 [APP/PROC/WEB/0] ERR Resource exhaustion event: the JVM was unable to allocate memory from the heap.
    
   2020-11-17T14:29:30.09+0200 [APP/PROC/WEB/0] ERR ResourceExhausted! (1/0)
    
   2020-11-17T14:29:37.23+0200 [RTR/21] OUT portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com - [2020-11-17T12:29:24.768641929Z] "POST /cdm_store_service/transport/import?contextId=ep2&contextType=SNAPSHOT HTTP/1.1" 502 61697413 67 "-" "axios/0.18.1" "-" "10.0.73.129:61226" x_forwarded_for:"-" x_forwarded_proto:"https" vcap_request_id:"52b07608-21e1-4d3c-7643-063696d93a86" response_time:12.465163 gorouter_time:0.000153 app_id:"f835ba3b-dd7c-4817-adfb-feb96c4fa049" app_index:"0" x_cf_routererror:"endpoint_failure" x_correlationid:"81f21ec9-2788-471f-5628-bc85a8d1f52d" tenantid:"-" sap_passport:"-" x_scp_request_id:"3f527f15-981c-4b7f-8645-17ffc988c01f-5FB3C224-9700D4" x_cf_app_instance:"-" x_b3_traceid:"ddd7664789dd144a" x_b3_spanid:"ddd7664789dd144a" x_b3_parentspanid:"-" b3:"ddd7664789dd144a-ddd7664789dd144a"
    
   2020-11-17T14:29:37.23+0200 [RTR/21] OUT 
    
   2020-11-17T14:29:37.26+0200 [APP/PROC/WEB/0] OUT Exit status 137 (out of memory)
    
   2020-11-17T14:29:37.26+0200 [SSH/0] OUT Remote access ended for 10.0.136.3:58532
    
   2020-11-17T14:29:37.26+0200 [CELL/SSHD/0] OUT Exit status 0
    
   2020-11-17T14:29:42.78+0200 [CELL/0] OUT Cell 9ae14043-c3cc-4907-949a-086e1215831e stopping instance 97733f19-a0e1-4b51-67b8-0b5d
    
   2020-11-17T14:29:42.78+0200 [CELL/0] OUT Cell 9ae14043-c3cc-4907-949a-086e1215831e destroying container for instance 97733f19-a0e1-4b51-67b8-0b5d
    
   2020-11-17T14:29:42.87+0200 [CELL/0] OUT Cell b3f221c9-1297-4ac5-8194-cd80010becf4 creating container for instance ea6951d4-4991-416f-469c-9a68
    
   2020-11-17T14:29:43.02+0200 [PROXY/0] OUT Exit status 137

- store crashes 1st. 2020-11-17T14:29:30.09+0200 then transport at 2020-11-17T14:29:38.43+0200 during a retry attempt during JSON.stringify   
-  crash after 150400 businessapp entities. at 200 per chunk. making at the 753 chunk that contains the crashing entities
- crashing entity. 1 catalog w/ 155k relations.
- 

                11.20.11.2.4 Tasks 
                11.20.11.2.5 Code 
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/328
PR falls b/c of tsconfig.json target 2020
full node14 config should be:
{
  "compilerOptions": {
    "allowSyntheticDefaultImports": true,
    "lib": ["ES2020"],
    "module": "ES2020",
    "moduleResolution": "node",
    "target": "ES2020"
  }
}
I changed target to es2017 and removed module ES2020 line for CI to pass.


                11.20.11.2.6 Additional 

                    11.20.11.2.6.1 Update regarding Node14
                    update from Asaf


                From: Klieger, Assaf <assaf.klieger@sap.com> 
Subject: RE: Update regarding Node14
 
Additional updates:
The current audit log version should work with node 14 (the colleagues do not see any risk with it) see attached mail,
Hana client will release a new version at Dec 17th so we assume that after a few days there will be official version of audit log, as they will be able to run their unit tests with node14.
New shared-lib version: 5.3.0-20201110123055
Moved to a new CI Docker “docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-14:14.15.0” instead of docker.wdf.sap.corp:50000/piper/node:latest which was very old:
e.g. https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/pull/346/files#diff-f040a0d3759794af5ab0ab3a47c98b3fR65
Moved to ecmaVersion 2020, had to switch to grunt-eslint
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/pull/346/files#diff-0378d5111ab996d5882f4712e9350604R6
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/pull/346/files#diff-b9cfc7f2cdf78a7f4b91a753d10865a2R27
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/pull/346/files#diff-35b4a816e0441e6a375cd925af50752c
Moved to build in xmake to 14.5.0
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/pull/346/files#diff-167ebc663f9281a7f6ebe3b53e1415c6
 
In order to continue testing Node 14, the next step we need your support with the other modules:
 
@Moskovich, Guy Can you please update:
cdm-schema, with the latest FOSS (npm-check -u) uuid may require small code change.
Maas-client, with the latest FOSS (npm-check -u), shared - lib 5.3.0-20201110123055 – also update engines – I suggest to remove it in node modules.
@Adoram, Nili – Can you please update feature-flags, with the latest FOSS (npm-check -u), shared - lib 5.3.0-20201110123055
 
@Dagan, Saar – Can you please update cdm-store-client, with the latest FOSS (npm-check -u), shared - lib 5.3.0-20201110123055
 
Once we will have these new versions we will be able to validate our services, and check also that audit log works correctly with the current version (without waiting for the official version).
 
We will update if we see more changes that are needed for the Node 14 transition.
 
Best Regards,
Assaf

                    11.20.11.2.6.2 action items
a. update shared-lib version: 5.3.0-20201110123055 in portal-cf-transport-service and cdm-store-client
cdm-store-client branch  yosi_10_11_20__17_29  
b. lint ecma versions
cdm-store-client NA
portal-cf-transport-service NA
c. update pipeline and xmake in portal-cf-transport-service. update cdm-store-client version
in .xmake.cfg: node-version=14.5.0
in .pipeline/config.yml:
    change: dockerImage: docker.wdf.sap.corp:50000/piper/node:latest
    to:     dockerImage: docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-14:14.15.0
d. upgrade versions of xssec, xsenv
"@sap/xsenv": "3.1.0",
         "@sap/xssec": "3.0.10",

e. FOSS, cdm-store-client , update dependencies according npm-check
f. update portal-cf-transport-service 

                    11.20.11.2.6.3
                11.20.11.2.7
            1.20.11.3 Fix transport commit timeout, mass content
        1.20.11.3.1 Links
        BLI:  https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1938 
EP open a ticket that when they are transporting 50,000 simple roles(very basic role with few apps), transport is passing successfully. However, when they are trying to transport 5000 of FFP demo role, which is a bit more complex role, with 37 entities only.
We need to understand what is the problem exactly first?
Transport is failing due to databased connection exhaustion on commit the transport. Saar saw that there are a lot of relation that we try to commit at once to CDM store.
We should support mass content of transport with high amount of entities and relations, in commit to CDM store.
Design and Implementation
Nestle will have 40000 roles with up to 100 apps each. the will have one massive role with 6500 apps.
EP ticket https://support.wdf.sap.corp/sap/support/message/2070417548

        Design: 
        Test scope:

problem:
commit to DB takes too long.
Total # of connections to DT DB. 250.
Allocated max # connections for cdm-store-service. 10
see:
    [i500695@C02X632CJGH6:2020-11-08 13:55:43:~/work/SAP/git/portal-cf-cdm-store-service:]2062$Ag CDM_MAX_POOL_SIZE
    manifest-concourse.yml
    25:  CDM_MAX_POOL_SIZE: 10
    
    manifest-dev.yml
    20:    CDM_MAX_POOL_SIZE: 10
    
    manifest.yml
    16:    CDM_MAX_POOL_SIZE: 10
    
    cdm.store.service/src/main/java/com/sap/portal/cf/database/postgres/PostgresDataSource.java
    69:            if (System.getenv("CDM_MAX_POOL_SIZE") != null) {
    70:                maxPoolSize = Integer.parseInt(System.getenv("CDM_MAX_POOL_SIZE"));


Commit code:

Possible fixes:
a. Add indexes. on context id and type
add migration to cdm.store.service/target/classes/db/migration/postgres/V19.4.21.0__entities_table.sql
e.g. 
create index context_id_idx ON contextid USING btree (n);

indexes queries:
a1. 
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" LIMIT 20;

explain analyze SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES";
Seq Scan on "CDM_ENTITIES"  (cost=0.00..38638.57 rows=150657 width=1776) (actual time=0.064..576.800 rows=150635 loops=1)
Execution time: 721.384 ms

a2. index cdm entities
drop index idx on table cdm."CDM_ENTITIES";  
drop index contextTypex on table cdm."CDM_ENTITIES"; 
create index idx on cdm."CDM_ENTITIES" (id);
create index contextTypex on cdm."CDM_ENTITIES" ("contextType");
create index contextTypelx on cdm."CDM_ENTITIES" (lower("contextType"));
create index tenantIdx on cdm."CDM_ENTITIES" ("tenantId");

some contextType, id :
SNAPSHOT, ep2_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3
explain analyze SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE id='ep2_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3' and "contextType"='SNAPSHOT' LIMIT 20;

  ->  Seq Scan on "CDM_ENTITIES"  (cost=0.00..39391.53 rows=150093 width=1776) (actual time=0.013..0.048 rows=20 loops=1)
Execution time: 0.125 ms

a3. index relations table
SELECT "fromMD5", "fromContextId", "fromContextType", "fromEntityId", "fromEntityType", "fromTenantId", "toMD5", "toContextId", "toContextType", "toEntityId", "toEntityType", "toTenantId", "relationType" FROM cdm."RELATIONS";

create index fromContextIdx on cdm."RELATIONS" ("fromContextId");
create index toContextIdx on cdm."RELATIONS" ("toContextId");
create index fromEntityTypex on cdm."RELATIONS" ("fromEntityType");
create index fromTenantIdx on cdm."RELATIONS" ("fromTenantId");
create index toTenantIdx on cdm."RELATIONS" ("toTenantId");
create index toContextTypelx on cdm."RELATIONS" (lower("toContextType"));
create index fromContextTypelx on cdm."RELATIONS" (lower("fromContextType"));

a4. check # rows
select count(*) from cdm."RELATIONS"; 
select count(*) from cdm."CDM_ENTITIES"; 
select (select count(*) from cdm."RELATIONS") as count1, (select count(*) from cdm."CDM_ENTITIES") as count2 ;

a5. lines for new provider
get the generated contextid 
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id" like '%ep3%' limit 1;
ep4_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3

SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id"='ep4_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
select count (*) FROM cdm."CDM_ENTITIES" WHERE "id"='ep4_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
EX:

Ex:
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "id"='ep3_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';

count:
select count(*) FROM cdm."CDM_ENTITIES" WHERE "id"='ep3_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
select count(*) FROM cdm."CDM_ENTITIES" WHERE "id"='ep4_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';
79000
select count(*) FROM cdm."RELATIONS" WHERE "toContextId"='ep3_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3';

cleanup entities table:
DELETE FROM cdm."CDM_ENTITIES"

a6. explain the heavy queries
    a6.1 delete existing context. just keep local provider entities.
DELETE FROM cdm."CDM_ENTITIES" WHERE id=<contextID> and lower(contextType)=lower(<contextType>) AND entityType NOT IN ('provider')

Simulate w/ select. 
explain analyze select FROM cdm."CDM_ENTITIES" WHERE id='ep3_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3' and lower("contextType")='snapshot' AND "entityType" NOT IN ('provider');
Index Scan using idx on "CDM_ENTITIES"  (cost=0.42..24400.48 rows=388 width=0) (actual time=0.142..798.622 rows=79000 loops=1)
Execution time: 871.219 ms

    a6.2 update temp context
    UPDATE CDM_ENTITIES SET id = tocontextId, contextType = lower(tocontextType) WHERE id = contextId AND lower(fromcontextType) = lower(fromcontextType) AND tenantId = tenantId;
simulate:
explain analyze select FROM cdm."CDM_ENTITIES" WHERE id='ep3_Temp_6275b50e-f163-4a1d-8fc1-54793c9889b3' AND lower("contextType")='snapshot' AND "tenantId"='810cd5c3489a9ef95a15cdf407e6b264';
Index Scan using idx on "CDM_ENTITIES"  (cost=0.42..24400.48 rows=387 width=0) (actual time=0.088..603.560 rows=79000 loops=1)
Execution time: 679.265 ms

b. Break down the big transaction to smaller ones.
code:
b1. src/main/java/com/sap/portal/cdm/store/webaccess/TransportController.java
    @PostMapping(value = "/commit", consumes = "application/json", produces = "application/json")
    @ApiOperation(value = "Commits import changes - changes temporary contexts to their original contexts.", response = String.class)
    public ResponseEntity commit(@RequestBody ArrayList<CommitConfiguration> commitConfigurations) {
        this.logger.trace("TransportController:commit() called with commitConfigurations = {}", commitConfigurations);
        List<AffectedSiteReferences> affectedSites;
        try {
            final ArrayList<SyncEntity> entityIdsToDelete = this.syncTableService.selectSyncCandidatesEntitiesIds(commitConfigurations);
            affectedSites = affectedSiteRefService.getAffectedSitesFromEntities(entityIdsToDelete);
            List<CommitResult> commitResults = transportAgent.commitAll(commitConfigurations);
            affectedSites.addAll(affectedSiteRefService.getAffectedSitesReferencesFromCommits(commitResults));
            this.logger.debug("TransportController::commit() affectedSites found = {}", Arrays.toString(affectedSites.toArray()));
            return ResponseEntity.ok(affectedSites.stream().distinct().collect(Collectors.toList()));
        } catch (Exception error) {
            this.logger.error("commit() error while committing one or more of the contexts", error);
            return new ResponseEntity<>(HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }

b2. src/main/java/com/sap/portal/cdm/store/service/impl/TransportAgent.java
    @Transactional("transactionManager")
    @Override
    public List<CommitResult> commitAll(List<CommitConfiguration> commitConfigurations) {
        this.logger.trace("commitAll() called with commitConfigurations = {}", commitConfigurations);
        List<CommitResult> results = new ArrayList<>();

        for (CommitConfiguration commitConfiguration : commitConfigurations) {
            CommitResult result = this.commit(commitConfiguration);
            results.add(result);
        }

        return results;
    }
which calls:
    @Transactional("transactionManager")
    @Override
    public List<IEntity> commit(String contextId, String contextType, boolean deltaUpdate) throws RuntimeException {
        this.logger.debug("commit() on contextId = {}, contextType = {}, deltaUpdate = {}", contextId, contextType, deltaUpdate);
        Assert.notNull(contextId, "context id can't be null");
        Assert.notNull(contextType, "context type can't be null");
        List<IEntity> committedEntities = new ArrayList<>();
        try {
            if (deltaUpdate) {
                committedEntities = updateWithDelta(contextId, contextType);
                int deleteEntitiesFromCDM = deleteEntitiesFromCDM(contextId, contextType);
                int deleteSyncCandidatesEntities = deleteSyncCandidatesEntities(contextId, contextType);
                this.logger.debug("deleteEntitiesFromCDM = {}, deleteSyncCandidatesEntities = {} ", deleteEntitiesFromCDM, deleteSyncCandidatesEntities);

            } else {
                updateWithoutDelta(contextId, contextType);
            }
        } catch (RuntimeException e) {
            logger.error("commit() commit failed.", e);
            throw e;
        }

        return committedEntities;
    }

b3. sql queries involved. update, no delta
a. delete existing context. just keep local provider entities.
DELETE FROM CDM-ENTITIES WHERE id=<contextID> and lower(contextType)=lower(<contextType>) AND entityType NOT IN ('provider')

and
DELETE FROM  RELATIONS WHERE fromEntityType NOT IN (<list of entityType to keep>) AND fromTenantId = tenantID AND fromContextId = contextId AND lower(fromContextType) = lower(contextType OR  toTenantId = tenantID AND toContextId = contextId AND lower(toContextType) = lower(contextType) AND relationType <> 'extends';


b. update temp context to context
    UPDATE  CDM_ENTITIES  SET id = tocontextId, contextType = lower(tocontextType) WHERE id = contextId AND lower(fromcontextType) = lower(fromcontextType) AND tenantId = tenantId;


b4. update relations
    UPDATE cdm.RELATIONS SET fromMD5 = MD5(concat_ws('::', tocontextId lower(tocontextType), fromEntityId, fromEntityType, fromTenantId)), fromContextId = fromContextId, fromContextType = lower(fromContextType), toMD5 = MD5(concat_ws('::', replace(toContextId, toContextId, ''), toContextType, toEntityId, toEntityType, toTenantId)), toContextId = replace(toContextId, toContextId, '')  WHERE (fromContextId = fromContextId AND lower(fromContextType) = lower(fromContextType)) AND (fromTenantId = fromTenantId);




repro:
On shirly's space. 

EP content:
http://mo-831912a33.mo.sap.corp:50000/irj/servlet/prt/prtrw/prtroot/com.sap.portal.cdm.persistency.EPCDMEntitiesComponent
user/pass
administrator/abcd@1234

client getter script:
[i500695@C02X632CJGH6:2020-11-08 16:45:45:~/work/SAP/CF/PoC/s4_integration_to_FLP_portal:]2080$ cat get_all.js 
process.env["NODE_TLS_REJECT_UNAUTHORIZED"] = 0
const request = require('request')
const uxt928url = 'https://ldciuxt.wdf.sap.corp:44311/sap/bc/ui2/cdm3/entities?sap-client=928'
const uyz200url = 'https://ldciuyz.wdf.sap.corp:44300/sap/bc/ui2/cdm3/entities?sap-client=200'
const uyr200url = 'https://ldai1uyr.wdf.sap.corp:44300/sap/bc/ui2/poc_cdm3/entities?sap-client=200&useRA=true'
const epurl = 'http://mo-831912a33.mo.sap.corp:50000/irj/servlet/prt/prtrw/prtroot/com.sap.portal.cdm.persistency.EPCDMEntitiesComponent'
const url = epurl
const s4user='cflp_tester'
const s4pwd='Abcd1234'
const epuser='administrator'
const eppwd='abcd@1234'
//var adam = 'COHENADA'
var yosi = 'IZAQ'
//var password = 'Walldorf01'
var password = 'Raanana03'
//var options = {
//  url: url,
//  auth: {
//    user: yosi,
//    password: password
//  }
//}
const s4options = {
  url: url,
  auth: {
    user: s4user,
    password: s4pwd
  }
}

const epoptions = {
  url: url,
  timeout: 20000,
  auth: {
    user: epuser,
    password: eppwd
  }
}

console.log('Send GET w/ options:', JSON.stringify(epoptions));

request(epoptions, function (err, res, body) {
    if (err) {
        if (err.code === 'ETIMEDOUT' || err.code === 'ESOCKETTIMEDOUT') {
            console.dir('timeout error');
        }
        else {
        console.dir(err)
        }
        return
    }
    else {
        console.dir('headers', res.headers)
        console.dir('status code', res.statusCode)
        console.dir('response body', body)
    }
});




        1.20.11.3.2 Design
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Mass+content+support

There are two important size limits:
incoming to transport.  Transport shall limit total response body size to 25MB. 
It can also be considered as a DOS protection.
The max body payload size should be enforced by transport in two phases.
First, fail the transport and communicate the reason to the admin. Note, that we will allow the admin to set up number of entities per site as a destination property. but only values in range (50,200) will be allowed.
Second phase transport would try to dynamically reduce the chunk size by requesting 100 entities first. If still max size exceeded try to reduce to 50 entities. If still max size is exceeded fail the transport. The algorithm will increase chunk size if possible.
Outgoing from transport. To reduce the outgoing memory footprint we suggest the following: transport will start deleting the payload after it is converted to relations.
 transport will start deleting the payload after it is converted to relations.
compress the relations by removing the context sub property.
limit # of relations to a sensible number.
We suggest to limit to N=3k relations per entity. The rational is. payload is an ID strings array. lets assume an avg ID len of 10. This translated to 20bytes. so 1k payload would add 20k for this entity but it's not all. The conversion to relations adds more text (see reference below)
The above conversion adds. "entityType":{} and the type (catalog/role/group/bussinessapp - avg length ~6). so 22 chars length.  so an extra 44 bytes per relation. so we get N*44 bytes per entity.
.Each chunk contains max of 200 entities. At worst case payload size is  (N*44*200) which is 8800N bytes, N=3k so we get 8.8k*3k = 26.4MB - which is the max size of chunk. Note that these calculations ignore translations and the rest of the properties because for now they are significantly smaller and are not multiplied by # of relations.
The max payload length limitation will be added to the validation service, advertised to customers and enforced by transport.

        1.20.11.3.3 Tests
manual tests:
a. repro issue
b. test fixes. 

test scope:
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Mass+content+support+Test+Scope


        1.20.11.3.4 Tasks

Assuming enforce limits option is selected.
            1.20.11.3.4.1 Transport 

finalize limits - 1PD [Done]

                1.20.11.3.4.1.1 Enforce max entity size limit
                - 6 PDs
Axios limits PoC.  <url:/Users/i500695/work/KB/nodejsKB#tn=__axiosSet_max_response_size__>
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/347
use axios maxContentLength to limit the response size
E2E test of EP mass content. still takes up too much memory and causes a crash.

                1.20.11.3.4.1.2 Enforce max payload length. Fail transport on exceeding length. 
                - 3PDS
update report with new size/payload length errors - 2 PDs
add ConnectivityMaxSizeLimitExceededErrorCode to ReportErrorCode 
New error ChunkEntitiesExceededMaxSize 

                    1.20.11.3.4.1.2.1 axios maxContentLength limit test on example role
use role, <url:/Users/i500695/work/SAP/git/portal-cf-transport-service/test/unit/cdm/resources/entities.json#tn=/UI2/SAP_KPIFRW5_TCR_S>
example: <url:/Users/i500695/work/code/nodejs/iterations/iterKeys.js>

pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/347

                    1.20.11.3.4.1.2.2 review preparation 
Use Asaf's mock provider. Add content exceeding limit.
<url:#r=__Asaf_destination__mock_provider__>
use file,/Users/i500695/work/SAP/git/portal-cf-transport-service/test/unit/transport/resources/entities_max_payload_length_exceeded.json 

Destination config (SaaS cockpit: https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/52fe6583-1cff-4ab1-93d7-e5c0055b0005/subaccount/2c554b97-d886-4f98-9342-60c95b6cd5fb/destinations )
name: yosi_mock_provider
type: http
description: A mock provider set for mass content exceeding size limit
url: https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/devutils/static/entities_max_payload_length_exceeded.json 
proxy-type: internet
authentication: NoAuthentication


                    1.20.11.3.4.1.2.3 report error strings
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-provider-manager/blob/master/providerManager/webapp/resources/i18n.properties#L191

                1.20.11.3.4.1.3 Take # entities from destination property.
                If it exists it take priority, allowed range  (50,200) - 3PDs
Transport will check for a custom destination property ‘provider.maxpagesize’ if it is set and is between 50 and 200 then it will be used as the max page size for the transport.



                1.20.11.3.4.1.4 Delete payload 
                - 3 PDs

                1.20.11.3.4.1.5 Adapt relations resolvers
                don't sent context to store client relations generation, verify cherry-pick and sections handled correctly. -5 PDs  
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/354

                1.20.11.3.4.1.6
            1.20.11.3.4.2 CDM-store Client

Make context object in relations optional - 3PDs
also remove payload
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/138/files
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/137

            1.20.11.3.4.3 CDM-store 
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/574

                1.20.11.3.4.3.1 Adapt to new relations structure (no context) and no payload.
                3 PDs
Set max payload size - 1PD
Note, set:
server.tomcat.max-http-form-post-size=10MB, // this is a request limit. only when content is FORM
server.tomcat.max-swallow-size=10MB // maxSwallowSize represents the size limit which can be uploaded or sent from within Tomcat from your application server to outside(outgoing request).


re. relations context.
a. src/main/java/com/sap/portal/cdm/store/service/impl/RelationService.java

Update the target.context is no longer required unless it points to a different
context. So if no target.context don't update:
    private void appendTempContextIdSuffixToRelationContextId(JsonNode relationEntity, String tempContextSuffix) {
        try {
            JsonNode contextJsonNode = relationEntity.get("target").get("context");
            ((ObjectNode) contextJsonNode).put("id", contextJsonNode.get("id").asText() + tempContextSuffix);
        } catch (RuntimeException e) {
            logger.debug("couldn't get context field of given relations json. will set source context.");
        }
    }

called by TransportAgent::mapStringEntitiesToIEntities()->RelationService::getRelationsFromContexts()

b. What about rel CTOR?
src/main/java/com/sap/portal/cdm/store/model/relation/CdmRelation.java
        // build target->context
        JsonNode targetEntityContext = mapper.createObjectNode();
        ((ObjectNode) targetEntityContext).put("id", contextId);
        ((ObjectNode) targetEntityContext).put("type", contextType);

keep as is?- IMO, yes

c. transport import related flow.
src/main/java/com/sap/portal/cdm/store/service/impl/TransportAgent.java
    private List<IEntity> mapStringEntitiesToIEntities(List<JsonNode> entitiesJson, Context context) {
        logger.debug("mapStringEntitiesToIEntities()");
        return entitiesJson.stream().map(entityJson -> {
            try {
                List<IRelation> relations = relationService.getRelationsFromContexts(context, entityJson.toString(), TEMP_CONTEXT_SUFFIX);
                return CdmJsonEntityBuilder.create(context, this.getCdmEntity(entityJson).toString(), translationService)
                        .createdBy(CurrentTenantHolder.getCurrentTenantUsername())
                        .withRelations(relations)
                        .build();
            } catch (IOException e) {
                logger.error("mapStringEntitiesToIEntities() error parsing cdm entity - " + e.getMessage() + " error = {}", e);
                throw new RuntimeException("error parsing cdm entity - " + e.getMessage(), e);
            }
        }).collect(Collectors.toList());
    }

looks like the target.context in relations is not actually used in CTOR. verify w/ Gil/Jawad
d.

            1.20.11.3.4.4 General
Sanity E2E. 3 PDs

32PDs total

            1.20.11.3.4.5 Validation Service
Validate payload length and overall entity size - 6 IDs

            1.20.11.3.4.6 Schema
Compress relations as suggested - 6 PDs
This will have ripple effect to all the services that rely on relations.

            1.20.11.3.4.7
        1.20.11.3.5 Code
        1.20.11.3.6 Additional

            1.20.11.3.6.1 NodeJs increase heap size

node --max-old-space-size=8192 server.js

So, 1st check system memory.
vcap@a96f8a69-abdb-4142-7d05-5b64:~$ free -m
              total        used        free      shared  buff/cache   available
Mem:         126115       39786        1141        3042       85187       83677
Swap:          8191         296        7895

In this case 1GB so can set to 512 (1/2 GB).  More than this will risk OS instability. BTW, this is the default value.

See, https://stackoverflow.com/questions/48387040/node-js-recommended-max-old-space-size/48392705#48392705

These options are now documented officially by node. For a 2GB machine, you should probably use:
NODE_OPTIONS=--max-old-space-size=1536
To determine the amount to use: You can see available memory on a Linux machine using free -m. Note that you can use the free and the buffers/cache memory combined, as buffers/cache can be thrown away (these buffers and cache are a nice way to use otherwise unused memory).
Note the official documentation formax-old-space-size also mentions:
On a machine with 2GB of memory, consider setting this to 1536 (1.5GB)
Hence the value above. Consider that the amount of memory needed for the base OS doesn't change much, so you could happily do 3.5 on a 4GB machine etc.


            1.20.11.3.6.2 Java increase memory size
flag is Xmx , default unit is MB.
Store allocates 398000K - 400MB , it can safetly allocate more. probably 150MB. 

$ cf ssh portal-cf-cdm-store-service
ps vcap@6b4c0d0e-a60a-48ee-7148-c7f4:~$ ps -aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.0   1120     4 ?        Ss   09:34   0:00 /tmp/garden-init
vcap          12  0.2  0.2 3304240 269552 ?      Ssl  09:34   0:24 META-INF/.sap_java_buildpack/sapjvm/bin/java -Xmx398000K -Xss1M -XX:ReservedCodeCacheSize=240M 
            1.20.11.3.6.3

        1.20.11.3.7
            1.20.11.4 

        1.20.12 2020 t12

            1.20.12.1 Transport - disk quota exceeded bug 
browserify packaged take up huge amount of space. causing disk quota error. 

also, the client lib transport-min.js is built by "accident" (via the test command). If you cf push after npm i -only=prod the uglify step would not happen (it's not part of build/postinstall).
                1.20.12.1.1 analysis
https://sapjira.wdf.sap.corp/browse/DWPBUGS-633

- rescale to 1GB.
$ cf app portal-cf-transport-service
Showing health and status for app portal-cf-transport-service in org launchpad / space i500695p as yosi.izaq@sap.com...

name:              portal-cf-transport-service
requested state:   started
routes:            portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/transport_service
last uploaded:     Thu 10 Dec 10:18:53 IST 2020
stack:             cflinuxfs3
buildpacks:        
	name                                                           version   detect output   buildpack name
	https://github.com/cloudfoundry/nodejs-buildpack.git#v1.7.33   1.7.33    nodejs          nodejs

type:           web
sidecars:       
instances:      1/1
memory usage:   1024M
     state     since                  cpu    memory         disk         details
#0   running   2020-12-10T08:19:31Z   1.2%   199.3M of 1G   1.2G of 4G   
cf scale portal-cf-transport-service -k 1G
- check:
a. prod
reduce time to 17 min. was 34.
real	17m28.032s
user	0m23.726s
sys	0m17.318s

The whole command
$ grep pushde package.json 
        "pushdev": "rimraf node_modules && npm i --only=prod && cf push -f manifest-dev.yml && npm i",

$ time npm run pushdev
real	21m17.773s
user	1m51.613s
sys	1m21.364s

b. prep rel


- analysis
https://docs.cloudfoundry.org/devguide/deploy-apps/troubleshoot-app-health.html#time
"
Make sure you are pushing only needed files. By default, cf push will push all the contents of the current working directory. Make sure you are pushing only the directory for your app. If your app is too large, or if it has many small files, Cloud Foundry may time out during the upload. To reduce the number of files you are pushing, ensure that you push only the directory for your app, and remove unneeded files or use the .cfignore file to specify excluded files.
Set the CF_STAGING_TIMEOUT and CF_STARTUP_TIMEOUT environment variables. By default your app has 15 minutes to stage and 5 minutes to start. You can increase these times by setting CF_STAGING_TIMEOUT and CF_STARTUP_TIMEOUT. Type cf push -h at the command line for more information.
If your app contains a large number of files, try pushing the app repeatedly. Each push uploads a few more files. Eventually, all files have uploaded and the push succeeds. This is less likely to work if your app has many small files.

Make sure your app is less than 1 GB. By default, Cloud Foundry deploys all the contents of the current working directory.
"

| - transport takes 833MB
| 1.3M	src
| 4.5M	target
| 5.1M	dist
|  43M	test
| 762M	node_modules
| 817M	total

big node_modules packages
 10M	swagger-ui-dist
 13M	prettier
 17M	rxjs
 24M	typeorm
 25M	@babel
 31M	@nestjs
 39M	feature-flags-client
 39M	portal-cf-shared-lib
 44M	cdm-store-client
 53M	@angular-devkit
 55M	typescript
258M	puppeteer
762M	total

dependency tree
$ npm list
├─┬ grunt-contrib-qunit@3.1.0
│ └─┬ puppeteer@1.20.0

part of dev dependencies
used for grunt-browserify task
    grunt.registerTask("browser-build", ["browserify", "uglify"]);

client side use the lib, e.g. https://github.wdf.sap.corp/Portal-CF/portal-cf-static-site-directory/blob/43a40b25bbdbf3e6b28fe409fa60d352b8292389/webapp/controller/SiteDirectory.controller.js#L75


push exceeds quota:
   2020-12-14T16:20:33.84+0200 [CELL/0] ERR tar: ./app/node_modules/puppeteer/.local-chromium/linux-686378/chrome-linux/chrome_100_percent.pak: Cannot open: Disk quota exceeded
takes 30+ minutes

rm -rf node_modules && npm i -only=prod &&  cf push -f manifest-dev.yml  

                1.20.12.1.2 possible solutions
a. seperate client code as resource/lib
just make the minified transport-zip accessible as resource 

b. talk 2 Jawad 

                1.20.12.1.3 OR
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/372

                1.20.12.1.4
            1.20.12.2 redis-cache delete keys by pattern issue

                1.20.12.2.1 Shared-lib redis fix


https://wiki.wdf.sap.corp/wiki/display/CPPortals/Connect+to+redis+hyperscaler+instance

https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFUNC%5D%5BSRE%5D%5BCONSISTENCY%5D+redis+cache+failed+to+delete+record+during+saveSite
Hyperscaler instances Cluster mode is saving each key in redis according to a hash function.
Transactions in Redis only occur within the same hash slot, which ensures the highest throughput. Since there is no inter-node/shard communication is needed, many failures scenarios are eliminated.
When trying to delete keys which were saved on different slots (with pattern), the following error occurs:
CROSSSLOT Keys in request don't hash to the same slot\n.
note. we encountered similar error: All keys in the pipeline should belong to the same slot 


Possible solutions:
a.  Using Hash tags:
In open source Redis, curly braces ({ and }) are signifiers of a hash tag and the string between these two characters is put through the CRC16 hashing function.
Pros:
Enforce keys to be in the same slot in the cluster.
Fairly easy to implement adding {}.
Cons:
If not done correctly we will have unbalanced cluster, or worse, one full node and many empty nodes.
Need to find all places in code and determine the correct key to add to cache.

b.  Using scan command:
Use scan command to get all keys, and delete them one by one - It will not work in redis cluster.
scanStream doesn't work with cluster mode.
The SCAN command does not take a key but a key pattern. Changes to a key immediately result in a different hash slot. That’s the reason why you have to scan over the whole cluster, except for one case, when using keys prefixed with a hash tag. 
We can use the scan command with the following logic: https://paluch.biz/blog/162-iterate-over-all-keys-in-a-redis-cluster.html
Pros:
Balanced nodes.
Cons:
Delete will be slower, can impact the performance of Redis, depends on the amount of keys.

c.  Use KEYS command by pattern to get all keys, and delete them one by one.
We can also get the slot of each key and after grouping together keys from the same slot, delete them as a group.
Pros:
Balanced nodes.
Cons:
Delete will be slower, can impact the performance of Redis, depends on the amount of keys.

d. chosen.
use getKeysByPattern() to get a list of the keys (
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/9e80d4c8112ddc6b68bfb2e91d84d2903278d98c/src/db/redis-client.js#L120)

Then delete one by one
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/9e80d4c8112ddc6b68bfb2e91d84d2903278d98c/src/db/redis-client.js#L145
  static async deleteKeysByPattern(loggerCtx, pattern) {
        let status = 0;
        try {
            let redisClient = await getClient(loggerCtx);
            if (redisClient) {
                let keys = await this.getKeysByPattern(loggerCtx, pattern);
                if (logger.isDebug()) {
                    logger.logRequestMessage(loggerCtx, 'debug', 'deleteKeysByPattern - keys to delete: %s', logger.printObject(keys));
                }
                if (keys.length > 0) {
                    for (let key of keys) {
                        status += await redisClient.del(key);
                    }
                }
            } else {
                if (logger.isError()) {
                    logger.logRequestMessage(loggerCtx, (CF_REDIS_DISABLE ? 'warn' : 'error'), 'getAllKeys - failed to get client');
                }
            }
        } catch (err) {
            if (logger.isError()) {
                logger.logRequestMessage(loggerCtx, 'error', 'deleteKeysByPattern - failed to delete keys by pattern- err %s', logger.printObject(err));
            }
        }
        return status;
    }


                1.20.12.2.2 portal-cf-transport-service fix, DWPBUGS-855

- error
 -- All keys in the pipeline should belong to the same slot 
 -- where:
 src/redis/services/cluster-redis.service.ts:deleteKeysByPattern()
 used by 
            await this.importStateService.cleanUpJobInfo(tenantId, jobId);
called from src/import/import.service.ts:finish()/cancel()

 -- repro
 redis plans
 $ cf s | grep redis
portal-redis                                      redis                                      v3.0-dev                     
portal-redis-cache                                redis-cache                                development                  portal-cf-transport-service
portal-redis-cache2                               redis-cache                                premium
portal-redis-cache3                               redis-cache                                standard                     portal-cf-transport-service     

 a. using standard plan
 test transport pass

 b. using premium plan
 change plan
 $ cf us portal-cf-transport-service portal-redis-cache3
Unbinding app portal-cf-transport-service from service portal-redis-cache3 in org launchpad / space i500695p as yosi.izaq@sap.com...
OK

[i500695@C02X632CJGH6:2021-02-01 15:36:39:~/work/SAP/git/portal-cf-transport-service:]2022$ cf bs portal-cf-transport-service portal-redis-cache2
Binding service portal-redis-cache2 to app portal-cf-transport-service in org launchpad / space i500695p as yosi.izaq@sap.com...
OK

[i500695@C02X632CJGH6:2021-02-01 15:37:09:~/work/SAP/git/portal-cf-transport-service:]2023$ cf rs portal-cf-transport-service

retry transport...

 -- possible fix
instead of deleting by pattern delete by specific keys
just Enumerate all possible states

-- PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/415

diffs:  <URL:/Users/i500695/work/SAP/PRs/transport/dwpbugs-855>
-
                1.20.12.2.3
            1.20.12.3

        1.20.13 2020 t13
Here is our commitment for T2013.
Team Capacity 96 PDs.
 
BLI Effort Estimation (in PDs) Sprint Comments

Support effort 10 PDs A+B Task: Support SMB 1 PD A/B Dependent on SMB
Task: Validation - Support IAS in approuter 1 PD A/B Dependent on appRouter
Task: Threat modeling Transport Service 1 PD A/B Sergey and Yan leading this
Task: Hyperscaler validation 1 PD A
[Federation] Support Transport service with oAuth client credentials 5 PDs A Leftovers from T2012B
E2E Puppeteer testing 30 PDs B Improve logging 13 PDs A

Dynamic logging 22 PDs B
Improve transport service browserify use - dev spaces 8 PDs A 
Refactor CDM Store error hierarchy and mechanism 15 PDs B Soft
[Eng]Start implementing provisioning service in NestJS 15 PDs B Soft
 
            1.20.13.1 dynamic logging
log levels: 'error', 'warn', 'info', 'verbose', 'debug', 'silly'
trace is silly
                1.20.13.1.1 Links
                nvestigate and add dynamic logging, first on our nest js implementations then on java (if possible)
Add UI to technical support that handles the log-level
 
transport service.
Provisioning service nest.
CDM Store.
Provisioning service.

            BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2014
            Design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2399274278
            Test scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Dynamic+Logging+Test+Scope
            wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Dynamic+Logging+wiki 

https://wiki.wdf.sap.corp/wiki/display/CPPortals/Technical+Support

    'error', 'warn', 'info', 'verbose', 'debug', 'silly'

                1.20.13.1.2 Design
                1.20.13.1.3 Tests
                    1.20.13.1.3.1 on hadar's space
API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.91.0
user:           yosi.izaq@sap.com
org:            launchpad
space:          i055502p


                        1.20.13.1.3.1.1 generate client token, tags: generate client technical token


- get the required IDs 
cf env portal-cf-provisioning-service | grep client 
sb-portal-cf-service-launchpadi055502p!b14400
$ cf env portal-cf-transport-service | grep launchpadInstanceId
    "launchpadInstanceId": "f60bccf9-a011-48c0-b077-2226b8a5450b",
$ cf env portal-cf-transport-service | grep tenantid
    "tenantid": "65e227fa-3e4d-42e2-84f7-d8e7fb13166e",

- generate technical token
current (start at 2023) way:
$ portal generate-client-token -s portal-xsuaa-broker -c '{"tenantId": "c7076a1c-fa1f-4274-a64b-9a6f15676027","instanceId": "6c72da9c-f0b0-4c9d-b029-7f9ff604e016","userName":"techUser","isProvider":"false", "clientid":"sb-portal-cf-service-lts!b15547", "userId": "yosi.izaq@sap.com","loggingLevel": "error"}'


pre 2022 way:
 yosi:
 portal generate-client-token -a portal-cf-transport-service -c '{"tenantId": "65e227fa-3e4d-42e2-84f7-d8e7fb13166e","instanceId": "f60bccf9-a011-48c0-b077-2226b8a5450b","userName":"techUser","isProvider":"false", "clientid":"sb-portal-cf-service-launchpadi055502p!b14400", "userId": "yosi.izaq@sap.com","loggingLevel": "error"}'

hadar launchpad token:  
portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "65e227fa-3e4d-42e2-84f7-d8e7fb13166e","instanceId": "f60bccf9-a011-48c0-b077-2226b8a5450b","userName":"techUser","isProvider":"false", "clientid":"sb-portal-cf-service-launchpadi055502p!b14400", "userId": "hadar.kobi@sap.com","loggingLevel": "silly"}'

client token (consumer saas), b529ed83-48f6-4b52-9487-6366e80d6357
portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "b529ed83-48f6-4b52-9487-6366e80d6357","instanceId": "f60bccf9-a011-48c0-b077-2226b8a5450b","userName":"techUser","isProvider":"false", "clientid":"sb-portal-cf-service-launchpadi055502p!b14400", "userId": "hadar.kobi@sap.com","loggingLevel": "silly"}'

portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId":,"instanceId":,"userName":"techUser","isProvider":"false", "clientid":, "userId":,"loggingLevel":}'

- postman collection
$ ls Provisioning.postman_collection.json 
Provisioning.postman_collection.json

Get:
curl --location --request GET 'https://portal-service-launchpadi055502p.cfapps.sap.hana.ondemand.com/transport_service/technical/getLoggingLevelForMicroService' \
--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vbGF1bmNocGFkLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoiZGVmYXVsdC1qd3Qta2V5LS0xNDI1ODUzMjE4IiwidHlwIjoiSldUIn0.eyJqdGkiOiJjMDhmYTc3NzdiNTA0YTliOTAzODhlMDUzMmU3MzNjNyIsImF6X2F0dHIiOnsidGVuYW50SWQiOiI2NWUyMjdmYS0zZTRkLTQyZTItODRmNy1kOGU3ZmIxMzE2NmUiLCJpbnN0YW5jZUlkIjoiZjYwYmNjZjktYTAxMS00OGMwLWIwNzctMjIyNmI4YTU0NTBiIiwidXNlck5hbWUiOiJ0ZWNoVXNlciIsImlzUHJvdmlkZXIiOiJmYWxzZSIsImNsaWVudGlkIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTA1NTUwMnAhYjE0NDAwIiwidXNlcklkIjoiaGFkYXIua29iaUBzYXAuY29tIiwibG9nZ2luZ0xldmVsIjoic2lsbHkifSwiZXh0X2F0dHIiOnsiZW5oYW5jZXIiOiJYU1VBQSIsInN1YmFjY291bnRpZCI6IjY1ZTIyN2ZhLTNlNGQtNDJlMi04NGY3LWQ4ZTdmYjEzMTY2ZSIsInpkbiI6ImxhdW5jaHBhZCJ9LCJzdWIiOiJzYi1wb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpMDU1NTAycCFiMTQ0MDAiLCJhdXRob3JpdGllcyI6WyJ1YWEucmVzb3VyY2UiLCJwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpMDU1NTAycCFiMTQ0MDAuQ2FsbGJhY2siXSwic2NvcGUiOlsidWFhLnJlc291cmNlIiwicG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTA1NTUwMnAhYjE0NDAwLkNhbGxiYWNrIl0sImNsaWVudF9pZCI6InNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGkwNTU1MDJwIWIxNDQwMCIsImNpZCI6InNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGkwNTU1MDJwIWIxNDQwMCIsImF6cCI6InNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGkwNTU1MDJwIWIxNDQwMCIsImdyYW50X3R5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJyZXZfc2lnIjoiYWM5YmUyM2UiLCJpYXQiOjE2MTE4MjE4OTgsImV4cCI6MTYxMTg2NTA5OCwiaXNzIjoiaHR0cHM6Ly9sYXVuY2hwYWQuYXV0aGVudGljYXRpb24uc2FwLmhhbmEub25kZW1hbmQuY29tL29hdXRoL3Rva2VuIiwiemlkIjoiNjVlMjI3ZmEtM2U0ZC00MmUyLTg0ZjctZDhlN2ZiMTMxNjZlIiwiYXVkIjpbInVhYSIsInBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGkwNTU1MDJwIWIxNDQwMCIsInNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGkwNTU1MDJwIWIxNDQwMCJdfQ.xYsSOfM7nnzCmxOkIoUhl6HH5VRiazzBimCCT_qefCdFTykIn9Kg_Sqg8pibRE-0luUAWWsrZ9zHf2_dceDcsxhwdA-l5qdx7Ne73er7z9DWSWtdfcGDWHqnELdHkjdUhT_9RciqwKiptCJxsda24sHFKJsNpVCRKaJLfcBun4ZP43yigyeyghedRQ61HOXE10gVA_IuJ_bsgz4kGQLJJQugXvqNHotinpF5co3CIsQUv3bqnhNaUzeXmA1eR3wJCgPdClFRPNtS66sq09hOknZwQ_mDac_WSut8BIF9s5DBJn842WQAfhfk-8StQAcWGxFdRbseUld_PjHkdD8ESQ' | jq '.'


Set:
curl --location --request POST 'https://portal-service-launchpadi055502p.cfapps.sap.hana.ondemand.com/provisioning_service/technical/setLoggingLevelForMicroService' \
--header 'Authorization: Bearer <token>' \
--header 'Content-Type: text/plain' \
--data-raw '{
    "userId": "hadar.kobi@sap.com",
    "tenantId": "",
    "instanceId": "",
    "loggingLevel": "debug"
}'

-

                    1.20.13.1.3.2

                1.20.13.1.4 Tasks

                    1.20.13.1.4.1 research

                        1.20.13.1.4.1.1 related PRs


https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/src/routes/technical-route.js#L121-L197
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-resources/blob/master/src/routes/technicalRoutes.js#L100-L178

                        1.20.13.1.4.1.2 Node impl start point
  // Set logging level for a specified request
    router.post('/setLoggingLevelForSpecificConfig', (req, res) => {
        let loggerCtx = logger.getLoggerCtx(req);
        let tenantIds, instanceIds, userIds, loggingLevel, isSpaceTechnicalUser;

        isSpaceTechnicalUser = technicalToken.isTechnicalUser(loggerCtx, req);
        if (isSpaceTechnicalUser && typeof req?.authInfo?.getAdditionalAuthAttribute === 'function') {

            logger.clearLoggingLevelMaps(loggerCtx);

            tenantIds = req.authInfo.getAdditionalAuthAttribute('tenantId');
            instanceIds = req.authInfo.getAdditionalAuthAttribute('instanceId');
            userIds = req.authInfo.getAdditionalAuthAttribute('userId');
            loggingLevel = req.authInfo.getAdditionalAuthAttribute('loggingLevel');

            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForSpecificConfig - loggingLevel %s, instance index %s, instance guid %s, tenantId %s, instanceId %s, userId %s ', loggingLevel, CF_INSTANCE_INDEX, CF_INSTANCE_GUID, logger.printObject(tenantIds), logger.printObject(instanceIds), logger.printObject(userIds));
            }

            if (userIds) {
                userIds = userIds.split(",");
            }
            if (instanceIds) {
                instanceIds = instanceIds.split(",");
            }
            if (tenantIds) {
                tenantIds = tenantIds.split(",");
            }

            if (userIds) {
                for (let userId of userIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.USER_ID, userId, loggingLevel);
                }
            }
            if (instanceIds) {
                for (let instanceId of instanceIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.INSTANCE_ID, instanceId, loggingLevel);
                }
            }
            if (tenantIds) {
                for (let tenantId of tenantIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.TENANT_ID, tenantId, loggingLevel);
                }
            }

            res.status(200).send(http.STATUS_CODES[200]);
        } else {
            if (logger.isError()) {
                logger.logRequestMessage(loggerCtx, 'error', '/setLoggingLevelForSpecificConfig - not technical user or invalid token');
            }
            return res.status(403).send(http.STATUS_CODES[403]);
        }

    });

    // Set all micro service requests logging level
    router.post('/setLoggingLevelForMicroService', (req, res) => {
        let loggerCtx = logger.getLoggerCtx(req);
        let isSpaceTechnicalUser, loggingLevel;

        isSpaceTechnicalUser = technicalToken.isTechnicalUser(loggerCtx, req);
        if (isSpaceTechnicalUser && typeof req?.authInfo?.getAdditionalAuthAttribute === 'function') {
            loggingLevel = req.authInfo.getAdditionalAuthAttribute('loggingLevel');
            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForMicroService - LoggingLevel %s, instance index %s, instance guid %s', loggingLevel, CF_INSTANCE_INDEX, CF_INSTANCE_GUID);
            }

            logger.setLogLevel(loggingLevel);
            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForMicroService - logging level has been successfully changed to %s', loggingLevel);
            }

            res.status(200).send(http.STATUS_CODES[200]);
        } else {
            if (logger.isError()) {
                logger.logRequestMessage(loggerCtx, 'error', '/setLoggingLevelForMicroService - not technical user or invalid token');
            }
            return res.status(403).send(http.STATUS_CODES[403]);
        }
    });

  // Set logging level for a specified request
    router.post('/setLoggingLevelForSpecificConfig', (req, res) => {
        let loggerCtx = logger.getLoggerCtx(req);
        let tenantIds, instanceIds, userIds, loggingLevel, isSpaceTechnicalUser;

        isSpaceTechnicalUser = technicalToken.isTechnicalUser(loggerCtx, req);
        if (isSpaceTechnicalUser && typeof req?.authInfo?.getAdditionalAuthAttribute === 'function') {

            logger.clearLoggingLevelMaps(loggerCtx);

            tenantIds = req.authInfo.getAdditionalAuthAttribute('tenantId');
            instanceIds = req.authInfo.getAdditionalAuthAttribute('instanceId');
            userIds = req.authInfo.getAdditionalAuthAttribute('userId');
            loggingLevel = req.authInfo.getAdditionalAuthAttribute('loggingLevel');

            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForSpecificConfig - loggingLevel %s, instance index %s, instance guid %s, tenantId %s, instanceId %s, userId %s ', loggingLevel, CF_INSTANCE_INDEX, CF_INSTANCE_GUID, logger.printObject(tenantIds), logger.printObject(instanceIds), logger.printObject(userIds));
            }

            if (userIds) {
                userIds = userIds.split(",");
            }
            if (instanceIds) {
                instanceIds = instanceIds.split(",");
            }
            if (tenantIds) {
                tenantIds = tenantIds.split(",");
            }

            if (userIds) {
                for (let userId of userIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.USER_ID, userId, loggingLevel);
                }
            }
            if (instanceIds) {
                for (let instanceId of instanceIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.INSTANCE_ID, instanceId, loggingLevel);
                }
            }
            if (tenantIds) {
                for (let tenantId of tenantIds) {
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.TENANT_ID, tenantId, loggingLevel);
                }
            }

            res.status(200).send(http.STATUS_CODES[200]);
        } else {
            if (logger.isError()) {
                logger.logRequestMessage(loggerCtx, 'error', '/setLoggingLevelForSpecificConfig - not technical user or invalid token');
            }
            return res.status(403).send(http.STATUS_CODES[403]);
        }

    });

    // Set all micro service requests logging level
    router.post('/setLoggingLevelForMicroService', (req, res) => {
        let loggerCtx = logger.getLoggerCtx(req);
        let isSpaceTechnicalUser, loggingLevel;

        isSpaceTechnicalUser = technicalToken.isTechnicalUser(loggerCtx, req);
        if (isSpaceTechnicalUser && typeof req?.authInfo?.getAdditionalAuthAttribute === 'function') {
            loggingLevel = req.authInfo.getAdditionalAuthAttribute('loggingLevel');
            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForMicroService - LoggingLevel %s, instance index %s, instance guid %s', loggingLevel, CF_INSTANCE_INDEX, CF_INSTANCE_GUID);
            }

            logger.setLogLevel(loggingLevel);
            if (logger.isInfo()) {
                logger.logRequestMessage(loggerCtx, 'info', '/setLoggingLevelForMicroService - logging level has been successfully changed to %s', loggingLevel);
            }

            res.status(200).send(http.STATUS_CODES[200]);
        } else {
            if (logger.isError()) {
                logger.logRequestMessage(loggerCtx, 'error', '/setLoggingLevelForMicroService - not technical user or invalid token');
            }
            return res.status(403).send(http.STATUS_CODES[403]);
        }
    });

                        1.20.13.1.4.1.3 Transport equivalent

        let loggerCtx = logger.getLoggerCtx(req);
use CLS impl instead. e.g.  let logger: any = this.sessionManager.get('loggerCtx');

    technicalToken = sharedLib.technicalToken,
import {technicalToken} from 'portal-cf-shared-lib';


                        1.20.13.1.4.1.4 shared lib infra
src/logs/cf-logger.js
                            1.20.13.1.4.1.4.1 clearLoggingLevelMaps(loggerCtx) 
                            {
        Logger.tenantIdsLoggingLevelMap.clear();
        Logger.instanceIdsLoggingLevelMap.clear();
        Logger.userIdsLoggingLevelMap.clear();

        this.logRequestMessage(loggerCtx, 'silly', 'clearLoggingLevelMaps - maps were cleared - userIdsLoggingLevelMap %s, instanceIdsLoggingLevelMap %s, tenantIdsLoggingLevelMap %s', this.printObject(Logger.userIdsLoggingLevelMap), this.printObject(Logger.instanceIdsLoggingLevelMap), this.printObject(Logger.tenantIdsLoggingLevelMap));
    }

clear log maps

                            1.20.13.1.4.1.4.2 setKeyAndValueInMap(loggerCtx, type, key, value) 
                            {
        this.logRequestMessage(loggerCtx, 'silly', 'setKeyAndValueInMap - type %s, key %s, value %s', type, key, value);
        switch (type) {
            case MAPS_TYPES.TENANT_ID:
                Logger.tenantIdsLoggingLevelMap.set(key, value);
                this.logRequestMessage(loggerCtx, 'silly', 'setKeyAndValueInMap - key %s, value %s were set for map of type tenantId', key, value);
                return;
            case MAPS_TYPES.INSTANCE_ID:
                Logger.instanceIdsLoggingLevelMap.set(key, value);
                this.logRequestMessage(loggerCtx, 'silly', 'setKeyAndValueInMap - key %s, value %s were set for map of type instanceId', key, value);
                return;
            case MAPS_TYPES.USER_ID:
                Logger.userIdsLoggingLevelMap.set(key, value);
                this.logRequestMessage(loggerCtx, 'silly', 'setKeyAndValueInMap - key %s, value %s were set for map of type userId', key, value);
                return;
        }
    }

used for storing the log level by the endpoint. e.g. 
                    logger.setKeyAndValueInMap(loggerCtx, mapsTypes.TENANT_ID, tenantId, loggingLevel);

                            1.20.13.1.4.1.4.3 setLoggingLevelSpecificConfig(loggerCtx, instanceId, userId, tenantId) 
                            {
        this.logRequestMessage(loggerCtx, 'silly', 'setLoggingLevelForRequest - set logging level for instanceId %s, userId %s, tenantId %s, userIdsLoggingLevelMap %s, instanceIdsLoggingLevelMap %s, tenantIdsLoggingLevelMap %s', instanceId, userId, tenantId, this.printObject(Logger.userIdsLoggingLevelMap), this.printObject(Logger.instanceIdsLoggingLevelMap), this.printObject(Logger.tenantIdsLoggingLevelMap));

        if (Logger.instanceIdsLoggingLevelMap.size > 0 || Logger.userIdsLoggingLevelMap.size > 0 || Logger.tenantIdsLoggingLevelMap.size > 0) {
            if (Logger.userIdsLoggingLevelMap.has(userId)) {
                loggerCtx.setDynamicLoggingLevel(Logger.userIdsLoggingLevelMap.get(userId));
                this.logRequestMessage(loggerCtx, 'silly', 'setLoggingLevelForRequest - set logging level %s for userId %s', Logger.userIdsLoggingLevelMap.get(userId), userId);

            } else if (Logger.instanceIdsLoggingLevelMap.has(instanceId)) {
                loggerCtx.setDynamicLoggingLevel(Logger.instanceIdsLoggingLevelMap.get(instanceId));
                this.logRequestMessage(loggerCtx, 'silly', 'setLoggingLevelForRequest - set logging level %s for instanceId %s', Logger.instanceIdsLoggingLevelMap.get(instanceId), instanceId);

            } else if (Logger.tenantIdsLoggingLevelMap.has(tenantId)) {
                loggerCtx.setDynamicLoggingLevel(Logger.tenantIdsLoggingLevelMap.get(tenantId));
                this.logRequestMessage(loggerCtx, 'silly', 'setLoggingLevelForRequest - set logging level %s for tenantId %s', Logger.tenantIdsLoggingLevelMap.get(tenantId), tenantId);
            }
        }
    }

used by the middleware to enforce correct logging level for scope of request

                        1.20.13.1.4.1.5 setDynamicLoggingLevel
Defined in cf-nodejs-logging-support 
Transport also uses it for log
const log = require('cf-nodejs-logging-support');

                        1.20.13.1.4.1.6

                    1.20.13.1.4.2

Design

integration with technical-support
research current impl

Transport: dynamic logging infra
Transport: set log API
Transport: set log middleware
Transport UT: log API
Transport UT: log Infra
Transport dynamic logging E2E
Provisioning: dynamic logging infra
Provisioning: set log API
Provisioning: set log middleware
Provisioning UT: log API
Provisioning UT: log Infra
Provisioning dynamic logging E2E







                1.20.13.1.5 Code
transport PRs
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/375
<url:~/work/SAP/PRs/transport/dynamicLoggingInfra375>

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/382
<url:~/work/SAP/PRs/transport/dynamicLoggingInfra382>

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/383
<url:~/work/SAP/PRs/transport/dynamicLoggingInfra383>

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/390

Provisioning PRs
https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/94
<url:~/work/SAP/PRs/provisioning/dynamicLoggingInfra94>

https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/102


                    1.20.13.1.5.1 middleware
src/middlewares/session.middleware.ts

wired to app (src/app/app.module.ts) 
export class AppModule implements NestModule {
    configure(consumer: MiddlewareConsumer) {
        ...
        consumer.apply(SessionMiddleware)
            .forRoutes({
                path: '*', method: RequestMethod.ALL
            });
    }
}

                    1.20.13.1.5.2 Logger
    private setLoggingLevelSpecificConfig(loggerCtx: any, instanceId: string, userId: string, tenantId: string): void {
        
    }
                    
                    1.20.13.1.5.3 Technical token authentication
export class AuthenticationMiddleware implements NestMiddleware {

  private readonly CLIENT_CREDENTIALS: string = 'client_credentials';
  private readonly pathsToApplyClientCredentialsCheck: Map<string, RequestMethod[]>;

  constructor() {
    this.pathsToApplyClientCredentialsCheck = new Map();
    this.initializePathsForClientCredentials();
  }

  use(req: Request, res: Response, next: Function) {
    if(this.checkForClientCredentials(req.url, req.method)) {
      return next(
      // ToDo, replace req.authInfo.getGrantType() check w/ shared lib technicalToken.isTechnicalUser call
          !Environment.isCloud() || req.authInfo.getGrantType() === this.CLIENT_CREDENTIALS ? null : new UnauthorizedException('allowed grant_type = client_credentials')
      );
    }
    return next(
      !Environment.isCloud() || req.authInfo.checkLocalScope('SuperAdmin') ? null : new UnauthorizedException('Super admin check failed')
    );
  }

  private checkForClientCredentials(url: string, method: string): boolean {
    const methods: RequestMethod[] = this.pathsToApplyClientCredentialsCheck.get(url);
    return methods && methods?.includes(RequestMethod[method]);
  }

  private initializePathsForClientCredentials(): void {
      //ToDo, add setLoggingLevelSpecificConfig POST/GET paths
    this.pathsToApplyClientCredentialsCheck.set('/transport_service/transports/external/reports', [RequestMethod.DELETE]);
  }
}


                    1.20.13.1.5.4 Add TTL to dynamicLogData

                    1.20.13.1.5.5
                1.20.13.1.6 Additional


            1.20.13.2 browserify, disk quota exceeded EUXTEAMSAAR-2015
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2015
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/372

diff --git a/package.json b/package.json
+        "pushdev": "rimraf node_modules && npm i --only=prod && cf push -f manifest-dev.yml && npm i",
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/373
            1.20.13.3

        1.20.14 2020 t14

            1.20.14.1 Links



    1.21 2021

        1.21.1  T01 

            1.21.1.1  x509 Support Transport service with ClientCertificateAuthentication

Motivation:
One procurement product is working on become a content provider, they need to use DT destination which configured proxy type=Internet with ClientCertificateAuthentication. This is available from destination service already. See screenshot.
.https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/4e13a04147314e8e9e54321f25d93fdc.html
Related products:
Portal/Launchpad/WZ/WZHR
User Story:
As an admin, I would like to be able to configure my DT destination with ClientCertificateAuthentication (proxy type=internet), in order to be comply with security compliance

Technical Information
Sklarski, Tsafrir
Check this documentation pages:
server cert ATN: https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/e75d7f15b808428e87ae70f494da0b42.html
oath2 ATN: https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/4e1d742a3d45472d83b411e141729795.html

destination client certificate: https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/LATEST/en-US/4e13a04147314e8e9e54321f25d93fdc.html
"
Client Certificate Authentication

This is used for destinations that refer to a service on the Internet. The relevant property value is:

Authentication=ClientCertificateAuthentication
The following credentials need to be specified:

Property	Description
KeyStoreLocation
When used in local environment
When used in cloud environment
Path to the JKS file that contains the client certificate(s) for authentication against a remote server.

The relative path to the JKS file. The root path is the server's location on the file system.
The name of the JKS file.
KeyStorePassword	The password for the key storage. This property is mandatory in case KeyStoreLocation is used.
Note
You can upload KeyStore JKS files using the same command for uploading destination configuration property file. You only need to specify the JKS file instead of the destination configuration file.
"

Destination certificate configuration: https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/df1bb55a526942b9bee78fea2ebb3162.html
"
Context

You can upload, add and delete certificates for your connectivity destinations. Bear in mind that:

You can only use JKS, PFX and P12 files for destination key store, and JKS, CRT, CER, DER for destination trust store.
You can add certificates only for HTTPS destinations. Truststore can be used for all authentication types. Keystore is available only for ClientCertificateAuthentication and OAuth2SAMLBearerAssertion.
An uploaded certificate file should contain the entire certificate chain.
Procedure

Uploading Certificates

Choose the Certificates button.
Choose Upload Certificate.
Browse to the certificate file you need to upload.
The certificate file is added.

Note
You can upload a certificate during creation or editing of a destination, by clicking the Upload and Delete Certificates link.
Adding Certificates to Destinations

Create a new destination, or open an existing one for editing.
In the URL field, enter an HTTPS address.
You can use the default JDK truststore or select another one from the dropdown menu. If the menu is empty, you can upload a certificate on the fly. To omit this property, you can set TrustAll=true.
If you choose Authentication = ClientCertificateAuthentication, you need to also provide a keystore.
"

We will get  S/4 CE system with ClientCertificateAuthentication for validation 
Tsafrir lead this topic from architect.
 

Scope:
Transport service support alternative secured way for DT destination, OAuth2ClientCredentials proxy type=internet.
 

Acceptance Criteria:
Portal/Launchpad/WZ/WZHR
Implementation
Test scope + review 
Validation with S/4 HANA CE
Demo as part of the DoD:
Transport should work with DT destination configured as ClientCertificateAuthentication proxy type=internet.. 

                1.21.1.1.1 Links
                 BLI:  https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2067
                 Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation%5D+Support+Transport+service+with+ClientCertificateAuthentication
                 Test scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation%5D+Support+Transport+service+with+ClientCertificateAuthentication+Test+Scope
                1.21.1.1.2 Design
                1.21.1.1.3 Tests

                    1.21.1.1.3.1 create mock certificates
see guide: <url:/Users/i500695/work/KB/Network/sslKB#r=__Create_a_client_certificate__>
cd /Users/i500695/work/SAP/ssl/mock_ca

                    1.21.1.1.3.2 Create mock provider that accepts client certificate authentication
Example: <url:/Users/i500695/work/KB/nodejsKB#r=__nodejs_client_certificate_authentication__>

                    1.21.1.1.3.3 Destination response
{
    "owner": {
        "SubaccountId": "e013e90d-245b-4500-acca-cf34f14ea287",
        "InstanceId": null
    },
    "destinationConfiguration": {
        "Name": "clientCertDestMock",
        "Type": "HTTP",
        "URL": "https://my301435-api.s4hana.ondemand.com/sap/bc/http/sap/aps_flp_content_exposure/entities",
        "Authentication": "ClientCertificateAuthentication",
        "ProxyType": "Internet",
        "KeyStorePassword": "Abcd1234",
        "TrustStoreLocation": "ca-cert.der",
        "KeyStoreLocation": "client-cert1.pfx",
        "TrustStorePassword": ""
    },
    "certificates": [
        {
            "Name": "client-cert1.pfx",
            "Content": "<client cert+pvk+client CA cert chain",
            "Type": "CERTIFICATE"
        },
        {
            "Name": "ca-cert.der",
            "Content": "<server CA chain>",
            "Type": "CERTIFICATE"
        }
    ]
}

                    1.21.1.1.3.4 Daniels certificates
[i500695@C02X632CJGH6:2021-02-17 17:34:46:~/work/SAP/BLIs/2021/x509SupportTransportservicewithClientCertificateAuthentication:]2021$ ls daniel.pfx 
daniel.pfx
                    1.21.1.1.3.5 iva.doncheva response
Hi Shirly,
 
If you want to consume a custom trust store for Neo destination, you could follow this documentation: https://help.sap.com/viewer/b865ed651e414196b39f8922db2122c7/Cloud/en-US/4da3b13c88ce4220bbd56a4361799668.html
 
Step 4)
 
For Cloud Foundry destination, at runtime you could use the Destination Service API to retrieve the destination (find destination):
 
https://api.sap.com/api/SAP_CP_CF_Connectivity_Destination/resource
 
The response should look like this:
 
{
    "owner": {
        "SubaccountId": "f444069d-6888-4f86-ae53-0f992c044a08",
        "InstanceId": null
    },
    "destinationConfiguration": {
        "Name": "custom_trust_store",
        "Type": "HTTP",
        "URL": "https://www.yahoo.com",
        "Authentication": "ClientCertificateAuthentication",
        "ProxyType": "Internet",
        "KeyStorePassword": "hello",
        "TrustStoreLocation": “my-trust-store.crt",
        "KeyStoreLocation": “my-key-store.jks",
        "TrustStorePassword": "test"
    },
    "certificates": [
        {
            "Name": “my-key-store.jks",
            "Content": “…”,
            "Type": "CERTIFICATE"
        },
        {
            "Name": “my-trust-store.crt",
            "Content": “…”,
            "Type": "CERTIFICATE"
        }
    ]
}
 
You could then consume the information form this response in your java code to configure your HTTP Client (similar to what is documented in Neo).
Destination Service only stores your configuration and you should then consume it at runtime.
 
Best regards,
Iva

                    1.21.1.1.3.6
                1.21.1.1.4 Tasks
                1.21.1.1.5 Code
                1.21.1.1.6 Additional




                1.21.1.2.6
            1.21.1.3

        1.21.2  T02 
            1.21.2.2 Prevent principal propogation, EUXTEAMSAAR-2108 [Federation] Support Transport service with Cloud connector configured to X509

                1.21.2.2.1 general
BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2108
Design:
Test-Scope:

Motivation:
We identify a situation when customer will configure the cloud connector to x509. if the destination configure as basic auth, this will be avoided and behave like *x509 . we get 401. If it was configured to basic auth in the could connector it works well.
Related products:
Portal/Launchpad/WZ/WZHR
User Story:
As an admin, I would like to be able to configure my DT destination with ClientCertificateAuthentication (proxy type=internet), in order to be comply with security compliance

Technical Information
Sklarski, Tsafrir
Transport service should know how to use the basic auth and not principal propagation even if teh cloud connector is configured to X509.
Principal propagation should not be supported in transport service as it will contradict the autmatic sync concept. Technical user. 
Guide to set the log level in SAP backends. Payload traces. To see why it happened.
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/67b0b94f09f2446598787eea0855e56b.html#loio67b0b94f09f2446598787eea0855e56b__header
Manol is the contact person from connectivity 
No oAuth2 relevancy
Scope:
POC & Design
Transport service should know how to use the basic auth and not principal propagation even if the cloud connector is configured to X509.
EE & Breakdown 
                1.21.2.2.2 tracking branch

            https://jtrack.wdf.sap.corp/browse/NGPBUG-140409
Basic authentication is not working in case SCC is configured with x509
Description:
When sending a request via connectivity service and SCC to an on premise backend the SCC is always trying to use the principal propagation even if no other principal is being sent.

 

The types of PP in SCC are described here: SCC -> Configure Access Control (HTTP)
https://help.sap.com/viewer/cca91383641e40ffbe03bdc78f00f681/Cloud/en-US/e7d4927dbb571014af7ef6ebd6cc3511.html


Note
There are two variants of a principal type X.509 certificate: X.509 Certificate (General Usage) and X.509 Certificate (Strict Usage). The latter was introduced with Cloud Connector 2.11. If the cloud side sends a principal, these variants behave identically. If no principal is sent, the injected HTTP headers indicate that the system certificate used for trust is not used for authentication.

The recommended variant is X.509 Certificate (Strict Usage) as this lets you use principal propagation and basic authentication over the same access control entry, regardless of the logon order settings in the target system.


                1.21.2.2.3 Saar Setup
Provider-Subaccount: 
$ cf t
API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.93.0
user:           yosi.izaq@sap.com
org:            launchpad
space:          i060224p

Consumer-Subaccount:https://scctest-dt-launchpad-launchpadi060224p.cfapps.sap.hana.ondemand.com/sites#Provider-Manage?sap-app-origin-hint=

Saar branch: scc1, hard coded url for request of proxy token. not scctest (subaccount) prefix
src/proxy/connectivity/connectivity.service.ts:
    private async generateProxyToken(reqInfo:any): Promise<string> {
        ...
        const response = await this.axiosInstance.get(`https://scctest.${this.connectivityCredentials.token_service_domain}/oauth/token`, {
...
}


                1.21.2.2.4 Tests

                1.21.2.2.5 Code
                PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/433

Transport 
connectivity.service

We want to prevent principal propagation

RT destination - principal propagation required

DT destination - principal propagation is forbidden


Cloud connecter - x509 set to none -> basic auth kicks in (no principal propagation)

When x509 is set to strict principal propagation kicks in. We want to avoid that.
This is controlled via header , SAP-Connectivity-Authentication, payload user token. 
Proxy-Authorization was ignored.


Proxy-Authorization - token 

To generate proxy token. Fields
Https://<subaccount-name><Connectivity.token_service_domain>/ouath/token/ ?grant_type=client_credentials

diffs: <url:/Users/I500695/work/SAP/PRs/transport/prevent_principal_propagation_x509>

            1.21.2.3

        1.21.3  T03 

            1.21.3.1   [Federation-Automatic sync] Transport service support new parameters(callback, token) - Design, tags: auto sync callback token
Motivation:
We would like to have the content coming from external provider automatically updated when the exposure report is invoked.
External providers such as EP and S/4 and others in the future, should be able to connect to cFLP and push an event to the cFLP whenever new content changes are available and can be retrieved with a delta request

User Story:
As an admin, I would like that content (in DT and RT) will be automatically updated once the Content Provider Admin is triggering an exposure of the content, without the need to manually synchronize\update the content in the Site Manager
Technical Information
Sklarski, Tsafrir
External providers such as EP and S/4 and others in the future, should be able to connect to cFLP and push an event to the cFLP whenever new content changes are available and can be retrieved with a delta request
Transport service support for new parameters(callback, token)  & Request delta link OData V4 mechanism and backward compatibility:
More details in Deep dive to the request to CDM Provider
Retry mechanism – decide to reuse existing? Or wait time and try again, minutes? 
The report should show all the changes that were made from the last initial/change: Meaning to merge all the changes in one report. Decide how to support this in the design and if this should be part of this implementation.  or later. not MVS - merged of reports. 
Idea: One report from the last sync action, semantic has this information. 
Do not show last empty report. 
High level Design https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2326673243
Contacts:  Tsafrir

Acceptance Criteria:
Design & Break down with EE
Transport service support for new parameters(callback, token)
Request delta link OData V4 mechanism
Backwards comp. 
Retry 
Avoid empty last report 
merge report - not in MVS
Design review 

                1.21.3.1.1   General


BLI:        https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-1888
design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation-Automatic+sync%5D+Transport+service+support
Test-Scope:

                1.21.3.1.2 high level design
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2326673243

                1.21.3.1.3

            1.21.3.2 [Mass Content] Support CDM store Full text search - Design 

Motivation
we want to support content providers systems connected to cFLP, Design time should be able to work with large amount of entities (role) coming from S4 or any other content provider.

User Story
As an admin I want to have an ability to handle mass entities in DT without any failures or crashes. With ability to search (server side) fill text search. 
General \ Technical Information
Design BLI
We want to allow full text search in CDM store
Admin will be able to search and get relevant results, search from the server side. based on the selected filter.
Any new entities that we save; we should save the text in away that the admin will be able to search on them. 

Import & Batch APIs 
Find a solution of how we will handle mass content operations (add;delete;update) 
example: Transport (/sync) mass content we send chunks to the CDM store client, till we commit. now we need to save/delete/update all the entities to CDM store. we will get timeout as it will take time to save the text for the full text search. 
What about when provider will be delete on the way during this operation 
Mass cherry picked use case; Import ; Batch APIs
take into account sync operation as well
return result should be return as relevancy sort 

Sarfati, Dana Define search return result sorted/order by and sort option on search results. with Kolner, Tamar & Mazuz Kalifa, Lev
Enhanced API (pagination) to support full text search  
Full text search should work in My content; Explore content and assignment panel; 
Implementation in different BLi https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2184
maximum support the following languages:
English (enUS),
German (deDE)
French (frFR)
Japanese (jaJP)
Portuguese (ptBR)
Russian (ruRU)
Simplified Chinese (zhCN)
Spanish (esES)

 There will be no admin tool for changing the search language, it will be according to browser language.

Supported Products
Portal/Launchpad/SWZ /SWZHR
Dependencies:
Client; Sematic; CDM store Client; OData API are dependent on this. 
Acceptance Criteria
Products: Portal/Launchpad/SWZ
Design Support full text search in my content; content explorer; assignment panel , return sorted by relevancy
Solution for how to handle transport (/sync) mass content we send chunks to the CDM store client, till we commit. now we need to save/delete/update all the entities to CDM store. we will get timeout as it will take time to save the text for the full text search. 
Product prefer to have it inside the action (Import; transport ;cherry picked)
Design review & EE 
Contacts
Jawad & Adam


                1.21.3.2.1 Links
         BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2181 
         Design:
         Test scope:

        |.2 Design
        |.3 Tests
        |.4 Tasks
        |.5 Code
        |.6 Additional

            1.21.3.3 [Federation-Automatic sync] Transport service support new parameters(callback, token) - Implementation

                1.21.3.3.1 Links
         BLI: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2130
         Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation-Automatic+sync%5D+Transport+service+support
         Test scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation-Automatic+sync%5D+Transport+service+support+Test+Scope

                1.21.3.3.2 Design

                1.21.3.3.3 Tests

                1.21.3.3.4 Tasks
                    1.21.3.3.4.1  Write Test Scope 
                    2 PDs. Make sure to add regression (non auto sync providers)
                    1.21.3.3.4.2  Prep setup/space 
                    1PD. Use Boris mock provider
                    1.21.3.3.4.3  DCM DTO update 
branch: yosi_16_03_21__12_17

-> Transport-controller start, swagger
    @ApiBody({
        description: 'The destination Id and a deltaLink if available and the context which the dcm will be imported to.',
        type: DcmPayloadDto,
    })

-> Transport-controller start, update DcmPayloadDto + Validation-Pipe
 --> Add callbackDto as sub property
export class CallbackDto {
    @ApiProperty()
    @IsNotEmpty({
        message: 'callback URL is missing.'
    })
    @IsString()
    readonly url: string;

    @ApiProperty()
    @IsNotEmpty({
        message: 'callback token is missing.'
    })
    @IsString()
    readonly token: string;
}

to 
export class DcmDto {
    @ApiProperty()
    @IsNotEmpty({
        message: 'source is missing.'
    })
    readonly source: SourceDto;

    @ApiProperty()
    @IsNotEmpty({
        message: 'context is missing.'
    })
    readonly context: ContextDto;

    @IsOptional()
    readonly destinationMappings: DestinationMappingsDto[]

    @ApiProperty()
    @IsOptional()
    @IsNotEmpty({
        message: 'callback is missing.'
    })
    readonly callback: CallbackDto;
}

    --> update Validation-Pipe + marshaling of dtos
add to DcmPayloadDtoValidationPipe::transform()
        if (dcmPayloadDto.dcm.callback) {
            await this.validate(plainToClass(CallbackDto, dcmPayloadDto.dcm.callback));
        }
        

    --> Fix integration tests
open issue
no need for custom DcmPayloadDtoValidationPipe() and manual plainToClass() calls.
see "good" example:
export-entities-payload.dto.ts
note use of 
    @ValidateNested()

and usage in controller, export.controller.ts
    @Post('/entities/start')
    @UsePipes(new ValidationPipe({ transform: true, whitelist: true, forbidNonWhitelisted: true }))
    @ApiResponse({status: 200, description: 'entities export completed successfully.'})
    @ApiResponse({status: 403, description: 'Forbidden.'})
    @ApiResponse({status: 401, description: 'Unauthorized.'})
    @ApiBody({
        description: 'Export payload should include the entities (id and type) and the relations data for controlling the export',
        type: ExportPayloadDto
    })
    startExportEntities( @Req() request, @Body() exportEntitiesPayloadDto: ExportEntitiesPayloadDto, @Res() res) {

    -->

-> Transport-controller start, update JobInfoDto


                    1.21.3.3.4.4  Job ID logic 

                    1.21.3.3.4.5  412 EP error handling 
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/470

                    1.21.3.3.4.6  Prefer header 
                    https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/447
                   https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/448 

                    1.21.3.3.4.7  Report changes 
                    3 PDs 
                    1.21.3.3.4.8  Delta link prefer + callback headers 

                   https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/455 
                   https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/452 

                   both united into: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/457
diff: <url:~/work/SAP/PRs/transport/auto_sync/deltaLinkLoop_PreferHeader>
delta link from location header: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/463

Preference-Applied add to report: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/462

fix regression: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/472/files

                    1.21.3.3.4.9  Delta link response logic 
                    2 PDs
                    1.21.3.3.4.10 Report Versions "DB" layer, including migration 
                    https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/446

                    1.21.3.3.4.11 Report Versions business logic 
                    2 PDs
                    1.21.3.3.4.12 Error handling 
                    2 PDs
                    1.21.3.3.4.13 Zero report overwrite or not 
                    1 PDs
                    1.21.3.3.4.14 Transport manage loop 
                    2 PDs, If we go this way, removes task Job ID logic!!. 
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/452/files
diffs: 
                    1.21.3.3.4.15 Partial stop loop 
                    1 PD
                    1.21.3.3.4.16 Improved retry 
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/451/files
diffs: <url:~/work/SAP/PRs/transport/improve_retry_strat_451>
tests: <url:#r=__retry_strat_transport_change__>
                    
                    1.21.3.3.4.17 Non user token 
                    1 PDs (mainly validation)
                    1.21.3.3.4.18 Feature Toggle 
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/450
<url:~/work/SAP/PRs/transport/autoSyncToggle_450>

                        1.21.3.3.4.18.1 reference in transport_service 
viztypes_filtering_enabled
Filter SMB content (viztypes that cherry pick SMB content)

- usage:
  src/transport/transport.job.ts
  startTransport()
            const vizTypesFlagVal = await this.featureFlagService.variation('viztypes_filtering_enabled');
  
- feature-flags service
import {variation, init} from 'feature-flags-client';
import {Inject, Injectable, OnModuleInit} from '@nestjs/common';
import {ILoggerFactory} from '../interfaces/logger-factory.interface';
import {Logger} from '../utils/logger';

@Injectable()
export class FeatureFlagService {
    private readonly logger: Logger;
    constructor(@Inject('ILoggerFactory') loggerFactory: ILoggerFactory) {
        this.logger = loggerFactory.getLogger(FeatureFlagService.name);

        init().catch((error) => {
            this.logger.debug('error', 'Error while initializing feature-flag-service: ' + error);
        });
    }

    async variation(featureFlagName: string): Promise<boolean> {
        let featureFlag = await variation(featureFlagName);
        return  featureFlag === 'true';
    }
}

- 
                        1.21.3.3.4.18.2 reference in semantic-service
[i500695@C02X632CJGH6:2021-03-25 12:06:15:~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]2002$ Ag auto_sync
test/unit/controllers/provider-controller.spec.js
2753:        it('should return an error upon deleteProviderToken rejection and auto_sync toggle is true', sinonTest(async function () {
2798:        it('should return an error upon deleteProviderToken rejection and no cherry-picks entities and auto_sync toggle is true', sinonTest(function () {

src/config/config.js
108:        AUTO_SYNC: 'auto_sync'

src/controllers/provider-controller.js
641:            if (variation(config.featureFlags.AUTO_SYNC) === 'true') {
651:            if (variation(config.featureFlags.AUTO_SYNC) === 'true') {
                        

                        1.21.3.3.4.18.3
                    1.21.3.3.4.19 Integration with semantic service 
                    3 PDs
                    1.21.3.3.4.20 Integration/Manual tests 
                    3 PDs
                    1.21.3.3.4.21 Auto tests
                    ??
                1.21.3.3.5 Code

                1.21.3.3.6 Additional

            1.21.3.4 placeholder
                1.21.3.4.1 Links
         BLI: ht
         Design: 
         Test scope:

                1.21.3.4.2 Design

                1.21.3.4.3 Tests

                1.21.3.4.4 Tasks

                1.21.3.4.5 Code

                1.21.3.4.6 Additional

        1.21.4  T04 
signoff BLI Effort Estimation (in PDs) Sprint Comments

Support effort 10 PDs A+B
Task: Support IAS for all scenarios 1 PDs A/B Handover of "Product Switcher" 5 PDs A/B
S4 CE E2E validation 5 PDs A/B
Postgres, hyperscaler version upg plan  12 ver. - execute tests as per Boaz plans (sanity for DB read & Write) 2 PDs A+B
[Mass Content] CDM store Support autoscale - preparation 12 PDs A Working with Nadav's team
[EU Regulation] Avoid printing to our logs, user name password or emails. [EU Regulation] Avoid printing to our logs, user name password or emails.  8 PDs A
[Quality] Custom domains - Production like landscape test systems 3 PDs A+B

[Performance] Replace requestAccessToken with requestCachedToken on our services 7 PDs A
Validation & Integration with other teams
[Federation-Automatic sync] Transport service support ETag - Design & Implementation  7 PDs A
 
CDM Store NestJS design 10 PDs B
 

[Federation-Automatic sync] Validation & Integration E2E - Transport service support destinations without technical user  5 PDs B
 

[Mass Content] Relations model (Get entities & site entities) - Support Pagination 16 PDs B [Soft]

            1.21.4.1  CDM Store NestJS design 10 PDs B
Motivation
make our services more scale and robust
we want to support content providers systems connected to cFLP, Design time should be able to work with large amount of entities (role) coming from S4 or any other content provider.
Activation is adding autoscale for activation in order to be able to support mass content for end users in RT
We want to be able to balance our load with auto scale, once we have tto much load on our instance we should create additional one  or more to handle the load and avoid us from crashing. 
User Story
As an admin I want to have an ability to handle mass entities in DT without any failures or crashes also for my End users in RT. 
General \ Technical Information
Backwards compliable 
This BLI is to do preparation for this  auto scale support:
Mass content creation for the load --> Could be taken from EP. Nestle test content. 
Define the threshold parameters for adding a new instance in case of load. 
Supported Products
Portal/Launchpad/SWZ /SWZHR
Cdm faker to prepare runtime site with mass content: (Ask Roman for content - it can be easier) - an application which can create content dynamically according to a provided configuration.
Activation service get site paging-requests simulator app.
Dependencies:
Acceptance Criteria
Products: Portal/Launchpad/SWZ
Mass content creation for the load --> Could be taken from EP. Nestle test content. 
build application that will load the CDM store with mass content 
Define the threshold parameters for adding a new instance in case of load. 
We do not have DB per service - risk
each service should have his own DB access  

                1.21.4.1.1 Links
                 BLI: 
                 Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/NestJS+CDM-Store+Service
                 Test scope:
                1.21.4.1.2 Design
                1.21.4.1.3 Tests
                1.21.4.1.4 Tasks
                1.21.4.1.5 Code
                1.21.4.1.6 Additional


            1.21.4.2 [Mass Content] CDM store Support autoscale - preparation 12 PDs A Working with Nadav's team, tags: cdm-store, autoscaler

                1.21.4.2.1 Links
                 BLI:  
                 Content creator: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2261
                 auto scaler policy: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2295
                 Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/CDM+store+Support+autoscale
- summary:
uses CF service application autoscaler: https://help.sap.com/docs/application-autoscaler/application-autoscaler/initial-setup
configuration guide: https://help.sap.com/docs/application-autoscaler/application-autoscaler/parameters-for-dynamic-scaling-policy

As part of the high level objectives to make CDM store service scalable, resilient and available (HA) we want to introduce autoscaler capability to CDM store.
The use cases that would require this are:
External content provider systems connected to cFLP, which may push huge amount of entities and/or huge entities into Design-time DB. 
Activation service scale-out.  Activation service can scale-out in case of load (for example when handling mass content for end users in RT). In such a case it will overwhelm CDM Store instances unless they scale-out as well.

Then this service consumes a policy to scale CDM store instances. It supports two types of policies: dynamic and scheduled.
Scheduled, as the name suggests, allows to define recurring schedules or specific date schedules for scaling.
For now, our use cases load spikes are not time/date bound and for this reason this type of policy is less appropriate.
The second policy is dynamic. It allows instances scaling based on memory or CPU usage, response time, throughput, or custom metrics.
This kind of policy is more adequate for CDM Store since it will allow us to scale-out when detecting load buildup but before actual crash.
The scaling rules can define, for example, that if the memory consumption either exceeds or falls below the set threshold, the application is respectively scaled up or down by an instance. If an array of scaling rules is defined, the Application Autoscaler runs periodic checks of the scaling policy to verify if any of the specified conditions matches. New instances are generated based on specified rules.

The policy takes the form of a json config file with key properties:
instance_min_count. The minimum number of application instances that are always running. 
instance_max_count. The maximum number of application instances that can be provisioned as part of application scaling.
scaling_rules. An array of rules. A rule comprises a group of key values set to automatically trigger the scaling activity.
metric_type. Supported
memoryused. in MB.
memoryutil. % of quota
cpu. CPU usage
throughput. reqs/sec
responsetime. in ms.
breach_duration_secs. The duration to analyze the collected metrics data points. The duration is considered from the current time to the past, for example: the last 600 seconds.
The service performs this analysis to check if the data points are consistently above or below the set threshold and makes the decision to scale. For a more accurate decision, set a larger duration, as in this case, more data points are analyzed.
In situations that cause a rapid increase of application load in short intervals, set a small duration. This enables the application to scale out before the maximum memory threshold is exceeded and prevents the application from crashing.
stat_window_secs, Frequency of measurements
cool_down_secs. The minimum duration between two successive scaling triggers. After the first scaling trigger, the second trigger occurs after the specified interval. This duration enables the application to be stable enough before it starts the next trigger. For production environments, a longer duration is recommended.

- Suggested policy
Dynamic Scaling Policy rules

- scale-up
memory utilisation 60%
TPS 10
CPU usage 70%
measurments frequency 1 min
breach duration 1 min
Min time before next scale cool down. 1 min
scale-down
memory utilisation 30%
TPS 10
CPU usage 35%
measurments frequency 10 min
breach duration 10 min
Min time before next scale. cool down. 10 min

policy: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/master/autoscaler/autoscaling-policy.json
{
    "instance_min_count": 2,
    "instance_max_count": 8,
    "scaling_rules": [
       {
            "metric_type": "memoryutil",
            "threshold": 60,
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">=",
            "adjustment": "+1"
        },
        {
            "metric_type": "memoryutil",
            "threshold": 30,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<",
            "adjustment": "-1"
        },
       {
            "metric_type": "throughput",
            "threshold": 10, // the throughput value in Requests/second
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">",
            "adjustment": "+1"
        },
        {
            "metric_type": "throughput",
            "threshold": 10,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<=",
            "adjustment": "-1"
        },
        {
          "metric_type": "cpu",
          "threshold": 70,
          "stat_window_secs": 60,
          "breach_duration_secs": 60,
          "cool_down_secs": 60,
          "operator": ">=",
          "adjustment": "+1"
        },
        {
          "metric_type": "cpu",
          "threshold": 35,
          "stat_window_secs": 600,
          "breach_duration_secs": 600,
          "cool_down_secs": 600,
          "operator": "<",
          "adjustment": "-1"
        }
        
    ]
}


- Autoscaler application Plan
manual
install app-autoscaler plugin

$ cf install-plugin -r CF-Community app-autoscaler-plugin
create service

cf create-service autoscaler lite portal-autoscaler
Creating service instance portal-autoscaler in org launchpad / space i500695p as yosi.izaq@sap.com...
OK

bind service
cf bs portal-cf-cdm-store-service portal-autoscaler

attach policy
cf attach-autoscaling-policy portal-cf-cdm-store-service cdm.store.service/src/main/resources/autoscaler/autoscaling-policy.json

restage
cf rs portal-cf-cdm-store-service

-   Add post deployment script to attach autoscaler policy

#!/usr/bin/python
import os
import utils.cf_helper as cf
import utils.general_helper as gen
from utils.log_helper import PortalLogger
 
# globals
logger = PortalLogger.get_instance()
LANDSCAPE_ENVIRONMENT = os.environ.get('LANDSCAPE_ENVIRONMENT')
ARTIFACT_FOLDER = os.environ.get('ARTIFACT_FOLDER')
AUTOSCALING_POLICY = f"{ARTIFACT_FOLDER}/autoscaler/autoscaling-policy.json"
 
class PostDeploy:
    """
        This class will execute all necessary steps after deployment script execution
        Prerequisites:
            Before calling this script make sure that all needed credentials are available in environment
            and CF login action was previously done.
    """
 
 
    @staticmethod
    def execute(app_name):
        PostDeploy.__apply_autoscaling_policy(app_name)
 
 
    @staticmethod
    def __apply_autoscaling_policy(app_name):
        if LANDSCAPE_ENVIRONMENT != "dev":
            logger.debug("---> PostDeploy: applying autoscaling policy file", AUTOSCALING_POLICY)
            # apply autoscaling policies
            gen.cmd_buffered(f"cf attach-autoscaling-policy {app_name} {AUTOSCALING_POLICY}")
            logger.debug("---> PostDeploy: applied autoscaling policy is:")
            gen.cmd_buffered(f"cf autoscaling-policy {app_name} >& stam")
            with open("stam", r) as filename:
                lines = filename.readlines()
                logger.debug(lines)
            gen.cmd_buffered("rm stam")



                 Test scope: 

                1.21.4.2.2 Design

                    1.21.4.2.2.1 documentation

                        1.21.4.2.2.1.1 Official documentation 

                            1.21.4.2.2.1.1.1 Procedure


                        https://help.sap.com/viewer/7472b7d13d5d4862b2b06a730a2df086/Cloud/en-US/f3e7fa907e9d4da89fc55602818bd6f4.html
check autoscaler availability
$ cf marketplace

create service
cf create-service autoscaler <service plan name> <instance name>
ex: cf create-service autoscaler standard myservice

bind to app
cf bind-service <application name> <instance name> -c <file name>.json
the json is the config file. as described in: https://help.sap.com/viewer/7472b7d13d5d4862b2b06a730a2df086/Cloud/en-US/79f443abe6b448ce9b606d10fd816f5c.html

check bound successfully
cf service <instance name>

                            1.21.4.2.2.1.1.2 autoscaler policy
                            Define a policy to scale your application instances either dynamically or based on schedules.

To initiate the scaling of an application, you need to define a policy. A policy is a JSON file containing an array of rules or a single rule for scaling. This JSON file is passed while binding the service with the application to be scaled. For more information, see Initial Setup.

You can choose between the following types of scaling policies:

Scale your application instances based on memory/CPU usage, reponse time, throughput, or custom metrics.

You can either define recurring schedules or specific date schedules for scaling. If you want to define multiple schedules, make sure that they don't overlap.
Caution
Overlapping schedules don't trigger the scaling.
In recurring schedules, the date is optional. However, you need to provide a date for a specific date schedule. If you set the parameters instance_min_count and instance_max_count within a schedule, they override the global values set for these parameters.


                                1.21.4.2.2.1.1.2.1 Dynamic Scaling Policy
->Scale your application instances based on memory or CPU usage, response time, throughput, or custom metrics.

Metric Types memory consumed and memory utilized

These scaling rules define that if the memory consumption either exceeds or falls below the set threshold, the application is respectively scaled up or down by an instance. If an array of scaling rules is defined, the Application Autoscaler runs periodic checks of the scaling policy to verify if any of the specified conditions matches. New instances are generated based on specified rules.

Example
A scaling policy comprises two rules:

Rule 1: If the memory exceeds 500 MB, a single instance of an application is created.

Rule 2: If the memory exceeds 800 MB, two application instances are created.

When defining an array of rules, its sequence must match the descending order of the threshold values, so that the higher value appears first in the sequence. In this example, rule 2 must be defined before rule 1 to ensure that the Application Autoscaler checks all conditions. 

-> Metric Type memory consumed
{
    "instance_min_count": 1, 
    "instance_max_count": 5, 
    "scaling_rules": [ 
        {
            "metric_type": "memoryused",
            "threshold": 90,
            "operator": ">=",
            "adjustment": "+1"
        },
 {
            "metric_type": "memoryused", 
            "threshold": 30, 
            "operator": "<", 
            "adjustment": "-1" 
        }
      
    ]
}
memory used is in MB

->Metric Type memory utilized, in % of quota
{
    "instance_min_count": 1, 
    "instance_max_count": 5, 
    "scaling_rules": [ 
       {
            "metric_type": "memoryutil",
            "threshold": 90,
            "operator": ">=",
            "adjustment": "+1"
        },
  {
            "metric_type": "memoryutil", 
            "threshold": 30, 
            "operator": "<", 
            "adjustment": "-1" 
        }
       
    ]
}

-> Metric Types throughput and responsetime
The following samples are simple scaling policies for the metric types throughput and responsetime. The scaling rule determines if the throughput or response time exceeds or falls below the set threshold.

    -->  Metric Type throughput
    {
    "instance_min_count": 1, 
    "instance_max_count": 5, 
    "scaling_rules": [ 
  
       {
            "metric_type": "throughput",
            "threshold": 100, // the throughput value in Requests/second
            "operator": ">",
            "adjustment": "+1"
        },
        {
            "metric_type": "throughput",
            "threshold": 100,
            "operator": "<=",
            "adjustment": "-1"
        }
	]
}

    -->  Metric Type responsetime
    {
    "instance_min_count": 1, 
    "instance_max_count": 5, 
    "scaling_rules": [ 
       {
            "metric_type": "responsetime",
            "threshold": 900, // the response time value in milliseconds
            "operator": ">",
            "adjustment": "+1"
        },
        {
            "metric_type": "responsetime",
            "threshold": 900,
            "operator": "<=",
            "adjustment": "-1"
        }
      ]
 }

    --> For advanced usage, you can provide optional values along with the mandatory ones. The following sample displays such a scaling policy:
{
    "instance_min_count": 1, 
    "instance_max_count": 5, 
    "scaling_rules": [ 
        {
            "metric_type": "memoryused",
            "breach_duration_secs": 600,
            "threshold": 90,
            "operator": ">=",
            "cool_down_secs": 300,
            "adjustment": "+1"
        },
 {
            "metric_type": "memoryused", 
            "breach_duration_secs": 600, 
            "threshold": 30, 
            "operator": "<", 
            "cool_down_secs": 300, 
            "adjustment": "-1" 
        }
       
    ]
}
    -->
-> Parameters for a Dynamic Scaling Policy
Parameter Description Mandatory Data Type Value Range Default Value Example
instance_min_count The minimum number of application instances that are always running.  Yes number minimum = 1; maximum = no upper limit none 1

instance_max_count The maximum number of application instances that can be provisioned as part of application scaling.  Yes number minimum = at least one more than instance_min_count; maximum = no upper limit none 5

scaling_rules A rule comprises a group of key values set to automatically trigger the scaling activity. You can have one or more rules. At least one rule out of a possible array size of two is validated.  Yes array none none none

metric_type The metric type can be memory usage in mebibytes (memoryused), memory utilization as a percentage of the memory quota (memoryutil), CPU as a percentage of virtual CPUs used (cpu), throughput in requests per second (throughput), or response time in milliseconds (responsetime).  Yes string none none One of the following options:
memoryused
memoryutil
cpu
throughput
responsetime

breach_duration_secs
The duration to analyze the collected metrics data points. The duration is considered from the current time to the past, for example: the last 600 seconds.
The service performs this analysis to check if the data points are consistently above or below the set threshold and makes the decision to scale. For a more accurate decision, set a larger duration, as in this case, more data points are analyzed.
In situations that cause a rapid increase of application load in short intervals, set a small duration. This enables the application to scale out before the maximum memory threshold is exceeded and prevents the application from crashing.
No	number minimum = 60 seconds; maximum = 3600 seconds 300 seconds 300 seconds
threshold The resources that can be considered for triggering the scaling activity are memory used in MB, memory utilized as percentage of memory assigned to the application, response time in milliseconds, or throughput in RPS. If any of the considered resource values is above or below the respective set values, the Application Autoscaler initiates the scaling activity.
Yes integer For memory consumed, minimum = 1; maximum = no upper limit.  For memory utilized, minimum = 1; maximum = 100
For throughput, minimum = 1; maximum = no upper limit.
For request per second, minimum = 1; maximum = no upper limit.
For cpu, minimum = 1; maximum = 100
none
30

From, https://github.com/cloudfoundry/app-autoscaler/issues/322#issuecomment-379032575
stat_window_secs is the time interval we aggregate metrics from application instances. Setting this value longer will smooth the metric values, it may reduce impact on potential noisy data points, but this may also cause insensitivity....
breach_duration_secs defines the time period that scaling will be triggered if all the data points during this time period always breach the scaling rule.
For example, if you set memory usage threshold to be 70%, breach_duration_secs = 120 means the scaling out will happen when memory usage >= 70% for 120 seconds.


operator The operator is used in combination with the threshold value to compare the current metric value. The expression is as follows: [MetricUsage value] [operator] [threshold].
Yes string none none 64 > 30

cool_down_secs The minimum duration between two successive scaling triggers. After the first scaling trigger, the second trigger occurs after the specified interval. This duration enables the application to be stable enough before it starts the next trigger. For production environments, a longer duration is recommended.
No number minimum = 60 seconds; maximum = 3600 seconds 300 seconds 300

adjustment The number of application instances to be scaled as part of the scaling activity. The format is + or - followed by the number of required instances.  Yes number none none +1 to scale up by an instance; -2 to scale down by two instances.

                                1.21.4.2.2.1.1.2.2 Recurring Schedules

-> The following example shows a schedule-based scaling policy:
{
 "instance_min_count": 1, 
 "instance_max_count": 5, 
   "schedules": {  
   "timezone":"Asia/Shanghai",
   "recurring_schedule":[  
      {  
         "start_time":"10:00",
         "end_time":"18:00",
         "days_of_week":[  
            1,
            2,
            3
         ],
         "instance_min_count":1,
         "instance_max_count":10,
         "initial_min_instance_count":5
      }      
     ]
   }
}
The policy in the example defines a recurring schedule, which is set for the Asia/Shanghai time zone. The schedule triggers application instances during the specified time frame on Sunday, Monday, and Tuesday. The days of the week are specified through the numbers 1 to 7 starting with 1 for Monday.

The policy defines the minimum and maximum number of application instances during the time frame as well as the number of application instances that should be available at the beginning of the recurring schedule.

For more information about the time zones for schedule-based policies, see Time Zones for a Schedule-Based Policy.
-> Schedule with Start Date and Day of the Month
"schedules": {  
   "timezone":"Asia/Shanghai",
   "recurring_schedule":[  
       {  
         "start_date":"2016-06-27",
         "end_date":"2016-07-23",
         "start_time":"11:00",
         "end_time":"19:30",
         "days_of_month":[  
            5,
            15,
            25
         ],
         "instance_min_count":3,
         "instance_max_count":10,
         "initial_min_instance_count":5
      }


-> Specific Date Schedule
{
    "instance_min_count": 1, 
    "instance_max_count": 5, 
 "schedules":{  
   "timezone":"Asia/Shanghai",
"specific_date":[
          {
             "start_date_time":"2015-06-02T10:00", 
             "end_date_time":"2015-06-15T13:59", 
             "instance_min_count":1,
             "instance_max_count":4,
             "initial_min_instance_count":2
          },
          {
             "start_date_time":"2015-01-04T20:00",
             "end_date_time":"2015-02-19T23:15",
             "instance_min_count":2,
             "instance_max_count":5,
             "initial_min_instance_count":3
          }
    ]
  }
 }

-> Advanced Usage

For advanced usage, you can provide optional values along with the mandatory ones. The following sample displays such a scaling policy:
{
 "instance_min_count": 1, 
 "instance_max_count": 5, 
   "schedules": {  
   "timezone":"Asia/Shanghai",
   "recurring_schedule":[  
      {  
         "start_time":"10:00",
         "end_time":"18:00",
         "days_of_week":[  
            1,
            2,
            3
         ],
         "instance_min_count":1,
         "instance_max_count":10,
         "initial_min_instance_count":5
      },
      {  
         "start_date":"2016-06-27",
         "end_date":"2016-07-23",
         "start_time":"11:00",
         "end_time":"19:30",
         "days_of_month":[  
            5,
            15,
            25
         ],
         "instance_min_count":3,
         "instance_max_count":10,
         "initial_min_instance_count":5
       }
     ]
   }
}
-> Full parameters list https://help.sap.com/viewer/7472b7d13d5d4862b2b06a730a2df086/Cloud/en-US/c8023eb0995e42a68697f4262218a032.html
Parameter Description Mandatory Data Type Value Range Default Value Example
schedules A schedule lets you configure scaling rules for specific days or on a recurring basis. Schedules guard against expected high surges or low activity periods.  Yes none none none none
timezone A valid time zone to run the schedule. For more information, see Time Zones for a Schedule-Based Policy.  Yes string none none Asia/Sanghai
recurring_schedule Triggers the scaling rule recursively during the specified intervals Yes none none none none
start_time Start time of a recurring schedule in 24-hr format (HH:MM).  Yes string minimum = 00:00; maximum = 23:59 none 10:00
end_time End time of a recurring schedule in 24-hr format (HH:MM).  Yes string minimum = 00:00; maximum = 23:59 none 21:00
start_date Start date of the schedule in YYYY-MM-DD format.  No string minimum = current date; maximum = no upper limit none 2020-06-27
end_date End date of the schedule in YYYY-MM-DD format.  No string minimum = set by start_date; maximum = no upper limit none 2020-07-23
days_of_week Triggers the scaling on weekdays ranging from 1 (Monday) to 7 (Sunday). The rule is executed during the weekdays specified within the array.  Yes array minimum = 1; maximum = 7 none [1,3,5]
days_of_month Triggers the scaling on days of the month ranging from 1 to 31. The rule is executed during the specified days of the month.  Yes array minimum = 1; maximum = 31 none [1,11,24,30]
instance_min_count Minimum number of instances during the recurrence period.  Yes number minimum = 1; maximum = no upper limit none 1
instance_max_count Maximum number of instances during the recurrence period.  Yes number minimum = set by instance_min_count; maximum = no upper limit none 5
initial_min_instance_count Minimum number of instances to scale up at the beginning of the recurrence period.  Yes number minimum = set by instance_min_count; maximum = instance_max_count none 5
specific_date Triggers the scaling rule during the specified date intervals.  Yes none none none none
start_date_time Start date and time of the schedule in YYYY-MM-DDTHH:MM format Yes string minimum = current date and time; maximum= no upper limit none 2015-06-02 T10:00
end_date_time End date and time of the schedule in YYYY-MM-DDTHH:MM format Yes string minimum = set by start_date_time; maximum= no upper limit none 2015-09-02 T10:00

->Time Zones for a Schedule-Based Policy 
https://help.sap.com/viewer/7472b7d13d5d4862b2b06a730a2df086/Cloud/en-US/92bceebce51f44f38f4e53d35ce2b41d.html



                            1.21.4.2.2.1.1.3 

                        1.21.4.2.2.1.2 definitions and testing
                        RT apps autoscaler wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Portal+Autoscaler+Service

lite plan. 2 rules per policy
-> Nodejs Applications with container memory higher than ~1.4 G should  trigger scale out before reaching 1.4G since its nodejs maximum default v8 reservation. Hence I am using 
-> "metric_type": "memoryused" limited to 1G 
-> Nodejs Applications with container memory higher than ~1.4 G should trigger scale out before reaching 80% of total memory [may be even lower] hence 
-> "metric_type": "memoryutil" limited to 80 % or lower Kravchik, Alexander TODO approuter scale out test with muenchausen 
-> Maximum CPU utilisation should be ~ 60% 
-> Most frequent metrics aggregation is once per 60 sec (default per 5 min), hence  "stat_window_secs": 60 and "breach_duration_secs": 60
-> Maximum number of DB connections on postgres backing service plan is 250 , hence if each RT application allocates pool of up to 5 connections, maximum number of apps shouldn't exceed 50, approuters are not counted since they do not connect to DB. Hence  "instance_max_count": 10
-> To support HA we need at least 2 instances of each runtime application. Hence  "instance_min_count": 2

-> NodeJS RT app config
{
  "instance_min_count": 2,
  "instance_max_count": 12,
  "scaling_rules": [
    {
      "metric_type": "memoryused",
      "threshold": 1000,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "memoryused",
      "threshold": 200,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    },
    {
      "metric_type": "cpu",
      "threshold": 50,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "cpu",
      "threshold": 25,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    }
  ]
}
-> RT app router config
{
  "instance_min_count": 2,
  "instance_max_count": 12,
  "scaling_rules": [
    {
      "metric_type": "memoryutil",
      "threshold": 80,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "memoryused",
      "threshold": 40,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    },
    {
      "metric_type": "cpu",
      "threshold": 60,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "cpu",
      "threshold": 30,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    }
  ]
{
  "instance_min_count": 2,
  "instance_max_count": 12,
  "scaling_rules": [
    {
      "metric_type": "memoryutil",
      "threshold": 80,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "memoryused",
      "threshold": 40,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    },
    {
      "metric_type": "cpu",
      "threshold": 60,
      "stat_window_secs": 60,
      "breach_duration_secs": 60,
      "cool_down_secs": 60,
      "operator": ">=",
      "adjustment": "+1"
    },
    {
      "metric_type": "cpu",
      "threshold": 30,
      "stat_window_secs": 600,
      "breach_duration_secs": 600,
      "cool_down_secs": 600,
      "operator": "<",
      "adjustment": "-1"
    }
  ]
}}
-> script to configure apps
#!/usr/bin/env bash
 
cf create-service autoscaler lite portal-autoscaler
 
declare -a apps=(
"portal-cf-site-service"
"portal-cf-activation-service"
"portal-cf-site-configuration"
"portal-cf-portal-personalization"
"portal-cf-static-resources"
)
 
declare -a ars=(
"launchpad-rt-approuter"
"portal-cf-rt-approuter"
"workzone-rt-approuter"
"workzonehr-rt-approuter"
)
 
 
for app in ${apps[@]}
do
echo "############## adding scaling policy to $app "
cf bs ${app} portal-autoscaler
cf attach-autoscaling-policy ${app} nodejs-apps/autoscaling-policy.json
cf restage ${app} &
done
 
 
for ar in ${ars[@]}
do
echo "############## adding scaling policy to $ar "
cf bs ${ar} portal-autoscaler
cf attach-autoscaling-policy ${ar} approuters/autoscaling-policy.json
cf restage ${ar} &
done

-> The design goes on about load tests results and conculsions...

                        1.21.4.2.2.1.3 integration
                        https://wiki.wdf.sap.corp/wiki/display/CPPortals/Portal+Autoscaler+Service+Integration

                        1.21.4.2.2.1.4 autoscaler binding manifest-concourse example
                        https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/manifest-concourse.yml#L11
                          services:
    - (( env("LANDSCAPE_ENVIRONMENT") != "dev" ? "portal-autoscaler" :~~ ))

                        1.21.4.2.2.1.5 a scaling policy example policy 
                        https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/autoscaler/autoscaling-policy.json

                        1.21.4.2.2.1.6 how to attach scaling policy 
                            https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/post_deployment.py#L38

                        1.21.4.2.2.1.7 Maximum number of connections to database

                            1.21.4.2.2.1.7.1 hyperscaler 
hyperscaler help: https://help.sap.com/viewer/b3fe3621fa4a4ed28d7bbe3d6d88f036/Cloud/en-US/e4a41a8f0eea459e912cc642532dc3ac.html?q=max%20connections

Service Plan	Instance type on AWS	Compute Resources	max_connections
standard	db.t2.small	1 vCPU + 2GB RAM	198
            db.t3.medium	2 vCPU + 4GB RAM	405
Premium	db.m5.large	2 vCPU + 8GB RAM	823
db.m5.xlarge	4 vCPU + 16GB RAM	1691
db.m5.2xlarge	8 vCPU + 32GB RAM	3429
db.m5.4xlarge	16 vCPU + 64GB RAM	5000
Note
Please note that the Hyperscaler reserves ~5 connections for internal monitoring and admin purposes. Hence connections available to the application are 5 less than the max_connections mentioned above.
What is the Number of max_connections for PostgreSQL Instances in Azurer Regions?

Service Plan	Instance type on Azure	Compute Resources	max_connections
Premium	
                GP_GEN5_2	2 vCPU + 10GB RAM	150
                GP_GEN5_4	4 vCPU + 20GB RAM	250
                GP_GEN5_8	8 vCPU + 40GB RAM	480
                GP_GEN5_16	16 vCPU + 80GB RAM	950
                
                            1.21.4.2.2.1.7.2 Service Fabric

AliCloud 
GCP 
                        1.21.4.2.2.1.8 Additional 
g.       Remember to calculate memory quota for maximum scale out event !
h.       Calculate max number of db connections :  MAX pool size * MAX instances #
i.       Hosts number of connections should be greater than all the pools of all the applications

                1.21.4.2.3 Tests

                    1.21.4.2.3.1 on my dev space
-> install plugin: $ cf install-plugin -r CF-Community app-autoscaler-plugin
create service:
[i500695@C02X632CJGH6:2021-04-21 15:24:54:~:]2002$ cf create-service autoscaler lite portal-autoscaler
Creating service instance portal-autoscaler in org launchpad / space i500695p as yosi.izaq@sap.com...
OK

-> bind
cf bs portal-cf-cdm-store-service portal-autoscaler

-> add autoscaler policy in resources
branch yosi_22_04_21__15_06

-> add postdeploy

-> add manifest-concourse
services
    - (( env("LANDSCAPE_ENVIRONMENT") != "dev" ? "portal-autoscaler" :~~ ))

->
[i500695@C02X632CJGH6:2021-04-22 17:20:02:~/work/SAP/git/portal-cf-cdm-store-service:]2010$ gits
On branch yosi_22_04_21__15_06
Untracked files:
  (use "git add <file>..." to include in what will be committed)

	cdm.store.service/src/main/resources/autoscaler/
	post_deployment.py
    manifest-concourse

note that cdm.store.service/src/main/resources/autoscaler/ files are mapped to ./app/BOOT-INF/classes/ in container. see:
vcap@fc77c294-5f8c-496d-792c-45a3:~$ ls ./app/BOOT-INF/classes/
application.properties  com  db  db.properties  logback.xml  schema  swagger

code:
-> [i500695@C02X632CJGH6:2021-04-22 17:48:33:~/work/SAP/git/portal-cf-cdm-store-service:]2018$ cat post_deployment.py  | pbcopy 
#!/usr/bin/python
import os
import utils.cf_helper as cf
import utils.general_helper as gen
from utils.log_helper import PortalLogger

# globals
logger = PortalLogger.get_instance()
LANDSCAPE_ENVIRONMENT = os.environ.get('LANDSCAPE_ENVIRONMENT')
ARTIFACT_FOLDER = os.environ.get('ARTIFACT_FOLDER')
AUTOSCALING_POLICY = f"{ARTIFACT_FOLDER}/autoscaler/autoscaling-policy.json"

class PostDeploy:
    """
        This class will execute all necessary steps after deployment script execution
        Prerequisites:
            Before calling this script make sure that all needed credentials are available in environment
            and CF login action was previously done.
    """


    @staticmethod
    def execute(app_name):
        PostDeploy.__apply_autoscaling_policy(app_name)


    @staticmethod
    def __apply_autoscaling_policy(app_name):
        if LANDSCAPE_ENVIRONMENT != "dev":
            logger.debug("---> PostDeploy: applying autoscaling policy file", AUTOSCALING_POLICY)
            # apply autoscaling policies
            gen.cmd_buffered(f"cf attach-autoscaling-policy {app_name} {AUTOSCALING_POLICY}")
            logger.debug("---> PostDeploy: applied autoscaling policy is:")
            gen.cmd_buffered(f"cf autoscaling-policy {app_name} >& stam")
            with open("stam", r) as filename:
                lines = filename.readlines()
                logger.debug(lines)
            gen.cmd_buffered("rm stam")

->  [i500695@C02X632CJGH6:2021-04-22 17:49:35:~/work/SAP/git/portal-cf-cdm-store-service:]2020$ cat cdm.store.service/src/main/resources/autoscaler/autoscaling-policy.json  | pbcopy 
{
    "instance_min_count": 2,
    "instance_max_count": 10,
    "scaling_rules": [
       {
            "metric_type": "memoryutil",
            "threshold": 60,
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">=",
            "adjustment": "+1"
        },
        {
            "metric_type": "memoryutil",
            "threshold": 30,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<",
            "adjustment": "-1"
        },
       {
            "metric_type": "throughput",
            "threshold": 10,
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">",
            "adjustment": "+1"
        },
        {
            "metric_type": "throughput",
            "threshold": 10,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<=",
            "adjustment": "-1"
        },
        {
          "metric_type": "cpu",
          "threshold": 70,
          "stat_window_secs": 60,
          "breach_duration_secs": 60,
          "cool_down_secs": 60,
          "operator": ">=",
          "adjustment": "+1"
        },
        {
          "metric_type": "cpu",
          "threshold": 35,
          "stat_window_secs": 600,
          "breach_duration_secs": 600,
          "cool_down_secs": 600,
          "operator": "<",
          "adjustment": "-1"
        }
        
    ]
}

-> push to my space
[i500695@C02X632CJGH6:2021-04-25 11:55:07:~/work/SAP/git/portal-cf-cdm-store-service:]2021$ gitd manifest-dev.yml 
-    - route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/cdm_store_service
+    - route:  portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service
   memory: 1024MB
-  path: <pathToFile>
+  path: /Users/i500695/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/target/cdm.store.service-1.60.0-SNAPSHOT.jar


-> attach policy
cf create-service autoscaler lite portal-autoscaler && cf bs portal-cf-cdm-store-service portal-autoscaler && cf attach-autoscaling-policy portal-cf-cdm-store-service cdm.store.service/src/main/resources/autoscaler/autoscaling-policy.json && cf rs portal-cf-cdm-store-service  && cf autoscaling-policy portal-cf-cdm-store-service

-> run monitor loop
$ while true; do date ; cf app portal-cf-cdm-store-service; sleep 30; done
Sun Apr 25 15:58:44 IDT 2021
...

-> Run load script:

    --> get token
    
tenant id, go to https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/details (consumer Subaccount: SAP Launchpad i500695 )
launchpadInstanceId:  cf env portal-cf-cdm-store-service | grep launchpadInstanceId
[i500695@C02X632CJGH6:2021-04-26 15:17:13:~/work/SAP/code/python/REST/CDM_Store:]2070$  portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "472abdee-c7a4-4357-80ed-3a490cc94622","instanceId": "29a214f1-6a89-4d38-9e0e-d762571391cc","userName":"techUser","isProvider":"false"}'

copy paste token...

    --> postman
        get all site entities
        python
import requests

url = "https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/v2/sites/d1b4523d-3630-43e4-b81d-edb65a8848cc/entities"

payload={}
headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer <token>'
}

response = requests.request("GET", url, headers=headers, data=payload)

print(response.text)

    --> script
    cat getAllSiteEntities.py | pbcopy 
import requests

url = "https://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/v2/sites/d1b4523d-3630-43e4-b81d-edb65a8848cc/entities"

payload={}
headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vbGF1bmNocGFkLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoiZGVmYXVsdC1qd3Qta2V5LS0xNDI1ODUzMjE4IiwidHlwIjoiSldUIn0.eyJqdGkiOiJkMjQ1NmRkODYwMWE0N2ZkOGVkZmYyNzRhN2I1ZDJmMyIsImF6X2F0dHIiOnsidGVuYW50SWQiOiI0NzJhYmRlZS1jN2E0LTQzNTctODBlZC0zYTQ5MGNjOTQ2MjIiLCJpbnN0YW5jZUlkIjoiMjlhMjE0ZjEtNmE4OS00ZDM4LTllMGUtZDc2MjU3MTM5MWNjIiwidXNlck5hbWUiOiJ0ZWNoVXNlciIsImlzUHJvdmlkZXIiOiJmYWxzZSJ9LCJleHRfYXR0ciI6eyJlbmhhbmNlciI6IlhTVUFBIiwic3ViYWNjb3VudGlkIjoiNjVlMjI3ZmEtM2U0ZC00MmUyLTg0ZjctZDhlN2ZiMTMxNjZlIiwiemRuIjoibGF1bmNocGFkIn0sInN1YiI6InNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGk1MDA2OTVwIWIxNDQwMCIsImF1dGhvcml0aWVzIjpbInVhYS5yZXNvdXJjZSIsInBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGk1MDA2OTVwIWIxNDQwMC5DYWxsYmFjayJdLCJzY29wZSI6WyJ1YWEucmVzb3VyY2UiLCJwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpNTAwNjk1cCFiMTQ0MDAuQ2FsbGJhY2siXSwiY2xpZW50X2lkIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiY2lkIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiYXpwIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiZ3JhbnRfdHlwZSI6ImNsaWVudF9jcmVkZW50aWFscyIsInJldl9zaWciOiI2NjBkMmJlMCIsImlhdCI6MTYxOTQzOTUzOSwiZXhwIjoxNjE5NDgyNzM5LCJpc3MiOiJodHRwczovL2xhdW5jaHBhZC5hdXRoZW50aWNhdGlvbi5zYXAuaGFuYS5vbmRlbWFuZC5jb20vb2F1dGgvdG9rZW4iLCJ6aWQiOiI2NWUyMjdmYS0zZTRkLTQyZTItODRmNy1kOGU3ZmIxMzE2NmUiLCJhdWQiOlsidWFhIiwicG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIl19.NbMNRC05gUfH4YsKDRFtQ8mnShxsBVbbeR-qd9S_CQEoWZQjjvPYwUaPV2JmJlMHc8RjOCi7BX0LmUshS1yIXEUzWEF7-PSpDBMfBXjIINy-a_FwaPOQeeEW0c-723sTclnGuJYsRXP5qe22aqoxmFu6Vtd0AGfLmVlRm70daAgDZsEdb8JvtCZg4PQi5nppj8msQg1AJkzrQnAnEZ4jc4Ib_10HILZHjUlKKzM3VxREIVBx4nWBidra6_CDOK6qtnmZNkr9tZGPAsS8Xi4QShqvFBofb4rkHY8Db4AnnQQBvk5EB4hELiIvgxrd2non_nGaXlndZoMP5gRctk1MyA'
}


initialTPS = 10 # 10 worker threads in pool. so actual tps is *10
tpsIncreaseFactor = 2.0
tpsIncreaseWindow = 60
threadPoolSize=20

import time
import datetime
import sys
import signal
import threading

#sys.stdout = open('/Users/i500695/temp/loadLog', 'w')
def signal_handler(sig, frame):
        print('Closing load tool')
        #sys.stdout.close()
        sys.exit(0)
signal.signal(signal.SIGINT, signal_handler)

def fire_n_reqs(tname, n):
    print('Thread {} firing {} requests. time {}'.format(tname, n, datetime.datetime.now()))
    for i in range(int(n)):
        requests.request("GET", url, headers=headers, data=payload)

def load(tname):
    print('Thread {} starting load. initialTPS={}, tpsIncreaseFactor={}, tpsIncreaseWindow={} seconds'.format(tname, initialTPS, tpsIncreaseFactor, tpsIncreaseWindow)) 
    start = time.time()
    currentTPS = initialTPS
    while True:
        fire_n_reqs(tname, currentTPS)
        end = time.time()
        if (end-start) >=tpsIncreaseWindow:
            start = time.time()
            currentTPS*=tpsIncreaseFactor
            print('Thread {} Stepping up TPS to {}'.format(tname, currentTPS))





import concurrent.futures

if __name__ == "__main__":
    # print('getting site entities from', url)
    # response = requests.request("GET", url, headers=headers, data=payload)
    # print(response.text)
    ##load()
    threads = list()
    for index in range(threadPoolSize):
        print("Main    : create and start thread %d.", index)
        x = threading.Thread(target=load, args=(index,))
        threads.append(x)
        x.start()




    --> Actual test
    load:
[i500695@C02X632CJGH6:2021-04-26 16:56:04:~/work/SAP/code/python/REST/CDM_Store:]2041$ py3 getAllSiteEntities.py 
Main    : create and start thread %d. 0
Thread 0 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 0 firing 10 requests. time 2021-04-26 17:25:24.373335
Main    : create and start thread %d. 1
Thread 1 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 1 firing 10 requests. time 2021-04-26 17:25:24.373949
Main    : create and start thread %d. 2
Thread 2 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Main    : create and start thread %d. 3
Thread 2 firing 10 requests. time 2021-04-26 17:25:24.374342
Thread 3 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Main    : create and start thread %d. 4
Thread 3 firing 10 requests. time 2021-04-26 17:25:24.374782
Thread 4 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 4 firing 10 requests. time 2021-04-26 17:25:24.375553
Main    : create and start thread %d. 5
Thread 5 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 second[i500695@C02X632CJGH6:2021-04-26 16:56:04:~/work/SAP/code/python/REST/CDM_Store:]2041$ py3 getAllSiteEntities.py 
Main    : create and start thread %d. 0
Thread 0 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 0 firing 10 requests. time 2021-04-26 17:25:24.373335
Main    : create and start thread %d. 1
Thread 1 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 1 firing 10 requests. time 2021-04-26 17:25:24.373949
Main    : create and start thread %d. 2
Thread 2 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Main    : create and start thread %d. 3
Thread 2 firing 10 requests. time 2021-04-26 17:25:24.374342
Thread 3 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Main    : create and start thread %d. 4
Thread 3 firing 10 requests. time 2021-04-26 17:25:24.374782
Thread 4 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 seconds
Thread 4 firing 10 requests. time 2021-04-26 17:25:24.375553
Main    : create and start thread %d. 5
Thread 5 starting load. initialTPS=10, tpsIncreaseFactor=1.2, tpsIncreaseWindow=180 secondss

logs:
 $ cat ~/temp/stam
while true; do date ; cf app portal-cf-cdm-store-service; sleep 15; done
 . stam | tee -a loadLog

~/work/SAP/logs/cdm-store/autoscaler_load/loadLog

-> 



                    1.21.4.2.3.2 on LTS

                1.21.4.2.4 Tasks
                1.21.4.2.5 Code

                1.21.4.2.6 Additional
directions/questions
-> Is stat_window_secs supported?- Didn't find in documentation. Does it mean data aggregation frequency?
-> threshold triggered by one or more instances? - one is sufficient
-> Is operational PG plan max connection size 250?
    --> Email to Boaz
We plan to add autoscaler policy to CDM store. We want the scaling policy to take into account the lowest max DB connections number across all our production environment options.
 
AWS is using hyperscaler PG DB. Question is which plan?- Is it: Standard, db.t3.medium?- If so, we will have 400 connections…
 
Azure is still not using hyperscaler PG DB but when it will, which plan will be used? -I hope it would be higher than GP_GEN5_2 b/c it only has 150 connections…
 
For the other IAAS, GCP, AliCloud (which are still using service fabric, right?). Can you plz let me know what is the max DB connections?

    --> Boaz response:
AWS is using PG, hyperscaler plan Premium with 8GB RAM which has max 823 connections.
Azure will use PG, hyperscaler with the same plan starting from Q3 2021, which is August 21st. It has 150 max connections, but we might need to create it with 80GB to support a higher figure.
See more information here: https://help.sap.com/viewer/b3fe3621fa4a4ed28d7bbe3d6d88f036/Cloud/en-US/e4a41a8f0eea459e912cc642532dc3ac.html
Re GCP/AC max DB connections, I don’t have a data, so I’m adding @Heinze, Thomas to the discussion.

    --> Thomas response
please understand as explained in the past, that this limitation is come from the underlying Postgres architecture (MSFT Postgres so far runs on Windows, where socket connections are expensive).We will soon introduce a next generation of Postgres service, which has higher connection limits.
    --> my response
(adding @Tammam, Ariel and @Tito, Meni back)

Thank you Thomas!

With this limitation in mind I think we need to review closely the applications that are bound the DT DB.
At worst case scenario where each app instance uses max connections there would be serious contention for DB connections.
At such worst case we could be looking at, 
content-package-store - 20 connections
cpkg-manager-service-green – 40
portal-cf-activation-service – 30 (when max scaled out)
portal-cf-provisioning-service – 20
BTW, there are also migration, transformation etc services that I didn’t count assuming they are meant to run one time only.

So 110 connections. Documentation mentions 5 connections are reserved for DB administration so 115 connections consumed.
Leaving CDM store service with 45 connections. Limiting its scale out to 4 instances.

    --> Thomas response 2
Hi Yosi,
 
for the new Postgres service on Azure you can see the new connection limit here (see General purpose instance):
https://docs.microsoft.com/de-de/azure/postgresql/flexible-server/concepts-limits
 
With a 8GB instance you get 211 Connections. Based on the timeline shared by @Wimmer, Boaz, I assumed you anyhow will wait for Postgres Flexible Server.
 
Regards, Thomas
    -->
-> CDM-store connection pool size is 10
    --> manifest-concourse.yml
  CDM_MAX_POOL_SIZE: 10
    --> com/sap/portal/cf/database/postgres/PostgresDataSource.java
    private static final int DEFAULT_MAX_POOL_SIZE = 10;
    ...
    private DataSource getDataSource(String username, String password, String url, String driverName) {
        int maxPoolSize = DEFAULT_MAX_POOL_SIZE;
        if (this.dataSource == null) {
            logger.info("getConnection() initializing data source PostgresDataSource");
            this.dataSource = DataSourceBuilder.create()
                    .type(org.apache.tomcat.jdbc.pool.DataSource.class)
                    .username(username)
                    .password(password)
                    .url(url)
                    .driverClassName(driverName)
                    .build();

            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setInitialSize(4);
            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setMaxIdle(4);

            if (System.getenv("CDM_MAX_POOL_SIZE") != null) {
                maxPoolSize = Integer.parseInt(System.getenv("CDM_MAX_POOL_SIZE"));
            }
            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setMaxActive(maxPoolSize);
            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setTestOnBorrow(true);
            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setRemoveAbandoned(true);
            ((org.apache.tomcat.jdbc.pool.DataSource) this.dataSource).setRemoveAbandonedTimeout(120);
        }
        return this.dataSource;
    }
    
-> max instances we want
-> increase policy
suggest, Dynamic-Scaling. rules based on throughput (req/sec), response-time(ms), cpu load
-> decrease policy
-> Breach time
-> Rules order. One of applies is sufficient. Order does not matters
-> service plans. 
checked on my saar global account space (https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/65e227fa-3e4d-42e2-84f7-d8e7fb13166e/org/c7486965-e5bd-4047-a1a1-79f702a29304/space/7e0d5a8a-30ae-4b1b-948b-cfa4914de088/service-marketplace&//detail/87d5e9c2-c003-4480-8f6b-2b9a4e1e78d9/?layout=TwoColumnsMidExpanded)
    --> lite policy. 
    This plan allows four scaling rules and two schedules per policy document
Features:
Dynamic scaling based on application metrics, 1 policy with 4 scaling rules and 2 schedules

    --> standard
   This plan allows ten scaling rules and ten schedules per policy document
Features:
Dynamic scaling based on application metrics, set a policy with up to 10 scaling rules and 10 schedules per bound app 

    -->
-> Container memory. manifest - 2GB. production, manifest-concourse - 4GB. max scale out is 40GB.
-> instance_min_count. HA dictates 2.
-> instance_max_count. 
250 connections to DT DB. shared by apps:
main:
portal-cf-cdm-store-service
portal-cf-provisioning-service
portal-cf-transport-service
portal-cf-activation-service
portal-cf-service-broker

all: 
$ cf s | grep portal-postgres
content-package-store,
cpkg-manager-service-blue,
portal-cf-activation-service,
portal-cf-cdm-store-service,
portal-cf-cdm-transformer,
portal-cf-content-repository,
portal-cf-design-time-service,
portal-cf-provisioning-service,
portal-cf-service-broker,
portal-cf-technical-support-am-blue,
portal-cf-technical-support-blue,
portal-cf-transport-service,
provisioning-service,
tenant-configuration

    ---> content-package-store, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20
repo: https://github.wdf.sap.corp/Portal-CF/content-package-store.git

    ---> cpkg-manager-service-green, Java/JPA Orm/postgres. uses native DataSource, default connections pool size of 20 X 2 => 40
repo: https://github.wdf.sap.corp/Portal-CF/cpkg-manager.git
src/main/java/com/sap/wz/cpkg/manager/service/configuration/CloudDataSourceConfiguration.java:
	private int maxParallelRequests = 20;
...
		int maxPoolSize = maxParallelRequests;
spring connection pool : org.springframework.cloud.service.PooledServiceConnectorConfig.PoolConfig;


    ---> portal-cf-activation-service, NodeJs/pg-boss/postgres. pool size 5. instances 2-6. max connections => 30
Most DB operations via cdm store, except activation queue
src/queue/activationQueue.js
        boss = new PgBoss(options);
    const options = {
        host: credentials.hostname,
        port: credentials.port,
        database: credentials.dbname,
        user: credentials.username,
        password: credentials.password,
        max: 5,
        deleteAfterDays: 1
    };
so max pool size, 5

    ---> portal-cf-cdm-store-service,  Java/postgres.  default connections pool size of 10 X 2 instances => 20

    ---> portal-cf-cdm-transformer, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20
used for transformations only (not production)
src/DB/dbClient.ts

    ---> portal-cf-provisioning-service, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20
-------------------- Use also Hana DB??-------------------- 
    ---> portal-cf-content-repository, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20
src/db/index.ts

    ---> portal-cf-design-time-service
converts CDM 2->3, seems like only used for migrations (using node-pg-migrate)


    ---> portal-cf-service-broker
The FLP@CF SB uses the SBF to exposes the FLP@CF Service in CF Marketplace.

    ---> portal-cf-technical-support-am-blue
portal-cf-technical-support-blue

-------------------- Use also Hana DB??-------------------- 

portal-cf-transport-service, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20
tenant-configuration, nestjs/typeOrm/postgres. uses typeOrm default connections pool size of 10 X 2 => 20

Are all relevant??- How many connections per each?- How many should be dedicated to CDM-store?
Maybe we can autoscale just store?

-> add service to manifest
e.g.
   services:
      #Services created with a new space
      - portal-autoscaler

-> post deploy apply autoscaling-policy 
Apply autoscaling policies  - in progress pending post-deployment.py
Add to the post- deployment scripts https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/post_deployment.py 
translate to python 
cf attach-autoscaling-policy portal-cf-site-service autoscaler/autoscaling-policy.json
verify that the policy attached 
cf autoscaling-policies portal-cf-site-service

-> Suggested policy
Dynamic Scaling Policy. Following rules:
- scale-up:
    - memory utilisation. 60%
    - TPS. 10
    - CPU usage. 70%
    - measurments frequency. 1 min
    - breach duration. 1 min
    - Min time before next scale. cool down. 1 min
- scale-down:
    - memory utilisation. 30%
    - TPS. 10
    - CPU usage. 35%
    - measurments frequency. 10 min
    - breach duration. 10 min
    - Min time before next scale. cool down. 10 min

e.g.
{
    "instance_min_count": 2,
    "instance_max_count": 10,
    "scaling_rules": [
       {
            "metric_type": "memoryutil",
            "threshold": 60,
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">=",
            "adjustment": "+1"
        },
        {
            "metric_type": "memoryutil",
            "threshold": 30,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<",
            "adjustment": "-1"
        },
       {
            "metric_type": "throughput",
            "threshold": 10, // the throughput value in Requests/second
            "stat_window_secs": 60,
            "breach_duration_secs": 60,
            "cool_down_secs": 60,
            "operator": ">",
            "adjustment": "+1"
        },
        {
            "metric_type": "throughput",
            "threshold": 10,
            "stat_window_secs": 600,
            "breach_duration_secs": 600,
            "cool_down_secs": 600,
            "operator": "<=",
            "adjustment": "-1"
        },
        {
          "metric_type": "cpu",
          "threshold": 70,
          "stat_window_secs": 60,
          "breach_duration_secs": 60,
          "cool_down_secs": 60,
          "operator": ">=",
          "adjustment": "+1"
        },
        {
          "metric_type": "cpu",
          "threshold": 35,
          "stat_window_secs": 600,
          "breach_duration_secs": 600,
          "cool_down_secs": 600,
          "operator": "<",
          "adjustment": "-1"
        }
        
    ]
}

-> CDM-store autoscaler application plan

    --> Production

    --> Existing landscapes
On old dev spaces need to manually add.
cf create-service autoscaler lite portal-autoscaler
cf bs portal-cf-cdm-store-service portal-autoscaler
cf attach-autoscaling-policy portal-cf-cdm-store-service cdm.store.service/src/main/resources/autoscaler/autoscaling-policy.json
cf rs portal-cf-cdm-store-service 

    --> reference portal-cf-site-service
[i500695@C02X632CJGH6:2021-04-22 12:24:22:~/work/SAP/git/portal-cf-site-service:]2073$ Ag autosca
post_deployment.py
11:AUTOSCALING_POLICY = f"{ARTIFACT_FOLDER}/autoscaler/autoscaling-policy.json"
26:        PostDeploy.__apply_autoscaling_policy(app_name)
38:    def __apply_autoscaling_policy(app_name):
40:            logger.debug("---> PostDeploy: applying autoscaling policy...")
41:            # apply autoscaling policies
42:            gen.cmd_buffered(f"cf attach-autoscaling-policy {app_name} {AUTOSCALING_POLICY}")

package.json
55:        "autoscaler",

manifest-concourse.yml
11:    - (( env("LANDSCAPE_ENVIRONMENT") != "dev" ? "portal-autoscaler" :~~ ))

    -->
->
https://github.com/cloudfoundry/app-autoscaler-cli-plugin#cf-attach-autoscaling-policy
                1.21.4.2.7 Content creator service

                1.21.4.2.8 Cloud Foundry CLI AutoScaler Plug-in
see: <url:#r=__Cloud_Foundry_CLI_AutoScaler_Plugin__>

                1.21.4.2.9 Adam python load script
import matplotlib
import requests as requests
import asyncio
import time as time
import matplotlib.pyplot as plt
import statistics as statistics

requests_timings = dict()


def make_request(index):
    requests_timings.setdefault(index, 0)
    start_time = time.time()
    response = requests.put(
        url='https://portal-service-launchpadi055502p.cfapps.sap.hana.ondemand.com/transport_service/transports/external/start',
        headers={
            'x-attribute-tenant-id': '1ce802a5-1e33-4e9d-968e-6fb3217ce807',
            'x-attribute-instance-id': 'f60bccf9-a011-48c0-b077-2226b8a5450b',
            'Authorization': 'Bearer <token>',
            'Content-Type': 'application/json'
        },
        data=f'{{"dcm": {{ "source": {{ "destinationId": "mock-provider" }}, "context": {{ "id": "yoavid5{index}", "type": "adamtype1" }} }} }}')
    print(response)
    end_time = time.time()
    requests_timings[index] = (end_time - start_time)


async def main():
    request_num = 1
    loop = asyncio.get_event_loop()
    futures = [
        loop.run_in_executor(
            None,
            make_request,
            i)
        for i in range(10)
    ]
    for response in await asyncio.gather(*futures):
        request_num = request_num + 1


loop = asyncio.get_event_loop()
loop.run_until_complete(main())

std = statistics.stdev(requests_timings.values())
mean = statistics.mean(requests_timings.values())
plt.plot(requests_timings.keys(), requests_timings.values())
plt.ylabel('time in seconds')
plt.xlabel('request #')
title = f'std = {std}sec mean = {mean}sec'
plt.title(title)
plt.show()

if __name__ == '__main__':
    print('DONE')



                1.21.4.2.10
            1.21.4.3 others 

                1.21.4.3.1 https://jira.tools.sap/browse/DWPBUGS-3566   Deleting roles in CP -> roles still appears in cockpit
RC: deleted roles not added to report chunk by CDM store since it’s not odata delta link scenario (so only in commit is it possible to know which entities are “deleted”)
 
We suggest two fixes.
Short term: commit method will also return a report chunk with the deleted entities in content pkg update scenario.
Fix in CDM-store and transport, Activity: https://jira.tools.sap/browse/EUXTEAMSAAR-3331
HLEE – M
Long term / additional: Semantic will bind to solace and sub to the topic so that it is informed of role add/delete events. Then on add/delete it will create/delete role-collection from cockpit.
Pros. Semantic will not depend on transport to handle correctly and w/ less probability for bugs create/delete role-collection from cockpit.
                1.21.4.3.2
            1.21.4.4
        1.21.5  T05 
        1.21.6  T06 
        1.21.7  T07 
        1.21.8  T08 
        1.21.9  T09 
        1.21.10 T10
        1.21.11 T11

            1.21.11.1  team BLIs

                1.21.11.1.1   EUXTEAMSAAR-2682 CEP Activation - Message Queue Library
repo: https://github.wdf.sap.corp/Portal-CF/portal-amqp-client.git
https://github.wdf.sap.corp/I355599/mq-management-client.git
design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+Solace+AMQP+Consumer+NPM+Module
test scope: https://wiki.wdf.sap.corp/wiki/display/CPPortals/CEP+Activation+-+Message+Queue+Library+Test+Scope


                1.21.11.1.2  EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces  Core and Portal Schema. 
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/196

                1.21.11.1.3 security fix
https://sapjira.wdf.sap.corp/browse/DWPBUGS-1513?filter=-2
PRs on all our NestJS services. e.g. https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/233/files

                1.21.11.1.4  EUXTEAMSAAR-2663 [Manual integration] Support additional param types in navigation. 
Documentation: https://help.sap.com/viewer/DRAFT/8c8e1958338140699bd4811b37b82ece/Cloud/en-US/4ba745b26b0e4ca494d99b94a858551d.html
PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-content-manager/pull/263
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-infra/pull/245

                1.21.11.1.5 EUXTEAMSAAR-2579 [CEP: Content Management] Support for Workpages & Workspaces - Transport Service and CDM Store

                1.21.11.1.6  EUXTEAMSAAR-2631 CEP Activation - Add Message Queue to CDM Store

                1.21.11.1.7 EUXTEAMSAAR-2644 [CEP: Content Management] Support for Workpages & Workspaces - Core and Portal Schema
Gerald PR: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/270
Adam PR: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/272

                1.21.11.1.8 EUXTEAMSAAR-2702 Improve DB performance II
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Design-time+PG+DB+Performance+improvements

 Cont. DB perf improvements

SRE Dashboard track. Provide list of metrics we need
PG 12 perf improvements. auto sharding?
etc.
                1.21.11.1.9 Task -  Research Security Issues class validator code injection
PRs - https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/40 - disabling abillity to use code injection throught class validator
also for all our NestJS repos

                1.21.11.1.10
            1.21.11.2 Other BLIs

                1.21.11.2.1 Lazy fix of FDC-app-host-id
https://wiki.wdf.sap.corp/wiki/pages/resumedraft.action?draftId=2676333707&draftShareId=5e0d2ae5-6568-4a81-b55b-15632e0da702&
https://sap-my.sharepoint.com/:v:/p/yuval_fainer/Eclh4H0skHBPrHSTIg0SaYQB3Bwfgni-Jwi-dZm-mdCfXA

-> 

                1.21.11.2.2 [CEP: Content Management] Extend the Site Manager to Support Content Packages
 Design document : https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%3A+Content+Management%5D+Extend+the+Site+Manager+to+Support+Content+Packages+-+Design+Document 
                
                1.21.11.2.3 Business Application Variant
                https://sapjira.wdf.sap.corp/browse/EUXTEAMGUYM-4112

                1.21.11.2.4 CEP site schema
https://wiki.wdf.sap.corp/wiki/display/CPPortals/CEP+site+CDM+schema

                1.21.11.2.5 crown jewls, mtls
Shared lib PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/pull/317


-- for reference , re Java MTLS Support
Saar:    Hi Yosi,
Carlos's team is doing the navigation service x509 crown jewels, you can maybe take some ideas:
https://github.wdf.sap.corp/Portal-CF/navigation-service/pull/212/files

Carlos's team is doing the navigation service x509 crown jewels, maybe you want to take a look:
https://github.wdf.sap.corp/Portal-CF/navigation-service/pull/212/files

It’s super important that you check that there is a new audit log library that you can use as when the audit log service change to x509 it will fail if we keep it as is, same goes to solace as you mentioned.
 
Thanks,
Saar
 
-- Gil research
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Wednesday, 10 November 2021 15:10
To: Dagan, Saar <saar.dagan@sap.com>; Frishberg Barak, Oren <oren.frishberg.barak@sap.com>; Laham, Eman <eman.laham@sap.com>; Pdut, Yaron <yaron.pdut@sap.com>; Shikva, Gil <gil.shikva@sap.com>
Subject: Re: Progress of Crown Jewels Requirements - Status check
 
+ @Shikva, Gil
 
Hi Saar, all,
 
We would like to update that Gil checked and currently CDM store doesn’t need any modifications as it does not send REST to external services.
 
There are two exceptions.
Current. Audit log which provides it’s own client.
Future. Solace. We need to update to utilize their support for TLS connection. See: https://docs.solace.com/Solace-PubSub-Messaging-APIs/API-Developer-Guide/Creating-Secure-Sessions.htm

-- Audit-Log
Please search for mTLS here:
https://github.wdf.sap.corp/xs-audit-log/audit-java-client/wiki/Audit-Log-V2
    --- Using mTLS authentication for the oauth2 service plan to send a certificate and a private key to the Audit Server
There are two ways to send a certificate and a private key to the Audit Server using the Audit Client:

(the recommended way) Using the default constructor of AuditLogMessageFactoryImpl and getting the environment configuration from an mTLS configured service binding to the Auditlog Service
The environment of a CF app can be checked with the following command, in order to ensure that the "certificate" and "key" environment configurations are there:

cf env <cf-app-name>
By having this setup, this configuration is loaded automatically by the Audit Client, as long as the default constructor of AuditLogMessageFactoryImpl is being used.

If needed, a custom configuration may also be passed to the Client using the following constructor:

AuditLogMessageFactoryImpl(VcapServices vcapServices)
Using a specific constructor of AuditLogMessageFactoryImpl
The certificate and private key can also be passed to the client by using the following constructor:

AuditLogMessageFactoryImpl(String serviceUrl, String xsuaaClientId, String xsuaaUrl, byte[] certificate, byt
    ---
 
This will conflict with:
https://github.wdf.sap.corp/Portal-CF/portal-platform-commons/blob/master/portal.platform.commons.cf/src/main/java/com/sap/portal/platform/commons/audit/AuditLogger.java#L51
                
                1.21.11.2.6 Enhance Transport Report 
Destination Related:
    - Can't connect to Destination – open ticket to destination service
    - Token failure – XSUAA error ( should not be under destination error) 

Connectivity and backend related (usually related to destination config):
    -	Oauth2. [Saar, what do we know about this?]
    -	Basic auth – no authorization from BE ( 403 , no authorization to see the exposure ) ( 401 – the user does not exit/wrong password/no strict usage in CC, CC certificate   ) , xsuaa error 
    -	Saml2
    -	X.509 strict usage not toggled 
    -	Wrong certificate
    -   Invalid certificate
    -   Revoked certificate 
    -   Invalid response from BE – format, 
    -   404 – wrong url , File not found , format 
    -   500 – BE error , resource in missing , url error 

Cloud connector related – check if we get specific error from cloud connector 
Other – ticket to transport 

Transport can send status code and translation key.

            1.21.11.3


        1.21.12 T12

            1.21.12.1 team BLIs
From: Izaq, Yosi <yosi.izaq@sap.com>
Date: Sunday, 21 November 2021 at 17:35
To: Tito, Meni <meni.tito@sap.com>, Bezalel, Orit <orit.bezalel@sap.com>
Subject: T2112: Signoff - Yosi's Team preview

Hi Meni & Orit, 

Please review.
              
 
Here is our commitment for Takt 2112 - available team capacity: 56 PDs.
 
See below list of candidates for T12 (prioritization may change depending on the effort estimation). If anything is missing, please let me know.
 
Tasks:
Support – 19PDs
Preplanning preparation effort – 10 PDS
 
                1.21.12.1.1 Engineering: Create site-entity table
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2720 

- Before improvement 
 explain analyze SELECT "CDM_ENTITIES"."entityMD5",
"CDM_ENTITIES".cdm,
baseEntities.cdm as base_cdm,
coalesce("CDM_ENTITIES"."updatedOn", baseEntities."updatedOn") as "updatedOn",
coalesce("CDM_ENTITIES"."entityTitle", baseEntities."entityTitle") as "entityTitle",
coalesce("CDM_ENTITIES"."entityDescription", baseEntities."entityDescription") as "entityDescription",
coalesce("CDM_ENTITIES"."entityId", baseEntities."entityId") as "entityId"
, count(*) OVER() as total_entities
FROM "CDM_ENTITIES" INNER JOIN (
WITH RECURSIVE recursive_relations AS (
SELECT "entityMD5", "tenantId", 'ref' as "relationType"
FROM "CDM_ENTITIES"
WHERE "CDM_ENTITIES"."tenantId" = '1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b'
And "CDM_ENTITIES"."id" = '2c8719b3-fec3-4e4e-83e0-90dde79e5b1c'
And "CDM_ENTITIES"."contextType" = 'site'
UNION
SELECT "RELATIONS"."toMD5", "RELATIONS"."toTenantId", "RELATIONS"."relationType"
FROM recursive_relations INNER JOIN "RELATIONS"
ON recursive_relations."entityMD5" = "RELATIONS"."fromMD5"
Where NOT ("RELATIONS"."fromEntityType" = 'businessapp' And "RELATIONS"."toEntityType" = 'section') And NOT ("RELATIONS"."fromEntityType" = 'section' And "RELATIONS"."toEntityType" = 'businessapp')
)
Select "entityMD5", "tenantId", "relationType"
From recursive_relations
) relations On relations."tenantId" = "CDM_ENTITIES"."tenantId" AND relations."entityMD5" = "CDM_ENTITIES"."entityMD5"
Left join "RELATIONS" On
relations."entityMD5" = "RELATIONS"."fromMD5" And "RELATIONS"."relationType" = 'extends'
Left join "CDM_ENTITIES" baseEntities On baseEntities."entityMD5" = "RELATIONS"."toMD5"
Where relations."relationType" != 'extends'
-- AND "CDM_ENTITIES"."tenantId" = '1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b'
ORDER BY coalesce("CDM_ENTITIES"."entityMD5", baseEntities."entityMD5") DESC, "CDM_ENTITIES"."entityMD5" LIMIT 10000

on LTS, 845ms
 
- After improvement 
 explain analyze SELECT "CDM_ENTITIES"."entityMD5",
"CDM_ENTITIES".cdm,
baseEntities.cdm as base_cdm,
coalesce("CDM_ENTITIES"."updatedOn", baseEntities."updatedOn") as "updatedOn",
coalesce("CDM_ENTITIES"."entityTitle", baseEntities."entityTitle") as "entityTitle",
coalesce("CDM_ENTITIES"."entityDescription", baseEntities."entityDescription") as "entityDescription",
coalesce("CDM_ENTITIES"."entityId", baseEntities."entityId") as "entityId"
, count(*) OVER() as total_entities
FROM "CDM_ENTITIES" INNER JOIN (
WITH RECURSIVE recursive_relations AS (
SELECT "entityMD5", "tenantId", 'ref' as "relationType"
FROM "CDM_ENTITIES"
WHERE "CDM_ENTITIES"."tenantId" = '1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b'
And "CDM_ENTITIES"."id" = '2c8719b3-fec3-4e4e-83e0-90dde79e5b1c'
And "CDM_ENTITIES"."contextType" = 'site'
UNION
SELECT "RELATIONS"."toMD5", "RELATIONS"."toTenantId", "RELATIONS"."relationType"
FROM recursive_relations INNER JOIN "RELATIONS"
ON recursive_relations."entityMD5" = "RELATIONS"."fromMD5"
Where NOT ("RELATIONS"."fromEntityType" = 'businessapp' And "RELATIONS"."toEntityType" = 'section') And NOT ("RELATIONS"."fromEntityType" = 'section' And "RELATIONS"."toEntityType" = 'businessapp')
)
Select "entityMD5", "tenantId", "relationType"
From recursive_relations
) relations On relations."tenantId" = "CDM_ENTITIES"."tenantId" AND relations."entityMD5" = "CDM_ENTITIES"."entityMD5"
Left join "RELATIONS" On
relations."entityMD5" = "RELATIONS"."fromMD5" And "RELATIONS"."relationType" = 'extends'
Left join "CDM_ENTITIES" baseEntities On baseEntities."entityMD5" = "RELATIONS"."toMD5"
Where relations."relationType" != 'extends'
AND "CDM_ENTITIES"."tenantId" = '1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b' #This limits recursion to a single tenant 
ORDER BY coalesce("CDM_ENTITIES"."entityMD5", baseEntities."entityMD5") DESC, "CDM_ENTITIES"."entityMD5" LIMIT 10000
on LTS, 0.3ms, note that should also search tenants from which this site cherry-picks or just from all authorized tenants 
AND "CDM_ENTITIES"."tenantId" = '1d59c4d7-5985-4f21-ad3c-1ac66bf14d2b' || "CDM_ENTITIES"."tenantId" = 'tid2'  || "CDM_ENTITIES"."tenantId" = 'tid1' #This limits recursion to a single tenant 

New/Leftovers:  

PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/711

 
                1.21.12.1.2 CEP Activation - Message Queue Library
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2682 
Load configuration from JSON to update queues and topics for consumer – 4 PDs
User Builder Pattern for creating consumers + Producers – 2 PDs
design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+CDM+store+service+Runtime+support+-+Detailed+Design#id-[CEP]CDMstoreserviceRuntimesupportDetailedDesign-Messagingeventservice 
Failover - connection recovery with the underlying entities. Connection factory. Map recv/send  – 2 PDs
 
Logging - Add more logs and make sure logs are written in an appropriate way – 2 PDs
Tests – UT + integration tests - running with the docker image producer+consumer –  8 PDs
CI. Inform Oren when ready for staging. Solace Image for + CLI access+batch of mgmt cmds to run – 5 PDs
Connect to PPMS – 1 PDs
Mark repo as internal (check with Yaron)  
24 PDs
Started in T11

PRs:
https://github.wdf.sap.corp/Portal-CF/amqp-client/pull/5

                1.21.12.1.3 CEP Activation -  Solace Service Instance Provisioning

https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2711 
 
 
@Bezalel, Orit, consider move this to devops completely. We have no capacity to do this in T12
Dev Spaces – research most cost effective way. 1:n (instance sharing, convention for topic names) or 1:1 or UL solace docker image to CF – 5 PDs
Production (global services) – 3 PDs
Post deployment. Need to check. – 1 PDs
Performance tests – 3 PDs
12 PDs 

Will be done as a task 
@Wimmer, Boaz will handle the entitlements for the messaging queue service -  https://wiki.wdf.sap.corp/wiki/display/CoCo/Message+Queuing+Entitlement.
@Margieh, Jawad will modify the global services config yml. @Abovian, Tigran can you please point to the global services yml. https://wiki.wdf.sap.corp/wiki/display/CoCo/Message+Queuing+Service+Instances 
DevOps will review and merge.

 
                1.21.12.1.4 CEP Activation – Add Message Queue to CDM Store
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631 
 
Code for batch operations. Call events code – 3 PDs
Snapshot, import APIs. Pass changed entities IDs. Logic of delta update. – 3 PDs
DAO – 5 PDs
REST – UT – 4 PDs
Wire Solace to Store + write Solace event transmitter impl – 6 PDs
21 PDs
Started in T11
Rest API implementation is included in this BLI

PRs: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/710
 
 
                1.21.12.1.5 Mass Content – POC (resilience)
                https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2712
Performant iLike index test in scale – 3 PDs
Research possible limitations – 2 PDs 
consider separate table, MD5 + three properties (id, title, desc) – 2 PDs
mini design – 1 PD
8 PDs
Soft commit

design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Mass+content+search+on+master+language+-+Server+side


                1.21.12.1.6 [Supportability] Transport service - enhance errors & logging
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2305 

                1.21.12.1.7
 

            1.21.12.2 External BLIs

            1.21.12.3
        1.21.13 T13

            1.21.13.10 Signoff
Team Capacity 57PDs
Tasks:
Support – 19PDs
[ Customer Bug ] Support optional relation between roles and catalogs/groups - Design + POC. Hard commit.
Where Toggle (role-group indirect relation on/off) - 1 PDs
stop conditions - 2 PDs
Consider R→G when Group has no apps belonging to role - 1 PDs
Design - 6 PDs
Guy, Ariel , PoC will not help in design better off to start implementing after design
10 PDs

Preplanning - 5PDs
CEP Activation -  Solace Service Instance Provisioning. follow up on  Frishberg Barak, Oren BLI Queue Messaging - Service Instance Provisioning
Verify CI tests work - 1PD
Escalate spaces solace to Ilan, target at least one space for shared usage - 1 PDs
CEP activation - message Queue integration ( Activation service and Navigation ) - support other teams. 5 PDs
Total: 7PDs
Determine max page size for activation - Perform  measurement tests - 5 PDs. Margieh, Jawad
Need support from Ben Simhon, Shlomi
Total: 5PDs
SRE:
Check every app has implemented "is_alive" API and exposed it in the technical support (transp/exp/imp/ort). ( SRE )  - SRE: Check app "is_alive" API. 1PD
[Mass Content] Compliant Backend Search - Imp
create search table and trgrm index - 3 PDs 
write new queries + DAO + Service - 10 PDs 
Update all our APIs - 5 PDs
drop FTS tables - 1 PD
cleanup FTS code - 3 PD
design + test scope - 3 Pls
Integration with client - 5 PDs
30 PDs 
Eng : Refactoring CDM service - 9PDs 

New/Leftovers:  

BLI Dependencies in other teams UX InfoDev DevOps Perf.  Estimated Effort Comments / Action items
CEP Activation - Add Message Queue to CDM Store 	Devops - Queue Messaging - Service Instance Provisioning Yes	IT - verify all existing scenario. 5 PDs
Tests on space - 3 PDs 
cap aggregation per msg - 3 PDs
asyncapi - 5 PDs
Total:
16 PDs
Continue from T12. Hard commit.


Support Sergey's team with - Business Application Variant - Extend CDM client	
Extend CDm client to support
Impl getEntityFull to return 3 parts of the entity. Use search API for ID. remove merge flag. Always return base, entity, merged, (could be empty) - 5 PDs
getEntityRelations -  support extend relation - 1 PD
test scope - 1PD
7 PDs

[Supportability] Transport service - enhance errors & logging	

            1.21.13.11 Scrum-of-scrums 

                1.21.13.11.1 21/12/21 13:28:10  

                1.21.13.11.2

            1.21.13.2 BLI https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2753 - is_alive
Sheli
Check every app has implemented "is_alive" API and exposed it in the technical support (transp/exp/imp/ort). ( SRE )  - SRE: Check app "is_alive" API. 1PD
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-technical-support/pull/333 
<URL:/Users/I500695/work/SAP/PRs/technical_support/is_alive_sheli>

check on LTS: https://portal-cf-technical-support-ar-lts.cfapps.sap.hana.ondemand.com

Clicking on Health Check -> is_alive -> can see the three services added: transport, import, export.

request:
curl 'https://portal-cf-technical-support-ar-lts.cfapps.sap.hana.ondemand.com/healthcheck/is_alive?_=1640601372656' \
  -H 'Connection: keep-alive' \
  -H 'Accept: */*' \
  -H 'x-csrf-token: ' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'X-Requested-With: XMLHttpRequest' \
  -H 'sec-ch-ua-platform: "macOS"' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Referer: https://portal-cf-technical-support-ar-lts.cfapps.sap.hana.ondemand.com/' \
response:
{"broker":{"status":"available"},"site_service":{"status":"available"},"site_service_storage":{"status":"available"},"portal_personalization":{"status":"available"},"static_resources_proxy":{"status":"available"},"site_configuration":{"status":"available"},"activation_service":{"status":"available"},"dts":{"status":"available"},"cdm_store_service":{"status":"available"},"odata_service":{"status":"available"},"provisioning-service":{"status":"available"},"semantic_service":{"status":"available"},"dt_static_resources":{"status":"available"},"transport_service":{"status":"available"},"export_service":{"status":"available"},"import_service":{"status":"available"},"launchpad":{"status":"available"},"launchpad-dt":{"status":"available"},"portal":{"status":"available"},"portal-dt":{"status":"available"},"workzone":{"status":"available"},"workzone-dt":{"status":"available"},"workzonehr":{"status":"available"},"workzonehr-dt":{"status":"available"}}

            1.21.13.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2754 - support (optional) indirect and direct relations

                1.21.13.3.1 general information


Jawad
design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2745647864
PRS:
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/201
<url:/Users/I500695/work/SAP/PRs/cdm_store_client/Roletocatalogandgrouprelations>

migration guide: https://wiki.wdf.sap.corp/wiki/display/CPPortals/New+Roles+to+Groups+and+Catalogs+Relations+-+Migration+Execution+Plan

Migration toggle: NEW_ROLES_RELATIONS_MIGRATION_TOGGLE
provider toggle: /cdm/payload/providerMetadata/enableRolesToGroupsAndCatalogsResolving

Margieh, Jawad:
I already extended the mock-provider to support relations from role to groups and catalogs
Need to extend it to support workspaces and workpages as well. PR: https://github.wdf.sap.corp/i324180/cdm-mock-provider/pull/5/files


                1.21.13.3.2 migration code 
<url:/Users/i500695/work/SAP/PRs/cdm_store/Support_relations_from_role_to_group_catalog>
<url:/Users/i500695/work/SAP/PRs/cdm_store/Support_relations_from_role_to_group_catalog_migration>

                1.21.13.3.3
            1.21.13.4 CEP Activation – Add Message Queue to CDM Store https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631
id=CEPActivationAddMessageQueuetoCDMStore__
design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+CDM+store+service+Runtime+support+-+Detailed+design
Jawad's design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+CDM+Store+Service+-+OData+Layer+Support
Gap re. Apollo provider content: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+CDM+Store+Service+-+OData+Layer+Support#id-[CEP]CDMStoreServiceODataLayerSupport-ApolloProvider&HTML5providercontentupdate

RT design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+Runtime+support+for+CEP
Adam, Gil

PRs:
ayncapi schema , https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/720
get entity with relations cdm-store-client: https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/203

            1.21.13.5 Support Sergey's team with - Business Application Variant - Extend CDM client	
Hadar
Extend CDm client to support
Impl getEntityFull to return 3 parts of the entity. Use search API for ID. remove merge flag. Always return base, entity, merged, (could be empty) - 5 PDs
getEntityRelations -  support extend relation - 1 PD
test scope - 1PD

        1.21.14 [Mass Content] Compliant Backend Search - Imp
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2755

PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/724

        1.21.15 Determine max page size for activation - Perform  measurement tests - 5 PDs. Margieh, Jawad
        task: https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2818
wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/cdm-store-service+get+site+pagination+max+pageSize+upper+boundary+testing
pr: https://github.wdf.sap.corp/Portal-CF/cf-gatling/pull/145
<url:/Users/I500695/work/SAP/PRs/cf_gatling/jawad_get_site_entities_max_page_size>
        1.21.16 related 
CEP activation - phase 2 - federated content + integration with Solace: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2746196140

        1.21.17 [ENG] CDM Store refactor -kickstart
https://jira.tools.sap/browse/EUXTEAMSAAR-2768

design:  https://wiki.wdf.sap.corp/wiki/display/CPPortals/CDM-Store+refactor+steps

        1.21.18
    1.22 2022

        1.22.1  T01 

            1.22.1.1  BLIs and tasks
Here is our commitment for Takt 2201 - Team Capacity  - 62 PDs
See below list of candidates for T12 (prioritization may change depending on the effort estimation). If anything is missing, please let me know.
Support – 19PDs

Tasks:

CEP activation - message Queue integration ( Activation service and Navigation ) - support other teams. 3 PDs

                1.22.1.1.1 Apollo, DTS and Developer SCENARIOS  Handover
-> E2E distribution
Hi,

Sergey me decided to distribute the automation between us as follows:

EP-CPP-CF-DEV will stay unchanged, @Alhazov, Sergey and @Izaq, Yosi will monitor it, we will need to update the Apollo component default assignee in Jira each takt
EP-CPP-CF-ASD component will be replaced by 3 new components:
EP-CPP-CF-DTS (DTS) @Izaq, Yosi
Nadav's automation was divided as following:
Hosted content provider - @Izaq, Yosi
Embedded content provider - @Izaq, Yosi
Apollo Existing - @Alhazov, Sergey
Apollo Existing Old UI5 - @Alhazov, Sergey
Apollo Integration - @Alhazov, Sergey
HTML5 New - @Izaq, Yosi
 

Thanks!

Sergey & Yosi

From: "Magarill, Zhenia" <zhenia.magarill@sap.com>
Date: Sunday, 30 January 2022 at 12:29
To: "Adoram, Nili" <nili.adoram@sap.com>, "Shefer, Shany" <shany.shefer@sap.com>, "Fainer, Yuval" <yuval.fainer@sap.com>, "Haviv, Tal" <tal.haviv@sap.com>, "Arbibe, Benjamin" <benjamin.arbibe@sap.com>, "Izaq, Yosi" <yosi.izaq@sap.com>, "Alhazov, Sergey" <sergey.alhazov@sap.com>, "Tito, Meni" <meni.tito@sap.com>, "Katan, Yael" <yael.katan@sap.com>, "Avrahami, Olga" <olga.avrahami@sap.com>, "Moneta, Inbal" <inbal.moneta@sap.com>, "Openhaim, Shiri" <shiri.openhaim@sap.com>
Cc: "Guy, Ariel" <ariel.guy@sap.com>
Subject: RE: Review Flow Ownership
 
Hi all,

 

Please see below the decisions that were taken 😊

EP-CPP-CF-DEV will stay unchanged, @Alhazov, Sergey and @Izaq, Yosi will monitor it, we will need to update the Apollo component default assignee in Jira each takt
EP-CPP-CF-ASD component will be replaced by 3 new components:
EP-CPP-CF-ASR (activation, static resources) @Adoram, Nili
EP-CPP-CF-SSR (site service) @Shefer, Shany
EP-CPP-CF-DTS (DTS) @Izaq, Yosi
 

Nadav's automation was divided as following:
Hosted content provider - @Izaq, Yosi
Embedded content provider - @Izaq, Yosi
Apollo Existing - @Izaq, Yosi @Alhazov, Sergey
Apollo Existing Old UI5 - @Izaq, Yosi @Alhazov, Sergey
Apollo Integration - @Izaq, Yosi @Alhazov, Sergey
HTML5 New - @Izaq, Yosi
HTML5 Existing  - @Shefer, Shany
Nadav APIs - @Adoram, Nili @Shefer, Shany
 

Actions Items:

Split Nadav APIs between Nili and Shani
HTML5 new and existing currently use the same test content – split the content between Yosi and Shani
@Adoram, Nili additional HO sessions for Yossi and Sergey will be required for suites 1-5 in the automation list above
Thanks and Best Regards,

Zhenia
->
                sessions. 1 day for prep. 1 day for HO. 1 Days for practice and learning. 15 PDs
HO agenda: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Developer+Story+HO+2022-01-03
Demo of Apollo provider
Demo of HTML5 provider
How do customers build an mtar
Content deployer vs GACD
Going over architecture general flow and design of DTS: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2026292928
Each content provider flow.
Integration with FDC (+ approuter extensions)
Optional going over different design (Assaf’s Wiki – architecture + designs)
DTS code review
Common problems, how to investigate customer tickets
Automation
WEB-IDE / BAS code
WEB-IDE extensions
BAS Extensions
Flp-generator

                1.22.1.1.2 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2755 SRE: [Mass Content] Compliant Backend Search - Imp  -  Cohen, Adam

write new queries + DAO + Service – 8 PDs 
Update all our APIs - 5 PDs
cleanup FTS code - 1 PD
test scope - 1 PDs
Integration with client - 5 PDs
21 PDs Total (7 PDs by capacity)

                1.22.1.1.3 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2820 [ENG] CDM Store refactor 2 
recording: https://sap-my.sharepoint.com/:v:/p/yosi_izaq/EXgPbdaz-lZCtZ586qWbtqMB3_ltN_aKQhvXUsArpAESHQ
design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2762859266
CQRS_Transactional_Outbox_Architecture_OR_API_Gateway_for_CDM_Store_Service
use bramble as graphql federator: https://github.com/movio/bramble


                1.22.1.1.4 https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2631
<url:#r=CEPActivationAddMessageQueuetoCDMStore__>

                1.22.1.1.5 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation
https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2793
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/727 
<url:/Users/I500695/work/SAP/PRs/cdm_store/Support_relations_from_role_to_group_catalog>
Test-Scope: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161


                1.22.1.1.6 [ENG] Regular update of OSS and 3rd party versions https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2819


                1.22.1.1.7 

                1.22.1.1.8
            1.22.1.2 related

                1.22.1.2.1 [DR] Activation Supporting group/catalog role optional relation
<url:/Users/i500695/work/SAP/documents/DRs/Activation_Supporting_group_catalog_role_optional_relation>
recording: https://sap-my.sharepoint.com/:v:/p/tal_haviv/EQ7TNH6GWRlBmocqHW73C-cB4-oDpt2gqne_cWTgye9G9g
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2789672254
                1.22.1.2.2


            1.22.1.3 retro
       retro T12+T13 https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2756198196
T12+T13 2011 Retrospective

Date	23/11/2021 
Participants	Cohen, AdamIzaq, Yosi  Kobi, Hadar Shikva, Gil,  Margieh, Jawad

OKRs
•	Improve two collaboration behaviors - small commits?- estimated time for review? schedule 1:1 PR CR meetings? 
o	very small commits didn't work for us. we try to keep the commits as small as possible
o	 For large PRs either the author or reviewer/s will schedule 1:1 PR CR meeting.
o	 Estimated time for review. Doesn't seem important/make a difference.
•	reduce context switches. meetingless day? -or daily slot? 
o	Kobi, Hadar , Margieh, Jawad , Cohen, Adam one day block
o	Shikva, Gil abstain 
•	place holder (all can add ideas)
Retrospective

What did we do well?
•	Kobi, Hadar, we are having discussions on point (ענייניים), focused daily
•	Kobi, Hadar, ordered approach to handle our tasks and interruptions
•	Cohen, Adam,   Devops, CI, automations more stable

What should we have done better? 
•	Cohen, Adam, cross functions (PO/QPE) should not be part of technical discussions. We should attempt to limit scope of meetings to relevant people only. +3



Actions
•	 Izaq, Yosi, decide dev duty model
•	 Izaq, Yosi, add Boris transport E2E to post deployment, on/off boarding. WIP
•	Cohen, Adam, ask devops for periodic re-trigger of our masters - for example every Sunday. there are problems preventing it from happening.
•	 Margieh, Jawad, check if git Bot can push empty commit 
•	Cohen, Adam, check if we can use an update version bot

            1.22.1.4
        1.22.2  T02 

            1.22.2.1   signoff
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2202+signoff

            1.22.2.2  [ENG] test and build using docker
dev: Gil
https://jira.tools.sap/browse/EUXTEAMSAAR-2851
prs: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/551/files 
<url:/Users/i500695/work/SAP/PRs/transport/testandbuildusingdocker>
https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/76/files

docker-compose.yml:
version: '3.7'
services:

  cdm-export-service:
    build: .
    container_name: cdm-export-service
    command: /bin/bash
    environment:
      - NODE_ENV=dev
      - TS_NODE_TRANSPILE_ONLY=true
      - TS_NODE_FILES=true
      - REDIS_HOST=redis
      - LOCAL_MODE=true
      - PGUSER=I_USER
      - PGPWD=Abcd1234
      - PGDBNAME=I_USER
      - PGHOST=postgres
      # https://github.com/TypeStrong/ts-node/issues/754
    stdin_open: true
    tty: true
#    ports:
#      - 3003:3000
#      - 9229:9229
    depends_on:
      - redis
      - postgres
    volumes:
      - ./:/apps


dockerfile:
FROM node:14-alpine
 RUN apk add --no-cache bash
 VOLUME /app
 WORKDIR /app
 #COPY . /app
 #RUN npm install
 #RUN npm dedupe
 CMD ["/bin/bash"]



            1.22.2.3 https://jira.tools.sap/browse/EUXTEAMSAAR-2853
https://jira.tools.sap/browse/EUXTEAMSAAR-2853
dev: Hadar, Sheli

            1.22.2.4 [Federation] Support optional relation between roles and catalogs/groups - CDM store implementation 
https://jira.tools.sap/browse/EUXTEAMSAAR-2793
E2E
dev: Jawad

                1.22.2.4.1 QA day

                    1.22.2.4.1.1  email thread


Hi,
This was decided by PO back then. (Tamar in 2018)
If admin deliberately wants empty groups ,he should see them…
 
Change of this decision is always possible, but PO need to define it.
 
Thanks,
Tal
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Thursday, February 17, 2022 1:03 PM
To: Arbibe, Benjamin <benjamin.arbibe@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Avrahami, Olga <olga.avrahami@sap.com>; Alhazov, Sergey <sergey.alhazov@sap.com>; Haviv, Tal <tal.haviv@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>
Subject: Re: Content providers for running test scope
 
Adding @Haviv, Tal back 😊
 
From: "Izaq, Yosi" <yosi.izaq@sap.com>
Date: Thursday, 17 February 2022 at 13:02
To: "Arbibe, Benjamin" <benjamin.arbibe@sap.com>, "Margieh, Jawad" <jawad.margieh@sap.com>, "Avrahami, Olga" <olga.avrahami@sap.com>, "Alhazov, Sergey" <sergey.alhazov@sap.com>
Cc: "Guy, Ariel" <ariel.guy@sap.com>
Subject: Re: Content providers for running test scope
 
Hi Benji,
 
On the one hand this is how it works so far so its WAD, not a bug. (BTW- Is this difference documented?)
On the other hand, I don’t understand why it was decided this way- I mean, why groups w/ 0 tiles/links in payload are filtered out but totally empty groups (who technically also have 0 tiles/links) are not.
Do you have an idea as to why?
 
10x!
Yosi
 
From: "Arbibe, Benjamin" <benjamin.arbibe@sap.com>
Date: Thursday, 17 February 2022 at 12:47
To: "Margieh, Jawad" <jawad.margieh@sap.com>, "Avrahami, Olga" <olga.avrahami@sap.com>, "Alhazov, Sergey" <sergey.alhazov@sap.com>
Cc: "Guy, Ariel" <ariel.guy@sap.com>, "Izaq, Yosi" <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope
 
Hi Jawad,
 
Yes – initially empty group (meaning saved in the site.json as empty) are not being filtered since always. Not sure what was the reason back then (2019 +-)
 
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service/blob/master/src/utils/permissions-filter-utils.js#L670
 
Best,
Benji
 
From: Margieh, Jawad <jawad.margieh@sap.com>
Date: Thursday, 17 February 2022 at 11:39
To: Arbibe, Benjamin <benjamin.arbibe@sap.com>, Avrahami, Olga <olga.avrahami@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Even though the group is empty?
Which service is responsible of filtering out empty groups/catalogs?
 
From: Arbibe, Benjamin <benjamin.arbibe@sap.com>
Date: Thursday, 17 February 2022 at 12:36
To: Margieh, Jawad <jawad.margieh@sap.com>, Avrahami, Olga <olga.avrahami@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Rergarding test 3
 
As the group is under the authorizations sections in the correct role – we are showing this.
 

 
I believe we should see why this is the data that is getting saved.
 
Best,
Benji
 
From: Margieh, Jawad <jawad.margieh@sap.com>
Date: Thursday, 17 February 2022 at 11:23
To: Arbibe, Benjamin <benjamin.arbibe@sap.com>, Avrahami, Olga <olga.avrahami@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Hi,
 
https://saartest.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites?roleRelation=true#Site-Directory?sap-app-origin-hint=
 
Sites:
site: test_10
provider: test_10
 
site: test_case_3
provider: test_case_3
 
Thanks,
Jawad
 
From: Arbibe, Benjamin <benjamin.arbibe@sap.com>
Date: Thursday, 17 February 2022 at 12:06
To: Margieh, Jawad <jawad.margieh@sap.com>, Avrahami, Olga <olga.avrahami@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Hi Jawad,
 
Do you have the Sites for the CDM Content in those mock test?
 
Best,
Benji
 
From: Margieh, Jawad <jawad.margieh@sap.com>
Date: Thursday, 17 February 2022 at 10:13
To: Avrahami, Olga <olga.avrahami@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>, Arbibe, Benjamin <benjamin.arbibe@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Adding @Alhazov, Sergey & @Arbibe, Benjamin
 
From: Margieh, Jawad <jawad.margieh@sap.com>
Date: Thursday, 17 February 2022 at 10:57
To: Avrahami, Olga <olga.avrahami@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

Hi,
 
Wiki updated with the test results for the mock provider.
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161
 
I ran 7 Test cases.
 
Conclusions:
2 test cases failed – I provided info on each.
Switching the toggle ON/OFF does not activate the affected sites.
 
 
Thanks,
Jawad
 
From: Avrahami, Olga <olga.avrahami@sap.com>
Date: Wednesday, 16 February 2022 at 21:35
To: Margieh, Jawad <jawad.margieh@sap.com>
Cc: Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: Re: Content providers for running test scope

 
Thank you, Jawad! 
 

On 16 Feb 2022, at 20:46, Margieh, Jawad <jawad.margieh@sap.com> wrote:

 
Hi,
 
Content updated.
 
Thanks,
Jawad
 
From: Avrahami, Olga <olga.avrahami@sap.com>
Date: Wednesday, 16 February 2022 at 19:45
To: Margieh, Jawad <jawad.margieh@sap.com>, Guy, Ariel <ariel.guy@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: RE: Content providers for running test scope

Hi,
 
Test scope is updated with everything we discussed today & landscape info.
 
@Margieh, Jawad – as we discussed, could you create update mocks for TC2 and TC9.
 
Also, I've aligned with Shany and she will make sure that SiteService Unit Tests covers test cases mentioned here.
 
We still have one open question about ownership of the E2E automation scenario.
 
Thank you,
Olga
 
 
 
From: Margieh, Jawad <jawad.margieh@sap.com> 
Sent: Wednesday, February 16, 2022 3:29 PM
To: Avrahami, Olga <olga.avrahami@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>
Subject: Content providers for running test scope
 
Hi,
 
I updated the Test scope documents with urls to the content providers for each test case.
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161
Can you please provide a URL for the cockpit where I can create a destinations for the content providers?
And add me as an administrator on the subaccount.
 
Thanks,
Jawad

                1.22.2.4.2 Test-Scope
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161
Prerequisite:
Understand the new toggle purpose:

Enable toggle this feature to include only groups and catalogs that have been directly assigned to the roles that the user is assigned to. 
Choose this option to prevent groups and catalogs that have not been directly assigned to the roles that the user is assigned to from being displayed at runtime. 
 
Disable toggle this feature to include all  groups and catalogs that have been assigned to the apps that have been directly assigned to the roles that the user is assigned to. 
Choose this option if all groups and catalogs assigned to the roles apps are required in your runtime site. 

Create content according TC1-9 flowcharts
Expose real S/4 content 
Use Toggle: roleRelation=true
Landscape for Manual: Saar Test , https://saartest.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites#Content-Manage?sap-app-origin-hint=&/

mock-content destination:
https://mock-provider-test-1.cfapps.sap.hana.ondemand.com/mock_provider/backend/sap/bc/ui2/cdm3/entities/

                1.22.2.4.3
            1.22.2.5 [SRE] backend search - migration  
https://jira.tools.sap/browse/EUXTEAMSAAR-2868
mock content
execution plan
Validations. LTS/RCT.
Migration report
migration procedure
create MV
use offset (not seek) pagination
Corner cases, failures handling

wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/backend+search+migration+-+execution+plan

            1.22.2.6 EUXTEAMSAAR-2846 [Federation] Support optional relation between roles and catalogs/groups - Migration of existing content
bli: https://jira.tools.sap/browse/EUXTEAMSAAR-2846
PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/768/files
set in manifest-concourse:
NEW_ROLES_RELATIONS_MIGRATION_TOGGLE: true

https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/766
<url:/Users/i500695/work/SAP/PRs/cdm_store/Support_relations_from_role_to_group_catalog_migration>

wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/New+Roles+to+Groups+and+Catalogs+Relations+-+Migration+Execution+Plan

            1.22.2.7 EUXTEAMSAAR-2816 Message queuing capacity planning
Jawad
repo: https://github.wdf.sap.corp/i324180/amqp-publisher-consumer 

global services add solace: https://github.wdf.sap.corp/Portal-CF/portal-global-services/pull/246
From e8a9a11a7e21f8977c2fb2c5f90ced3be0e2799e Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 13 Dec 2021 13:27:53 +0200
Subject: [PATCH 1/2] Adding message queuing service

---
 manifest-concourse.yml | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/manifest-concourse.yml b/manifest-concourse.yml
index 6e55b78..411f36c 100644
--- a/manifest-concourse.yml
+++ b/manifest-concourse.yml
@@ -178,7 +178,14 @@ service_instances:
   - instance_name: portal-postgresql-nav
     service: postgresql
     plan: (( valid(.context.config.cf.portal-postgres-nav) ? .context.config.cf.portal-postgres-nav :"v9.6-small" ))    
-    skip: (( env("HYPERSCALER_POSTGRES_ENABLED") == "true" ? true :false ))    
+    skip: (( env("HYPERSCALER_POSTGRES_ENABLED") == "true" ? true :false ))
+  - instance_name: portal-message-queuing
+    service: message-queuing
+    plan: standard
+    options:
+      - arg_key: -c
+        arg_val: (( asjson(.metadata.message-queuing) ))
+    #skip: (( env("LANDSCAPE_ENVIRONMENT") == "dev" ? true :false ))
 user_provided_service_instances:
   - instance_name: workzonehr-dc-mapping
     options:
@@ -235,3 +242,7 @@ metadata:
     gcp: gcs-standard
     openstack: oss-standard
     ali: oss-standard
+  message-queuing:
+    sourceIPs: 0.0.0.0/0
+    resources:
+      units: (( env("LANDSCAPE_ENVIRONMENT") == "dev" ? 100 :200 ))

From 701725581897d67d0a644fd578a023386aa3a42b Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Mon, 13 Dec 2021 13:52:42 +0200
Subject: [PATCH 2/2] Update manifest-concourse.yml

---
 manifest-concourse.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/manifest-concourse.yml b/manifest-concourse.yml
index 411f36c..78fd56c 100644
--- a/manifest-concourse.yml
+++ b/manifest-concourse.yml
@@ -245,4 +245,4 @@ metadata:
   message-queuing:
     sourceIPs: 0.0.0.0/0
     resources:
-      units: (( env("LANDSCAPE_ENVIRONMENT") == "dev" ? 100 :200 ))
+      units: (( env("LANDSCAPE_ENVIRONMENT") == "dev" ? "100" :"200" ))



            1.22.2.8
        1.22.3  T03 

            1.22.3.1  [Federation] Implement an encoding and decoding logic for role IDs - research and design	 - https://jira.tools.sap/browse/EUXTEAMSAAR-2907

                1.22.3.1.1  background


[Federation] Implement an encoding and decoding logic for role IDs - https://jira.tools.sap/browse/EUXTEAMSAAR-2882
[Federation] Handle special characters in Transport service for Role IDs - 

https://wiki.wdf.sap.corp/wiki/display/CPPortals/Handle+special+characters+for+role+IDs 

                1.22.3.1.2 Risks+HLEE for implementation on launchpad
Risks:
•	The requirement for encoding decoding in the launchpad services has negative affect on LP scalability. Reason being:
o	it adds complexity in multiple points (transport, role mapping service, RT, UI) 
o	introduces coupling between services and 
o	sets a precedence for other content providers to request support of additional, possibly different, unsupported charters.
•	changing the role id (encoding) makes it harder to associate with the original role
•	encoding requires extra characters and consumes from max length limitation
•	If we allow provisioning of content with unsupported chars from content providers, for product consistency we should allow it in our UI as well. In general encoding/decoding would be required at every future ingress/egress points to/from LP.  
•	Add more divergence between portal schema and core schema
•	according to Helge’s email response, there might be another customers who created roles with another special characters that we do not support. Hence we will need to add them to the schema in the future and modify our code accordingly. 
•	Clashes with requirements of EP as content provider. Specifically, b/c they need to trim long role IDs to only 228 characters. In combination with adding the unsupported chars to core schema (which requires extra characters for encoding in LP) may exceed XSUAA limitation on role ID length of 255 chars. As long as EP does not comply with the core schema (70 chars limit on role ID len) or can assure that unsupported chars will never be used.

HLEE 
Fix portal schema for role entity 	we shouldn't accept '/' in our portal schema for roles - S
Extend core schema for role entity Role id  in the core schema should also accept ‘&()=,:;<>?’	- S
Implement an encoding and decoding logic for role IDs encoded ID should remain human readable, including "/"	Izaq, Yosi , encoding/decoding in a central place (shared lib or nestjs-commons) - M
Use encoding logic in transport service before persisting roles to snapshot  - S
Use encoding logic in role Mapping service on received roles from IAG/IPS - S
Use decoding logic in role Mapping Service on roles ID before sent to IAG - S
integration and E2E validations - M (S for at least 2 teams)
content for E2E Automations + more TCs - S-M
Total: 2L+M - 2L+M+S 

            1.22.3.2 EUXTEAMSAAR-2842 Enabling Transport of "Save As Local" applications
https://jira.tools.sap/browse/EUXTEAMSAAR-2842

PRs:
https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/62

            1.22.3.3 EUXTEAMSAAR-2305 [Supportability] Transport service - enhance errors & logging 
design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2762062759
Table of errors been added to the design
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2762062759#id-[Supportability]Transportserviceenhanceerrors&logging-errormappingtable
Test-Scope: 
PRs: 
            1.22.3.4 EUXTEAMSAAR-2843 [CEP: Federated HTML5) DTS move from batch API to import API
design: 
Test-Scope: 
prs:
https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/66

https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/30859375MB

            1.22.3.5 EUXTEAMSAAR-2903 [ENG] upgrade node version
prs:
wiki: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Main+Features+Node.js+16

            1.22.3.6
        1.22.4  T04 

            1.22.4.1  [CEP] RT API - Services Productization
https://jira.tools.sap/browse/EUXTEAMYAEL-1387

                1.22.4.1.1  design :[CEP] CEP Content API - Services Productization

                1.22.4.1.2 

            1.22.4.2 product support workshop

                1.22.4.2.1 task, https://jira.tools.sap/browse/EUXTEAMSAAR-2969

                1.22.4.2.2

9/05 
General topics – Zhenia – 30 mins
Troubleshooting and OPS topics – @Wimmer, Boaz/@Profesorsky, Run/@Malekan, Yael - 1.5 hrs
 
10/05
Mobile Start, Enterprise Search, Flex Overview - @Adoram, Nili – 30 mins
Work zone troubleshooting – @Adoram, Nili – 45 mins
Developer scenario Troubleshooting – @Adoram, Nili  - 45 mins – Yosi and Sergey believe that the best person to provide this session is Tal
 
11/05
Transport content items and direct role relation overview - @Izaq, Yosi – 10 mins 
DTS, CDM, PRV, RCP, TR troubleshooting  - @Izaq, Yosi – 30 mins
Auto-sync content providers and app editor enhancements - @Alhazov, Sergey – 10 mins
SEM, URL templates, BCI troubleshooting (should include) - @Alhazov, Sergey – 50 mins 
SRB, SSR, HAV, NCT, PER, Neo troubleshooting  - @Shefer, Shany – 30 mins

            1.22.4.3 changing the current structure of workspace / workpage

                1.22.4.3.1 BLIs
support workspaces in CDM 3.2  (revised) - research and design  	- https://jira.tools.sap/browse/EUXTEAMSAAR-2967
support workspaces in CDM 3.2  (revised) - Schema changes - https://jira.tools.sap/browse/EUXTEAMSAAR-2962
workspaces in CDM 3.2  (revised) - Services adjustments - implementation - https://jira.tools.sap/browse/EUXTEAMSAAR-2963

                1.22.4.3.2

Hey,
Attached is the test scope for changing the current structure of workspace / workpage.
The change is to remove the workspace and change the workpage to be related to “space” entity instead of the “workspace” entity.
 
TS covers
Cdm-schema – changes to the entities
Cdm-store – adding possible relation from space to workpage
Transport – using the client to generate relations + resolving of workpage id inside space entity
Cdm-client – generation of the new relation between space and workpage
 
Link : https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2889657116

            1.22.4.4 Monitor features with Dynatrace.
https://jira.tools.sap/browse/EUXTEAMNILI-5611
design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Monitor+features+with+dynatrace+-+Design+Document
Background and Requirements
We were requested to provide information by Mobile start on how many customers turn on the Mobile start toggle in Site Settings.
Today it's impossible to get information about the usage of different features ( in site settings) by our product. Therefore we would like to add a dashboard in Dynatrace to extract data on the features.   

- portal-cf-site-configuration
Monitored Site features and their locations in ushell
site settinsg are located under ushellConfig of site.  under renderers.fiori2.componentData.config. sample ushellConfig:
{
    "defaultRenderer": "fiori2",
    "flpPlatform": "cFLP",
    "renderers": {
        "fiori2": {
            "componentData": {
                "config": {
                    "enableRecentActivity": false,
                    "enableSearch": false,
                    "enableUserDefaultParameters": true,
                    "rootIntent": "Shell-home",
                    "enableTilesOpacity": false,
                    "enablePersonalization": true,
                    "enableUserThemes": true,
                    "enableSetTheme": true,
                    "enableSetLanguage": true,
                    "enableHideGroups": true,
                    "enableActionModeMenuButton": true,
                    "enableActionModeFloatingButton": true,
                    "enableAutomaticSignout": true,
                    "sessionTimeoutIntervalInMinutes": 14,
                    "sessionTimeoutReminderInMinutes": 3,
                    "applications": {
                        "Shell-home": {
                            "enableTilesOpacity": false,
                            "enableActionModeMenuButton": true,
                            "enableActionModeFloatingButton": true,
                            "enableHideGroups": true
                        }
                    }
                }
            }
        }
    },
....

Create mapping file with the name of feature needed and its path in site entitiy ushell config
This will enable easily adding/removing additional features when needed with a single json file.
features-config-mapping.json:
{
    "enableSearch": "\"config\"->'enableSearch'",
    "enablePersonalization": "\"config\"->'enablePersonalization'",
    "enableRecentActivity": "\"config\"->'enableRecentActivity'",
    "enableSearch": "\"config\"->'enableSearch'",
    "enableUserDefaultParameters": "\"config\"->'enableUserDefaultParameters'",
    "enableTilesOpacity": "\"config\"->'enableTilesOpacity'",
    "enableUserThemes": "\"config\"->'enableUserThemes'",
    "enableSetTheme": "\"config\"->'enableSetTheme'",
    "enableSetLanguage": "\"config\"->'enableSetLanguage'",
    "enableHideGroups": "\"config\"->'enableHideGroups'",
    "enableActionModeMenuButton": "\"config\"->'enableActionModeMenuButton'",
    "enableActionModeFloatingButton": "\"config\"->'enableActionModeFloatingButton'",
    "enableAutomaticSignout": "\"config\"->'enableAutomaticSignout'"
}

- Collection of metrics - metricUtils.js
Add metric util class, that will:
periodically collect the feature counts and store locally in memory
integrate with opentelemtry with scheduler to periodically send info to dynatrace
As code runs with each instance, register the dynatrace feature count observers just for index 0 (no need to all instances to send data)
...
    //Read feature list mapping and build query from it
const    FEATURE_LIST = Object.keys(require('../resources/features-config-mapping.json'));
 
//Hold all counters for features
let siteFeaturesCounters
 
 
...
 
    async attachSiteFeatuersMetrics() {
        // Create dynatrace meters observers for each feature read from  siteFeaturesCounters 
        // inialize interval
    }
 
    sttic async updateLatestSiteFeaturesCounters() {
        // Make call to DB with matching SQL QUERY to collect all counters and save in  siteFeaturesCounters 
    }
}

- Query DB for feature - site-confgiuration-dao.js
create query based on mapping
const
    FEATURE_CONFIG_MAPPING = require('../resources/features-config-mapping.json'),
    FEATURE_SELECTS = buildFeatureSelects(FEATURE_CONFIG_MAPPING),
    QUERY_STRING_GET_SITE_FEATURES_COUNTERS = `SELECT COUNT(*)::int as "numberOfSites", ${FEATURE_SELECTS} FROM (SELECT ("SITE_CONFIGURATION_DATA"->'payload'->'config'->'ushellConfig'->'renderers'->'fiori2'->'componentData'->'config') AS "config" FROM "portal.cf::SiteConfiguration"."SITE_CONFIGURATION") AS "DATA" `;
//takes json of features (key and path of feature) and build a string count SQL query for all
function buildFeatureSelects(featureMappings) {
    return Object.entries(featureMappings).map(function (entry) {
        return `COUNT(*) FILTER (WHERE (${entry[1]})::bool)::int as "${entry[0]}"`;
    }).join(', ');
}
 
.....
//method  to perform the query
 async getSiteFeatureCounters(loggerCtx) {
Sample query created with list above:
SELECT COUNT(*)::int as "numberOfSites",
   COUNT(*) FILTER (WHERE ("config"->'enableSearch')::bool)::int as "enableSearch",
   COUNT(*) FILTER (WHERE ("config"->'enablePersonalization')::bool)::int as "enablePersonalization",
   COUNT(*) FILTER (WHERE ("config"->'enableRecentActivity')::bool)::int as "enableRecentActivity",
   COUNT(*) FILTER (WHERE ("config"->'enableUserDefaultParameters')::bool)::int as "enableUserDefaultParameters",
   COUNT(*) FILTER (WHERE ("config"->'enableTilesOpacity')::bool)::int as "enableTilesOpacity",
   COUNT(*) FILTER (WHERE ("config"->'enableUserThemes')::bool)::int as "enableUserThemes",
   COUNT(*) FILTER (WHERE ("config"->'enableSetTheme')::bool)::int as "enableSetTheme",
   COUNT(*) FILTER (WHERE ("config"->'enableSetLanguage')::bool)::int as "enableSetLanguage",
   COUNT(*) FILTER (WHERE ("config"->'enableHideGroups')::bool)::int as "enableHideGroups",
   COUNT(*) FILTER (WHERE ("config"->'enableActionModeMenuButton')::bool)::int as "enableActionModeMenuButton",
   COUNT(*) FILTER (WHERE ("config"->'enableActionModeFloatingButton')::bool)::int as "enableActionModeFloatingButton",
   COUNT(*) FILTER (WHERE ("config"->'enableAutomaticSignout')::bool)::int as "enableAutomaticSignout"
FROM (SELECT ("SITE_CONFIGURATION_DATA"->'payload'->'config'->'ushellConfig'->'renderers'->'fiori2'->'componentData'->'config') AS "config" FROM "portal.cf::SiteConfiguration"."SITE_CONFIGURATION") AS "DATA"
Any improvments for query appreciated.
Need to validate security of this query (all selects are hardcoded by us)
            1.22.4.5 Jawad architecture track

                1.22.4.5.1 PG encryption

                1.22.4.5.3 get site entities
[10:41] Margieh, Jawad
I am testing the get site with pagination
 like 1

[10:41] Margieh, Jawad
and I think the roles to group and catalogs relations

[10:41] Margieh, Jawad
should be removed

[10:41] Margieh, Jawad
We discussed that in the past

[10:42] Margieh, Jawad
and we colcluded that it does not matter whether we do it or not

[10:42] Margieh, Jawad
as long as the activation service knows how to handle this

[10:42] Margieh, Jawad
the get Site SQL with the roles to groups and relations logic takes around 16 seconds
EXPLAIN ANALYZE SELECT
    "CDM_ENTITIES"."entityMD5",
    "CDM_ENTITIES".cdm,
    baseEntities.cdm AS base_cdm,
    coalesce("CDM_ENTITIES"."updatedOn", baseEntities."updatedOn") AS "updatedOn",
    coalesce("CDM_ENTITIES"."entityTitle", baseEntities."entityTitle") AS "entityTitle",
    coalesce("CDM_ENTITIES"."entityDescription", baseEntities."entityDescription") AS "entityDescription",
    coalesce("CDM_ENTITIES"."entityId", baseEntities."entityId") AS "entityId",
    count(*) OVER () AS total_entities
FROM
    "CDM_ENTITIES"
        INNER JOIN ( WITH RECURSIVE recursive_relations AS (
        SELECT
            "entityMD5",
            "tenantId",
            'ref' AS "relationType"
        FROM
            "CDM_ENTITIES"
        WHERE
                "CDM_ENTITIES"."tenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
          AND "CDM_ENTITIES"."id" = 'be4d18e4-fb29-409f-b320-1f73d3fc0c75'
          AND "CDM_ENTITIES"."contextType" = 'site'
        UNION
        SELECT
            "RELATIONS"."toMD5",
            "RELATIONS"."toTenantId",
            "RELATIONS"."relationType"
        FROM
            recursive_relations
                INNER JOIN "RELATIONS" ON recursive_relations."entityMD5" = "RELATIONS"."fromMD5"
        WHERE
            NOT ("RELATIONS"."fromContextId" IN (
                SELECT
                    "entityId"
                FROM
                    "CDM_ENTITIES"
                WHERE
                        "tenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
                  AND "entityType" = 'provider'
                  AND "cdm" -> 'payload' -> 'providerMetadata' ->> 'enableRolesToGroupsAndCatalogsResolving' = 'true')
          AND (("RELATIONS"."fromEntityType" = 'businessapp'
            AND "RELATIONS"."toEntityType" = 'group')
            OR ("RELATIONS"."fromEntityType" = 'businessapp'
                AND "RELATIONS"."toEntityType" = 'catalog')))
                         AND NOT ("RELATIONS"."fromContextId" IN (
                            SELECT
                                "entityId"
                            FROM
                                "CDM_ENTITIES"
                            WHERE
                                "tenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
                                AND "entityType" = 'provider'
                                AND ("cdm" -> 'payload' -> 'providerMetadata' ->> 'enableRolesToGroupsAndCatalogsResolving' = 'false'
                                    OR "cdm" -> 'payload' -> 'providerMetadata' ->> 'enableRolesToGroupsAndCatalogsResolving' IS NULL))
                            AND (("RELATIONS"."fromEntityType" = 'role'
                                    AND "RELATIONS"."toEntityType" = 'group')
                                OR ("RELATIONS"."fromEntityType" = 'role'
                                    AND "RELATIONS"."toEntityType" = 'catalog')))
        )
SELECT
    "entityMD5",
    "tenantId",
    "relationType"
FROM
    recursive_relations) relations ON relations."tenantId" = "CDM_ENTITIES"."tenantId"
    AND relations."entityMD5" = "CDM_ENTITIES"."entityMD5"
    LEFT JOIN "RELATIONS" ON relations."entityMD5" = "RELATIONS"."fromMD5"
    AND "RELATIONS"."relationType" = 'extends'
    LEFT JOIN "CDM_ENTITIES" baseEntities ON baseEntities."entityMD5" = "RELATIONS"."toMD5"
WHERE
    relations."relationType" != 'extends'
  AND "CDM_ENTITIES"."tenantId" IN ( SELECT DISTINCT
    "toTenantId"
    FROM
    "RELATIONS"
    WHERE
    "fromTenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
  AND "fromContextId" = 'SUB_ACCOUNT'
  AND "fromContextType" = 'sub_account'
  AND "relationType" = 'extends'
    UNION
    SELECT
    'f28774264ab4e8a6c5a7987989e0daf8')
ORDER BY
    coalesce("CDM_ENTITIES"."entityMD5", baseEntities."entityMD5") DESC,
    "CDM_ENTITIES"."entityMD5"
    LIMIT 200

[10:43] Margieh, Jawad
without it takes 3 seconds.
EXPLAIN ANALYZE SELECT
    "CDM_ENTITIES"."entityMD5",
    "CDM_ENTITIES".cdm,
    baseEntities.cdm AS base_cdm,
    coalesce("CDM_ENTITIES"."updatedOn", baseEntities."updatedOn") AS "updatedOn",
    coalesce("CDM_ENTITIES"."entityTitle", baseEntities."entityTitle") AS "entityTitle",
    coalesce("CDM_ENTITIES"."entityDescription", baseEntities."entityDescription") AS "entityDescription",
    coalesce("CDM_ENTITIES"."entityId", baseEntities."entityId") AS "entityId",
    count(*) OVER () AS total_entities
FROM
    "CDM_ENTITIES"
        INNER JOIN ( WITH RECURSIVE recursive_relations AS (
        SELECT
            "entityMD5",
            "tenantId",
            'ref' AS "relationType"
        FROM
            "CDM_ENTITIES"
        WHERE
                "CDM_ENTITIES"."tenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
          AND "CDM_ENTITIES"."id" = 'be4d18e4-fb29-409f-b320-1f73d3fc0c75'
          AND "CDM_ENTITIES"."contextType" = 'site'
        UNION
        SELECT
            "RELATIONS"."toMD5",
            "RELATIONS"."toTenantId",
            "RELATIONS"."relationType"
        FROM
            recursive_relations
                INNER JOIN "RELATIONS" ON recursive_relations."entityMD5" = "RELATIONS"."fromMD5")
SELECT
    "entityMD5",
    "tenantId",
    "relationType"
FROM
    recursive_relations) relations ON relations."tenantId" = "CDM_ENTITIES"."tenantId"
    AND relations."entityMD5" = "CDM_ENTITIES"."entityMD5"
    LEFT JOIN "RELATIONS" ON relations."entityMD5" = "RELATIONS"."fromMD5"
    AND "RELATIONS"."relationType" = 'extends'
    LEFT JOIN "CDM_ENTITIES" baseEntities ON baseEntities."entityMD5" = "RELATIONS"."toMD5"
WHERE
    relations."relationType" != 'extends'
  AND "CDM_ENTITIES"."tenantId" IN ( SELECT DISTINCT
    "toTenantId"
    FROM
    "RELATIONS"
    WHERE
    "fromTenantId" = 'f28774264ab4e8a6c5a7987989e0daf8'
  AND "fromContextId" = 'SUB_ACCOUNT'
  AND "fromContextType" = 'sub_account'
  AND "relationType" = 'extends'
    UNION
    SELECT
    'f28774264ab4e8a6c5a7987989e0daf8')
ORDER BY
    coalesce("CDM_ENTITIES"."entityMD5", baseEntities."entityMD5") DESC,
    "CDM_ENTITIES"."entityMD5"
    LIMIT 200
[10:43] Margieh, Jawad
I have a database with 17M relations

[10:43] Margieh, Jawad
and 1M entities

[10:49] Margieh, Jawad
With the role to groups/cat handling

            1.22.4.6  role ID special characters BLIs
BLI updated
Schema changes: https://jira.tools.sap/browse/EUXTEAMSAAR-2964
Implantation : https://jira.tools.sap/browse/EUXTEAMSAAR-2984

special characters wiki - https://wiki.wdf.sap.corp/wiki/display/CPPortals/Role+ID+special+characters+in+launchpad+service+-+research+and+validation (Gil)
Role ID special characters in launchpad service - research and validation
Skip to end of metadata
Created by Shikva, Gil, last modified on Apr 28, 2022
Go to start of metadata
Motivation
Business role IDs in ABAP have special characters that are not supported in CDM Schema. Also some of these characters are not supported also in XSUAA and role editor. In order to overcome this issue, architects decided on an encoding \ decoding solution that will replace unsupported characters with supported characters before saving to CDM store. Also character set in core schema will be extended with additional characters for roles.



Validation
before we started we changed portal schema to support all characters

Federation With ‘&()=,:<>? characters

Create provider with Role with specials characters (as specified in the scope) → succeeded.
Roles are created and can be seen in the editors → we can see the roles in the provider editor and also create cherry picks from it.When trying to navigate to those roles we are getting some error in the UI client. (content manager UI).
Roles can be assigned to site → we assigned the role to a site. succeeded.
Role collections are created successfully on on the BTP cockpit → succeeded.
Role collections can be assigned to users via BTP cockpit. → can be assigned to a user only from the user UI screen - choosing a user and adding it a role collection.
RT site can be executed, role content is rendered in the site and apps can be executed. → runtime was seen with the apps.
Federation With ‘&()=,:<>?;\/% characters

Create provider with Role with specials characters (as specified in the scope) → succeeded.
Roles are created and can be seen in the editors → we can see the roles in the provider editor and we had an issue creating the create cherry picks.(cdm store service).When trying to navigate to those roles we are getting some error in the UI client.(content manager UI).
Roles can be assigned to site → we assigned the role to a site.
Role collections are created successfully on on the BTP cockpit → role collection were created via the cherry pick creation and were created successfully. you cannot create role collection via the cockpit UI.
Role collections can be assigned to users via BTP cockpit. → can be assigned to a user only from the user UI screen - choosing a user and adding it a role collection.
RT site can be executed, role content is rendered in the site and apps can be executed. → runtime was seen with the apps.
Manual integration ‘&()=,:<>?;\/% characters:

Create role with special characters via editors → client UI currently prevent creation with the above characters. We also tried calling directly to semantics service API and failed, apparently Encoding/Decoding when calling to cdm store service).
Assign app to role → succeeded.
Assign app to groups/catalogs → succeeded.
Assign role to site → succeeded.
Role collection is created in BTP cockpit
Assign user to role collection
Run the site, execute apps


Gaps
in order to support ;\/% - cdm store service need to do more changes.

basically to expose API with the entity id not as a path variable - there is security issues related for using \/ - https://backstage.forgerock.com/knowledge/kb/article/a59558448

also ;% causing 500 error from tomcat →

org.springframework.security.web.firewall.RequestRejectedException: The request was rejected because the URL contained a potentially malicious String "%25" (encoded %)
an option to resolve it will be to send the entity id as a query/request param.

            1.22.4.7 Subject: [SRE] Removing dependency in HTML5 Repository
https://jira.tools.sap/browse/EUXTEAMNILI-5703

Hi everyone,
 
As part of SRE effort, we reduced the dependency of Launchpad in HTML5 Repository.
As of 2204b, all HTML bootstrap static resources (such as javascript files) are directly loaded from Nginx.
From functionality perspective there is no change of course.
However, in case of an outage in HTML5 Repository (which has happened in the past), the customer site will still load as expected.
I would like to thank @Kandov, Reuven for leading this topic, as well as the entire team that was engaged to assist.
 
If you come across any issue that might be related to this change, please let me know.
 
Best regards,
Nili Adoram
Scrum Master | Cloud Portal


Motivation:  
The Launchpad runtime site has several dependencies on other services in order to populate the site content and provide functionality.        Currently unavailability of those services causes the site not to load which results in outage for customers.
We need to identify all dependencies that can affect RT site not to be loaded and define the behavior in case the service is unavailable.   
Scope:
In this BLI we should focus on the dependencies to HTML5 repo.  
Move our own static resources of the site from the HTML5 repo to a new micro service in our own responsibility. 
Design a way to mitigate the dependencies and allow site to load with missing functionality in case of a problem. i.e. providing information from cache. 
Provide a clear error message in case of missing functionality when micro service/html5 is down.  
Take into account the cache-busting- if something was updates cache token is changed and we need to go to the server to bring the updated content. 
Future plan and not part of the scope of this BLI 
 Allow the content to reside in CDN (AKAMAI)
            1.22.4.8 PG benchmark
https://github.wdf.sap.corp/i324180/postgres-benchmark
                1.22.4.5.4
            1.22.4.6  Node 16 upgrade - Sheli 

https://wiki.wdf.sap.corp/wiki/display/CPPortals/Transport+Service+-+upgrade+to+node+16
BLI: https://jira.tools.sap/secure/RapidBoard.jspa?rapidView=8499&view=detail&selectedIssue=EUXTEAMSAAR-2903
PRs:
https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/95
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/567
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/225



Steps executed:

Installed node 16 locally.

nestjs-commons: 

package.json:
Changed node engine to 16.0.0 
Changed "@sap/xsenv": "3.1.1" to "@sap/xsenv": "3.2.1" (support node 16)
Npm install - getting warnings on shared-lib unsupported engine:
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: 'portal-cf-shared-lib@6.11.0-20220206075959',
npm WARN EBADENGINE   required: { node: '^14.0.0' },
npm WARN EBADENGINE   current: { node: 'v16.14.0', npm: '8.3.1' }
npm WARN EBADENGINE }

npm run build - success
npm run test - success 
cdm-store-client:

npm run build - passes after adding to tsconfig.json: skipLibCheck": true. In order to ignore the express declarations. For some reason without it the build fails on Response type, that should be ignored since it is in the node_modules folder.
npm run test-local - passes successfully.
transport service

Changed engine to - 16.0.0
Changed buildpack to 1.7.67
Changed "@sap/xsenv": "3.1.1" to "@sap/xsenv": "3.2.1" (support node 16)
Changed nests-commons + cdm-store-client to point to the git branches - npm install failed - couldn’t find nestjs-common modules.
Reverted step 4 - took and built nests-commons, cdm-store-client branches locally. 
Transport-service - overrided the push_dir / node_modules / nests-commons, cdm-store-client with the dist folders + package.json.
Npm run push_dev


Tested sanity transport on my machine - transport uyz passes successfully.

CI and xmake should support node 16 in order to continue with the push to master.


            1.22.4.7
        1.22.5  T05 

            1.22.5.1  EUXTEAMSAAR-2940 Apollo: support FDC enhancement for search only return sap.app/type is application or card
https://jira.tools.sap/browse/EUXTEAMSAAR-2940

PRs: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/318/files

            1.22.5.2 EUXTEAMSAAR-2984 Role ID special characters in launchpad service- implementation
https://jira.tools.sap/browse/EUXTEAMSAAR-2984
add TC coverage: https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/pull/629

            1.22.5.3 Tal-Haviv EUXTEAMNILI-5895 - [SRE] Load runtime site with minimal dependencies-Destination service
Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BSRE%5D+Load+runtime+site+with+minimal+dependencies-Destination+service+-+Design+document

            1.22.5.4 EUXTEAMSAAR-2991 [ENG] Design.  Improvement to cdm-store tables
Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BEng.%5D+Improve+cherrypick+merging+strategy+-+Design+Document 
https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BEng.%5D+Improve+cherrypick+merging+strategy+-+Design+Document#id-[Eng.]ImprovecherrypickmergingstrategyDesignDocument-ProductImpact
            1.22.5.5
        1.22.6  T06 

            1.22.6.1 tags: Ariel-Tamam new architecture  
https://sap.sharepoint.com/:p:/t/portal-architecture/EURd_6tfqn9KsGGbKd1BniABFc6UyOQ2avOdA3amsmSt9w?e=VWzEJK&wdLOR=cA36074E1-AEFE-8849-A13F-53D75FD5A3CB


            1.22.6.2 tags: Multiple URL-Templates per Business-App
https://github.wdf.sap.corp/sap-shell/architecture-decision-records/blob/main/adr/1013-multiple-url-templates-per-business-app.md
During transport we will extend current implementation from single URL-template per bussiness-app to multiple 
so OOTB (Out-of-the-box) URL-Templates (stored in schema) require no processing 
custom URL-Templates (provided by content provider) we need to verify exist in content. If not, fail application save 
Also add provider id prefix to URL-Template id 

                1.22.6.2.1 readme.md

|   # 1013. Multiple URL-Templates per Business-App
|   
|   Date: 2022-05-16
|   
|   ## Status
|   
|   Accepted
|   
|   ## Context
|   
|   This ADR enables the CEP stack to fulfill new product requirements (e.g. MyHome) and addresses some shortcomings in the current way how content can be modelled.
|   
|   Since its introduction with CDM 3.0, the `targetAppConfig` of a BusinessApp refers to a [URL-template](https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FIORITECHP1-9472.md) which describes in a declarative way the URL through which the application can be launched (see [schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/AppDescriptor.extension.json)). 
|   
|   The semantics of the resulting URL and the ways how this URL can be used (e.g. embedded in an iFrame, standalone in new tab, or native mobile app) is currently derived from several factors:
|   
|   1. property `sap.integration/navMode` in `targetAppConfig` of a BusinessApp (see [JSON schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/AppDescriptor.extension.json#L47))
|   2. property `capabilities/navigationMode` of URL-template (see [JSON schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/urltemplate.json#L86))
|   3. URL-template name (see definition of native mobile apps in chapter 3.2 in [SDD CDM Runtime API V1.1.docx](https://sap.sharepoint.com/teams/CDMRuntimeAPIforSAPMobileStart/Shared%20Documents/General/SDD%20CDM%20Runtime%20API%20V1.1.docx))
|   
|   This approach has some short-comings:
|   
|   - It is not easy and error prone - both for the content provider as well as for the consumer - to control and determine how an app will be launched. For example, it's not easy to differentiate between _open a new tab with a shell and launch the app there embedded in an iFrame_ and _open a new tab and just launch the app-URL standalone as-is_.
|   - It is not possible to define multiple ways to launch the same app, e.g. offer embedded URL + standalone URL + native mobile URL(s). If several options are to be supported, the BusinessApp needs to be duplicated.
|   - It is not possible to launch the same app in different ways depending on the consumption context (e.g. launch embedded in cFLP, standalone in its own product shell for MyHome, or natively from SAP Mobile Start
|   
|   ## Decision
|   
|   To overcoming these limitations the usage of URL-templates gets extended.
|   
|   ### Launch semantics of URL-template
|   Today, the property `capabilities/navigationMode` of URL-template is defined as (see [JSON schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/urltemplate.json#L257)):
|   ```json
|               "navigationMode": {
|                 "type": "string",
|                 "enum": ["newWindow", "newWindowThenEmbedded", "embedded", "inplace", "explace"],
|                 "description": "Navigation mode of the target application. ('inplace'/'explace' were deprecated and exist only for compatibility)"
|               },
|   ```
|   
|   This is mixing two aspects which we will separate more clearly: 
|   1. Whether or not the app should be opened in a new tab/window  
|      This quality does not really depend on the semantics or technical capabilities of the URL-template but rather on the desired UX.  
|      We will therefore take this dimension out of the URL-template definition and solely let it be defined by the product and UX specifications of the consumption context. Content providers can still define a desired default behavior through `sap.integration/navMode` in `targetAppConfig` of a BusinessApp (see [JSON schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/AppDescriptor.extension.json#L47)).
|   
|   
|   2. The semantics of the resulting URL  
|      This will be defined through the values of the existing `capabilities/navigationMode` property of the URL-template. The underlying `enum` will be extended with the following values - each describing the capabilities of the resulting URL of this template:
|      - `standalone` - URL for an app that does not have any dependencies to the CEP/MyHome shell at runtime. The app typically runs within its own product shell. The app MUST NOT be launched through an iFrame owned by the CEP/MyHome shell, as it is not guaranteed that the app is iFrame-enabled and as the app can come with own shell visuals.
|      - `embedded` - URL for an app that can be launched in an iFrame owned by the CEP shell. That means, the apps MUST be enabled to run within an iFrame, it MUST NOT render any own shell UX elements which visually conflict with the surrounding shell, and it SHOULD adopt the shell [postMessage APIs](https://wiki.wdf.sap.corp/wiki/display/uxintegra/Application+Integration+APIs) to communicate with the surrounding shell.
|      - `native-iOS-install` - URL to install a native iOS app. 
|      - `native-iOS-launch` - URL to launch a native iOS app. 
|      - `native-Android-install` - URL to install a native Android app. 
|      - `native-Android-launch` - URL to launch a native Android app. 
|     
|      The remaining values will be deprecated and will internally map to the above values as follows:
|      - `newWindow` => `standalone`
|      - `newWindowThenEmbedded` => `embedded`
|      - `inplace` => `embedded`
|      - `explace`=> `standalone`
|   
|      If an app can provide a single URL which fulfills the semantics of more then one `capabilities/navigationMode` (e.g. `embedded` AND `standalone`), the list of supported values can be expressed through a new optional property `capabilities/navigationModes` which takes an array of the same `enum` type as discussed above. This avoids the duplication of nearly-identical URL-templates. **Note:** this simplification is only applicable if the other properties of the `capabilities` [section](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/urltemplate.json#L60) still apply to all `navigationModes`.
|   
|      **Note:** This ADR supersedes the definition in [FLPCOREANDUX-4595](https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FLPCOREANDUX-4595.md). There, native-[iOS|Android] install and launch URLs were bundled within one URL-template. For details see [Native & web apps in CEP](resources/1013/Minutes_2022-04-05_Native_and_web_apps_in_CEP.pdf).
|   
|   ### Add deviceType to URL-Templates
|   Today, a `deviceType`-tagging (i.e. the definition which form factors are supported by this app) can only be done in the context of a BusinessApp (_sap.ui_ and _inbounds_). By now supporting multiple templates for a single BusinessApp, this definition can differ between the different URL-templates. For example, the (responsive) web app might support _phone_, _tablet_, and _desktop_, while the native app is only available for _phone_.  
|   Therefore, the `capabilities` section of a URL-template gets extended with a new optional property `deviceTypes` with the same schema definition as in the BusinessApp. If this property is used for a given template its values override the deviceType settings in `sap.ui/deviceTypes` (for the whole app) and in `sap.app/crossNavigation/inbounds` (for the inbound).
|   
|   ### Allow multiple URL-templates per business-app
|   Today, the `sap.integration` property of a BusinessApp can refer to a single URL-template only (see [JSON schema](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core/AppDescriptor.extension.json#L11))
|   ```json
|       "sap.integration": {
|           "type": "object",
|           "properties": {
|               "urlTemplateId": { },
|               "urlTemplateParams": { },
|               "navMode": { }
|           }
|       }
|   ```
|   
|   In order to allow content providers to define multiple launch options for the same BusinessApp, the property `sap.integration` will be complemented by a new property `sap.integrations` containing an array of URL-template references. Either `sap.integration` or `sap.integrations` needs to be provided.
|   ```json
|       "sap.integrations": {
|           "type" : "array",
|           "items": {
|               "type": "object",
|               "properties" : {
|                   "urlTemplateId": { },
|                   "urlTemplateParams": { },
|                   "navMode": { }
|               }
|           }
|       }
|   ```
|   
|   The **Rules for content providers** which define a `targetAppConfig` are:
|   - At least a template with semantic `standalone` SHOULD be provided (for backwards compatibility this can't be a MUST).
|   - If the application is enabled to be launched embedded through an iFrame within a surrounding FLP/CEP/MyHome shell, an `embedded` URL-template SHOULD be provided.
|   - If a native iOS mobile application exists for the given business-app, URL-templates for `native-iOS-*` SHOULD be provided.
|   - If a native Andoid mobile application exists for the given business-app, URL-templates for `native-Android-*` SHOULD be provided.
|   - There MUST NOT be more than one URL-template with the same `navigationMode` value per BusinessApp.
|   - If the previous rules lead to a single URL-template for a given BusinessApp, the non-array variant of the `sap.integration` section CAN be used; otherwise the array variant MUST be used.
|   - If multiple launch options cover different functional scopes (e.g. more fine granular web apps vs. a more coarse granular mobile app), the modelling should follow the more fine granular cut. For more details incl. example please see [Native & web apps in CEP](resources/1013/Minutes_2022-04-05_Native_and_web_apps_in_CEP.pdf).
|   
|   ### Navigation Service
|   The [API definition](https://github.wdf.sap.corp/Portal-CF/navigation-service/tree/master/docs/apis) of the _Navigation Service_ already defines a `launchType` parameter when requesting a navigation target. This `launchType` maps to the values of the `capabilities/navigationMode` property of the URL-template and allows the _Navigation Service_ to choose the appropriate template when determining the target URL.
|   
|   In addition to the values of the URL-template `navigationMode`s, the Navigation Service supports an additional launchType `central`. This launchType results in an URL pointing to a central CEP instance which is parametrized in a way that it opens the requested app inplace using its `embedded` template.
|   
|   In order to simplify the usage of the Navigation Service, the API should additionally offer an endpoint which accepts a vector of prioritized `LaunchType`s and returns the URL for the first matching template together with its launchType. For scenarios where the final decision for a given launchType can only be done by the client (e.g. launch native mobile app or fallback to web app based on app-availability on the end-user's device) an additional endpoint should return pairs of URLs and corresponding launch types for all matching URL-templates.
|   
|   ### CEP Clients
|   The selection of the URL-template which is actually used for launching an app is done by the consumption context at runtime. This selection depends on product/UX decisions and the user's runtime environment, i.e. the used client:
|   
|   - **CEP web client** calls the Navigation Service with the `launchType` vector [`embedded`, `standalone`]. That means, if possible the app will be launched in an embedded iFrame. If an embedded template does not exist, it falls back to the standalone template and opens the resulting URL as-is in a new tab.
|   - **My Home web client** only uses the `launchType` `standalone` and opens the resulting URL in a new tab. All other templates are ignored.
|   - **SAP Mobile Start** uses the `launchType` vector [`native-*-install`, `native-*-launch`, `central`, `standalone`]. That means, if available, native apps are preferred. If no native app is available, either a central CEP instance is launched which opens the app inplace (if an `embedded` template is available), of a standalone web app is launched.  
|   If Mobile Start is running in the MyHome context, the `launchType` `central` will be omitted; i.e. similar to the MyHome Web client all web apps open standalone in the context of their product shell.
|   - **ABAP FLP** can use the same logic as the CEP web client when launching S/Cube BTP extensions: depending on the existence of an `embedded` URL-template the target app can either be launched embedded through an iFrame or standalone in a new tab.
|   
|   **Special considerations for _embedded_ launch**: Launching applications embedded through an iFrame requires both the surrounding shell as well as the iFrame-URL to use the same Common Super Domain (CSD; see [Why a Common Super Domain](https://github.wdf.sap.corp/cFLPIAMTopics/SSOforCFLP/blob/master/README.md#why-a-common-super-domain)). By allowing apps to define both an `embedded` as well as a `standalone` URL-template, we could launch the app based on whether or not the CSD requirements are fulfilled - without the need to force the content provider to adapt its content definition. This distinction could be made based on a configuration setting in the concrete consumption context or even completely dynamically at runtime (process the `embedded` URL-template first and check whether the resulting URL fulfills the same CSD as the surrounding shell and fallback to the `standalone` URL-template otherwise).
|   
|   ## Taken By
|   
|   Marko Degenkolb, Ariel Tammam, Tsafrir Sklarski, Haralambie Dumistracel, Gerald Krause, Helge Dombrowski, Steffen Huester, Christopher Schmitz, Nico Haller, Christian Hengstler
|   
|   ## Consequences
|   
|   Content providers will not need to differentiate their content definition based on the consumption scenario. Instead, they can provide a single content exposure which can be used across the different consumption scenarios coming with different product, UX, and technical boundary conditions. Specifically, content providers can use the same content definition and exposure for integrating with cFLP, My Home, and SAP Mobile Start.
|   
|   The changes described above are backwards compatible for existing content providers: The reference of just a single URL-template per BusinessApp is still allowed and the currently used `capabilities/navigationMode` values will be mapped to the newly defined ones. 
|   
|   The change is also compatible with existing clients (cFLP ushell and SAP Mobile Start), as the existing RT APIs (GetSite, CDM RT v1) stay as-is and the required mapping logic will be done as part of the activation flow (see _Adoption_ below).
|   
|   ### Adoption
|   Implementing this ADR requires adoption in the following places:
|   
|   - **CDM Schema:** 
|     - Update definition of `capabilities/navigationMode`
|     - Add new property `capabilities/navigationModes`
|     - Add new property `sap.integrations`
|     - Add `deviceTypes` property to `capabilities` section of URL-templates
|   
|   - **Content Providers:** Although the described extensions are backwards compatible for existing content providers, their adoption by CDM content providers is highly recommended and should be straight forward.  
|   New content providers such as SFSF should directly adopt the extended CDM schema.  
|   For S/4 as content provider the changes will comprise:
|     - Addition of a new single URL-template representing the `standalone` launch of S/4 applications within the S/4 ABAP FLP (this is already PoC'ed in https://jira.tools.sap/browse/FIORITECHP1-22162)
|     - Addition of a reference to this new URL-template for each BusinessApp 
|     - Otherwise no changes to the exposed entities and relations are required
|   
|   - **Activation Flow for Site Service:**
|     If a BusinessApp refers to a single URL-template only, today's activation logic remains unchanged. That means, existing content which is consumed through the Site service (used by today's cFLP client) and the depending RT API v1 (used by SAP Mobile Start) will work in exactly the same way as of today. 
|     However, if a BusinessApp refers to multiple URL-templates, the Activation flow for the Site Service needs to be extended to ensure that only a single URL-template per BusinessApp is exposed:
|     - Combine separate `native-iOS|Android-install` and `native-iOS|Android-launch` templates into a single template as currently used in cFLP and defined in [FLPCOREANDUX-4595](https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FLPCOREANDUX-4595.md). 
|     - If an app contains URL-templates for iOS or Android, separate those into dedicated BusinessApps for iOS and Android. This reflects the status quo with SAP Mobile Start and cFLP.
|     - If an app contains both `embedded` AND `standalone` templates, omit the `standalone` template and expose the `embedded` template.
|     - If only a `standalone` template remains, replace the `navigationMode` `standalone` with `newWindow`.
|      
|     Note: These activation steps are only required as long as those APIs are still used. Specifically, the first two steps are only required as long as SAP Mobile Start uses the RT API v1. That means, if SAP Mobile Start completely transitions to the new CEP Content API _before_ Content Providers expose multiple URL-templates, step 1. and 2. can be omitted.
|   
|   - **Activation Flow for CEP Content API:** 
|     - Translate deprecated values for `navigationMode` as defined in [Launch semantics of URL-template](#launch-semantics-of-url-template)
|     - If an URL-template combines native installURL and launchURL as defined in [FLPCOREANDUX-4595](https://github.wdf.sap.corp/FLP/flp-core-concepts/blob/master/FLPCOREANDUX-4595.md), separate these into separate templates.
|     
|   - **CDM Store:** Expose extended CDM content with multiple URL-templates to _Navigation Service_
|   
|   - **Navigation Service:** Replicate multiple URL-templates from _CDM Store_ and resolve target URLs using the template which best matches the requested `launchType` (see [above](#navigation-service)). Additionally, the new `deviceType` property in the URL-template's capabilities section needs to be evaluated when filtering targets.
|   
|   - **CEP Content API:** To avoid that pages contain visualizations which later on cannot be launched, the CEP Content API needs to allow to filter visualizations by deviceType and preferredLaunchTypes:  
|     Get visualizations (ID(s), deviceType, preferredLaunchTypes[]) => list of visualizations w/ descriptor 
|     - deviceType mandatory
|     - preferredLaunchTypes mandatory (== prioritized allow list) 
|     - Filtering by matching deviceType & launchType happens in service implementation 
|     - Returns all visualizations with matching deviceType AND (matching launchTypes OR those without a targetApp) 
|     - Example call for SAP Mobile Start on iOS: (ID(s), deviceType=phone, preferredLaunchTypes = [native-iOS-launch, native-iOS-install, central, standalone]) 
|   
|   - **Clients:** In order to use the appropriate URL-template for the given consumption scenario both the _CEP web client_ as well as _SAP Mobile Start_ need to adopt the _Navigation Service_ and need to request target URLs with the preferred `launchType` (see [CEP Clients](#cep-clients)).

                1.22.6.2.2

            1.22.6.3 Signoff
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2206+signoff
email:
 Hi,
 
Here is our commitment for Takt 2206 - Team Capacity ( 73PDs)
See below list of candidates for T06 (prioritization may change depending on the effort estimation). If anything is missing, please let me know.
 
Team capacity 73 PDs
Support - 19 PDs
Tasks:
HTML5 New Tenant refactoring
 
New/Leftovers:  
 
Prio
BLI/Activity
Comments / Action items
[Mass content ] graphQL Mesh support - research
Role ID special characters - additional characters newely supported by XSUAA
 
Extend CDM store API to search for apps which are not URL template nativeiOS or NativeAndroid 
DTS refactoring
soft commit
[ENG] entity validators
soft commit
 
  
Thanks!
Yosi
 
BLIs:
HTML5 New Tenant refactoring: https://jira.tools.sap/browse/EUXTEAMSAAR-3031

[Mass content ] graphQL Mesh support - research - https://jira.tools.sap/browse/EUXTEAMGUYM-4405 
Role ID special characters - additional characters newely supported by XSUAA - https://jira.tools.sap/browse/EUXTEAMSAAR-3016 
Extend CDM store API to search for apps which are not URL template nativeiOS or NativeAndroid  - https://jira.tools.sap/browse/EUXTEAMSAAR-2983 
DTS refactoring -  https://jira.tools.sap/browse/EUXTEAMSAAR-3020
[ENG] entity validators - https://jira.tools.sap/browse/EUXTEAMSAAR-3018

    


            1.22.6.4 Extend Role-Mapping to support Derived/Composite Roles
Extend Role-Mapping to support Derived/Composite Roles - Design review
https://jira.tools.sap/browse/EUXTEAMYAEL-1358
design: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2890287479

            1.22.6.5 [Mass content ] graphQL Mesh support - research - https://jira.tools.sap/browse/EUXTEAMSAAR-3017
PoC git repo: https://github.wdf.sap.corp/i324180/graphql-mesh
[i500695@WYLQRXL9LQ:2022-06-13 13:58:48:~/git/Jawad:]2005$ git clone https://github.wdf.sap.corp/i324180/graphql-mesh.git
[i500695@WYLQRXL9LQ:2022-06-13 13:59:42:~/git/Jawad/graphql-mesh:]2010$ cat README.md 

Fix high cpu usage b/c of token decoding:
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/pull/347
Diff:
diff --git a/CHANGELOG.md b/CHANGELOG.md
index 76eeb7f7..4d8b346d 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -7,6 +7,10 @@ This project adheres to [Semantic Versioning](http://semver.org/).
 
 The format is based on [Keep a Changelog](http://keepachangelog.com/).
 
+## [6.19.0]
+### Changed
+- Save decoded technical token in cache along with technical token - This reduces decoding the jwt each time technical token is fetched from cache and improves performance.
+
 ## [6.16.0]
 ### Changed
 - added functionality to the cf-logger. using the new functionality results in not having to check the log level everywhere in the code using it.
diff --git a/src/utils/technical-token.js b/src/utils/technical-token.js
index 13f67b4b..5962760a 100644
--- a/src/utils/technical-token.js
+++ b/src/utils/technical-token.js
@@ -59,10 +59,9 @@ function initIdentityZoneId(loggerCtx) {
     }
 }
 
-function isValidToken(loggerCtx, token) {
+function isValidToken(loggerCtx, decodedToken) {
     let isValidToken = false;
     try {
-        const decodedToken = jwtDecode(token);
         // Adding a buffer of 10 Minutes (600 secs) to the calculation.
         const currentTimeInSecPlusBuffer = (Date.now() / 1000) + 600;
         if (decodedToken.exp < currentTimeInSecPlusBuffer) {
@@ -162,16 +161,17 @@ class TechnicalToken {
         }
 
         if (cachedTechnicalTokens.has(cacheKey)) {
-            let token = cachedTechnicalTokens.get(cacheKey);
-            if (isValidToken(loggerCtx, token)) {
-                technicalToken = token;
+            let tokenInfo = cachedTechnicalTokens.get(cacheKey);
+            if (isValidToken(loggerCtx, tokenInfo.decodedToken)) {
+                technicalToken = tokenInfo.technicalToken;
             }
         }
 
         if (!technicalToken) {
             let params = {loggerCtx, serviceName, urlKey, subDomain, credentialsConfig, isReturnError};
             technicalToken = await TechnicalToken.requestToken(params);
-            cachedTechnicalTokens.set(cacheKey, technicalToken);
+            const decodedToken = jwtDecode(technicalToken);
+            cachedTechnicalTokens.set(cacheKey, {technicalToken, decodedToken});
         }
 
         return technicalToken;




            1.22.6.6 Extend CDM store API to search for apps which are not URL template nativeiOS or NativeAndroid  
            - https://jira.tools.sap/browse/EUXTEAMSAAR-2983 
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/806

id=role_ID_special_characters_-_additional_characters_newely_supported_by_XSUAA_
            1.22.6.7 Role ID special characters - additional characters newely supported by XSUAA 
            - https://jira.tools.sap/browse/EUXTEAMSAAR-3016 
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/811
https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/301
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-infra/pull/322
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-content-manager/pull/320
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/228


            1.22.6.8 Private Key Rotation Test Scope QA Week

                1.22.6.8.1 email-thread
Amazing news 🥳
Kudos! 👏🏼💪🏼

From: Guy, Ariel <ariel.guy@sap.com>
Date: Wednesday, 22 June 2022 at 16:35
To: Avrahami, Olga <olga.avrahami@sap.com>, Turin, Daniel <daniel.turin@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Maman, Asaf <asaf.maman@sap.com>, Schuller, Tom <tom.schuller@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>, Lipmanovich, Boris <boris.lipmanovich@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Cohen, Adam <adam.cohen01@sap.com>, Tito, Meni <meni.tito@sap.com>, Wimmer, Boaz <boaz.wimmer@sap.com>
Subject: RE: Private Key Rotation Test Scope QA Week
Amazing news, well done team
אלופים!!
 
 
From: Avrahami, Olga <olga.avrahami@sap.com> 
Sent: Wednesday, 22 June 2022 15:57
To: Turin, Daniel <daniel.turin@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Maman, Asaf <asaf.maman@sap.com>; Schuller, Tom <tom.schuller@sap.com>; Alhazov, Sergey <sergey.alhazov@sap.com>; Lipmanovich, Boris <boris.lipmanovich@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Cohen, Adam <adam.cohen01@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Tito, Meni <meni.tito@sap.com>; Wimmer, Boaz <boaz.wimmer@sap.com>
Subject: RE: Private Key Rotation Test Scope QA Week
 
+@Wimmer, Boaz
 
Thanks for the update – good job guys!!! 
 
Just a few comments:
 
| 1.	Since feature toggle was added just now to the global services  – please make sure to validate that it’s created properly  
| 2.	There is one more test which is blocked  - we have a meeting with Ariel and DLM about it tomorrow
| 3.	As was discussed during the execution plan review, please schedule sync meetings with Ops (Boaz) to validate the migration during deployments: 
| •	RCT – 03/07
| •	Canary Internal – 07/07
| •	LIVE – 14/07
 
Thanks again!
Olga
 
 
 
 
 
From: Turin, Daniel <daniel.turin@sap.com> 
Sent: Wednesday, 22 June 2022 15:37
To: Izaq, Yosi <yosi.izaq@sap.com>; Maman, Asaf <asaf.maman@sap.com>; Schuller, Tom <tom.schuller@sap.com>; Alhazov, Sergey <sergey.alhazov@sap.com>; Lipmanovich, Boris <boris.lipmanovich@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Cohen, Adam <adam.cohen01@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Avrahami, Olga <olga.avrahami@sap.com>; Tito, Meni <meni.tito@sap.com>; Turin, Daniel <daniel.turin@sap.com>
Subject: FW: Private Key Rotation Test Scope QA Week
 
 
Private Key Rotation BLI is complete.
Major props to @Schuller, Tom and @Maman, Asaf for excellent work.
Feature toggle has been pushed to portal-global-service with default value true
Which means this is On-By-Default.
 
Regards,
@Maman, Asaf, @Lipmanovich, Boris, @Schuller, Tom & @Turin, Daniel
 
From: Schuller, Tom <tom.schuller@sap.com>
Date: Wednesday, 22 June 2022 at 14:52
To: Avrahami, Olga <olga.avrahami@sap.com>, Guy, Ariel <ariel.guy@sap.com>, Alhazov, Sergey <sergey.alhazov@sap.com>, Maman, Asaf <asaf.maman@sap.com>, Turin, Daniel <daniel.turin@sap.com>
Subject: Private Key Rotation Test Scope QA Week
Hi All,
We’ve officially completed the Test Scope. All test cases went successfully.
Thank you everyone for your help and commitment.
 
https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BFederation%5D+Automatic+synchronization+-+Private+key+rotation+-+Test+Scope
 
Thank you very much,
Tom

                1.22.6.8.2
            1.22.6.9

        1.22.7  T07 

            1.22.7.1   multiple URL-templates 

PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/582
https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/306
            1.22.7.2 golang
Pros:
- performance: golang forte 
- rich and exhaustive concurrency model. threads, channels etc
- minimum abstractions. Very fast GC.
- ci/cd related. one single executable. so all dependencies are packaged 


Cons:
- more complex 
- code writing velocity is slower than nodejs
- steep learning curve 
- smaller community compared to nodejs
- language not showing signs of growth. community is not expanding. see:
  https://insights.stackoverflow.com/survey/2021#technology-most-popular-technologies
  https://www.magicbell.com/blog/most-popular-programming-languages
  

            1.22.7.3 CEP new experience
Design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCEP%5D+Standard+-+New+Experience+%28Phase+1%29+Design+document
recording: https://sap-my.sharepoint.com/:v:/p/lea_kritchker/EVQkKEWo-RBFnaehz1yDWy4BTvxhV6IREfa6s3B0Xz3rBA

            1.22.7.4 DTS refactoring
design: https://wiki.wdf.sap.corp/wiki/display/CPPortals/DTS+refactoring#DTSrefactoring-NoInputValidations

report structure:
{
    "instanceId": "string",
    "identityZoneId": "string",
    "contextId": "string",
    "contextType": "string",
    "id": string,
    "contents": SchemaReport | ImportReport
}
 
// report of import content - ImportReport
{
    "total": "string",
    "failed": "number",
    "status": "string",
    "correlationId": "string",
    "messages": {
        "errors": "array",
        "warnings": "array"
    }
}
 
// report of schema - SchemaReport
{
    "valid": "boolean",
    "errors": "array",
    "entitiesToImport": "array",
    "context": {
         "id": "string",
         "contextType": "string"
    }
}

            1.22.7.5 signoff 

            1.22.7.6 reduce disk space 
https://jira.tools.sap/browse/DWPBUGS-2208
- reducing dependencies PR 
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/241
    use this cdm-store-client version in:
    -- https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/103/files
    -- https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/105/files

- plan B. increase disk space PRs
https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/103
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/583

            1.22.7.7 EUXTEAMSAAR-3055 Role ID special characters - additional characters newely supported by XSUAA - the schema changes
[15:26] Kahan, Sheli
Hi Yosi, syncing you: I created the PRs according to Gil's instructions. Still working on pushing them (CI, reviews etc.):
https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/308
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/832
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-infra/pull/325 - pushed, verify CI is green
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-content-manager/pull/326


        1.22.8  T08 

            1.22.8.1  Other teams

                1.22.8.1.1  [CEP] New activation service- Error handling (https://jira.tools.sap/browse/EUXTEAMNILI-5598)
BLI: https://jira.tools.sap/browse/EUXTEAMNILI-5598
DR: https://wiki.one.int.sap/wiki/x/PAWWtQ
Recording: https://sap-my.sharepoint.com/:v:/p/reuven_kandov/EVQfc7Dd_A9Npgq5hoGoVn0BjgmcO9wV3Kglnf4aCKNz5g

                1.22.8.1.2 timestamps Immanuel
Wiki - https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Mini+design+-+adding+timestamps+to+CUD+API
BLI - https://jira.tools.sap/browse/EUXTEAMYAEL-1601

                1.22.8.1.3   Content Package E2E Flows
Olga

| 1.	[CEP] [Q3] Upload Content Package and validate in RT (BLI - EUXTEAMYAEL-1599)
| 2.	[CEP] [Q3] Content Package Administration (BLI - EUXTEAMGUYM-4516)
| 3.	[CEP] [Q3] Launchpad View Modes (BLI- EUXTEAMNILI-6101)

                1.22.8.1.4 content-manager react 
design: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=2965746318

TLDR:
a. react basics: https://reactjs.org/docs/getting-started.html 
c. React Hooks - https://reactjs.org/docs/hooks-intro.html
d. React router - https://reactrouter.com/docs/en/v6
e. React Redux - https://react-redux.js.org/
f. Redux Toolkit -https://redux-toolkit.js.org/ 
g. Redux Toolkit Query - https://redux-toolkit.js.org/rtk-query/overview
h. Jest - https://jestjs.io/docs/getting-started
i. React Testing Library - https://testing-library.com/docs/
j. Typescript -     https://www.typescriptlang.org/docs/handbook/typescript-from-scratch.html
k. Vite - https://vitejs.dev/


Query params for LTS newUI=true&mode=mock
mock is for use mock content and not 

                1.22.8.1.5
            1.22.8.2 our team

                1.22.8.2.1 EUXTEAMSAAR-3038 [CEP] Multiple URL Templates for business app - CDM Store/Transport Service
https://jira.tools.sap/browse/EUXTEAMSAAR-3038
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/582
Hadar, committed last PRs
<url:/Users/i500695/work/SAP/PRs/transport/EUXTEAMSAAR_3038_CEP_Multiple_URL_Templates_for_business_app__CDM_Store_Transport_Service>

                1.22.8.2.2 Role ID special characters - additional characters newely supported by XSUAA - the schema changes
Hadar & Gil
https://jira.tools.sap/browse/EUXTEAMSAAR-3055
Scope:
To complete the full scenario as specified in previous BLI https://jira.tools.sap/browse/EUXTEAMSAAR-2984 

Extend CDM and Portal schema support  with characters '\ /%'- wait until fix is entered by XSUAA -  https://jtrack.wdf.sap.corp/browse/SECAUTH-1926

New update: we will support only '/'

                1.22.8.2.3 DTS refactoring
Adam,
Also, [Dev scenario] HTML5 Apps provider - Error handling and reporting - Client impl.  
https://jira.tools.sap/browse/EUXTEAMSAAR-3107 

DTS Testscope: https://wiki.one.int.sap/wiki/display/CPPortals/%5bDTS+refactoring%5d+DTS+Regression+Test+Scope
Adam report Testscope: https://wiki.one.int.sap/wiki/display/CPPortals/HTML5+provider+report+test+scope

                1.22.8.2.4 [CEP] Import local Spaces and WorkPages - implementation, tags: Import local Spaces and WorkPages gil guide
 Gil

                    1.22.8.2.4.1 BLI https://jira.tools.sap/browse/EUXTEAMSAAR-3075
#302	Jira:EUXTEAMSAAR-3075 - upgrade to the newest infra with support for spaces and workpages	master	DECLINED				6 days ago
#330	Jira:EUXTEAMSAAR-3075 - upgrade version of nestjs-commons	master	MERGED		
#87	Jira:EUXTEAMSAAR-3075 - upgrade nestjs-common	master	MERGED		
#105	JIRA:EUXTEAMSAAR-3075 - adding space and workpage entity type to be valid when creating folder in import zip file	master	MERGED		

                    1.22.8.2.4.2 Import spaces and workpages guide
 guide: https://wiki.one.int.sap/wiki/display/CPPortals/Import+spaces+and+workpages+guide 
 <url:/Users/i500695/work/SAP/documents/launchpad/Import spaces and workpages guid_a68807bad28a4a98baa08b86bf4f6eeb-210822-1135-12268.pdf>

 full guide:
Import spaces and workpages guide
Retrieving a zip file and preparing it to import
in order to get a zip file which already has roles and business app -
we highly recommend to selected roles and business apps that you will want to connect to the space/s and workpage/s you will want to create/import, and export them.
after downloading the zip file with the role/s and business app/s,
we will need to add space/s and workpage/s to the zip before importing it back to the system. the following explains the structure of the zip to be imported.
this image demonstrate a zip which have role/s and business app/s
in order to create the right structure for space/s and workpage/s, we will need to create folders - 1 for space/s and 1 for workpage/s, after the creation the structure should be like this -
so we added the "space" folder and the "workpage" folder and inside each of them we created the "space1.json" and "workpage1.json" respectively.
inside those files we will create an array of JSON objects that will represent the space/s and the workpage/s (respectively) we will want to import to the system.
the next step will be handling the relations between the entities and also will have samples you can use in order to create those files.
Understanding the relations
  
 in order to be able to use spaces and workpages in launchpad runtime, we need to understand and set the relations between entities. in the above diagram we can see the relations between the entity types.
in order to use a space, we will need to add a relation to a role entity.
   Role before space assignment
   
       {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "texts": {
            "cdm|identification|title": {
                "type": "XTIT",
                "value": {
                    "": "Role Title",
                    "en": ""
} },
            "cdm|identification|description": {
                "type": "XTIT",
} },
"value": {
    "": "",
"en": "" }
        "payload": {
            "apps": []
        },
        "_version": "3.0",
        "relations": {
            "apps":[{
                "target": {
                    "id": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
                    "entityType": "businessapp",
                    "context": {
                    "id": "SUB_ACCOUNT",
                    "type": "sub_account"
} },
                "label": "ref"
            },{
                "target": {
                    "id": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
                    "entityType": "businessapp",
                    "context": {
                    "id": "SUB_ACCOUNT",
                    "type": "sub_account"
                    }
},
                "label": "ref"
            }],
            "spaces": []
        },
        "identification": {
            "id": "your-role-id",
            "title": "{{cdm|identification|title}}",
            "entityType": "role",
            "description": "{{cdm|identification|description}}"
} }
}
 note the above json cdm/relations/spaces array is empty.

  Role after spaces assignment
 {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "texts": {
            "cdm|identification|title": {
                "type": "XTIT",
                "value": {
                    "": "Role Title",
                    "en": ""
} },
            "cdm|identification|description": {
                "type": "XTIT",
} },
"value": {
    "": "",
"en": "" }
"payload": {
    "apps": []
},
"_version": "3.0",
"relations": {
    "apps":[{
        "target": {
            "id": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
            "entityType": "businessapp",
            "context": {
            "id": "SUB_ACCOUNT",
            "type": "sub_account"
} },
        "label": "ref"
    },{
        "target": {
            "id": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
            "entityType": "businessapp",
            "context": {
            "id": "SUB_ACCOUNT",
            "type": "sub_account"
            }
},
        "label": "ref"
    }],
    "spaces": [{
        "target": {
            "id": "your-space-id-1",
            "entityType": "space",
            "context": {
            "id": "SUB_ACCOUNT",
            "type": "sub_account"
} },
        "label": "ref"
    }, {
   
   } }
}
        "target": {
            "id": "your-space-id-2",
            "entityType": "space",
            "context": {
            "id": "SUB_ACCOUNT",
            "type": "sub_account"
            }
},
        "label": "ref"
    }]
},
"identification": {
"id": "your-role-id",
"title": "{{cdm|identification|title}}",
"entityType": "role",
"description": "{{cdm|identification|description}}"
 note the above json cdm/relations/spaces array contains 2 space with "your-space-id-1" and "your-space-id-2" ids.
in order to use a workspace, we will need to add a relation to a space entity.

  Space before workpage assignment
 {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "_version": "3.1.0",
        "identification": {
} }
    "id": "your-space-id-1",
    "entityType": "space",
    "title": "{{spaceTitle}}"
},
"payload": {
    "contentNodes": []
},
"relations": {
    "pages":[],
    "workpages": []
},
"texts": [ {
        "locale": "",
        "textDictionary": {
            "spaceTitle": "Space Title 1"
        }
}, {
} ]
"locale": "en",
"textDictionary": {
    "spaceTitle": "Space Title 1"
}
    note the above json cdm/relations/workpages array is empty and also cdm/payload/contentNodes array is empty.

  Space after workpage assignment
 {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "_version": "3.1.0",
        "identification": {
            "id": "your-space-id-1",
            "entityType": "space",
            "title": "{{spaceTitle}}"
        },
        "payload": {
            "contentNodes": [{
                "type": "workpage",
                "id": "your-workpage-id-1"
}] },
        "relations": {
            "pages":[],
            "workpages": [{
                "target": {
                    "id": "your-workpage-id-1",
                    "entityType": "workpage",
                    "context": {
                        "id": "SUB_ACCOUNT",
                        "type": "sub_account"
                    }
},
                "label": "ref"
            }]
}, "texts": [
] }
}
{
    "locale": "",
    "textDictionary": {
        "spaceTitle": "Space Title 1"
} },
{
    "locale": "en",
    "textDictionary": {
        "spaceTitle": "Space Title 1"
} }
    note the above json cdm/relations/workpage array contains 1 workpage with "your-workpage-id-1" id and also cdm/payload/contentNodes arrary contains the same workpage.
all workpages in cdm/payload/contentNodes array must be reflected in cdm/relations/workpage array and vice versa.
in order to add apps (business apps) to a workpage, we will need to add a relation to the workpage entity.
all widgets app id and viz id must be reflected in relations sections.

  Workpage before apps assignment
 {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "_version": "3.2.0",
        "identification": {
} }
    "entityType": "workpage",
    "id": "your-workpage-id-1",
    "title": "{{Title}}"
},
"payload": {
    "rows": [{
        "columns": [{
            "cells": [{
                "id": "cell-1",
                "widgets": []
            }],
            "id": "col-1"
        }],
        "id": "row-1"
    }]
},
"relations": {
"viz": [] },
"texts": [ {
        "locale": "",
        "textDictionary": {
            "Title": "Default Title 1"
        }
}, {
} ]
"locale": "en",
"textDictionary": {
    "Title": "English Title 1"
}
    note the above json cdm/relations/viz array is empty and also the above json cdm/payload/rows/[0]/columns/[0]/cells/[0]/widgets array is empty.
  Workpage after app assignments
 {
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
"id": "SUB_ACCOUNT",
   
   } },
"contextType": "sub_account",
"tenantId": "775eeba4e6172dd19ad198f039644ca1",
"identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
"instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
"cdm": {
    "_version": "3.2.0",
    "identification": {
        "entityType": "workpage",
        "id": "your-workpage-id-1",
        "title": "{{Title}}"
    },
    "payload": {
        "rows": [{
            "columns": [{
                "cells": [{
                    "id": "cell-1",
                    "widgets": [{
                        "id": "widg-1",
                        "viz": {
                            "appId": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
                            "vizId": "Default-VizId"
} }, {
} }, {
} }]
}, "texts": [
}] }],
            "id": "col-1"
        }],
        "id": "row-1"
    }]
},
"relations": {
    "viz": [{
        "label": "ref",
        "target": {
            "context": {
"id": "widg-2",
"viz": {
    "appId": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
    "vizId": "Default-VizId"
}
    "id": "SUB_ACCOUNT",
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
"properties": {
    "vizId": "Default-VizId"
}
"label": "ref",
"target": {
"context": {
    "id": "SUB_ACCOUNT",
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
"properties": {
    "vizId": "Default-VizId"
}
{
    "locale": "",
    "textDictionary": {
        "Title": "Default Title 1"

    ] }
}
} },
{
    "locale": "en",
    "textDictionary": {
        "Title": "English Title 1"
} }
 note the above json cdm/relations/viz array contains 2 apps "0a05ce64-1564-4a9f-9689-9b10ddd5502b" and "e09bed4d-5874-45c7-a99d-9ee5ba237aa8" ids.
also the above json cdm/payload/rows/[0]/columns/[0]/cells/[0]/widgets array contains 2 objects containing the those apps.
Final Steps
after adding the JSON object and taking care of the relations between the entities, we will need to compress the folder back to a zip file. so the folder we will zip need to be in the following structure -
notice that when you compress the zip file you make sure this is the structure of the folder and there is no other hidden or temp files inside the zip. mac users can use the following command in order to compress and create the zip file (avoiding temp and hidden files) -
running this command in the terminal assumes current folder is the root folder of the zip file you want to create.
Samples
  zip -r zipFileName.zip . -x ".*" -x "__MACOSX" -x "**/.DS_Store"
    "workpage1.json" file sample contains 2 workspace JSON object (in an array)
 [{
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
  
           "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
    }
}, "cdm": {
    "_version": "3.2.0",
    "identification": {
        "entityType": "workpage",
        "id": "your-workpage-id-1",
        "title": "{{Title}}"
    },
    "payload": {
        "rows": [{
            "columns": [{
                "cells": [{
                    "id": "cell-1",
                    "widgets": [{
                        "id": "widg-1",
                        "viz": {
                            "appId": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
                            "vizId": "Default-VizId"
} }, {
}] }],
            "id": "col-1"
        }],
        "id": "row-1"
    }]
},
"relations": {
    "viz": [{
        "label": "ref",
        "target": {
            "context": {
} }, {
} }]
}, "texts": [
"id": "widg-2",
"viz": {
    "appId": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
    "vizId": "Default-VizId"
}
    "id": "SUB_ACCOUNT",
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
"properties": {
    "vizId": "Default-VizId"
}
"label": "ref",
"target": {
"context": {
    "id": "SUB_ACCOUNT",
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
"properties": {
    "vizId": "Default-VizId"
}
{
    "locale": "",
    "textDictionary": {
        "Title": "Default Title 1"
} },
{

   } }, {
} ]
"locale": "en",
"textDictionary": {
    "Title": "English Title 1"
}
"metadata": {
    "updatedOn": 1659610246000,
    "updatedBy": "John M",
    "createdBy": "John M",
    "createdOn": 1659610246000,
    "context": {
        "id": "SUB_ACCOUNT",
        "contextType": "sub_account",
        "tenantId": "775eeba4e6172dd19ad198f039644ca1",
        "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
        "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
"cdm": {
    "_version": "3.2.0",
    "identification": {
        "entityType": "workpage",
        "id": "your-workpage-id-2",
        "title": "{{Title}}"
    },
    "payload": {
        "rows": [{
            "columns": [{
                "cells": [{
                    "id": "cell-1",
                    "widgets": [{
                        "id": "widg-1",
                        "viz": {
                            "appId": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
                            "vizId": "Default-VizId"
} }, {
}] }],
            "id": "col-1"
        }],
        "id": "row-1"
    }]
},
"relations": {
    "viz": [{
        "label": "ref",
        "target": {
            "context": {
} }, {
"id": "widg-2",
"viz": {
    "appId": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
    "vizId": "Default-VizId"
}
    "id": "SUB_ACCOUNT",
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "0a05ce64-1564-4a9f-9689-9b10ddd5502b",
"properties": {
    "vizId": "Default-VizId"
}
"label": "ref",
"target": {
    "context": {
        "id": "SUB_ACCOUNT",

   ] }
}]
} }]
}, "texts": [
    "type": "SUB_ACCOUNT"
},
"entityType": "businessapp",
"id": "e09bed4d-5874-45c7-a99d-9ee5ba237aa8",
"properties": {
    "vizId": "Default-VizId"
}
{
    "locale": "",
    "textDictionary": {
        "Title": "Default Title 2"
} },
{
    "locale": "en",
    "textDictionary": {
        "Title": "English Title 2"
} }
   "space1.json" file sample contains 2 space JSON object (in an array)
 [{
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "_version": "3.1.0",
        "identification": {
            "id": "your-space-id-1",
            "entityType": "space",
            "title": "{{spaceTitle}}"
        },
        "payload": {
            "contentNodes": [{
                "type": "workpage",
                "id": "your-workpage-id-1"
}] },
        "relations": {
            "pages":[],
            "workpages": [{
                "target": {
                    "id": "your-workpage-id-1",
                    "entityType": "workpage",
                    "context": {
                        "id": "SUB_ACCOUNT",
                        "type": "sub_account"
                    }
},
                "label": "ref"
            }]
   
    ] }
}, "texts": [
{
    "locale": "",
    "textDictionary": {
        "spaceTitle": "Space Title 1"
} },
{
    "locale": "en",
    "textDictionary": {
        "spaceTitle": "Space Title 1"
} }
},{
    "metadata": {
        "updatedOn": 1659610246000,
        "updatedBy": "John M",
        "createdBy": "John M",
        "createdOn": 1659610246000,
        "context": {
            "id": "SUB_ACCOUNT",
            "contextType": "sub_account",
            "tenantId": "775eeba4e6172dd19ad198f039644ca1",
            "identityZoneId": "1ce802a5-1e33-4e9d-968e-6fb3217ce807",
            "instanceId": "85daabb3-0ad7-43d6-bf55-7c9f2aa92ebd"
} },
    "cdm": {
        "_version": "3.1.0",
        "identification": {
            "id": "your-space-id-2",
            "entityType": "space",
            "title": "{{spaceTitle}}"
        },
        "payload": {
            "contentNodes": [{
                "type": "workpage",
                "id": "your-workpage-id-2"
}] },
        "relations": {
            "pages":[],
            "workpages": [{
                "target": {
                    "id": "your-workpage-id-2",
                    "entityType": "workpage",
                    "context": {
                        "id": "SUB_ACCOUNT",
                        "type": "sub_account"
                    }
},
                "label": "ref"
            }]
}, "texts": [
            {
                "locale": "",
                "textDictionary": {
                    "spaceTitle": "Space Title 2"
} },
            {
                "locale": "en",
                "textDictionary": {
                    "spaceTitle": "Space Title 2"
} }
]

        } }]
 sample of zip file contains 1 role, 2 spaces, 2 workpages and 2 businessapps.
the relations between them -
your-role-id-1 (role) your-space-id-1, your-space-id-2 (spaces)
your-role-id-1 (role) 0a05ce64-1564-4a9f-9689-9b10ddd5502b, e09bed4d-5874-45c7-a99d-9ee5ba237aa8 (businessapps) your-space-id-1 (space) your-workpage-id-1 (workpage)
your-space-id-2 (space) your-workpage-id-2 (workpage)
your-workpage-id-1 (workpage) 0a05ce64-1564-4a9f-9689-9b10ddd5502b, e09bed4d-5874-45c7-a99d-9ee5ba237aa8 (businessapps) your-workpage-id-2 (workpage) 0a05ce64-1564-4a9f-9689-9b10ddd5502b, e09bed4d-5874-45c7-a99d-9ee5ba237aa8 (businessapps)


                    1.22.8.2.4.3 Test-Scope 
https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+%5BQ3%5D+Import+Local+Spaces+and+Workpages

                    1.22.8.2.4.4

                1.22.8.2.5 Update minimum UI5 version supported for launchpad module 
Jawad
https://jira.tools.sap/browse/EUXTEAMSAAR-3066
schema: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/310
DTS: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/347
web ide: https://github.wdf.sap.corp/Portal-CF/portal-cf-webide-plugin/pull/117 

                1.22.8.2.6 [CEP]: CDM Store – add "timestamp" attribute to all events
bli: https://jira.tools.sap/browse/EUXTEAMSAAR-3108?src=confmacro
Yoav
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/848
Design: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3061384158 

diffs: <url:/Users/i500695/work/SAP/PRs/cdm_store/timestamps>  

                1.22.8.2.7
            1.22.8.3
        1.22.9 2022 T09 

            1.22.9.1 Signoff 
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2209+signoff

References
Sign-off template and guidelines



Planning
Yosi's team T2209

Breakdown
Team Capacity  -  47 PDs

Support - 20 PDs

Tasks:

Security-Threat Modeling for WorkZone  2 PDs

Remaining Capacity  -  25 PDs

New/Leftovers:  



Epic/Area	BLI/Activity Estimated Effort Dependencies in other teams UX InfoDev DevOps Perf.  Comments / Action items

CEP Beta	[CEP] E2E validation activities for beta release - Yosi's team	10 PDs	Leftover from T08
CEP Beta	[CEP]: CDM Store – add "timestamp" attribute to all events	RC candi fix duplicate provider issue plus add UT/IT coverage- 3PDS
TS 0 bug - 3 PDs
Wrong TS  fix: Instead the solution proposal is for the merge logic for CP entities to apply to the timestamps as well. So when content in snapshpot is updated and CDM store calculates which CP roles are affected for sending events these events will have the newer TS (in this case the  base/snapshot entity TS        - 7 PDs
SELECTEDTS must fixes w/ update content packages disabled: 6 PDs

Full TS support Total: 13 PDs - Note must for GA

Total: 6 PDs

Remaining Capacity  -  19 PDs
continue leftovers detected in the testing 
Mass content and admin UI 	[CEP] Implement materialized view for paginated search - Design ( T09)	list searches that require improvement
pros and cons of MV
possible other quick win fixes
PoC - test refresh in scenario when multiple admin work concurrently 
Total: 10 PDs

Remaining Capacity  -  9 PDs



Mass content and admin UI 	[CEP] Implement materialized view for paginated search - Imp. (T09)	S+M. breakdown depends on design.	

soft commit
CEP performance 	[CEP] Improve performance For CEP activation - Design  
new read API - 4 PDs
New service/DAO/JDBC - 4 PDs
8 PDs

soft commit
Issues raised as part of Shlomi performance tests
CEP performance 	[CEP] Improve performance For CEP activation - Implementation  	depends on design BLI	soft commit
CEP performance 	[CEP] Support delta update in "update content package scenario" - design 

reduce redundant create + delete events - 5 PDs
reduce redundant update events. Send update event only for actually updated entities. - 3 PDs
reduce redundant writes in CDM store (updates of non-updated entities)  - 3 PDs
compare actual jsonb values and send update only for changed entities only - 4 PDs
options: 
new service for calculating diff in content 
add functionality to store-client (can be used by import service to benefit from diff capability as well)
Total: 15 PDs

soft commit
Supportability 	[Dev scenario] HTML5 Apps provider - Error handling and reporting - Client impl. 	
soft commit

eftover from T08 

SRE/supportability	DTS refactoring  

Security /Supportability 	[Security] Cred-store - adapt our code to use key/file instead of password - DTS 	
breakdown. TBD.

Shared lib should be enhanced with method to store credentials as key (if it suffice) or file. https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/master/src/security/secure-store.js#L112


DTS should write to cred store using this new method,but reading also for 'old'  (lazy migration). https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/blob/master/src/utils/store-activation-util.ts#L281
Adoram, Nili Common rt approuter should read using this new method, but reading also for 'old' (lazy migration) https://github.wdf.sap.corp/Portal-CF/common-rt-approuter/blob/master/src/extensions/blue-box-utils/blue-box-extensions.ts#L40
Shefer, Shany Service broker should delete (on delete instance) from both old and new https://github.wdf.sap.corp/Portal-CF/portal-cf-service-broker/blob/master/src/lib/hooks.js#L53
cross team. Test of regressions and new.
deploy of apollo with plugin/dynamic tiles, federate it and see it works
use mtls with same flow
deploy of embedded cotnent provider  (like workflow, or one that already is tested).

soft commit


Public signoff
Hi,



Here is our commitment for Takt 2209 - Team capacity 41 PDs

See below list of candidates for T08 (prioritization may change depending on the effort estimation). If anything is missing, please let me know.

Team Capacity  -  47 PDs

Support - 20 PDs

Tasks:

Security-Threat Modeling for WorkZone  2 PDs

New/Leftovers:  



Epic/Area	
BLI/Activity

Comments / Action items

CEP Beta	[CEP] E2E validation activities for beta release - Yosi's team	Leftover from T08
CEP Beta	[CEP]: CDM Store – add "timestamp" attribute to all events	continue leftovers detected in the testing 
Mass content and admin UI 	[CEP] Implement materialized view for paginated search - Design ( T09)	
Mass content and admin UI 	[CEP] Implement materialized view for paginated search - Imp. (T09)	soft commit
CEP performance 	
[CEP] Improve performance For CEP activation - Design  

soft commit

Issues raised as part of Shlomi performance tests

CEP performance 	[CEP] Improve performance For CEP activation - Implementation  	soft commit
CEP performance 	
[CEP] Support delta update in "update content package scenario" - design 

soft commit
Supportability 	[Dev scenario] HTML5 Apps provider - Error handling and reporting - Client impl. 	
soft commit

leftover from T08 

SRE/supportability	
DTS refactoring  


Security /Supportability 	[Security] Cred-store - adapt our code to use key/file instead of password - DTS 	soft commit



Plz find detailed breakdown here.

Thanks!

Yosi
            1.22.9.2 team BLIs

                1.22.9.2.1 CEP tasks

                    1.22.9.2.1.1 29/08/22 14:10:35  
[9:45] Labinsky, Kalman
Hi Yosi, can you please review this, Ariel wants the import zip for cep to be in github https://github.wdf.sap.corp/Portal-CF/Backbone-Automations/pull/24
I also added her a reference to the import export wiki https://github.wdf.sap.corp/Portal-CF/Backbone-Automations/pull/25
From e16d2abe3c340d8efce603808153c127521f0597 Mon Sep 17 00:00:00 2001
From: Kalman Labinsky <kalman.labinsky@sap.com>
Date: Sun, 28 Aug 2022 16:37:41 +0300
Subject: [PATCH 1/2] Update README.md

---
 README.md | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/README.md b/README.md
index 5142baa..56b0d68 100644
--- a/README.md
+++ b/README.md
@@ -1,11 +1,14 @@
 # Backbone-Automations
 
 ## 1. HTML5-NEW-TENANT
-test file [link](/test/html5/html5-new.spec.ts)
+test file: [link](/test/html5/html5-new.spec.ts)
 ### Jobs: [LTS](https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/LTS-HTML5-NEW-TENANT/) [RCT](https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/RCT-HTML5-NEW-TENANT/)
 
 ## 2. Sanity
 located in portal-cf-fs-automation [link to wiki](https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/tree/master/ui-tests/sanity)
 
 ## 3. DTS automations
-[link](https://wiki.one.int.sap/wiki/display/CPPortals/DTS+Automation+Tests)
+[wiki](https://wiki.one.int.sap/wiki/display/CPPortals/DTS+Automation+Tests)
+
+## 4 Import Export automations
+[wiki](https://wiki.one.int.sap/wiki/display/CPPortals/Import+Export+Automations)

From 4c0134ffddee7ff4484442c01ae943e4e3e1e39e Mon Sep 17 00:00:00 2001
From: Kalman Labinsky <kalman.labinsky@sap.com>
Date: Sun, 28 Aug 2022 16:38:40 +0300
Subject: [PATCH 2/2] .

---
 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 56b0d68..7712a98 100644
--- a/README.md
+++ b/README.md
@@ -10,5 +10,5 @@ located in portal-cf-fs-automation [link to wiki](https://github.wdf.sap.corp/Po
 ## 3. DTS automations
 [wiki](https://wiki.one.int.sap/wiki/display/CPPortals/DTS+Automation+Tests)
 
-## 4 Import Export automations
+## 4. Import Export automations
 [wiki](https://wiki.one.int.sap/wiki/display/CPPortals/Import+Export+Automations)


[10:35] Izaq, Yosi
good morning Kalman. sure no problem. 10x!

we also need approval for change of e2e docker image https://github.wdf.sap.corp/Portal-CF/ci-tools/pull/1471
From 59606ab5e66308c2bc46821969e7ab841a3a8115 Mon Sep 17 00:00:00 2001
From: Kalman Labinsky <kalman.labinsky@sap.com>
Date: Mon, 29 Aug 2022 08:52:43 +0300
Subject: [PATCH 1/2] change docker to cloud.sap

---
 .../LTS-HOSTED-GLOBAL-CONTENT-PROVIDER-TEST.yaml                | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/resources/parameters/end2endTestJobs/LTS-HOSTED-GLOBAL-CONTENT-PROVIDER-TEST.yaml b/resources/parameters/end2endTestJobs/LTS-HOSTED-GLOBAL-CONTENT-PROVIDER-TEST.yaml
index 3999523c7..b87264434 100644
--- a/resources/parameters/end2endTestJobs/LTS-HOSTED-GLOBAL-CONTENT-PROVIDER-TEST.yaml
+++ b/resources/parameters/end2endTestJobs/LTS-HOSTED-GLOBAL-CONTENT-PROVIDER-TEST.yaml
@@ -4,7 +4,7 @@ params:
     value: "hosted-vizTypes-content-provider"
     className: string
   - name: "DOCKER_IMAGE"
-    value: "docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-puppeteer-cf:1.0.1-20200806103700"
+    value: "bit-ce.int.repositories.cloud.sap/ci-docker-node-puppeteer:16"
     className: string
   - name: "TEST_COMMANDS"
     value: "git config --global http.sslVerify false && npm i mbt@1.2.4 -g && npm i && ENV=${ENV}  npm run e2e"

From 06489180e11609bce6729438c126ea2851c4af1d Mon Sep 17 00:00:00 2001
From: Kalman Labinsky <kalman.labinsky@sap.com>
Date: Mon, 29 Aug 2022 08:53:28 +0300
Subject: [PATCH 2/2] Update LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml

---
 .../end2endTestJobs/LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/resources/parameters/end2endTestJobs/LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml b/resources/parameters/end2endTestJobs/LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml
index 9cdec9ded..ce3272026 100644
--- a/resources/parameters/end2endTestJobs/LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml
+++ b/resources/parameters/end2endTestJobs/LTS_EMBEDDED_CONTENT_PROVIDER_TEST.yaml
@@ -3,7 +3,7 @@ params:
   - name: "TEST_REPOSITORY"
     value: "workzone-external-content-provider"
   - name: "DOCKER_IMAGE"
-    value: "docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-puppeteer-cf:1.0.1-20200806103700"
+    value: "bit-ce.int.repositories.cloud.sap/ci-docker-node-puppeteer:16"
   - name: "TEST_COMMANDS"
     value: "git config --global http.sslVerify false && npm i mbt@1.2.4 -g && CF_API=${CF_API} DOMAIN=${DOMAIN} ORG=${ORG} SPACE=${SPACE} DEPLOY_URL=${DEPLOY_URL} RT_PORTAL_URL=${RT_PORTAL_URL} TEST_USER='portaltest@mailinator.com' TEST_PASSWORD=${TEST_PASSWORD} npm run e2e"
     description: "<b><font color=\"red\">Mandatory</font> - your project test commands split by new line</b><br><font color=\"orange\"><b>Warning: </b></font>In case you are using 'password' as parameter, please replace it as following: password-><b>${password}</b><br><b>For example:</b> TEST_URL=https://flpdevelop.dt.cpplts.cfapps.sap.hana.ondemand.com TEST_USER='test username' TEST_PASSWORD=${password} npm test"

devops didnt get back to me https://jira.tools.sap/browse/DWPBUGS-2494

-> [Yesterday 11:25] Cohen, Adam
by the way these are the tickets i was on on BCP 

[Yesterday 11:26] Cohen, Adam
Remote server responded with HTTP status code 500 - seems like an issue with the cred store. He says they do not use x509
 
Smart business component load failure in Portal FLP - needs to be closed, issue with cachebuster token has been resolved. Rendering of tiles not related to us.
 
Unable to deploy to Portal service - need to understand how come he is the only one getting 400 from semantic. I checked and we send the same object as before the refactoring
 
TsInternalServerErrorException when deploying launchpad - they had some issue without logs available. I asked them to retrigger so we get the logs. Before I did that they deleted something in the account now nothing works. They cant delete it and retrigger the deployment without errors related to that deletion
 heart 1

[Yesterday 11:26] Cohen, Adam
the left part is the title of them


                1.22.9.2.2 [CEP]: CDM Store – add "timestamp" attribute to all events

                    1.22.9.2.2.1 RC_CANDI fix for Duplicate html5 provider

                        1.22.9.2.2.1.1 actual RC_CANDI
Hi Yael,
 
CI is green, please let me know what the test system is ready for validation.
 
Thanks,
Jawad
 
From: Wilfand, Kfir <kfir.wilfand@sap.com>
Date: Monday, 29 August 2022 at 12:14
To: Malekan, Yael <yael.malekan@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Frishberg Barak, Oren <oren.frishberg.barak@sap.com>, Dagan, Saar <saar.dagan@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix

https://portaldesigntime.jaas-gcp.cloud.sap.corp/job/ci-portal-cf-cdm-store-service-voter/job/rc/22/
This is the correct build**

 
From: Wilfand, Kfir <kfir.wilfand@sap.com>
Date: Monday, 29 August 2022 at 12:12
To: Malekan, Yael <yael.malekan@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Frishberg Barak, Oren <oren.frishberg.barak@sap.com>, Dagan, Saar <saar.dagan@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix

I pushed a CI fixed as we did for the master branch:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/857

please follow this rc pipeline:
https://portaldesigntime.jaas-gcp.cloud.sap.corp/job/ci-portal-cf-cdm-store-service-voter/job/rc/21/



 
From: Malekan, Yael <yael.malekan@sap.com>
Date: Monday, 29 August 2022 at 11:36
To: Margieh, Jawad <jawad.margieh@sap.com>, Wilfand, Kfir <kfir.wilfand@sap.com>, Frishberg Barak, Oren <oren.frishberg.barak@sap.com>, Dagan, Saar <saar.dagan@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: RE: RC Candi fix

Hi Jawad,

Please merge the PR to RC - https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/854 and update once the CI is green.
Once the CI will be green, I’ll update the RC test systems and will trigger the deployment.
 
Regards,
Yael
 
From: Margieh, Jawad <jawad.margieh@sap.com> 
Sent: Monday, 29 August 2022 10:32
To: Malekan, Yael <yael.malekan@sap.com>; Wilfand, Kfir <kfir.wilfand@sap.com>; Frishberg Barak, Oren <oren.frishberg.barak@sap.com>; Dagan, Saar <saar.dagan@sap.com>; Adoram, Nili <nili.adoram@sap.com>; Yurowitz, Daniel <daniel.yurowitz@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix
 
Validated successfully on LTS
 
From: Malekan, Yael <yael.malekan@sap.com>
Date: Monday, 29 August 2022 at 10:09
To: Wilfand, Kfir <kfir.wilfand@sap.com>, Frishberg Barak, Oren <oren.frishberg.barak@sap.com>, Dagan, Saar <saar.dagan@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: RE: RC Candi fix

Hi @Fried, Yoav, @Margieh, Jawad – did you verified the fix on LTS?
 
Regards,
Yael
 
From: Wilfand, Kfir <kfir.wilfand@sap.com> 
Sent: Sunday, 28 August 2022 19:26
To: Frishberg Barak, Oren <oren.frishberg.barak@sap.com>; Dagan, Saar <saar.dagan@sap.com>; Adoram, Nili <nili.adoram@sap.com>; Malekan, Yael <yael.malekan@sap.com>; Yurowitz, Daniel <daniel.yurowitz@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix
 


CI is green!!!
@Frishberg Barak, Oren – thanks for your help, I opened a ticket for a technical user:
https://fiorilaunchpad.sap.com/sites#Help-Inbox&/detail/7005180671/ZSER



 
From: Frishberg Barak, Oren <oren.frishberg.barak@sap.com>
Date: Sunday, 28 August 2022 at 18:34
To: Dagan, Saar <saar.dagan@sap.com>, Wilfand, Kfir <kfir.wilfand@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Malekan, Yael <yael.malekan@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix

Hi,
I am unable to logon to the PPMS system (I7P) for changing the password:
 

@Wilfand, Kfir, please ask access for a technical user and replace the credentials in vault
See technical user section in: https://wiki.one.int.sap/wiki/display/PPMS/CV+Part+FOSS
Thanks,
Oren
 
From: Frishberg Barak, Oren <oren.frishberg.barak@sap.com>
Date: Sunday, 28 August 2022 at 18:11
To: Dagan, Saar <saar.dagan@sap.com>, Wilfand, Kfir <kfir.wilfand@sap.com>, Adoram, Nili <nili.adoram@sap.com>, Malekan, Yael <yael.malekan@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix

hi
401 means un authotized. i guess it means the password expired after 2 years.I will try to connect when i am at home.
Thanks
Oren
From: Dagan, Saar <saar.dagan@sap.com>
Sent: Sunday, August 28, 2022 6:06:28 PM
To: Wilfand, Kfir <kfir.wilfand@sap.com>; Adoram, Nili <nili.adoram@sap.com>; Malekan, Yael <yael.malekan@sap.com>; Yurowitz, Daniel <daniel.yurowitz@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix
 
Hi Kfir,
 
Thanks for the update.
Please run it with skip ppms.
 
Thanks and BR,
Saar
From: Wilfand, Kfir <kfir.wilfand@sap.com>
Sent: Sunday, August 28, 2022 5:58:58 PM
To: Adoram, Nili <nili.adoram@sap.com>; Malekan, Yael <yael.malekan@sap.com>; Yurowitz, Daniel <daniel.yurowitz@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix
 
Hello All, 

The CI reached the Integration step, but failed on IPScan and PPMS with this error:

17:47:48 [sapCheckPPMSCompliance] Step execution failed (category: undefined). Error: failed to retrieve SCV '73555000100200008841': failed to send request to path /odataint/borm/odataforosrcy/SoftwareComponentVersions('73555000100200008841')?$format=json: failed to send request to path /odataint/borm/odataforosrcy/SoftwareComponentVersions('73555000100200008841')?$format=json: request to https://i7p.wdf.sap.corp/odataint/borm/odataforosrcy/SoftwareComponentVersions('73555000100200008841')?$format=json returned with response 401 Unauthorized

It’s a central PPMS issue dealing right now, since this morning and already open a dedicated ticket:
https://support.wdf.sap.corp/sap(bD1lbiZjPTAwMSZkPW1pbiZpPTE=)/bc/bsp/sap/crm_ui_start/default.htm?saprole=ZCSSNEXTPROC&crm-object-type=CRM_SRQM_INCIDENT&crm-object-keyname=OBJECT_GUID&crm-object-value=0090FAE68C2A1EED89D556CF1CEBC60F

Since the last commit, you insert in not contain dependency changes. I recommend temporarily disabling this step. 
Can you approve that?

 
From: Wilfand, Kfir <kfir.wilfand@sap.com>
Date: Sunday, 28 August 2022 at 15:54
To: Adoram, Nili <nili.adoram@sap.com>, Malekan, Yael <yael.malekan@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: Re: RC Candi fix

I opened a very high ticket for Jaas support:
https://itsm.services.sap/sp?id=sap_ticket_form&is_new_order=true&table=incident&sys_id=c42369961b6191108ff341939b4bcb80



 
From: Adoram, Nili <nili.adoram@sap.com>
Date: Sunday, 28 August 2022 at 15:52
To: Malekan, Yael <yael.malekan@sap.com>, Yurowitz, Daniel <daniel.yurowitz@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Cohen, Adam <adam.cohen01@sap.com>, Wilfand, Kfir <kfir.wilfand@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: RE: RC Candi fix

+@Wilfand, Kfir from DevOps
 
From: Malekan, Yael <yael.malekan@sap.com> 
Sent: Sunday, 28 August 2022 15:49
To: Yurowitz, Daniel <daniel.yurowitz@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: RE: RC Candi fix
 
Hi,
 
I’m the ops on duty.
 
Regards,
Yael
 
From: Yurowitz, Daniel <daniel.yurowitz@sap.com> 
Sent: Sunday, 28 August 2022 15:23
To: Margieh, Jawad <jawad.margieh@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Cc: DL BTP Core AP UE Services IL Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>
Subject: RE: RC Candi fix
 
Approved.
 
Who in DevOps is on this?
 
Thanks,
Daniel
 
From: Margieh, Jawad <jawad.margieh@sap.com> 
Sent: Sunday, August 28, 2022 2:05 PM
To: Yurowitz, Daniel <daniel.yurowitz@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Cohen, Adam <adam.cohen01@sap.com>
Subject: Re: RC Candi fix
 
Hi Daniel,
 
The issue was not caught by our integration test because we did not have a test that creates a cdm entity in two tenants that shares the same ID and context.
We did not add the tests yet, however Yoav is working on adding them.
 
We already validated a fix on Dev space, and waiting for cdm-store-service to be available on LTS to validate the fix there as well.
Currently CI is failing, we opened a ticket for DevOps: https://jira.tools.sap/browse/DWPBUGS-2518
 
Of course we will also run the E2E test suites that failed to to the issue to verify that everything is working as expected.
 
 
Thanks,
Jawad
 
 
From: Yurowitz, Daniel <daniel.yurowitz@sap.com>
Date: Sunday, 28 August 2022 at 13:47
To: Izaq, Yosi <yosi.izaq@sap.com>, Fried, Yoav <yoav.fried@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>
Subject: RE: RC Candi fix

Explain why it was not identified internally earlier:
It was not caught in our tests as it is a side effect of a change of inheritance of a class.
Please elaborate on this. This seems like the type of thing that should have been covered by automation.
Proposed preventive measures (what steps should be taken to avoid this or similar issues in the future):
Addition of tests and run E2E test suites.
Were the new tests added already?
Have you expanded to other additional similar situations?
 
 
Thanks,
Daniel
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Sunday, August 28, 2022 1:28 PM
To: Yurowitz, Daniel <daniel.yurowitz@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>
Subject: Re: RC Candi fix
 
It is. The dup html5 provider regression.
10x
Yosi
 
From: Yurowitz, Daniel <daniel.yurowitz@sap.com>
Date: Sunday, 28 August 2022 at 13:12
To: Fried, Yoav <yoav.fried@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Margieh, Jawad <jawad.margieh@sap.com>
Subject: RE: RC Candi fix

Do I understand correctly from the description that this is the issue that caused the regression last week?
 
Thanks,
Daniel
 
From: Fried, Yoav <yoav.fried@sap.com> 
Sent: Sunday, August 28, 2022 12:40 PM
To: Yurowitz, Daniel <daniel.yurowitz@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>
Subject: RC Candi fix
 
Hi Daniel,
 
I would like to request an approval for providing a fix via RC_CANDI, with the following details:
 
Description of the bug: HTML5 Proivder duplicated in launchpad designtime.
 
Link to Jira bug (labels, versions, description, risk,… all set in the ticket.):  https://jira.tools.sap/browse/DWPBUGS-2496
 
Fix was already submitted to master and validated.
 
PR created for RC branch and are ready to be merged:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/854
 
 
Thanks,
Yoav
                        1.22.9.2.2.1.2 Leftovers UT+IT
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/858/files

[12:36] Fried, Yoav
Hey Yosi

[12:36] Fried, Yoav
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/commit/87f520ffbd4e921d8c602ebac52808cdd345c4ff

[12:37] Fried, Yoav
this is the test that I added

cdm.store.service/src/test/java/com/sap/portal/cdm/store/webaccess/CdmControllerIT.java:
    @Test()
    public void batch_create2EntitiesUpdate1_expect1UpdatedAnd1Unchanged() throws Exception {
        List<String> sentMessages = new ArrayList<>();
        environmentVariables.set("MIGRATION_TOGGLE", "false");
        int dbEntities = JdbcTestUtils.countRowsInTable(this.jdbcTemplate, this.CdmEntitiesTableName);

        String payload1 = org.apache.commons.io.IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("com/sap/portal/cdm/store/webaccess/batch/batch.create.1.entity.json"));
        mockMvc.perform(post("/cdm_store_service/cdm/entities/").contextPath("/cdm_store_service").contentType(MediaType.APPLICATION_JSON).content(payload1)
                .headers(generateHttpHeaders(additionalAttributes("zoneId1", "instanceId1","username","isProvider")))
                .with(bearerToken(generateDefaultClientCredentialJwt()))).andExpect(status().isOk());

        Assert.assertEquals(1, JdbcTestUtils.countRowsInTable(this.jdbcTemplate, this.CdmEntitiesTableName));

        String payload2 = org.apache.commons.io.IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("com/sap/portal/cdm/store/webaccess/batch/batch.create.1.entity.json"));
        mockMvc.perform(post("/cdm_store_service/cdm/entities/").contextPath("/cdm_store_service").contentType(MediaType.APPLICATION_JSON).content(payload2)
                .headers(generateHttpHeaders(additionalAttributes("zoneId2","instanceId2","username","isProvider")))
                .with(bearerToken(generateDefaultClientCredentialJwt()))).andExpect(status().isOk());

        Assert.assertEquals(2, JdbcTestUtils.countRowsInTable(this.jdbcTemplate, this.CdmEntitiesTableName));

        payload2 = org.apache.commons.io.IOUtils.toString(this.getClass().getClassLoader().getResourceAsStream("com/sap/portal/cdm/store/webaccess/batch/batch.update.same.entity.json"));
        mockMvc.perform(post("/cdm_store_service/cdm/entities/").contextPath("/cdm_store_service").contentType(MediaType.APPLICATION_JSON).content(payload2)
                .headers(generateHttpHeaders(additionalAttributes("zoneId2","instanceId2","username","isProvider")))
                .with(bearerToken(generateDefaultClientCredentialJwt()))).andExpect(status().isOk());

        mockMvc.perform(post("/cdm_store_service/cdm/v2/entities/search").contextPath("/cdm_store_service")
                        .contentType(MediaType.APPLICATION_JSON).with(bearerToken(generateDefaultClientCredentialJwt()))
                        .content("{\n" +
                                "\"x-attribute-username\": \"default_user\"," +
                                "  \"metadata\": {\n" +
                                "    \"context\": {\n" +
                                "      \"id\": \"SAP\",\n" +
                                "      \"contextType\": \"SITE\"\n" +
                                "    }\n" +
                                "  },\n" +
                                "  \"match\": [\n" +
                                "    {\n" +
                                "      \"/cdm/identification/id\": \"cdmId\"\n" +
                                "    }\n" +
                                "  ],\n" +
                                "  \"return\": {\n" +
                                "    \"/cdm/identification/title\": {\n" +
                                "      \"alias\": \"title\"\n" +
                                "    }\n" +
                                "  }\n" +
                                "}").headers(generateHttpHeaders(additionalAttributes("zoneId1","instanceId1","username","isProvider"))))
                .andDo(mvcResult -> {
                    ObjectMapper mapper = new ObjectMapper();
                    JsonNode response = mapper.readTree(mvcResult.getResponse().getContentAsString());
                    Assert.assertEquals("CREATED_TITLE", response.get("data").get(0).get("entity").get("title").asText());
                    Assert.assertTrue(response.get("data").size() == 1);
                });

        mockMvc.perform(post("/cdm_store_service/cdm/v2/entities/search").contextPath("/cdm_store_service")
                        .contentType(MediaType.APPLICATION_JSON).with(bearerToken(generateDefaultClientCredentialJwt()))
                        .content("{\n" +
                                "\"x-attribute-username\": \"default_user\"," +
                                "  \"metadata\": {\n" +
                                "    \"context\": {\n" +
                                "      \"id\": \"SAP\",\n" +
 
i324180 2 hours ago Member
SUB_ACCOUNT and sub_account

	Reply…
                                "      \"contextType\": \"SITE\"\n" +
                                "    }\n" +
                                "  },\n" +
                                "  \"match\": [\n" +
                                "    {\n" +
                                "      \"/cdm/identification/id\": \"cdmId\"\n" +
                                "    }\n" +
                                "  ],\n" +
                                "  \"return\": {\n" +
                                "    \"/cdm/identification/title\": {\n" +
                                "      \"alias\": \"title\"\n" +
                                "    }\n" +
                                "  }\n" +
                                "}").headers(generateHttpHeaders(additionalAttributes("zoneId2","instanceId2","username","isProvider"))))
                .andDo(mvcResult -> {
                    ObjectMapper mapper = new ObjectMapper();
                    JsonNode response = mapper.readTree(mvcResult.getResponse().getContentAsString());
                    Assert.assertEquals("UPDATED_TITLE", response.get("data").get(0).get("entity").get("title").asText());
                    Assert.assertTrue(response.get("data").size() == 1);
                });
    }

                        1.22.9.2.2.1.3
                    1.22.9.2.2.2

                1.22.9.2.3
            1.22.9.3 non team BLIs

                1.22.9.3.1 tenant separation, role collections issue, frosta, novartis

                    1.22.9.3.1.1 issue summary
TLDR: semantic obtains a token for access to xsuaa apis to carry on role collections creation in certain flows: CTMS import of content, auto sync of external provider etc.
semantic uses cache (implementation in shared lib). but the cached token doesn't contain subdomain info and this is not unique to the tenant (subdomain is unique per landscape which is unique per tenant)
src/utils/technical-token.js
    async requestAccessTokenByDestinationConfig(loggerCtx, subDomain) {

        try {
            token = await technicalToken.requestCachedToken({
                loggerCtx,
                credentialsConfig: {
                    tokenURL: destinationConfig.tokenServiceURL,
                    clientId: destinationConfig.clientId,
                    clientSecret: destinationConfig.clientSecret,
                    cacheKey: apiaccessDestination,
                },
            });

hotfix: https://jira.tools.sap/browse/DWPBUGS-2602
date: 08/09/22 16:05:00  
Master: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/1038
Live: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/pull/1039


email thread 1:
------------------------------ 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Monday, August 29, 2022 1:10 PM
To: Limor, Shani <shani.limor@sap.com>; Schwartz, Ilan <ilan.schwartz@sap.com>
Subject: Re: Federated role automatically appearing in BTPcockpit
 
Hi Ilan,
 
It is as Shani stated. Both these tickets passed through my team. The first one we suspect a bug in cockpit component where role of one tenant is created in a different tenant. IIRC Hadar or Gil handled and they moved it to cockpit component.
The second was wrongly assigned to my team. We spent a lot of time and meetings w/ Abap and Steampunk members trying move this forward. Our colleagues from said team cont. the investigations but according to Helge the cust. has future plans and is no longer interested in investing effort to investigate the original ticket.
 
HTH,
Yosi
 
From: Limor, Shani <shani.limor@sap.com>
Date: Monday, 29 August 2022 at 9:54
To: Schwartz, Ilan <ilan.schwartz@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>
Subject: RE: Federated role automatically appearing in BTPcockpit

Hi Ilan,
 
There are links to 2 incidents.
The second incident - Helge from ABAP FLP took on himself cause the scenario was Steampunk as content provider.
The first incident was handled in Yosi`s team and is now assigned to a different component without processor for ~20 days.
Helge raised a concern that both incidents are related to each other and that they showcase a security issue of roles creation in different customers accounts.
 
Have a great day,
Shani
------------------------------
email thread 2:
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Wednesday, August 24, 2022 3:46 PM
To: Dombrowski, Helge Christian <helge.christian.dombrowski@sap.com>; Kusch, David <david.kusch@sap.com>; Keller, Anne <anne.keller01@sap.com>; Kobi, Hadar <hadar.kobi@sap.com>; Limor, Shani <shani.limor@sap.com>; Tito, Meni <meni.tito@sap.com>
Cc: Avrahami, Olga <olga.avrahami@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Shikva, Gil <gil.shikva@sap.com>; Abramenko, Maria <maria.abramenko@sap.com>
Subject: Re: Federated role automatically appearing in BTPcockpit
 
+ @Tito, Meni
 
From: Dombrowski, Helge Christian <helge.christian.dombrowski@sap.com>
Date: Wednesday, 24 August 2022 at 12:25
To: Izaq, Yosi <yosi.izaq@sap.com>, Kusch, David <david.kusch@sap.com>, Keller, Anne <anne.keller01@sap.com>, Kobi, Hadar <hadar.kobi@sap.com>, Limor, Shani <shani.limor@sap.com>
Cc: Avrahami, Olga <olga.avrahami@sap.com>, Guy, Ariel <ariel.guy@sap.com>, Shikva, Gil <gil.shikva@sap.com>, Abramenko, Maria <maria.abramenko@sap.com>
Subject: RE: Federated role automatically appearing in BTPcockpit

Hi Colleagues,
 
In my eyes the current state of this issue is quite critical, since there seems to be some kind of tenant isolation issue.
 
We have these 2 incidents:
https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/a37bf60fdb041154a827a6b605961906
https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/5ce5164adbcc91501014ba03f39619a3
 
In the Novatis incident we just had the issue that additional roles suddenly appeared in the cockpit, but at least these were roles created by the customer. In the second incident the customer sees roles, that he does not know. Worse based on the naming convention it looks very similar to the Novatis roles. So the assumption is that the customer Forsta AG is actually seeing roles from the customer Novatis!
 
Are you aware if somebody is currently analyzing this issue in depth? We were quite slow with the Novatis incident and the other incident seems to be in a classical component ping/pong loop.
 
CC @Limor, Shani, because I think this is something for your current role as I understood it. Sorry, if wrong!
 
Best regards,
Helge
 
From: Dombrowski, Helge Christian 
Sent: Donnerstag, 18. August 2022 11:18
To: Izaq, Yosi <yosi.izaq@sap.com>; Kusch, David <david.kusch@sap.com>; Keller, Anne <anne.keller01@sap.com>; Kobi, Hadar <hadar.kobi@sap.com>
Cc: Avrahami, Olga <olga.avrahami@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Shikva, Gil <gil.shikva@sap.com>
Subject: RE: Federated role automatically appearing in BTPcockpit
 
Hi Colleagues,
 
We strongly suspect that this is some kind of error on customer site.
 
@Keller, Anne and me plan to have another call with the customer.
 
Best regards,
Helge
 
From: Izaq, Yosi <yosi.izaq@sap.com> 
Sent: Montag, 8. August 2022 14:21
To: Dombrowski, Helge Christian <helge.christian.dombrowski@sap.com>; Kusch, David <david.kusch@sap.com>; Keller, Anne <anne.keller01@sap.com>; Kobi, Hadar <hadar.kobi@sap.com>
Cc: Avrahami, Olga <olga.avrahami@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Shikva, Gil <gil.shikva@sap.com>
Subject: Federated role automatically appearing in BTPcockpit
 
Hi Helge,
 
Re. Ticket: https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/a37bf60fdb041154a827a6b605961906
 
I have seen that you’ve assigned it to RCP component (which is LP transport service). However I think there’s a mistake here. The transport system used in this scenario (Steampunk, ABAP on demand) is different. We have verified that in two ways.
First. Hadar in meeting with the customer reproducing the issue and LP transport service is not involved at all.
Second, we have discussed with @Kusch, David and @Keller, Anne and understood that LP transport service is not part of the flow.
 
Can you please assign back to ABAP until identifying the correct component?
We are happy to assist but according to what @Kobi, Hadar saw in meeting with the customer this is not related at all to our components.
 
If you require more information, I’d suggest you schedule a meeting with the customer. We will be happy to assist in any way and attend such meeting as well.
 
Thanks!
Yosi
                    1.22.9.3.1.2

                1.22.9.3.2 upgrading approuter to version 11.4.0
                and adding two major features of approuter:
| 1.	Dynamic logging level
| 2.	Dynamic Identity provider

Design WIP: https://wiki.one.int.sap/wiki/display/CPPortals/Approuter+version+11.4.0+-+Dynamic+Logging+and+Dynamic+IDP 


            1.22.9.4 Sprint reviews

                1.22.9.4.1 2022 9a
- EUXTEAMSAAR-3107 [Dev scenario] HTML5 Apps provider - Error handling and reporting - Client impl.
Adam completed. closed last Leftovers. already Demo in 8b 

- EUXTEAMSAAR-3100 [CEP] E2E validation activities for beta release - Yosi's team 
done. import local workpages tested E2E. automation coverage too early. supported other teams for CEP-beta bugs 

- EUXTEAMSAAR-3108 [CEP]: CDM Store – add "timestamp" attribute to all events
PRs in place. need validation on external provider sync. for that Yoav is adding delta-update functionality to the mock provider

                1.22.9.4.2 2022 9b

            1.22.9.5
        1.22.10 T10

            1.22.10.1 [CEP] Implement materialized view for paginated search - Design
https://jira.tools.sap/browse/EUXTEAMSAAR-3132
design: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3092748750

            1.22.10.2
        1.22.11 T11

            1.22.11.1 signoff
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2211+signoff
Here is our commitment for Takt 2211 - Team capacity 49 PDs

See below list of candidates for T11 (prioritization may change depending on the effort estimation). If anything is missing, please let me know.

Team Capacity  -  49 PDs

Support - 20 PDs



Tasks:

Move team subaccounts and spaces to EU12 Phase 1: create on fully functional space on EU12.
Total: 5 PDs



Complete validation of multi url template with s4 content 
IT + manual validation (only possible when all bugs are resolved)

Total: 2 PDs



New/Leftovers:  



Epic/Area	BLI/Activity Estimated Effort Comments / Action items

Security /Supportability 	[Security] Cred-store - adapt our code to use key/file instead of password - DTS 	
Total: 5 PDs 

Continue leftover from T10 , migration execution plan 

Mass content and admin UI 	[CEP] CDM store as search service	
Total: 5 PDs


Mass content and admin UI 	
[CEP/Mass Content]: CDM store supports random access pagination

Total:  24 PDs


Mass content and admin UI 	CEP] CDM store consume events from RT services	
Total: 27 PDs

soft commit

Mass content and admin UI 	CEP] Performant APIs for CEP-activation - Design 	
Total: 5 PDs

soft commit

complete leftovers from T10 - baseline e, and evaluate options

Mass content and admin UI 	[CEP] Performant APIs for CEP-activation	
Depends on the completion of the design.

soft commit



            1.22.11.2
        1.22.12 T12

            1.22.12.1  Signoff
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2212+signoff

subject: Yosi’s Team 2212 Sign-off

Body:
Hi all,
Here is our team signoff for T12.

Overall team capacity is 30 PDs.

Support efforts are 20 PDs.



Tasks:
Move team subaccounts and spaces to EU12 - Ongoing - 3 PDs
Transition from application logs to cloud logging- First phase - T12B - Content Lachnish, Hani - align of the final scope and requirements.
1 PD to align on requirements. actual effort depends on it. HLEE: M


Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 CEP] CDM store consume events from RT services 14 A/B

2 [CEP] Enable content package update 33 SOFT


 

            1.22.12.2 [CEP] CDM store consume events from RT services 
            https://jira.tools.sap/browse/EUXTEAMSAAR-3135
Motivation:
In CEP Standard Edition we introduce two new entities - Spaces and Workpages to allow more flexibility in the Page Building and Grid layouting 

              More information can be found here - CEP - Business Domain Model.docx

In addition , we need to support Mass-Content in design time scenarios for all the entities , the old ( app, group, catalog , role)  and the new ( Spaces and Workpages)  , which are  saved under different db sources like  CDM store and on GraphQL.

Both needs came together to a solution which required writing the Admin UI in a manner that will support search and  pagination of entities coming from different db sources.

User Story

 As an admin I would like to get the most updated content ( spaces and workpages as well )  on the content manager tables
 

Technical Information

Scope:
implementation of RT event consumption - upon contract definition with RT service ( Shany's team) -  as per BLI https://jira.tools.sap/browse/EUXTEAMYAEL-1612 
handle timestamps to prevent race condition 
timestamps in where clause tsnew> tsexist 
validation consumption - Unit test and CDM store integration tests 
In case Shany side is completed ( planed for T12A) , run cross validation

Test-Scope: https://wiki.one.int.sap/wiki/display/CPPortals/CDM+Store+Service+Consume+Events+from+GraphQL+Runtime+Service+-+Test+Scope 
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/887 

            1.22.12.3
        1.22.13 T13
Signoff: https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2213+signoff 
Team Capacity  - 39 PD's

Support - 20 PDs
Tasks:
New/Leftovers:  

Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 CEP] CDM store consume events from RT services 1 A Leftover: commit PR's, resolve recent schema issue
2 rebranding launchpad ( 12/1) - API hub , links 3 A/B Could be delayed due to xmas vacations
3	Cred store E2E validation 	6	A/B	
depends on Shefer, Shany to complete her related BLI
4	[CEP] Support for custom domain based on IAS - Validation 	1	A	depends on content and test environments readiness
5	[CEP] Enable content package update	36	SOFT	


1 1 A Leftover: commit PR's, resolve recent schema issue
2 3 A/B Could be delayed due to xmas vacations
3	6	A/B	
depends on Shefer, Shany to complete her related BLI
4	1	A	depends on content and test environments readiness
5	36	SOFT	


            1.22.13.1 CEP] CDM store consume events from RT services 
https://jira.tools.sap/browse/EUXTEAMSAAR-3135

            1.22.13.2 rebranding launchpad ( 12/1) - API hub , links 
https://jira.tools.sap/browse/EUXTEAMSAAR-3211
Gerrit PR: https://git.wdf.sap.corp/c/contentpipeline/+/5785706 

            1.22.13.3 Cred store E2E validation 	
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3212

Motivation:
We have a BCP ticket where stakeholder deployment started to fail after mTLS support was added for the XSUAA instance.
Logs shows that the credential-store service respond with 413 –
errorDescription: 'The credential exceeded maximum size',\n    error_code: 'payload_too_large'
This is due to the fact that mTLS credentials contain a certificate/key which makes the credential larger.
According to the cred-store colleagues we will need to adapt our code to use key/file instead of password.
Cred store Jtrack: https://jtrack.wdf.sap.corp/browse/NGPBUG-194180

User Story: . 
Technical Information Prerequisite (which in an case should already exist) – All should be familiarized with flows that use it. ( See mail attached).
Shared lib should be enhanced with method to store credentials as key (if it suffice) or file. https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/master/src/security/secure-store.js#L112
DTS should write to cred store using this new method,but reading also for 'old'  (lazy migration). https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/blob/master/src/utils/store-activation-util.ts#L281
Until all other teams are ready use env var with default false

Common rt approuter should read using this new method, but reading also for 'old' (lazy migration) https://github.wdf.sap.corp/Portal-CF/common-rt-approuter/blob/master/src/extensions/blue-box-utils/blue-box-extensions.ts#L40
Service broker should delete (on delete instance) from both old and new https://github.wdf.sap.corp/Portal-CF/portal-cf-service-broker/blob/master/src/lib/hooks.js#L53
Test of regressions and new.
deploy of apollo with plugin/dynamic tiles, federate it and see it works
use mtls with same flow
deploy of embedded cotnent provider  (like workflow, or one that already is tested).
Other option (I'm less favour of it, to have full migration and use just new).

 

Scope:
E2E test scope  and test system. Work with Avrahami, Olga  . Align with Nili's and Shany test scopes. 
related BLI:
Shany's - https://jira.tools.sap/browse/EUXTEAMYAEL-1762
Nili's -  https://jira.tools.sap/browse/EUXTEAMNILI-6212 
Run E2E validation for involved scopes:
Apollo

Validation bugs:
https://jira.tools.sap/browse/DWPBUGS-3038 - cred
https://jira.tools.sap/browse/DWPBUGS-3039 - broker

Apollo E2E issue:
Subject: RE: LTS_APOLLO_INTEGRATION job not working - mTLS service broker
+@Tito, Meni, @Frishberg Barak, Oren, @Wilfand, Kfir
Heads up – ALL Apollo automation tests are red since sprint beginning. The issue is reported in this jira- https://jira.tools.sap/browse/DWPBUGS-3034, which pending response from piper team https://itsm.services.sap/sp?id=sap_ticket_form&table=incident&sys_id=c472c7a21bf7591062e643b5bb4bcb19&view=portal If won’t be solved today, tests should be executed manually - before the code split (tomorrow) and during the Q-Gate (next Sunday). Since we talk about Apollo, such manual tests will be time consuming. Best regards, Olga

Test scope: https://wiki.one.int.sap/wiki/pages/viewpage.action?spaceKey=CPPortals&title=Test+Scope+%5BE2E%5D+-+Apollo+federated+support+mTLS%2C+use+CredStore+File+storage 

PRs: Hi Yosi, can you please review https://github.wdf.sap.corp/Portal-CF/ApolloSimpleContent/pull/5 https://github.wdf.sap.corp/Portal-CF/ApolloSimpleContent/pull/4
i'm adding extensions so should not efect existing flows 


Gap re. Certificate rotation:
From: yosi.izaq@sap.com
When: 16:00 - 16:30 25 January 2023 
Subject: MTLS cred store gap
 
 
Please add anyone you think is needed.
Issue:
We have cert. expiration policy. Every time the certificates are expired the cust. Needs to perform some manual operation to renew the certificate and then unbind+bind approuter<->XSUAA + redeploy content
This also needs to be performed for all the automation that use MTLS (like Nili portal/LP UI E2E)
 
Agenda:
Discuss what need to be documented for cert. rotation by cust (the redeploy mainly)
Discuss if we can find a way to make the procedure more streamlined for our customers and our own automations
 
10x!
Yosi

Kalman: "
Adding general documentation about rotating x.509 certs - https://help.sap.com/docs/btp/sap-business-technology-platform/rotate-x-509-secrets
What is different in our case is that we will require the user to  also redeploy in order to save new uaa key cert in cred store for federation apollo"

            1.22.13.4 [CEP] Support for custom domain based on IAS - Validation 	, tags: Support for custom domain based on IAS validation manual
https://jira.tools.sap/browse/EUXTEAMSAAR-3207
Apollo documentation (for training)  - https://wiki.one.int.sap/wiki/display/CPPortals/Apollo+Documentation
Information how to setup "Enel" like landscape -https://wiki.one.int.sap/wiki/display/CPPortals/Configuring+Custom+Domain+For+Federated+Content+Apolllo+scenario
Test-Scope: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3238822009
https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Support+for+custom+domain+based+on+IAS+-+Test+Scope
Manual validation: 
https://cdautoeu12rct.launchpadrcteu12.cfapps.eu12.hana.ondemand.com/site?siteId=67b641ba-56a3-4e8e-998c-1bafc200e7ae
(admin / adminUser1)
Validate numbers on Dynamic Tiles are working
Navigate to applications and validate they are opened as expected.
Validate Shell Plugin is shown in the top right next to the User Icon

            1.22.13.5 [CEP] Enable content package update	
https://jira.tools.sap/browse/EUXTEAMSAAR-3198
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/925/files
Gil-Shikva

            1.22.13.6 Setting up a custom domain on SAP Build Work Zone, standard edition - KT 
What’s New - use this page to be updated on all latest Workzone st and adv/Portal releases: https://help.sap.com/whats-new/cf0cb2cb149647329b5d02aa96303f56?locale=en-US&Component=Cloud%20Portal%20Service%3BSAP%20Build%20Work%20Zone,%20advanced%20edition%3BSAP%20Build%20Work%20Zone,%20standard%20edition
 
Setting Up a Custom Domain documentation: https://help.sap.com/docs/build-work-zone-standard-edition/sap-build-work-zone-standard-edition/setting-up-custom-domain
 
      Identity Authentication - Configure OpenID Connect Application for Authorization Code Flow: https://help.sap.com/docs/IDENTITY_AUTHENTICATION/6d6d63354d1242d185ab4830fc04feb1/4a9425465cbb4a7aa7c3d86c9cabca51.html
 
Also the links to recordings:
 
Custom Domain in  nutshell – Nili’s demo: ​Takt 2301 review-20230214_222534-Meeting Recording.mp4 icon Takt 2301 review-20230214_222534-Meeting Recording.mp4
 
Recording of the session: ​Setting up a custom domain on SAP Build Work Zone, standard edition - KT-20230419_120213-Meeting Recording.mp4 icon Setting up a custom domain on SAP Build Work Zone, standard edition - KT-20230419_120213-Meeting Recording.mp4

            1.22.13.7
        1.22.14
    1.23 2023 , year of CEP, workzone standard and advanced editions, tags: 2023, CEP
CEP sync wiki: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3302442793
test subaccount on LTS:
https://e2estdlts.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites?newUI=true&sap-ui-version=untested#Content-ManageNew?sap-app-origin-hint=
ADMINISTRATOR/Welcome1!


        1.23.1    Takt01 , T01 

            1.23.1.1    signoff
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2301
Team Capacity  - 56 PDs

Support - 20 PDs
Tasks:
New/Leftovers:  


Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 [CEP] Support for custom domain based on IAS - Validation 10 A


2 Admin UI - API to fetch snapshot and cherrypick entities for content explorer 22 A/B
3	[CEP] Enable content package update	33	SOFT	
5	Schema changes   - add keyword as mandatory on the tag section	5	SOFT	


 
            1.23.1.2 [CEP] Support for custom domain based on IAS 
            BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3207
            Test-Scope: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Support+for+custom+domain+based+on+IAS+-+Test+Scope
            Custom Domain Q-Gate test - PORTALSBACKLOG-791 -https://jira.tools.sap/browse/PORTALSBACKLOG-791  
            add more jobs to Jenkins - https://jira.tools.sap/browse/EUXDEVOPS-3239

            1.23.1.3 Admin UI - API to fetch snapshot and cherrypick entities for content explorer 

design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BAdmin+UI%5D+-+API+to+fetch+snapshot+and+cherrypick+entities+for+content+explorer
Test-Scope:  https://wiki.one.int.sap/wiki/display/CPPortals/%5BTest+Scope%5D+Provider+Snapshot+-+add+isCerryPick+option+to+CDM+Store+Search+metadata
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/914
IT for isCherryPick of businessapp: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/919/files
<url:/Users/i500695/work/SAP/PRs/cdm_store/add_is_cherrypicked_914>

            1.23.1.4 bugs 

                1.23.1.4.1 https://jira.tools.sap/browse/DWPBUGS-3173, New content manager table do not show updates if description has more then 1 line 
JIRA:DWPBUGS-3173 - replace title, desc, id and version using jackson
Gil fixed. https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/918/files

                1.23.1.4.2 https://jira.tools.sap/browse/DWPBUGS-3032?filter=259181, HTML5 app isn't part of CDM RT API V1
 JIRA:DWPBUGS-3032 -create new object on targetAppConfig SAP_APP and not all targetAppConfig as a code owner.

                1.23.1.4.3
            1.23.1.5
        1.23.2    Takt02 , T02 

            1.23.2.1    Sign-off
Hi all,

Here is our team signoff for T02.

Team Capacity  - 55 PDs

Support - 20 PDs

Tasks:

Support Performance team with validation of timeout issue Hamisha, Ronen
BLIs:  

Priority

BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 [CEP] Enable content package update 28 A/B


2 [Eng] Node 16/18 Update - Yosi's team 7 A/B Dependency: @Adoram, Nili  shared lib – should be complete this week

3 [CEP]Stable and Unique IDs for Elements of Work Pages 11 SOFT


4 CEP] content package automations 8 SOFT



            1.23.2.2 [CEP] Enable content package update
https://jira.tools.sap/browse/EUXTEAMSAAR-3198
test-scope: 
design-review:
PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/925

            1.23.2.3 [Eng] Node 16/18 Update 
Note. NestJS also upgrades to version 9:
-        "@nestjs/common": "8.2.6", 
         to:
+        "@nestjs/common": "9.3.9",


PRs: https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/315/files
<url:/Users/i500695/work/SAP/PRs/node14_to_18_upgrade/portal-cf-provisioning-service-new>
https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/130
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/614
https://github.wdf.sap.corp/Portal-CF/amqp-client/pull/86

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/614
https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/130 
https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/405 
https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/117
https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/118 
https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/409

            1.23.2.4 [CEP]Stable and Unique IDs for Elements of Work Pages 

PRs:
UX: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-provider-manager/pull/261/files
Store: 
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/924
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/922


            1.23.2.5 [CEP] content package automations 

            1.23.2.6
            1.23.2.7 cross-effort
Multiple subaccounts, Adam and Jawad:
https://wiki.one.int.sap/wiki/display/CPPortals/Multiple+Cross-subaccount+HTML5+Content+Providers

            1.23.2.8
        1.23.3    Takt03 , T03 

            1.23.3.1     QA day content package update


            1.23.3.2 Configurations HL Overview & Design.
 https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3354660791

            1.23.3.3 others

                1.23.3.3.1 autovacuum_vacuum_scale_factor
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/948
From aae7bd25cd8c3f910e0db91c972f4263ab5a8621 Mon Sep 17 00:00:00 2001
From: Jawad Margieh <jawad.margieh@sap.com>
Date: Thu, 23 Mar 2023 14:28:40 +0200
Subject: [PATCH] autovacuum_vacuum_scale_factor

---
 .../db/migration/postgres/V23.03.23__vacuum_scale_factor.sql | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 cdm.store.service/src/main/resources/db/migration/postgres/V23.03.23__vacuum_scale_factor.sql

diff --git a/cdm.store.service/src/main/resources/db/migration/postgres/V23.03.23__vacuum_scale_factor.sql b/cdm.store.service/src/main/resources/db/migration/postgres/V23.03.23__vacuum_scale_factor.sql
new file mode 100644
index 000000000..99be024ae
--- /dev/null
+++ b/cdm.store.service/src/main/resources/db/migration/postgres/V23.03.23__vacuum_scale_factor.sql
@@ -0,0 +1,5 @@
+ALTER TABLE "cdm"."CDM_ENTITIES" SET (autovacuum_vacuum_scale_factor = 0.02);
+ALTER TABLE "cdm"."RELATIONS" SET (autovacuum_vacuum_scale_factor = 0.02);
+ALTER TABLE "cdm"."entities_searchable_text" SET (autovacuum_vacuum_scale_factor = 0.05);
+ALTER TABLE "cdm"."pre_commit_relations" SET (autovacuum_vacuum_scale_factor = 0.05);
+ALTER TABLE "cdm"."snapshot_imports" SET (autovacuum_vacuum_scale_factor = 0.05);
                1.23.3.3.2
            1.23.3.4
        1.23.4    Takt04 , T04 

            1.23.4.1    Sign-off
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2304


Team Capacity  - 47 Pds, out of which:
•	Support Effort - 20 PDs
•	Security Effort – 3 PDs
 
Tasks:
 
Security Effort:
a.	Security issues - Whitesource vulnerabilities - phosphor
b.	Preparation  for security validation
 
BLIs: 
| Priority	BLI	Effort Estimation (in PDs)	Planned Sprint (A/B)	Comments
| 1	Security: Update dependencies for security compliance
| 3	B	
| 2	[CEP] content package automations
| 5 	B	leftover
| 3	Consume HTML5 applications from multiple subaccounts
| 17	B	Including team Architect capacity
| 
| 4	CEP Content Channels - Create content package with Package id from Central Store
| 10	SOFT	
 

id=Security_issues___Whitesource_vulnerabilities___phosphor
            1.23.4.2 Security issues - Whitesource vulnerabilities - phosphor
Shirly-Cohen
bli: https://jira.tools.sap/browse/EUXTEAMSAAR-3304
phosphor: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/952/files
jackson issue:
    - https://github.com/FasterXML/jackson/wiki/Jackson-Release-2.13
    - https://github.com/FasterXML/jackson-databind/issues/3214 
For an absent property Jackson injects NullNode instead of null to a JsonNode-typed constructor argument of a @ConstructorProperties-annotated constructor

    - 
class-validator: https://docs.nestjs.com/techniques/validation

            1.23.4.3 Preparation  for security validation
https://jira.tools.sap/browse/EUXTEAMSAAR-3316
 link to the security validation 2023.
https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3446615774
 
id=content_package_automations
            1.23.4.4 content package automations
Gil-Shikva , Alon-Manshari, Kalman-Labinsky
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3167 
PRs: https://github.wdf.sap.corp/Portal-CF/Backbone-Automations/pull/31/files
<url:/Users/i500695/work/SAP/PRs/e2e_automations/content_package_update_automations>

                1.23.4.4.1 wiki 
                https://wiki.one.int.sap/wiki/pages/viewpage.action?spaceKey=CPPortals&title=Content+Package+Update+Automations
git: https://github.wdf.sap.corp/Portal-CF/Backbone-Automations/tree/contentPackageTests/test/content-package
Motivation
In this automation, we are testing a flow of updating a content package via several test cases. These test cases are (as of April 2023):
Update - updating cdm entities in the content package - e.g. changing the title of an existing entity
Create - adding new entities to the content package - e.g. adding a new role
Delete - delete existing entity - e.g delete an app
Environments: 

lts	Yosi Test Cockpit2 (https://canary.cockpit.btp.int.sap/cockpit/#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/caaedb7d-53e1-4d45-97d3-9a633ea55382/subaccountoverview)	Site-Directory (https://yosi-e2e-tests.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites?pkgSyncOn=true#Provider-Manage?sap-app-origin-hint=)	Ur I-user or the credentials mentioned below
rct	cockpit(https://canary.cockpit.btp.int.sap/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/22d32245-1c00-4c03-9315-8aeb7f6a7ee9/subaccountoverview)	Site Directory  (https://update-package-rct.dt.launchpadrcteu12.cfapps.eu12.hana.ondemand.com/sites#Site-Directory)	credentials mentioned below
Note: use chromium 

Cards - all of the above + cards

Test Case Folder Structure:
A test case is structured in the following way:

content/
├── update/
│   ├── i18n
│   ├── manifest.json
│   ├── artifacts (optional)
├── create/
│   ├── i18n
│   ├── manifest.json
│   ├── artifacts (optional)

The code zip each 'create' and 'update' folder - generating content package zip, and then create a "cp_test_config.json" that contains a more relevant data extracted from the manifest.json.

The 'content' folder contains "changes.txt" file that contains what changed after updating the content package.

General Test Case Flow
A generic test case contains the following flow:

Creating a test scenario ("cp_test_config.json" and zipping the content package) → Uploading content package → create a site → assigning roles to the site → verifying the content was create successfully in both DT&RT →

updating the content package → verifying the content was updated successfully in both DT&RT → delete the content package and the site

if the content package contains cards, the version and assets of the cards are being checked as well.

The tests generally works around comparing the 'afterUpdate' and 'afterCreate' objects in the 'cp_test_config.json' of the specific test case.

Running Locally
In order to run the tests, setup an env variable called 'LANDSCAPE' with either your IDE or in .env file, with value of 'lts' or 'rct',

Then add/edit the '.env' file of the root folder and add these variables according to the landscape:

LTS:

BTP_PRODUCT_USERNAME=P000013
BTP_USERNAME=portaltest@mailinator.com
PRODUCT_USERNAME=portaltest@mailinator.com
BTP_PASSWORD=abcUser1
PRODUCT_PASSWORD=abcUser12

RCT:

BTP_PRODUCT_USERNAME=teamuser1234@gmail.com
PRODUCT_USERNAME=teamuser1234@gmail.com
BTP_PASSWORD=QWE11asd
BTP_USERNAME=teamuser1234@gmail.com
PRODUCT_PASSWORD=QWE11asd


After that, run the tests with either the command 'npm run content-package-update:test' or with your IDE ui 
note: I've created a symlink and two files. see:
[i500695@WYLQRXL9LQ:2023-04-30 14:54:12:~/git/Backbone-Automations:]2016$ cat lts.env
BTP_PRODUCT_USERNAME=P000013
BTP_USERNAME=portaltest@mailinator.com
PRODUCT_USERNAME=portaltest@mailinator.com
BTP_PASSWORD=abcUser1
PRODUCT_PASSWORD=abcUser12
[i500695@WYLQRXL9LQ:2023-04-30 14:55:01:~/git/Backbone-Automations:]2017$ cat rct.env
BTP_PRODUCT_USERNAME=teamuser1234@gmail.com
PRODUCT_USERNAME=teamuser1234@gmail.com
BTP_PASSWORD=QWE11asd
BTP_USERNAME=teamuser1234@gmail.com
PRODUCT_PASSWORD=QWE11asd
[i500695@WYLQRXL9LQ:2023-04-30 14:55:04:~/git/Backbone-Automations:]2018$ ln -sf rct.env  .env
[i500695@WYLQRXL9LQ:2023-04-30 14:55:14:~/git/Backbone-Automations:]2020$ ls -l .env
lrwxr-xr-x  1 i500695  staff     7B Apr 30 14:55 .env@ -> rct.env

[i500695@WYLQRXL9LQ:2023-04-30 16:19:59:~/git/Backbone-Automations:]2036$ ls -l .env
lrwxr-xr-x  1 i500695  staff     7B Apr 30 14:55 .env@ -> rct.env
[i500695@WYLQRXL9LQ:2023-04-30 16:20:02:~/git/Backbone-Automations:]2037$ export LANDSCAPE=rct
[i500695@WYLQRXL9LQ:2023-04-30 16:20:13:~/git/Backbone-Automations:]2038$ npm run content-package-update

                1.23.4.4.2

id=Consume_HTML5_applications_from_multiple_subaccounts__
            1.23.4.5 Consume HTML5 applications from multiple subaccounts
jawad-margieh
As described Here  : Tenant awareness is supported in BTP via the subscription mechanism based on the SaaS Registry service.  
A Solution provider can deploy set of HTML5 applications to his account and enable consumers to subscribe to this solution. from CEP side, we would like to enable consumption of these application as a separate HTML5 provider.
concept: https://wiki.one.int.sap/wiki/display/CPPortals/Consumption+of+remote+HTML5+Repository+providers+-+Concept+for+a+new+Content+channel 
Contact : Sklarski, Tsafrir 

https://jira.tools.sap/browse/EUXTEAMSAAR-3315

id=Setup_Automation___Support_Automatic_Assignment_of_Provider_roles_to_Sites___Design
            1.23.4.6 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Design
Gil-Shikva, Kalman-Labinsky
https://jira.tools.sap/browse/EUXTEAMSAAR-3280
Design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Support+Automatic+Assignment+of+Provider+roles+to+Sites+-+Design 


User Story:
As an Admin/Consultant I would like to be able to assign Content provider roles to a Site to enable automatic roles assignment via API call.  

Technical Information
 SDD of the Content API. The topic of this BLI is covered in sections 2.5.4.1/.2. I suggest using this document as reference for subsequent work on this BLI.
https://sap.sharepoint.com/teams/ProjectAlchemy/Shared%20Documents/Architecture/Content%20Model/SDD%20CEP%20Content%20API.docx

Contacts: Krause, Gerald  Sklarski, Tsafrir 

Scope:
Design:

 Two new GraphQL actions :
addAutomaticRoleAssignmentsToSites  (( sections 2.5.4.1 in the SDD of the Content API) - Establish relation between a ProviderID/s and site/s in the QGL service
removeAutomaticRoleAssignmentsToSites ( sections 2.5.4.1 in the SDD of the Content API) ) - Terminates the relation between the ProviderID/s and site/s in the GQL service  
Trigger Automatic assignment between Provider cherrypicked roles to sites ( consult with Sematic service team as needed) :
When the relation above exists and one of the following actions occurred: 
When API addAutomaticRoleAssignmentsToSites is called, all the cherrypicked roles on the provider will be assigned automatically to the related sites
Manual or automatic sync on Provider  is triggered , all provider roles  with "Content Addition Mode" set to automatic will be assigned to the related sites
When Manually cherrypicking roles, the roles will be assigned to the related sites
Terminate relation  between the provider and the site, when site or provider is deleted, the assignment on the site will not be changed. 
The actions are supported in content administrator scenarios and thus requires corresponding privileges
Design should consider that these APIs will be needed also for the Site entity ( from site to providers ).
 API's should be designed as a public API ( publishing on the API Hub is not in scope of this BLI)

            1.23.4.7 BETA feature toggle ennablement with a roster between the on-duty of the different teams, tags: CEP beta feature toggle sap start standard
wiki: https://wiki.one.int.sap/wiki/display/CPPortals/BETA+feature+toggle+ennablement+with+a+roster+between+the+on-duty+of+the+different+teams
note: BETA feature toggle ennablement with a roster between the on-duty of the different teams 

            1.23.4.8
        1.23.5    Takt05 , T05 

            1.23.5.1    Sign-off
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2305
Public signoff
Hi all,



Team Capacity  - 57 Pds, out of which:

Support Effort - 20 PDs
Security Effort – 3 PDs
 

Tasks:

Leftover Automation - add jobs to Jenkins jobs and dashboard : 1.   from [CEP] Content package update - test automation BLI  2.  Custom domain test
 

Security Effort:

Import/Transport services - Add Malware Scans 
Secval preparation
 

BLIs: 

Priority

BLI

Effort Estimation (in PDs)

Planned Sprint (A/B)

Comments

1 Support CMK and PGB in CDM store - Design  16 A/B

2 Support Object store CMK in Node JS services - Design	6 A

3 Setup Automation - Automatic Assignment of Provider roles to Site - design  12 B


4 Support CMK and PGB in CDM store - Imp 14 SOFT

5 Support Object store CMK in Node JS services - Imp 20 SOFT

6 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp  Depends on design SOFT

7 CDM schema -  change  "path" as mandatory property in the indicatorDataSource  1-10 depends on query on all DCs SOFT

8 Add deleted role to the report chunk for CDM store 5 SOFT
Thanks,

Yosi
            1.23.5.2 Leftover Automation - add jobs to Jenkins jobs and dashboard 
Kalman-Labinsky, Alon-Manshari
https://jira.tools.sap/browse/EUXTEAMSAAR-3344

            1.23.5.3 Import/Transport services - Add Malware Scans 
Alon-Manshari
https://jira.tools.sap/browse/EUXTEAMSAAR-3288
https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/147/files

            1.23.5.4 Secval preparation
Shirly-Cohen
https://jira.tools.sap/browse/EUXTEAMSAAR-3347

            1.23.5.5 Support CMK and PGB in CDM store - Design  , tags: Support CMK and PGB in CDM store - Design  
jawad_margieh
https://jira.tools.sap/browse/EUXTEAMSAAR-3336
design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCMK%5D+CDM+Store+Service+Support+for+multiple+Data+Sources+per+Tenant+ID+-+Design+Document

            1.23.5.6 Support Object store CMK in Node JS services 
Alon-Manshari
Shirly-Cohen
https://jira.tools.sap/browse/EUXTEAMSAAR-3335
https://wiki.one.int.sap/wiki/display/CPPortals/%5BCMK%5D+Support+Object+store+CMK+in+Node+JS+services-Design

            1.23.5.7 Setup Automation - Automatic Assignment of Provider roles to Site - design   
<url:#r=Setup_Automation___Support_Automatic_Assignment_of_Provider_roles_to_Sites___Design>



            1.23.5.8 Support CMK and PGB in CDM store - Imp 
https://jira.tools.sap/browse/EUXTEAMSAAR-3342
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/998/files#diff-6c68349448ec2262f28af83d885312f3ea286fe45a87cbc0caa9f59dc4a73bb4


            1.23.5.9 CDM schema -  change  "path" as mandatory property in the indicatorDataSource 
Alon-Manshari
https://jira.tools.sap/browse/EUXTEAMSAAR-3289
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/440
https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/435

            1.23.5.10 Add deleted role to the report chunk for CDM store
Yoav-Fried
https://jira.tools.sap/browse/EUXTEAMSAAR-3331
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/959

            1.23.5.11 [CEP] trigger activation on a subaccount level - design
https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+trigger+activation+on+a+subaccount+level++-+design

            1.23.5.12 Support CMK for apple in object store
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3502
Devs: Kalman-Labinsky, Yoav-Fried, Alon-Manshari 
PR for UT: https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/169/files
            1.23.5.13
        1.23.6    Takt06 , T06 

            1.23.6.1    Sign-off
Hi all, 

Here is our team signoff for T06.

Team Capacity  - 55 Pds, out of which:

• Support Effort - 20 PDs 
Tasks:

• CDM store Service to support Data termination Process on Unsubscribe Total: 1 PDs  Manshari, Alon 
• E2E validation before GA – 2 PD
   

BLIs:  Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 20 A Shikva, Gil Labinsky, Kalman 

2 [CEP] Performant APIs for CEP-activation 26 SOFT Margieh, Jawad 
3 CDM-Store breaks eventual consistency  16 SOFT Manshari, Alon Cohen, Shirly 
4 Support CMK and PGB in CDM store - Design 3 SOFT
5 Support Object store CMK in Node JS services - Design 4 SOFT

            1.23.6.2  CDM store Service to support Data termination Process on Unsubscribe Total
            1 PDs  Manshari, Alon 

            1.23.6.3  E2E validation before GA 
            2 PD


            1.23.6.4  Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start, tags: Setup Automation - Support Automatic Assignment of Provider roles to Sites for Sap-Start
            - Imp 20 A Shikva, Gil Labinsky, Kalman 
bli: https://jira.tools.sap/browse/EUXTEAMSAAR-3290
design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Support+Automatic+Assignment+of+Provider+roles+to+Sites+-+Design 

test-scope: https://wiki.one.int.sap/wiki/display/CPPortals/Setup+Automation+-+Support+Automatic+Assignment+of+Provider+roles+to+Sites+-+Test+Scope
PRs:
JIRA: EUXTEAMSAAR-3290 - add relation new API: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1001
<url:/Users/i500695/work/SAP/PRs/cdm_store/JIRA_EUXTEAMSAAR_3290__add_relation_new_API>
JIRA: EUXTEAMSAAR-3290 - add base context id property to event messages https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1005
EUXTEAMSAAR-3290 - Provider site relation: https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service/pull/76
 https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service/pull/77
 https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service/pull/92/files

            1.23.6.5  [CEP] performant APIs for CEP-activation 
            Margieh, Jawad 
https://jira.tools.sap/browse/EUXTEAMSAAR-3133
PRs: https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/265/files
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1000/files 
<url:/Users/i500695/work/SAP/PRs/cdm_store/POC_get_cherry_pick_role_relations_new_API>
design: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3092748750 - [CEP] CDM Store / CEP Activation Mass Content Support & Improvements - Design Document


            1.23.6.6  CDM-Store breaks eventual consistency  
            16 SOFT Manshari, Alon Cohen, Shirly 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3365

            1.23.6.7  Support CMK and PGB in CDM store 
            - Design 3 SOFT

            1.23.6.8  Support Object store CMK in Node JS services 
            - Design 4 SOFT

            1.23.6.9 Sap-Start Setup Automation: Support Auto sync callback URL for content package creation from store
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3384
          Gap in Content package creation from store  
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/compare/callback-cp
Jawad made pr, Shirly will add UT and work w/ Boris

            1.23.6.10 import agents, tags: import agents
high level design: https://wiki.one.int.sap/wiki/display/CPPortals/CEP+-+Enable+Transport+Agents+-+Concept

            1.23.6.11
        1.23.7    Takt07 , T07 , tags: 2023 T07 takt07

            1.23.7.1    Signoff
Hi all,

Here is our team signoff for T07. 

Team Capacity  -   24 PDs (3 weeks), out of which:

Support 15 PDs (3 weeks)
Tasks:

BLIs:
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 Support CMK For Apple in CDM store - Imp 16 SOFT

 
2 Support CMK for Apple in Node JS services - Design 10 SOFT

 
3 [O&S 3-8]write an Audit Log event when the export happens 2 A

 
4 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 32 SOFT

Leftovers. Testing, validations and consistency
 
Thanks,

Yosi



            1.23.7.2 Team BLIs
                1.23.7.2.1 Support CMK For Apple in CDM store 
Devs: jawad-margieh
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3342
PRs: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/998

                1.23.7.2.2 Support CMK for Apple in Node JS services 
Devs: Shirly-Cohen
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3335
Design:
PRs: 


                1.23.7.2.3 [O&S 3-8]write an Audit Log event when the export happens 
Devs: Alon-Manshari
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3401
Design:
PRs: https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/156, https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/155 
https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/159

                1.23.7.2.4 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 32 SOFT
Devs: Kalman-Labinsky, Yoav-Fried

            1.23.7.3 external contribution, tags: external contribution

                1.23.7.3.1 FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko , tags: FIORITECHP1-25531 [CEP] Multiple URL Templates for business app Extension 1031 - Transport service marko first code contribution 
                , Degenkolb, Marko <marko.degenkolb@sap.com>
https://jira.tools.sap/browse/FIORITECHP1-25531
Design: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+Transport+Service%3A+Support+URL-Templates+with+Destination
branch resolve-urlTemplateDestination
commit: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/commit/b3aa0a10c7952150e1d8646993c57152c5a67ffe

code:
src/cdm-resolvers/resolvers/businessapp-id-resolver.ts
    private resolveCustomUrlTemplate(urlTemplate:object, params:ResolversParamsDto): void {
        const urlTemplateId = urlTemplate?.[BusinessAppIdResolver.URL_TEMPLATE_ID];
        if(urlTemplateId && (!this.isOOTBUrlTemplate(urlTemplate))) {
            const resolvedUrlTemplateId = this.resolveEntityId(urlTemplateId, params?.providerId);
            urlTemplate[BusinessAppIdResolver.URL_TEMPLATE_ID] = resolvedUrlTemplateId;
        }
        const urlTemplateDestination = urlTemplate?.[BusinessAppIdResolver.URL_TEMPLATE_DESTINATION];
        if(urlTemplateDestination) {
            const resolvedUrlTemplateDestination = this.resolveEntityId(urlTemplateDestination, params?.providerId);
            urlTemplate[BusinessAppIdResolver.URL_TEMPLATE_DESTINATION] = resolvedUrlTemplateDestination;
        }
    }

Hi Yosi,
 
I added the contacts you mentioned to the Design Wiki. Please invite to the review with the team as you proposed. Timing wise every slot which is free in my calendar works. Especially beginning of next week there is still quite some free slots. If its hard to find something, please let me know. I can then try to reshuffle.
 
As we ran out of time in our call let me raise a few further questions by mail:
In BusinessAppDestinationResolver.resolveEntityDestination, property sap.app/destination is populated with the providerId if the destination is undefined/empty. In addition, property sap.app/providerId is added with the providerId as value.
What is the intention behind this logic? Can you please point me to the corresponding design wiki?
In contrast to the other resolvers, BusinessAppDestinationResolver does not inherit from AbstractCdmEntityIdResolver and does not use its central resolveEntityId method. Unfortunately, its own, local implementation behaves differently as it does not transform the providerId to lowercase. Furthermore, the corresponding unit test in test\unit\cdm\resolvers\businessapp-destination-resolver.spec.ts is crafted in a way that this inconsistency is not detected. However, if you let the providerId in those tests have an uppercase character, the tests will fail.
Is there a reason behind this inconsistency? Is there some design wiki you can share for this?
The tests in test\unit\cdm\resolvers\businessapp-id-resolver.spec.ts do only test the logic for the sap.integration section. However, I can’t find tests for the subsequently added sap.integrations support in BusinessAppIdResolver. Where can I find those tests and what was the reason to not add them next to the tests for sap.integration?
 
Many thanks!
Marko


            1.23.7.4 Other teams

                1.23.7.4.1  CEP Activation optimize classic homepage
https://wiki.one.int.sap/wiki/display/CPPortals/CEP+Activation+-+Optimize+classic+homepage

                1.23.7.4.2
            1.23.7.5
        1.23.8    Takt08 , T08 

            1.23.8.1     sign-off
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2308+Sign-Off
Team Capacity  -   43 PDs 
Support 20 PDs 
Total remaining: 23 PDs
Tasks:
CDM schema and schema-validator handover session  - 1 PDs 
Add deleted role to the report chunk for CDM store - bug - 8 PDs 


BLIs:
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 Support CMK For Apple in CDM store - Imp 8 A Leftover

2 Support CMK for Apple in Node JS services - Design 5 A Leftover

3 Support CMK for Apple in Node JS services - Imp 33 SOFT
4 Support CMK for apple in object store 12 SOFT
5 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp  26 SOFT



            1.23.8.2 [Performance] CDM on event
Dev: Adam-Cohen
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3451
PRs: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1052
Design: https://wiki.one.int.sap/wiki/display/CPPortals/CDM-STORE+-+cdm+on+event
design-review-recording: https://sap-my.sharepoint.com/:v:/p/adam_cohen01/EUvd7EOAi9ZLkhgJFmXcCmgB30ADsB9_UNajy4RBpiPJ6A 


            1.23.8.3 Setup Automation - Support Automatic Assignment of Provider roles to Sites 
Dev: Yoav-Fried
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1047

            1.23.8.4 Support CMK For Apple in CDM store 
Dev: Jawad
followup: CMK - SMB & WorkZone content provider (https://jira.tools.sap/browse/EUXTEAMSAAR-3475)
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1055
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3475
            1.23.8.5 other teams

                1.23.8.5.1 reuven-kandov Design Nili's team CMK: Node Changes - Phase 1 -> Object store support
DR: https://wiki.one.int.sap/wiki/display/CPPortals/Design+Nili%27s+team+CMK%3A+Node+Changes+-+Phase+1+-%3E+Object+store+support

Plan to change using Object Store instance per tenant implicitly:
https://help.sap.com/docs/object-store/object-store-service-on-sap-btp/service-plans-and-entitlements
https://github.wdf.sap.corp/hcpbd-blr/object-storage-broker/blob/master/User%20Manual.md#custom-encryption-using-central-kms-on-aws

                1.23.8.5.2 Daniel-Turin, Alma-Shalom: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCEP%5D+SAP+Start%3A+Administration+Capabilities
Identify selected plan and SKU
portal-cf-html-bootstrap
we require access to the Plan data in multiple entry point
it would be better to add the plan data to the window property to avoid recurrent requests to SiteConfiguration (should be done in  the portal-cf-html-bootstrap routes)
the actual value of the plans (that should be hung on the window beside the currently existing scenario) is fetched by utilizing SiteConfiguration (via portal-cf-shared-lib/blob/master/src/configuration/config-utils.js)
this info (scenario and plan) then will be accessible from anywhere in the frontend by calling:
window.document.querySelector("meta[name^='sap.flp.cf']:not([name=''])").content.plan
window.document.querySelector("meta[name^='sap.flp.cf']:not([name=''])").content.scenario
example: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-infra/blob/8e25c26a0ee03d76597f46528ddf63f178c60fae/src/sap/ushell/services/designer/infra/services/designTime/ScenarioService.js
portal-cf-static-infra
Add a method to extract plan from window so it will be available to all relevant consuming repos

portal-cf-shared-lib
create a new method to handle plan extraction that will handle all plan states
global-services
add feature toggle for dev spaces

  Disable site directory capabilities by plan
portal-cf-site-semantic-service
Add to the existing API: semantic/entity/site the projection of the property: /cdm/payload/config/ushellConfig/flpPlatform, such that we will be able to check if  this is a sap-start site ( property has value “MYHOME” )
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/blob/master/src/routes/main/entity/sites.js#L28
handle projection both in sore client and site-entity-controller: https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/blob/master/src/controllers/site-entity-controller.js#L55
portal-cf-site-directory
extract plan and SKU with method from static infra: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-site-directory/blob/master/webapp/Component.js#L53

Foundation Plan
In this plan there will only be a single site that is the “sap-start” site
Create/ Import Tile - hidden
Convert neo site - hide
Search - hide
Site Tile icons
“go to site” – visible
navigating to site-settings - hidden
“more” option - hidden
Standard Plan
Identify Sap-Start site from request (semantic will add this to the projection as mentioned above)  
only for sap-start site do the following: 
“go to site” – visible 
Navigation to site setting – hidden
More – hidden  
Create/ Import Tile - visible - no change

Disable side panel capabilities by plan
portal-cf-design-static-infra
extract plan and SKU with method from static infra 
Foundation plan
Content manager left entry – hidden 
remove content manager new container from left menu: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-design-infra/blob/1a887b23a0dce72ced64e1b649929cc6a542acd4/src/sap/ushell/designer/plugins/adminPlugin/controller/Admin.controller.js#L185
Standard plan - no changes
2.4.  Disable subaccount settings capabilities by plan
portal-cf-static-subaccount-settings
Foundation plan 
tab identity provisioning - visible
tab identity authentication – visible
tab error logs - visible
all other tabs hidden
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-subaccount-settings/blob/master/subAccountSettings/webapp/view/accountSettingsContainer.view.xml
https://github.wdf.sap.corp/Portal-CF/portal-cf-static-subaccount-settings/blob/master/subAccountSettings/webapp/model/formatter.js
Standard plan - no changes

Disable channel manager capabilities by plan
portal-cf-static-provider-manager
extract plan and SKU with method from static infra 
Foundation plan 
hide button “create content package”: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-provider-manager/blob/master/providerManager/webapp/view/providerManager.view.xml#L40
new provider dialog
cloudLOb destination is:
destination with proxy type internet
destination's additional properties include: sap-start = CloudLOB
filter out all RT destination which are not cloudlob
Content Addition Mode will be automatic and disabled

IPS will be toggled and disabled
save button enablement logic (*^)
what should we do with Runtime Destination for Dynamic Data drop down ? what will be the impact of this change ?
what we do in semantic when enableRolesToGroupsAndCatalogsResolving is set ?
edit provider dialog
filter out all RT destination which are not cloudlob
Content Addition Mode will be automatic and disabled

IPS will be toggled and disabled
sync provider dialog
Yosi's team API can handle sync scenario
Standard plan
new provider dialog
if cloudlob destination is selected enable checkbox: "configure as sap start provider"
if checkbox is checked
Content Addition Mode will be automatic and disabled

IPS will be toggled and disabled
send to semantic new parameter is-sap-start-provider ?
edit provider dialog
if cloudlob destination is selected 
checkbox should be visible and editable
if checked
Content Addition Mode will be automatic and disabled

IPS will be toggled and disabled
send to semantic new parameter is-sap-start-provider
if checked off
IPS should not be toggled and enabled - today it is always disabled on edit mode ??
Content Addition Mode will be manual (?) and enabled
update new parameter is-sap-start-provider and send to semantic
if destination is not cloud lob
hide checkbox
portal-cf-dt-bff
Expand bff destination API bff/destinations?field=Type&value=HTTP to return also type and proxytype in the response
Expand bff service to return also additional properties from destination service
integration with new changes + Validate this change pose no regression (Nilli's team support is needed here)
https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-bff/blob/master/src/destination/destination.service.ts#L13
https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-bff/blob/master/src/destination/destination.interface.ts#L6
portal-cf-site-semantic-service
Add support in semantic to extract plan (shared-lib) (with redis params on notification callback or using a new call to configuration utils)
Foundation plan 
Provider creation should trigger the automatic assignment of the provider role to sap start site (Yosi team API)
https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service#automatic-assignment-of-content-providers-cherry-pick-roles-to-sites
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-semantic-service/blob/master/src/controllers/provider-controller.js#L223
Standard plan
is-sap-start-provider parameter
if true
trigger the automatic assignment of the provider role to sap start site (Yosi team API)
if false
trigger the automatic un-assignment of the provider role to sap start site (Yosi team API)
https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service#remove-assignments-of-sites-to-content-providers-cherry-pick-roles
add swagger changes for new query param 
cdm-schema changes 
add new parameter to provider's metadata to identify the provider as sap-start (so we would be able later to call auto-assignment API)

Handle UCL generated providers
we need to differentiate between 2 providers:

manually created providers (via UI)
API / Backend (UCL generated flow) created providers
to do that we will use the property createdByUCL in provider metadata: { "providerMetadata":{ "providerType": "external", ..., “createdByUCL”: true }}



portal-cf-static-provider-manager
channel manager table
if flag createdByUCL exist
provider title should have info icon with string explaining this is a UCL generated provider 
delete button is disabled on the channel action column
edit button is disabled on the channel action column
Automatic assignment repair button ??? where ? when ? how ? what to do ? - not clear
portal-cf-dt-frontend
channel exploration
if flag createdByUCL exist 
cherrypick / uncherrypick disabled

            1.23.8.6 [CMK] Embedded Content Providers handling - Test Scope
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3475
DR: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCMK%5D+Handling+embedded+content+provider+for+CMK+enabled+tenants
Test-scope: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCMK%5D++Embedded+Content+Providers+handling+-+Test+Scope
content providers types - https://wiki.one.int.sap/wiki/display/CPPortals/Content+providers+types

Eventually all these provided types are converted to either one of these providers types when saved to the database.
export const EXPOSED_CONTENT_TYPE = {
    GLOBAL: 'global',
    EMBEDDED: 'embedded',
    SAAS_APPROUTER: 'SAAS_APPROUTER'
};
 
I created a PR to handle also the “global” content provider type.
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1060

            1.23.8.7 Support CMK for Apple in Node JS services 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3343
Test-Scope: https://wiki.one.int.sap/wiki/display/CPPortals/%5BCMK%5D+Backbone+-+Node.js+Services+Support+of+multiple+Databases+%5BTransport%2C+Import%2C+DTS%5D-+Test+Scope
PRs:
    nestjs-common: 
    prs 167-183
https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/167

    Transport-service:
    mainly: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/659

    import-service:
        main pr: https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/161
        also,  162 and 166

    DTS: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/447

            1.23.8.8
        1.23.9    Takt09 , T09 , tags: Takt09 , T09

            1.23.9.1    sign-off
Team Capacity  -   56PDs
Support - 20 PDs
Eng:
 Delete space / provider fail issue - 5 PDs
Tasks:
Code review with Adam: [Performance] CDM on event 2 PDs
bind WZ AR to Mock workflow service LTS eu10 - 2PDs
Redis cleanup - 1 PD
[Security] Upgrade Ajv to newest version (cdm-schema) - 6PDs

CMK E2E validation 

            1.23.9.2 CMK E2E validations, 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3502
CMK Test-Scope: https://wiki.one.int.sap/wiki/display/CPPortals/CMK+-+E2E+Validation+Plan
Devs: Alon-Manshari, Yoav-Fried, Shirly-Cohen

            1.23.9.3 Delete space  provider fail issue 
Developer: Gil-Shikva 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3506
Fix delete space / provider fail issue (b/c of active subscriptions)
  – Issue: can't delete space or prvider.
  – RC: There are active subscriptions. Sometimes its very hard to find and delete all
  Even using CIS API to get the list of active subscriptions 
  – Impact: Stakeholders frustrated. Many tickets. bussiness activities and development delays.
  – Proposed fix:
    provisioning service will allow to delete the provider (remove Foreign-key constraint) and will delete cascade (so that the subscribers who's subscribedTenantId matches the provider instance ID will be deleted)

            1.23.9.4 bind WZ AR to Mock workflow service LTS eu10 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3420
done. 
there are still issues and we need a BLI to stabilize 

            1.23.9.5 Redis cleanup 
Dev: Alon-Manshari 
Task: https://jira.tools.sap/browse/EUXTEAMSAAR-3421

            1.23.9.6 [Security] Upgrade Ajv to newest version (cdm-schema)
BLI: https://jira.tools.sap/browse/EUXTEAMYAEL-2090
Dev: Shirly-Cohen 

            1.23.9.7 CMK E2E validation 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3502
Dev: Alon-Manshari, Yoav-Fried
           
            1.23.9.8 other teams

                1.23.9.8.1 Support WZ provisioning for CMK customers 
reuven-kandov
BLI: https://jira.tools.sap/browse/EUXTEAMNILI-6866
There is a request by customers (i.e. Apple ) to manage their encrypted keys by themselves and not by SAP. Therefore we would like to support databases which are encrypted by customers Keys (CMK). 

The WZ provisioning process should be adopted to support customers that are managing their encrypted keys by themselves(CMK). 

Scope:
Operation team need to update WZ ADV DC json mapping CF→DWS+ add to the jason the "global- account id"  Laham, Eman , Profesorsky, Run Malekan, Yael 
Following the updated jason mapping we need to adjust the workzone-cf-provisioning API and in case of CMK customer we need to check the full cf domain instead of checking only the super domain as done today. 
Ensure that provisioning continues to work as usual for all other non CMK customers. 
JAM are modifying the company creation API to accept more parameters that are related to CMK object store onboarding, BLI: DWS-6729
In WZ configurator there is a request send to jam in order to create a company, this request should include the additional parameters: “global-account id” ( can be taken from the jason mapping) , “sub-account id” ( already passed), “root Application” ( Ren, Ryan to check whether it can be hardcoded in jam and doesn't need to be passed in the request) and  "CMK enabled" parameter.  
To check if automations need to be updated.   
List of SFSF API doesn't need to be changed - confirmed with Ryan that there is no change to SFSF APIs. 
CMK should be supported with custom domain. 
Guidelines:
JAM tech contacts: @Zhao, Robert , Ren, Ryan 

Provisioning flow for Apple for the CMK enablement: CMK On/offboarding - CP Services Portals - Wiki@SAP (int.sap)                                                      Meeting recording: https://sap-my.sharepoint.com/:v:/p/revital_rabin/EW-d21AdjARJqyOu0HwX0ccBwh3nUkSb56nm6SjHTgOnQQ      

Design-Document: https://wiki.one.int.sap/wiki/display/CPPortals/Design%3A+Support+WZ+provisioning+for+CMK+customers

                1.23.9.8.2

            1.23.9.9 CMK for apple  in Node JS services – Automation
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3450
Dev: Alon-Manshari, jawad-margieh 

            1.23.9.10 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3290
Dev: Kalman-Labinsky

            1.23.9.11 Delete space / provider fail issue 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3506
Dev: Gil-Shikva


            1.23.9.12 Subaccount activation from CDM store - Design  
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3505
Dev: Shirly-Cohen , Adam-Cohen

        1.23.10   Takt10, T10
Here is our team signoff for T10.
Team Capacity  - 55 PD 
Support - 20 PD

Tasks:
Odata compliance:  deleted entity in a delta payload – 1 PD
E2E automation suites switch to ng-router - HO meeting  + Maintain new suites - 3 PDs
Security validations prep&demo – 2 PDs
Eng:
Table partitioning poc – 8 PDs


BLIs:

Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 

[security] Upgrade JAVA version and Spring Boot 3

Setup Automation - Terminate the provider to site association removes the role assignment 
Subaccount activation from CDM store - Design  

[CEP] Support export / import - Enable Transport Agents - design

Subaccount activation from CDM store - IMP 

depends on design (HLEE will be included in the design)

            1.23.10.1 Subaccount activation from CDM store  - design
https://wiki.one.int.sap/wiki/display/CPPortals/Subaccount+activation+from+CDM+store
Dev: Shirly-Cohen 

            1.23.10.2 related: MQ related issues, tags:  MQ related issues , solace, eventual consistency, race condition
https://wiki.one.int.sap/wiki/display/CPPortals/Kickstart+25.10.22

            1.23.10.3 Table partitioning poc 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3540 
Developer: Hadar-Kobi

            1.23.10.4 Odata compliance:  deleted entity in a delta payload - 1PD  - 
Task: https://jira.tools.sap/browse/EUXTEAMSAAR-3422
Developer: Hadar-Kobi

            1.23.10.5 E2E automation suites switch to ng-router 
Task: https://jira.tools.sap/browse/EUXTEAMSAAR-3546 
- HO + Maintain new suites - 3 PDs 
Status: waiting for Nili HO

            1.23.10.6 Security validations prep&demo 
Task: https://jira.tools.sap/browse/EUXTEAMSAAR-3547
Developer: Kalman-Labinsky
presentation: https://sap-my.sharepoint.com/:p:/p/kalman_labinsky/EeA6q8F0m1ZIu7DKcGW6K78BCJOuQJAkuAe4qi7wXUBoow?e=4%3ANWlmn5&fromShare=true&at=9&wdLOR=c01C8A62F-111F-A244-A10E-3A89217F026C 

also btw fix cls-hooked
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/pull/277

https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/191


            1.23.10.7 Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3290
Developer: Kalman-Labinsky

            1.23.10.8 [security] Upgrade JAVA version and Spring Boot 3
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3360
Developer: jawad-margieh

            1.23.10.9 Setup Automation - Terminate the provider to site association removes the role assignment 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3504
Dev: Gil-Shikva

            1.23.10.10 [CEP] Support export / import - Enable Transport Agents - design
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3136

            1.23.10.11 Subaccount activation from CDM store - IMP 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3512

            1.23.10.12 other teams

                1.23.10.12.1 [DR] [CEP] Content API - Support Filtering visualizations (Launchtype, Devicetype)

From: Ben Hefer, Immanuel <immanuel.ben.hefer@sap.com>
Let’s review the design for filtering visualizations by launch type and device type.
Link to recording -   [DR] [CEP] Content API - Support Filtering visualizations (Launchtype, Devicetype)-20231010_130259-Meeting Recording.mp4
BLI – https://jira.tools.sap/browse/EUXTEAMYAEL-2035
Design document (wip) – https://wiki.one.int.sap/wiki/x/9oID3w 
 

            1.23.10.13
        1.23.11   Takt11, T11

            1.23.11.1    Planning
Here is our team signoff for T11.
Team Capacity  -  30PD
Support - 20 PDs
Tasks:
Disk storage near maximum - start with checking cost for increasing quota - 1 PD
Add deleted role to the report chunk for CDM store - fixing a bug - 7 PDs
Eng:
Table partitioning poc – 5 PDs

BLIs:
Priority BLI	Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 Setup Automation - Terminate the provider to site association removes the role assignment 	5	A
2 [CEP] Support export / import - Enable Transport Agents - design	4	A/B	
3	[Sap Start] support Private key rotation for  content package - CDM store 6	A/B
4	Store CMK resilience  -cron jobs	8	Soft	
5 Extent the API in Provisioning service to return the Tenant id 	10	Soft	


            1.23.11.2 Disk storage near maximum - start with checking cost for increasing quota 
raise disk quotas to 2GB

Developer: Kalman-Labinsky
Task: https://jira.tools.sap/browse/EUXTEAMSAAR-3599 
PRs:
"
Hi Yosi,

for task https://jira.tools.sap/browse/EUXTEAMSAAR-3599

PR's:

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/682/files
https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/469/files
https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/162/files

https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/365/files 2048M -> 2GB, just to be aligned
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1126
should we do it https://jira.tools.sap/browse/DWPBUGS-4719
"
            1.23.11.3 hotfix  Customer is not able to sync his content provider due to http request timeout.
I would like to request an approval for providing a fix via HOTFIX, with the following details:
Description of the bug: Customer is not able to sync his Content Provider due to request timeout blocking Go-to Live.
 
Link to Jira bug (labels, versions, description, risk,… all set in the ticket.):  https://jira.tools.sap/browse/DWPBUGS-4780
 
Fix was submitted to master and validated.
Customer is not able to sync his content provider due to http request timeout.
This blocks his go-to-live decision on 25th October.

More information: https://itsm.services.sap/now/cwf/agent/record/sn_customerservice_case/b8f9839083c2bd18eeb7a780ceaad3b5
PRs:
CDM Store:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1121 master
 private final int maximumNumberOfArgs = 23 * 1000; // down from 25

https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1122 rc

https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1123 live

 

Transport Service:
https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/679 master
manifest-concourse.yml
  CDM_SNAPSHOT_COMMIT_REQUEST_TIMEOUT: 480000 # 8 * 60 * 1000 // set TO to 8 minuts

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/680 rc

https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/681 live

            1.23.11.4 CDM store deadlock issue
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1138
https://jira.tools.sap/browse/DWPBUGS-4797

            1.23.11.5 Table partitioning poc 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3540
Design: https://wiki.one.int.sap/wiki/display/CPPortals/Table+partitioning+design+and+PoC

We will use hash partitioning 
ex:

CREATE TABLE IF NOT EXISTS "CDM_ENTITIES"
        (
            LIKE "CDM_ENTITIES_OLD" -- copying the table structure
        ) PARTITION BY hash ("tenantId") ; -- the partition key

On CDM_ENTITIES table -  partition by tenantID using HASH

On RELATIONS table -  partition by fromTenantId using HASH

On entities_searchable_text table - partition by tenant_id using HASH  

Table per tenant isn't recommended b/c it will create hundreds of partitions which are not well balanced in size
some may even be huge 

Migration
Migration Steps
Get lock on the database (maintenance window)
Rename the base table
Create an empty partitioned table with the old base table name.
Create the required indices and constraints on the new partitioned table
Move the data from the old table to the new partitioned table
Drop the old table - after few sprints


Key point: Testing on a copy of lts db on local machine (around 2.5m rows combined in "CDM_ENTITIES" & "RELATIONS), copying the data from the original table to the partitioned table took around 2 minute. 
Assuming the same compute power on remote machine, eu10 which contains 9m rows combined should take around 8-10 minutes for the entire migration.

Actual migration:
ALTER TABLE "CDM_ENTITIES" RENAME TO "CDM_ENTITIES_OLD";
 
CREATE TABLE IF NOT EXISTS "CDM_ENTITIES"
        (
            LIKE "CDM_ENTITIES_OLD"
        ) PARTITION BY hash ("tenantId");
 
 ALTER TABLE "CDM_ENTITIES" ADD PRIMARY KEY;
 
PERFORM create_hash_partitions(10,'CDM_ENTITIES');  // we write create_hash_partitions function 
    
INSERT INTO "CDM_ENTITIES" (SELECT * FROM "CDM_ENTITIES_OLD");

Migration execution, Via API protected by technical-token

Table "entities_searchable_text" situation
Foreign key
The "entities_searchable_text" table has a the same row count as "CDM_ENTITIES" with slightly different values in the "title" & "description" columns, thus making it a suitable candidate for partitioning.

With the partitioning of the "CDM_ENTITIES" table, it creates problem:

The unique constraint will need to be dropped from the "entityMD5" column in "CDM_ENTITIES" table (this is due to postgres partitioning limitations) . Thus, the FK in "entities_searchable_text" table that references this column will need to be dropped.
This means that this table will be managed manually, which leads to a lot of effort and business logic changes in cdm store.

This limitation can be worked around by creating a unique constraint on "tenantId" & "entityMD5" in "CDM_ENTITIES" table, and FK in "entities_searchable_text" that references these columns.

ALTER TABLE "CDM_ENTITIES"
    ADD CONSTRAINT tenantid_md5_unique UNIQUE ("tenantId", "entityMD5");
 
ALTER TABLE cdm.entities_searchable_text
    ADD CONSTRAINT entities_searchable_text_entity_md5_fkey
        FOREIGN KEY (entity_md5, tenant_id) REFERENCES cdm."CDM_ENTITIES" ("entityMD5", "tenantId")
            ON DELETE CASCADE ON UPDATE CASCADE;
Partitioning
When we look into partitioning of the "entities_searchable_text" table, we some issues regarding our business logic:

Some queries relies on the unique_md5 constraint which was removed as we mentioned earlier, and replaced with tenantid_md5_unique constraint.

Example for such query: 

... "\tON CONFLICT(\"entity_md5\") DO UPDATE SET entity_title = EXCLUDED.entity_title, entity_description = EXCLUDED.entity_description" ...


Thus we will need to change all CONFLICT(\"entity_md5\") to CONFLICT(\"entity_md5\",tenant_id) in these queries (found 4 in total)



            1.23.11.6 [CEP] Support export / import - Enable Transport Agents - design
Dev: Kalman-Labinsky, Alon-Manshari, Tsafrir 
design: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3752192085  


            1.23.11.7 Add deleted role to the report chunk for CDM store 
changed to: Fix recent report related issues
https://jira.tools.sap/browse/EUXTEAMSAAR-3331

| 1. commit method will also return a report chunk with the deleted entities in content pkg update scenario.
| Fix in CDM-store and transport
| Currently we have identified three gaps related to report.
| Fix gap in content package update , Jira bug https://jira.tools.sap/browse/DWPBUGS-3566
| During content pacakge  update we idetify the gap that deleting role as part of the update scnari will not remove the role from cockpit. thsi is due to:
| deleted roles are not added to report chunk by CDM store since it’s not odata delta link scenario (so only in commit it is possible to know which entities are “deleted” ).
| Semantic service send request to delete the role from cockpit upon this information only.
|  
| 2. incorrect amount of roles in the report in the foundation plan - https://jira.tools.sap/browse/DWPBUGS-4467
|  
| 3. last successful report is shown even when there are failures - https://jira.tools.sap/browse/DWPBUGS-3459

pr1: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/684/files

            1.23.11.8 Setup Automation - Terminate the provider to site association removes the role assignment 	
Dev: Gil-Shikva, Hadar-Kobi
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3504
provider-service pr:             https://github.wdf.sap.corp/Portal-CF/portal-cf-provider-service/pull/117/files

            1.23.11.9 Extent the API in Provisioning service to return the Tenant id 	
Developer: jawad-margieh 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3576
PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new/pull/367


            1.23.11.10 [Sap Start] support Private key rotation for  content package - CDM store 
Developer: jawad-margieh 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3538

            1.23.11.11
        1.23.12   2023 Takt12 T12, tags: 2023 Takt12 T12

		
            1.23.12.0 sign-off   
Here is our team signoff for T12.

Team Capacity  -  58 PD

Support - 20 PDs

Tasks:

Fix recent report related issues - fixing a bug  Total: 3 PDS - Fried, Yoav 

Disable key validation - Total: 5 PDS - Izaq, Yosi  - Moved to Polt.

Multiple TENANT_HOST_PATTERN for SDM - Total: 4 PDS  - Manshari, Alon 

E2E automation suites switch to ng-router - HO meeting - Total: 1 PDS - All team - done. Need to create a task for missing automations (mailed to Ariel)

NG approuter E2E validation - cross teams - Total: 3 PDS  - ?



Eng:

JAVA 17 enabled improvements - Total: 6 PDS - Fried, Yoav



Security:

GHAS - fix 12 warnings, fix from security champion capacity - Cohen, Shirly 



BLIs:

Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 Store CMK resilience  -cron jobs 2 A Cohen, Shirly 

2 Subaccount activation from CDM store - IMP  20 A/B Kobi, Hadar 

3 [CEP] Implement agent orchestration - export 30 Soft Margieh, Jawad Manshari, Alon 

4 [CEP] Implement agent orchestration - import 33 Soft Margieh, Jawad Manshari, Alon 



            1.23.12.1   x509 compliance - Connection to External Services Using x509 Audit-Log-service oauth2
wiki: https://wiki.one.int.sap/wiki/display/CPPortals/Move+to+Audit+log+MTLS
relies on x-subdomain header being passed in the requests
main changes:
- bind to new plan (new instance created Audit-Log-service-oauth2)
- pass subdomain as parameter 
message.tenant('$SUBSCRIBER', subdomain)
-
            1.23.12.2 Store CMK resilience  -cron jobs	
Dev: Shirly-Cohen 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3535

            1.23.12.3 [CEP] Implement agent orchestration - export
Dev: Alon-Manshari, jawad-margieh 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3659

            1.23.12.4 [CEP] Implement agent orchestration - import
Dev: Alon-Manshari, jawad-margieh 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3645

            1.23.12.5 Subaccount activation from CDM store 
Developer: Hadar-Kobi, Shirly-Cohen, Gil-Shikva
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3512

            1.23.12.6 Fix recent report related issues - fixing a bug  
Developer: Yoav-Fried
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3331

            1.23.12.7 Multiple TENANT_HOST_PATTERN for SDM 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3618
SQL with fix: </Users/i500695/work/SAP/code/CF/SDM_THP_Fix_SQL/refactor_host_url 2.sql>
            1.23.12.8
        1.23.13   Takt13, T13, tags: Takt13, T13

            1.23.13.1  sign-off
 
[Change summary: [Security] cls-hooked – moved to #1 priority]
 
Here is our team signoff for T13.
Team Capacity  -  49
Support - 20 PDs
 
Tasks:
Fix recent report related issues - 3 PDs, SOFT
Workzone Postgres DB - impact of unavailability - 3 PDs, SOFT
 
New/Leftover
 
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 [Security] cls-hooked 5 PDs A/B
 
2 Subaccount activation from CDM store - IMP 7 PDs A
3 Subaccount activation from CDM store - migration execution 8 PDs A/B
4 [Security] Connection to External Services Using x509 7 PDs A/B
5 [CEP] Implement agent orchestration - import 50 PDs SOFT
 
            1.23.13.2 external teams designs and BLIs

                1.23.13.2.1 STD-NG approuter and super common domain support, tags: STD-NG approuter and super common domain support
https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3833823471
Background and Requirements
The NG router will replace the old approuter (launchpad DT+RT approuters). - JUST LAUNCHPAD
support super common domain 'cloud.sap' ( TG38), side by side with the existing 'on demand. com' domain.  


Scope:
Replace all STD (launchpad) routes, DT and RT, from the old approuter to NG router. This change should be protected with a environment variable and turned on gradually on selected DCs. 
it should be possible to change for a specific customer (subaccount) to use the old Approuter
Support additional domain 'cloud.sap' (https://*.DC.workzone.cloud.sap/) side by side with the existing 'ondemand.com' domain (dependency with operation BLI, EUXDEVOPS-3495) 
Mobile 
add new routes cloud.sap. to mobile instance config
use one single mobile instnace to avoid losing data

NG-Router
Routes :
On a dev space - in manifest-concures change routes of prod to exisintg approuter routes, example launchpad:

ng-router:

iaspocconsumer-dt-launchpad-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com
iaspocconsumer-launchpad-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com
iaspocconsumer-launchpadng-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com
Patterns:
Set env variables:

change launchpad to (?:dt-)?-launchpad(?:ng)? (optional non captured regex group - dt and ng prefixes) 

LAUNCHPAD_DESTINATION_HOST_PATTERN 

 ^.*-sapdelim-(.*?)((?:dt-)?-launchpad(?:ng)?-devspaceseu12iaspoc).*$
LAUNCHPAD_TENANT_HOST_PATTERN

(^([^-]*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\.cfapps\.eu12\.hana\.ondemand\.com)|^([^-]*)(?=(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\.cfapps\.eu12\.hana\.ondemand\.com)|^(.*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\.cfapps\.eu12\.hana\.ondemand\.com)|^(.*(?<!-m))(?=(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\.cfapps\.eu12\.hana\.ondemand\.com))

SKU_MAP 

[
    {
        "approuter-domain": "-cpp-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com",
        "destination-host-pattern": "^.*-sapdelim-(.*?)(-cppng-devspaceseu12iaspoc).*$",
        "ias-instance": "ias-clp",
        "portal-instance": "portal-service-default-instance",
        "sku": "portal",
        "sku-host-pattern": "(^(.*)(?=-cppng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "tenant-host-pattern": "(^(.*)(?=-sapdelim-(.*)-cppng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*)(?=-cppng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "xsuaa-instance": "portal-xsuaa-clp"
    },
    {
        "approuter-domain": "-launchpad-old-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com",
        "destination-host-pattern": "^.*-sapdelim-(.*?)(-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc).*$",
        "ias-instance": "ias-launchpad",
        "portal-instance": "launchpad-service-default-instance",
        "sku": "launchpad",
        "sku-host-pattern": "(^([^-]*)(?=(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "tenant-host-pattern": "(^([^-]*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^([^-]*)(?=(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*(?\u003c!-m))(?=(-m)?-(?:dt-)?launchpad(?:ng)?-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "xsuaa-instance": "portal-xsuaa-launchpad"
    },
    {
        "approuter-domain": "-workzone-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com",
        "destination-host-pattern": "^.*-sapdelim-(.*?)(-mobile|-cards)?(-workzoneng-devspaceseu12iaspoc).*$",
        "ias-instance": "ias-workzone",
        "portal-instance": "workzone-service-default-instance",
        "sku": "workzone",
        "sku-host-pattern": "(^([^-]*)(?=(-mobile|-cards)?-workzoneng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "tenant-host-pattern": "(^([^-]*)(?=-sapdelim-([^-]*)(-mobile|-cards)?-workzoneng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^([^-]*)(?=(-mobile|-cards)?-workzoneng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*)(?=-sapdelim-([^-]*)(-mobile|-cards)?-workzoneng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*(?\u003c!-mobile)(?\u003c!-cards))(?=(-mobile|-cards)?-workzoneng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "xsuaa-instance": "portal-xsuaa-workzone"
    },
    {
        "approuter-domain": "-workzonehr-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com",
        "destination-host-pattern": "^.*-sapdelim-(.*?)(-mobile|-cards)?(-workzonehrng-devspaceseu12iaspoc).*$",
        "ias-instance": "ias-workzonehr",
        "portal-instance": "workzone-service-default-instance",
        "sku": "workzonehr",
        "sku-host-pattern": "(^([^-]*)(?=(-mobile|-cards)?-workzonehrng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "tenant-host-pattern": "(^([^-]*)(?=-sapdelim-([^-]*)(-mobile|-cards)?-workzonehrng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^([^-]*)(?=(-mobile|-cards)?-workzonehrng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*)(?=-sapdelim-([^-]*)(-mobile|-cards)?-workzonehrng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com)|^(.*(?\u003c!-mobile)(?\u003c!-cards))(?=(-mobile|-cards)?-workzonehrng-devspaceseu12iaspoc\\.cfapps\\.eu12\\.hana\\.ondemand\\.com))",
        "xsuaa-instance": "portal-xsuaa-workzonehr"
    },
    {
        "approuter-domain": "-launchpad-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com",
        "destination-host-pattern": "^.*-sapdelim-(.*?)(-start-devspaceseu12iaspoc).*$",
        "ias-instance": "ias-launchpad",
        "portal-instance": "launchpad-service-default-instance",
        "sku": "sapstart",
        "sku-host-pattern": "(^([^-]*)(?=(-m)?-start-devspaceseu12iaspoc\\.sap\\.cloud\\.sap))",
        "tenant-host-pattern": "(^([^-]*)(?=-sapdelim-([^-]*)(-m)?-start-devspaceseu12iaspoc\\.sap\\.cloud\\.sap)|^([^-]*)(?=(-m)?-start-devspaceseu12iaspoc\\.sap\\.cloud\\.sap)|^(.*)(?=-sapdelim-([^-]*)(-m)?-start-devspaceseu12iaspoc\\.sap\\.cloud\\.sap)|^(.*(?<!-m))(?=(-m)?-start-devspaceseu12iaspoc\\.sap\\.cloud\\.sap))",
        "xsuaa-instance": "portal-xsuaa-launchpad"
    }
]
destinations

[
{"Name": "dummy-dest","URL": "https: //dummy.com"},
{"Name": "mobilestart","HTML5.ForwardAuthToken": true,"URL": "https: //iaspocconsumer-m-launchpad-old-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com","HTML5.Timeout": 600000}
]

LAUNCHPAD_APPROUTER_DOMAIN → pointing to the old approuter

-launchpad-old-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com

SAPSTART_TENANT_HOST_PATTERN - TODO (didnt change for the poc)
SAPSTART_DESTINATION_HOST_PATTERN - TODO (didnt change for the poc)

Old approuters:
On a dev space -  in manifest-concures change routes of prod to exisintg approuter routes for different one "old", example launchpad:

launchpad-dt-approuter: iaspocconsumer-dt-launchpad-old-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com

launchpad-rt-approuter: iaspocconsumer-launchpad-old-devspaceseu12iaspoc.cfapps.eu12.hana.ondemand.com


CDTEST with * subdomains
Fix cd test env together with DevOps
deployed NG-Router with changed routes, tenant_host_pattern ,approuter_pattern, SKU-MAP
updated manually xsuaa instance with redirect-uris
deployed launchpad-rt-approuter with changed routes
Access new domain : https://consumercdt.sap-cdtest.workzone.cloud.sap/site?siteId=861cf594-04f6-4e95-bb2d-aec408942edd#Shell-home

SKUs and other env vars - Adapt all patterns
add optional (dt) and optional (ng):

LAUNCHPAD_DESTINATION_HOST_PATTERN (example for devenv)

(( "^.*-sapdelim-(.*?)((?:dt-)?-launchpad(?:ng)?" env("HOST_SUFFIX") ").*$" ))
 LAUNCHPAD_TENANT_HOST_PATTERN (exampele for devenv):

(( "(^([^-]*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?" env("HOST_SUFFIX") "\\." replace(env("DOMAIN"), ".", "\\.") ")|^([^-]*)(?=(-m)?-(?:dt-)?launchpad(?:ng)?" env("HOST_SUFFIX") "\\." replace(env("DOMAIN"), ".", "\\.") ")|^(.*)(?=-sapdelim-([^-]*)(-m)?-(?:dt-)?launchpad(?:ng)?" env("HOST_SUFFIX") "\\." replace(env("DOMAIN"), ".", "\\.") ")|^(.*(?<!-m))(?=(-m)?-(?:dt-)?launchpad(?:ng)?" env("HOST_SUFFIX") "\\." replace(env("DOMAIN"), ".", "\\.") "))" ))
SKU_MAP for launchpad:

launchpad:
  sku: "launchpad"
  sku-host-pattern: (( "(^([^\\.]*)(?=(\\.m)?\\.(?:dt.)?launchpad(?:ng)?" replace(env("HOST_SUFFIX"), "-", "",1) "\\." replace(env("DOMAIN"), ".", "\\.") "))" ))
  portal-instance: "launchpad-service-default-instance"
  xsuaa-instance: "portal-xsuaa-launchpad"
  ias-instance: "ias-launchpad"
  tenant-host-pattern: (( "(^(.*)(?=-sapdelim-([^\\.]*)(\\.m)?\\.(?:dt.)?launchpad(?:ng)?" replace(env("HOST_SUFFIX"), "-", "",1) "\\." replace(env("DOMAIN"), ".", "\\.") ")|^([^\\.]*)(?=(\\.m)?\\.(?:dt.)?launchpad(?:ng)?" replace(env("HOST_SUFFIX"), "-", "",1) "\\." replace(env("DOMAIN"), ".", "\\.") "))" ))
  destination-host-pattern: (( "^.*-sapdelim-(.*?)(\\.(?:dt.)?launchpad(?:ng)?" replace(env("HOST_SUFFIX"), "-", "",1) ").*$" ))
  approuter-domain: (( ".launchpa.old" replace(env("HOST_SUFFIX"), "-", "",1) "." env("DOMAIN") ))
LAUNCHPAD_APPROUTER_DOMAIN

(( ".launchpad.old" replace(env("HOST_SUFFIX"), "-", "",1) "." env("DOMAIN") ))
In routes + TENANT_HOST_PATTERN + SKU_MAP add also cloud.sap.sap domain to the regex

isnt part yet of the sample above


                1.23.13.2.2 export import agents - Liraz
DR: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3899364757
Developer: Alma-Shalom

Status tracking: https://wiki.one.int.sap/wiki/display/CPPortals/Import+and+Export+Agents 

                1.23.13.2.3

            1.23.13.3 Fix recent report related issues 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3331
Developer: Yoav-Fried

            1.23.13.4 Workzone Postgres DB - impact of unavailability 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3696
Dev: Alon-Manshari 

            1.23.13.5 [Security] cls-hooked 
BLI: https://jira.tools.sap/browse/EUXTEaMSAAR-3406
Developer: Kalman-Labinsky, jawad-margieh

            1.23.13.6 Subaccount activation from CDM store  , tags: activation from CDM store  
Developer: Hadar-Kobi, Shirly-Cohen, Gil-Shikva
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3512

PRs:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1193/files
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1190

                1.23.13.6.1 CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli , tags: SAA sub-account-activation CLI https://github.wdf.sap.corp/I349433/sub-account-activation-cli 
local: /Users/i500695/git/sub-account-activation-cli

[i500695@WYLQRXL9LQ:2024-01-30 13:54:44:~/git/sub-account-activation-cli:]2007$ cat README.md 
# sub-account-activation-cli
Sub Account Activation CLI

### How to Install
- git clone this repo
- run npm i
- run npm run build
- run npm i -g
- use the "saac" command line to start using this CLI

### Examples

running status command providing url and using portal CLI generate-client-token command
```
- saac status -u https://portal-service-yosiproviderhadar.cfapps.eu12.hana.ondemand.com -t $(portal generate-client-token -s portal-xsuaa-broker)
```

running this command on any environment will return the status of the sub account activation from cdm store service side
```
- saac status -u $(dirname $(cf apps | grep "/cdm_store_service" | awk '{print $NF}')) -t $(portal generate-client-token -s portal-xsuaa-broker)

- uses commander
| ## Commander.js: Powerful CLI Tool for Node.js
| 
| If you're building command-line interfaces (CLIs) in Node.js, **Commander.js** is a popular and powerful library. It simplifies defining and parsing arguments, handling subcommands, and creating user-friendly help messages. 
| 
| Here's a quick overview of its key features:
| 
| **Capabilities:**
| 
| * **Easy Argument Parsing:** Define required and optional arguments, flags, and aliases with concise methods like `.option()`, `.requiredOption()`, and `.argument()`.
| * **Subcommand Support:** Create nested subcommands to organize your CLI's functionality and delegate handling to separate functions.
| * **Built-in Help System:** Automatically generate comprehensive help messages based on your defined options and commands.
| * **Validation and Error Handling:** Commander handles invalid arguments and helps display informative error messages to users.
| * **Extensible and Customizable:** You can further customize the behavior and output of Commander with plugins and custom formatting.
| 
| **Getting Started:**
| 
| 1. **Install Commander:** `npm install commander`
| 2. **Import Commander:** `const commander = require('commander');`
| 3. **Define Options and Commands:** Use methods like `.option()` and `.command()` to specify your CLI structure.
| 4. **Parse Arguments:** Call `commander.parse(process.argv)` to capture arguments from the command line.
| 5. **Access Options and Arguments:** Use `commander.options` and `commander.args` objects to access parsed data.
| 6. **Implement Command Logic:** Write functions to handle each command and utilize the parsed arguments.
| 
| **Resources:**
| 
| * **Official Documentation:** [https://www.npmjs.com/package/commander](https://www.npmjs.com/package/commander)
| * **GitHub Repository:** <invalid URL removed>?
| * **Quick Start Guide:** <invalid URL removed>?
| * **Building a TypeScript CLI with Commander:** [https://blog.logrocket.com/tag/typescript/](https://blog.logrocket.com/tag/typescript/)
| 
| **Feel free to ask any specific questions you have about using Commander.js!** I'd be happy to help you create user-friendly and powerful CLIs for your Node.js projects.


commander example
const program = require('commander');

// Define a command with a required argument and an optional flag
program
  .command('greet <name>')
  .description('Greet a user by name')
  .option('-w, --with-exclamation', 'Add an exclamation mark')
  .action((name, options) => {
    const greeting = options.withExclamation ? 'Hello, ' + name + '!' : 'Hello, ' + name + '.';
    console.log(greeting);
  });

// Parse command-line arguments
program.parse(process.argv);


- my wrappers:
/Users/i500695/work/SAP/tools/subaccount_activation


                1.23.13.6.2
            1.23.13.7
        1.23.14   


            1.23.13.2

        1.23.14

    1.24 2024, tags: 2024
        1.24.1    Takt01 , T01 , tags: Takt01 

            1.24.1.1    signoff
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2401+Sign-Off
Here is our team signoff for T01.
Team Capacity  -  60 pds
Support - 20 PDs
Tasks:
NG approuter E2E validation and automation  - 10 PDs
[DevOps] review env vars - 3 PDs. capped at 1 PD this Takt. SOFT 

Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 Subaccount activation from CDM store - migration execution 11 PDs A/B According to plan migration execution in production is planned for next Takt
2 [Security] Connection to External Services Using x509  5 PDs A Blocked until architects reach a decision re. sub domain is handled in shared lib or not. Changing decision will likely change EE.
3 Destination Mapping for Cards - support search of card aliases 10 PDs A/B
4 [CEP] Implement agent orchestration - export 30 PDs SOFT Sklarski, Tsafrir is joining to lead this BLI
5 [CEP] Implement agent orchestration - import 45 PDs SOFT


 
            1.24.1.2 NG approuter E2E validation and automation
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3639
Developer: Hadar-Kobi 

            1.24.1.3 [DevOps] review env vars 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3713
Developer: Alon-Manshari

            1.24.1.4 Subaccount activation from CDM store - migration execution 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3695
Developer: Shirly-Cohen

            1.24.1.5 [Security] Connection to External Services Using x509 
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3299
Dev: Gil-Shikva, Hadar-Kobi

            1.24.1.6 Destination Mapping for Cards - support search of card aliases
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3711
Developer: Yoav-Fried, jawad-margieh
design: https://wiki.one.int.sap/wiki/display/CPPortals/Design%3A+Destination+Mapping+for+Cards+-+support+search+of+card+aliases

Test-Scope: https://wiki.one.int.sap/wiki/display/CPPortals/Test+scope+-+Destination+Mapping+for+Cards+-+support+search+of+card+aliases


            1.24.1.7 [CEP] Implement agent orchestration - export
SOFT
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3659
Developer: Tsafrir-Sklarski

            1.24.1.8 [CEP] Implement agent orchestration - import
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3645
Dev: Alon-Manshari, jawad-margieh 

            1.24.1.9 Other teams BLIs

                1.24.1.9.1 [CF] Consolidate get dependencies logic to one service (remove from App router) - Design
https://jira.tools.sap/browse/EUXTEAMFLPRT-761
Motivation:
As part of the move from the current approuter to the NG approuter in Q1, some of the functionality available in the approuter should move to other services. In particular the get dependencies flow should move out from current approuter as NG approuter will not handle it. 

Today, approuter return to CIS all external dependencies (for example:  HTML5 repo, audit log, portal service - service broker). Service broker returns dependencies to additional internal services (interest cards for example). We would like to return both external and internal services dependencies by one service.

Requirements:
Dependency handling:

Determine which service is best suited for handling dependencies.
Redirect callback from CIS to the selected service for subscription\get dependencies\change plan (saas-registry)
Subscription callback should call selected  service to get dependencies.
The selected service should return all dependencies including the ones that are returned by approuter today (new approuter will not handle it) and the ones returned by service broker. Bind all services to the new service.
Create instance of the broker in the pre-deployment of the service and bind to the selected  service - to be clarified with Israel if the broker need to be used and for what.
Make sure update dependencies work as expected (triggered by Ops when dependencies change)
Validate subscribe, unsubscribe flows are working with no regressions. 
It is a mandatory for NG Approuter, - SRE track which we commited. Currently Approuter usage cost us alot and performance 
 

General guidelines:

Supported products: SAP Start, SAP Build Workzone Standard.
Out of scope: SAP Build Workzone Advanced (since NG approuter for Advanced will be in Q2\Q3 24 ).
Technical Information:
dependencies returned by approuter today for Standard - see mail from Sergio attached
Scope:
Create a design document for the Dependencies logic within the selected service
Create design document
Design Document template
Design document exaples
If a new Service should be created, take into account the checklist for new service
schedule and perform a design review with all relevant colleagues (including Architects/teams from all relevant teams - service broker, approuter etc.)
 
Supported Products:
SAP Start,
SAP Build Workzone Standard
Technical contacts: 
Approuter:  Sergio Rozenszajn
NG approuter \ common-rt-approuter: Nili Adoram
Service-Broker: Israel Even Hen

design: https://wiki.one.int.sap/wiki/display/CPPortals/Design%3A+Consolidate+the+%27get+dependencies%27+logic+to+one+service

                1.24.1.9.2 [ANS Notification] Support multiple mobile instances
https://wiki.one.int.sap/wiki/display/CPPortals/%5BANS+Notification%5D+Support+multiple+mobile+instances+-+Design+Document
Background and Requirements
Today, Notification service can push notifications to only one mobile service instance. (currently supported for mobile start based on SAP Build Work Zone, standard edition (launchpad) )

At any given time mobile service instance could be binded to only one approuter

In our current architecture, SBWZ could have on the same tenant different editions (Foundation, STD, ADV). Each edition has its own approuter (until all will be replaced with NG router). This leads to the following  situations:

Notification could not be supported on mobile application service of both WZ SFSF and WZ P&T. 
Notification could not be supported on both mobile application service and mobile start in ADV, once mobile start will be integrated in ADV(Q2/24) and we will need to support 2 different mobile instances in one edition. 
To solve these gaps, Notification service is now working to enable push notifications to several mobile service instances, BLI: ANS-890

                1.24.1.9.3
            1.24.1.10
        1.24.2    Takt02 , T02 

            1.24.2.1    external teams
		
                1.24.2.1.1    NG router-replace XSUAA sample go library - Design
https://wiki.one.int.sap/wiki/pages/resumedraft.action?draftId=4019033655&draftShareId=b852f27f-fdd0-4b97-bb99-6e0d5806554e&

                1.24.2.1.2  Destination Mapping for Cards - Extend CDM portal schema for provider entity

                    1.24.2.1.2.1  design 
                    https://wiki.one.int.sap/wiki/display/CPPortals/Destination+Mapping+for+Cards+-+Extend+CDM+portal+schema+for+provider+entity
Motivation:
Today, alias mapping is only supported for destinations affecting app launch (runtime destination). In cases where Visualizations need to display data that is fetched from another destination, the Admin can only use a single default destination as defined in "Runtime Destination for OData". In CEP we support Cards as a new visualization type to the CDM content model.

Cards define required destinations in their descriptor and in many cases it is different than the one configured for launching the app. To improve usability and allow decoupling from any concrete destination configuration performed by an administrator we should extend the alias mapping to support also mapping of destination configured on the Card level. 

In addition, allowing Admin to create alias mapping for cards destinations will provide the flexibility to create the same alias in different providers with different destination urls. Today, all cards using the same alias must use the same destination.

This requirement is relevant for both Mobile Start as well as Web Shell in order to support cards in SAP Build Workzone.

Clarification: We often confuse and mix Alias and Destination as terms. In this case we wish to fetch all Aliases from the visualizations such that they may be mapped to appropriate Destinations. 

These mappings must be persisted on the Provider CDM entity which would make them available for fetching at Runtime, directly from the CDM store.

search API (CDM-store)
{
  "x-attribute-username": "default_user",
  "metadata": {
    "context": {
      "id": "providerId",
      "contextType": "snapshot"
    }
  },
  "match": [{"/cdm/identification/entityType": "businessapp"}],
  "return": {"/cdm/aliases/cards": {
    "alias": "aliases"
  }}
}

response payload
[
  {
    aliases: ["alias1A"],
  },
  {
    aliases: ["alias2B"],
  },
  {
    aliases: ["alias3C"],
  },
  {
    aliases: ["alias4D"],
  }
]

Alias Mapping Data management flows
The following flows include access and manipulation of the Aliases data and the corresponding destination mapping:
1) Create Provider
In this flow the expectation is that we retrieve all existing card specific aliases and save them in a structure on the provider entity, without any mappings as these haven't been created yet.
This is the simplest flow as no consideration must be given to existing data sets already persisted on the provider entity.


2) Sync Provider
This flow introduces a degree of complexity as it includes the following options:
A) New Applications In Snapshot - these could include new card visualizations the introduce new Aliases that must be added to the structure that exists on the provider without affecting other aliases and their potentially existing mapped destinations.
B) Removed Applications from Snapshot - We must be sure to alter the existing structure on the provider entity such that any Aliases that were derived from businessapps that were removed from the snapshot, no longer will exist in the Aliases structure persisted on the provider.
C) Duplication of Aliases derived from Applications - We must not overwrite existing mappings between Aliases and Destinations due to parsing Aliases that already exist on businessapps or derived from new businessapps that have been added to a snapshot.


Critical Performance Considerations
We avoid the pitfalls of assuming the best case scenario and therefore assume that the amount of Businessapps with cards from which aliases will be derived is aligned with the ever nearing aspirations of supporting mass content. 

We have already witnessed certain S4 providers that contain serious magnitudes of data (8000 roles, and many more applications).

The payload we receive from Cdm-Store is structured as an Array of Arrays, and in the absence of any other options (such as using Maps or Merkle Trees) we have a lower bound limit of O(N) where we must iterate over all entries within the payload array.

Historically, when we had to hold collections of data within CDM entities, where we did not now the value of the property keys, we utilized arrays of objects for this. Theoretically this could serve our purpose since we don't know the value of each alias we will receive from any provider, however the repercussions of using an array to persist all card aliases is the need to iterate over all entries in the payload we receive from the applications (from cdm-store) and also iterate repeatedly over all entries in the provider entity, resulting in O(N^2) which from a performance perspective is not acceptable.



While we cannot control the structure we receive from cdm-store (array of arrays), we can and should select a more performant structure for the mapping and persisting of alias and destination data on the provider entity.

Selected Provider CDM entity Card Alias Mapping structure
Within providerEntity.cdm.payload.providerMetadata we will add a new property: "cardAliasesMapping" which will be built as such:
"cardAliasesMapping": {
    "firstAlias": {"name": "firstAlias", "destination": "mappedDestinationA"},
    "secondAlias": {"name": "secondAlias", "destination": "mappedDestB"},
    "thirdAlias": {"name": "thirdAlias", "destination": ""}
} 
our schema definition must allow for cases where "cardAliasesMapping" object is empty.
our schema definition must assure that in the event that a mapping exists, it must include the properties "name" and "destination".
our schema should not allow any additional properties in cardAliasesMapping and no additional properties within every entry (beside name and destination).
Since we do not know in advance the values of the Aliases we are to receive and yet wish for these Aliases to represent keys of properties within an object, we will use JSON-Schema capability "patternProperties" which was introduced in JSON-Schema draft-04 (we are currently using draft-07 making this available to us). This will allow us to capture values as regular expressions and then utilize their values as keys of an object in a manner which is dynamic.Documentation: https://json-schema.org/understanding-json-schema/reference/object#regexp
Therefore, the new addition to the schema definition in cdm-schema of a provider cdm entity, and specifically within providerMetadata property will be as such:

 Collapse source
"cardAliasesMapping": {
              "type": "object",
              "patternProperties": {
                "^(?!$).+": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "destination": {
                      "type": "string"
                    }
                  },
                  "required": ["name", "destination"]
                }
              },
              "additionalProperties": false
            }
Data Management Flows
1) Provider Creation:

On provider creation we will conduct the following logic:

1) Make call to cdm-store to retrieve all aliases from businessapps that have cards within a given snapshot (determined by providerId).

2) Iterate over the array of businessapp entries and for each one - iterate over the included aliases array.

3) For each alias → Create a new entry in cardAliasesMapping as such:

 Collapse source
"cardAliasesMapping": {
    "newAlias": {"name": "newAlias", "destination": ""}
}
Flow takes O(N) Where N is the number of aliases returned from cdm-store.

2) Provider Sync:

On provider sync we will conduct the following logic:

1) Make call to cdm-store to retrieve all aliases from businessapps that have cards within a given providerId. This will serve as the main source of truth with regard to what aliases should exist on the provider.

2) Make call to retrieve the existing Provider CDM entity and retrieve from it the existing "cardAliasesMapping" structure. This will serve as the main source of truth with regard to what destination values should exist for aliases that already exist and are also returned from cdm-store.

3) Iterate over the array of businessapp entries and for each one - iterate over the included aliases array.

4) For each alias → Check if this alias exist in our existing "cardAliasesMapping" structure (O(1) due to opting for an object structure).

YES → copy the entire existing Alias object from "cardAliasesMapping" structure to our new structure. This will preserve the mapped destination value.
NO → Create a new alias entry in "cardAliasesMapping" structure as such:
 Collapse source
"cardAliasesMapping": {
    "newAlias": {"name": "newAlias", "destination": ""}
}
We ignore all existing mapping in "cardAliasesMapping" for which aliases do not exist in the response from cdm-store, and by doing so we essentially remove alias mappings from applications that have been removed from the provider snapshot and for which there should no longer be a mapping.

5) Overwrite Provider CDM entity "cardAliasesMapping" with our newly formed "cardAliasesMapping" structure. and persist CDM provider entity to cdm-store.

Flow takes O(N) Where N is the number of aliases returned from cdm-store.

                    1.24.2.1.2.2

                1.24.2.1.3


            1.24.2.2

            1.24.2.2 signoff

Tasks:
Destination mapping of cards -Support liraz team to Extend CDM portal schema - 1 PD 
Support workflow GACD - 2 PDs 
[CSR] Initial analysis of calls to external services  - 3 PDs 
Updating Audit log wiki - 0 PDs
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

|1 Subaccount activation from CDM store - migration execution 2 PDs A/B According to plan migration execution in production is planned for this Takt
|2 [Security] Connection to External Services Using x509 5 PDs A
|3 [Security] Upgrade url-templates 	1 PDs A 
|4 SAA - Enhance API to support entity type and context 	16 PDs A/B
|5 Destination Mapping for Cards - CDM store migration	16 PDs SOFT
|6 Unique Inbound ID for Federated Applications - Transport	8 PDs SOFT
|7 Unique Inbound ID for Federated Applications - HTML5/Apollo	M+S: Breakdown depends on mini design above
|8 [CEP] Implement agent orchestration - export

            1.24.2.3 Destination Mapping for Cards - CDM store migration	
FYI – Migration guide wiki was updated.
CLI commands are now part of the portal cli.
 
Commands:
portal start-cdm-migration  Starts the cdm migration
portal get-cdm-migration-report  Gets the migration report
 
Wiki: https://wiki.one.int.sap/wiki/x/IgC68g
 
 
Please let me know if you have any question.
 
Best Regards,
Jawad


            1.24.2.4 Sprint review

completed:
audit log types alignment - https://jira.tools.sap/browse/EUXTEAMSAAR-3764 (Kalman)
Subaccount activation from CDM store - migration execution  - https://jira.tools.sap/browse/EUXTEAMSAAR-3695 (Shirly)
Support workflow GACD -https://jira.tools.sap/browse/EUXTEAMSAAR-3742 (Jawad)

Small leftover:
[Security] Connection to External Services Using x509 - [Security] Connection to External Services Using x509 
    Plan, Shany: Hi Everyone,
    I synced with Cohen, Adam we need to wait to the next code split (this Thursday) in order to run the subaccount alignment on RC landscapes.
    As this is one of the prerequisite to enable the ENV variable we will be able to to enable the ENV variable in master only next sprint (3A).
    I will update also in mail the new timelines:
    T2402B
    Env variable in all services should remain false in master.
    T2403A
    OPS - to run both subdomain allignment & update subscription on RC landscapes
    Dev teams - enable the ENV variable to true in all the services in master

Pending:
Destination mapping of cards -Support Liraz team to Extend CDM portal schema - https://jira.tools.sap/browse/EUXTEAMSAAR-3746

continue:
Unique Inbound ID for Federated Applications - HTML5/Apollo - https://jira.tools.sap/browse/EUXTEAMSAAR-3747
Unique Inbound ID for Federated Applications - Transport - https://jira.tools.sap/browse/EUXTEAMSAAR-3338
Destination Mapping for Cards - CDM store migration - https://jira.tools.sap/browse/EUXTEAMSAAR-3743
Replay Event ( SAA)- Enhance API to support entity type and context - https://jira.tools.sap/browse/EUXTEAMSAAR-3748

        1.24.3    Takt03 , T03 

            1.24.3.1    Planning
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+team+T2403

Team Capacity  -  70PDs
Support - 20 PDs
Tasks:
Destination mapping of cards -Support liraz team to Extend CDM portal schema
Delivering WZ Lib in the HTML5Repo code - Handover
[SECURITY] Upgrade security-patched-spring-boot-starter in cdm-store service

New/Leftover

Epic/Area	BLI/Activity Estimated Effort ( initial) Dependencies in other teams Sprint UX InfoDev DevOps Perf.  Comments / Action items

Mass content support  CDM store reduce load - code removal A	 +	T3A

Security  [Security] Connection to External Services Using x509  A	 Remaining for T03A: Dev teams - to enable the ENV variable to true in all the services (in master )

Sort order of pages in federated spaces	Event Replay ( SAA)- Enhance API to support entity type and context A/B	 Leftover from T02
Mobile start Unique inbound ID Unique Inbound ID for Federated Applications - Transport L	A/B	
LEftover from T02

Mobile start Unique inbound ID Unique Inbound ID for Federated Applications - HTML5/Apollo M+S	A/B	
LEftover from T02

Mobile start Unique inbound ID Unique Inbound ID for Local and Federated Applications - Import M	A/B	


Role based Cards	CDM store to support filter assignment per vis type A/B	 For supporting Liraz BLI Admin UI to block assignment of cards to group

Export/Import	[CEP] Implement agent orchestration - import

Export/Import	[CEP] Implement agent orchestration - export 0 - Tsafrir	 Tsafrir

            1.24.3.2 signoff
Team Capacity  -  70PDs Support - 20 PDs Total Remaining: 50 PDs

Tasks:
Destination mapping of cards -Support liraz team to Extend CDM portal schema - 1 PDs
Delivering WZ Lib in the HTML5Repo code - Handover - 5 PD
[SECURITY] Upgrade security-patched-spring-boot-starter in cdm-store service - 2 PD

New/Leftover
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments

1 CDM store reduce load - code removal	5 PDs A
2 [Security] Connection to External Services Using x509  0 PDs A Izaq, Yosi  - Consume BLI
3 Event Replay ( SAA)- Enhance API to support entity type and context	10 PDs A/B
4 Unique Inbound ID for Federated Applications - Transport	3 PDs A
5 Unique Inbound ID for Federated Applications - HTML5/Apollo	5 PDs A/B
6 Unique Inbound ID for Local and Federated Applications - Import	3 PDs A/B
7 CDM store to support filter assignment per vis type	17 PDs SOFT 
8 [CEP] Implement agent orchestration - import	45 PDs SOFT
9 [CEP] Implement agent orchestration - export	22 SOFT


            1.24.3.3 [SECURITY] Upgrade security-patched-spring-boot-starter in cdm-store service 
https://jira.tools.sap/browse/EUXTEAMSAAR-3794
Developer: Shirly-Cohen 
planned-time: 2 PDs 


            1.24.3.4 Unique Inbound ID for Federated Applications - Transport
https://jira.tools.sap/browse/EUXTEAMSAAR-3338
Developer: Yoav-Fried
planned-time: 3 PDs 

PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/607 

Reference, card-aliases migration: https://wiki.one.int.sap/wiki/display/CPPortals/Businessapps+Cards+Aliases+Migration+Guide+-+CDM+Store+Service

            1.24.3.5 Replay Event ( SAA)- Enhance API to support entity type and context 
            https://jira.tools.sap/browse/EUXTEAMSAAR-3748
Developer: Alon-Manshari
planned-time: 9 PDs 

PRs: 
Events replay API  - https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1269
Support instance id replay events -  https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/1282/files

new CLI repo: https://github.wdf.sap.corp/I585770/replay-events-cli


            1.24.3.6 Unique Inbound ID for Federated Applications - HTML5/Apollo
            https://jira.tools.sap/browse/EUXTEAMSAAR-3747
Developer: Hadar-Kobi 
planned-time: 5 PDs 

PR: https://github.wdf.sap.corp/Portal-CF/cdm-import-service/pull/236

            1.24.3.7 CDM store reduce load - code removal
https://jira.tools.sap/browse/EUXTEAMSAAR-3791
Developer: jawad-margieh
validations of code removal. Basically in all flows local entites CUD should send {v1,v2} events, all snapshot entities only {v2}
planned-time: 5 PDs 

            1.24.3.8 [CEP] Implement agent orchestration - import
           https://jira.tools.sap/browse/EUXTEAMSAAR-3645 
Developer: Kalman-Labinsky
planned-time: 45 PDs 

            1.24.3.9 [CEP] Implement agent orchestration - export
https://jira.tools.sap/browse/EUXTEAMSAAR-3659
Developer: Tsafrir-Sklarski
planned-time: 22 PDs 

            1.24.3.10 Arburg escalation (internal server error)

                1.24.3.10.1 email thread
Jawad: After further discussing this internally.
We suspect that getting the Keys stored in Redis by pattern may cause issues, consedering we have 1.3 million keys.
Please see Redis official documentation on that matter:
https://redis.io/commands/keys/
Warning: consider KEYS as a command that should only be used in production environments with extreme care. It may ruin performance when it is executed against large databases.



The guidance is to replace this with SCAN, https://redis.io/commands/scan/
SCAN Syntax SCAN cursor [MATCH pattern] [COUNT count] [TYPE type]
Available since: 2.8.0
Time complexity: O(1) for every call. O(N) for a complete iteration, including enough command calls for the cursor to return back to 0. N is the number of elements inside the collection.
ACL categories:
@keyspace, @read, @slow

Usages of KEYS –
Shared-lib: https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/blob/master/src/db/redis-client.js#L540
NestJs-common: https://github.wdf.sap.corp/Portal-CF/nestjs-common/blob/master/src/redis/services/cluster-redis.service.ts#L170
 
I have created a potential PR with the relevant changes: https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/264.
This wasn’t yet tested or validated.

                1.24.3.10.2 REDIS perf fixes
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib/pull/516#pullrequestreview-10512975

                1.24.3.10.3 RCA 
https://i7p.wdf.sap.corp/sap(bD1lbiZjPTAwMQ==)/bc/bsp/sno/ui_entry/entry.htm?param=69765F6D6F64653D3030312669765F7361706E6F7465735F6E756D6265723D3334333330353926
Symptom

After content provider sync or performing some changes in the site (adding roles, etc) you may not see expected changes.


Other Terms

SAP Build Workzone

Activation

System Aliases


Reason and Prerequisites

Site changes may not be “activated” correctly in the runtime site, due to the following reasons:

Site contains too many entities
Alias mappings may be missing
Other exceptions or errors could occur

Solution

You can inspect the state of site activation by using the following api  = <approuter/ /cp.portal/bff_service/activation/site_state/<site_id>


                1.24.3.10.4
            1.24.3.11 Planned migrations
- RBC (Role-Based-Cards) replay events (no dependency on other BLIs)
Start validation on LTS next week. On 3B timeline

- RBC migrations w/o replay event. 
  -- generate bussisness-app per card (BA is assigned to card) , 
  -- also add all cards to everyone role
  -- We need more info from DWS (DR, Jawad, Tal must attend) to estimate possible regressions

- Space sort replay migration. Uli will define timeline and drive this.   


            1.24.3.12 WZ Advanced Migration of existing WZ standalone Cards to standalone local Apps 
https://jira.tools.sap/browse/DWS-3991

            1.24.3.13
        1.24.4    Takt04 , T04 

Kalman - T04 on reserve duty
Gil - T4-T6 moved to UPA team

            1.24.4.1     signoff

1 Unique Inbound ID - Migration for existing content (local + federated)	15 PDs A+B Assuming Nili's team adds API+CLI for reactivate all sites + get all sites activation status Kobi, Hadar Fried, Yoav 
2 [CEP] Implement agent orchestration - import	41 PDs SOFT Manshari, Alon 
3 [CEP] Implement agent orchestration - export	16 PDs SOFT Labinsky, Kalman Margieh, Jawad 
4 CDM store to support filter assignment per vis type	18 PDs SOFT Cohen, Shirly 
5 [Golden Path] HTML5 as a Content provider: CDM library logging and schema validation	6 PDs A Margieh, Jawad 1.24.4.2

            1.24.4.2  Unique Inbound ID - Migration for existing content (local + federated)	
BLI:https://jira.tools.sap/browse/EUXTEAMSAAR-3745
Developer: Hadar-Kobi, Yoav-Fried 

            1.24.4.3 [CEP] Implement agent orchestration - import	
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3645
Developer: Alon-Manshari

            1.24.4.4 [CEP] Implement agent orchestration - export	
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3659
Developer: Kalman-Labinsky, 
execution-lead: jawad-margieh
topic-lead: Ariel-Guy

            1.24.4.5 CDM store to support filter assignment per vis type	
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3751
Developer: Shirly-Cohen

            1.24.4.6 [Golden Path] HTML5 as a Content provider: CDM library logging and schema validation	
BLI: https://jira.tools.sap/browse/EUXTEAMSAAR-3836
Developer: jawad-margieh

            1.24.4.7  other teams

                1.24.4.7.1  UPA

                    1.24.4.7.1.1  [UPA] Exposure of site via content provider - Design Review
https://wiki.one.int.sap/wiki/display/CPPortals/%5BUPA%5D+Exposure+of+site+via+content+provider+-+Design

                    1.24.4.7.1.2
                1.24.4.7.2
            1.24.4.8 
            1.24.4.9 
            1.24.4.10
            1.24.4.11
            1.24.4.12
        1.24.5    Takt05 , T05 , tags: 2024 Takt05 
id=__2024_Takt05_signoff
            1.24.5.1    signoff
Tasks
SecVal preparation for T05B - 3 PDs Cohen, Shirly 
NG router validation in ADV - 1 PDs Izaq, Yosi 
 
Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 Update the cdm-schema with the new extended regex provided in the Lang-code ADR 1 PD A Cohen, Shirly 
2 Unique Inbound ID - Migration for existing content (local + federated) 5 PDs A Kobi, Hadar Fried, Yoav 
3 Schema validation for unknown entity types 3 PDs A Manshari, Alon 
4 CDM store to support filter assignment per vis type 12 PDs A+B Cohen, Shirly 
5 [CEP] Implement agent orchestration - import 28 PDs SOFT Manshari, Alon 
6 [CEP] Implement agent orchestration - export 18 PDs SOFT Labinsky, Kalman
 
 
            1.24.5.2 SecVal preparation for T05B
            3 PDs Cohen, Shirly 
https://jira.tools.sap/browse/EUXTEAMSAAR-3908            
Developer: Shirly-Cohen

            1.24.5.3 NG router validation in ADV 
             1 PDs Izaq, Yosi 
https://jira.tools.sap/browse/EUXTEAMSAAR-3892

 
            1.24.5.4 Update the cdm-schema with the new extended regex provided in the Lang-code ADR 
            1 PD A Cohen, Shirly 

            1.24.5.5 Unique Inbound ID - Migration for existing content (local + federated) 
            5 PDs A Kobi, Hadar Fried, Yoav 
migration guide: https://wiki.one.int.sap/wiki/display/CPPortals/Businessapps+Unique+Inbound+ID+Migration+Guide+-+CDM+Store+Service
Test-Scope: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=4223838355

            1.24.5.6 Schema validation for unknown entity types 
            3 PDs A Manshari, Alon 
https://jira.tools.sap/browse/EUXTEAMSAAR-3895
Developer: Alon-Manshari

            1.24.5.7 CDM store to support filter assignment per vis type 
            12 PDs A+B Cohen, Shirly 

            1.24.5.8 [CEP] Implement agent orchestration 
            import 28 PDs SOFT Manshari, Alon 

            1.24.5.9 [CEP] Implement agent orchestration 
            export 18 PDs SOFT Labinsky, Kalman
PR: https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/196/files

            1.24.5.10 Update the cdm-schema with the new extended regex provided in the Lang-code ADR
https://jira.tools.sap/browse/EUXTEAMSAAR-3878
Developer: Shirly-Cohen

        1.24.6    Takt06  T06 , tags: Takt06  T06 

            1.24.6.1    signoff

            1.24.6.2

        1.24.7    Takt07  T07 , tags: Takt07  T07 

            1.24.7.1     signoff

                1.24.7.1.1     email
Hi,
Here is our team signoff for T07
 
Team Capacity  -  60 PDs
Support - 30 PDs
Engineering -  5 PDs
 
Tasks Priority Task Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 [Task] NG router Validations in ADV 3 PDs A Fried, Yoav 2 [Task] Default VizType - Support Migration
2 PDs A Cohen, Shirly 3 [Task] Replay Migration not starting on US10 3 PDs A Manshari, Alon Izaq, Yosi 
4 [Task] Security Scans (OSS & SAST) - replace outdated FOSSs in 'cdm.store.service' 2 PDs A/B Stalmakhova, Nataliya (external - Project) 
5 [Task] Unique Inbound ID - Support Migration 2 PDs A/B Cohen, Shirly 
6 [Task] Security - Remove secrets from application logs for 'cdm-export-service' 1 PDs A/B Stalmakhova, Nataliya (external - Project) 
 
BLIs New/Leftover Priority BLI Effort Estimation (in PDs) Planned Sprint (A/B) Comments 
1 [Golden Path] HTML5 as a Content provider: E2E integration and validation 10 PDs A Margieh, Jawad Fried, Yoav
2 [CEP] Implement agent orchestration - import 18 PDs A Manshari, Alon Kobi, Hadar
3 [CEP] Support export / import - Implement workpage export logic 2 PD A Labinsky, Kalman 
4 [CEP] Import/export page and spaces - E2E validation cross teams 13 PDs A+B Labinsky, Kalman 
5 Unique Inbound ID - E2E Validation & Testing 8 PDs A+B Cohen, Shirly 
6 [CEP] Support export / import - productisation - Public API for export 4 PDs SOFT Labinsky, Kalman 
 
Engineering Priority Task Effort Estimation (in PDs) Planned Sprint (A/B) Comments
1 [ENG] Skipping siteActivation calculation in the cdm store service during content deployment 10 PDs Capped by 5 PDs allocation for eng SOFT Margieh, Jawad 
 
                1.24.7.1.2 wiki 
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2407+Sign-Off

                1.24.7.1.3 Tasks

                    1.24.7.1.3.1 [Task] NG router Validations in ADV 3 PDs A Fried, Yoav 2 [Task] Default VizType - Support Migration
                    1.24.7.1.3.2 PDs A Cohen, Shirly 3 [Task] Replay Migration not starting on US10 3 PDs A Manshari, Alon Izaq, Yosi 
                    1.24.7.1.3.4 [Task] Security Scans (OSS & SAST) - replace outdated FOSSs in 'cdm.store.service' 2 PDs A/B Stalmakhova, Nataliya (external - Project) 
                    1.24.7.1.3.5 [Task] Unique Inbound ID - Support Migration 2 PDs A/B Cohen, Shirly 
                    1.24.7.1.3.6 [Task] Security - Remove secrets from application logs for 'cdm-export-service' 1 PDs A/B Stalmakhova, Nataliya (external - Project) 

                1.24.7.1.4 BLIs
                    1.24.7.1.4.1 [Golden Path] HTML5 as a Content provider: E2E integration and validation 10 PDs A Margieh, Jawad Fried, Yoav

                        1.24.7.1.4.1.1  Subject: RE: Please review the HTML5 content provider documentation - updated links
 
Update – build is ready - please use only these links*:

Dev Guide:
Developing HTML5 Business Solutions as Content Providers - https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/developing-html5-apps-for-cross-subaccount-consumption?&state=DRAFT
About the Common Data Model Definitions - https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/creating-cdm-json-file-for-multi-tenancy-html5-app?&state=DRAFT

 
Admin Guide:
Federation of HTML5 Business Solutions[[NA]]  approved from my side
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/federation-of-html5-business-solutions?&state=DRAFT

Settings for HTML5 Business Solutions[[NA]]  comments were added
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/settings-for-html-business-solutions-work-in-progress?&state=DRAFT

Manage Content Providers (HTML5 Business Solutions)[[NA]]  approved from my side
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/manage-content-providers-html5-business-solutions?&state=DRAFT

Assign Roles to Site and Users to Roles[[NA]]  comments were added
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/assign-roles-to-site-and-users-to-roles?&state=DRAFT

Consume HTML5 Business Solutions Across Subaccounts[[NA]]  comments were added
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/consume-html5-business-solutions-across-subaccounts?&state=DRAFT

Restrictions - Work in Progress[[NA]]  approved from my side
https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/restrictions-work-in-progress-not-for-review-yet?&state=DRAFT
 
Not for Review
The following topics are conceptual topics + diagrams that we will only be updated in takt7.
Integrating Business Content
Learn the Basics of Integrating Content

                        1.24.7.1.4.1.2
                    1.24.7.1.4.2 [CEP] Implement agent orchestration - import 18 PDs A Manshari, Alon Kobi, Hadar
                    1.24.7.1.4.3 [CEP] Support export / import - Implement workpage export logic 2 PD A Labinsky, Kalman 
PR: https://github.wdf.sap.corp/Portal-CF/cdm-export-service/pull/216/files
נראה לי פחות או יותר סיימתי
אולי קצת לסדר את הקוד
אחרי שלמתי יותר על streams
נראה לי זה היה יחסית יותר חלק
הכל עם promises
בלי on("event")
with callbacks
export agent fixes,
save zip in tmp, only stream file once all agents succeeded

                    1.24.7.1.4.4 [CEP] Import/export page and spaces - E2E validation cross teams 13 PDs A+B Labinsky, Kalman 
                    1.24.7.1.4.5 Unique Inbound ID - E2E Validation & Testing 8 PDs A+B Cohen, Shirly 
                    1.24.7.1.4.6 [CEP] Support export / import - productisation - Public API for export 4 PDs SOFT Labinsky, Kalman 
		
                        1.24.7.1.4.6.1 Subject: Public API - Portal PR - add support for workpages and pages
 
I created a PR for extending are api payload to enable a new entity.
Can you please review and if it’s ok merge it to staging.
Link: https://git.wdf.sap.corp/c/contentpipeline/+/6184250
 
I see there are some warnings, we have commitment and we will handle this later.
I wanted to ask regarding x-sap-shortText, currently we don’t have this but I see there is a message that it’s missing.
Can you please elaborate if it’s mandatory, also where would it appear If we have it.
I just see a json example here https://pages.github.tools.sap/CPA/api-metadata-validator/rules/oas/sap-oas-short-text/, but it’s unclear to me where it would be in the UI
Link to current API:  https://api.sap.com/api/ContentExport/resource/
 
                        1.24.7.1.4.6.2

                1.24.7.1.5 Eng
		
                    1.24.7.1.5.1 [ENG] Skipping siteActivation calculation in the cdm store service during content deployment 10 PDs Capped by 5 PDs allocation for eng SOFT Margieh, Jawad 

                    1.24.7.1.5.2
                1.24.7.1.6 

            1.24.7.2 Additional BLIs

                1.24.7.2.1 Provider site handling errors & messages Design review
https://wiki.one.int.sap/wiki/display/CPPortals/%5BSAL%5D+Exposure+of+site+via+content+provider+-+Design

Motivation:  
SAP Ariba Launchpad wants to deliver central Entry point (based on STD edition) for multiple procurement solutions.
Provide an Integrated Experience to Procurement End-Users via a "Unified Entry point for LoB" across BTP, S/4 and ARIBA technology
Procurement providing resources to fill the gap and deliver SAL (Unified Procurement Access) to substitute missing resources in UES
SAL has several procurement solutions which one of them is a content provider that will be aggregated into one "central" content provider, which will expose all the content from all content providers(procurement solutions). 
This SAL central entry point should be SAP Managed solution, customer will get RT site with all procurement solutions. No admin for first phase.
There is a part that will be done by Moritz team with UCL, to provide an ability to do automatic set up for the SAL customers. SAP Managed site. 
... more details are covered in the following deck: https://sap-my.sharepoint.com/:p:/r/personal/damian_lion_maring_sap_com/Documents/Powerpoint/Procurement%20UPA%20Work%20Packages.pptx?d=w23bbbfc98e5442f4a38058f90a0a8040&csf=1&web=1&e=d6zUFf


Cdm Store Service
the service will need to handle/do the following:

change the portal site schema to enable site cherry-pick
add relations/base entry to the schema and use relation.json to define this entry.
add oneof required for the site - [ _version, identification, payload ] or [ _version, identification, relations ] 
site cherry-pick creation:
use cherry-pick API

/cdm/entities/extends this API is currently in use in order to create role and businessapp cherry-pick

support mass cherry-pick creation at once.
a designated API for cherry-pick creation
need to add a few code changes to support site cherry-pick
in our case we will need to create also sitereferences entities - this API currently doesn't create it.
use batch API

/cdm/batch this API is currently in use to create entities via the UI (semantic service)

no need to change the code
we can call this API with 2 entities as 1 transaction creation - site cherry-pick and sitereferences entities.
doesnt support mass cherry-pick creation.
it's not a cherry-pick API so if we will want to add more functionally in the future for cherry picking - we will need to change also batch API.
if option 1 is selected - we will add the creation of sitereferences with the site cherry-pick creation in the cherry-pick API.
when using the cherry-pick API when creating a site - we need to to create it under the site id context. 
make sure affected site will return the cherry-picked site when updating the snapshot.


Transport Service
the service will need to handle/do the following:

transport service will support creation or update of a single site entity per snapshot
if a transport run will run without delta link - the service will make sure that the current run will have max 1 site entity. if the service will get more then 1 site entity - an appropriate error will be raised.
if a transport run will run with delta link - the service will read from cdm store service the site entity id that is currently stored (if there is one like that) and will validate that if a site is returned from the content provider it has to be the site id that is currently stored in the cdm store service.


the service will create a portal schema site entity - when a core site entity is returned from content provider
the site id will be prefixed with the context id (provider id) - run the resolver code add the prefix for all entities.
create the portal site properties according to the core schema site entity received - need to go over both schema and see which property is written in the other one.
add a property - payload/core.site - and attached the core site entity under it. - will be used for "set site alias" for provider service and also for future use. ֿ
currently the service raise/uses event via Redis pub/sub - we want to start using solace messaging queue in order to send message about transport ended.
transport service will publish event via Solace messaging queue on topic - "/transport/{transportType}/ended" - which transport type can be - external/content_package - the message that will be published - will be the same report JSON object that it raised today via Redis pub/sub.

https://www.websequencediagrams.com/app:
title Provider Creation Flow
 
participant "SAL Provisioning" as SAL
participant "Semantic Service" as SS
participant "Provider Service" as PS
participant "Transport Service" as TS
participant "Cdm Store Service" as CDMSS
participant "Content provider" as CP
 
SAL-->>SS: create provider
SS-->>TS: create provider snapshot
activate TS
  loop
      TS->CP: retrieve CDM content page (may including site)
      TS->TS: validate site entity
      TS->TS: create portal site entity from core site entity
  end
  TS->CDMSS: store snapshot
  TS->TS: transport ended publish(event)
deactivate TS
PS->PS: transport ended(event)
activate PS
alt snapshot site created (via the transport report message)
PS->CDMSS: create cherry-pick site (and sitereferences)
PS->PS: call automatic roles assignment between site id and provider id
PS->SS: call site alias API
end
deactivate PS

Provider service
provider service will be subscribe to the following solace events (published by cdm-store-service):

site created - topic → "v2/cdm/site/entities/created"
site modified - topic → "v2/cdm/site/entities/modified"
site deleted - topic → "v2/cdm/site/entities/deleted"
when a site is been created/modified/deleted the provider service will check if the site if the site context is snapshot (coming from provider snapshot change), the provider service will do the following:

when site created:
provider service will created a site (site cherry pick and sitereferences) by calling to cdm-store-service API
provider service will created a roles assignment between the provider id and the new site id
provider service will set the site alias which was set by the site exposed from the snapshot - by calling semantic service set alias API
when site modified:
provider service will set/update/delete the site alias which was set/deleted by the site exposed from the snapshot - by calling semantic service set alias API
when site deleted:
provider service will deleted site (site cherry pick and sitereferences) by calling cdm-store-service API
provider service will delete the automatic roles assignment between the provider id and the deleted site id
provider service will delete the site alias for the deleted site - by calling semantic service set alias API

database changes
2 new tables will be added

table name: providers_cherry_pick_sites

type	text	text	text	text	bigint	text(created/updated)
table name: providers_cherry_pick_sites_events

type	text	text	text	text	bigint	bigint	text(create/update/delete)	json	text(to_be_processed/processing/processed)  
site logic → 

this logic will receive a tenant provider and site and will do the following → 

will query the providers_cherry_pick_sites_event table for rows which equals to the tenant provider and site received as long as there is no row in processing status for the last 1 min.
in case there are rows returned from 1 → the logic will read the current last_site_action and site_last_update_timestamp values from the providers_cherry_pick_sites table, if there are no rows from 1 exit the logic.
the row from 1 with the highest site_update_timestamp will be processed →
will check if the site_update_timestamp is not greater than the site_last_update_timestamp move to 5 (don't need to perform anything).  
will check if site_action → 
if create/update
will run create logic (as mentioned above) if there is no last_site_action from 2
will run update logic (as mentioned above) if there is last_site_action from 2
is delete
will run delete logic (as mentioned above) if there is last_site_action from 2
after the logic the providers_cherry_pick_sites will be updated with the last operation we run and (same transaction)
all the rows from 1 will be marked as processed in providers_cherry_pick_sites_event table.
will run from 1 again. 


                1.24.7.2.2

            1.24.7.3
        1.24.8    Takt08  T08 , tags: Takt08  T08 
        1.24.9    Takt09  T09 , tags: Takt09  T09 
        1.24.10   Takt10 T10, tags: Takt10 T10
        1.24.11   Takt11 T11
        1.24.12   Takt12 T12
        1.24.13   Takt13 T13


    1.25 2025
    1.26
    1.27
    1.28
    1.29
    1.30
    1.31
    1.32
    1.33
    1.34
    1.35
    1.36
    1.37
    1.38
    1.39
    1.40
    1.41
    1.42
    1.43
    1.44
    1.45
    1.46
    1.47
    1.48
    1.49
    1.50

2. CF, Cloud Foundry

    2.0 logs, kibana, tags: logs, kibana, CLS, cloud logging service

        2.0.1  application logging


internal canary: https://logs.cf.hana.ondemand.com/

Production DCs:
eu12: https://logs.cf.eu12.hana.ondemand.com/
eu10: https://logs.cf.eu10.hana.ondemand.com/
us10: https://logs.cf.us10.hana.ondemand.com/
cn40: https://logs.cf.cn40.hana.ondemand.com/
<DC>: https://logs.cf.<DC>.hana.ondemand.com/

        2.0.2 CLS, cloud logging service, tags: CLS, cloud logging service, 
https://wiki.one.int.sap/wiki/display/CPPortals/CLS+Dashboard+links

ap11,https://kibana-sf-fa4357ef-9b6d-496e-b76c-a55c913a60e2.001.ap11.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


ap12,https://kibana-sf-9f1eba5a-4062-4f31-8c93-4f40b4e63ddf.001.ap12.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


ap20,https://kibana-sf-9e084d1d-44c2-4c00-994e-d27279f7fd1e.003.ap10.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


br10,https://kibana-sf-845c9bdd-0a85-4f5d-8eb9-ee2f0a41834a.003.br10.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


eu10,https://kibana-sf-024d4a69-0577-4910-9985-12e630e3b843.cls-10.cloud.logs.services.eu10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


us10,https://kibana-sf-455ab4a5-9f75-4b92-ab9f-789a7a80f8a5.cls-05.cloud.logs.services.us10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


ap10,https://kibana-sf-4a244a51-8f58-416f-bcd6-fd21c5d4617b.003.ap10.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


us21,https://kibana-sf-acc1af0b-e4ea-4886-a156-4bae1535ad94.cls-05.cloud.logs.services.us10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


ca10,https://kibana-sf-77894f85-24e6-445d-a662-42a4b3d15806.cls-05.cloud.logs.services.us10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


eu20,https://kibana-sf-cd9a0d28-1a1f-4aca-9c28-511fcd398114.cls-10.cloud.logs.services.eu10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


eu11,https://kibana-sf-e4890ed2-be0e-4135-94e2-3cdcee7a3a8f.cls-10.cloud.logs.services.eu10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767  has context menu


jp20,https://kibana-sf-0a097035-79c6-4a50-bf87-6dc1880c5ac1.003.ap10.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


us20,https://kibana-sf-8042cf4a-006b-4936-a1eb-e712f6f196ce.cls-04.cloud.logs.services.us10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


jp10,https://kibana-sf-3a62f11c-3ed5-419c-9f09-fac7d25740b2.003.ap10.cls.services.cloud.sap/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


us30hotfix,https://kibana-sf-020bd202-919b-464f-84f5-0f45689acbb7.cls-04.cloud.logs.services.us10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


eu10hotfix,https://kibana-sf-04fbee18-c7a5-47f9-a2a5-798c3baf9929.cls-05.cloud.logs.services.eu10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


eu20hotfix,https://kibana-sf-0e68a2b5-9367-4ca4-969b-117d992bf612.cls-04.cloud.logs.services.eu10.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


canaryeu12,https://kibana-sf-0eb06f0d-5f37-40f1-809f-167779b64893.cls-02.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


canaryeu10,https://kibana-sf-ed4e2188-ad1e-425b-badd-474990fc49b8.cls-03.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


canaryeu12,https://kibana-sf-445a2e9a-92ab-40ba-87e0-31ad0ecee47a.cls-03.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


rcteu12,https://kibana-sf-022ab075-edec-4169-99a5-d1bdeb04aa85.cls-03.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


flprct,https://kibana-sf-2428011b-6147-4100-8475-f50ab627c508.cls-01.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


rct,https://kibana-sf-678a469f-5771-4a8a-b758-6a10f88b2281.cls-01.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


daily,https://kibana-sf-65286307-51ee-49d8-a1e7-70412b5c93ea.cls-01.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


lts,https://kibana-sf-f1644e91-c824-4529-b728-43d175dcbf2d.cls-03.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


flplts,https://kibana-sf-3e404bdb-6ab5-464c-8f6a-1f172436dcd3.cls-03.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767


ltseu12,https://kibana-sf-d6799c6d-c4b1-443a-8621-43c371882bcd.cls-02.cloud.logs.services.sap.hana.ondemand.com/app/dashboards#/view/maintained-by-perfx_cf-content-package_CF-Requests-and-Logs?_g=h@c823129&amp;_a=h@063a767




        2.0.3

    2.1 CF CLI tags: CF CLI, command line


        2.1.1 First steps , tags: cf 101, login, api, endpoint

            2.1.1.1 install 


install cli via package:
https://github.com/cloudfoundry/cli/wiki/V8-CLI-Installation-Guide#installers-and-compressed-binaries
https://packages.cloudfoundry.org/stable?release=macosx64&version=v8&source=github

install cli via brew:
brew install cloudfoundry/tap/cf-cli

upgrade:
$ brew upgrade cloudfoundry/tap/cf-cli
Updating Homebrew...


            2.1.1.2 login, api endpoints , tags: login api endpoints 

                2.1.1.2.1 EU10 canary api

https://cpcli.cf.sap.hana.ondemand.com
API endpoint:   https://api.cf.sap.hana.ondemand.com
set api: cf api https://api.cf.sap.hana.ondemand.com

                2.1.1.2.2 EU10 production 
set api endpoint: cf api api.cf.eu10.hana.ondemand.com

                2.1.1.2.3 US20, US21
api.cf.us20.hana.ondemand.com
cf api api.cf.us21.hana.ondemand.com

                2.1.1.2.4 General form API
api.cf.<DC>.hana.ondemand.com

                2.1.1.2.5 EU12 provider accounts endpoints
cf api api.cf.eu12.hana.ondemand.com

            2.1.1.3 login
login with SSO
$ cf login --sso
API endpoint: https://api.cf.eu10.hana.ondemand.com

Temporary Authentication Code ( Get one at https://login.cf.eu10.hana.ondemand.com/passcode ): 
go to this URL, enter passcode from authenticator 
then copy paste passcode


login: cf l(ogin)
logout: cf logout
change space org, ex. to fcc : cf t -o fcc -s myspace
check space: cf t
push to space: cf push -f maifest.yml
list service instances: cf s


            2.1.1.4
        2.1.2 manage service-instances

            2.1.2.1 get list of bound services: cf s
get specific service. grep. ex:
[i500695@C02X632CJGH6:2018-12-18 18:17:25:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1002$ cf s | grep meter
portal-metering                                   metering                                   standard                          portal-cf-site-service, portal-cf-technical-support-blue                                                                                                                                                                                                                                                                                                                                                                      create succeeded
portal-metering-service                           metering-service                           development                       portal-cf-site-semantic-service                                                                                                                                                          

            2.1.2.2 unbind service: cf us app service
[i500695@C02X632CJGH6:2018-12-18 18:18:34:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1003$ cf -help us
NAME:
   unbind-service - Unbind a service instance from an app

USAGE:
   cf unbind-service APP_NAME SERVICE_INSTANCE
ex: 
[i500695@C02X632CJGH6:2018-12-18 18:20:10:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1005$ cf us portal-cf-site-semantic-service portal-metering-service 
Unbinding app portal-cf-site-semantic-service from service portal-metering-service in org fcc / space boris-provider as i500695...
OK


            2.1.2.3 delete a service: cf ds service
[i500695@C02X632CJGH6:2018-12-18 18:19:34:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1004$ cf -help ds
NAME:
   delete-service - Delete a service instance

USAGE:
   cf delete-service SERVICE_INSTANCE [-f]

ALIAS:
   ds

OPTIONS:
   -f      Force deletion without confirmation

   ex:
$ cf ds portal-metering-service

Really delete the service portal-metering-service?> y
Deleting service portal-metering-service in org fcc / space boris-provider as i500695...
OK

            2.1.2.4 create service
cf cs service-instance

ex:
[i500695@C02X632CJGH6:2018-12-19 10:38:06:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1008$ cf create-service metering-service default  portal-metering-service -c '{"providerToken":"f3efd8a9-dfc7-4a98-83d6-d6c922b05a6c"}' 
Creating service instance portal-metering-service in org fcc / space boris-provider as i500695...
OK

Attention: The plan `default` of service `metering-service` is not free.  The instance `portal-metering-service` will incur a cost.  Contact your administrator if you think this is in error.

            2.1.2.5 bind service to app
[i500695@C02X632CJGH6:2018-12-19 10:38:19:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1009$ cf help bs
NAME:
   bind-service - Bind a service instance to an app

USAGE:
   cf bind-service APP_NAME SERVICE_INSTANCE [-c PARAMETERS_AS_JSON] [--binding-name BINDING_NAME]

   Optionally provide service-specific configuration parameters in a valid JSON object in-line:

   cf bind-service APP_NAME SERVICE_INSTANCE -c '{"name":"value","name":"value"}'

   Optionally provide a file containing service-specific configuration parameters in a valid JSON object. 
   The path to the parameters file can be an absolute or relative path to a file.
   cf bind-service APP_NAME SERVICE_INSTANCE -c PATH_TO_FILE

   Example of valid JSON object:
   {
      "permissions": "read-only"
   }

   Optionally provide a binding name for the association between an app and a service instance:

   cf bind-service APP_NAME SERVICE_INSTANCE --binding-name BINDING_NAME

EXAMPLES:
   Linux/Mac:
      cf bind-service myapp mydb -c '{"permissions":"read-only"}'

   Windows Command Line:
      cf bind-service myapp mydb -c "{\"permissions\":\"read-only\"}"

   Windows PowerShell:
      cf bind-service myapp mydb -c '{\"permissions\":\"read-only\"}'

   cf bind-service myapp mydb -c ~/workspace/tmp/instance_config.json --binding-name BINDING_NAME

ALIAS:
   bs

OPTIONS:
   --binding-name      Name to expose service instance to app process with (Default: service instance name)
   -c                  Valid JSON object containing service-specific configuration parameters, provided either in-line or in a file. For a list of supported configuration parameters, see documentation for the particular service offering.

SEE ALSO:
   services

ex:
[i500695@C02X632CJGH6:2018-12-19 10:40:31:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1010$ cf bs portal-cf-site-semantic-service portal-metering-service 
Binding service portal-metering-service to app portal-cf-site-semantic-service in org fcc / space boris-provider as i500695...
OK
TIP: Use 'cf restage portal-cf-site-semantic-service' to ensure your env variable changes take effect

            2.1.2.6 restage, reload configuration
cf restage app

<< Index
NOME
restage - Stage the app's latest package into a droplet and restart the app with this new droplet and updated configuration (environment variables, service bindings, buildpack, stack, etc.).
UTILIZZO
cf restage APP_NAME
This command will cause downtime unless you use '--strategy rolling'.
EXAMPLES
cf restage APP_NAME
cf restage APP_NAME --strategy rolling
cf restage APP_NAME --strategy rolling --no-wait
ALIAS
rg
OPZIONI
--strategy
Deployment strategy, either rolling or null.

--no-wait
Exit when the first instance of the web process is healthy

AMBIENTE
CF_STAGING_TIMEOUT=15 Max wait time for staging, in minutes


            2.1.2.7 env, read app config
cf env
ex:
[i500695@C02X632CJGH6:2018-12-19 10:51:19:~/Desktop/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]1012$ cf restage portal-cf-site-semantic-service
Waiting for app to start...

name:              portal-cf-site-semantic-service
requested state:   started
routes:            portal-service-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic
last uploaded:     Wed 19 Dec 10:50:55 IST 2018
stack:             cflinuxfs2
buildpacks:        nodejs

type:            web
instances:       1/1
memory usage:    1024M
start command:   npm start
     state     since                  cpu    memory        disk           details
#0   running   2018-12-19T08:51:17Z   0.0%   31.6M of 1G   339.7M of 1G   

            2.1.2.8 set env
cf set-env app var val

                2.1.2.8.1 set log level
cf set-env app CF_APP_LOG_LEVEL level
PORTAL-CF
ex:
cf set-env portal-cf-site-semantic-service CF_APP_LOG_LEVEL debug 
cf set-env portal-cf-cdm-store-service CF_APP_LOG_LEVEL debug  && cf restage portal-cf-cdm-store-service

e.g.
 grep LEVEL manifest*
manifest-concourse.yml:    CF_APP_LOG_LEVEL: INFO
manifest-dev.yml:    CF_APP_LOG_LEVEL: debug
manifest.yml:    CF_APP_LOG_LEVEL: INFO

                2.1.2.8.2
            2.1.2.9 manually copy files ssh to container
cat src/main.ts  | cf ssh portal-cf-transport-service "cat > /home/vcap/app/src/main.ts"

            2.1.2.10 restart

0 downtime restarts:
a. plugin https://github.com/homedepot/cf-rolling-restart

b.  restart per instance:
cf restart-app-instance Test 0
cf restart-app-instance Test 1
cf restart-app-instance Test 2

            2.1.2.11 cf cli check information re. redis service plan and version
To check information about Redis service plan and version using the cf CLI, you can use the following command:

cf service SERVICE_INSTANCE_NAME
Replace SERVICE_INSTANCE_NAME with the name of your Redis service instance.

This command will display detailed information about your service instance, including its plan, version, and other details such as service bindings and credentials.

You can also use the following command to list all the service instances in your space and their respective plans:

cf services
This will display a list of all the service instances in your space along with their respective service plans and other information.

Note that the output of these commands may vary depending on the version of the cf CLI you are using and the specific Redis service provider you are using.

            2.1.2.12
        2.1.3 generate oauth-token 
$ cf oauth-token

            2.1.2.11 unbind all apps using a service and then delete it 
Motivation: when a service is not longer needed it should be removed to save costs
delete service will fail as long as there apps bound to it.
let's automate the process

example account:
a. login to space 
| [i500695@WYLQRXL9LQ:2022-09-15 12:50:52:~:]2001$ cf login --sso
| API endpoint: https://api.cf.sap.hana.ondemand.com
| 
| Temporary Authentication Code ( Get one at https://login.cf.sap.hana.ondemand.com/passcode ): 
| Authenticating...
| OK
| 
| 
| Select an org:
| 1. devspaces
| 2. DynamicForms
| 3. flpci
| 4. i500695launchpad
| 5. launchpad
| 6. mainsub
| 7. perfdt
| 8. portal-prov
| 9. rcsub
| 10. SaarTest
| 11. SAP_PORTAL_SERVICES
| 12. swz
| 13. swzmainlts
| 14. swzperf
| 15. yosiTests
| 
| Org (enter to skip): 5
| Targeted org launchpad.
| 
| Select a space:
| 1. i055502c
| 2. i055502p
| 3. i060224p
| 4. i310019c
| 5. i310019p
| 6. i324180c
| 7. i324180p
| 8. i349433c
| 9. i500695
| 10. i500695c
| 11. i500695p
| 12. i521258c
| 13. i521258p
| 
| Space (enter to skip): 9
| Targeted space i500695.
| 
| API endpoint:   https://api.cf.sap.hana.ondemand.com
| API version:    3.120.0
| user:           yosi.izaq@sap.com
| org:            launchpad
| space:          i500695

b. list services 
cf s 
c. 

cd ~/work/scripts/python/cf/
<url:~/work/scripts/python/cf/cfServiceMgr.py>
reference: <url:/Users/i500695/work/KB/python/KB_python#r=__cli_menu_python__>
            2.1.2.12
        2.1.4 organizations and spaces

            2.1.4.1 get organizations names
[i500695@WYLQRXL9LQ:2022-04-04 13:33:33:~/git/portal-cf-cdm-store-service:]2017$ cf orgs
Getting orgs as yosi.izaq@sap.com...

name
DynamicForms
flpci
i500695launchpad
launchpad
mainsub
perfdt
portal-prov
rcsub
SaarTest
SAP_PORTAL_SERVICES
swz
swzmainlts
swzmainltshtml5apps
swzperf
swzrcrcthtml5apps

            2.1.4.2 get organization GUID
[i500695@WYLQRXL9LQ:2022-04-04 13:33:38:~/git/portal-cf-cdm-store-service:]2018$ cf org launchpad --guid
c7486965-e5bd-4047-a1a1-79f702a29304

            2.1.4.3 get spaces names 
[i500695@WYLQRXL9LQ:2022-04-04 13:33:42:~/git/portal-cf-cdm-store-service:]2019$ cf spaces
Getting spaces in org launchpad as yosi.izaq@sap.com...
name
i055502c
i055502p
i060224p
i310019c
i310019p
i324180c
i324180p
i349433c
i500695c
i500695p
i521258c
i521258p

            2.1.4.4 get space guid
$ cf space i500695p --guid
7e0d5a8a-30ae-4b1b-948b-cfa4914de088
            2.1.4.5 create space 
cf create-space <space name> 

            2.1.4.6 programmatically iterate over spaces in org 
org_guid=$(cf org launchpad --guid)
cf curl "v2/spaces?results-per-page=100&q=organization_guid:$org_guid" | jq -r '.resources[].entity.name'

[i500695@WYLQRXL9LQ:2022-04-04 16:45:42:~/git/portal-cf-site-service:]2015$ cf curl "v2/spaces?results-per-page=100&q=organization_guid:$org_guid" | jq -r '.resources[].entity.name'
i324180p
i055502p
i521258p
i500695p
i310019p
i055502c
i324180c
i310019c
i349433c
i500695c
i521258c
i060224p

same as login into org and listing spaces
[i500695@WYLQRXL9LQ:2022-04-04 16:45:50:~/git/portal-cf-site-service:]2016$ cf spaces
Getting spaces in org launchpad as yosi.izaq@sap.com...
name
i055502c
i055502p
i060224p
i310019c
i310019p
i324180c
i324180p
i349433c
i500695c
i500695p
i521258c
i521258p

for space_name in $(cf curl "v2/spaces?results-per-page=100&q=organization_guid:$org_guid" | jq -r '.resources[].entity.name'); do
    echo "Sharing service instance portal-message-queuing to space $space_name"
    set +e
    cf share-service portal=portal-message-queuing -s $space_name -o <org_name>
    set -e
done
            2.1.4.7 share services 

                2.1.4.7.1  share services manual 
https://docs.cloudfoundry.org/devguide/services/sharing-instances.html
About Service Instance Sharing
Sharing a service instance between spaces allows apps in different spaces to share databases, messaging queues, and other types of services. This eliminates the need for development teams to use service keys and user-provided services to bind their apps to the same service instance that was provisioned using the cf create-service command. Sharing service instances improves security, auditing, and provides a more intuitive user experience.

Service instances can be shared into multiple spaces and across orgs.
Developers and administrators can share service instances between spaces in which they have the Space Developer role.
Developers who have a service instance shared with them can only bind and unbind apps to that service instance. They cannot update, rename, or delete it.
Developers who have a service instance shared with them can view the values of any configuration parameters that were used to provision or update the service instance.
For example, if two development teams have apps in their own spaces, and both of those apps want to send messages to each other using a messaging queue, you can do the following:

The development team in space A can create a new instance of a messaging queue service, bind it to their app, and share that service instance into space B.
A developer in space B can then bind their app to the same service instance, and the two apps can begin publishing and receiving messages from one another.
Enabling Service Instance Sharing in Cloud Foundry
To enable service instance sharing, the platform operator must enable the service_instance_sharing flag in Cloud Foundry.

$ cf enable-feature-flag service_instance_sharing
Sharing a Service Instance
You can share a service instance from one space to another if you have the Space Developer role in both spaces.

To share a service instance to another space, run the following Cloud Foundry Command Line Interface (cf CLI) command:

$ cf share-service SERVICE-INSTANCE -s OTHER-SPACE [-o OTHER-ORG] 
You cannot share a service instance into a space where a service instance with the same name already exists.
To share a service instance into a space, the space must have access to the service and service plan of the service instance that you are sharing. Run the cf enable-service-access command to set this access.
If you no longer have access to the service or service plan used to create your service instance, you cannot share that service instance.
Get Information About Service Instance Sharing
To get information about service instance sharing on the originating space, run the following cf CLI command from that originating space:

cf service SERVICE-INSTANCE-NAME
For example:

$ cf service mydb

name:             mydb
service:          p-mysql
tags:
plan:             100mb
description:      mysql databases on demand been created by a platform.
documentation:
dashboard:        
service broker:   mysql-broker

shared with spaces:
org        space        bindings
org-1      space-1      0
org-1      space-2      2

Showing status of last operation from service my-service-3...

status:    create succeeded
message:   Operation succeeded
started:   2021-03-01T15:10:15Z
updated:   2021-03-01T15:10:17Z

bound apps:
name              binding name   status             message
my-music-app                     create succeeded   Operation succeeded

There is no upgrade available for this service.
For each of the spaces, the service instance is shared into the output. The output shows the number of bindings to apps of the service instance in that space.
When the service instance is not shared, This service is not currently shared appears instead of shared with spaces.
If you run the command while targeting the space where the service instance has been shared, you see the originating space and organization.

For example:

$ cf service mydb 

name:                     mydb
shared from org/space:    acceptance / dev
service:                  p-mysql
tags:
plan:                     100mb
description:              mysql databases on demand been created by a platform.
documentation:
dashboard:        
service broker:           mysql-broker

Showing status of last operation from service my-service-3...

status:    create succeeded
message:   Operation succeeded
started:   2021-03-01T15:10:15Z
updated:   2021-03-01T15:10:17Z

bound apps:
name              binding name   status             message
my-library-app                   create succeeded   Operation succeeded

There is no upgrade available for this service.
In this case, no information about other spaces is exposed.

Unsharing a Service Instance
WARNING: Unsharing a service instance automatically deletes all bindings to apps in the spaces it was shared into. This may cause apps to fail. Before unsharing a service instance, run the cf service SERVICE-INSTANCE command to see how many bindings exist in the spaces the service instance is shared into.

You can unshare a service instance if you have the Space Developer role in the space where this service instance was shared from.

Developers cannot delete or rename a service instance until it is unshared from all spaces.

To unshare a service instance, run the following cf CLI command:

$ cf unshare-service SERVICE-INSTANCE -s OTHER-SPACE [-o OTHER-ORG] [-f]
The optional -f flag forces unsharing without confirmation.

Security Considerations
Service keys cannot be created from a space that a service instance has been shared into.
This ensures that developers in the space where a service instance has been shared from have visibility into where and how many times the service instance is used.
Sharing service instances does not automatically update app security groups (ASGs). The network policies defined in your ASGs may need to be updated to ensure that apps using shared service instances can access the underlying service.
Access to a service must be enabled using the cf enable-service-access command for a service instance to be shared into a space.
Not all services are enabled for sharing instances functionality. Contact the service vendor directly if you are unable to share instances of their service. If you are a service author, see Enabling Service Instance Sharing.
Disabling Service Instance Sharing in Cloud Foundry
To disable service instance sharing, run the following command:

$ cf disable-feature-flag service_instance_sharing
This only prevents new shares from being created. To remove existing shares, see Deleting All Shares.

Deleting All Shares
The script below finds all service instances that are shared, and for each space that the service instance is shared into, all service bindings to that service instance are deleted, and all shares are deleted.

If a service binding is not successfully deleted, the script continues trying to unshare subsequent service instances.

To use this script, you must be logged in as an administrator and have jq installed.

Note: This script has been tested on macOS Sierra 10.12.4 and Ubuntu 14.04.5. Use the script at your own risk.

#!/usr/bin/env bash

set -u
set -e

# refresh auth token
cf oauth-token >/dev/null

for instance_guid in $(cf curl /v3/service_instances | jq -r '.resources[].guid'); do
  for space_guid in $(cf curl /v2/service_instances/$instance_guid/shared_to | jq -r 
'.resources[].space_guid'); do
    echo "Unsharing service instance $instance_guid from space $space_guid"

    set +e
    cf curl -X DELETE "/v3/service_instances/$instance_guid/relationships/shared_spaces/$space_guid"
    set -e
  done
done

                2.1.4.7.2 share service to space command
    cf share-service portal=portal-message-queuing -s $space_name -o <org_name>

                2.1.4.7.3
            2.1.4.8
        2.1.5 read event logs
[i500695@WYLQRXL9LQ:2022-05-03 15:39:00:~/git/portal-cf-design-time-service:]2014$ cf events cdm-import-service
Getting events for app cdm-import-service in org rcsub / space rct as yosi.izaq@sap.com...
time                          event                            actor                         description
2022-04-27T15:24:48.00+0300   audit.app.build.create           sapeuxautomation@sap.com      
2022-04-27T00:34:05.00+0300   audit.app.process.rescheduling   web                           index: 0, reason: Cell is being evacuated, cell_id: dbd234c5-81d6-402b-aa8a-4f577753dcff, instance: 935ee1a0-60b4-4e0a-7a22-52dc
2022-04-26T23:54:22.00+0300   audit.app.process.rescheduling   web                           index: 2, reason: Cell is being evacuated, cell_id: 3ac72a14-94b1-4ccb-8d72-9d8c0e25ae15, instance: 86532dd9-4299-4261-6af9-155f
2022-04-26T23:28:12.00+0300   audit.app.process.rescheduling   web                           index: 1, reason: Cell is being evacuated, cell_id: d9392026-eb5f-4451-884a-7dca46023cdf, instance: a8dee35f-9b89-42b4-594c-6818
2022-04-26T22:07:52.00+0300   audit.app.process.rescheduling   web                           index: 1, reason: Cell is being evacuated, cell_id: 4c083338-aa8b-4174-ae8a-e52e96af2c97, instance: 1218279f-0c61-4fd4-5ed2-2445

        2.1.6
    2.2 FAQ 

        2.2.1  manifest-dev.yml

            2.2.1.1  url

This line must be changed.
    - route: portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/cdm_store_service

otherwise. error. ex:
Pushing from manifest to org fcc / space tomer2 as i500695...
Using manifest file manifest-dev.yml
Deprecation warning: Use of 'buildpack' attribute in manifest is deprecated in favor of 'buildpacks'. Please see http://docs.cloudfoundry.org/devguide/deploy-apps/manifest.html#deprecated for alternatives and other app manifest deprecations. This feature will be removed in the future.

The route 'portal-service<hostsuffix>.cfapps.sap.hana.ondemand.com/cdm_store_service' is not a properly formed URL
FAILED


change to:
+    - route: portal-service-Tomer2-i500695.cfapps.sap.hana.ondemand.com/cdm_store_service

        2.2.2 path attribute, tags: manifest path attribute cf push
We are now supporting the path attribute in manifest yaml before runtime.
This change will allow us to push content from a specific directory to CF, thus decreasing the deployment time.
 
The path should be added from the root directory of the app (exclude the root directory itself), and should be in the “applications” scope in the manifest.
 
For example, If you have a node app and you can push only the content in the “dist” folder, you can simply add this line to the manifest:
“path: dist”

contact: Peeri, Yaniv <yaniv.peeri@sap.com>

        2.2.3
    2.3 Push services

        2.3.1 java based

            2.3.1.1 push latest version
a. gitco master && git pull
b. mci
c. 



        2.3.2 nodejs based

        2.3.3 

    2.4 Remote debug
    
        2.4.1 real remote debug

            2.4.1.1 An easy way to debug Node.JS apps in Cloud Foundry 
https://codeburst.io/an-easy-way-to-debug-node-js-apps-in-cloud-foundry-22f559d44516

Go to the profile of Shimi Tal
Shimi TalFollow
Jun 20, 2017
There are some blogs on how to debug a Node.JS application in CF, but it’s related to the old Node.JS versions, where you should add “node-inspector” and play with the path to the node executable file to invoke the node-inspector.
From the latest node version (v6.3.0+) it’s not needed anymore. To help colleagues that are struggling making it work, I decided to write this short blog explaining how to do it…
Following is step by step guide, how to get it up and debugging
Don’t try it at home/prod :-)
|      1. You should change the start script in the package.json to run with the
|      inspect flag like following: (app.js is your application starting point)
|      “start”: “node --inspect app.js”
|      2. Add node engine entry to your package.json (this step tell to the node.js build-pack which node version should be installed in the application container)
|      “engines”: {
|        “node”: “7.10.0”
|       }
|      3. Push the application:
|      Note : Since not all the platforms Build-pack is supporting the latest node engines you should use the following command, which run the latest node build-pack from Github.
|      Use:
|      cf push -b https://github.com/cloudfoundry/nodejs-buildpack
|      Note: We use version “7.10.0” since this is the minimum node version that supported with the latest (The build-pack supported engine version may be changed frequently, you can see the exact version here) Node.JS build-pack that published on GitHub. (if your platform/custom build-pack support it you just need to simply push your application without the -b flag and the reference URL)
|      For more info see: https://github.com/cloudfoundry/nodejs-buildpack/releases
|      4. Create SSH Tunnel via the terminal that you can remotely access the application debug port which by default is 9229
|      cf ssh -N -T -L 9229:127.0.0.1:9229 <applicationName>
|      Note: To enable SSH access to your app, SSH access must also be enabled for both the space that contains the app and the application. you can do it like following:
|      cf enable-ssh <applicationName>
|      And
|      cf allow-space-ssh SPACE_NAME
|      5. Now you should get the URL of the Chrome dev-tools from the application log
|      cf logs <applicationName> --recent
|      6. Put The URL (can take a few seconds to connect) in the browser and click on Sources, open the tree file entry and navigate to the application starting file app.js/index.js/server.js, etc) and put a break-point(see the screen-shot below).
|      7. Run the application URL in the browser and it should stop at the break-point you set.
|      It should look like:
|      

            2.4.1.2 my guide for remote debug

                2.4.1.2.1 remote debug wiki
                https://wiki.wdf.sap.corp/wiki/display/CPPortals/Remote+Debug+NodeJS+apps+on+CF

                2.4.1.2.2 setup nodejs app
a. Instruct node to open debug port for you application
	a1. package.json
	diff:
+++ b/package.json
@@ -3,7 +3,7 @@
     "version": "1.19.0",
     "description": "Portal Semantic Service",
     "scripts":     {
-        "start": "node ./bin/web",
+        "start": "node --inspect ./bin/web",

	a2. push
cf push -f manifest-dev.yml 

At this point the app container exposes port 9229 locally. 



          localhost                                       remote CF app container

      +-------------------------+                     +-----------------------------+
      |+---------+              |                     |                             |
      ||IDE      |              |9229  SSH-tunel 9229 |       port 9229             |
      ||---------+          +--+|<--------------------++---+-----------+            |
      ||         |          |  ||                     ||localhost      |            |
      ||         |          |--||                     ||   |    +------+------+     |
      |+---------+---------->  ||                     ||   |    |my nodejs app|     |
      |                     |  ||                     ||   |    |-------------|     |
      |          +---------->  ||                     ||   |    |             |     |
      | +--------|          +--+|                     ||   |    |             |     |
      | |Chrom   +              |                     |+---+    |             |     |
      | |--------|              |                     |         +-------------+     |
      | |        |              |                     |                             |
      +-+--------+--------------+                     +-----------------------------+

	a3.

                2.4.1.2.3 remote debug steps 
b. open ssh tunnel
either:
portal node-ssh -a portal-cf-transport-service

or:
      cf ssh -N -T -L 9229:127.0.0.1:9229 <applicationName>
don't stop the command until debug session is over.

e.x:
$       cf ssh -N -T -L 9229:127.0.0.1:9229 portal-cf-site-semantic-service
or $ remDbgSemantic

c. In IntelliJ, edit debug configuraions, + (add new), template 'Attach to Node.js/Chrome),
host: localhost
port: 9229
Attach to: Chrome or nodejs > 6.3

set your breakpoint and debug away :)


            2.4.1.3 possible issues
-> connect to 127.0.0.1:9229 failed: ssh: rejected: connect failed (dial tcp 127.0.0.1:9229: connect: connection refused)
ssh to app container, then run netstat
e.g.
~$ netstat -an
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 0.0.0.0:2222            0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN     
tcp        0      0 10.158.91.174:59882     10.158.91.174:8080      TIME_WAIT  
tcp        0      0 10.158.91.174:59144     3.121.25.45:9999        ESTABLISHED
tcp        0      0 10.158.91.174:59146     3.121.25.45:9999        ESTABLISHED
tcp        0      0 10.158.91.174:58012     10.11.241.100:51817     ESTABLISHED
tcp        0      0 10.158.91.174:59158     10.158.91.174:8080      TIME_WAIT  
tcp        0      0 10.158.91.174:2222      10.0.129.98:47864       ESTABLISHED

see 9229 is not LISTEN.
check how process started.
$ ps -aux | grep node
vcap         152  0.0  0.0   9312   968 ?        S    15:56   0:00 sh -c node dist/main.js
vcap         153  0.5  0.1 1555328 127468 ?      Sl   15:56   0:06 node dist/main.js
note no --inspect. why?
Check package.json npm start and manifest-dev.yml command
e.g.
    command: npm run-script build && npm run-script start:prod
this will override npm start...

For TypeScript can set 
    "start:prod":  "tsc-watch -p tsconfig.build.json --onSuccess \"node --inspect-brk dist/main.js\"",

for just changing on the spot. kill the node process and start manually like 
    /home/vcap/deps/0/bin/node --inspect dist/main.js

->
        2.4.2 Connect to CF xsa from local machine

            2.4.2.1 instructionas in node_modules/@sap/xsenv/README.md
@sap/xsenv
Utility for easy setup and access of environment variables and services in Cloud Foundry and XSA.

Applications in Cloud Foundry take various configurations from the environment. For example Cloud Foundry provides properties of bound services in VCAP_SERVICES environment variable.

To test locally you need to provide these configurations by yourself. This package allows you to provide default configurations in a separate configuration file.

This reduces clutter by removing configuration data from the app code.
You don't have to set env vars manually each time you start your app.
Different developers can use their own configurations for their local tests without changing files under source control. Just add this configuration file to .gitignore and .cfignore.
You can provide default configurations on two levels:

For Cloud Foundry services via getServices() and default-services.json
For any environment variable via loadEnv() and default-env.json
While here we often reference Cloud Foundry, it all applies also to SAP HANA XS Advanced On-premise Runtime which emulates Cloud Foundry as much as possible.

Install

npm install --save @sap/xsenv
Service Lookup

Normally in Cloud Foundry you bind a service instance to your application with a command like this one:

cf bind-service my-app aservice
Here is how you can get this service configuration in your node application:

var xsenv = require('@sap/xsenv');

var services = xsenv.readCFServices();
console.log(services.aservice.credentials); // prints { host: '...', port: '...', user: '...', passwrod: '...', ... }
Often the service instance name is not known in advance. Then you can pass its name as an environment variable and use it like this:

var services = xsenv.readCFServices();
var svc = services[process.env.SERVICE_NAME];
Another alternative is to lookup the service based on its metadata:

var svc = xsenv.cfServiceCredentials({ tag: 'hdb' });
console.log(svc); // prints { host: '...', port: '...', user: '...', passwrod: '...', ... }
This example finds a service binding with hdb in the tags. See Service Query below for description of the supported query values.

You can also look up multiple services in a single call:

var xsenv = require('@sap/xsenv');

var services = xsenv.getServices({
  hana: { tag: 'hdb' },
  scheduler: { label: 'jobs' }
});

var hanaCredentials = services.hana;
var schedulerCredentials = services.scheduler;
This examples finds two services - one with tag hdb and the other with label jobs. getServices function provides additional convenience that default service configuration can be provided in a JSON file.

To test the above example locally, create a file called default-services.json in the working directory of your application. This file should contain something like this:

{
  "hana": {
    "host": "localhost",
    "port": "30015",
    "user": "SYSTEM",
    "password": "secret"
  },
  "scheduler": {
    "host": "localhost",
    "port": "4242",
    "user": "my_user",
    "password": "secret"
  }
}
Notice that the result property names (hana and scheduler) are the same as those in the query object and also those in default-services.json.

Local environment setup describes an alternative approach to provide service configurations for local testing.

User-Provided Service Instances

While this package can look up any kind of bound service instances, you should be aware that User-Provided Service Instances have less properties than managed service instances. Here is an example:

  "VCAP_SERVICES": {
    "user-provided": [
      {
        "name": "pubsub",
        "label": "user-provided",
        "tags": [],
        "credentials": {
          "binary": "pubsub.rb",
          "host": "pubsub01.example.com",
          "password": "p@29w0rd",
          "port": "1234",
          "username": "pubsubuser"
        },
        "syslog_drain_url": ""
	  }
    ]
  }
As you can see the only usable property is the name. In particular, there are no tags for user-provided services.

Service Query

Both getServices and filterCFServices use the same service query values.

Query value	Description
{string}	Matches the service with the same service instance name (name property). Same as { name: '<string>' }.
{object}	All properties of the given object should match corresponding service instance properties as they appear in VCAP_SERVICES. See below.
{function}	A function that takes a service object as argument and returns true only if it is considered a match
If an object is given as a query value, it may have the following properties:

Property	Description
name	Service instance name - the name you use to bind the service
label	Service name - the name shown by cf marketplace
tag	Should match any of the service tags
plan	Service instance plan - the plan you use in cf create-service
If multiple properties are given, all of them must match.

Note: Do not confuse the instance name (name property) with service name (label property). Since you can have multiple instances of the same service bound to your app, instance name is unique while service name is not.

Here ar some examples.

Find service instance by name:

xsenv.cfServiceCredentials('hana');
Look up a service by tag:

xsenv.cfServiceCredentials({ tag: 'relational' });
Match several properties:

xsenv.cfServiceCredentials({ label: 'hana', plan: 'shared' });
Pass a custom filter function:

xsenv.cfServiceCredentials(function(service) {
  return /shared/.test(service.plan) && /hdi/.test(service.label);
});
Notice that the filter function is called with the full service object as it appears in VCAP_SERVICES, but cfServiceCredentials returns only the credentials property of the matching service.

getServices(query, [servicesFile])

Looks up bound service instances matching the given query. If a service is not found in VCAP_SERVICES, returns default service configuration loaded from a JSON file.

query - An object describing requested services. Each property value is a filter as described in Service Query
servicesFile - (optional) path to JSON file to load default service configuration (default is default-services.json). If null, do not load default service configuration.
returns - An object with the same properties as in query argument where the value of each property is the respective service credentials object
throws - An error, if for some of the requested services no or multiple instances are found
cfServiceCredentials(filter)

Looks up a bound service instance matching the given filter.

Note: this function does not load default service configuration from default-services.json.

filter - Service lookup criteria as described in Service Query
returns - Credentials object of found service
throws - An error in case no or multiple matching services are found
filterCFServices(filter)

Returns all bound services that match the given criteria.

filter - Service lookup criteria as described in Service Query
returns - An array of credentials objects of matching services. Empty array, if no matches found.
readCFServices()

Transforms VCAP_SERVICES to an object where each service instance is mapped to its name.

Given this VCAP_SERVICES example:

  {
    "hana" : [ {
      "credentials" : {
        ...
      },
      "label" : "hana",
      "name" : "hana1",
      "plan" : "shared",
      "tags" : [ "hana", "relational" ]
    },
    {
      "credentials" : {
        ...
      },
      "label" : "hana",
      "name" : "hana2",
      "plan" : "shared",
      "tags" : [ "hana", "relational", "SP09" ]
    } ]
  }
readCFServices would return:

{
  hana1: {
    "credentials" : {
      ...
    },
    "label" : "hana",
    "name" : "hana1",
    "plan" : "shared",
    "tags" : [ "hana", "relational" ]
  },
  hana2: {
    "credentials" : {
      ...
    },
    "label" : "hana",
    "name" : "hana2",
    "plan" : "shared",
    "tags" : [ "hana", "relational", "SP09" ]
  }
}
Local environment setup

To test your application locally you often need to setup its environment so that resembles the environment in Cloud Foundry. You can do this easily by defining the necessary environment variables in a JSON file.

For example you can create file default-env.json with the following content in the working directory of the application :

{
  "PORT": 3000,
  "VCAP_SERVICES": {
    "hana": [
      {
        "credentials": {
          "host": "myhana",
          "port": "30015",
          "user": "SYSTEM",
          "password": "secret"
        },
        "label": "hana",
        "name": "hana-R90",
        "tags": [
          "hana",
          "database",
          "relational"
        ]
      }
    ],
    "scheduler": [
      {
        "credentials": {
          "host": "localhost",
          "port": "4242",
          "user": "jobuser",
          "password": "jobpassword"
        },
        "label": "scheduler",
        "name": "jobscheduler",
        "tags": [
          "scheduler"
        ]
      }
    ]
  }
}
Then load it in your application:

xsenv.loadEnv();
console.log(process.env.PORT); // prints 3000
console.log(xsenv.cfServiceCredentials('hana-R90')); // prints { host: 'myhana, port: '30015', user: 'SYSTEM', password: 'secret' }
This way you don't need in your code conditional logic if it is running in Clod Foundry or locally.

You can also use a different file name:

xsenv.loadEnv('myenv.json');
loadEnv([file])

Loads the environment from a JSON file. This function converts each top-level property to a string and sets it in the respective environment variable, unless it is already set. This function does not change existing environment variables. So the file content acts like default values for environment variables.

This function does not complain if the file does not exist.

file - optional name of JSON file to load, 'default-env.json' by default. Does nothing if the file does not exist.
Loading SSL Certificates

If SSL is configured in XSA On-Premise Runtime, it will provide one or more trusted CA certificates that applications can use to make SSL connections. If present, the file paths of these certificates are listed in XS_CACERT_PATH environment variable separated by path.delimiter (: on LINUX and ; on Windows).

loadCertificates([certPath])

Loads the certificates listed in the given path. If this argument is not provided, it uses XS_CACERT_PATH environment variable instead. If that is not set either, the function returns undefined. The function returns an array even if a single certificate is provided. This function is synchronous.

certPath - optional string with certificate files to load. The file names are separated by path.delimiter. Default is process.env.XS_CACERT_PATH.
returns - an array of loaded certificates or undefined if certPath argument is not provided
throws - an error, if some of the files could not be loaded
For example this code loads the trusted CA certificates so they are used for all subsequent outgoing HTTPS connections:

var https = require('https');
var xsenv = require('@sap/xsenv');

https.globalAgent.options.ca = xsenv.loadCertificates();
This function can be used also to load SSL certificates for HANA like this:

var hdb = require('hdb');
var xsenv = require('@sap/xsenv');

var client = hdb.createClient({
  host : 'hostname',
  port : 30015,
  ca   : xsenv.loadCertificates(),
  ...
});
loadCaCert()

Deprecated. Use loadCertificates instead.

This function loads the certificates listed in XS_CACERT_PATH environment variable into https.globalAgent of Node.js. All subsequent outgoing HTTPS connections will use these certificates to verify the certificate of the remote host. The verification should be successful if the certificate of the remote host is signed (directly or via some intermediary) by some of these trusted certificates.

It is suggested to call this function once during the application startup.

xsenv.loadCaCert();
If XS_CACERT_PATH variable is not set, the function does nothing. This function is synchronous. It will throw an error if it cannot load some of the certificates.

Debugging

Set DEBUG=xsenv in the environment to enable debug traces. See debug package for details.

            2.4.2.2
        2.4.3 Issues

            2.4.3.1 remote debug your newly concurse created space that SSH fails.
Workaround:
 
Go here: https://github.com/orange-cloudfoundry/cf-plugin-bg-restage/releases
Download cf-plugin-bg-restage_darwin_amd64
Run cf install-plugin cf-plugin-bg-restage_darwin_amd64
ex:
[i500695@C02X632CJGH6:2020-04-28 10:58:07:~/temp/temp1:]2018$ cd ~/Downloads/
[i500695@C02X632CJGH6:2020-04-28 11:02:42:~/Downloads:]2019$ cf install-plugin cf-plugin-bg-restage_darwin_amd64
Attention: Plugins are binaries written by potentially untrusted authors.
Install and use plugins at your own risk.
Do you want to install the plugin cf-plugin-bg-restage_darwin_amd64? [yN]: y
Installing plugin bg-restage...
OK

Plugin bg-restage 1.1.0 successfully installed.


Run cf bg-restart appName (cf bg-restart portal-cf-site-semantic-service)
Try and open a bridge for debugging again (portal node-ssh --application portal-cf-site-semantic-service)

        2.4.4
    2.5 cf ssh, tags: cf ssh enable-ssh 

        2.5.1  basic cf ssh 


https://docs.cloudfoundry.org/devguide/deploy-apps/ssh-apps.html


login to app
[i500695@C02X632CJGH6:2019-05-29 16:51:39:~/work/KB:]1672$ cf a | grep sema
cf enable-sportal-cf-site-semantic-service        started           1/1         1G       1G     portal-service-borisl-i349897.cfapps.sap.hana.ondemand.com/semantic
portal-cf-freestyle-semantic-service   started           1/1         128M     1G     portal-service-borisl-i349897.cfapps.sap.hana.ondemand.com/templates
[i500695@C02X632CJGH6:2019-05-29 16:51:52:~/work/KB:]1673$ cf enable-ssh portal-cf-freestyle-semantic-service
ssh support is already enabled for 'portal-cf-freestyle-semantic-service'
[i500695@C02X632CJGH6:2019-05-29 16:52:08:~/work/KB:]1674$ cf ssh portal-cf-freestyle-semantic-service
vcap@9339967a-e622-453a-461e-05fc:~$ 

load app env
vcap@9339967a-e622-453a-461e-05fc:~$ /tmp/lifecycle/shell
vcap@9339967a-e622-453a-461e-05fc:~$ echo $VCAP_APPLICATION 
{"application_id":"3258a91f-4dc2-4b62-8c37-63eb729caf87","application_name":"portal-cf-freestyle-semantic-service","application_uris":["portal-service-borisl-i349897.cfapps.sap.hana.ondemand.com/templates"],"application_version":"0693d538-b96e-46e2-a28b-f10e04d6ef43","cf_api":"https://api.cf.sap.hana.ondemand.com","host":"0.0.0.0","instance_id":"9339967a-e622-453a-461e-05fc","instance_index":0,"limits":{"disk":1024,"fds":16384,"mem":128},"name":"portal-cf-freestyle-semantic-service","port":8080,"space_id":"93f28d96-f2e7-4ec3-b558-52402b7ba41c","space_name":"borisl","uris":["portal-service-borisl-i349897.cfapps.sap.hana.ondemand.com/templates"],"version":"0693d538-b96e-46e2-a28b-f10e04d6ef43"}


get app endpoint and GUID
[i500695@C02X632CJGH6:2019-05-29 16:55:41:~/work/KB:]1675$ cf app portal-cf-freestyle-semantic-service  --guid
3258a91f-4dc2-4b62-8c37-63eb729caf87
[i500695@C02X632CJGH6:2019-05-29 16:55:44:~/work/KB:]1676$ cf curl /v2/info
{
   "name": "",
   "build": "",
   "support": "",
   "version": 0,
   "description": "Cloud Foundry at SAP Cloud Platform",
   "authorization_endpoint": "https://login.cf.sap.hana.ondemand.com",
   "token_endpoint": "https://uaa.cf.sap.hana.ondemand.com",
   "min_cli_version": null,
   "min_recommended_cli_version": null,
   "app_ssh_endpoint": "ssh.cf.sap.hana.ondemand.com:2222",
   "app_ssh_host_key_fingerprint": "af:82:92:98:0b:80:c4:14:3e:0a:9b:c3:c8:4b:ae:21",
   "app_ssh_oauth_client": "ssh-proxy",
   "doppler_logging_endpoint": "wss://doppler.cf.sap.hana.ondemand.com:443",
   "api_version": "2.135.0",
   "osbapi_version": "2.14",
   "bits_endpoint": "https://bits.cf.sap.hana.ondemand.com",
   "user": "3b4e547a-d74d-48e3-9032-8441d2e5574e"
}

        2.5.2 copy files from CF 

            2.5.2.1 my way
cf ssh <app> -c "cat /home/vcap/path/to/file" > file

            2.5.2.2 scp or sftp


The documentation is here https://github.com/cloudfoundry/diego-ssh#cloud-foundry-via-cloud-controller-and-uaa , but this is a summary:

cf login and cf target
cf curl /v2/info | jq .app_ssh_endpoint this is your SSH host
cf ssh-code then copy the value, this is your password
cf app app-name --guid this is part of your user name
sftp -P 2222 cf:<app-guid>/<app-instance-num>@<ssh-host>, when prompted for a password, enter the passcode you copied in step #3.
Similarly, for scp you can run scp -P 2222
-oUser=cf:<app-guid>/<app-instance-num> my-local-file.json
<ssh-host>:my-remote-file.json.

Full documentation:
Cloud Foundry via Cloud Controller and UAA

For Cloud Foundry, the user is of the form cf:app-guid/instance and the password must be an authorization code that the ssh proxy server can exchange for an authorization token. The SSH proxy must be configured to use an OAuth client id that has been defined in the UAA. The client id used by the proxy must be advertised in the /v2/info endpoint under the app_ssh_oauth_client key. Please see the UAA documentation for details on how to allocate an authorization code.

The proxy will contact the Cloud Controller as the user to determine if the policy allows the user to access application containers via SSH.

Client example:

$ curl -k -v -H "Authorization: $(cf oauth-token | tail -1)" \
    https://uaa.bosh-lite.com/oauth/authorize \
    --data-urlencode  "client_id=$(cf curl /v2/info | jq -r .app_ssh_oauth_client)" \
    --data-urlencode 'response_type=code' 2>&1 | \
    grep Location: | \
    cut -f2 -d'?' | \
    cut -f2 -d'=' | \
    pbcopy # paste authoriztion code when prompted for password
or, with the Cloud Foundry cf command line interface;

$ cf ssh-code | pbcopy # paste authorization code when prompted for password
The authorization code can then be used as the password:

$ ssh -p 2222 cf:$(cf app app-name --guid)/0@ssh.bosh-lite.com
$ scp -P 2222 -oUser=cf:$(cf app app-name --guid)/0 my-local-file.json ssh.bosh-lite.com:my-remote-file.json
$ sftp -P 2222 cf:$(cf app app-name --guid)/0@ssh.bosh-lite.com
The Cloud Foundry cf command line interface (v6.13 and newer) can also be used to access an interactive shell in an application container:

$ cf ssh app-name
$ cf ssh app-name -i 3 # access the container hosting index 3 of the app
This support is enabled with the --enableCFAuth flag.


        2.5.3
    2.6 CF administration

        2.6.1 Configure destinations

a. login to cockpit
e.g. site-manager,https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/SA0225001210/subaccount/c87ade1a-5a38-4801-bc19-a15062b7c501/details 

b. connectivity -> destinations 

        2.6.2 clp instance ID

            2.6.2.1 get clp instance ID
cf service portal-service-default-instance --guid

            2.6.2.2

        2.6.3


    2.7 CF Portal

        2.7.1 portal-cli , tags: Jawad portal cli
https://github.wdf.sap.corp/i324180/portal-cli

            2.7.1.1 readme

# Portals CLI

The Portals CLI is written in Node.js. The CLI exposes multiple development commands like generating tokens, connecting to postgres db or Redis remotely
re-stage apps asynchronously, managing xsuaa clones, getting saas subscriptions, html5 applications list and more..

![Portal CLI Usage 1](assets/portal-cli-usage.gif)
![Portal CLI Usage 2](assets/gut.png)


## Prerequisite

Download and install nodejs: https://nodejs.org/en/download/.

cf-cli must be installed and configured on the system for this CLI to work. Refer to https://docs.cloudfoundry.org/cf-cli/install-go-cli.html for installation on the system of your interest.

Make sure you're logged in to CF and on the correct space
```shell script
$ cf t -o <ORG> -s <SPACE>
```

## Install Portal CLI
```shell script
$ git clone git@github.wdf.sap.corp:i324180/portal-cli.git
$ cd portal-cli
$ npm i
$ npm i -g  (in case you have permissions issues run: sudo npm i -g)
```

if you face permissions issues/EACCES errors installing the CLI globally:
```shell script
sudo chown -R `whoami` ~/.npm
sudo chown -R `whoami` /usr/local/lib/node_modules
```

## CLI

### generate-user-token (alias: gut)
generates grant_type:user_token JSON web token
```shell script
$ portal generate-user-token
$ portal gut
```
#### Option
- ```-a```,```--application```: application name, default: portal-cf-dt-approuter
- ```-u```,```--username```: email/username
- ```-p```, ```--password```: password
- ```-s```, ```subdomain```: cloudfoundry subdomain (consumer subdomain)

### generate-client-token (alias: gct)
generates grant_type:client_credentials JSON web token
```shell script
$ portal generate-client-token
$ portal gct
```
#### Option
- ```-a```,```--application```: application name bound to the xsuaa instance
- ```-c```,```--config```: additional attributes json
- ```-p```, ```--path```: path to the additional attributes json file

### postgres-ssh (alias: ps)
opens ssh tunnel and creates a local server for connecting remotely to postgres
```shell script
$ portal postgres-ssh
$ portal ps
```
#### Option
- ```-a```,```--application```: application name bound to the postgres instance
- ```-p```,```--port```: local port for port forwarding

### redis-ssh (alias: rs)
opens ssh tunnel and creates a local server for connecting remotely to redis
```shell script
$ portal redis-ssh
$ portal rs
```
#### Option
- ```-a```,```--application```: application name bound to the redis instance
- ```-p```,```--port```: local port for port forwarding

### java-ssh (alias: js)
opens ssh tunnel to the container for remotely debugging java application.
```shell script
$ portal java-ssh
$ portal js
```
#### Option
- ```-a```,```--application```: java application name
- ```-p```,```--port```: local port for port forwarding

### node-ssh (alias: ns)
opens ssh tunnel to the container for remotely debugging and live editing a nodejs application.
notice: make sure port - ```9229``` is not taken.
```shell script
$ portal node-ssh
$ portal ns
```
#### Option
- ```-a```,```--application```: nodejs application name

### async-restage (alias: ar)
restage cloudfoundry applications asynchronously, this operation causes downtime.
```shell script
$ portal async-restage
$ portal ar
```
#### Option
- ```-a```,```--applications```: comma-delimited list of app names to restage.

### get-clones (alias: gc)
get UAA clones of a service broker xsuaa master instance.
```shell script
$ portal get-clones
$ portal gc
```
#### Option
- ```-s```,```--service```: xsuaa broker instance name.

### delete-clones (alias: dc)
delete all UAA clones of a service broker xsuaa master instance.
```shell script
$ portal delete-clones
$ portal dc
```
#### Option
- ```-s```,```--service```: xsuaa broker instance name.

### list-subscriptions (alias: ls)
get subscriptions list of product.
```shell script
$ portal list-subscriptions
$ portal ls
```
#### Option
- ```-p```,```--product```: product name e.g `portal`, `launchpad`, `workzone`, `workzonehr`.

### list-html5 (alias: lh)
get html5 applications list of product from consumer subaccount.
```shell script
$ portal list-html5
$ portal lh
```
#### Option
- ```-p```,```--product```: product name e.g `portal`, `launchpad`, `workzone`, `workzonehr`.
- ```-s```, ```subdomain```: cloudfoundry subdomain (consumer subdomain)

### help
show help menu for a commands
```shell script
$ portal help
$ portal <command_name> --help
$ portal <command_name> -h
```

### version
show CLI version
```shell script
$ portal version
$ portal -v
```


## Examples
```shell script
$ portal generate-client-token -a portal-cf-cdm-store-service -c "{'a': 'b'}"
$ portal generate-client-token -a portal-cf-cdm-store-service -c /path/to/additionalAttributes.json
$ portal generate-user-token -u mymail@sap.com -p myPassword -s consumer-subdomain
$ portal async-restage -a app1,app2,app3 # restage certain apps
$ portal async-restage # restage all apps in space.
$ portal get-clones -s portal-xsuaa-broker
$ portal delete-clones -s portal-xsuaa-broker
$ portal list-subscriptions -p launchpad
$ portal list-html5 -p launchpad -s customer-subdomain
```


## How to build and run locally
```sh
$ npm i
$ run index.js with desired arguments.
```


            2.7.1.2 Connect to CMK DB 
a. open tunnel
[i500695@WYLQRXL9LQ:2023-08-21 15:16:30:~/git/portal-cf-cdm-store-service:]2022$ remPGTunnel  6542
opening a remote SSH tunnel to CF cell of portal-cf-technical-support-green
running: portal postgres-ssh -a portal-cf-technical-support-green -p 6542
┌──────────┬────────────────┐
│ server   │ localhost:6542 │
│ username │ 769cae285851   │
│ password │ 703291b5625e   │
│ dbname   │ aMNcSJwcZMbY   │
└──────────┴────────────────┘
b. Connect to DB
[i500695@WYLQRXL9LQ:2023-08-21 13:20:52:~:]2010$  pgcli -h 127.0.0.1 -u 769cae285851 -d aMNcSJwcZMbY -p 6542
Password for 769cae285851: 
Server: PostgreSQL 12.14
Version: 3.5.0
Home: http://pgcli.com
aMNcSJwcZMbY>

            2.7.1.3 my examples
portal generate-user-token -u yosi.izaq@sap.com -p mypass -s backbone-saas

                2.7.1.3.1  getMyToken  alias
$ getMyToken
using portal-cli to generate password token for yosi.izaq@sap.com at backbone-saas
please provide user yosi.izaq@sap.com password: 
got token eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vYmFja2JvbmUtc2Fhcy5hdXRoZW50aWNhdGlvbi5zYXAuaGFuYS5vbmRlbWFuZC5jb20vdG9rZW5fa2V5cyIsImtpZCI6ImtleS1pZC0xIiwidHlwIjoiSldUIn0.eyJqdGkiOiI3NmM3NDA1MjQ1ZmE0ZDY4YTVlMDgxNjdiZGVmODRkYiIsImV4dF9hdHRyIjp7ImVuaGFuY2VyIjoiWFNVQUEiLCJ6ZG4iOiJiYWNrYm9uZS1zYWFzIiwic2VydmljZWluc3RhbmNlaWQiOiJiYmY1NTE3Zi1mMjhjLTQxNjQtOThlZi03ODUzZjViYWY4ZjcifSwie…bQZbRXZiV9tEg535oYIaj6Gh29Xex6JNZ5A
token was copied to clipboard 


Alias
alias getMyToken='~/work/SAP/code/python/CF/pcliGetToken.py --u yosi.izaq@sap.com -a backbone-saas'

Python wrapper:
#!/usr/local/bin/python3

import getpass
import subprocess, shlex
import os
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('-u', '--user', help='provide username, e.g. yosi.izaq@sap.com')
parser.add_argument('-a', '--account', help='provide (consumer) account name, e.g. backbone-saas')
args=parser.parse_args()

USER='yosi.izaq@sap.com'
CONSUMER_ACCOUNT='backbone-saas'
TOKEN_ENV_VAR="USERTOKEN"

if args.user:
    USER=args.user
if args.account:
    CONSUMER_ACCOUNT=args.account

print('using portal-cli to generate password token for {} at {}'.format(USER, CONSUMER_ACCOUNT))
PASSWORD=getpass.getpass('please provide user {} password: '.format(USER))
cmd = 'portal generate-user-token -u {} -p {} -s {}'.format(USER, PASSWORD, CONSUMER_ACCOUNT)

res = subprocess.run(shlex.split(cmd), stdout=subprocess.PIPE)
token = res.stdout.rstrip().decode('utf8')
print('got token {}'.format(token))

subprocess.run('pbcopy', universal_newlines=True, input=token)
print("token was copied to clipboard ")


            2.7.1.4 readme The Portal CLI intends to bring several day-to-day development operations/tools to the command line
 
With the current version of Portal CLI you can:
generate a user_token
generate a client_credentials token - w/o additional attributes.
opens ssh tunnel to instance and creates a local server for connecting to postgres in cloud.
opens ssh tunnel to instance and creates a local server for connecting to redis in cloud.
opens ssh tunnel to app and creates a local server for remotely debugging java app.
opens ssh tunnel to the nodejs app, for remote and live code changes.
Asynchronously re-stage applications
 
Contact me if you would like to see specific features added to the CLI / you’d like to contribute.
 
For installation, you can follow the instructions in the readme:
https://github.wdf.sap.corp/i324180/portal-cli#portals-cli

Prerequisite

cf-cli must be installed and configured on the system for this CLI to work. Refer to https://docs.cloudfoundry.org/cf-cli/install-go-cli.html for installation on the system of your interest.

Install Portal CLI

~/work/SAP/git/
git clone git@github.wdf.sap.corp:i324180/portal-cli.git
cd portal-cli
npm i -g  (in case you have permissions issues run: sudo npm i -g)
Usages

Make sure you're logged in to CF and on the correct space

cf t -o <ORG> -s <SPACE>
portal
portal generate-user-token [-a <approuter>] -u <email> -p <password> -s <cosumer_subdomain>
portal generate-client-token -a <app> [-p <path to json file> -c <json>]
portal postgres-ssh -a <app> -p <port_number>
portal redis-ssh -a <app> -p <port_number>
portal java-app-ssh -a <app> -p <port_number>
portal async-restage [-a <app1,app2,app3>]
Examples

portal generate-client-token -a portal-cf-cdm-store-service -c "{'a': 'b'}"
portal generate-client-token -a portal-cf-cdm-store-service -c /path/to/additionalAttributes.json
portal generate-user-token -u mymail@sap.com -p myPassword -s consumer-subdomain
portal async-restage -a app1,app2,app3 # restage certain apps
portal async-restage # restage all apps in space. 

            2.7.1.5 remote redis connection
$ portal rs -a portal-cf-transport-service -p 8765

            2.7.1.6 start all apps
you can now use the portal cli to start all apps in space in matter of seconds using portal async-start
$ portal async-start

BTW, can also use my alias:
$ cfStartAllApps
            2.7.1.7 releases
https://github.wdf.sap.corp/i324180/portal-cli/releases
    
            2.7.1.8 Thursday 9 November 2023 at 16:03 major update, tags: Thursday 9 November 2023 at 16:03 major update

                2.7.1.8.1 new features

                    2.7.1.8.1.1 Jawad's message
It's been about a year and a half since my last update on the Portal CLI, and I think it's time to share some news.
A bunch of new features were added to the Portal CLI during this time.
 
Link to Portal CLI on GitHub: https://github.wdf.sap.corp/i324180/portal-cli#portal-cli-workzone
 
Here's a list of what's new:
Start all apps in space asynchronously
Tail or show formatted and human-readable recent logs for an app.  (Experimental)
Support for opening ssh tunnel, connects remotely to postgres and run sql query on the db instance instantly through the cli – Supports running query on multiple DCs at once (Thanks to @Messing, Or for the contribution)
Support for Message Queuing Management APIs
Get configuration and statistics of a queue.
Get list of queue subscriptions of a given queue.
Get configurations of all queues.
Get app resources with translations from FDC from subaccount/instance id.
Get WorkZone private docker registry credentials.
 
Enhancements:
Generating user_token with user configured on a custom IDP.
Opening an ssh tunnel to a specific Postgres instance. (for applications that have bindings to multiple PG instances due to CMK enablement)
New look and feel, enhanced `help` and examples for commands usages.
Local disk caching for improving commands runtime performance.
 
 
Lastly, Generative AI using OpenAI GPT-4.5 has been included in the Portal CLI, allowing you to ask the Portal AI Assistant questions about WorkZone, SAP Start, and SAP Mobile Start, SAP help documentation was used as a knowledge base for the model.
(AI Assistant mostly respond within 20-30 sec.)
 
You can login using your email and password. Don’t forget to add the last 6 digits from your authenticator – Refer to Generative AI section.

                    2.7.1.8.1.2 logs
logs
Tail or show formatted and human-readable recent logs for an app.

$ portal logs APP_NAME
$ portal logs APP_NAME --recent
$ portal logs APP_NAME -c <correlation_id> -l <log_level>
Options
--recent : dump recent logs instead of tailing.
--full, -f : obtain full logs.
--level, -l : filter logs by log level.
--corr-id, -c : filter logs by correlation id.

example:
API endpoint:   https://api.cf.eu12.hana.ondemand.com
API version:    3.149.0
user:           yosi.izaq@sap.com
org:            rcsubeu12
space:          rcteu12
[i500695@WYLQRXL9LQ:2023-11-12 10:52:31:~:]2014$ cf a | grep cdm
cdm-export-service-green                           started           web:3/3             portal-service-rcteu12.cfapps.eu12.hana.ondemand.com/cdm_export_service
cdm-import-service-blue                            started           web:3/3             portal-service-rcteu12.cfapps.eu12.hana.ondemand.com/cdm_import_service
portal-cf-cdm-store-service-blue                   started           web:0/3             portal-service-rcteu12.cfapps.eu12.hana.ondemand.com/cdm_store_service
portal-cf-cdm-transformer-blue                     started           web:3/3             portal-service-rcteu12.cfapps.eu12.hana.ondemand.com/cdm_transformer
[i500695@WYLQRXL9LQ:2023-11-12 10:52:48:~:]2015$ cf a | grep cdm
[i500695@WYLQRXL9LQ:2023-11-12 10:53:31:~:]2015$ portal logs portal-cf-cdm-store-service-blue

                    2.7.1.8.1.3 generate user token
$ portal gut -u admin -p adminUser1 -s cmkofficiarcteu12

subdomain is in consumer sub-account overview, ex: https://canary.cockpit.btp.int.sap/cockpit/#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/0dcc9a5d-7d14-4c0c-b35e-c36876e6dba1/subaccountoverview 

                    2.7.1.8.1.4 open redis connection
ex:
[i500695@WYLQRXL9LQ:2023-11-12 11:43:18:~/git/portal-cli:]2021$ portal rs -a portal-cf-transport-service-blue -p 7892
┌──────────┬──────────────────────────────────┐
│ server   │ localhost:7892                   │
│ password │ bcUPnRtMJSDjreLJRIIiHsfzIvSGcgKg │
└──────────┴──────────────────────────────────┘

then connect via cli/ux 
ex:
[i500695@WYLQRXL9LQ:2023-11-12 11:50:49:~/work/code/interviewQs/leetcode/dynamic_programming:]2008$ redis-cli -p 7892 -a bcUPnRtMJSDjreLJRIIiHsfzIvSGcgKg 
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:7892> ping
PONG
127.0.0.1:7892> set yosi izaq

for CLI commands see: 
https://www.tutorialspoint.com/redis/redis_keys.htm

                    2.7.1.8.1.5 remote debug java application 
$ portal js -a portal-cf-cdm-store-service-blue -p 9358

                    2.7.1.8.1.6 restart or restage all applications
portal as - restart 
portal ar - restage

                    2.7.1.8.1.7 Ask GPT re. use cases and docs
 Generative AI using OpenAI GPT-4.5 has been included in the Portal CLI, allowing you to ask the Portal AI Assistant questions about WorkZone, SAP Start, and SAP Mobile Start, SAP help documentation was used as a knowledge base for the model.
[i500695@WYLQRXL9LQ:2023-11-12 12:52:57:~/git/portal-cli:]2025$ portal login -u portaltechuser@sap.com -p Abcd1234
Logged In!
| [i500695@WYLQRXL9LQ:2023-11-12 12:53:28:~/git/portal-cli:]2026$ portal ask "transport content using ctms"
| Sure, I'd be happy to help! To transport content using the SAP Cloud Transport Management service (CTMS), you can follow these steps:
| 
| 1. Select the content items you wish to transport in the Content Manager. If you select a role, the apps assigned to it, along with the groups and catalogs these apps are assigned to, will also be transported automatically. 
| 
| 2. Toggle the Selected button at the top to switch between viewing only the selected items or viewing all the items in the list. 
| 
| 3. Click the Export Selected Content Items using SAP Cloud Transport Management System (CTMS) icon above the list on the right. 
| 
| 4. In the dialog that opens, review the list of selected items and click Transport. 

The selected content items, along with their related content items, are transported from the source system to the target system. 

Please note, before importing content, make sure that the content providers from the source environment are also defined in the target environment and that the ID of each provider is identical in all the environments. Otherwise, the content from these content providers will not be imported.

For more detailed information you can check the following:

[Transport Selected Content](https://help.sap.com/docs/WZ_STD/8c8e1958338140699bd4811b37b82ece/e809cb3866a64692a539f4c74430cd86.html)

                    2.7.1.8.1.8
                2.7.1.8.2

            2.7.1.9 cf user-token

                2.7.1.9.1 Oriel's email
Usage:
 
cf user-token <scenario> <tenant>
 
where:
 
scenario is portal , launchpad, workzone or workzonehr
tenant  is the consumer tenant subdomain
 
The command prints a link that gets the user to a login page, and after logging in it prints two user tokens:
 
An Approuter user token
A Portal Service user token
 
This solution works on both XSUAA and IAS.
 
Note that for this to work, http://localhost:8080/** must be added as a redirect_uri in the relevant XSUAA / IAS instance. This already in place for dev spaces, LTS and RCT.
                2.7.1.9.2


            2.7.1.10
    2.8 CF plugins, extensions
https://plugins.cloudfoundry.org


        2.8.1 cf top
cf install-plugin -r CF-Community "top"

[i500695@C02X632CJGH6:2020-02-24 16:29:37:~/work/SAP/git/portal-cf-transport-service:]2193$ cf install-plugin -r CF-Community "top"
Searching CF-Community for plugin top...
Plugin top 0.9.5 found in: CF-Community
Attention: Plugins are binaries written by potentially untrusted authors.
Install and use plugins at your own risk.
Do you want to install the plugin top? [yN]: y
Starting download of plugin binary from repository CF-Community...
 |19.59 MiB / 19.59 MiB [========================================================================================================================================] 100.00% 21s
Installing plugin top...
OK

Plugin top 0.9.5 successfully installed.
[i500695@C02X632CJGH6:2020-02-24 16:33:15:~/work/SAP/git/portal-cf-transport-service:]2194$ cf top portal-cf-transport-service
 
        2.8.2  list-services
[i500695@C02X632CJGH6:2020-02-24 16:35:02:~/work/SAP/git/portal-cf-transport-service:]2195$ cf install-plugin -r CF-Community "ListServices"
Searching CF-Community for plugin ListServices...
Plugin ListServices 1.0.0 found in: CF-Community
Attention: Plugins are binaries written by potentially untrusted authors.
Install and use plugins at your own risk.
Do you want to install the plugin ListServices? [yN]: y
Starting download of plugin binary from repository CF-Community...
 |10.85 MiB / 10.85 MiB [=========================================================================================================================================] 100.00% 1s
Installing plugin ListServices...
OK

Plugin ListServices 1.0.0 successfully installed.
[i500695@C02X632CJGH6:2020-02-24 16:37:38:~/work/SAP/git/portal-cf-transport-service:]2197$ cf list-services portal-cf-transport-service
Service Name                      Service Instance URL
portal-redis                      https://api.cf.sap.hana.ondemand.com/v2/service_instances/143066c3-719a-4187-9473-03e15377df56
portal-connectivity               https://api.cf.sap.hana.ondemand.com/v2/service_instances/29dc3deb-3139-4c9a-b392-29a621bb6b39
portal-destination                https://api.cf.sap.hana.ondemand.com/v2/service_instances/412fa4e9-f643-49d0-b69a-ee9eb03fdf54
portal-application-logs           https://api.cf.sap.hana.ondemand.com/v2/service_instances/fab44b36-bc70-4913-9626-160d519e4f05
portal-audit-logs                 https://api.cf.sap.hana.ondemand.com/v2/service_instances/ba741005-e659-4dde-9374-42eb292cd59a
portal-dynatrace                  https://api.cf.sap.hana.ondemand.com/v2/service_instances/7129c6e2-0aff-42d5-985f-b5669d63572f
portal-xsuaa-broker               https://api.cf.sap.hana.ondemand.com/v2/service_instances/b57e23e2-c19b-4add-b7d9-7ca3a4b0fbd0
portal-cf-general-configuration   https://api.cf.sap.hana.ondemand.com/v2/service_instances/25442157-773a-4184-aad9-7a820d049e98

        2.8.3 log-stream
https://github.com/cloudfoundry/log-stream-cli

install:
[i500695@C02X632CJGH6:2020-03-01 19:04:02:~/Downloads:]2066$ go get github.com/cloudfoundry/log-stream-cli/cmd/log-stream-cli
[i500695@C02X632CJGH6:2020-03-01 19:05:06:~/Downloads:]2067$ cf install-plugin $GOPATH/bin/log-stream-cli
Attention: Plugins are binaries written by potentially untrusted authors.
Install and use plugins at your own risk.
Do you want to install the plugin /Users/i500695/.go/bin/log-stream-cli? [yN]: y
Installing plugin log-stream...
OK

Plugin log-stream N/A successfully installed.

usage:
$ cf log-stream portal-cf-cdm-store-service portal-cf-transport-service portal-cf-site-semantic-service

        2.8.4 lookup-route 
tool that allows to find org/space by the route and even change the target:
 
Install:
>cf install-plugin -r CF-Community "route-lookup"
 
Usage:
>cf lookup-route -t hasiconsumer-launchpad-securityvalcanaryhasi.cfapps.sap.hana.ondemand.com
Bound to:
securityvalcanary/hasi/launchpad-rt-approuter
Changed target to securityvalcanary/hasi.


id=__Cloud_Foundry_CLI_AutoScaler_Plugin__
        2.8.5 Cloud Foundry CLI AutoScaler Plug-in
https://github.com/cloudfoundry/app-autoscaler-cli-plugin#cf-attach-autoscaling-policy

install: cf install-plugin -r CF-Community app-autoscaler-plugin

Command List

Command	Description
autoscaling-api, asa	Set or view AutoScaler service API endpoint
autoscaling-policy, asp	Retrieve the scaling policy of an application
attach-autoscaling-policy, aasp	Attach a scaling policy to an application
detach-autoscaling-policy, dasp	Detach the scaling policy from an application
create-autoscaling-credential, casc	Create custom metric credential for an application
delete-autoscaling-credential, dasc	Delete the custom metric credential of an application
autoscaling-metrics, asm	Retrieve the metrics of an application
autoscaling-history, ash	Retrieve the scaling history of an application

read, create or unset policy:
cf autoscaling-policy

Retrieve the scaling policy of an application, the policy will be displayed in JSON format.

cf autoscaling-policy APP_NAME [--output PATH_TO_FILE]
ALIAS: asp

OPTIONS:

--output : dump the policy to a file in JSON format
EXAMPLES:

View scaling policy, replace APP_NAME with the name of your application:
$ cf autoscaling-policy APP_NAME

Showing policy for app APP_NAME...
{
	"instance_min_count": 1,
	"instance_max_count": 5,
	"scaling_rules": [
		{
			"metric_type": "memoryused",
			"breach_duration_secs": 120,
			"threshold": 15,
			"operator": ">=",
			"cool_down_secs": 120,
			"adjustment": "+1"
		},
		{
			"metric_type": "memoryused",
			"breach_duration_secs": 120,
			"threshold": 10,
			"operator": "<",
			"cool_down_secs": 120,
			"adjustment": "-1"
		}
	]
}
Dump the scaling policy to a file in JSON format:
$ cf asp APP_NAME --output PATH_TO_FILE

Saving policy for app APP_NAME to PATH_TO_FILE...
OK
cf attach-autoscaling-policy

Attach a scaling policy to an application, the policy file must be a JSON file, refer to policy specification for the policy format.

cf attach-autoscaling-policy APP_NAME PATH_TO_POLICY_FILE
ALIAS: aasp

EXAMPLES:

$ cf attach-autoscaling-policy APP_NAME PATH_TO_POLICY_FILE

Attaching policy for app APP_NAME...
OK
cf detach-autoscaling-policy

Detach the scaling policy from an application, the policy will be deleted when detached.

cf detach-autoscaling-policy APP_NAME
ALIAS: dasp

EXAMPLES:

$ cf detach-autoscaling-policy APP_NAME

Detaching policy for app APP_NAME...
OK


        2.8.6
    2.9 login

        2.9.1 2fa, two factor authentication
tldr, open ticket at https://wiki.wdf.sap.corp/wiki/display/idservice/Support

https://wiki.wdf.sap.corp/wiki/display/CPUAM/2FA+via+CAM

enroll device. https://portal.wdf.sap.corp/wcm/ROLES://portal_content/cp/roles/employee/employee_services/ITServices/Mobile/Infocenters/SAP%20IT%20for%20SAP/Mobile/~/Bring%20Your%20Own%20Device

support: DL CP 2FA Support <DL_5EA18C3DE2E4C5027E8D4F60@global.corp.sap>
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2257546157

Which app should I use for generating the 2FA code?	
For this you can use:
RSA tokens (supported Nov 23, 2020)
the SAP Authenticator app or the Microsoft Authenticator app. These apps need to be installed on a seperate corporate device. In case you don't have a second corporate device, then you can enroll your private mobile https://portal.wdf.sap.corp/go/byod and then use Microsoft Authenticator for generating Two-Factor-Authentication codes.
All other solutions are not allowed!

Does 2FA also work with RSA tokens?	Yes (as of the date Nov 19, 2020). You need to request the CAM Profile "SCP Core RSA Authentication" (auto approved). You need to provide the RSA Token in the following way: password:token. Don't miss the colon!

https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2167014128

When asked for user/password enter
yosi.izaq@sap.com
<pwd> + <6 digit token>
Get token from mobile authenticator app


        2.9.2 chrome 2fa extension

            2.9.2.1 updated for 15/12/22 10:04:33  


            2.9.2.2 original wiki
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Two-factor+auth+from+browser
a. install https://chrome.google.com/webstore/detail/authenticator/bhghoamapcdpbohphigoooaddinpkbai 
b.  remove the old authentication
navigate to the profile management site (https://accounts.sap.com/ui/protected/profilemanagement). click on the trash can icon to delete the current two-factor authentication.
c. choose 'existing Multi-Factor Authentication'. 
d. choose verification method to delete (TOTP) and paste the code from your phone 
e. add new authentication, enter the code you receive in the plugin to confirm the activation. 
f. after proceeding you should see a popup confirming the activation 
g. in authenticator settings → preferences → use autofill

how to use?
when you face a new login - click on the authenticator extension icon 
click on the OTP passcode (first attempt will prompt permissions to use copy/paste)
login!
        2.9.3

    2.10 Troubleshooting Slow Requests in CF
    https://docs.cloudfoundry.org/adminguide/troubleshooting_slow_requests.html

        2.10.1 Overview
App requests typically transit the following components. Only the router (Gorouter) and app are within the scope of CF. Operators can deploy the HAProxy load balancer that comes with CF instead of, or in addition to, an infrastructure load balancer.

See the following diagram:
+------------------------+           +----------------------------+        +------------------------------------------------------------------------------+
|                        |           |                            |        |   CF                                                                         |
|                        |           |                            |        | +----------------------------+        +------------------------------+       |
|    Client              |           |  Load Balancer             |        | |                            |        |                              |       |
|                        +----------->                            +--------> | Router                     |        | Backend                      |       |
|                        |           |                            |        | |                            +-------->                              |       |
|                        <-----------+                            <--------+ |                            <--------+                              |       |
|                        |           |                            |        | |                            |        |                              |       |
|                        |           |                            |        | |                            |        |                              |       |
|                        |           |                            |        | |                            |        +------------------------------+       |
|                        |           |                            |        | +----------------------------+                                               |
+------------------------+           +----------------------------+        |                                                                              |
                                                                           +------------------------------------------------------------------------------+


There are four boxes labeled, from left to right, 'Client', 'Load Balancer', 'Router', and 'Backend'. A black box frames the 'Router' and 'Backend' boxes and is labeled 'CF'. A horizontal black arrow points left to right from the 'Client' box to the 'Load Balancer' box. A horizontal black arrow points left to right from the 'Load Balancer' box to the 'Router' box. A horizontal black arrow points left to right from the 'Router' box to the 'Backend' box. A horizontal black arrow points right to left from the 'Backend' box back to the 'Router' box. A horizontal black arrow points right to left from the 'Router' box back to the 'Load Balancer' box. A horizontal black arrow points right to left from the 'Load Balancer' box back to the 'Client' box.

Any of the components in the diagram above can cause latency. Delays can also come from the network itself.

To troubleshoot slow requests and diagnose what might be causing latency to your app requests:

Experiment 1: Measure Total Round-Trip App Requests
Experiment 2: View Request Time in Access Logs
Experiment 3: Duplicate Latency on Another Endpoint
Experiment 4: Remove the Load Balancer from the Request Path
Experiment 5: Remove Gorouter from the Request Path
Experiment 6: Test the Network between the Router and the App
After you determine the cause of latency, see the following sections for more information:

Use App Logs to Locate Delays in CF
Causes for Gorouter Latency
Operations Recommendations
        
        2.10.1 Experiment 1: Measure Total Round-Trip App Requests
To measure the total round-trip time for your deployed app that is experiencing latency, run:

time curl -v APP-ENDPOINT
Where APP-ENDPOINT is the URL endpoint for the deployed app.

For example:

$ time curl -v http://app1.app_domain.com

GET /hello HTTP/1.1
Host: app1.app_domain.com
User-Agent: curl/7.43.0
Accept: */*

HTTP/1.1 200 OK
Content-Type: application/json;charset=utf-8
Date: Tue, 14 Dec 2019 00:31:32 GMT
Server: nginx
X-Content-Type-Options: nosniff
X-Vcap-Request-Id: c30fad28-4972-46eb-7da6-9d07dc79b109
Content-Length: 602
hello world!

real 2m0.707s
user 0m0.005s
sys  0m0.007s
The real time output shows that the request to http://app1.app_domain.com took approximately two minutes, round-trip. This seems like an unreasonably long time, so it makes sense to find out where the delay is occurring.

To narrow down the cause of latency, see the following table for information about the output that you see after running time curl -v APP-ENDPOINT:

Result	Explanation	Action
The output shows latency.	A component of your app request flow is causing a delay.	Continue with the rest of the experiments to try to narrow down which component is causing latency.
The output does not show latency.	Your app experiences inconsistent delays.	Try to find an endpoint that is consistently experiencing latency. If that is not possible, then continue with the following experiments, running each of them multiple times.
The output shows the error: Could not resolve host: NONEXISTENT.com	DNS failed to resolve.	Troubleshoot your DNS configuration.
The output of curl returns normally, but there is no value for X-Vcap-Request-Id.	The request from the load balancer did not reach CF.	Troubleshoot your load balancer configuration.

        2.10.2 Experiment 2: View Request Time in Access Logs
If you suspect that you are experiencing latency, the most important logs are the access logs. The cf logs command streams log messages from Gorouter as well as from apps. This section describes how to find and understand the access log timestamps.

To view request time in access logs:

(Optional) Run cf apps to determine the name of the app.

Run:

cf logs APP-NAME
Where APP-NAME is the name of the app.

From another command line window, send a request to your app.

After your app returns a response, enter Ctrl-C to stop streaming cf logs.

For example:

$ cf logs app1


2019-12-14T00:33:32.35-0800 [RTR/0] OUT app1.app_domain.com - [14/12/2019:00:31:32.348 +0000] "GET /hello HTTP/1.1" 200 0 60 "-" "HTTPClient/1.0 (2.7.1, ruby 2.3.3 (2019-11-21))" "10.0.4.207:20810" "10.0.48.67:61555" x_forwarded_for:"52.3.107.171" x_forwarded_proto:"http" vcap_request_id:"01144146-1e7a-4c77-77ab-49ae3e286fe9" response_time:120.00641734 app_id:"13ee085e-bdf5-4a48-aaaf-e854a8a975df" app_index:"0" x_b3_traceid:"3595985e7c34536a" x_b3_spanid:"3595985e7c34536a" x_b3_parentspanid:"-"
2019-12-14T00:32:32.35-0800 [APP/PROC/WEB/0]OUT app1 received request at [14/12/2019:00:32:32.348 +0000] with "vcap_request_id": "01144146-1e7a-4c77-77ab-49ae3e286fe9"
^C

In the example above, the first line contains timestamps from Gorouter for both when it received the request and what was its response time processing the request:
14/12/2016:00:31:32.348: Gorouter receives request
response_time:120.00641734: Gorouter round-trip processing time This output shows that it took 120 seconds for Gorouter to process the request, which means that the two-minute delay above takes place within CF. In CF, delays can occur within Gorouter, within the app, or within the network between the two.
To narrow down the cause of latency, see the following table for information about the output that you see after running cf logs APP-NAME:

Result	Explanation	Action
The output shows latency within response_time.	Gorouter, the network, or the app itself is causing latency.	Continue with the rest of the experiments to try to narrow down which component is causing latency.
The output does not show latency within response_time.	A component before Gorouter is causing latency.	Continue with the rest of the experiments to try to narrow down which component is causing latency.
The output does not show a log line.	Every incoming request should generate an access log message. If a request does not generate an access log message, it means Gorouter did not receive the request.	Troubleshoot your Gorouter configuration.

        2.10.3 Experiment 3: Duplicate Latency on Another Endpoint
The next step to debugging latency is finding an endpoint that consistently experiences delays. Use a test app that does not make any internal or external requests or database calls. For example, see dora on GitHub.

If you cannot push any apps to your foundation, find an API endpoint that does not make any external calls to use for the rest of the experiments. For example, use a health or information endpoint.

To duplicate latency on another endpoint:

Push an example app.

Measure a request’s full round-trip time from the client and back as by running:

time curl -v TEST-APP-ENDPOINT
Where TEST-APP-ENDPOINT is the URL endpoint for the test app. While every network is different, this request should take less than 0.2 seconds.

See the following table for information about the output that you see after running time curl -v TEST-APP-ENDPOINT:

Result	Explanation	Action
The output shows latency.	One of the components in the app request path is causing latency.	Continue with the rest of the experiments, using the test app, to try to narrow down which component is causing latency.
The output does not show latency.	Something in your app configuration is causing latency.	Evaluate your app for recent changes. See below for more information.
If this experiment shows that something in your app is causing latency, use the following questions to start troubleshooting your app:

Did you recently push any changes?
Does your app make database calls?
If so, have your database queries changed?
Does your app make requests to other microservices?
If so, is there a problem in a downstream app?
Does your app log where it spends time? For more information, see Use App Logs to Locate Delays in CF below.

        2.10.4 Experiment 4: Remove the Load Balancer from Request Path
The next step is to remove the load balancer from the test path by sending the request directly to Gorouter. You can do this by accessing the network where Gorouter is deployed, sending the traffic directly to the Gorouter IP address, and adding the route in the host header.

To remove the load balancer from the request path:

Choose a router VM from your deployment and get its IP address. Record this value and use it as the ROUTER-IP when you run the command in a later step.

Run:

bosh ssh router/ROUTER-GUID
Where ROUTER-GUID is the unique identifier for the router VM.

To determine the amount of time a request takes when it skips the load balancer, run:

time curl ROUTER-IP -H "Host: TEST-APP-ENDPOINT"
Where:

ROUTER-IP is the router VM IP address that you located in the first step.
TEST-APP-ENDPOINT is the URL endpoint for the test app.
See the following table for information about the output that you see after removing the load balancer from the app request path:

Result	Explanation	Action
The output shows latency.	The load balancer is not causing latency.	Continue with the rest of the experiments, using the test app, to try to narrow down which component is causing latency.
The output does not show latency.	A component before Gorouter is causing latency.	Look at your load balancer logs and logs for any other components that exist between the end client and Gorouter.

        2.10.5 Experiment 5: Remove Gorouter from Request Path
The next step is to remove Gorouter from the request path. You can SSH into the router VM and send a request directly to the app.

To remove Gorouter from the app request path:

To retrieve the IP address and port number of the Diego Cell where your test app instance runs, run:

cf ssh TEST-APP -c "env | grep CF_INSTANCE_ADDR"
Where TEST-APP is the name of the test app. For example:

$ cf ssh my-app -c "env | grep CF_INSTANCE_ADDR"
Choose any router VM from your deployment and SSH into it by running:

bosh ssh router/ROUTER-GUID
Where ROUTER-GUID is the unique identifier for the router VM.

To determine the amount of time a request takes when it skips Gorouter, run time curl CF_INSTANCE_ADDR.

See the following table for information about the output that you see after removing Gorouter from the app request path:

Result	Explanation	Action
The output shows latency.	Gorouter is not causing latency.	Continue with the rest of the experiments, using the test app, to try to narrow down which component is causing latency.
The output does not show latency.	Gorouter is causing latency.	See Causes for Gorouter Latency and Operations Recommendations below.

        2.10.6 Experiment 6: Test the Network between the Router and the App
The next step is to time how long it takes for your request to make it from the router VM to the Diego Cell where your app is deployed. You can do this by using tcpdump on both VMs.

To test the network between the router and the app:

Choose a router VM from your deployment and record its IP address. Use this value as the ROUTER-IP in later steps.
To get the IP address of the Diego Cell where your test app instance is running, run cf ssh TEST-APP -c "env | grep CF_INSTANCE_IP", where TEST-APP is the name of the test app.
To get the port number of the Diego Cell where your test app instance is running, run cf ssh TEST-APP -c "env | grep CF_INSTANCE_PORT", where TEST-APP is the name of the test app.
On the command line, locate the router VM that matches the ROUTER-IP value from the first step.
To SSH into the router VM, run bosh ssh router/ROUTER-GUID, where ROUTER-GUID is the unique identifier for the router VM.
On the router VM, log in as root.
To capture all packets going to your app, run tcpdump 'dst CF_INSTANCE_IP and dst port CF_INSTANCE_PORT'.
In a second command line window, SSH into the Diego Cell that corresponds with CF_INSTANCE_IP. Run bosh ssh digeo-cell/DIEGO-CELL-GUID, where DIEGO-CELL-GUID is the unique identifier for the Diego Cell where your app is running.
On the Diego Cell, log in as root.
To capture all packets going to your app, run tcpdump 'dst port CF_INSTANCE_PORT and src ROUTER-IP', where ROUTER-IP is the router VM IP address that you recorded in the first step.
In a third command line window, run ssh ROUTER-IP, where ROUTER-IP is the router VM IP address.
To make a request to your app, run curl CF_INSTANCE_IP:CF_INSTANCE_PORT.
Compare the first packet captured on the router VM with the first packet captured on the Diego Cell. The packets should match. Use the timestamps to determine how long it took the packet to traverse the network.

Note: If you use a test app, this should be the only traffic to your app. If you are not using a test app and there is traffic to your app, then these tcpdump commands could result in many packet captures. If the tcpdump results are too verbose to track, you can write them to a pcap file and use wireshark to find the important packets. To write tcpdump commands to a file, use the -w flag. For example: tcpdump -w router.pcap.

See the following table for information about the output that you see after testing the network between the router and the app:

Result	Explanation	Action
The output shows latency.	Your network is causing latency.	Troubleshoot your network configuration.
The output does not show latency.	A component in your app request path is causing latency.	Repeat the diagnostic experiments to narrow down which component is causing latency. Follow the steps in Experiment 1: Measure Total Round-Trip App Requests and ensure that you are consistently experiencing latency.

        2.10.7 Use App Logs to Locate Delays in CF
To gain a more detailed picture of where delays exist in your request path, augment the logging that your app generates. For example, call your logging library from the request handler to generate log lines when your app receives a request and finishes processing it:

2019-12-14T00:33:32.35-0800 [RTR/0] OUT app1.app_domain.com - [14/12/2019:00:31:32.348 +0000] "GET /hello HTTP/1.1" 200 0 60 "-" "HTTPClient/1.0 (2.7.1, ruby 2.3.3 (2019-11-21))" "10.0.4.207:20810" "10.0.48.67:61555" x_forwarded_for:"52.3.107.171" x_forwarded_proto:"http" vcap_request_id:"01144146-1e7a-4c77-77ab-49ae3e286fe9" response_time:120.00641734 app_id:"13ee085e-bdf5-4a48-aaaf-e854a8a975df" app_index:"0" x_b3_traceid:"3595985e7c34536a" x_b3_spanid:"3595985e7c34536a" x_b3_parentspanid:"-"
2019-12-14T00:32:32.35-0800 [APP/PROC/WEB/0]OUT app1 received request at [14/12/2019:00:32:32.348 +0000] with "vcap_request_id": "01144146-1e7a-4c77-77ab-49ae3e286fe9"
2019-12-14T00:32:32.50-0800 [APP/PROC/WEB/0]OUT app1 finished processing req at [14/12/2019:00:32:32.500 +0000] with "vcap_request_id": "01144146-1e7a-4c77-77ab-49ae3e286fe9"
By comparing the router access log messages from Experiment 2: View Request Time in Access Logs with the new app logs above, you can construct the following timeline:

14/12/2016:00:31:32.348: Gorouter receives request
2016-12-14T00:32:32.35: App receives request
2016-12-14T00:32:32.50: App finishes processing request
2016-12-14T00:33:32.35: Gorouter finishes processing request
The timeline indicates that Gorouter took close to 60 seconds to send the request to the app and another 60 seconds to receive the response from the app. This suggests either of the following:

A delay with Gorouter. See Causes for Gorouter Latency below.
Network latency between Gorouter and the Diego Cells that host the app.
Causes for Gorouter Latency
Two potential causes for Gorouter latency are:

Routers are under heavy load from incoming client requests.

Apps are taking a long time to process requests. This increases the number of concurrent threads held open by Gorouter, reducing capacity to handle requests for other apps.

        2.10.8 Operations Recommendations
Monitor CPU load for Gorouters. At high CPU (70%+), latency increases. If the Gorouter CPU reaches this threshold, consider adding another Gorouter instance.

Monitor latency of all routers using metrics from the Firehose. Do not monitor the average latency across all routers. Instead, monitor them individually on the same graph.

Consider using Pingdom against an app on your CF deployment to monitor latency and uptime. For more information, see the Pingdom website.

Consider enabling access logs on your load balancer. To enable access logs, see your load balancer documentation. Just as you use Gorouter access log messages above to determine latency from Gorouter, you can compare load balancer logs to identify latency between the load balancer and Gorouter. You can also compare load balancer response times with the client response times to identify latency between client and load balancer.

Deploy a nozzle to the Loggregator Firehose to track metrics for Gorouter. For more information, see Deploying a Nozzle to the Loggregator Firehose. Available metrics include:

CPU utilization
Latency
Requests per second
        2.10.1 


    2.11 remote connections

        2.11.1  remote connection to postgres
note: "Connect to CDM Store postgress DB"
Postgres password Mac

Update: 
Looks like Jawad’s portal CLI works better.
portal postgres-ssh -a portal-cf-cdm-store-service -p 9000

A. Open connection 


[i500695@C02X632CJGH6:2020-05-07 10:13:58:~:]2014$ remCDMStorePGTunnel 
exporting store cf env params 

CDMdbName=SYvvhabd83XE1q_B,CDMdbHost=10.11.241.41,CDMdbUsr=CId1xmg0gGHxHcXk,CDMdbPwd=cEIwk6Tk8F2dsgyZ,CDMdbPort=55657,
spawning local http server listening on 6432
[1] 45473
create a ssh tunnel by running: cf v3-ssh -L 6432:10.11.241.41:55657 portal-cf-cdm-store-service 
command is also copied to clipboard

In separate terminal, paste and run the ssh tunnel. e.x.  cf v3-ssh -L 6432:10.11.241.41:55657 portal-cf-cdm-store-service 

B. Open pgadmin 
Master password: G4rtU()1

Define a new connection. Host: localhost. 
User/pwd. Copy from 1st command output.
Port - same.
￼
￼

Open that connection:

C. Navigate to main table cdm_entities
<connection> -> Databases -> <DB UID> -> Schemas -> cdm -> tables -> cdm_entities
￼

D. Run SQL
￼
Ex, select all cols:
 
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm
	FROM cdm."CDM_ENTITIES";


If you get error:
“
Error opening SSH connection: You are not authorized to perform the requested action.
FAILED
Failed - exec: Error opening SSH connection: You are not authorized to perform the requested action.
“

| 1. Login via CF CLI to the space
| 2. run cf space-ssh-allowed <space, e.g. Portal>
| 3. run cf ssh-enabled portal-cf-technical-support-green (or blue, run cf a to know)
|     * if you get this message: "ssh support is disabled for 'portal-cf-technical-support-green'", then continue to step 4.
| 4. run cf enable-ssh portal-cf-technical-support-green
| 5. cf bg-restage portal-cf-technical-support-green.

Example:
[i500695@C02X632CJGH6:2020-11-01 18:02:21:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2078$ cf space-ssh-allowed  Portal
ssh support is enabled in space 'Portal'.
[i500695@C02X632CJGH6:2020-11-01 18:25:14:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2079$ cf a | grep technical
portal-cf-technical-support-am-green   started           web:1/1     sap-portal-services-portal-portal-cf-technical-support-am.cfapps.eu10.hana.ondemand.com, portal-service.cfapps.eu10.hana.ondemand.com/technical_support
portal-cf-technical-support-ar-green   started           web:2/2     portal-cf-technical-support-ar.cfapps.eu10.hana.ondemand.com
portal-cf-technical-support-green      started           web:1/1     portal-cf-technical-support.cfapps.eu10.hana.ondemand.com
[i500695@C02X632CJGH6:2020-11-01 18:25:51:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2080$ cf ssh-enabled portal-cf-technical-support-green
ssh support is disabled for app 'portal-cf-technical-support-green'.
ssh is disabled for app
[i500695@C02X632CJGH6:2020-11-01 18:26:13:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2081$ cf enable-ssh portal-cf-technical-support-green
Enabling ssh support for app portal-cf-technical-support-green as yosi.izaq@sap.com...
OK

[i500695@C02X632CJGH6:2020-11-01 18:26:27:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2082$ cf bg-restage portal-cf-technical-support-green
Creating an app manifest from current settings 

$ cf restart portal-cf-technical-support-green

[i500695@C02X632CJGH6:2020-11-01 18:31:06:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2085$ cf enable-ssh portal-cf-technical-support-green
Enabling ssh support for app portal-cf-technical-support-green as yosi.izaq@sap.com...
OK

        2.11.2  remote connection to redis

            2.11.2.1  general procedure


id=__open_redis_ssh_tunnel__
a. open local http server
python3 -m http.server 9001
Serving HTTP on :: port 9001 (http://[::]:9001/) ...

b. open secure tunnel
 remRedisTransport 
fetching redis cf env params and opening a secure tunnel
redisHost=clustercfg.rg-ba912642-b2bc-4d87-a156-d948a2fc371a.vwvwdz.euc1.cache.amazonaws.com, redisPort=1286, password=YpSSuykkmSeGFonMEfrrYYDiteFZOijh
creating ssh tunnel from local 9001 to remote clustercfg.rg-ba912642-b2bc-4d87-a156-d948a2fc371a.vwvwdz.euc1.cache.amazonaws.com:1286. Plz make sure to have a local http server on 9001. eg. python3 -m http.server 9001

c. connect w/ client.
    c1. medis
    [i500695@C02X632CJGH6:2020-12-16 12:52:39:~/work/SAP/git/medis:]2008$ npm run start

    c2. redis-cli
 brew install redis
 redis-cli -h localhost -p 9001

            2.11.2.2 adaptions for connecting to hyperscaler-redis 

                2.11.2.2.1 amazon elasticcache
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Connect+to+redis+hyperscaler+instance

my procedure using portal-cli (the tunnel part can be replaced by <url:#r=__open_redis_ssh_tunnel__>
check for empty port. say, 1295
lsof -nP -iTCP:1295
then
a.  portal redis-ssh -a portal-cf-transport-service -p 1295

b. install Redis CLI  (brew install redis, then use redis-cli)
Install stunnel , may be you have : which stunnel
edit /usr/local/etc/stunnel/stunnel.conf
[redis-cli]
client = yes
accept = 127.0.0.1:6380 # this is what you expose to the client
connect = 127.0.0.1:1295 # the internal port you've opened on the ssh tunnel

remove comments and make sure in unix format!


c. kill and execute the stunnel # I've you have root permissions you can run is as a service etc.. 
d. Open a new terminal window and run: redis-cli -p 6380 -a <password taken from the env var of the redis service instance)

                2.11.2.2.2


            2.11.2.3
        2.11.3
    2.12 provider spaces

        2.12.1 update space Jenkins
https://portalcfdevelopers.jaas-gcp.cloud.sap.corp/job/deployOrchestratorJobs/job/

        2.12.2

    2.13 BTP CLI , tags: BTP CLI 

        2.13.1 install
a. login to control center https://int.controlcenter.ondemand.com/index.html 
b. click "Download the SAP BTP command line interface (btp CLI)" 
c. choose mac ( https://tools.hana.ondemand.com/ )
d. download and install 
e. add to path
[i500695@WYLQRXL9LQ:2022-07-25 18:02:02:~/git/portal-cf-cdm-store-service:]2032$ grep btp ~/.aliases -C 2
#sap cf btp cli 
export PATH="$PATH:${HOME}/work/SAP/CF/tools/"
#sap cf btp cli 
f.

        2.13.2 assign entitlements for subaccounts 
pre-condition. set entitlement in global account via control center (see full note "Yosi’s team accounts landscapes sub accounts resources")
btp assign accounts/entitlement --global-account sa0225001210 --to-subaccount 70f673d3-7623-42d9-802a-a00c5c3903b8 --for-service fs-storage --plan custom --amount 1

        2.13.3

    2.14 CF stacks 

        2.14.1 changing stacks 
https://docs.cloudfoundry.org/devguide/deploy-apps/stacks.html
Changing Stacks
Overview
Available Stacks
Restaging Apps on a New Stack
Stacks API
Page last updated: December 17, 2020

This topic explains how to restage apps on a new stack. It also provides a description of stacks and lists the supported stacks on Cloud Foundry.

To restage a Windows app on a new Windows stack, see Changing Windows Stacks.

You can also use the Stack Auditor plugin for the Cloud Foundry Command Line Interface (cf CLI) when changing stacks. See Using the Stack Auditor Plugin.

Overview
A stack is a prebuilt root file system (rootfs) that supports a specific operating system. For example, Linux-based systems need /usr and /bin directories at their root. The stack works in tandem with a buildpack to support apps running in compartments. Under Diego architecture, cell VMs can support multiple stacks.

Note: Docker apps do not use stacks.

Available Stacks
Cloud Foundry includes support for cflinuxfs3. The Linux cflinuxfs3 stack is derived from Ubuntu Bionic 18.04. For more information about supported libraries, see the GitHub stacks page.

You can also build your own custom stack. For more information, see Adding a Custom Stack.

Restaging Apps on a New Stack
For security, stacks receive regular updates to address Common Vulnerabilities and Exposures (CVEs). Apps pick up on these stack changes through new releases of Cloud Foundry. However, if your app links statically to a library provided in the rootfs, you may have to manually restage it to pick up the changes.

It can be difficult to know what libraries an app statically links to, and it depends on the languages you are using. One example is an app that uses a Ruby or Python binary, and links out to part of the C standard library. If the C library requires an update, you may need to recompile the app and restage it.

To restage an app on a new stack, do the following:

Use the cf stacks command to list the stacks available in a deployment.

$ cf stacks
Getting stacks in org MY-ORG / space development as developer@example.com...
OK

name            description
cflinuxfs2      Cloud Foundry Linux-based filesystem - Ubuntu Trusty 14.04 LTS
cflinuxfs3      Cloud Foundry Linux-based filesystem - Ubuntu Bionic 18.04 LTS
To change your stack and restage your app, run the following command:

cf push MY-APP -s STACK-NAME
Where:

MY-APP is the name of the app.
STACK-NAME is the name of the new stack.
For example, to restage your app on the stack cflinuxfs3, run cf push MY-APP -s cflinuxfs3:

    $ cf push MY-APP -s cflinuxfs3
    Using stack cflinuxfs3...
    OK
    Creating app MY-APP in org MY-ORG / space development as developer@example.com...
    OK
    ...
    requested state: started
    instances: 1/1
    usage: 1G x 1 instances
    urls: MY-APP.cfapps.io
    last uploaded: Wed Apr 8 23:40:57 UTC 2015
        state    since                    cpu    memory        disk
    #0  running  2015-04-08 04:41:54 PM   0.0%   57.3M of 1G   128.8M of 1G
    
Stacks API
For API information, see the Stacks section of the Cloud Foundry API Documentation.

        2.14.2

    2.15 Performance

        2.15.1 NodeJS Performance

            2.15.1.1 Pavel wiki on Nodejs performance, tags: Pavel wiki on Nodejs performance
wiki: https://wiki.one.int.sap/wiki/display/CPPortals/Node.js+performance+-+how+to+measure+and+improve 
- Logging KIbana
Tips: Debug logs setting affecting performance.
If you do not see logs - check Statistics - it is very possible some logs are dropped. (Relevant to application logs only)

- Performance Metrics
Collecting performance metrics such as CPU usage, memory consumption, response time, throughput, etc., can provide insights into the application's behavior and health. 
Kibana
Dynatrace


- Built-In Node.js Debugging

Node.js has built-in debugging that can be enabled by setting the `inspect` flag when starting your application. This allows you to connect using a tool like Chrome DevTools and step through your code and inspect variables.

> node --inspect index.js and Chrome’s DevTools are a convenient way to profile our local applications.
> node --prof index.js  and  > node --prof-process isolate-<FILE_NAME>-v8.log
Related links:

How to measure and improve Node.js performance https://raygun.com/blog/improve-node-performance/#profiler
Using Heap Profiler https://nodejs.org/en/learn/diagnostics/memory/using-heap-profiler
Profiling Node.js Applications https://nodejs.org/en/learn/getting-started/profiling
How to Stress Test Your Website With ab (ApacheBench) https://www.inmotionhosting.com/support/edu/wordpress/performance/stress-test-with-apachebench/
The ab command also known as ApacheBench is a command line benchmarking tool for testing the amount of time it takes your server to respond to HTTP requests. You can use this information to determine the estimated number of simultaneous requests your Apache HTTP server can handle before it begins to degrade the overall performance.

How to run the PostgreSql Benchmark tool - PgBench https://wiki.one.int.sap/wiki/display/CPPortals/How+to+run+the+PostgreSql+Benchmark+tool+-+PgBench

- Memory leaks can severely impact the performance and stability of Node.js applications. Tools like Node.js heapdump or memwatch-next can help detect and diagnose memory leaks by taking heap snapshots or tracking memory usage over time.

Related links:

heapdump https://www.npmjs.com/package/heapdump
memwatch-next https://www.npmjs.com/package/memwatch-next

- Event Loop Monitoring

The event loop is a fundamental part of Node.js's non-blocking I/O model. Libraries like `event-loop-lag` can help you monitor the health of your event loop and detect when it's getting backed up.

In Node.js, the event loop is a core concept that enables asynchronous I/O operations to be executed in a non-blocking manner. It's essentially a loop that continually checks for events and executes any associated callback functions.

Here's how the event loop works in Node.js:
Event Queue: Asynchronous operations (such as I/O operations, timers, or network requests) are initiated, and their associated callback functions are queued up in the event queue.
Event Loop: The event loop continuously checks for any pending events in the event queue.
Execution: When an event is detected in the event queue, its associated callback function is dequeued and executed.
Non-Blocking: The event loop allows Node.js to handle multiple concurrent operations without blocking the execution of other code. While waiting for I/O operations to complete, Node.js can continue executing other code or handle additional requests.
Callbacks: Callback functions are a fundamental part of Node.js programming. They allow you to define code that should execute once an asynchronous operation is complete. These callback functions are passed as arguments to asynchronous functions and are invoked by the event loop when the corresponding event occurs.
Overall, the event loop is crucial for Node.js's asynchronous, non-blocking I/O model, enabling efficient handling of multiple operations and scalability for applications that require high concurrency.

Related links:
Grafana - http://10.236.199.61:3000/d/n_D6bCIIz/nodejs?orgId=1&from=1709550289081&to=1709555322375&var-Landscape=eu12-canary&var-Process_Group=portal-cf-site-service-ronenspace1
Introduction to Event Loop Utilization in Node.js - https://nodesource.com/blog/event-loop-utilization-nodejs/
Visualizing memory management in V8 Engine - https://deepu.tech/memory-management-in-v8/

- Continuous Integration and Deployment (CI/CD)
Integrate performance testing into your CI/CD pipeline to catch performance regressions early in the development lifecycle.

-External tools:
PM2 is a Node.js monitoring tool that enables the monitoring of Node.js application performance in production. It allows you to keep your application running forever, reload without downtime, and facilitate common system admin tasks. https://github.com/Unitech/pm2

Related links:
Top 6 tools for Node.js monitoring https://blog.logrocket.com/top-tools-node-js-monitoring/

- Lightrun
Dynamically instrument  logs, traces, and metrics to get real-time insights into the behavior of your live applications at runtime  straight from your IDE . No code changes, redeployments, or restarts are needed.
Putting the Lightrun Platform directly in a developers IDE will allow them to do live production debugging without having to re release their codebase, stop or restart production services. It will shift observability far left in the SDLC. This process will save time and get the developers to focus on high value IT work.
Related links:
Home - Lightrun https://lightrun.com/?device=c&keyword=lightrun&country&campaign=11945199044
Lightrun SAP https://sap.sharepoint.com/teams/CEPPerformanceTeam/Shared%20Documents/Forms/AllItems.aspx?id=%2Fteams%2FCEPPerformanceTeam%2FShared%20Documents%2FSAP%20Lightrun%20Evaluation%20Summary%2Epdf&parent=%2Fteams%2FCEPPerformanceTeam%2FShared%20Documents

            2.15.1.2

        2.15.2

    2.16 dmol displaying memory and logs of Cloud Foundry application instances 
The `cf dmol` command is part of the Cloud Foundry Command Line Interface (CLI) and is used for displaying memory and logs of Cloud Foundry application instances. Here's the basic syntax and commonly used options:

**Basic Syntax:**

```bash
cf dmol [-i <instance_index>] [--lines <num_lines>] [--recent] [<app_name>]
```

**Options:**

* **`-i` or `--instance`:** Specifies the index of the application instance you want to inspect (starts at 0). If omitted, it displays information for all instances.
* **`--lines`:** Specifies the number of log lines to display.
* **`--recent`:** Displays only the most recent logs.
* **`<app_name>`:** (Optional) The name of the application. If not provided, the command will use the currently targeted application.

**Examples:**

* **Show memory and logs for all instances of the `my-app` application:**
   ```bash
   cf dmol my-app
   ```
* **Show memory and the last 100 lines of logs for instance 1 of `my-app`:**
   ```bash
   cf dmol -i 1 --lines 100 my-app
   ```
* **Show the most recent logs for all instances of the currently targeted app:**
   ```bash
   cf dmol --recent
   ```

**Important Note:**

The `cf dmol` command might not be available by default in all Cloud Foundry installations or CLI versions. You may need to install it as a plugin:

```bash
cf install-plugin "multiapps-cli-plugin"
```

After installation, you should have the `cf dmol` command available. For more information on this plugin, refer to the documentation:
[https://github.com/cloudfoundry/multiapps-cli-plugin](https://github.com/cloudfoundry/multiapps-cli-plugin)

GitHub - cloudfoundry/multiapps-cli-plugin: A CLI plugin for Multi-Target Application (MTA) operations in Cloud Foundry
https://github.com/cloudfoundry/multiapps-cli-plugin

    2.17

3. research features

    3.1 Add default catalog and group upon site creation
id=__Add_default_catalog_and_group_upon_site_creation

a. upon each site creation. Also create a default catalog and group. (like the default flp that Dean added)

b. upon each bussiness app add its viz type to group
 upon each bussiness app delete - delete its viz type to group


c. Add the default groupt to {site : {groupOrder : [] }} 
Talk 2 Amir

d. can delete default group and catalog.
Make sure to delete group from groups order 

        3.1.1  code research

-> json templates:
    --> flp page:
note 
        "groupsOrder": []

    --> site
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/resources/templates/default-site/site.default.json
note:
    "groupsOrder": [
      "group.default"
    ],
upon site activation the groupsOrder array is copied from flp to site

The rest are there
catalog.default.json            generic_url_app_with_query.json menu.default.json               role.everyone.json
generic_url_app.json            group.default.json              pageapp.flp.json                site.default.json 

-> usage of json templates 
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/cdm/template-builder.js

/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/services/store/store-request-builder.js
buildSiteCreationBatch()

-> For creating  a site with default group and catalog add two more batch create requests after 
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/services/store/store-client.js:createSite()

add two methods 
buildDefaultGroupCreationBatch()
buildDefaultCatalogCreationBatch()

    buildDefaultGroupCreationBatch(siteId, title) {
        let group = TemplateBuilder.getGroup();
        group.identification.title = title;
        group.identification.id = UUID.v1();

        let catalog = TemplateBuilder.getCatalog();
        catalog.identification.title = title;
        catalog.identification.id = UUID.v1();

        let batchRequests = [
            {
                metadata: {
                    operation: 'CREATE'
                },
                cdm: group
            },
            { metadata: {
                    operation: 'CREATE'
                },
                cdm: catalog
            }
        ];

        return this.buildBatch(siteId, batchRequests);
    }

-> don't forget to set groupsOrder in site.default.json

->  Need to perform this only if in 'canary' mode.
Where to obtain whether 'canary'?
Best to have an env var.
As temporary measure can use VCAP_SERVICES meetering {}
  "metering-service": [
   {
    "binding_name": null,
    "credentials": {
     "clientid": "sb-a302de61-320b-4b28-bfca-c15dd0888409!b4219|metering!b4066",
     "clientsecret": "tLm0GL0cObSPZErG8XzwWOdtFZo=",
     "metering_url": "https://maas-metering.cfapps.sap.hana.ondemand.com/dev",
     "region": "cf-eu10-canary",
     "token_url": "https://site-manager.authentication.sap.hana.ondemand.com"
    },

code:
    /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/services/metering/metering-client.js
const serviceCredentials = VCAP.get('portal-metering-service');
    ...
        this.meteringUrl = serviceCredentials.metering_url + '/usage/v2/usage/documents';
        this.region = serviceCredentials.region;

Long term solution could be:
a. in manifest-dev.yml set LANDSCAPE to canary. This will serve all dev spaces
b. in manifest.yml set LANDSCAPE to production. Add pre-install groovy script that sets LANDSCAPE to canary for lkg.

-> for each new bussiness-app add its viz-type to default group

        3.1.2

    3.2

4. REST examples, API, Postman, curl 

    4.1 semantic


        4.1.1  Batch requests

            4.1.1.1  CREATE Batch requests


                4.1.1.1.1  Create bussiness-app request


Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
Request Method: POST
Status Code: 200 OK
Remote Address: 35.158.183.129:443
Referrer Policy: no-referrer-when-downgrade
Content-Encoding: gzip
Content-Length: 1054
Content-Type: application/json; charset=utf-8
Date: Thu, 21 Feb 2019 15:18:51 GMT
Etag: W/"9e6-1PXnXO7GMYCN9wp2Cz+nRXKWc+o"
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload;
Vary: Accept-Encoding
X-Content-Type-Options: nosniff
X-Dns-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Request-Id: be9e3eb4-a7a2-4196-60d0-58eab0bc72fb
X-Vcap-Request-Id: 078cbc11-76f6-462d-71e4-9da0d3e03ac2
X-Xss-Protection: 1; mode=block
Accept: application/json, text/javascript, */*; q=0.01
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6
Cache-Control: no-cache
Connection: keep-alive
Content-Length: 1384
Content-Type: application/json; charset=UTF-8
Cookie: JSESSIONID=s%3AMDkxDkUtLPEXRgvcChdMhsleRr4N2pRY.GANpZb6YeKgusPmDqpGJ0DckvpQOtyuRA7NirYx1T7I; __VCAP_ID__=82f2764d-d004-44cd-68b6-a264
Host: fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
Origin: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
Pragma: no-cache
Referer: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/sites?siteId=5baf59be-f67a-4767-8c44-a0c8682113b6&flp=true
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36
X-CSRF-Token: b10687a072b11f92-SN5s2unQh3bJLoztYA-54xDB_LE
X-Requested-With: XMLHttpRequest
X-XHR-Logon: accept="iframe"
contextId: 5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"CREATE"},"cdm":{"_version":"3.0","identification":{"id":"f5d20403-3eb1-460f-ae4e-7217df08112c","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}","entityType":"businessapp"},"payload":{"targetAppConfig":{"_version":"1.13.0","sap.app":{"crossNavigation":{"inbounds":{"GenericURL-f5d204033eb1460f":{}}},"tags":{"keywords":[]}},"sap.integration":{"urlTemplateId":"templateGenericURL","urlTemplateParams":{"url":"https://testapp.com","query":{}},"navMode":"inplace"}},"visualizations":{"RandomURL-Launcher":{"target":{"inboundId":"GenericURL-f5d204033eb1460f"},"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"subtitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle}}","info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"GenericURL-f5d204033eb1460f","parameters":{}}}}}},"defaultViz":"RandomURL-Launcher"},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"app1"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"type":"XTIT","value":{"":""}}}}}]}

In [153]: import json 
In [156]: pprint(json.dumps(batchreq))                                                                                                               
('{"BATCH": [{"metadata": {"operation": "CREATE"}, "cdm": {"_version": "3.0", '
 '"identification": {"id": "f5d20403-3eb1-460f-ae4e-7217df08112c", "title": '
 '"{{cdm|identification|title}}", "description": '
 '"{{cdm|identification|description}}", "entityType": "businessapp"}, '
 '"payload": {"targetAppConfig": {"_version": "1.13.0", "sap.app": '
 '{"crossNavigation": {"inbounds": {"GenericURL-f5d204033eb1460f": {}}}, '
 '"tags": {"keywords": []}}, "sap.integration": {"urlTemplateId": '
 '"templateGenericURL", "urlTemplateParams": {"url": "https://testapp.com", '
 '"query": {}}, "navMode": "inplace"}}, "visualizations": '
 '{"RandomURL-Launcher": {"target": {"inboundId": '
 '"GenericURL-f5d204033eb1460f"}, "vizType": "sap.ushell.StaticAppLauncher", '
 '"vizConfig": {"sap.ui": {"icons": {"icon": ""}}, "sap.app": {"subtitle": '
 '"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle}}", '
 '"info": '
 '"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"}, '
 '"sap.flp": {"target": {"type": "IBN", "inboundId": '
 '"GenericURL-f5d204033eb1460f", "parameters": {}}}}}}, "defaultViz": '
 '"RandomURL-Launcher"}, "texts": {"cdm|identification|title": {"type": '
 '"XTIT", "value": {"": "app1"}}, "cdm|identification|description": {"type": '
 '"XTIT", "value": {"": ""}}, '
 '"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle": '
 '{"type": "XTIT", "value": {"": ""}}, '
 '"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info": '
 '{"type": "XTIT", "value": {"": ""}}}}}]}')

body json:
{"BATCH":[{"metadata":{"operation":"CREATE"},"cdm":{"_version":"3.0","identification":{"id":"f5d20403-3eb1-460f-ae4e-7217df08112c","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}","entityType":"businessapp"},"payload":{"targetAppConfig":{"_version":"1.13.0","sap.app":{"crossNavigation":{"inbounds":{"GenericURL-f5d204033eb1460f":{}}},"tags":{"keywords":[]}},"sap.integration":{"urlTemplateId":"templateGenericURL","urlTemplateParams":{"url":"https://testapp.com","query":{}},"navMode":"inplace"}},"visualizations":{"RandomURL-Launcher":{"target":{"inboundId":"GenericURL-f5d204033eb1460f"},"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"subtitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle}}","info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"GenericURL-f5d204033eb1460f","parameters":{}}}}}},"defaultViz":"RandomURL-Launcher"},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"app1"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"type":"XTIT","value":{"":""}}}}}]}

- curl
curl -X POST \
  http://localhost:3003/semantic/entity/site \
  -H 'Content-Type: application/json' \
  -H 'Postman-Token: 53701c97-43e8-4c3c-b242-f41f6507f432' \
  -H 'cache-control: no-cache' \
  -d '{
  "name": "yosi",
  "id": "123"
}'

- python
import requests

url = "http://localhost:3003/semantic/entity/site"

payload = "{\n  \"name\": \"yosi\",\n  \"id\": \"123\"\n}"
headers = {
    'Content-Type': "application/json",
    'cache-control': "no-cache",
    'Postman-Token': "7005c13d-dc7d-4191-8822-369797713cfd"
    }

response = requests.request("POST", url, data=payload, headers=headers)

print(response.text)

[i500695@C02X632CJGH6:2019-06-25 11:20:09:~/work/code/python/sap/requests:]2012$ py3 !$
py3 createSiteLocal.py
{"status":500,"originOfError":"CDMStoreError","message":""}

                4.1.1.1.2 create a catalog
Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
Request Method: POST
Status Code: 200 OK
Remote Address: 54.93.226.111:443
Referrer Policy: no-referrer-when-downgrade
HTTP/1.1 200 OK
Content-Encoding: gzip
Content-Length: 1117
Content-Type: application/json; charset=utf-8
Date: Thu, 21 Feb 2019 15:22:21 GMT
Etag: W/"ae4-IAaRNFQNHk6MBLpIyOAzcNJCW2g"
Vary: Accept-Encoding
X-Content-Type-Options: nosniff
X-Dns-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Request-Id: 4b82ba1c-ed06-42bf-785b-e243cdbf8d71
X-Vcap-Request-Id: e1e4f503-d71d-4eea-7335-67fc544a0436
X-Xss-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload;
POST /semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6 HTTP/1.1
Host: fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
Connection: keep-alive
Content-Length: 407
Pragma: no-cache
Cache-Control: no-cache
X-XHR-Logon: accept="iframe"
Origin: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
X-CSRF-Token: b10687a072b11f92-SN5s2unQh3bJLoztYA-54xDB_LE
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36
Content-Type: application/json; charset=UTF-8
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Referer: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/sites?siteId=5baf59be-f67a-4767-8c44-a0c8682113b6&flp=true
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6
Cookie: JSESSIONID=s%3AMDkxDkUtLPEXRgvcChdMhsleRr4N2pRY.GANpZb6YeKgusPmDqpGJ0DckvpQOtyuRA7NirYx1T7I; __VCAP_ID__=82f2764d-d004-44cd-68b6-a264
contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"CREATE"},"cdm":{"_version":"3.0","identification":{"id":"2a8853c5-c433-4554-aa62-e12eaeadef3c","entityType":"catalog","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"viz":[]},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"cat1"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}}}}}]}

                4.1.1.1.3 create a group
Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
Request Method: POST
Status Code: 200 OK
Remote Address: 52.28.215.193:443
Referrer Policy: no-referrer-when-downgrade
HTTP/1.1 200 OK
Content-Encoding: gzip
Content-Length: 1172
Content-Type: application/json; charset=utf-8
Date: Thu, 21 Feb 2019 15:23:40 GMT
Etag: W/"bed-rAMRLEMllN7s5047rAT84BTHlaw"
Vary: Accept-Encoding
X-Content-Type-Options: nosniff
X-Dns-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Request-Id: f0d38426-49c2-4586-7462-3ea547000b8a
X-Vcap-Request-Id: 5b8054ca-9d5c-4829-4ef1-d6f15a99e946
X-Xss-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload;
POST /semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6 HTTP/1.1
Host: fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
Connection: keep-alive
Content-Length: 406
Pragma: no-cache
Cache-Control: no-cache
X-XHR-Logon: accept="iframe"
Origin: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com
X-CSRF-Token: b10687a072b11f92-SN5s2unQh3bJLoztYA-54xDB_LE
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36
Content-Type: application/json; charset=UTF-8
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Referer: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/sites?siteId=5baf59be-f67a-4767-8c44-a0c8682113b6&flp=true
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,es-419;q=0.8,es;q=0.7,he;q=0.6
Cookie: JSESSIONID=s%3AMDkxDkUtLPEXRgvcChdMhsleRr4N2pRY.GANpZb6YeKgusPmDqpGJ0DckvpQOtyuRA7NirYx1T7I; __VCAP_ID__=82f2764d-d004-44cd-68b6-a264
contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"CREATE"},"cdm":{"_version":"3.0","identification":{"id":"32cf7e13-4e58-40ff-b48f-c3f65e71aa21","entityType":"group","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"tiles":[]},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"grp"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}}}}}]}
version when GET of current group is not performed, the group is cached:

            4.1.1.2 DELETE

                4.1.1.2.1 delete a group


Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"DELETE","id":"32cf7e13-4e58-40ff-b48f-c3f65e71aa21","entityType":"group"}}]}

                4.1.1.2.2
            4.1.1.3 UPDATE

                4.1.1.3.1 update app title
Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"_version":"3.0","identification":{"id":"f5d20403-3eb1-460f-ae4e-7217df08112c","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}","entityType":"businessapp"},"payload":{"targetAppConfig":{"_version":"1.13.0","sap.app":{"crossNavigation":{"inbounds":{"GenericURL-f5d204033eb1460f":{}}},"tags":{"keywords":[]}},"sap.integration":{"urlTemplateId":"templateGenericURL","urlTemplateParams":{"url":"https://testapp.com","query":{}},"navMode":"inplace"}},"visualizations":{"RandomURL-Launcher":{"target":{"inboundId":"GenericURL-f5d204033eb1460f"},"vizType":"sap.ushell.StaticAppLauncher","vizConfig":{"sap.ui":{"icons":{"icon":""}},"sap.app":{"subtitle":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle}}","info":"{{cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info}}"},"sap.flp":{"target":{"type":"IBN","inboundId":"GenericURL-f5d204033eb1460f","parameters":{}}}}}},"defaultViz":"RandomURL-Launcher"},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"app2"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|subtitle":{"type":"XTIT","value":{"":""}},"cdm|payload|visualizations|RandomURL-Launcher|vizConfig|sap.app|info":{"type":"XTIT","value":{"":""}}}}}]}


                4.1.1.3.2 update catlog title
Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"_version":"3.0","identification":{"id":"2a8853c5-c433-4554-aa62-e12eaeadef3c","entityType":"catalog","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"viz":[]},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"cat2"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}}}}}]}


                4.1.1.3.3 update groupt title
Request URL: https://fcc-dt-cpp-boris-provider-i349897.cfapps.sap.hana.ondemand.com/semantic/batch?contextId=5baf59be-f67a-4767-8c44-a0c8682113b6
{"BATCH":[{"metadata":{"operation":"UPDATE"},"cdm":{"_version":"3.0","identification":{"id":"32cf7e13-4e58-40ff-b48f-c3f65e71aa21","entityType":"group","title":"{{cdm|identification|title}}","description":"{{cdm|identification|description}}"},"payload":{"tiles":[]},"texts":{"cdm|identification|title":{"type":"XTIT","value":{"":"grp1"}},"cdm|identification|description":{"type":"XTIT","value":{"":""}}}}}]}


                4.1.1.3.4
            4.1.1.4 READ

        4.1.2 semantic Swagger API
load semantic. Locally: ~/work/SAP/CF_LocAL/portal-cf-site-semantic-service:]781$ export NODE_ENV=development && export PORT=3003 && node ./bin/web
http://localhost:3003/semantic/api-docs/
$ curl -X GET   http://localhost:3003/semantic/api-docs/

        4.1.3 get site
- curl
curl -X POST \
  http://localhost:3003/semantic/entity/site \
  -H 'Content-Type: application/json' \
  -H 'Postman-Token: 53701c97-43e8-4c3c-b242-f41f6507f432' \
  -H 'cache-control: no-cache' \
  -d '{
  "name": "yosi",
  "id": "123"
}'

- python
import requests

url = "http://localhost:3003/semantic/entity/site"

payload = "{\n  \"name\": \"yosi\",\n  \"id\": \"123\"\n}"
headers = {
    'Content-Type': "application/json",
    'cache-control': "no-cache",
    'Postman-Token': "7005c13d-dc7d-4191-8822-369797713cfd"
    }

response = requests.request("POST", url, data=payload, headers=headers)

print(response.text)

[i500695@C02X632CJGH6:2019-06-25 11:20:09:~/work/code/python/sap/requests:]2012$ py3 !$
py3 createSiteLocal.py
{"status":500,"originOfError":"CDMStoreError","message":""}


        4.1.4
    4.2 cdm-store-service

        4.2.0 Access tokens 

            4.2.0.1 > postman collection: cdm store

                4.2.0.1.1 generate client token, tags: generate client technical token 
-> generate token. use portal cli (Jawad)

 portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "e013e90d-245b-4500-acca-cf34f14ea287","instanceId": "b22dcea4-6c61-4dab-875f-a8fa2d952f3c","userName":"techUser","isProvider":"false"}'
take them from 
cf env portal-cf-cdm-store-service
for PaaS portal/launchpad token:
cf env portal-cf-cdm-store-service | grep launchpadInstanceId && cf env portal-cf-cdm-store-service | grep tenantid
[i500695@C02X632CJGH6:2020-11-03 13:39:08:~/work/SAP/git/portal-cf-cdm-store-service:]2015$ cf env portal-cf-cdm-store-service | grep launchpadInstanceId
    "launchpadInstanceId": "b22dcea4-6c61-4dab-875f-a8fa2d952f3c",
[i500695@C02X632CJGH6:2020-11-03 13:39:42:~/work/SAP/git/portal-cf-cdm-store-service:]2016$ cf env portal-cf-cdm-store-service | grep tenantid
    "tenantid": "65e227fa-3e4d-42e2-84f7-d8e7fb13166e",

-> For SaaS token. take tenant ID from SaaS cockpit. 
My consumer account on i500695p global account: https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/details
(tenant) ID 472abdee-c7a4-4357-80ed-3a490cc94622
instance id: $ cf env portal-cf-cdm-store-service | grep launchpadInstanceId
    "launchpadInstanceId": "29a214f1-6a89-4d38-9e0e-d762571391cc",
saas technical token:
 portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "472abdee-c7a4-4357-80ed-3a490cc94622","instanceId": "29a214f1-6a89-4d38-9e0e-d762571391cc","userName":"techUser","isProvider":"false"}'


-> e.g. https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/e013e90d-245b-4500-acca-cf34f14ea287/details
"
Subaccount Details
Subdomain: i310019launchpad
ID: e013e90d-245b-4500-acca-cf34f14ea287
"
ID is the tenant ID


        4.2.1  is alive
http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/portal_api/is_alive

curl --location --request GET 'http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/portal_api/is_alive'

        4.2.2 get entity by type and id
http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entity/businessapp/id/5d7b2d45-5319-4f08-a53c-8eafc1e15feb?context=SITE&contextType=site

curl:
curl --location --request POST 'http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entity/businessapp/id/5d7b2d45-5319-4f08-a53c-8eafc1e15feb?context=SITE&contextType=site' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer https://sapjira.wdf.sap.corp/browse/EUXTEAMSAAR-2130' \
--data-raw '{
	"direction": "DOWN",
	"level": "0",
	"search": {}
}'


        4.2.3 get entities with relations
        http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/context/id/SUB_ACCOUNT/type/sub_account?isFullCdm=true&withRelationTypes=ref

curl:
curl --location --request POST 'http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/context/id/SUB_ACCOUNT/type/sub_account?isFullCdm=true&withRelationTypes=ref' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw '{
	"direction": "DOWN",
	"level": "10",
	"search": {
  }
}'
        4.2.4 get all entities of type
http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/role
curl:
curl --location --request GET 'http://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/role' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw ''

id=__search_cherry-pick_local_providers
        4.2.5 search cherry-pick local providers
        https://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/search
curl:
curl --location --request POST 'https://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/search' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <SaaS teantID based token>' \
--data-raw '{
  "metadata":{
    "context": {
      "id": "SUB_ACCOUNT",
      "contextType": "sub_account"
    },
    "page": {
      "number": 1,
      "size": 100
    }
  },
"match": [{"/cdm/identification/entityType": "provider"} ]

}'

id=__Search_all_provider_entities_cherry-pick_from_SaaS_and_base_from_Apollo_provider_PaaS

        4.2.6 Search all provider entities, cherry-pick from SaaS and base from Apollo provider PaaS
https://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/search?contextId=SUB_ACCOUNT&contextType=sub_account&withRelationTypes=extends
curl:
curl --location --request POST 'https://portal-service-launchpadi310019p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/search?contextId=SUB_ACCOUNT&contextType=sub_account&withRelationTypes=extends' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <SaaS tenant ID token>' \
--data-raw '{
  "metadata":{
    
  },
"match": [{"/cdm/identification/entityType": "provider"} ]

}'
        4.2.7 get all roles
http://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/role

postman: CDM-store -> get all roles

pyton:
import requests

url = "http://portal-service-launchpadi500695p.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities/type/role"

payload={}
headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOi8vbGF1bmNocGFkLmF1dGhlbnRpY2F0aW9uLnNhcC5oYW5hLm9uZGVtYW5kLmNvbS90b2tlbl9rZXlzIiwia2lkIjoiZGVmYXVsdC1qd3Qta2V5LS0xNDI1ODUzMjE4IiwidHlwIjoiSldUIn0.eyJqdGkiOiJhZjRjNGViYjU3Y2M0ODZhODA1MjhhM2YwYjRiYzYwYyIsImF6X2F0dHIiOnsidGVuYW50SWQiOiI0NzJhYmRlZS1jN2E0LTQzNTctODBlZC0zYTQ5MGNjOTQ2MjIiLCJpbnN0YW5jZUlkIjoiMjlhMjE0ZjEtNmE4OS00ZDM4LTllMGUtZDc2MjU3MTM5MWNjIiwidXNlck5hbWUiOiJ0ZWNoVXNlciIsImlzUHJvdmlkZXIiOiJmYWxzZSJ9LCJleHRfYXR0ciI6eyJlbmhhbmNlciI6IlhTVUFBIiwic3ViYWNjb3VudGlkIjoiNjVlMjI3ZmEtM2U0ZC00MmUyLTg0ZjctZDhlN2ZiMTMxNjZlIiwiemRuIjoibGF1bmNocGFkIn0sInN1YiI6InNiLXBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGk1MDA2OTVwIWIxNDQwMCIsImF1dGhvcml0aWVzIjpbInVhYS5yZXNvdXJjZSIsInBvcnRhbC1jZi1zZXJ2aWNlLWxhdW5jaHBhZGk1MDA2OTVwIWIxNDQwMC5DYWxsYmFjayJdLCJzY29wZSI6WyJ1YWEucmVzb3VyY2UiLCJwb3J0YWwtY2Ytc2VydmljZS1sYXVuY2hwYWRpNTAwNjk1cCFiMTQ0MDAuQ2FsbGJhY2siXSwiY2xpZW50X2lkIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiY2lkIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiYXpwIjoic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwiZ3JhbnRfdHlwZSI6ImNsaWVudF9jcmVkZW50aWFscyIsInJldl9zaWciOiI2NjBkMmJlMCIsImlhdCI6MTYxOTM1NDAxMCwiZXhwIjoxNjE5Mzk3MjEwLCJpc3MiOiJodHRwczovL2xhdW5jaHBhZC5hdXRoZW50aWNhdGlvbi5zYXAuaGFuYS5vbmRlbWFuZC5jb20vb2F1dGgvdG9rZW4iLCJ6aWQiOiI2NWUyMjdmYS0zZTRkLTQyZTItODRmNy1kOGU3ZmIxMzE2NmUiLCJhdWQiOlsidWFhIiwicG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIiwic2ItcG9ydGFsLWNmLXNlcnZpY2UtbGF1bmNocGFkaTUwMDY5NXAhYjE0NDAwIl19.0eCgZD7M900pZQJApbmA2qe7Stflqad2VowIrxjUO0PKZiAsMfBgN9SMv6mcicBlJvJCg2Ma-nuzG5JMRS7U2cxnDySiFw902aNj7imhLZ7Geu8U8Cg3cLe5EPlCGtzkMnROxJM2XZLMDf_PGqvW-BbMhKDC_Cz6Nd24KTqeYMkgu5_Ukd516niOVNsdHMWrIec_GVRpCXgnEFs9-xAt8m1FrBx_tyRwSTuwlUUWuucs1j30_CzvCfoqBKeKEyIdTrdPX_IW914UTdGptKfzP3wHNIg6Br5nRwhh4YKJpsOD5MNWpE8F6nL7ZLncBmCav36d2442xy34-zQawh_wCA'
}

response = requests.request("GET", url, headers=headers, data=payload)

print(response.text)

        4.2.8
    4.3

40. tags: Microservices and libraries, tags: Microservices , libraries, git repositoires

    40.1  portal-cf-site-semantic-service

        40.1.1   lifecycle
a. start
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/package.json
        "start": "node ./bin/web", ->
        /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/bin/web
            let app = require('../src/app'); ->
                /Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/app.js 
                    const express = require('express');
                     require('./express/passport')(app);
                     require('./express/setup')(app);
                     require('./routes')(app);
                     require('./express/errors')(app);
                    ...
                    module.exports = app;
            app.listen(port, () => logger.logMessage("info", "portal-cf-site-semantic is listening on port %d", port));


b. routes
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/routes/sites.js
/Users/i500695/work/SAP/CF_LocAL/portal-cf-site-semantic-service/src/routes/entities.js


        40.1.2 CI Builds


        40.1.3 Master builds

            40.1.3.1 Frequent issues

                40.1.3.1.1 Deployment failures

                    40.1.3.1.1.1  App is not starting

                        40.1.3.1.1.1.1  Src depends on test root cause
logs show error:
dist/main.js not founds

reason src has dependencies on test. test files are not built in deployment
simple test. run build and check dist has test files.
e.g.
ls dist/test/unit/utils/cf-nodejs-logger.mock.js
dist/test/unit/utils/cf-nodejs-logger.mock.js

This will fail the deployment

To fix move the test dependencies to src

                        40.1.3.1.1.1.2

                    40.1.3.1.1.2


                40.1.3.1.2


            40.1.3.2

        40.1.4
    40.2 portal-metering-service

    40.3 portal-cf-dt-approuter

        40.3.1 general
git: https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-approuter/tree/master

deploy to space:
a. build  
[i500695@C02X632CJGH6:2019-03-21 11:17:30:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]556$ npm run processBuild

b. manifest, 
$ cfSetYosi01
$ updateManifestDTAppRouter_Yosi
$ cf push -f manifest-dev.yml 

c.


        40.3.2 Test locally

            40.3.2.1 web server


a. run web server. e.g.
	python 2:
[i500695@C02X632CJGH6:2019-03-21 15:22:11:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]569$ python -m SimpleHTTPServer 3001
	python 3:
[i500695@C02X632CJGH6:2019-03-21 15:22:11:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]569$ python -m http.server 3001

or, $ localServer

            40.3.2.2 manual local tests with mock 
b. navigate to url:
http://localhost:3001/<path to index html>?mode=mock#
http://localhost:3001/static-resources/contentManager/webapp/index.local.html?mode=mock
http://localhost:3001/static-resources/contentManager/webapp/index.local.html?mode=mock#/entityEditor/businessapp/my_dummy_app/display

or for 8080 port, http://localhost:8080/static-resources/contentManager/webapp/index.local.html?mode=mock#
            40.3.2.3 qunit

<URL:#r=__cd_approuter_qunit_tests__>

            40.3.2.4 UIVeri5

                40.3.2.4.1 How to run localy


make sure local http server is running in dt-approuter root
$ npm run uiveri5-mock-test-all

                40.3.2.4.2 improve speed, run in paralel
[i500695@C02X632CJGH6:2019-06-23 10:55:35:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2152$ system_profiler SPHardwareDataType
Hardware:

    Hardware Overview:

      Model Name: MacBook Pro
      Model Identifier: MacBookPro15,1
      Processor Name: Intel Core i9
      Processor Speed: 2.9 GHz
      Number of Processors: 1
      Total Number of Cores: 6
      L2 Cache (per Core): 256 KB
      L3 Cache: 12 MB
      Hyper-Threading Technology: Enabled
      Memory: 16 GB
      Boot ROM Version: 220.260.171.0.0 (iBridge: 16.16.5200.0.0,0)
      Serial Number (system): C02X632CJGH6
      Hardware UUID: 548590A7-97A8-5F70-88BB-9793E31EEF45

[i500695@C02X632CJGH6:2019-06-23 10:56:46:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2153$ uname -a
Darwin C02X632CJGH6 18.6.0 Darwin Kernel Version 18.6.0: Thu Apr 25 23:16:27 PDT 2019; root:xnu-4903.261.4~2/RELEASE_X86_64 x86_64
[i500695@C02X632CJGH6:2019-06-23 10:56:55:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2154$ time npm run uiveri5-mock-test-all

$ time npm run uiveri5-mock-test-all
...
real	35m10.456s
user	0m33.270s
sys	0m7.637s
                40.3.2.4.3
            40.3.2.5
        40.3.3 Eslint
$ dtapprouterLint 
-> Infra
Navigate to the Infra directory
cd static-resources/infra 
Run ESLint code validation
npm run local-lint 

cd static-resources/infra && npm run local-lint  && cd -

-> Site-directory

Navigate to the site-directory directory
cd static-resources/site-directory 
Run ESLint code validation
npm run local-lint 

-> contentManager:
[i500695@C02X632CJGH6:2019-03-26 15:13:41:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]607$ cd static-resources/contentManager
[i500695@C02X632CJGH6:2019-03-27 11:06:22:~/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager:]608$ npm run local-lint

> content-manager@1.7.0 local-lint /Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager
> grunt local-lint

Running "eslint:local" (eslint) task

/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/controller/app/AppNavigationContent.controller.js
  11:94  error  'IconDialogBox' is defined but never used. Allowed unused args must match /^next/  no-unused-vars

✖ 1 problem (1 error, 0 warnings)


Done.

        40.3.4 code coverage
[i500695@C02X632CJGH6:2019-04-24 16:50:48:~/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager:]612$ npm run local-test-and-coverage

        40.3.5 deploy to space
 $  npm run processBuild
 $  npm run build-client-side-dev 


 $  npm run processBuild &&  npm run build-client-side-dev 
manifest:
 [i500695@C02X632CJGH6:2019-10-02 13:23:16:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2056$ vimdiff  manifest-dev.yml  /Users/i500695/work/SAP/CF/Manifests/dt-approuter/manifest-dev.yosi01.yml 
$ sed -ie 's/yosi01/yosi03/' manifest-dev.yml 
[i500695@C02X632CJGH6:2019-10-02 13:23:15:~/work/SAP/CF_LocAL/portal-cf-dt-approuter:]2055$ gitd
diff --git a/manifest-dev.yml b/manifest-dev.yml
index 1968fa28..5ab955f4 100644
--- a/manifest-dev.yml
+++ b/manifest-dev.yml
@@ -5,14 +5,14 @@ applications:
 - name: portal-cf-dt-approuter
   routes:
     # fcc in this case is the tenant consuming fcc as SaaS
-    - route: <identityzone>-dt-cpp<hostsuffix>.<domain>
+    - route: site-manager-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com
     #- route: fcc-cpp-jawad-i324180.<domain>
   memory: 256M
   instances: 1
   buildpacks:
     - https://github.com/cloudfoundry/nodejs-buildpack/releases/download/v1.6.39/nodejs-buildpack-cflinuxfs3-v1.6.39.zip
   env:
-    TENANT_HOST_PATTERN:  '^(.*)-dt-cpp<hostsuffix>.<domain>'
+    TENANT_HOST_PATTERN: '^(.*)-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com'
     SAP_JWT_TRUST_ACL: "[{\"clientid\":\"*\",\"identityzone\":\"sap-provisioning\"}]"
     XS_APP_LOG_LEVEL: DEBUG
   services:
 
 2061  cf push -f manifest-dev.yml 

        40.3.6 dt-approuter debug tips
        cmd+alt+i - open Chrome dev-tools
        to load non minified js code add param sap-ui-debug=true
ex:
https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/sitedirectory?sap-ui-debug=true#Content-Manage&/entityEditor/businessapp/09F20D07563087C9AED8D76E0CD5025A/display/Local

https://site-manager-saas-dt-cpp-yosi03-i500695.cfapps.sap.hana.ondemand.com/sitedirectory?sap-ui-debug=true#Content-Manage&/entityEditor/role/s4_role/display/Local

id=__cd_approuter_qunit_tests__

-> Content manager
/Users/i500695/work/SAP/CF_LocAL/portal-cf-dt-approuter/static-resources/contentManager/webapp/test/unit/unitTests.qunit.html
run from broswer or from IDE, right click, run.

->

        40.3.7 qunit tests

    40.4 dt-static-resources

        40.4.1 repo
https://github.wdf.sap.corp/Portal-CF/dt-static-resources/blob/master/README.md#developer-work-on-own-repoeditors-or-libraryand-want-verify-his-code-in-mock-or-in-dev-environment

 git clone https://github.wdf.sap.corp/Portal-CF/dt-static-resources.git
 /Users/i500695/work/SAP/git/dt-static-resources

push to space:
    npm i
     npm run build-client-side-dev 

     edit manifest, e.g.  <url:/Users/i500695/work/SAP/CF/Manifests/dt-static-reources/manifest-dev.yml>
cf push -f manifest-dev.yml 


        40.4.2 readme
This repository is used for packading and deployment of portal design time environmenty. I has no static code. all the static code located in the following repositoires:

Repository	Content	Dependencies	CI status
portal-cf-static-infra	infra	none	Build Status
portal-cf-static-design-infra	freestyle designtime infra	none	Build Status
portal-cf-static-content-manager	contentManagerContainer, contentManager	infra	Build Status
portal-cf-static-site-settings	siteSettingsContainer, siteSettings	infra	Build Status
portal-cf-static-freestyle-dt	contentEditor, menuEditor, pagePreview, pageEditor	infra, cfDesignInfra	Build Status
portal-cf-static-site-directory	site-directory	infra	Build Status
portal-cf-static-provider-manager	providerManager	infra	Build Status
portal-cf-static-workzone-configurator	workzoneConfigurator	infra	Build Status
Generate fcc.json , DesignerFioriLaunchpad.html and /site-directory/index.html

npm run mergeHtml
Add required registerModulePath:
For mock: add entry under modulePaths property of static-resources\admin-sites\ushellConfigurations\evofordesignTimeGlobal.json
For cf: portal-cf-static-resources/src/lib/DesignTimeProxyService.js method: getDesignerUshellConfig
Definiton default Intent: update next property: renderers.fiori2.componentData.rootIntent
For mock: static-resources\admin-sites\ushellConfigurations\evofordesignTimeGlobal.json
For cf: portal-cf-static-resources/src/resources/admin-sites/subAccountManagerV2UshellConfig.json
load library definiton under: ui5.libs
For mock: static-resources\admin-sites\ushellConfigurations\evofordesignTimeGlobal.json
For cf: portal-cf-static-resources/src/resources/admin-sites/subAccountManagerV2UshellConfig.json
Edit designer site:(define new applications and plugins, add applications to menu

For mock: static-resources\admin-sites\GlobalFioriLaunchpad-TMPL.html
For cf: portal-cf-static-resources/src/resources/admin-sites/sites/subAccountManagerV2.json
Developer Story
Developer work on own repo(editors or library)and want verify his code in mock or in dev-environment

Be sure that this repository existed under the same root as dt-static-resources

Go to package.json and remove form devDependencies dedicated module(e.g portal-cf-static-content-manager).

Run

    npm install
Run required build command (create target-static-resources)
    npm run build-client-side-dev
    or 
    npm run build-client-side-dev-min
    or 
    npm run build-client-side-mock
Build
Build dt-static-resources:

 npm run processBuild
To deploy minified client code to your developer space run:

This command will copy your minified client code to target-static-resources
 npm run build-client-side
To deploy source code (not minified) to your developer space run:

This command:

Copy your source client code to target-static-resources
  npm run build-client-side-dev 
To deploy source minified code to your developer space run:

This command:

Copy minified source client code to target-static-resources
  npm run build-client-side-dev-min
Running Design Time in Mock Mode
Clone repository portal-cf-freestyle-ootb-templates
Clone repository portal-cf-freestyle-static-resources
Open command line under dt-static-resources and run next commands:
This command:

Generate fcc.json , DesignerFioriLaunchpad.html and /site-directory/index.html
Generate xs-app.json
Copy your source client code to target-static-resources
    npm run build-client-side-mock 
start mock approuter
    npm start 
Url to localhost for each scenarios:
portal: http://localhost:5000/sites?mode=mock

workzone: http://localhost:5000/workzone?mode=mock

workzonehr http://localhost:5000/workzone?mode=mock&scenario=WORKZONEHR

launchpad: http://localhost:5000/launchpad?mode=mock

Admin Shell on sub-account level
Each application provide its own title (in resource bundle and manifest of application)
  "sap.app": {
   ...
     "i18n": "resources/i18n.properties", 
    "title": "{{SITE_EDITOR_TITLE}}",
    ...
  },
example
Data Loss Protection: work around

Each application that implement Data Loss Protection provide notification on exit:
  Component.js:
    exit: function () {
                sap.ui.getCore().getEventBus().publish("sap.ushell.services.designer.editor_components.EditorSplitApp.Component", "onNavigationAllowed");
            }
example

Editor/Application on sub account level(shared context):

Each application should notify that it opened in global context
Component.js:
   active: function()
                {
                    Utils.setMockPath(this);
                    sap.ui.getCore().getEventBus().publish("sap.ushell.cpv2.services.globalContext", "opened");
                },
Editor works with site context:

Each application should notify that it opened in site context
Component.js:
   active: function()
                {
                    Utils.setMockPath(this);
                    sap.ui.getCore().getEventBus().publish("sap.ushell.cpv2.services.siteContext", "opened");
                },
Ability navigation with parameter
In definiton crossNavigation of application define siteId parameter
for mock: site-directory-TMPL.json
for cf: portal-cf-static-resources/src/resources/admin-sites/sites/subAccountManagerV2.json
     "crossNavigation": {
          "inbounds": {
            "Menu-Manage": {
              "semanticObject": "Menu",
              "action": "Manage"
            },
            "signature": {
              "parameters": {
                "siteId": {
                  "required": false,
                  "default": {
                    "value": "abcd",
                    "format": "plain"
                  }
                }
              },
              "additionalParameters": "allowed"
            }
          }
        }

        40.4.3
   

    40.5 cdm-store microservice , tags: cdm-store microservice 

        40.5.1  getting started

            40.5.1.1  get code
git clone https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service.git

$ docker run --name local-postgres -e POSTGRES_USER=<your i username> -e POSTGRES_PASSWORD=Abcd1234 -d -p 5432:5432 postgres:9.6
so for me:
docker run --name local-postgres -e POSTGRES_USER=i500695 -e POSTGRES_PASSWORD=Abcd1234 -d -p 5432:5432 postgres:9.6
$ docker run --name local-postgres -e POSTGRES_USER=postgres2 -e POSTGRES_PASSWORD='G4rtU()1' -d -p 5432:5432 postgres:9.6
[i500695@C02X632CJGH6:2020-03-05 15:11:23:~/work/SAP/git/portal-cf-cdm-store-service:]2072$ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
213d53527720        postgres:9.6        "docker-entrypoint.s…"   13 seconds ago      Up 11 seconds       0.0.0.0:5432->5432/tcp   local-postgres

to stop the container run $ docker stop local-postgres. to start it again run $ docker start local-postgres

mci
 mvn  clean install  -Ddb.username=i500695   -Ddb.password='Abcd1234' 
 mvn  clean install  -Ddb.username=postgres2   -Ddb.password='G4rtU()1' 

 mvn spring-boot:run  -Dspring.profiles.active=dev -Ddb.username=postgres2   -Ddb.password='G4rtU()1' 

            40.5.1.2 15/10/23 12:44:11  - SAP stops working with oracle java.
remove any Java from oracle / lre / openjdk
Generally found in
/Users/<user>/Library/Java/JavaVirtualMachines/<JAVA>/Contents/Home
/Library/Java/JavaVirtualMachines/<JAVA>/Contents/Home

use SapMachine
if you have brew run 
brew install sapmachine-jdk

            40.5.1.3 Java 17

                40.5.1.3.1  preliminary steps


https://github.com/SAP/SapMachine/wiki/Installation

https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+team+new+employee+corner
https://wiki.one.int.sap/wiki/pages/viewpage.action?spaceKey=CPPortals&title=Yosi%27s+team+new+employee+corner#Yosi'steamnewemployeecorner-Gettingstartedbuildingcdmstore

                40.5.1.3.2 build
$ brew install sapmachine-jdk
$ export JAVA_HOME=`/usr/libexec/java_home -v 21.0.1`
$ mci
                40.5.1.3.3 run tests

a. start docker containers
    a1. solace 
    $ docker-compose -f solace-docker-compose.yml  up -d
[+] Running 1/1
 ⠿ Container pubSubStandardSingleNode  Started 

    b2. pg 
   docker run --name local-postgres-cmk -e POSTGRES_USER=portal_user -e POSTGRES_PASSWORD=portal_pass -d -p 5433:5432 postgres:12
  docker run --name local-postgres -e POSTGRES_USER=portal_user -e POSTGRES_PASSWORD=portal_pass -d -p 5432:5432 postgres:12

b.
  $ mvn \
  clean install \
  -Ddb.username=<I_USER> \
  -Ddb.password=<PASSWORD>
  -Dcmk.db.username=cmk_portal_user \
  -Dcmk.db.password=cmk_portal_pass \
  -DLOCAL_CMK_DB_ENABLED=true

  $ mvn  clean install  -Ddb.username=portal_user  -Ddb.password=portal_pass -Dcmk.db.username=cmk_portal_user  -Dcmk.db.password=cmk_portal_pass  -DLOCAL_CMK_DB_ENABLED=true

            40.5.1.4 40.5.1.1  Fix build issues 
a. First set to java 8
| get list of VMs:
| $ /usr/libexec/java_home -V
| Matching Java Virtual Machines (4):
|     13.0.1, x86_64:	"OpenJDK 13.0.1"	/Library/Java/JavaVirtualMachines/openjdk-13.0.1.jdk/Contents/Home
|     10.0.2, x86_64:	"Java SE 10.0.2"	/Library/Java/JavaVirtualMachines/jdk-10.0.2.jdk/Contents/Home
|     1.8.0_241, x86_64:	"Java SE 8"	/Library/Java/JavaVirtualMachines/jdk1.8.0_241.jdk/Contents/Home
|     1.8.0_292, x86_64:	"AdoptOpenJDK 8"	/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home
| Then set to correct one
$ export JAVA_HOME=`/usr/libexec/java_home -v 1.8.0_292`

b. verify mvn 3.5
[i500695@WYLQRXL9LQ:2022-10-25 12:21:32:~/git/portal-cf-cdm-store-service/cdm.store.service:]2012$ export JAVA_HOME=`/usr/libexec/java_home -v 1.8.0_292`^C
[i500695@WYLQRXL9LQ:2022-10-25 12:23:09:~/git/portal-cf-cdm-store-service/cdm.store.service:]2012$ mvn --version
Apache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-17T21:33:14+03:00)
Maven home: /opt/homebrew/Cellar/maven@3.5/3.5.4_1/libexec

if not make sure to run old maven 3.5 (or else you'll get error [FATAL] Non-resolvable parent POM for com.sap.cloud.cf.portal:cdm-store-service-parent:1.92.0: Could not find artifact com.sap.sgs:security-patched-spring-boot-starter:pom:2.5.14-sap-07 in project.local (file:${project.basedir}/repo) and 'parent.relativePath' points at wrong local POM @ line 5, column 11) 
 so:
 brew install maven@3.0 
 and add to path 
echo 'export PATH="/opt/homebrew/opt/maven@3.5/bin:$PATH"' >> /Users/i500695/.bash_profile

c.  settings.xml
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+team+new+employee+corner#Yosi%27steamnewemployeecorner-CDM-Store-Service
https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=1926595678#Howtosetuplocalenvironment(CPV2)-MavenConfiguration
https://github.wdf.sap.corp/FLP/flp-java-maven-docker/blob/main/settings.xml
copy to .m2

d. Update version in POM files
    c1.  pom.xml
   <parent>
     <groupId>com.sap.sgs</groupId>
     <artifactId>security-patched-spring-boot-starter</artifactId>
-    <version>2.5.14-sap-20</version>
+    <version>2.5.14-sap-07</version>

    c2. inner pom cdm.store.service/pom.xml
     <dependency>
       <groupId>org.postgresql</groupId>
       <artifactId>postgresql</artifactId>
-      <version>42.4.1</version>
+      <version>42.3.3</version>

d.
CDM-store KT: https://sap-my.sharepoint.com/:v:/p/jawad_margieh/EWxFl-MOnrtPrPvVWJEw5jkBxSSRBu4DiB1jsBgyl_wfYQ

            40.5.1.1  main tables
            		
                40.5.1.1.1  CDM_ENTITIES


a.  \d cdm."CDM_ENTITIES"
+-------------------+--------+-----------+
| Column            | Type   | Modifiers |
|-------------------+--------+-----------|
| createdOn         | bigint |  not null |
| createdBy         | text   |  not null |
| updatedOn         | bigint |  not null |
| updatedBy         | text   |  not null |
| entityId          | text   |  not null |
| entityType        | text   |  not null |
| entityTitle       | text   |           |
| entityDescription | text   |           |
| tenantId          | text   |  not null |
| instanceId        | text   |  not null |
| identityZoneId    | text   |  not null |
| contextType       | text   |  not null |
| id                | text   |  not null |
| cdm               | jsonb  |  not null |
| entityMD5         | text   |           |
+-------------------+--------+-----------+
Indexes:
    "CDM_ENTITIES_pkey" PRIMARY KEY, btree ("entityType", "entityId", id, "contextType", "tenantId")
    "md5_unique" UNIQUE CONSTRAINT, btree ("entityMD5")
    "cdm_entities_entity_md5_index" btree ("entityMD5")
    "cdm_entities_entity_type_index" btree ("entityType")
    "cdm_entities_table_tenant_context_id_type_index" btree ("tenantId", id, "contextType")
    "cdm_entities_tenant_id_index" btree ("tenantId")
Referenced by:
    TABLE "cdm.entities_searchable_text" CONSTRAINT "entities_searchable_text_entity_md5_fkey" FOREIGN KEY (entity_md5) REFERENCES cdm."CDM_ENTITIES"("entityMD5") ON UPDATE CASCADE ON DELETE CASCADE

Note, entityMD5 is a hash of five Identity fields and is unique constraint, fields: tenantId( Derived from instanceId, identityZoneId), contextType, contextId, entityType, entityId
identityZoneId - customer specific
instanceId - per subscription to one of our product

Note, tenantId in cdm-store is not same as what customer see in cockpit 
To get customer content use instanceId of SKU (can get it from VCAP portal-cf-general-configuration section e.g. launchpadInstanceId) and identityZoneId set to cockpit tenantId
for all customer content cross all his products, use where identityZoneId = "tenantId" 

Time: 1.123s (1 second), executed in: 1.118s (1 second)
AjjAxgyOruVg> \dt cdm."CDM_ENTITIES"
+--------+--------------+-------+-------+
| Schema | Name         | Type  | Owner |
|--------+--------------+-------+-------|
| cdm    | CDM_ENTITIES | table | dbo   |
+--------+--------------+-------+-------+

                40.5.1.1.2 RELATIONS
two kinds, extends for cross-context (cherrypicks)
and ref (same context) - aggregation

b.  \d cdm."RELATIONS"
+-----------------+------+-----------+
| Column          | Type | Modifiers |
|-----------------+------+-----------|
| fromMD5         | text |  not null |
| fromContextId   | text |  not null |
| fromContextType | text |  not null |
| fromEntityId    | text |  not null |
| fromEntityType  | text |  not null |
| fromTenantId    | text |  not null |
| toMD5           | text |  not null |
| toContextId     | text |  not null |
| toContextType   | text |  not null |
| toEntityId      | text |  not null |
| toEntityType    | text |  not null |
| toTenantId      | text |  not null |
| relationType    | text |  not null |
+-----------------+------+-----------+
Indexes:
    "RELATIONS_pkey" PRIMARY KEY, btree ("fromMD5", "fromContextId", "fromContextType", "fromEntityId", "fromEntityType", "fromTenantId", "toMD5", "toContextId", "toContextType", "toEntityId", "toEntityType", "toTenantId")
    "relations_table_from_tenant_context_index" btree ("fromContextId", "fromContextType", "fromTenantId")
    "relations_table_frommd5_index" btree ("fromMD5")
    "relations_table_relation_type" btree ("relationType")
    "relations_table_to_tenant_context_index" btree ("toContextId", "toContextType", "toTenantId")
    "relations_table_tomd5_index" btree ("toMD5")

example:
$ vimf cdm.store.service/src/test/resources/com/sap/portal/cdm/store/service/CdmEntitiesDeltaUpdateRoles.json 
     "relations": {
       "apps": [
         {
           "target": {
             "id": "f2469d9b-ad45-4a4f-a832-0b378a60b4dd",
             "entityType": "businessapp",
             "context": {
               "id": "S4_PROVIDER",
               "type": "SNAPSHOT"
             }
           },
           "label": "ref"
         },
         {
           "target": {
             "id": "c7a0b214-58f5-4a51-b7c6-ceaffcd69e24",
             "entityType": "businessapp",
             "context": {
               "id": "S4_PROVIDER",
               "type": "SNAPSHOT"
             }
           },
           "label": "ref"
         }
       ]
     },

relations site->site-reference->role->app/group/catalog/space 
also catalogs/groups that have apps are modeled in DB as relation app->catalog/group 
this makes our graph traversal easier 
so to get all catalog apps search relation toXXX and pass fromXXX of catalog
     

            40.5.1.2

        40.5.2 CDM store APIs, Requests, collections , tags: CDM store APIs, Requests, collections 

            40.5.2.1  BATCH API


                40.5.2.1.1  code
/Users/i500695/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/webaccess/CdmController.java
    @PreAuthorize("@crossTenantAuthorizationService.hasAuthorization(#batch)")
    @PostMapping(value = "/entities", consumes = "application/json")
    public ResponseEntity batch(@RequestBody @Validated(BatchUpdateValidator.class) BatchUpdate batch) {
        logger.trace("batch() called with batch request = {}", batch);
        if (migrationService.isReadOnly()) {
        	  logger.error("batch() Cannot perform batch during migration");
              return new ResponseEntity<>(HttpStatus.INTERNAL_SERVER_ERROR);
        }
        if (batch.getContext() != null) {
            logger.debug("batch() batch called with context Id = {} tenantId = {} identityZoneId = {} instanceId = {}", batch.getContext().getId(), batch.getContext().getTenantId(), batch.getContext().getIdentityZoneId(), batch.getContext().getInstanceId());
        }
        int rowEffected;

        rowEffected = entityService.batch(batch);

        if (rowEffected > 0) {
            return new ResponseEntity<>(HttpStatus.OK);
        } else if (rowEffected == 0) {
            logger.debug("batch() Couldn't find entities to delete (DELETE_CONTEXT flow)");
            return new ResponseEntity<>(HttpStatus.NO_CONTENT);
        }
        logger.debug("batch() update failed");
        return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
    }

                40.5.2.1.2 curl batch request
curl --location 'https://portal-service-lts.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entities' \
--header 'x-attribute-tenant-id: 61526bed-8de3-411c-9adf-376bc6a81702' \
--header 'x-attribute-instance-id: f803670f-16a1-4131-862d-8bbc5e620027' \
--header 'x-attribute-username: cardmigration' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <place token>' \
--header 'Cookie: JSESSIONID=B4C6D8F887630FE452A98E77E570BA7C; _VCAP_ID_=f9160390-a6ea-468e-443e-b754' \
--data-raw '{
    "x-attribute-username": "cardmigration",
    "context":
{         "contextType": "sub_account",         "id": "SUB_ACCOUNT"     }
,
    "operations": [
        {
            "cdm": {
                "_version": "3.0",
                "identification":
{                     "id": "fc13878b-3804-4d74-80d4-ffc8883d310b",                     "entityType": "businessapp",                     "title": "dgoalsv2"                 }
,
                "payload": {
                    "visualizations": {
                        "talenteamhr.dgoalsv2.vis": {
                            "vizType": "sap.card",
                            "vizConfig": {
                                "sap.ui": {
                                    "icons":
{                                         "icon": "sap-icon://list"                                     }
,
                                    "technology": "UI5",
                                    "deviceTypes":
{                                         "phone": true,                                         "tablet": true,                                         "desktop": true                                     }
                                },
                                "baseURL": "/content-repository/talenteamhr.dgoalsv2/6153710aef10e0b9d3145e3c6969f9dd",
                                "sap.app": {
                                    "id": "talenteamhr.dgoalsv2",
                                    "type": "card",
                                    "title": "dgoalsv2",
                                    "subTitle": "dgoalsv2",
                                    "applicationVersion":
{                                         "version": "1.0.0"                                     }
                                },
                                "_version": "1.14.0",
                                "provided": false,
                                "sap.card": {
                                    "data": {
                                        "request":
{                                             "url": "./appdata.json"                                         }
                                    },
                                    "type": "List",
                                    "header": {
                                        "icon":
{                                             "src": "\{iconSrc}
"
                                        },
                                        "title": "Development Goals of ",
                                        "subTitle": "snahata@talenteam.com"
                                    },
                                    "content": {
                                        "data": {
                                            "path": "/d/results",
                                            "request":
{                                                 "url": "./appdata.json"                                             }
                                        },
                                        "item": {
                                            "icon":
{                                                 "src": "sap-icon://attachment"                                             }
,
                                            "title": "{name}",
                                            "description": "{stateLabel} ---> {purposeLabel}"
                                        },
                                        "maxItems": 5
                                    }
                                },
                                "updatedOn": 1634012751730,
                                "sap.platform.mobilecards":
{                                     "compatible": false                                 }
                            }
                        }
                    }
                },
                "texts": [
                    {
                        "locale": "",
                        "textDictionary": {}
                    }
                ]
            },
            "metadata":
{                 "operation": "CREATE"             }
        }
    ]
}'


                40.5.2.1.3
            40.5.2.2 is_alive
Hi Jawad, interest cards need to implement is_alive on their JAVA apps + connect them into the central is_alive. we implemented it for cdm-store. Do you know if we have documentation with guidelines how to implement?

            40.5.2.3
        40.5.3 push to space

        40.5.4 Connect to Database
        
            40.5.4.1 how to connect to cdm-store db, tags: how to connect to cdm-store db
<url:/Users/I500695/work/KB/kb_DB#r=__ExampleconnectandworkwithcdmstoreDB__>

Prerequisite: install Jawad's portal-cli: https://github.wdf.sap.corp/i324180/portal-cli
Download and install nodejs: https://nodejs.org/en/download/.
cf-cli must be installed and configured on the system for this CLI to work. Refer to https://docs.cloudfoundry.org/cf-cli/install-go-cli.html for installation on the system of your interest.
$ brew install cloudfoundry/tap/cf-cli@7
$ cf login
API endpoint: https://api.cf.sap.hana.ondemand.com
Password:  <SSO pwd><One time RSA token>

Authenticating...
OK

| Select an org:
| 1. DynamicForms
| 2. flpci
| 3. i500695launchpad
| 4. launchpad
| 5. mainsub
| 6. perfdt
| 7. portal-prov
| 8. rcsub
| 9. SaarTest
| 10. SAP_PORTAL_SERVICES
| 11. swz
| 12. swzperf
| 
| Org (enter to skip): 5
| Targeted org mainsub.
| 
| Select a space:
| 1. daily
| 2. flplts
| 3. lts

Space (enter to skip): 3
Targeted space lts.

API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.108.0
user:           yosi.izaq@sap.com
org:            mainsub
space:          lts

Make sure you're logged in to CF and on the correct space

$ cf t -o <ORG> -s <SPACE>

$ git clone git@github.wdf.sap.corp:i324180/portal-cli.git
$ cd portal-cli
$ npm i -g 


            40.5.4.2 When our apps are connecting to the Postgres DB do they use username and password or the server cert, tags: When our apps are connecting to the Postgres DB do they use username and password or the server cert
check bindings:
e.g.
$ cf env portal-cf-cdm-store-service-blue | vi -
...
  "postgresql-db": [
    {
      "binding_guid": "2b220b0f-ab9c-4992-9d14-be3b06fd7b69",
      "binding_name": null,
      "credentials": {
        "dbname": "zSnFpcSOJTMs",
        "hostname": "postgres-995d225d-507c-4a59-a764-5389642560d0.crkc3ulytfr9.eu-central-1.rds.amazonaws.com",
        "password": "41cbceacdbb844a3",
        "port": "4984",
        "sslcert": "reducted",
        "sslrootcert": "reducted",
        "uri": "postgres://698b68dde9e5:41cbceacdbb844a3@postgres-995d225d-507c-4a59-a764-5389642560d0.crkc3ulytfr9.eu-central-1.rds.amazonaws.com:4984/zSnFpcSOJTMs",
        "username": "698b68dde9e5"
      },

in our code:
/Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cf/database/cmk/PostgresCmkDataSource.java
    private DataSource getDataSource(String username, String password, String url, String driverName) {
        if (this.dataSource == null) {
            if (Arrays.stream(env.getActiveProfiles()).anyMatch(
                    env -> (env.equalsIgnoreCase("cloud")))) {
                jdbcUrl = PostgresUtil.addClientCertToJdbcUrl(url, dataSourceProperties);
            } else {
                jdbcUrl = url;
            }
            this.dataSource = DataSourceBuilder.create()
            ...
            }
/Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cf/database/utils/PostgresUtil.java
    public static String addClientCertToJdbcUrl(String currentJdbcUrl,
                                                IDataSourceProperties dataSourceProperties) {


            40.5.4.3
        40.5.5 cdm-store tests, api payloads

            40.5.5.1 Batch payloads

                40.5.5.1.1 create 

ex: cdm.store.service/src/test/resources/com/sap/portal/cdm/store/service/batch.cherrypick.role.json 
{
   "x-attribute-username": "default_user",
   "context": {
     "id": "SUB_ACCOUNT",
     "contextType": "sub_account"
   },
   "operations": [
     {
       "metadata": {
         "operation": "CREATE"
       },
       "cdm": {
         "_version": "3.0",
         "identification": {
           "id": "dummy.role2",
           "entityType": "role",
           "title": "{{roleTitle}}"
         },
         "payload": {
           "catalogs": [
             {
               "id": "billing.catalog"
             }
           ],
           "groups": [
             {
               "id": "billing.group"
             }
           ],
           "apps": [
             {
               "id": "cus.sd.billingdoclist.manages1"
             }
           ]
         },
         "texts": [
           {
             "locale": "",
             "textDictionary": {
               "roleTitle": "Default Title"
             }
           },
           {
             "locale": "en",
             "textDictionary": {
               "roleTitle": "English Title"
             }
           },
           {
             "locale": "de",
             "textDictionary": {
               "roleTitle": "Deutscher Titel"
             }
           },
           {
             "locale": "es-AR",
             "textDictionary": {
               "roleTitle": "Título español"
             }
           }
         ],
         "relations": {
           "base": [
             {
               "target": {
                 "id": "500d950d-ad14-4e13-8da2-dfc0494e4382",
                 "entityType": "role",
                 "context": {
                   "id": "S4_PROVIDER",
                   "type": "snapshot"
                 }
               },
               "label": "extends"
             }
           ],
           "apps": []
         }
       }
     }
   ]
 }

                40.5.5.1.2
            40.5.5.2

        40.5.6 migrations 

            40.5.6.1 Migration Guides
-> Adam:
For the migration process we ran the logic on the application startup, using an ENV flag.
The logic was executed in a single transaction on each tenant to make sure of its atomicity per client. Any issue that would fail the migration would rollback the transaction and write the details to a log object, which is printed in the end of the process + written to the file system.
 
This is a small wiki which describes the flow and shows an example of the final log object :  https://wiki.wdf.sap.corp/wiki/display/CPPortals/backend+search+migration+-+execution+plan
 
Note that each migration is different. In the described migration the changes were done to create a new table which doesn’t affect any customer until the feature is released.

triggering the migration
there is an env var called "MIGRATIONS_TOGGLE" which is currently set to "false". changing it to "true" and deploying the cdm-store will result in running the migration.

if possible, the migration should run in off-work hours, such as saturday evening

we will want to turn the flag to "true" atleast a sprint before the feature is out, so we will have the time to react if it is needed.

turning the flag to "true" should not have any affect on any other flow.

the process of the migration
what the migration does is to go over all of the entities in the "CDM_ENTITIES" table, take specific fields we need to a new table called "entities_searchable_text", do some manipulation on the data if needed, and add to the new table. there are no changes what so ever to the existing customer data in any of the existing tables.

the migration should take between 5-15 min. therefor we cannot run it all as one transaction as data might be changed by the users in the meanwhile.

we will run the migration as a none transactional operation. if there is any failure, the migration can be retriggered without any additional operations needed.

handling exceptions
as we fill a new table which will be filled before the feature is completely released, there is nothing that is needed to be done when there is an error. the data will correct itself in the next migration if needed.

if we will notice a bug in the migration code itself, we will have the time to fix it in the regular delivery flow.

report
when the migration finishes in w/e state, a report with the following structure will be generated:

report
{ "totalNumberOfEntities" : number
, "finalStatus" : boolean
, "totalNumberOfTenants": number
, "tenantsReports" : [ 
    { "numberOfEntities": number,
      "failureReason": string,
      "tenantId": string,
      "status": boolean }
  ]}
to understand if the whole migration succeeded, the field "finalStatus" has to show "true".

the report contains information on each tenant and the overall data on all of them together.

the report will be written to the log as an ERROR, with a prefix string "THIS IS NOT AN ERROR".

the report will also be written to the container disk under the path "/src/main/fullTextSearchMigrations.json"

Checking for errors
the checks should be to look for the report generated as stated above in every DC. if there are any issues, we will investigate and provide a fix to LTS if needed. there is no need for rel / hotfix
->
            40.5.6.2

        40.5.7 Swagger
from readme:
### Swagger / REST API
* Visual definition: [Swagger UI](https://github.wdf.sap.corp/pages/Portal-CF/portal-cf-cdm-store-service/swagger/)
* Yaml definition: [cdm-store-swagger.yaml](https://github.wdf.sap.corp/pages/Portal-CF/portal-cf-cdm-store-service/cdm.store.service/src/main/resources/swagger/cdm-store-swagger.yaml)

        40.5.8 buildpack, tags buildpack java version end of life support 
cdm-store is using sap JVM 
manifest.yml:  buildpack: sap_java_buildpack
java version 8. see:
    https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/dd03579c5f89782cba0b591ae6c1526a064bd3d6/pom.xml
    <java.version>1.8</java.version>

End of support 12/2027. see:
https://workzone.one.int.sap/site#workzone-home&/groups/3nEFU6Y5VbsvUq92zvk4ru/overview_page/pDDBI51n21HqbAFrk9krXb

        40.5.9 CDM-Store-Service error handling

            40.5.9.1 RestResponseEntityExceptionHandler 
public class RestResponseEntityExceptionHandler extends ResponseEntityExceptionHandler {

see: https://www.baeldung.com/global-error-handler-in-a-spring-rest-api
implement a global error handler for a Spring REST API.

We will use the semantics of each exception to build out meaningful error messages for the client, with the clear goal of giving that client all the info to easily diagnose the problem.
@ControllerAdvice
public class CustomRestExceptionHandler extends ResponseEntityExceptionHandler {
    ...
}

            40.5.9.2 Custom validators
import org.springframework.validation.Validator;
https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/validation/Validator.html
https://reflectoring.io/bean-validation-with-spring-boot/

ex: public class ImportValidator implements Validator {


            40.5.9.3

        40.5.10 CDM-Store-Service updates,, tags: CDM-Store-Service updates

            40.5.10.1 Congratulations a new Postgres image has been added to portal-cf-cdm-store-service, 19/06/23 13:11:26  
From: Mishael, Roy <roy.mishael@sap.com>
Date: Wednesday, 14 June 2023 at 14:00
To: Margieh, Jawad <jawad.margieh@sap.com>, Izaq, Yosi <yosi.izaq@sap.com>, Frishberg Barak, Oren <oren.frishberg.barak@sap.com>
Subject: Congratulations a new Postgres image has been added to portal-cf-cdm-store-service

Hello everyone,
 
As was mentioned in the EUXDEVOPS-3321, a new image was created (and already inserted) into the portal-cf-cdm-store-service repository 🥳
 
The files which have changed are:
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/4d2bee642db7c2f05259f25b63111dcfa23c8ebd/.pipeline/extensions/Pull-Request%20Voting.groovy
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/blob/4d2bee642db7c2f05259f25b63111dcfa23c8ebd/.pipeline/extensions/Integration.groovy
 
The new image listens to port 5433 (instead of the default 5432 Postgres port) and is node based.
 
For more documentation about the image, please take a look at ci-docker-postgres (or the repository if you want to dive more deeply).
 
Best Regards,
Roy 😊

code snippet:
def call( parameters ) {
    // lock as a workaround on the solace issue, after fixing the issue with solace need to remove this lock
    def lockResource = "ci-portal-cf-cdm-store-service-voter"
    lock(resource: lockResource) {
        Script script = (parameters?.script ?: this) as Script
        def excludedClasses = "com/sap/portal/cf/database/config/DataSourceConfig.class,com/sap/portal/cf/database/hana/HanaDataSource.class,com/sap/portal/cf/security/config/WebSecurityConfig.class,com/sap/portal/cf/database/hana/HanaVersionVerifier.class,com/sap/portal/cdm/store/Application.class,com/sap/portal/cdm/store/webaccess/ServiceStatus.class"
        def uniqueId = UUID.randomUUID().toString()
        podTemplate(
                name: env.jaas_owner + '-jaas',
                label: uniqueId,
                containers: [
                        containerTemplate(name: 'jnlp', image: 'eu.gcr.io/sap-scp-jaas-prod/jnlp:4.13-1-sap-02', args: '${computer.jnlpmac} ${computer.name}'),
                        containerTemplate(name: 'postgres', image: 'postgres:latest',
                                envVars: [
                                        envVar(key: 'POSTGRES_DB', value: 'postgres'),
                                        envVar(key: 'POSTGRES_USER', value: 'postgres'),
                                        envVar(key: 'POSTGRES_PASSWORD', value: 'docker'),
                                        envVar(key: 'POSTGRES_HOST', value: 'localhost'),
                                        envVar(key: 'POSTGRES_PORT', value: '5432')
                                ]
                        ),
                        containerTemplate(name: 'postgres-2', image: 'bit-ce.int.repositories.cloud.sap/ci-docker-postgres:13.11', command: '/usr/bin/tail -f /dev/null',
                                envVars: [
                                        envVar(key: 'POSTGRES_DB', value: 'postgres'),
                                        envVar(key: 'POSTGRES_USER', value: 'postgres'),
                                        envVar(key: 'POSTGRES_PASSWORD', value: 'docker'),
                                        envVar(key: 'POSTGRES_HOST', value: 'localhost'),
                                        envVar(key: 'POSTGRES_PORT', value: '5433')
                                ]
                        ),
                        containerTemplate(name: 'maven', image: 'bit-ce.int.repositories.cloud.sap/neo/mvn-java8-new:1.0', command: 'tail -f /dev/null')
                ]) {

            40.5.10.2
        40.5.11 CDM-Store Events functionality

            40.5.11.1 introduction to CDM-Store Events functionality

                40.5.11.1.1 CDM-Store published events to Solace MQ
    - for every CUD operation
    - includes timestamp and for improved performance also the full entity
    - uses event table to make sure events are eventually sent even when solace connection is temporarily unavailable

                40.5.11.1.2 main code entries
/Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/IEventPublisher.java - interface for publishEvent() method

event publishers:
[i500695@WYLQRXL9LQ:2023-12-24 18:54:40:~/git/portal-cf-cdm-store-service:]2014$ agjavafiles publishEvent
cdm.store.service/src/test/java/com/sap/portal/cdm/store/event/ConsumeRTEventsIT.java
cdm.store.service/src/test/java/com/sap/portal/cdm/store/event/impl/EventProducerTest.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/utils/Helper.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/impl/SolaceEventPublisher.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/impl/DirectEventPublisher.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/IEventPublisher.java

Event producer:
cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/impl/EventProducer.java
public API:
    @Override
    public Future<Boolean> produceCreatedEventForEntities(final List<IEventEntityProperties> entities, final boolean isV2) {
        return handleEventAsync(entities, OperationName.CREATE, isV2);
    }

    @Override
    public Future<Boolean> produceUpdatedEventForEntities(final List<IEventEntityProperties> entities, final boolean isV2) {
        return handleEventAsync(entities, OperationName.UPDATE, isV2);
    }

    @Override
    public Future<Boolean> produceDeletedEventForEntities(final List<IEventEntityProperties> entities, final boolean isV2) {
        return handleEventAsync(entities, OperationName.DELETE, isV2);
    }


uses JMS, specifically these (prompt to copilot)
explain java code: import jakarta.jms.BytesMessage;
import jakarta.jms.JMSException;
import jakarta.jms.Message;
import jakarta.jms.Session;
import org.springframework.jms.JmsException;
import org.springframework.jms.connection.CachingConnectionFactory;
import org.springframework.jms.core.JmsTemplate;
Sure, I can explain the Java code that you have provided. 😊

The code consists of several import statements that are used to include classes and interfaces from different packages. These packages are related to Java Message Service (JMS), which is a standard API for sending and receiving messages between applications.

- `import jakarta.jms.BytesMessage;` imports the `BytesMessage` interface, which represents a message that contains a stream of bytes. This message type is for client encoding of existing message formats⁵.
- `import jakarta.jms.JMSException;` imports the `JMSException` class, which is the root exception class for all JMS-related exceptions. This class has several subclasses that indicate specific error conditions.
- `import jakarta.jms.Message;` imports the `Message` interface, which is the root interface for all JMS messages. It defines the common methods and headers for all message types.
- `import jakarta.jms.Session;` imports the `Session` interface, which represents a single-threaded context for producing and consuming messages. A session can create and manage message producers, consumers, queues, topics, and transactions.
- `import org.springframework.jms.JmsException;` imports the `JmsException` class, which is a Spring-specific subclass of `RuntimeException` that wraps any checked exceptions that are thrown by the JMS API. This class allows the JMS operations to be used with a consistent exception handling strategy.
- `import org.springframework.jms.connection.CachingConnectionFactory;` imports the `CachingConnectionFactory` class, which is a Spring-specific subclass of `SingleConnectionFactory` that adds session caching as a performance optimization. This class can reuse the same session for multiple send or receive operations, reducing the overhead of creating and closing sessions.
- `import org.springframework.jms.core.JmsTemplate;` imports the `JmsTemplate` class, which is a Spring-specific helper class that simplifies the use of the JMS API. This class provides methods for sending and receiving messages, converting messages to and from Java objects, and executing callbacks within a JMS session.

If you want to learn more about JMS and Spring, you can check out these web search results:

- [JMS Tutorial - Java Message Service Tutorial - HowToDoInJava](^4^)
- [JmsTemplate (Spring Framework 6.1.2 API)](^3^)
- [Convert String to a JMS BytesMessage in Java - Stack Overflow](^2^)
- [java - how to import jms - Stack Overflow](^1^)

I hope this helps. Have a nice day! 😊

Source: Conversation with Bing, 12/24/2023
(1) BytesMessage (Solace JMS API v10.21.0). https://docs.solace.com/API-Developer-Online-Ref-Documentation/jms/javax/jms/BytesMessage.html.
(2) JMS Tutorial - Java Message Service Tutorial - HowToDoInJava. https://howtodoinjava.com/jms/jms-java-message-service-tutorial/.
(3) JmsTemplate (Spring Framework 6.1.2 API). https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jms/core/JmsTemplate.html.
(4) Convert String to a JMS BytesMessage in Java - Stack Overflow. https://stackoverflow.com/questions/11229531/convert-string-to-a-jms-bytesmessage-in-java.
(5) java - how to import jms - Stack Overflow. https://stackoverflow.com/questions/8191564/how-to-import-jms.

                40.5.11.1.3 who is sending events?
/Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/ImportService.java
[i500695@WYLQRXL9LQ:2023-12-25 15:41:33:~/git/portal-cf-cdm-store-service:]2024$ agjavafiles produceCreatedEventForEntities
cdm.store.service/src/test/java/com/sap/portal/cdm/store/event/impl/EventProducerTest.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/ImportNonDeltaHandler.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/ImportService.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/EntityService.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/RelationService.java
cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/impl/CommitedEntitiesPublisher.java

            40.5.11.2 Events are saved to an events log table
example from /Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/service/impl/ImportService.java::commitImportForNonSnapshotContexts()
                if(toBeUpdatedEntities != null) {
                    this.eventProducer.produceUpdatedEventForEntities(toBeUpdatedEntities, false);
                    this.commitedEntitiesPublisher.insertEntitiesToEventsTable(toBeUpdatedEntities, OperationName.UPDATE);
                    createUpdateEntities.removeAll(toBeUpdatedEntities);
                }
publishes events for committed entities: /Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/impl/CommitedEntitiesPublisher.java
uses a cron job to resend in case of failures to send: EventScheduler.java


            40.5.11.3

        40.5.12 odds and ends of CDM-store , tags: odds and ends of CDM-store 

            40.5.12.1 tenantid is actually md5 hash of indentityZoneId and instancId
hash calculation: Utils.java
    public static String constructHashOf(String value1, String value2) throws NoSuchAlgorithmException {
        String combinedTenantId = String.format("%s::%s", value2, value1);
        MessageDigest md = MessageDigest.getInstance("MD5");
        md.update(combinedTenantId.getBytes());
        byte[] digest = md.digest();
        return DigestUtils.md5Hex(digest);
    }

simple CLI that mimics it, GPT with small tweaks by me:
[i500695@WYLQRXL9LQ:2024-01-22 14:56:57:~/work/SAP/code/CF/caclTenantId:]2034$ cat MD5DigestCLI.java 
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Scanner;

public class MD5DigestCLI {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        // System.out.println("Enter the first string:");
        // String input1 = scanner.nextLine();
        String input1 = args[0];
        String input2 = args[1];

        //System.out.println("Enter the second string:");
        //String input2 = scanner.nextLine();

        // Calculate MD5 digest for the first input
        String digest1 = calculateMD5(input1+"::"+input2);
        System.out.println("MD5 Digest for the two strings concateneated with :: in between " + digest1);

        scanner.close();
    }

    private static String calculateMD5(String input) {
        try {
            // Create a MessageDigest instance for MD5
            MessageDigest md5Digest = MessageDigest.getInstance("MD5");

            // Update the digest with the input data
            byte[] hashedBytes = md5Digest.digest(input.getBytes());

            // Convert the byte array to a hexadecimal string
            return bytesToHex(hashedBytes);

        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
            return null;
        }
    }

    // Helper method to convert byte array to hexadecimal string
    private static String bytesToHex(byte[] bytes) {
        StringBuilder hexString = new StringBuilder();
        for (byte b : bytes) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) {
                hexString.append('0');
            }
            hexString.append(hex);
        }
        return hexString.toString();
    }
}

[i500695@WYLQRXL9LQ:2024-01-22 14:57:11:~/work/SAP/code/CF/caclTenantId:]2035$ javac MD5DigestCLI.java 
[i500695@WYLQRXL9LQ:2024-01-22 14:57:13:~/work/SAP/code/CF/caclTenantId:]2036$ java MD5DigestCLI aaa bbb
MD5 Digest for the two strings concateneated with :: in between 9ac59f0a9300909c9367d9d761273e89


            40.5.12.2


        40.5.13
    40.6 portal-cf-provisioning-service, tags: portal-cf-provisioning-service


        40.6.1 new
$  export PGUSER="i500695" && export PGPWD="Abcd1234" && export PG_DB_NAME="my_database" &&  docker start local-redis && docker start local-postgres
        40.6.2 old
        readme
# portal-cf-provisioning-service

[![Build Status](https://gkeportalcf.jaas-gcp.cloud.sap.corp/buildStatus/icon?job=portal-cf-provisioning-service/master)](https://gkeportalcf.jaas-gcp.cloud.sap.corp/job/portal-cf-provisioning-service/job/master/)

## Important message from DevOps:

**Welcome! for any new repository there are few further steps require in order to deliver its code to production.
Please notify devOps team once the code is ready in order to join the required step**

| Step | job | Status |
| ----- | ------ | :--------: |
| Initialization | create and restrict main branches master/rc/live | **Done** |
| Development | Create CI Pipeline | **Done** |
| Release | Copy from master to rc/live branches | **Not Done** |
| Internal Delivery | Deploy to (Dev/Nightly/CI-create-space) | **Not Done** |
| External Delivery | Deploy to val / validation /Internal production / Live | **Not Done** |

Please update on ongoing changes (updates in manifest.yml, manifest-dev.yml, changes in dependencies, etc )

## Description
This service should orchestrate the call for each service in the provisioning process.

## Local development
#### Option 1
Run the Application.java under tenant.provisioning with the following VM options: -Ddb.username=<I_USER> -Ddb.password=<PASSWORD>

#### Option 2
Run mvn spring-boot:run -Ddb.username=<I_USER> -Ddb.password=<PASSWORD>

## Tests
#### Unit tests and Integration Tests
```mvn clean install -Ddb.username=<I_USER> -Ddb.password=<PASSWORD>``` will run unitests only.

## Docker
The provisioning-service can be started in a docker container.

#### Option 1
Build an image: ```docker build -f Dockerfile -t provisioning-service .```

Create and run container: ```docker run -it -p 127.0.0.1:8081:8081 --name provisioning-service provisioning-service:latest```

#### Option 2
Run ``` ./docker-init.sh <I_USER> <DB_PASSWORD>```

Finally, the docker container can be accessed through: ```localhost:8081``` .

        40.6.2 build, test
       [i500695@C02X632CJGH6:2020-05-17 18:06:15:~/work/SAP/git/portal-cf-provisioning-service:]2009$ mvn clean install -Ddb.username=i500695 -Ddb.password=mypwd; 
...
[INFO] --- maven-install-plugin:2.5.2:install (default-install) @ provisioning-service ---
[INFO] Installing /Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/target/portal-cf-provisioning-service.jar to /Users/i500695/.m2/repository/com/sap/cloud/cf/portal/provisioning-service/1.42.0-SNAPSHOT/provisioning-service-1.42.0-SNAPSHOT.jar
[INFO] Installing /Users/i500695/work/SAP/git/portal-cf-provisioning-service/tenant.provisioning/pom.xml to /Users/i500695/.m2/repository/com/sap/cloud/cf/portal/provisioning-service/1.42.0-SNAPSHOT/provisioning-service-1.42.0-SNAPSHOT.pom
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary for provisioning-service-parent 1.42.0-SNAPSHOT:
[INFO] 
[INFO] provisioning-service-parent ........................ SUCCESS [  2.140 s]
[INFO] portal-database .................................... SUCCESS [  6.366 s]
[INFO] provisioning-service ............................... SUCCESS [ 23.502 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  32.345 s
[INFO] Finished at: 2020-05-17T18:06:15+03:00
[INFO] ------------------------------------------------------------------------

        40.6.3 Swagger
Need two things:
a. provisioning-swagger.yaml
b. annotations. ApiOperation 
@ApiOperation(value = "Get all consumers tenant Ids of Launchpad/Portal/WorkZone")
    @GetMapping(value = "/consumers/ids", produces = "application/json")
    @PreAuthorize("@securityService.hasGrantTypeClientCredentials()")
    public ResponseEntity getAllConsumersTenantIds() {
        return this.getAllConsumersTenantIdsByInstanceId();
    }

        4.6.4 Tables, DB, tags: provisioning-service Tables, DB, microservice

            4.6.4.1 schema
aMNcSJwcZMbY> \dn
+------------------------------+--------------+
| Name                         | Owner        |
|------------------------------+--------------|
| cdm                          | dbo          |
| cdm:import:service           | dbo          |
| pgboss                       | dbo          |
| portal-cf-provider-service   | dbo          |
| portal.cf::ActivationService | dbo          |
| portal.cf::CepActivation     | dbo          |
| portal.cf::GACD              | dbo          |
| portal.cf::ServiceBroker     | dbo          |
| portal_cf_cdmCore            | dbo          |
| portal_cf_cdmRuntime         | dbo          |
| portal_cf_transformer        | dbo          |
| provisioning                 | dbo          |
| public                       | VLarkNmWMdEh |
| report                       | dbo          |
| wzcpkgmanager                | dbo          |
+------------------------------+--------------+

so schema = provisioning

SET search_path TO provisioning;
now list tables

            4.6.4.2 provisioning-service tables
aMNcSJwcZMbY> \dt
+--------------+-----------------------+-------+-------+
| Schema       | Name                  | Type  | Owner |
|--------------+-----------------------+-------+-------|
| provisioning | global_providers      | table | dbo   |
| provisioning | migration_lock        | table | dbo   |
| provisioning | migration_status      | table | dbo   |
| provisioning | providers             | table | dbo   |
| provisioning | subscribers           | table | dbo   |
| provisioning | virtual_subscriptions | table | dbo   |
+--------------+-----------------------+-------+-------+

                4.6.4.2.1  subscribers table


aMNcSJwcZMbY> \d subscribers 
+-------------------------+-----------------------------+----------------------------+
| Column                  | Type                        | Modifiers                  |
|-------------------------+-----------------------------+----------------------------|
| created_at              | timestamp without time zone |  default CURRENT_TIMESTAMP |
| subscribedToTenantId    | character varying(300)      |                            |
| instance_id             | character varying(300)      |  not null                  |
| subscription_app_plan   | character varying(300)      |  not null                  |
| identity_zone_id        | character varying(300)      |  not null                  |
| tenant_id               | character varying(300)      |  not null                  |
| subscription_sub_domain | character varying(300)      |  not null                  |
| subaccount_id           | text                        |                            |
+-------------------------+-----------------------------+----------------------------+
Indexes:
    "PK_85fb1f2aa0a1b18776b6c651fd5" PRIMARY KEY, btree (tenant_id)
Foreign-key constraints:
    "subscribers_subscribedToTenantId_fkey" FOREIGN KEY ("subscribedToTenantId") REFERENCES providers(tenant_id)

- list all subscribers to a certain provider:
aMNcSJwcZMbY> select "sub"."instance_id", "subscribedToTenantId" from subscribers sub INNER JOIN providers ON sub."subscribedToTenantId" = providers.tenant_id ;
+--------------------------------------+----------------------------------+
| instance_id                          | subscribedToTenantId             |
|--------------------------------------+----------------------------------|
| 02241b30-8d09-41c2-8207-d3303a6d26a2 | 5e2da03432063d9af2499ebab38d8f57 |
| 02241b30-8d09-41c2-8207-d3303a6d26a2 | 5e2da03432063d9af2499ebab38d8f57 |
| 02241b30-8d09-41c2-8207-d3303a6d26a2 | 5e2da03432063d9af2499ebab38d8f57 |
| 02241b30-8d09-41c2-8207-d3303a6d26a2 | 5e2da03432063d9af2499ebab38d8f57 |
| 02241b30-8d09-41c2-8207-d3303a6d26a2 | 5e2da03432063d9af2499ebab38d8f57 |
+--------------------------------------+----------------------------------+
SELECT 5


                4.6.4.2.2  providers table
aMNcSJwcZMbY> select count(*) from providers
+-------+
| count |
|-------|
| 5     |
+-------+
SELECT 1
Time: 0.086s
aMNcSJwcZMbY> select * from providers
aMNcSJwcZMbY> \d providers
+---------------------+-----------------------------+----------------------------+
| Column              | Type                        | Modifiers                  |
|---------------------+-----------------------------+----------------------------|
| created_at          | timestamp without time zone |  default CURRENT_TIMESTAMP |
| instance_id         | character varying(300)      |  not null                  |
| plan_id             | character varying(300)      |  not null                  |
| identity_zone_id    | character varying(300)      |  not null                  |
| space_id            | character varying(300)      |  not null                  |
| organization_id     | character varying(300)      |  not null                  |
| tenant_id           | character varying(100)      |  not null                  |
| is_product_provider | boolean                     |  not null                  |
+---------------------+-----------------------------+----------------------------+
Indexes:
    "PK_91c8a2d5af835498654b727fb54" PRIMARY KEY, btree (tenant_id)
Referenced by:
    TABLE "global_providers" CONSTRAINT "global_providers_provider_tenant_id_fkey" FOREIGN KEY (provider_tenant_id) REFERENCES providers(tenant_id)
    TABLE "subscribers" CONSTRAINT "subscribers_subscribedToTenantId_fkey" FOREIGN KEY ("subscribedToTenantId") REFERENCES providers(tenant_id)



+----------------------------+--------------------------------------+-------------------------------+--------------------------------------+--------------------------------------+--------------------------------------+----------------------------------+>
| created_at                 | instance_id                          | plan_id                       | identity_zone_id                     | space_id                             | organization_id                      | tenant_id                        |>
|----------------------------+--------------------------------------+-------------------------------+--------------------------------------+--------------------------------------+--------------------------------------+----------------------------------+>
| 2021-12-09 12:30:24.584493 | 5194b57c-623e-4a2e-b02c-7895c586d376 | portal-plan-launchpadi324180p | 65e227fa-3e4d-42e2-84f7-d8e7fb13166e | 27e79f63-1259-4cdc-9d9e-f21396391b55 | c7486965-e5bd-4047-a1a1-79f702a29304 | a1b0e8dc949c443ee1058d58d765cc12 |>
| 2021-12-09 12:30:24.584493 | 2d4e6502-4f94-4e4a-8337-bb9d76f09480 | portal-plan-launchpadi324180p | 65e227fa-3e4d-42e2-84f7-d8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | dfeadc66c4858be18d845388aea28471 |>
| 2021-12-09 12:30:24.584493 | 02241b30-8d09-41c2-8207-d3303a6d26a2 | portal-plan-launchpadi324180p | 65e227fa-3e4d-42e2-84f7-d8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | 5e2da03432063d9af2499ebab38d8f57 |>
| 2021-12-09 12:30:24.584493 | 2891f649-d3b5-49fb-bf78-f114b8673107 | portal-plan-launchpadi324180p | 65e227fa-3e4d-42e2-84f7-d8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | 56d4a03f6c4aa3fb5088fb40a944830d |>
| 2022-06-06 08:11:25.519124 | fb65b61a-9a8e-4f73-8491-31586e7002d9 | portal-plan-launchpadi324180p | 65e227fa-3e4d-42e2-84f7-d8e7fb13166e | 421677ea-b075-4b48-85e1-c4efd629bdb5 | c7486965-e5bd-4047-a1a1-79f702a29304 | 0c71d1a45f32b27ae0de51b727c720f7 |>
+----------------------------+--------------------------------------+-------------------------


------------+--------------------------------------+--------------------------------------+----------------------------------+---------------------+
            | space_id                             | organization_id                      | tenant_id                        | is_product_provider |
------------+--------------------------------------+--------------------------------------+----------------------------------+---------------------|
8e7fb13166e | 27e79f63-1259-4cdc-9d9e-f21396391b55 | c7486965-e5bd-4047-a1a1-79f702a29304 | a1b0e8dc949c443ee1058d58d765cc12 | False               |
8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | dfeadc66c4858be18d845388aea28471 | True                |
8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | 5e2da03432063d9af2499ebab38d8f57 | True                |
8e7fb13166e | 452d27bc-14a3-4589-8881-c9274cac2bc1 | c7486965-e5bd-4047-a1a1-79f702a29304 | 56d4a03f6c4aa3fb5088fb40a944830d | True                |
8e7fb13166e | 421677ea-b075-4b48-85e1-c4efd629bdb5 | c7486965-e5bd-4047-a1a1-79f702a29304 | 0c71d1a45f32b27ae0de51b727c720f7 | False               |
------------+--------------------------------------+--------------------------------------+----------------------------------+---------------------+
                4.6.4.2.3 global_providers
aMNcSJwcZMbY> \d global_providers
+--------------------+-----------------------------+----------------------------+
| Column             | Type                        | Modifiers                  |
|--------------------+-----------------------------+----------------------------|
| created_at         | timestamp without time zone |  default CURRENT_TIMESTAMP |
| instance_id        | character varying(300)      |  not null                  |
| namespace          | character varying(300)      |  not null                  |
| provider_id        | character varying(300)      |  not null                  |
| provider_tenant_id | character varying(300)      |                            |
+--------------------+-----------------------------+----------------------------+
Indexes:
    "PK_9a41d1b8c00291fb88c1d1a587c" PRIMARY KEY, btree (namespace)
Foreign-key constraints:
    "global_providers_provider_tenant_id_fkey" FOREIGN KEY (provider_tenant_id) REFERENCES providers(tenant_id)


                4.6.4.2.4
            4.6.4.3

        4.6.5

    40.7 cdm-store-client , tags: cdm-store-client microservice

        40.7.1 commit flow

            40.7.1.1 update version
CHANGELOG.md

say this is current version
## [1.21.0] - 2020-05-18
 #### Changed.
 - Changed a typo in the relations factory which caused a wrong bug of handler to work for Pages entities
 - Added relations support for Spaces entities inside of Roles entities

add
## [1.22.0] - 2020-05-18
 #### Changed.
 - a change

            40.7.1.2

        40.7.2 frequent cdm-store-client issues

            40.7.2.1 error TS2307: Cannot find module 'cdm-store-client' or its corresponding type declarations.
when building portal-cf-transport-service:
            > tsc -p tsconfig.build.json
src/cdm/cdm.client.service.ts:3:72 - error TS2307: Cannot find module 'cdm-store-client' or its corresponding type declarations.

After updating version.
[i500695@C02X632CJGH6:2020-06-10 18:17:43:~/work/SAP/git/portal-cf-transport-service:]2078$ npm show cdm-store-client version
1.25.0-20200610072804
[i500695@C02X632CJGH6:2020-06-10 18:18:10:~/work/SAP/git/portal-cf-transport-service:]2079$ grep store-client package.json
        "cdm-store-client": "1.25.0-20200610072804"

reason:
/dist was not built before deployment to nexus.
b.c of change to .xmake.cfg.
this line was replaced:
before_publish=build

fix: return line. commit PR (triggers build & deploy to nexus)
then update version in portal-cf-transport-service 
[i500695@C02X632CJGH6:2020-06-11 13:44:03:~/work/SAP/git/portal-cf-transport-service:]2090$ gitd
diff --git a/package.json b/package.json
index 813e042..d036597 100644
--- a/package.json
+++ b/package.json
@@ -37,7 +37,7 @@
-        "cdm-store-client": "1.25.0-20200610072804",
+        "cdm-store-client": "1.25.0-20200611095411",



        40.7.3

    40.8 portal-platform-commons

        40.8.1  git repo
        https://github.wdf.sap.corp/Portal-CF/portal-platform-commons.git

build, run tests: 
~/work/SAP/git/portal-platform-commons:]2021$ mci
...
[INFO] 
[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ portal.platform.commons.cf ---
[INFO] Building jar: /Users/i500695/work/SAP/git/portal-platform-commons/portal.platform.commons.cf/target/portal.platform.commons.cf-1.0.0-SNAPSHOT.jar
[INFO] 
[INFO] --- maven-install-plugin:2.4:install (default-install) @ portal.platform.commons.cf ---
[INFO] Installing /Users/i500695/work/SAP/git/portal-platform-commons/portal.platform.commons.cf/target/portal.platform.commons.cf-1.0.0-SNAPSHOT.jar to /Users/i500695/.m2/repository/com/sap/cloud/portal/portal.platform.commons.cf/1.0.0-SNAPSHOT/portal.platform.commons.cf-1.0.0-SNAPSHOT.jar
[INFO] Installing /Users/i500695/work/SAP/git/portal-platform-commons/portal.platform.commons.cf/pom.xml to /Users/i500695/.m2/repository/com/sap/cloud/portal/portal.platform.commons.cf/1.0.0-SNAPSHOT/portal.platform.commons.cf-1.0.0-SNAPSHOT.pom
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary for portal.platform.commons 1.0.0-SNAPSHOT:
[INFO] 
[INFO] portal.platform.commons ............................ SUCCESS [  0.278 s]
[INFO] portal.platform.commons.api ........................ SUCCESS [  2.314 s]
[INFO] portal.platform.commons.cf ......................... SUCCESS [  5.401 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  8.160 s
[INFO] Finished at: 2020-05-20T10:04:34+03:00


        40.8.2 use portal-platform-commons

            40.8.2.1 update version in portal-cf-provisioning-service

example: I need commons to provide the WORKZONE/LAUNCHPAD instance IDs.
Currently only has getPortalInstanceId() in SecurityUtil.
I suggest to add getWorkzoneInstanceId, getLaunchpadInstanceId so I can use them in provisioning non Apollo data termination flow.
Makes sense 2 u?
 
steps: develop change, add UT, build&test localy, push PR, merge to master. then after build is promoted to nexus, need to update:
<commons.platform.version>1.0.0-20200511100541_d63d6e80ee90e2a60627f7790855da8663c7d016</commons.platform.version>
In the portal-cf-provisioning-service pom.xml.
 
 
        40.8.3
    40.9 tag: portal-cf-transport-service


        40.9.1 Main use cases and architecture

        40.9.2 Unit and Integration tests

            40.9.2.1 transport Integration tests
            test/integration/transport/transport.integration.spec.ts

            40.9.2.2 import Integration tests

import.integration.api.ts

            40.9.2.3 transport integration tests common errors
Create containers for postgres and redis. 
$ docker run --name local-postgres -e POSTGRES_USER=i500695 -e POSTGRES_PASSWORD=Abcd1234 -d -p 5432:5432 postgres:9.6
$ docker run --name local-redis -d -p 6379:6379 redis:4.0

its required to load two containers, pg + redis.
For pg, set env vars for user/pwd/dbname, check file src/config/local.config.ts
ex:
 export PGUSER="i500695" && export PGPWD="Abcd1234" && export PG_DB_NAME="i500695"
[i500695@C02X632CJGH6:2021-03-16 17:49:02:~/work/SAP/git/portal-cf-transport-service:]2039$ echo $PGUSER && echo $PGPWD && echo $PG_DB_NAME 
i500695
Abcd1234
i500695

start containers:
$ docker start local-redis && docker start local-postgres


containers should be up.
[i500695@C02X632CJGH6:2021-03-16 17:04:28:~/work/SAP/git/portal-cf-transport-service:]2020$ docker ps
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS          PORTS                    NAMES
d623d12848f8   redis:4.0      "docker-entrypoint.s…"   5 months ago    Up 30 minutes   0.0.0.0:6379->6379/tcp   local-redis
2cdc03fe0488   postgres:9.6   "docker-entrypoint.s…"   12 months ago   Up 3 hours      0.0.0.0:5432->5432/tcp   local-postgres

oneliner:
 export PGUSER="i500695" && export PGPWD="Abcd1234" && export PG_DB_NAME="i500695" &&  docker start local-redis && docker start local-postgres

                40.9.2.3.1 timeout exceeded
Possible reasons
                    40.9.2.3.1.1 redis keys not deleted

a. connect to redis cli
$ docker exec -it local-redis redis-cli

b. list all keys
127.0.0.1:6379> KEYS *

c. delete all keys
127.0.0.1:6379> FLUSHALL
OK

                40.9.2.3.2 Validation pipe double/mismatch validation
dcm-payload-dto-validation.pipe.ts
call to class-validator validate()  hangs from:
    private async validate(value: any): Promise<void> {
        let errors: any[] = await validate(value);
        if (errors.length > 0) {
            throw new BadRequestException(errors);
        }
    }

When double/mismatch validation. like this wrong code: 
        await this.validate(plainToClass(ContextDto, dcmPayloadDto.dcm.context));
        await this.validate(plainToClass(CallbackDto, dcmPayloadDto.dcm.context));


                40.9.2.3.3

            40.9.2.4
        40.9.3 swagger

            40.9.3.1 Consume, read API
a. load locally
~/work/SAP/git/portal-cf-transport-service:]2052$ npm run start:dev

b. in browser
http://localhost:3000/transport_service/api/exports/

http://localhost:3000/transport_service/api/imports/

http://localhost:3000/transport_service/api/transports/

            40.9.3.2 Build swagger
src/swagger/swagger.service.ts

wired into main.ts

            40.9.3.3

        40.9.4 transport-service help

            40.9.4.1 CIAS Guide: SAP Launchpad Service Integration with SAP S/4HANA
https://help.sap.com/doc/16e48a873c2f4b1587b55e3ffa1bff67/1.0/en-US/6b51f4d55acf42d6a7d4dd5f691014e2.pdf (page 29)
<url:/Users/I500695/work/SAP/documents/launchpad/CIAS Guide SAP Launchpad Service Integration with SAP S4HANA.pdf> 
https://blogs.sap.com/2021/03/26/sap-launchpad-service-understanding-direct-and-tunneled-access/

        40.9.5
    40.10 technical support

        40.10.1 General

        40.10.2 Technical support set log level

apps:
[i500695@C02X632CJGH6:2021-01-11 09:40:45:~:]2001$ cf t
API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.91.0
user:           yosi.izaq@sap.com
org:            launchpad
space:          i055502p
[i500695@C02X632CJGH6:2021-01-11 10:16:37:~:]2002$ cf a | grep techni
portal-cf-technical-support            started           web:1/1     portal-cf-technical-support-launchpadi055502p.cfapps.sap.hana.ondemand.com
portal-cf-technical-support-am         started           web:1/1     portal-service-launchpadi055502p.cfapps.sap.hana.ondemand.com/technical_support
portal-cf-technical-support-ar         started           web:1/1     portal-cf-technical-support-ar-launchpadi055502p.cfapps.sap.hana.ondemand.com


UX: portal-cf-technical-support-launchpadi055502p.cfapps.sap.hana.ondemand.com

portal-cf-technical-support-launchpadi500695p.cfapps.sap.hana.ondemand.com

Logging level 



Get tenantid
 cf ssh portal-cf-transport-service -c "echo \$VCAP_SERVICES" | jq -r  '.xsuaa[0].credentials.tenantid' | pbcopy

Or use alias
$ printTenantId portal-cf-transport-service

Get log level
Sending from: https://portal-cf-technical-support-launchpadi055502p.cfapps.sap.hana.ondemand.com/ 
With my user and Shirly IDZone 

TechnicalSupportController:103 TechnicalSupportController::createDynamicLogDto() parameters: userId: "yosi.izaq@sap.com", tenantId: "e013e90d-245b-4500-acca-cf34f14ea287", instanceId: null, loggingLevel: "debug"

Note SaaS tenant IDs
Hadar: 1ce802a5-1e33-4e9d-968e-6fb3217ce807
Shirly: e013e90d-245b-4500-acca-cf34f14ea287

Set user id + ID zone ID is fine
￼
        40.10.3

    40.11 Developer-Scenario, tags: Developer-Scenario, Apollo, HTML5 providers

        40.11.1 Wikis
Hand-over session 1:        https://wiki.wdf.sap.corp/wiki/display/CPPortals/Developer+scenario+HO+session+1 
Hand-over session 2: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2783055749
(also in my notes)

        40.11.2 Deprecation of old portal deployer API
Release notes with the deprecation announcement was published on January 26th:
https://help.sap.com/whats-new/cf0cb2cb149647329b5d02aa96303f56?Component=Cloud%2520Portal%2520Service&locale=en-US
The deployer application will be deprecated on 31st May, 2023.

Instead of this application, update the launchpad modules to use the GACD (Generic Application Content Deployer) module.

Action: To use the GACD module, add to the modules section of your mta.yaml file the following code: content-endpoint: developer

For example:

- name: <FLP module name>
    type: com.sap.portal.content
    path: <FLP module path>
    requires:
      - name: portal_resources_<MTA ID>    #The content will be deployed to the endpoint defined by this key
        parameters:
           content-target: true
           service-key:
             name: <MTA ID>_html5_repo_host #Will be used to create the service key for content deployment
            config:                         #The service key configs can be defined inline
               content-endpoint: developer

        40.11.3 troubelshooting

            40.11.3.1 Session Time Out guide - to get approve for customer:
https://wiki.one.int.sap/wiki/display/CPPortals/Provided+custom+solutions

            40.11.3.2
    40.12  DTS, tags: DTS, design time service, portal-cf-design-time-service

        40.12.1  background

        40.12.2 general information

        40.12.3 features and PRs

            40.12.3.1  multiple  applications with same IDs
'Customer do not see html5 apps in his content provider'
code: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/blob/master/src/index.js 

app.post('/dts/api/v1/transport/importSaasApprouterApplications', async (req, res) => {})
pr: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/pull/271
diffs:
From b9cf01015b6c2e70055b9bdea2aecb6f2fca09a8 Mon Sep 17 00:00:00 2001
From: i053580 <assaf.klieger@sap.com>
Date: Mon, 21 Jun 2021 21:24:41 +0300
Subject: [PATCH] i053580 - duplicate appIds

---
 CHANGELOG.md |  3 +++
 src/index.js | 14 +++++++++++++-
 2 files changed, 16 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 97c665a3..3ace38d2 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -6,6 +6,9 @@ This project adheres to [Semantic Versioning](http://semver.org/).
 The format is based on [Keep a Changelog](http://keepachangelog.com/).
 
 ## [4.32.0]
+### Changed
+- Changed duplicate appId error, show proper log message and do not fail the sync flow
+
 ### Fixed
 - Using the Cross Navigation if HTML5 URL Apps - fix for BCP 414256/2021
 
diff --git a/src/index.js b/src/index.js
index be6a59a5..bc5656a0 100644
--- a/src/index.js
+++ b/src/index.js
@@ -104,6 +104,11 @@ app.post('/dts/api/v1/transport/importSaasApprouterApplications', async (req, re
     // SaasApprouter Applications "helium" are replicated per subaccount and the snapshots are per subaccount
     if (typeof req?.authInfo?.getAdditionalAuthAttribute === 'function') {
         let loggerCtx = logger.getLoggerCtx(req);
+
+        // Check for duplicate ids in subaccount.
+        let appIds = req.body.appIds;
+        let findDuplicates = appIds.filter((item, index) => appIds.indexOf(item) !== index);
+
         let providerData = {
             loggerCtx: loggerCtx,
             res: res,
@@ -111,7 +116,8 @@ app.post('/dts/api/v1/transport/importSaasApprouterApplications', async (req, re
             instanceId: "SAAS_APPROUTER_HTML5_APP_REPO",
             subdomain: req.authInfo.getAdditionalAuthAttribute('subdomain') || req.body.subdomain,
             appHostIdsStr: req.body.appHostIds,
-            appIds: req.body.appIds,
+            // use only unique app ids
+            appIds: [...new Set(appIds)],
             isSaasApprouter: true,
             isExternalContentProvider: false,
             isSapProvider: false,
@@ -120,6 +126,12 @@ app.post('/dts/api/v1/transport/importSaasApprouterApplications', async (req, re
         };
 
         let cdmProviderData = new CdmProviderData(providerData);
+
+        // add to log duplicate appIds
+        for (let duplicateEntity of findDuplicates) {
+            cdmProviderData.setAppMessagesInErrorsObject(duplicateEntity, "Duplicate \"sap.app/id\", id must be unique in subaccount.", true);
+        }
+
         if (cdmProviderData.isProviderDataInitialized) {
             await ImportService.importSite(loggerCtx, res, cdmProviderData);
         }


            40.12.3.2

        40.12.4
    40.13 git repositories

        40.13.1 k6 testing https://github.wdf.sap.corp/Portal-CF/k6-load-testing, tags: Jawad k6 testing

            40.13.1.1 README.md
<p align="center">
  <a href="" rel="noopener">
 <img src="https://github.wdf.sap.corp/Portal-CF/k6-load-testing/blob/master/assets/k6-launchpad.png?raw=true" alt="K6 load testing with Launchpad"></a>
</p>

<h3 align="center">Launchpad k6 Load Testing</h3>

<div align="center">

[![Build Status](https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/buildStatus/icon?job=k6-load-testing)](https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/24_designtime/job/k6-load-testing/)

</div>

---

<p align="center">
Integrate performance testing with k6 into your Jenkins Pipeline setup. <br>
By integrating performance tests into your CI pipelines, you can catch performance issues earlier and ship
more stable and performant applications to production.
</p>

## 📝 Table of Contents
- [About](#about)
- [Getting Started](#getting_started)
- [Running the tests](#running_tests)
- [Usage](#usage)
- [Future Development](#future_development)
- [High level setup Diagram](#diagram)
- [Built Using](#built_using)
- [Authors](#authors)
- [Acknowledgments](#acknowledgement)
- [References](#references)

## 🧐 About <a name = "about"></a>
### What is k6?
Grafana k6 is an open-source load testing tool that makes performance testing easy and productive for engineering teams. k6 is free, developer-centric, and extensible.

Using k6, you can test the reliability and performance of your systems and catch performance regressions and problems earlier. k6 will help you to build resilient and performant applications that scale.

k6 is developed by Grafana Labs and the community.

### Key features
k6 is packed with features, which you can learn all about in the documentation. Key features include:

- CLI tool with developer-friendly APIs.
- Scripting in JavaScript ES2015/ES6 - with support for local and remote modules
- Checks and Thresholds - for goal-oriented, automation-friendly load testing

## 🏁 Getting Started <a name = "getting_started"></a>
### Prerequisites
- k6 installation guide - https://k6.io/docs/getting-started/installation/
- Docker installation guide - https://docs.docker.com/get-docker/ If you would like to leverage running k6 in docker

```shell
$ git clone git@github.wdf.sap.corp:Portal-CF/k6-load-testing.git
$ cd k6-load-testing
$ npm install
```

## 🔧 Running the tests <a name="running_tests"></a>
### Tests directory structure
`src/tests` directory structure:
```text
<micro_service_name>
├── <suite_name>
    ├── <test_name>.test.js
        └── <inner_suite_name>
            └── <another_test>.test.js
            └── <other_test>.test.js
```

### Run tests using k6 CLI
https://k6.io/docs/getting-started/running-k6/#running-local-tests

### Run tests using Grunt
Under the hood the `grunt k6` task uses the same `k6` command to run the load test scripts, However it also
provides an option to run a test suites.  

#### Grunt Options
```shell
--TEST_SUITE_PATH=<path_to_test_suite_directory> # Path to the tests suite to run.
--TEST_PATH=<path_to_k6_test_script> # Path to the load test file to run.
--K6_OPTIONS=<Custom environment variables> # a custom envoironment variables. e.g --K6_OPTIONS="-e ENV_1=ABC -e ENV_2=XYZ"
--K6_ENV=<K6 ENV variables> # e.g K6_VUS, K6_ITERATIONS etc.. Refer for https://k6.io/docs/using-k6/options/ for more information
--K6_CLOUD # whether to publish results to K6 cloud (make sure you're logged in k6 login cloud -t <auth_token>)
```


## 🚀 Usage <a name="usage"></a>

### pre-defined Environment Variables
```js
__ENV.PORTAL_URL // Portal service URL.
__ENV.USER_TOKEN // user token that can be used for user_token flows.
__ENV.CONSUMER_TENANT_ID // consumer tenant ID.
__ENV.CONSUMER_SUBDOMAIN // consumer subdomain.
__ENV.PRODUCT_INSTANCE_ID // The Portal/Launchpad/WorkZone/WorkZoneHR instance ID.
__ENV.USE_MUENCHHAUSEN_FOR_USER_TOKENS // whether to use MUENCHHAUSEN for simulating user logins.
__ENV.USE_MUENCHHAUSEN_FOR_USER_AUTH_CODES // whether to use MUENCHHAUSEN for generating authorization codes to simulate user logins.
__ENV.APPROUTER_PORTAL_UAA_CREDENTIALS // The approuter's Portal instance UAA credentials.
__ENV.APPROUTER_XSUAA_APP_CREDENTIALS // The approuter's XSUAA application instance credentials.
__ENV.CLIENT_ID // xsuaa broker client ID - used to generate client_credentials token.
__ENV.CLIENT_SECRET // xsuaa broker client secret - used to generate client_credentials token.
__ENV.UAA_URL // xsuaa broker UAA url - used to generate client_credentials token.
__ENV.CLIENT_CRED_TOKEN // client credentials token, if provided token will not be generated as part of the test setup.
__ENV.CONSUMER_APPROUTER_URL // subscribed consumer approuter URL. 
```

### Writing your first test
Please follow filename convention e.g `<test_name>.test.js` and test structure.  
```javascript
import {defaultSetup} from "../../utils/test-default-setup.js"; // Setup default test data
export {handleSummary} from '../../utils/handle-summary.js'; // handles exporting test summary as HTML

const testName = '<your_test_name>';

// 1. init code

export const options = {
    // 2. test options - Options let you configure how k6 behaves during test execution.
};

export function setup() {
    // 3. setup code
    let data = defaultSetup({vus: exec.instance.vusInitialized});
    // 4. add more setup data to data object if needed.
    return data;
}

export default function (data) {
    // 5. VU code
}

export function teardown(data) {
    // 6. teardown code
}

```

## High level setup Diagram <a name="diagram"></a>
<img src="https://github.wdf.sap.corp/Portal-CF/k6-load-testing/blob/master/assets/diagram.png?raw=true" alt="K6 load testing with Launchpad"></a>

## 📝 Future Development <a name = "future_development"></a>
- Integrate with Grafana + InfluxDB
- Improve documentation
- Provide guide for Muenchhausen setup in consumer subaccount.
- Add support for mapping group to role collections - for testing purposes.  
- Enhance Jenkinsfile to obtain variables provided without further implementation in the Jenkinsfile.

## ⛏️ Built Using <a name = "built_using"></a>
- [k6](https://k6.io/) - Load testing framework.
- [Jenkins](https://www.jenkins.io/) - CI/CD, building and running tests.
- [GruntJs](https://gruntjs.com/) - Running tasks.

## ✍️ Authors <a name = "authors"></a>
- [@Jawad Margieh](https://github.wdf.sap.corp/i324180) - Idea, Initial work & Infrastructure

See also the list of [contributors](https://github.wdf.sap.corp/Portal-CF/k6-load-testing/graphs/contributors) who participated in this project.

## 🎉 Acknowledgements <a name = "acknowledgement"></a>
- [@Ariel Tammam](https://github.wdf.sap.corp/i036832) for bringing this to my attention.

## References <a name = "references"></a>
- Awesome K6: https://github.com/grafana/awesome-k6
- Jenkins Job config XML: https://gkeperfpokimon.jaas-gcp.cloud.sap.corp/view/24_designtime/job/k6-load-testing/config.xml
- Muenchhausen documentation: https://muenchhausen.internal.cfapps.sap.hana.ondemand.com/
- Muenchhausen SAML metadata: https://muenchhausen.internal.cfapps.sap.hana.ondemand.com/saml/metadata

            40.13.1.2 k6
beginner guide: https://medium.com/swlh/beginners-guide-to-load-testing-with-k6-85ec614d2f0d
code: https://github.com/grafana/k6/

        40.13.2

    40.14 tags: SAP cloud Connector, SCC

        40.14.1 SAP help Cloud Connector resources
- main help:         https://help.sap.com/docs/CP_CONNECTIVITY/cca91383641e40ffbe03bdc78f00f681/e6c7616abb5710148cfcf3e75d96d596.html 
- custom domain 
https://help.sap.com/docs/CUSTOM_DOMAINS/74af813c7ee2457cb5eddca0cc70a0c1/4414cc43db2d4229b27b232a5590e253.html

https://help.sap.com/docs/CUSTOM_DOMAINS/74af813c7ee2457cb5eddca0cc70a0c1/1c6c729595f144d9a0bec1b4e2ef1299.html
- tunneled access

example customer question:
Some months ago, we counted on your help to guide is in a topic related to SAP Cloud Connector and Content Federation to BTP in Petrobras.
I have a somehow similar case for customer HP in USA, where we are implementing SAP Work Zone and customer wants to consume a Web Application (non-SAP) that is hosted in their internal network and not exposed to the internet.  The main issue is that customer does not want to expose this open to the internet, so the intention would be that only SAP BTP can reach to it, in a tunneled access.
I understand that SAP Cloud Connector can act in both necessities: as a reverse proxy and as a tunneled access where only BTP can consume the internal resources, however since we are not talking about an SAP application on the other end to be consumed, I am not aware of restrictions that SCC could have for this scenario since the application would have to be accessed and rendered inside WZ.
Can you advise on restrictions on such scenario or maybe if that is not your core, do you know someone from SCC or Destination topics?

Jawad: Support for tunneled access was implemented on Nili’s team.
I think Tal / Reuven should have more information about that.
In the meantime, here are some wikis containing more information about TA –
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2823284478
https://wiki.wdf.sap.corp/wiki/display/CPPortals/%5BCustom+domains%5D+Support+custom+domain+for+tunneled+access
https://github.wdf.sap.corp/cFLPIAMTopics/InternalVsExternalAccessPointForCFLP/blob/master/README.md 

- 

        40.14.3

    40.15 cdm-schema, tags: cdm-schema, schema 

        40.15.1 repositories
		
            40.15.1.1 public 

https://github.com/SAP/common-data-model

            40.15.1.2 internal
https://github.wdf.sap.corp/Portal-CF/cdm-schema.git

            40.15.1.3
        40.15.2 README.md
# Common Data Model - JSON Schema

[![Build Status](https://portalcommonci.jaas-gcp.cloud.sap.corp/buildStatus/icon?job=ci-cdm-schema-voter/master)](https://portalcommonci.jaas-gcp.cloud.sap.corp/job/ci-cdm-schema-voter/job/master/)

This repository contains the sources of CDM JSON Schemas and complementary tools.

For CRUD API specification, please refer to [CDM API](https://github.wdf.sap.corp/FLP/cdm-api)


##### Table of Contents

- [Links](#links)
- [Issues](#issues)
- [CLI](#cli)
    - [Validation](#validation)
    - [Validate Options](#validate_options)
    - [Validate Response](#validate_response)
- [Development](#development)
    - [Installation](#installation)
    - [Repo Structure](#repo_structure)
    - [Adding Entities](#adding-entities)
    - [Build](#build)
    - [Local CLI](#local-cli)
    - [Build Artefact](#build_artefact)
    - [Pull Requests](#pull_requests)

## Links

[CDM API](https://github.wdf.sap.corp/FLP/cdm-api)

[Common Data Model 3.0 Architecture Concept](https://wiki.wdf.sap.corp/wiki/display/unifiedshell/CDM+3.0+Architecture+Concept+%28ACD%29+-+Cross+Platform+Architecture)

[AppDescriptor github](https://github.wdf.sap.corp/AppDescriptor/manifest)

## Issues

For reporting issues, please send an email to the following DL: [DL BTP Core AP UE Services IL Team Shany](mailto:DL_5C175AB8F862670109623BBF@global.corp.sap)

## CLI

Command-line interface for working with CDM JSONs.

Note:
An option to install the CLI from npm will be available in the coming weeks.

For now please follow [developer's installation](https://github.wdf.sap.corp/Portal-CF/cdm-schema/tree/refactor_repo#installation)
and use [local CLI](https://github.wdf.sap.corp/Portal-CF/cdm-schema/tree/refactor_repo#local-cli)

### Validation

Validate JSON files against CDM JSON Schema

```
cdm validate [options] [files...]
```

Examples:

Validate a single JSON:
```
cdm validate /path/to/myObject.json
```

Validate multiple JSONs:
```
cdm validate /path/to/dir/catalog_sample.json /path/to/dir/group_sample.json
```

Validate multiple JSONs in the same directory:
```
cdm validate catalog_sample.json group_sample.json --dir /path/to/dir
```

#### Validate Options

```
-d, --dir [dir]  Configuring root folder of JSON files

string
```

```
-s, --schema [schema]  The schema to validate with

enum ["core" | "portal" | "apollo"]
```


#### Validate Response

Example of output for 2 valid jsons:

```
CDM validation results:
#1 valid
#2 valid
```

Example of output for non-valid json (_version is missing):
```
CDM validation results:
#1  (1) data should have required property '_version'
```

## Development


### Installation

Clone code from repository, and install it:

```
git clone git@github.wdf.sap.corp:Portal-CF/cdm-schema.git
```
```
cd cdm-schema
```
```
npm install
```

Run tests:
```
npm test
```


### Repo Structure

[/examples](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/examples) Contains CDM JSON examples

[/resources](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/resources) Contains resources used by cFLP modules

[/raw](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw) Contains raw JSON schemas

[/raw/core](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/core) CDM Core JSON schema

[/raw/portal](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/portal) CDM Portal JSON schema

[/raw/apollo](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/raw/apollo) CDM Apollo JSON schema

[/src](https://github.wdf.sap.corp/Portal-CF/cdm-schema/blob/master/src) Contains sources of build, validation and tests

### Adding Entities

To add a new entity you must follow these steps:
- The entity is added under the root folder 'raw' in the appropriate sub-folder (apollo/core/portal)
- Make sure your new entity is linked to schema.json of the chosen folder (whether directly or through other entities)
- Run the build script and check that the new entity appears in the 'dist' folder
- Keep in mind the following questions:
  - Should the entity be added in the default's folder? (/resources/portal-cdm-templates/)
  - Adding to 'core' & 'portal:
    - Have you added a new entity type? If so, add its name under /(core\portal)/identification.properties.entityType.enum



### Build

A build would transform raw schema into a bundled, de-referenced, minified JSON Schema.

Build artefacts could be found at `/dist/schema/*`.

* Build CDM schemas:

    `npm run build`

* Fetch and bundle AppDescriptor schema :

    `npm run build-app`

* Full build (AppDescriptor + CDM):

    `npm run build-full`


### Local CLI

You can interact with the CLI as mentioned above, but refer to the local schema:

```
./bin/cli validate myObject.json
```

A prerequisite is to build the schema first -> `npm run build`


### Build Artefact

The build artefact resides in [nexus](https://nexussnap.wdf.sap.corp:8443/nexus/#nexus-search;quick~cdm-schema):

* Compiled and minified JSON Schemas for Core, Portal and Apollo
* Resources - skeleton JSONs and default URL Templates
* CLI - enables to validate JSONS against the schemas
* Node.js module for Portal Services

### Pull Requests

Please follow the template for PRs:
```
### Description

<your description> --> information of the change, why/what, links, root cause for bugs, etc...

### Changes

* <change> --> e.g. sap.app/ach pattern now supports parts with length 1
* <change>
* ...

### Implications

<your implications> --> who/what is affected by the change
```

        40.15.3 validate entities

            40.15.3.1 cli


$npm i
$npm run start 
[i500695@WYLQRXL9LQ:2022-08-11 16:55:50:~/git/cdm-schema:]2078$ cdm validate /Users/i500695/git/portal-cf-transport-service//test/integration/transport/mock/content/with_work_space_and_page/1.json
-bash: cdm: command not found
[i500695@WYLQRXL9LQ:2022-08-11 16:56:14:~/git/cdm-schema:]2079$ ./bin/cli validate /Users/i500695/git/portal-cf-transport-service//test/integration/transport/mock/content/with_work_space_and_page/1.json
cmd/cli >> 
CDM validation results:
#1 /Users/i500695/git/portal-cf-transport-service//test/integration/transport/mock/content/with_work_space_and_page/1.json: 	(1) {"message":"Missing identification!! not a CDM entity json"}

[i500695@WYLQRXL9LQ:2022-08-11 16:59:03:~/git/cdm-schema:]2081$ ./bin/cli validate /Users/i500695/git/portal-cf-transport-service//test/utils/resources/viztype-cherrypicked-from-business-app.json 
cmd/cli >> 
CDM validation results:
#1 /Users/i500695/git/portal-cf-transport-service//test/utils/resources/viztype-cherrypicked-from-business-app.json: 	(1) {"keyword":"required","dataPath":".payload","schemaPath":"#/properties/payload/required","params":{"missingProperty":"vizTypeConfig"},"message":"should have required property 'vizTypeConfig'"}


            40.15.3.2 UX
I would like to share with you a validator UI for our schema. It a tool that allows anyone in SAP to validate that a CDM payload complies with the schema..
Gerald added a single index.html file to our repo. This index.html just takes the compiled schema from schema/core/schema.min.json and loads UI5 and the ajv json validator lib from the web.
We just had to enable Github pages for the repo.
Here you can see live how it works: https://github.wdf.sap.corp/pages/Portal-CF/cdm-json-schema/cdm_export_validation

            40.15.3.3
        40.15.4 code structure 

            40.15.4.1 CLI
- /Users/i500695/git/cdm-schema/bin/cli
const cli = require('commander');
...
cli.command('validate [files...]')
    .description('validate json files with JSON Schema of CDM. it will recognize the entity type according to the given content')
    .option('-d, --dir [dir]', 'Configuring root folder of JSON files')
    .option('-s, --schema [schema]', 'The schema to validate with')
    .action(async function (files = [], args = {}) {
        if (args.dir) {
            const filesFromDir = await readDir(args.dir)
                .map((file) => path.join(args.dir, file));
            files = files.concat(filesFromDir);
        }
        if (files.length === 0) {
            return logger.error("Please provide files to validate");
        }
        const jsons = await readJSONs(files);
        try {
            let results = await cdm.validate({ jsons, schema: args.schema });
            logger.log("\nCDM validation results:\n" +
                getFormattedResults(files, results).join("\n") +
                "\n");
        } catch(e) {
            logger.error("error during validation");
            throw e;
        }
    });

- /Users/i500695/git/cdm-schema/src/index.js
const validate = ({ jsons, schema, sync = false }) => {
    if (typeof schema === "string") {
        if (schema === "3.0") { // remaining compatible...
            schema = "core";
        }
    }
    if (sync) {
        return validateEntity({ jsons, schema });
    }
    return validateEntityAsync({ jsons, schema });
};

- /Users/i500695/git/cdm-schema/src/cmd/validate-entity.js
module.exports = function validateEntity({ jsons, schema }) {
    if (!Array.isArray(jsons) && jsons) {
        jsons = [jsons];
    }
    if (typeof schema === "string") {
        schema = readSchema({ sync: true, basePath: "dist", schemaName: schema, ref: "schema.min.json" });
    }
    return jsons.map((obj) => validator.validateCdmEntity(schema, obj));

};

- /Users/i500695/git/cdm-schema/src/validator/validator.js
const Ajv = require('ajv');
const object = require('lodash/object');
const ajv = new Ajv({allErrors: true});
...
// boils down to
    validate(objSchema, obj) {
        const valid = ajv.validate(objSchema, obj);
        return {
            valid: valid,
            errors: ajv.errors || null
        };



            40.15.4.2

        40.15.5 FAQ re. CDM schema

            40.15.5.1 portal schema

                40.15.5.1.1 validation of portal schema entities
CDM store only validates portal schema which excludes payload so payload validation is not done at all

payload is not validated. see:
[i500695@WYLQRXL9LQ:2022-12-13 14:37:44:~/git/cdm-schema/raw/portal:]2201$ grep exclude *
catalog.json:    "exclude": [ "properties.payload" ],
group.json:    "exclude": [ "properties.payload" ],
page.json:    "exclude": [ "properties.payload" ],
role.json:    "exclude": [ "properties.payload" ],
space.json:    "exclude": [ "properties.payload" ],
workpage.json:    "exclude": [ "properties.payload" ],
[i500695@WYLQRXL9LQ:2022-12-13 14:38:44:~/git/cdm-schema/raw/portal:]2203$ grep exclude * | awk '{print $1}' | sed 's/://'
catalog.json
group.json
page.json
role.json
space.json
workpage.json

                40.15.5.1.2

            40.15.5.2 core schema



        40.15.6
    40.16 credential-store, cred-store service, tags: credential-store, cred-store service

        40.16.1 General information

        40.16.2 X509 and Cred-store

            40.16.2.1 certificate renovation

                40.16.2.1.1 Kalman's procedure for Nili's automations 
for the automations the same is required to redeploy when cert. is expired b/c of MTLS binding

workaround:
Kalman: I found out that for xsuaa instance the longest time we can set tokens (for keys and binding) in 3 years (99,999,999 seconds) - link - https://help.sap.com/docs/btp/sap-business-technology-platform/application-security-descriptor-configuration-syntax#:~:text=token%2Dvalidity-,Sets%20the%20token%20lifetime%20in%20seconds%20for%20access%20tokens%20issued%20by%20SAP%20Authorization%20and%20Trust%20Management%20service.%20The%20value%20ranges%20from%20300%20seconds%20to%2099%2C999%2C999%20seconds%2C%20in%20other%20words%2C%20from%205%20minutes%20to%20more%20than%203%20years.,-Default%3A%2043200%20seconds
For creating a binding in seems like the longest time to set is 7 days - link - https://help.sap.com/docs/btp/sap-business-technology-platform/parameters-for-x-509-certificates-managed-by-sap-authorization-and-trust-management-service
But on the other hand it seems like the binding/key is valid as long as the instance certificate is valid - link - https://help.sap.com/docs/btp/sap-business-technology-platform/service-instance-secrets#:~:text=X.509%20secret.-,SAP%20Authorization%20and%20Trust%20Management%20service%20can%20generate%20an%20X.509%20certificate%20for%20you%20or%20you%20can%20provide%20your%20own.%20The%20X.509%20secret%20remains%20valid%20as%20long%20as%20the%20certificate%20itself%20is%20valid.,-Note 
 
I’ll look more into this topic, for now we can extend the validity time of xsuaa instance itself and look more into bindings
 
Binding example:
config:
  credential-type: x509
  x509:
    validity: 7
    validity-type: DAYS
 
Instance example:
parameters:
  path: ./xs-security.json
  service-plan: application
  service: xsuaa
  config:
    oauth2-configuration:
      credential-types: [ "x509" ]
      token-validity: 99999999
            40.16.2.2

        40.16.3
    40.17 SAP message queue, solace, activemq, tags: SAP message queue, tags: SAP message queue

        40.17.1 contacts, links
timur.fichter@sap.com - MQ contact
SAP k8s message-queuing service: https://inventory.services.tools.sap/cp.portal/site#Services-Maintain?sap-ui-app-id-hint=sap.tools.services.inventory.app.services&/Services(ID='SERVICE-319',IsActiveEntity=true)?sap-iapp-state=TASCOFSKPFXLWD6ZBFPOV3YKBXTB4V6AJ6Z0FQMOE

Maintenance notifications DL: BTP INT CDE EM Notifications
Outlook name: DL BTP INT CDE EM Notifications (External) 
https://profiles.wdf.sap.corp/groups/64a653cd2e5bea028e462fc7/users

        40.17.2 Design-Documents
Event-driven messaging With Messaging Queue Service (AMQP 1.0): https://wiki.one.int.sap/wiki/plugins/servlet/mobile#content/view/2604892474
https://sap-btp.slack.com/archives/CSR77JW6T - SAP Messaging Queue Service Slack channel

        40.17.3 Solace FAQ, tags: Solace FAQ

            40.17.3.1 how to perform certificate rotation for the solace without the devops job, tags: how to perform certificate rotation for the solace without the devops job
$ cf unbind-service portal-cf-provider-service portal-message-queuing
$ cf bind-service portal-cf-cdm-store-service-blue portal-message-queuing -c '{"certificate":true,"xsuaa":{"credential-type":"x509","x509":{"key-length":2048,"validity":365,"validity-type":"DAYS"}}}'

            40.17.3.2
        40.17.4 XSUAA , tags: XSUAA 

            40.17.4.1 XSUAA FAQ, tags: XSUAA FAQ

                40.17.4.1.1  max issued certificate validity performing
1 year. see documentation: https://sap.github.io/cloud-sdk/docs/java/features/connectivity/mtls#:~:text=By%20default%20XSUAA%20managed%20certificates,fail%20after%20your%20certificate%20expires.

            40.17.4.2

        40.17.5
    40.18 Content Provider Types in our product, tags: Content Provider Types in our product

        40.18.1 HTML5 apps content provider (aka saas approuter)
Similar to apollo, without approuter
Called uppon sync of content provider → DTS
Does not have any destination
All apps run in an iframe with special url template to run in the same cflp domani
[Launchpad/Workzone] - Approuter as a Service "helium like" consumption


        40.18.2 Apollo Content provider (aka CF content provider aka Apollo bluebox)
The first content provider (=apollo bluebox).
This an apollo solution which contains approuter, cdm-deployer and some uis.
Can be exposed either by federation or manually:
federation =  adding saas-registry to provide to expose it ,subscribe to it in the cockpit ,then cherry pick apps. ,
Manul -  creating urls directly to apollo. (and making sure they can run in an iframe)
Does not have any destination
All apps run in an iframe.
Example: Any of our test apollo site which can be exposed also to CFLP - https://testcontent-lkgtestcontentdonotdelete-testcontent-ar.cfapps.sap.hana.ondemand.com/cp.portal/site#Shell-home

        40.18.3 External content provider
Content provider which is developed outside CF, not deployed in CF at all. 
It is accessed via destination to collect the snapshots and also to access the actual data.
All apps run in an iframe.
Example: S4 


        40.18.4 Embedded content provider
a 'hidden' Out Of The Box Apollo content provider , deployed in the owners' space with few differences:
doesn't require customer to subscribe or do action to get it
Doesnt have an approuter
apps run embedded and not in frame
All roles within are cherry picked and added to site.
Automatically provided for all customers, for all sites. → currently its only for workzone.
For workzone currently its registered when customer subscribes to workzone
It imitates a business service deployed in portal space ,and so apps runs embedded.
Example: workflow



        40.18.5 Workzone Local content provider 
Contains workzone plugins and url apps, automatically added to any workzone site

Quite similar to the embedded content provider with few differences:

Uses the workzone portal instance
Doesnt have saas-registry  ,but provides details of provider through env variables
Have some specific code in the workzone-provisioning-service


        40.18.6 Hosted content provider 
Content provider which is deployed totally in portal space.
Contains ONLY static resources and no server side components.
Deployed using an mtar downloaded from nexus
First stage not generice and 2 types;
html5 resources provider
static ui5 resources only → not really a content provider, but yet another static resources deployer
Example: User Default

        40.18.7 global vizTypes provider 
static ui5 resources + cdm viztypes → similar to the local workzone content provider with differences
It has no roles and no content , besides vizTypes
More known as global content provider
the registration of this provider can be done any time, unrelated to workzone subscription and enable the exposed vizTypes to be used by any other provider.
Example: SMB



        40.18.8 OOTB Plugins
OOTB plugins are loaded either hardcoded in code, or via local content provider.

releavnt git repo: https://github.wdf.sap.corp/Portal-CF/portal-cf-static-resources/blob/ddb420e95b6323e4c7d1cb7d2da1737a7d6fbfbe/src/lib/ProxyService.js#L5

        40.18.9 Hardcoded in code:
xRay - used in apollo, loaded through destination from external location
coPilot - used in apollo, loaded through destination from external location
webAssistant - cFLP  ,loaded through dynamic destination from external location
Theme Manager - apollo + cflp - our OOTB code reside in our static resources.
Domain Access List Service - cflp - our OOTB code reside in static resources, handles cwhitelist maintained by key user
Enterprise Portal  - CFLP - oour OOTB code reside in static resources, handles EP session termination 
Plugins from workzone local content provider:
all workzone related plugins - https://github.wdf.sap.corp/Portal-CF/workzone-content-provider/tree/master/src/plugins/sap/workzonePlugins


        40.18.10
    40.19 CF services processes 

        40.19.1 deprecation, out of commission, retire service, tags:deprecation, out of commission, retire service

            40.19.1.1 Productive services deprecation process, shany, old GraphQL service,tags: Productive services deprecation process, shany, old GraphQL service, 
 
This sprint we completed the deprecation of the old cep services - Old GraphQL services deprecation
This is the first time we deprecating services that were already productive in live so I thought it will be good to share it with you in case you need do the same thing in the future 😊
Inside the BLI you will be able to see all the subtasks that were needed for the deprecation process after consulting with OPS & Devops & Boris as the security lead.
 
Description
Motivation:
New graphQL services were created for GA.
The old graphQL services were used for the Beta but are not in use anymore for CEP.
We should not maintain the old services anymore.

Scope:
List of services to deprecate:
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-gateway
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-runtime
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-core
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-database-client
Remove the old services from the security scan - contact Lipmanovich, Boris
Delete old services E2E automation specs, jobs & tests consumers + remove from the automation dashboard + update Team E2E Wiki
remove it from deployment pipeline & code split - contact Devops & OPS team
Move old services to archive (contact Frishberg Barak, Oren) + update Shany's Team Repositories Wiki
Sub-Tasks

Options
Remove the old services from the security scan - contact Boris	Task	DONE	
Delete old services E2E automation specs	Task	DONE	
Delete old services E2E automation CI jobs	Task	DONE	
Delete automtion tests comsumers	Task	DONE	
Remove automations + CI master from dashboard	Task	DONE	
 Update the team E2E wiki	Task	DONE	
Remove it from deployment pipeline & code split - contact Devops & OPS	Task	DONE	
Move old services to archive - contact Oren	Task	DONE	
Update Shany's Team Repositories Wiki	Task	DONE	
Update CF Application and Owners wiki	Task	DONE	
Delete services from LTS	Task	DONE	
Delete services from all other RC & Live landscapes	Task	DONE	

I349209
Shefer, Shany added a comment - 03/Jul/23 11:05 AM
The applications were manually removed from lts (eu10) by Devops.
Oren stopped the code split for these applications and stop their deployment to the master landscapes.
Devops team is not archiving the github repositories since they are still active for rc and live.
The deletion from all the other landscapes will be done by Devops & OPS by a new removal job that is in development by Devops team - https://jira.tools.sap/browse/EUXDEVOPS-2791


I349209
Shefer, Shany added a comment - 03/Jul/23 12:37 PM
PRs for deleting automation jobs:

https://github.wdf.sap.corp/Portal-CF/e2e-jjb/pull/96/files
https://github.wdf.sap.corp/Portal-CF/e2e-jjb/pull/98/files


I349209
Shefer, Shany added a comment - 25/Jul/23 3:02 PM
All blocked tasks will be done once the old service will be deleted in Live.
this is planned for month after the GA.



I349209
Shefer, Shany added a comment - 24/Aug/23 2:54 PM
Wimmer, Boaz  - were the old services deleted from live?



I309025
Wimmer, Boaz added a comment - 24/Aug/23 6:46 PM
Hi Shefer, Shany this task is managed in https://jira.tools.sap/browse/EUXDEVOPS-3391, but wasn't completed yet, because of other priorities. We will handle it next week.



I349209
Shefer, Shany added a comment - 27/Aug/23 6:06 PM
https://jira.tools.sap/browse/EUXDEVOPS-3391 - cleanup old graphql apps was completed by OPS.

Solomon, Sivan - this is not part of the signoff but we can add it in the review of 9A.


            40.19.1.2

        40.19.2


    40.20 CF components products  and plans, tags: CF components products and plans 

        40.20.1 07/09/23 15:54:08  products and plans list
As you probably know the official supported plans for SAP Build Work Zone are the following:

Portal:
standard
SAP Build Work Zone, standard edition:
standard
free
foundation – 
    SAP Start 
    SAP Start  WZ 
 
SAP Build Work Zone, advanced edition:
standard
advanced

products configuration is retained in UPS portal-cf-general-cofiguration
in sub json, e.g.
        "clpInstanceId": "2891f649-d3b5-49fb-bf78-f114b8673107",
        "launchpadInstanceId": "02241b30-8d09-41c2-8207-d3303a6d26a2",
        "portalInstanceId": "2891f649-d3b5-49fb-bf78-f114b8673107",
        "workzoneInstanceId": "2d4e6502-4f94-4e4a-8337-bb9d76f09480"
Note that WZ and WZHR share same instanceId, workzoneInstanceId, they have different ARs pre NG-AR 
        40.20.2

    40.21 CF setups common issues, certificates, credentials, tags: CF setups common issues,  certificates, credentials, 

        40.21.1 


    40.22 SAP mobile start, tags: SAP mobile start


        40.22.1  SAP mobile start help, tags: SAP mobile start help
https://help.sap.com/docs/mobile-start

        40.22.2 SAP mobile start Architecture, tags: SAP mobile start Architecture

        40.22.3 SAP mobile start  integration to workzone, tags: SAP mobile start  integration to workzone

            40.22.3.1   SAP mobile start  integration to workzone - known issues, tags: SAP mobile start  integration to workzone - known issues

                40.22.3.1.1    Navigation to URL app now working, tags: Navigation to URL app now working
see email: "SAP Mobile Start & Build Apps"

                40.22.3.1.2

            40.22.3.2

        40.22.4 
    40.23
41. placeholder 

5. Operations

    5.1 Migration from Cred Store to CUPS
Get this guid: cf service portal-service-default-instance --guid
Run the fallowing command
WIN:  cf update-user-provided-service portal-cf-general-configuration -p "{\"tag\":\"portal-url-config\",\"clpInstanceId\":\"<guid>\",\"portalServiceUrl\":\"https://portal-service-<space>-<iuser>.cfapps.sap.hana.ondemand.com\", \"maasSalt\":\"SOME_SALT\"}"
MAC: cf update-user-provided-service portal-cf-general-configuration -p "{\"tag\": \"portal-url-config\", \"clpInstanceId\": \"<guid>\", \"portalServiceUrl\": \"https://portal-service-<space>-<iuser>.cfapps.sap.hana.ondemand.com\", \"maasSalt\":\"SOME_SALT\" }"
cf restage portal-cf-site-semantic-service

ex:
700  cf service portal-service-default-instance --guid
  701  cf update-user-provided-service portal-cf-general-configuration -p "{\"tag\": \"portal-url-config\", \"clpInstanceId\": \"<bd3db024-6c95-407a-b75e-643a9fdb58e8>\", \"portalServiceUrl\": \"https://portal-service-yosi01-i500695.cfapps.sap.hana.ondemand.com\", \"maasSalt\":\"SOME_SALT\" }"
  702  cf restage portal-cf-site-semantic-service


    5.2 create dev space concurse

instructions: https://github.infra.hana.ondemand.com/Portal/landscape-aws-canary-developers/blob/master/README.md#prerequisites-one-time-only

        5.2.1  intro

            5.2.1.1  devops presentation

Key messages:
Testing the deployment as part of the CI  - deployment failure will cause the artifact not to be release
One manifest for all (manifest-concourse.yml) no double maintenance
Init environment – follow this guidelines:
https://github.infra.hana.ondemand.com/Portal/landscape-aws-canary-developers
(I can't login)

In this week we extending our support for init environment in order to allow you easy on boarding
Windows users – we are still looking for a solution. SAP IT just removed us from the recommended way of iac colleagues so we are escalating
 
Here you can find the presentation:
https://sap.sharepoint.com/:p:/t/CloudPortalDevOps/EQ5zCng68ZFLu5KhiRYz4CQBTKgI2uOYJo9dTq4Kvm128A?e=QBKPyc
 
            5.2.1.2 slack channel, #prtl-init-env

            5.2.1.3 request git permissions
From: "Neiderman, Erez" <erez.neiderman@sap.com>
Date: Thursday, 20 February 2020 at 11:30
To: DL CP Services Portals All <DL_IMS_NETWEAVER_IL@exchange.sap.corp>, DL CP DWP Portals DevOps <DL_5B5894787BCF84E069000032@global.corp.sap>, DL CP DWP Portals DevOps - Cloud CI <DL_5982358F7BCF84BF9E000D1A@global.corp.sap>
Subject: New init-env is coming...
 
Hi all,
 
We need all of you to request access to GitHub.infra domain in order to be able to use the new init-env.
This GitHub hosts the repository you will need to clone in order to run the init-env.
 
Steps:
Go to https://github.infra.hana.ondemand.com/ and check if you already have a user by trying to sign in (most probably you don’t have).
At the bottom of this page, you will find a “support” link – click on it and it will create a Jira ticket for you.
In the description write: 
“Hello, 
I need a user to access GitHub.infra in order to work on some existing projects. I am aware that this domain will soon be shut down and migrated to another GitHub domain, but I still need access at the moment.
Best regards!
Yosi”
Soon after you create the ticket, you will get an email with a link to create your password.
"
Hello there!



Someone has created an account for you on a GitHub Enterprise installation.



  Username: I500695

  Email: yosi.izaq@sap.com



Please use the following link to set your password:
"

Once you have successfully signed in, send @DL CP DWP Portals DevOps - Cloud CI an email and will add your user to the our GitHub “Developers” team.
 
Let me know if you have any issues,

            5.2.1.4 create space instructions
            # landscape-aws-canary-developers

## Table of Contents  
* [How to create your Init-Env pipeline](README.md#how-to-create-your-init-env-pipeline)
    * [Prerequisites - one time only](README.md#prerequisites-one-time-only)    
    * [Init environment execution](README.md#Init-environment-execution)
        * [READ BEFORE EXECUTION](README.md#READ-BEFORE-EXECUTION)
        * [Create pipeline scenario](README.md#Create-pipeline-scenario)
        * [Update pipeline scenario](README.md#Update-pipeline-scenario)
        * [Delete pipeline scenario](README.md#Delete-pipeline-scenario)  
* [Update/Deploy only one application](README.md#UpdateDeploy-only-one-application)  
* [Testing your manifest and pre/post python scripts](README.md#testing-your-manifest-and-prepost-python-scripts)
* [How to prepare your manifest for local deployment](README.md#Advanced-How-to-prepare-your-manifest-for-local-deployment)
    * [Prerequisites](README.md#prerequisites)
    * [Prepare your environment](README.md#prepare-your-environment)
    * [Spiff merge command](README.md#spiff-merge-command)
    * [Spiff Documentation](README.md#Spiff-documentation)  


# How to create your Init-Env pipeline

                5.2.1.4.1 ## Prerequisites-one time only
* make sure you have access to https://github.tools.sap/portal

### Mac OS and Linux users
* Install [Docker](https://www.docker.com/products/docker-desktop)
* Install [yq](https://mikefarah.gitbook.io/yq/#install)
brew install yq

                5.2.1.4.2 iacbox
* Install [iacbox script](https://github.tools.sap/cloudfoundry/iacbox#use-released-version)
a. get script - https://github.tools.sap/cloudfoundry/iacbox/blob/master/script/iacbox-curl
pwd  
/Users/i500695/work/SAP/tools/iac

SAP/tools/iac                                                                                                                                         
▶ cat iacbox-curl
#!/usr/bin/env bash
set -e

if [ -z "${GITHUB_TOOLS_TOKEN}" ]; then
  echo "GITHUB_TOOLS_TOKEN is not set"
  exit 1
fi

#
# Runs the latest iacbox script from https://github.tools.sap/cloudfoundry/iacbox
#
# Use --help to view the available options
#
# DISCLAIMER
# This script may not work in case GitHub is down. If you want to use an offline version of
# the iacbox script, please downlod it from
# https://github.tools.sap/cloudfoundry/iacbox/releases
#

GIT_API_URL="https://${GITHUB_TOOLS_TOKEN}@github.tools.sap/api/v3"
GIT_REPO="cloudfoundry/iacbox"

bash <(curl -s -L "${GIT_API_URL}/repos/${GIT_REPO}/contents/script/iacbox" | jq -r '.content' | base64 -d) "$@"

# Get lastest release. Requires jq to be installed
#
# URL=$(curl "https://$GITHUB_TOOLS_TOKEN@github.tools.sap/api/v3/repos/cloudfoundry/iacbox/releases/latest" | jq -r '.assets[] | select(.name=="iacbox") | .url')
# bash <(curl -L -s -H "Authorization: token ${GITHUB_TOOLS_TOKEN}" -H "Accept: application/octet-stream" "$URL") "$@"


b. for access token. go to https://github.tools.sap/settings/tokens
Developer-Settings -> Personal-access-token -> select all scopes. in note wrote "personal access"
copy token.
 export GITHUB_TOOLS_TOKEN=1a2a604b725df05011a1a2a60ec00ffc18ceb91a

c. use brew 4 latest version...
export HOMEBREW_GITHUB_API_TOKEN=<your token from github.tools.sap>
export HOMEBREW_GITHUB_API_TOKEN=1a2a604b725df05011a1a2a60ec00ffc18ceb91a
brew tap cloudfoundry/cp-core https://github.infra.hana.ondemand.com/cloudfoundry/homebrew-cp-core.git
brew install iacbox

note, to update iacbox version:
export HOMEBREW_GITHUB_API_TOKEN=<your token from github.tools.sap>
brew update
brew upgrade iacbox

* Run these commands to get latest version of [openssl](https://www.openssl.org/source/) installed and accessible from cli
###
    brew update
    brew install openssl
    
    # to make openssl accessible from your PATH copy command from brew install openssl output
    # it should be something like this: echo ‘export PATH=“/usr/local/opt/openssl@1.1/bin:$PATH”’ >> ~/.bash_profile
    source ~/.bash_profile

 NOTE: 
 - In case your terminal is not bash_profile.. it can be .zshrc or other tool.. 
 - Please update the relevant file in your tool respectively

    

                5.2.1.4.3 ## Init environment execution

### READ BEFORE EXECUTION 
During script execution:
* When prompted:
  * login to concourse using the url given in console output.
  https://centralconcourse.cfops.eu1.sapxdc.io/login?fly_port=55491

  * choose apps you want to deploy (use SPACE to select, arrows up/down to go over the apps list, ENTER to continue).
  * enter space admin user: **\<your user ID\>** (i-user)
  * enter space admin user password: **\<your password\>** (your computer password)
  * re-enter space admin user password for avoiding mistakes: **\<your password\>**
* When script finished navigate to https://centralconcourse.cfops.eu1.sapxdc.io/teams/PORTAL_INTERNAL/pipelines/<developer-branch/space-name> and check the deployment status.

## Create pipeline scenario
- For helping information: ```./init-env --help```

### Clone this repository:
    git clone --recursive https://github.infra.hana.ondemand.com/Portal/landscape-aws-canary-developers.git
    my path: ~/work/SAP/git/landscape-aws-canary-developers

### To execute init environment script run the following commands:
    cd landscape-aws-canary-developers
    ./init_env.sh --prod <optional: product branch/tag> --space <space-name> --org <org-name>
    ex: default to master branch 
    ./init_env.sh --space yosib4 --org backbone 

    workaround LibreSSL version check
    $ sed -ie 's/OpenSSL/SSL/' utils.sh &&    ./init_env.sh --space yosib4 --org backbone 

if asked this:
navigate to the following URL in your browser:

  https://centralconcourse.cfops.eu1.sapxdc.io/login?fly_port=49162

put 
Bearer 1a2a604b725df05011a1a2a60ec00ffc18ceb91a

And make sure token is exported in rc files
▶ grep HOMEBREW_GITHUB_API_TOKEN ~/.bashrc ~/.zshrc
/Users/i500695/.bashrc:export HOMEBREW_GITHUB_API_TOKEN=1a2a604b725df05011a1a2a60ec00ffc18ceb91a
/Users/i500695/.zshrc:export HOMEBREW_GITHUB_API_TOKEN=1a2a604b725df05011a1a2a60ec00ffc18ceb91a

 export GITHUB_TOOLS_TOKEN=1a2a604b725df05011a1a2a60ec00ffc18ceb91a

When asked:
“? Enter the admin username for portal organization”
i500695
<my pwd>

Then, when prompted login to 
https://centralconcourse.cfops.eu1.sapxdc.io/login?fly_port=56207
use github method.

#### Arguments
| 1. `--prod`: must be valid **branch** or release **tag**, if not provided, default is **master**
|     * valid branches: **master**, **rc** or **live**
|     * valid rel tag format: **rel/version-timestamp+commit**
| 2. `--org`: should contain only **letters**, **numbers** and **-**
| 3. `--space`: if space already exist it will be updated

Note. success message:
pipeline created!
you can view your pipeline here: https://centralconcourse.cfops.eu1.sapxdc.io/teams/PORTAL_INTERNAL/pipelines/backbone-yosib4-20200323102559

the pipeline is currently paused. to unpause, either:
  - run the unpause-pipeline command:
    ./fly -t ci unpause-pipeline -p backbone-yosib4-20200323102559
  - click play next to the pipeline in the web ui
---> unpause concourse pipeline
unpaused 'backbone-yosib4-20200323102559'
M	products/product-cf-portal
Switched to branch 'master'
Your branch is up to date with 'origin/master'.

*********************************************************************************************************************************

To check deployment status navigate here:

    -------->   https://centralconcourse.cfops.eu1.sapxdc.io/teams/PORTAL_INTERNAL/pipelines/backbone-yosib4-20200323102559


## Update pipeline scenario
- For helping information: ```./init-env --help```    
    
### To execute init environment script run the following commands:
    cd landscape-aws-canary-developers
    ./init_env.sh --prod <optional: product branch/tag> --space <space-name> --org <org-name> --ls <landscape developer branch name>

#### Arguments
- `--ls`: 
    * To update existing environment, execute **init_env.sh** script and provide your **landscape developer branch name** (including the timestamp).

# Delete pipeline scenario
'dev_cleanup.sh' is a script to delete your concourse pipeline and your branches in this landscape repository( local and remote ) 
    
    ./dev_cleanup.sh <your-pipeline-name>
 
 for example:
    
    ./dev_cleanup.sh flpci-test-20200223230641


# Update/Deploy only one application

For updating a specific application on an existing space that was created by the init-env.sh script

## Mac OS and Linux users
       
    cd <landscape-folder>
    git checkout <your branch - was created by the init-env.sh script, should be org-space-timestamp>
    iacbox -it -iv=weberstephanhd/iacbox2:v284 - starts the iacbox docker
    git config --global user.name <i-user>
    git config --global user.email <email>
    git config --global credential.username <i-user>
    git config --global credential.helper store
    cd products/product-cf-portal
    git pull origin <master/rc/live/rel tag> - gets the latests artifact version available in nexus
    iac -d <app name> lifecycle deploy - starts the deployment process

## Windows users    

Please use Git Bash for running the following commands
### Perquisites
- Install [Docker](https://www.docker.com/products/docker-desktop) for windows

### Commands

    winpty docker.exe run --rm -it weberstephanhd/iacbox2:v284
    git clone --recursive https://github.infra.hana.ondemand.com/Portal/landscape-aws-canary-developers.git
    cd landscape-aws-canary-developers
    git config --global user.name <i-user>
    git config --global user.email <email>
    git config --global credential.username <i-user>
    git config --global credential.helper store
    git checkout <your branch - was created by the init-env.sh script, should be org-space-timestamp>
    cd products/product-cf-portal
    git pull origin <master/rc/live/rel tag> - gets the latests artifact version available in nexus
    iac -d <app name> lifecycle deploy - starts the deployment process
    
# Testing your manifest and pre/post python scripts

## Mac OS and Linux users

All manifests and python scripts for each application are found in "landscape-aws-canary-developers/products/product-cf-portal/deployments"

    cd <landscape-folder>
    git checkout <your branch - was created by the init-env.sh script, should be org-space-timestamp>
    
it is recommended to create another branch from this branch, not a must

    iacbox -it -iv=weberstephanhd/iacbox2:v284 - starts the iacbox docker
    git config --global user.name <i-user>
    git config --global user.email <email>
    git config --global credential.username <i-user>
    git config --global credential.helper store
    cd products/product-cf-portal
    git pull origin <master/rc/live/rel tag> - gets the latests artifact version available in nexus
    
Do all you coding\changes in your favorite code editor (all changes are automatically synced to the iacbox docker) and then run:

    iac -d <app name> lifecycle deploy - starts the deployment process with your changes

Once you have finished your development\testing, you should push your changes to the original repository of the application in  github.wdf and not to the landscape repository.
If you have created a new branch for this development, it is best to delete it

## Windows users    

All manifests and python scripts for each application are found in "landscape-aws-canary-developers/products/product-cf-portal/deployments"

    winpty docker.exe run --rm -it weberstephanhd/iacbox2:v284
    git clone --recursive https://github.infra.hana.ondemand.com/Portal/landscape-aws-canary-developers.git
    git config --global user.name <i-user>
    git config --global user.email <email>
    git config --global credential.username <i-user>
    git config --global credential.helper store
    cd landscape-aws-canary-developers
    git checkout <your branch - was created by the init-env.sh script, should be org-space-timestamp>
    
it is recommended to create another branch from this branch, not a must

    cd products/product-cf-portal
    git pull origin <master/rc/live/rel tag> - gets the latests artifact version available in nexus
    
Do all you coding\changes in your favorite code editor and then run:

    iac -d <app name> lifecycle deploy - starts the deployment process with your changes

Once you have finished your development\testing, you should push your changes to the original repository of the application in **github.wdf** and not to the landscape repository.
If you have created a new branch for this development, it is best to delete it

# Advanced How to prepare your manifest for local deployment

## Prerequisites
Option 1:   
* Install spiff++: spiff is a command line tool and declarative in-domain hybrid YAML templating system
    |1. please download https://github.com/mandelsoft/spiff/releases spiff++ version 1.4v and above by your operating system
    |2. after extract spiff, you may add it to you path env

Option 2:
* using iacbox docker container:
    * MacOs:  run  ```iacbox -it -iv=weberstephanhd/iacbox2:v284```
    * Windows:
       | 1. open Git Bash  
       | 2. run ```winpty docker.exe run --rm -v <path//to//directory//to//mount>:<//copy-directory-in-container> -it weberstephanhd/iacbox2:v284```
       | 3. for example: ```winpty docker.exe run --rm -v //c//Users//i502728//git://git -it weberstephanhd/iacbox2:v284``` - will share the 'git' directory with the container
        

        
           
## Prepare your environment

### Comment first line of the manifest:
    
    # context: (( &temporary ( merge ) ))
    
don't forget to uncomment when you finish with testing.
### Edit environment variables:

Supported values:

* \<manifest-type\> : 
    | 1. **'dev'** in case you would like to use manifest-dev.yml
    | 2. **'canary'** in case you would like to use manifest.yml

* \<type\> :  by default **'aws'**, in case you need to test ibm environment, value is **'ibm'**

```
    export HOST_SUFFIX='<space-scope>'
    
    export DOMAIN='cfapps.sap.hana.ondemand.com'
    
    export LANDSCAPE_ENVIRONMENT='<manifest-type>'
   
    export LANDSCAPE_TYPE='<type>'
```

**NOTE!**
Your manifest may contains more than the values above, please export these values also in order to preventing spiff failures.

### Spiff merge command: 

    spiff merge <manifest> > '<manifest-result>'

The result is new manifest file.

## Spiff Documentation
    
https://github.com/mandelsoft/spiff

            5.2.1.5
        5.2.2

    5.3

6. Authentication and authorization

    6.1  XS UAA

        6.1.1  https://github.wdf.sap.corp/xs2/node-xs2sec#usage-of-the-xs-advanced-container-security-api-in-your-nodejs-application
In order to use the capabilities of the XS Advanced container security API, add the module "sap-xssec" to the dependencies section of your application's package.json.

To enable tracing, you can set the environment variable DEBUG as follows: DEBUG=xssec:*.

        6.1.2
    6.2

7. technical resources

    7.1 https://stackoverflow.com/questions/tagged/sap-cloud-sdk


    7.2

8. security

    8.1 security checks on source code

        8.1.1 Vulas

            8.1.1.1 problem description
during jaas build of master/rc etc
ex:
https://gkeportalcf.jaas-gcp.cloud.sap.corp/job/portal-cf-provisioning-service/job/master/
click 'vulas report'
critical must be fixed.
Exempted optionally.

            8.1.1.2 Fix process
read CVE and repo of effected version.
identify fix version and upgrade version

cli for dependencies report:
mvn dependency:tree > ~/st
snip:
[INFO] com.sap.cloud.cf.portal:provisioning-service:jar:1.37.0-SNAPSHOT
[INFO] +- org.springframework:spring-web:jar:5.1.12.RELEASE:compile
[INFO] |  +- org.springframework:spring-beans:jar:5.1.12.RELEASE:compile
[INFO] |  \- org.springframework:spring-core:jar:5.1.12.RELEASE:compile
[INFO] |     \- org.springframework:spring-jcl:jar:5.1.12.RELEASE:compile
[INFO] +- org.springframework.boot:spring-boot-starter-web:jar:2.1.11.RELEASE:compile
[INFO] |  +- org.springframework.boot:spring-boot-starter:jar:2.1.11.RELEASE:compile
[INFO] |  |  +- org.springframework.boot:spring-boot-autoconfigure:jar:2.1.11.RELEASE:compile
[INFO] |  |  +- org.springframework.boot:spring-boot-starter-logging:jar:2.1.11.RELEASE:compile
[INFO] |  |  |  +- org.apache.logging.log4j:log4j-to-slf4j:jar:2.11.2:compile
[INFO] |  |  |  |  \- org.apache.logging.log4j:log4j-api:jar:2.11.2:compile
[INFO] |  |  |  \- org.slf4j:jul-to-slf4j:jar:1.7.29:compile
[INFO] |  |  +- javax.annotation:javax.annotation-api:jar:1.3.2:compile
[INFO] |  |  \- org.yaml:snakeyaml:jar:1.23:runtime
[INFO] |  +- org.springframework.boot:spring-boot-starter-json:jar:2.1.11.RELEASE:compile
[INFO] |  |  +- com.fasterxml.jackson.datatype:jackson-datatype-jdk8:jar:2.9.10:compile
[INFO] |  |  +- com.fasterxml.jackson.datatype:jackson-datatype-jsr310:jar:2.9.10:compile
[INFO] |  |  \- com.fasterxml.jackson.module:jackson-module-parameter-names:jar:2.9.10:compile
[INFO] |  +- org.springframework.boot:spring-boot-starter-tomcat:jar:2.1.11.RELEASE:compile
[INFO] |  |  +- org.apache.tomcat.embed:tomcat-embed-core:jar:9.0.30:compile
[INFO] |  |  +- org.apache.tomcat.embed:tomcat-embed-el:jar:9.0.29:compile
[INFO] |  |  \- org.apache.tomcat.embed:tomcat-embed-websocket:jar:9.0.29:compile


            8.1.1.3
        8.1.2 PPMS

            8.1.2.1 problem description
during jaas build of master/rc etc

            8.1.2.2 request permission    
tracking wiki:      https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?spaceKey=CPPortals&title=Free+Open+Source+%28FOSS%29+Process
actual permission request tool: https://open-source.mo.sap.corp/
It will generate an email to Diskin, Julia <julia.diskin@sap.com>, Eini, Niv <niv.eini@sap.com>
ex:
Hello PPMS SCV Entry Owner Julia Diskin,

I want to use FOSS Spring Boot 2.1.13.RELEASE (Code Center ID: 17955685, licence: Apache License 2.0) in SCV FLP CLOUD CF V2 (FLP_CLOUD_CF 2.0). Please maintain the FOSS as a comprised component of the SCV in PPMS.

If you get multiple requests to maintain different FOSS for the same SCV you can use the PPMS function "Adopt from Open Source Tool". It enables the transfer of all FOSS requested for one SCV.

Best regards,
Saar Dagan (I060224)

This request was sent via the Open Source Tool.


Technical Details

FOSS Component Name:	Spring Boot
FOSS Component Version:	2.1.13.RELEASE
FOSS Code Center ID:	17955685
FOSS in PPMS:	Access FOSS in PPMS
FOSS in OST:	Access FOSS in OST
 
SCV Name:	FLP CLOUD CF V2
SCV PPMS Object Number:	73555000100200008841
SCV Technical Name:	FLP_CLOUD_CF
SCV Technical Release:	2.0
SCV in PPMS:	Access SCV in PPMS
This mail is also sent to the following roles and colleagues on CC:

ECCN Contact(s):
Yan Vulich

Information Provider(s):
Shiri Openhaim

Security Responsible(s):
Matan Elitzur, Yan Vulich, Niv Eini

Additional Receivers:
Yosi Izaq



            8.1.2.3
        8.1.3
    8.2

9. Tests tags: E2E tests, integration tests, nightly tests, Automation 

    9.1   Cross team integration tests
               https://gkenewflpcf.jaas-gcp.cloud.sap.corp/job/CFLP-E2E-INTEGRATION-TEST/ 

    9.2 Guys E2E,  CFLP-E2E-INTEGRATION-TEST 
    JAAS: https://gkeportalcf.jaas-gcp.cloud.sap.corp/view/DEVELOPER%20CORNER/job/end2endTestJobs/job/CFLP-E2E-INTEGRATION-TEST/
 
Repo:
https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/tree/master/test/cFLP

    9.3   setups

        9.3.1   LKG
        Latest Known Good environment
$ cftlkg 
API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.88.0
user:           yosi.izaq@sap.com
org:            flpci
space:          lkg

LKG cockpit
https://account.int.sap.hana.ondemand.com/cockpit/#/globalaccount/SA0225001210/subaccount/messi/org/faa224af-7e76-4987-962d-d5303376bc19/space/7fa3556b-af2c-469b-9712-c513f226f472/applications


LKG site manager

https://flpdevelop.lkg.dt.cpp.cfapps.sap.hana.ondemand.com

        9.3.2 tags: LTS

            9.3.2.1 LTS system

the new system is called LTS:
you can use teamuser1234@gmail.com

LTS

Cf t -o mainsub -s lts

API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.93.0
user:           yosi.izaq@sap.com
org:            mainsub
space:          lts

            9.3.2.2 cockpit of mainsub lts, tags: lts cockpit
https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/c7076a1c-fa1f-4274-a64b-9a6f15676027/org/c45e1c2b-b218-416d-945e-04e2941593e9/space/ecde9397-fafa-4431-83e7-553dbe0215e1/applications

main sub subaccount: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/c7076a1c-fa1f-4274-a64b-9a6f15676027/subaccountoverview 
lts space: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/c7076a1c-fa1f-4274-a64b-9a6f15676027/org/c45e1c2b-b218-416d-945e-04e2941593e9/space/ecde9397-fafa-4431-83e7-553dbe0215e1/applications 

            9.3.2.3 consumers accounts

                9.3.2.3.1 saartest 
                DT: https://saartest.lts.dt.launchpad.cfapps.sap.hana.ondemand.com/sites
 Saartest consumer cockpit https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/d457a23c-1a34-49df-8275-ed5476056c41/subaccount/1ae3150a-3252-4e45-977e-99f2842f0541/destinations
you can use teamuser1234@gmail.com
QWE11asd

                9.3.2.3.2 yosi-e2e-tests
DT: https://yosi-e2e-tests.dt.launchpadlts.cfapps.sap.hana.ondemand.com/sites#Site-Directory

                9.3.2.3.3
            9.3.2.4 Subscribed accounts

Navigate to site manager
a. Login to cockpit
b. Instances and subscriptions
c. Select provider subscription. e.g. Lauchpad-LTS. 
d. Go to application


Add access permissions:
a. Login to cockpit
b. Users tab
c. Click on user
d. Click …
e. Assign role collection

f. Search and add it


        9.3.3 Dev

id=__new_globabl_accounts__
            9.3.3.1 tags: Yosi, formerly Saar, global account dev spaces

                9.3.3.1.1 cockpit


My PaaS, LP applications: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/65e227fa-3e4d-42e2-84f7-d8e7fb13166e/org/c7486965-e5bd-4047-a1a1-79f702a29304/space/7e0d5a8a-30ae-4b1b-948b-cfa4914de088/applications

Saar Global accounts: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/accountModel&//?section=SubaccountsSection&view=TilesView
consumer subaccounts: 
    Jawad's Consumer-Subaccount: 'SAP Launchpad i324180', https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/9fc76aae-fa55-4657-b360-41659cf6521e/subaccountoverview
    Jawad's content manager. go to consumer subaccount (above), 'instances and subscriptions', In Applications table click ... of 'SAP Launchpad launchpadi324180', Navigate to Application


My consumer account: https//account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/service-instances

My consumer design time: 
https://i500695launchpad-dt-launchpad-launchpadi500695p.cfapps.sap.hana.ondemand.com/sites#Site-Directory  

How to access via UX:
a. login to consumer cockpit (https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/472abdee-c7a4-4357-80ed-3a490cc94622/service-instances)
b. services -> instances and subscriptions, "Applications to which your subaccount is currently subscribed", say, SAP Launchpad - launchpadi500695p 
c. at the end of line. click three dots. go to application

                9.3.3.1.2 CF cli access

                    9.3.3.1.2.1 my space
[I500695@C02ZR8BSMD6N:2021-11-14 15:37:26:/Users/i500695/git/portal-cf-cdm-store-service/cdm.store.service:]2021$ cf login
API endpoint: https://api.cf.sap.hana.ondemand.com

User ID: i500695
Password: 

Authenticating...
OK

| Select an org:
| 1. DynamicForms
| 2. flpci
| 3. i500695launchpad
| 4. launchpad
| 5. mainsub
| 6. perfdt
| 7. portal-prov
| 8. rcsub
| 9. SaarTest
| 10. SAP_PORTAL_SERVICES
| 11. swz
| 12. swzperf
| 
| Org (enter to skip): 4
| Targeted org launchpad.
| 
| Select a space:
| 1. i055502c
| 2. i055502p
| 3. i060224p
| 4. i310019c
| 5. i310019p
| 6. i324180c
| 7. i324180p
| 8. i349433c
| 9. i500695c
| 10. i500695p
| 11. i521258c
| 12. i521258p

Space (enter to skip): 10
Targeted space i500695p.

API endpoint:   https://api.cf.sap.hana.ondemand.com
API version:    3.108.0
user:           yosi.izaq@sap.com
org:            launchpad

                    9.3.3.1.2.2 update space 
a. Jenkins job: https://portalcfdevelopers.jaas-gcp.cloud.sap.corp/job/deployOrchestratorJobs/job/UPDATE-ENVIRONMENT/build?delay=0sec 
b. 

    b1. update select applications, safer 
    b2. to update all - select all prone to failures, open dev tools Console, run:
$$('input[type="checkbox"').map(i => i.checked = true)
unselect    DEPLOY-PORTAL-SERVICE-DEFAULT
c. org: launchpad, space i500695p


                    9.3.3.1.2.3
                9.3.3.1.3 tags: control center 
https://int.controlcenter.ondemand.com/index.html

                9.3.3.1.4 Manage entitlements and quotas
manage in: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/entityEntitlements
First entitlement should be enabled in control center for this globalaccount 

see note "Yosi’s team accounts landscapes sub accounts resources"
                9.3.3.1.5
            9.3.3.2

        9.3.4 RCT, Release-candidate-test

            9.3.4.1 RCT space
|  [i500695@WYLQRXL9LQ:2022-05-03 15:36:17:~/git/portal-cf-design-time-service:]2008$ cf login --sso
|  API endpoint: https://api.cf.sap.hana.ondemand.com
|  
|  Temporary Authentication Code ( Get one at https://login.cf.sap.hana.ondemand.com/passcode ): 
|  Authenticating...
|  OK
|  
|  
|  Select an org:
|  1. DynamicForms
|  2. flpci
|  3. i500695launchpad
|  4. launchpad
|  5. mainsub
|  6. perfdt
|  7. portal-prov
|  8. rcsub
|  9. SaarTest
|  10. SAP_PORTAL_SERVICES
|  11. swz
|  12. swzmainlts
|  13. swzmainltshtml5apps
|  14. swzperf
|  15. swzrcrcthtml5apps
|  
|  Org (enter to skip): 8
|  Targeted org rcsub.
|  
|  Select a space:
|  1. flprct
|  2. rct
|  
|  Space (enter to skip): 2
|  Targeted space rct.
|  
|  API endpoint:   https://api.cf.sap.hana.ondemand.com
|  API version:    3.115.0
|  user:           yosi.izaq@sap.com
|  org:            rcsub
|  space:          rct


            9.3.4.2 rct cockpit
https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/7329906c-776f-4ea1-b0dd-ea9b6e66ea72/org/ae46e3ef-f9b5-4442-8fa5-d599053ea88a/space/d3b95927-f158-41d0-9a4f-7fc21e419062/app/48ff08f2-45c0-4b3c-9230-4b791b1bd495/overview
rct space: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/7329906c-776f-4ea1-b0dd-ea9b6e66ea72/org/ae46e3ef-f9b5-4442-8fa5-d599053ea88a/space/d3b95927-f158-41d0-9a4f-7fc21e419062/applications
RC sub subaccount: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/subaccount/7329906c-776f-4ea1-b0dd-ea9b6e66ea72/subaccountoverview 
portal-devops globalaccount: https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/d1aaa917-ad69-4664-9baf-6f47004b3bde/accountModel&//?section=HierarchySection&view=TreeTableView

        9.3.5
    9.4   tags: post-deployment tests, sanity, FLP-UI-SANITY-E2E, portal-cf-fs-automation

        9.4.0   SANITY-POST-DEPLOY

            9.4.0.1   README, tags: SANITY-POST-DEPLOY, SANITY-POST-DEPLOY-PORTAL, SANITY-POST-DEPLOY-LAUNCHPAD, readme, Kalman

when auto run failes validate manually:

https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/tree/master/ui-tests/sanity

in our automation repo Kalman added links to all related info
https://github.wdf.sap.corp/Portal-CF/Backbone-Automations

readme: https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/blob/master/ui-tests/sanity/README.MD
Kalman: manually validate: https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/blob/master/ui-tests/sanity/README.MD#how-to-validate-manually



| ## Post deploy sanity validation:
| 
| When Deploying we run basic sanity tests to ensure the deployment was successful.
| 
| ### Jenkins Jobs: 
| 1. [portal](https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY-PORTAL/) 
| 2. [launchpad](https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY-LAUNCHPAD/)
| 
| both jobs run preform the same validation
| 
| ### Run post deploy in landscapes: [link](https://portalcfe2e.jaas-gcp.cloud.sap.corp/view/POST-DEPLOYMNET-TEST-JOBS/)
| 
| ### Prerequisites
| To speed up the test execution and to simulate a customer case we rely on **existing** content and validate that it was not affected after deployment
| 
| ### Prerequisites Job
| To add prerequisites content to a new subscribed SKU run the prerequisites [job](https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY-PREREQUISITES/)
| 1. Make sure to configure the design time URL with the **TEST_URL** variable
| 2. Add admin role to the test user in the cockpit: **portaltest@mailinator.com**
| 
| Note: if the content with the same id's exists in the SKU the job will fail because of creating duplicate items
| 
| ### Common Issues
| 1. CN40 landscapes sometimes fail due to timeout because of latency issues. If the job fails please retry or check manually
| 2. The test fails due to no content. This can be an issue with the deployment job or caused by unsubscribing without rerunning the prerequisites job
| 
| ### How to validate manually
| 1. navigate to the site named "sanityTest"
| 2. validate an app named "app1sanity" exists
| 3. click on tile and verify navigation
| 
| ### Code [postdeployment.ui.sanity.spec.js](/ui-tests/sanity/postdeployment.ui.sanity.spec.js)
| 
| ### Content created with prerequisites Job:
| (in case prerequisites job fails or if you want to create manually)
| 1. An app with title: "app1sanity"
| 2. A group with the title: "group-sanity"
| 3. A group _assigned_ to app
| 4. An app _assigned_ to everyone role
| 5. A site named "sanityTest"
| 
| ### Definition of the landscapes: [link](https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/resources/postDeploymentTests/test-jobs.yml)
| 
| ### Wiki of test environments: [link](https://wiki.wdf.sap.corp/wiki/display/CPPortals/Test+Environments)


            9.4.0.2 manual Verification
take site directory parameter from test 
ex: https://portalpostdeployment.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY-LAUNCHPAD/87/parameters/ 
TEST_URL: https://testflpconsumerhotfix.dt.launchpadhotfix.portal.cn40.apps.platform.sapcloud.cn/sites#Site-Directory 
TEST_USER: portaltest@mailinator.com
TEST_PASSWORD: abcUser1

            9.4.0.3 post-deployment environments 
https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/resources/postDeploymentTests/test-jobs.yml

            9.4.0.4
        9.4.1   current job
[11:49] Labinsky, Kalman
we deleted that, they run https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY/
they run this https://portalcfe2e.jaas-gcp.cloud.sap.corp/view/POST-DEPLOYMNET-TEST-JOBS
that triggers the SANITY-POST-DEPLOY/ in all DC's
created from this file https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/resources/postDeploymentTests/test-jobs.yml

job that creates the content in case of new DC or unsubscribe
requires content creation before hand (one time per DC per SKU)
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/SANITY-POST-DEPLOY-PREREQUISITES/

        9.4.2 old test suites

            9.4.2.1 FLP-UI-SANITY-E2E 
( Mon Dec 20 14:25:46 IST 2021) post deployment sanity 
ci: https://github.wdf.sap.corp/Portal-CF/ci-tools/pull/1262/files
actual test code:  in fs-automation repo. ex: https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/pull/538/files
ui-tests/sanity/postdeployment.ui.sanity.spec.js 
removal of old flp-ui-sanity-e2e job: https://github.wdf.sap.corp/Portal-CF/ci-tools/pull/1273#pullrequestreview-6148041
            9.4.2.2

        9.4.3 

    9.5   Tests configuration  - ci-tools repository
repo: https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/

Example configuration:
https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/resources/parameters/end2endTestJobs/RCT-IMPORT-EXPORT-E2E.yaml

local clone:
[I500695@C02ZR8BSMD6N:2022-01-03 13:27:26:~/git/ci-tools:]2253$ cdcitools 
[I500695@C02ZR8BSMD6N:2022-01-03 13:27:29:/Users/i500695/git/ci-tools:]2254$ 

When posting PRs should also trigger the reactor:
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endReactor/242/
As in the PR details checkbox - should check after success

        9.5.1 tweak e2e test job configuration
https://github.wdf.sap.corp/Portal-CF/ci-tools/blob/master/resources/parameters/end2endTestJobs/RCT-IMPORT-EXPORT-E2E.yaml
change:
 - name: "TEST_REPORT_PATH"
    value: "ui-tests/target/functional/*.*\nui-tests/target/functional/assets/*.*"
to:
 - name: "TEST_REPORT_PATH"
    value: "ui-tests/target/functional/

PR: https://github.wdf.sap.corp/Portal-CF/ci-tools/pull/1274

        9.5.2

    9.6   Test Tools

        9.6.1   A new CLI for fetching E2E jobs parameters
@Temkin, Keren and I wrote a small tool that can save lots of time when running E2E test jobs locally.  It can:
List all e2e jobs
Get the parameters of a single job, in a format that can be pasted to WebStorm, or redirected to an .env file
It also deals with post deployment jobs
It requires generating a Github personal access token (https://docs.github.com/en/enterprise-server@2.22/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) before the first usage. The token is stored on the OS secure keychain.
More details (including installation instructions) can be found in the repo https://github.wdf.sap.corp/Portal-CF/portaltest-cli.
I’d like to also thank @Labinsky, Kalman for the initial idea.
BR,
Oriel

            9.6.1.1    usage example:
[I500695@C02ZR8BSMD6N:2022-01-20 10:47:01:/Users/i500695/git/portaltest-cli:]2048$ portaltest --help
Usage: portaltest [options] [command]

Options:
  -h, --help                         display help for command

Commands:
  get-env <job_name>                 Print a list of environment variables associated with the job <job_name>
  get-pd-env <landscape> <job_name>  Print a list of environment variables associated with the POST DEPLOYMENT job <job_name>
  list-jobs                          List all E2E jobs
  set-github-token                   Set a new Github personal access token
  delete-github-token                Delete the current Github personal access token
  help [command]                     display help for command
[I500695@C02ZR8BSMD6N:2022-01-20 10:47:09:/Users/i500695/git/portaltest-cli:]2049$ portaltest get-pd-env RCT-IMPORT-EXPORT-E2E
error: missing required argument 'job_name'
[I500695@C02ZR8BSMD6N:2022-01-20 10:47:49:/Users/i500695/git/portaltest-cli:]2050$ portaltest get-pd-env RCT RCT-IMPORT-EXPORT-E2E
Unexpected post-deployment file format
[I500695@C02ZR8BSMD6N:2022-01-20 10:48:10:/Users/i500695/git/portaltest-cli:]2051$ pwdcp
[I500695@C02ZR8BSMD6N:2022-01-20 10:48:15:/Users/i500695/git/portaltest-cli:]2052$ portaltest get-envRCT-IMPORT-EXPORT-E2E
error: unknown command 'get-envRCT-IMPORT-EXPORT-E2E'
[I500695@C02ZR8BSMD6N:2022-01-20 10:48:46:/Users/i500695/git/portaltest-cli:]2053$ portaltest get-env RCT-IMPORT-EXPORT-E2E
DOCKER_IMAGE=docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-puppeteer-cf:2.0.0
TEST_REPOSITORY=portal-cf-fs-automation
TEST_URL=https://rctsaare2esource.dt.cpprct.cfapps.sap.hana.ondemand.com
TEST_USER=portaltest@mailinator.com
TEST_PASSWORD=abcUser1
TEST_PATH=
TEST_TARGET_URL=https://rctsaare2etarget.dt.launchpadrct.cfapps.sap.hana.ondemand.com
TEST_COMMANDS=npm install --prefix ./ui-tests/ && chmod 777 ./ui-tests/ && mkdir -p -m 777 ./ui-tests/target/functional && cd ./ui-tests && npx mocha --timeout 3000000 ./import/import-export-zip.spec.js --reporter mochawesome --reporter-options reportDir=target/functional,reportFilename=functionalReport
TEST_REPORT_PATH=ui-tests/target/
TEST_REPORT_TYPE=html
[I500695@C02ZR8BSMD6N:2022-01-20 10:48:50:/Users/i500695/git/portaltest-cli:]2054$ portaltest get-pd-env AWS-RCT RCT-IMPORT-EXPORT-E2E
DOCKER_IMAGE=docker.wdf.sap.corp:51089/bit_ce/ci-docker-node-puppeteer-cf:2.0.0
TEST_REPOSITORY=portal-cf-fs-automation
TEST_URL=https://rctsaare2esource.dt.cpprct.cfapps.sap.hana.ondemand.com
TEST_USER=portaltest@mailinator.com
TEST_PASSWORD=abcUser1
TEST_PATH=
TEST_TARGET_URL=https://rctsaare2etarget.dt.launchpadrct.cfapps.sap.hana.ondemand.com
TEST_COMMANDS=npm install --prefix ./ui-tests/ && chmod 777 ./ui-tests/ && mkdir -p -m 777 ./ui-tests/target/functional && cd ./ui-tests && npx mocha --timeout 3000000 ./import/import-export-zip.spec.js --reporter mochawesome --reporter-options reportDir=target/functional,reportFilename=functionalReport
TEST_REPORT_PATH=ui-tests/target/
TEST_REPORT_TYPE=html

            9.6.1.2  code 
    -- uses commander module, https://www.npmjs.com/package/commander 

    -- github access /Users/I500695/git/portaltest-cli/lib/github.js
import axios from "axios";
import https from "https";
import keytar from "keytar";
import prompt from "prompt-async";
import { ErrorCodes, GithubError } from "./githubError.js";

const OWNER = "Portal-CF";
const REPO = "ci-tools";
const PATH_TO_END2END_CONF = "/resources/parameters/end2endTestJobs";
const PATH_TO_POST_DEPLOYMENT_CONF = "/resources/postDeploymentTests/test-jobs.yml";
const API_URL = "https://github.wdf.sap.corp/api/v3";


const _createAxiosInstance = (apiUrl, token) => {
    const _axios =  axios.create({
        baseURL: apiUrl,
        auth: {
            password: token
        },
        httpsAgent: new https.Agent({ rejectUnauthorized: false }) // An ugly hack @TODO - fix
    });

    _axios.interceptors.response.use(undefined, (error) => {
        switch (error?.response?.status) {
            case 401:
                throw new GithubError("Invalid token", ErrorCodes.INVALID_TOKEN);
            case 403:
                throw new GithubError("Unauthorized", ErrorCodes.UNAUTHORIZED);
            case 404:
                throw new GithubError("File Not found", ErrorCodes.NOT_FOUND);
        }
        return Promise.reject(error.message);
    });

    return _axios;
}


const _fetchFileMeta = async (token, pathToFile) => {
    const _axios = _createAxiosInstance(API_URL, token);
    const { data: fileMeta } = await _axios.get(`/repos/${OWNER}/${REPO}/contents/${pathToFile}`);
    return fileMeta;
}

const _fetchFile = async (token, pathToFile) => {
    const _axios = _createAxiosInstance(API_URL, token);
    const fileMeta = await _fetchFileMeta(token, pathToFile);
    const { data: file } = await _axios.get(fileMeta["download_url"],{ baseURL: "" });
    return file;
}


const getStoredGithubToken = async () => {
    return keytar.getPassword("github.token","portaltest-cli");
};

const deleteStoredGithubToken = async () => {
    return keytar.deletePassword("github.token" , "portaltest-cli");
};

const getPersonalAccessTokenFromInput = async () => {
    console.log(
        `Please generate a personal github access token in the following link:
        https://docs.github.com/en/enterprise-server@2.22/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token`
    );

    prompt.message = "";
    prompt.start();

    const token = await prompt.get( { name : "github", description : "Please enter github access token", required : true });
    await keytar.setPassword("github.token", "portaltest-cli", token.github);
    return keytar.getPassword("github.token","portaltest-cli");
};

const fetchParamsYaml = async(token, testName) => {
    return await _fetchFile(token, `${PATH_TO_END2END_CONF}/${testName}.yaml`);
}

const fetchPostDeploymentYaml = async(token) => {
    return await _fetchFile(token, `${PATH_TO_POST_DEPLOYMENT_CONF}`);
}

const listParamsYamlFiles = async (token) => {
    return await _fetchFileMeta(token, `${PATH_TO_END2END_CONF}`);
};

export {
    listParamsYamlFiles,
    fetchParamsYaml,
    fetchPostDeploymentYaml,
    getStoredGithubToken,
    getPersonalAccessTokenFromInput,
    deleteStoredGithubToken
};
    --

            9.6.1.3

        9.6.2
    9.7   EXTERNAL-PROVIDER-SYNC 
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/LTS-EXTERNAL-PROVIDER-SYNC/
        9.7.1   Support Direct Role Relation

            9.7.1.1   Summary
Kalman:
I completed implementing the automation for direct role relation with @Temkin, Keren. Thank you to everyone that helped complete the task and spatially to Sergay. 
 
Can each team that was involved in the feature review of the code and implementation? please review the code in the link - https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/pull/579
 
We would like to focus in the review also on the modularity of the steps executed to be able to analyze efficiently issues in a case of a regression.
 
As of now the code will be added to the automation EXTERNAL-PROVIDER-SYNC - https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/LTS-EXTERNAL-PROVIDER-SYNC/
 
We implemented cases 6 and 9 in the test scope with the role relation toggle - https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2775000161

            9.7.1.2

        9.7.2

    9.8   DTS automations

        9.8.1   background
https://wiki.wdf.sap.corp/wiki/display/CPPortals/DTS+Automation+Tests#DTSAutomationTests-HTML5APPS(newsitescenario)

HTML5 APPS (new site scenario)
Repo: 
https://github.wdf.sap.corp/Portal-CF/html5-app-test-content

Jenkins: 
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/LTS_CFLP_HTML5_APPS_NEW_SCENARIO/
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/RCT_CFLP_HTML5_APPS_NEW_SCENARIO/
Jenkins Configuration:
Test command: git config --global http.sslVerify false && ENV=${ENV} npm run newSiteTest
ENV parameter: lts-new - should be filled in with the relevant landscape, taken from environments.json
Description:
The test creates a new space and deploys an mtar containing different HTML5 apps. Following sync (in which DTS is invoked), it verifies that the apps were loaded as expected in runtime.

MTA:
Contains:

diverse apps (static tiles with translations, dynamic tiles with odata request, url applauncher, app with params, cross app navigation etc.), shell plugins, backend app (express app that expose two routes , and return random number) for the dynamic tile
service instances: 2 destination service instances (sub-account level, instance level), 2 HTML5 repo instances (one for each destination instance), uaa instance. 
Notes:

There is no portal instance in the mta in this scenario. The apps will be deployed to HTML5 repos. DTS will be invoked only during sync.
Some apps use sub account level destination. Ex: - name: html5apps-subaccount-destination-service 
Some apps use instance level destination. Ex: - name: html5apps-instance-destination-content 
Test Flow:
Using npm, mocha, cf cli commands

html5NewScenarioE2E.sh $ENV
setupEnv.js - passes the env variables of the relevant landscape extracted from environments.json to the next script
createSpace
assignRole
downloadMtarNew
deployMtarNew
operateDestinationInstanceLevel - Some apps use instance level destination. The approuter uses the destination in order to get apps from html5 repo (/applications route). During the deployment, destination service creates a sub-account level destination on production (Portal space) . When running the test, we need this phase in order to create the sub-account level destination on lts / rct / dev provider space. 
updateProvider - sync operation
operateDestination - For the dynamic tile, which performs odata request ,we create sub_account level destination to get to the backend application. If we run the test on our dev spaces, we need to create it manually.
createSiteNew
puppeteer - Helium_Test.js - validates the different tiles and shell plugin are loaded as expected
operateDestinationInstanceLevel
deleteContentAndSite
undeployAndDeleteSpace
mergeReports
Notes:

Some resources are used by the existing e2e scenario owned by Shani's team as well (i.e: mta.yaml, puppeteer).  Therefore, when changing a 'shared' file, we should validate that both scenarios (new/existing) are working as expected.
Known Issues:
In the following case of failure:
AssertionError [ERR_ASSERTION]: Failed to deploy, err: "Deploying multi-target app archive target/html5-app-test-content.mtar in org swzmainltshtml5apps / space 2294-consumer as sapeuxautomation@sap.com...\n\nUploading 1 files...\n  /home/jenkins/agent/workspace/end2endTestJobs/LTS_CFLP_HTML5_APPS_NEW_SCENARIO/html5-app-test-content/target/html5-app-test-content.mtar\nOK\nOperation ID: a7bd0868-d5f5-11ec-ac45-eeee0a8bbb43\nOperation ID: a7bd0868-d5f5-11ec-ac45-eeee0a8bbb43\nDeploying in org \"swzmainltshtml5apps\" and space \"2294-consumer\"\nDetected MTA schema version: \"3\"\nNo deployed MTA detected - this is initial deployment\nDetected new MTA version: \"1.43.0-20220515142005+0d4c2c61c748602b4d17201aacd41be5a8874051\"\nProcessing service \"html5apps-subaccount-destination-service\"...\nCreating service \"html5apps-subaccount-destination-service\" from MTA resource \"html5apps-subaccount-destination-service\"...\nProcessing service \"html5apps-instance-destination-service\"...\nProcessing service \"html5apps-xsuaa-service\"...\nProcessing service \"html5apps-subaccount-html5-app-host-service\"...\nCreating service \"html5apps-instance-destination-service\" from MTA resource \"html5apps-instance-destination-service\"...\nCreating service \"html5apps-subaccount-html5-app-host-service\" from MTA resource \"html5apps-subaccount-html-repo-host\"...\nSetting service \"html5apps-xsuaa-service\" parameters from \"xs-security.json\"\nCreating service \"html5apps-xsuaa-service\" from MTA resource \"uaa-html5apps\"...\nProcessing service \"html5apps-instance-html5-app-host-service\"...\nCreating service \"html5apps-instance-html5-app-host-service\" from MTA resource \"html5apps-instance-html-repo-host\"...\nService operation failed: Controller operation failed: 409 Updating service \"html5apps-xsuaa-service\" failed: Conflict: Error creating service \"html5apps-xsuaa-service\" from offering \"xsuaa\" and plan \"application\": CF-ServiceBrokerConflict(10001): Service broker error: Service broker xsuaa failed with: Application with xsappname html5apps!t16275 already exists. To create a new service instance, ensure that the xsappname specified in your application's xs-security.json file together with the selected service plan of the UAA service broker lead to a new appid. To update an existing service instance, use the update-service command instead. \nProceeding with automatic retry... (3 of 3 attempts left)\nCreating service \"html5apps-xsuaa-service\" from MTA resource \"uaa-html5apps\"...\nService operation failed: Controller operation failed: 409 Updating service \"html5apps-xsuaa-service\" failed: Conflict: Error creating service \"html5apps-xsuaa-service\" from offering \"xsuaa\" and plan \"application\": CF-ServiceBrokerConflict(10001): Service broker error: Service broker xsuaa failed with: Application with xsappname html5apps!t16275 already exists. To create a new service instance, ensure that the xsappname specified in your application's xs-security.json file together with the selected service plan of the UAA service broker lead to a new appid. To update an existing service instance, use the update-service command instead. \nProceeding with automatic retry... (2 of 3 attempts left)\nCreating service \"html5apps-xsuaa-service\" from MTA resource \"uaa-html5apps\"...\nService operation failed: Controller operation failed: 409 Updating service \"html5apps-xsuaa-service\" failed: Conflict: Error creating service \"html5apps-xsuaa-service\" from offering \"xsuaa\" and plan \"application\": CF-ServiceBrokerConflict(10001): Service broker error: Service broker xsuaa failed with: Application with xsappname html5apps!t16275 already exists. To create a new service instance, ensure that the xsappname specified in your application's xs-security.json file together with the selected service plan of the UAA service broker lead to a new appid. To update an existing service instance, use the update-service command instead. \nProceeding with automatic retry... (1 of 3 attempts left)\nCreating service \"html5apps-xsuaa-service\" from MTA resource \"uaa-html5apps\"...\nService operation failed: Controller operation failed: 409 Updating service \"html5apps-xsuaa-service\" failed: Conflict: Error creating service \"html5apps-xsuaa-service\" from offering \"xsuaa\" and plan \"application\": CF-ServiceBrokerConflict(10001): Service broker error: Service broker xsuaa failed with: Application with xsappname html5apps!t16275 already exists. To create a new service instance, ensure that the xsappname specified in your application's xs-security.json file together with the selected service plan of the UAA service broker lead to a new appid. To update an existing service instance, use the update-service command instead. \n1 of 1 done\nProcess failed.\nUse \"cf deploy -i a7bd0868-d5f5-11ec-ac45-eeee0a8bbb43 -a abort\" to abort the process.\nUse \"cf deploy -i a7bd0868-d5f5-11ec-ac45-eeee0a8bbb43 -a retry\" to retry the process.\nUse \"cf dmol -i a7bd0868-d5f5-11ec-ac45-eeee0a8bbb43\" to download the logs of the process.\n"

Solution: Delete the spaces under swzmainltshtml5apps.

cf login
Select swzmainltshtml5apps,
Delete all the spaces that haven't been deleted. For example: cf delete-space 2293-consumer

        9.8.2 HTML5_APPS_NEW_SCENARIO

            9.8.2.1 code
Repo: https://github.wdf.sap.corp/Portal-CF/html5-app-test-content
actual tests: tests/html5-app-test-content/Puppeteer_Test.js
PUPPETEER tests: https://github.wdf.sap.corp/Portal-CF/perf-puppeteer/blob/24ac62527cd0587d70182489043dfb16c3992133/src/tests/portals/Helium_Test.js#L42


Jenkins: 
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/LTS_CFLP_HTML5_APPS_NEW_SCENARIO/
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/RCT_CFLP_HTML5_APPS_NEW_SCENARIO/
Jenkins Configuration:
Test command: git config --global http.sslVerify false && ENV=${ENV} npm run newSiteTest
ENV parameter: lts-new - should be filled in with the relevant landscape, taken from environments.json
Description:
The test creates a new space and deploys an mtar containing different HTML5 apps. Following sync (in which DTS is invoked), it verifies that the apps were loaded as expected in runtime.

            9.8.2.2 example, skip test
src/tests/portals/Helium_Test.js
    // *** 06 - Flex Personalization View ***
    perfUtils.itPerfTransaction('Helium', '06_flex_personalization_view_PERFORMANCE', async () => {
        await heliumActionsAndAssertions.waitClickXpathAndWaitXPathInIframe(page, heliumControls.searchProductsTile, heliumControls.searchProductsViewsButton);
    });
    it.skip('06_flex_personalization_view', async () => {
        await page.setCacheEnabled(false);
        let frame = await heliumActionsAndAssertions.waitClickXpathAndWaitXPathInIframe(page, heliumControls.searchProductsTile, heliumControls.searchProductsViewsButton);
        const viewName = await heliumActionsAndAssertions.searchProductsCreateView(frame);
        await heliumActionsAndAssertions.searchProductsHardReload(page);
        frame = await pageHelpers.switchToIframe(page, heliumControls.Iframe);
        await pageHelpers.waitXpathClickXpathAndWaitXpath(frame, heliumControls.searchProductsViewsButton, heliumControls.searchProductsViewsSaveAsButton);
        await heliumActionsAndAssertions.verifySearchProductsNewView(frame, viewName);
    });


            9.8.2.3
        9.8.3
    9.9  tags: html5-new-tenant 
    https://github.wdf.sap.corp/Portal-CF/automation-infra
    https://github.wdf.sap.corp/Portal-CF/Backbone-Automations/blob/i542566-html5-new-fix/test/html5/html5-new-alt.spec.ts
https://sap-my.sharepoint.com/:v:/p/yosi_izaq/EQVkRIsjzBdCl8F6QbBmFa4B8hpWucO0QHPa5e1stVud7Q

    9.10  Team Automations, E2E tests, tags: Team Automations

        9.10.1  Embedded content provider
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/jjb-LTS-UI5-EMBEDDED-CONTENT-PROVIDER-TEST-SPECIFIC-UI5-VERSION-e2e/
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/jjb-RCT-UI5-EMBEDDED-CONTENT-PROVIDER-TEST-SPECIFIC-UI5-VERSION-e2e/

        9.10.2
    9.11 
    9.12 
    9.13 
    9.14 
    9.15 
    9.16 


10.  guidelines 

    10.1  Source code conventions

        10.1.1  portal product scenarios
 
As you may know, there is a cross-team BLI for aligning scenario names that appear in our code, in order to prevent confusion caused by different names for the same scenario (CLP/Portal etc.).
After a sync meeting between the teams it was decided to use full scenario names, and not abbreviations.
 
This means that from now on, whenever you mention a scenario name in your code – whether it's a function name, a variable name, a logged string or anything else – you should always use its full name.
If possible, use shared lib's enum (from configUtils).
Note that WorkzoneHR is not a separate scenario (even though it appears so here), it's actually a private case of Workzone scenario.
 
SCENARIOS = {
    PORTAL: 'PORTAL',
    LAUNCHPAD: 'LAUNCHPAD',
    WORKZONE: 'WORKZONE',
    WORKZONEHR: 'WORKZONEHR',
    APOLLO: 'APOLLO'
};
 
Current instances of scenario names should be changed if they are not according to the new convention:
CLP à Portal
CFLP à Launchpad
SWZ/BWP/DWP à Workzone
 
The person in charge of the BLI in each team:
Guy's team - @Blechman, Dean
Saar's team - @Margieh, Jawad
Yael's team- @Vainshtain, Alina
Nili's team - @Angrest, Etay
Nadav's team - @Geva, Uri
 
        10.1.2
 
 

    10.2

11. BUGS, tags: bugs, defects, bcp, jiraa, snow, service-now, customer support

    11.1  BCP
    https://support.wdf.sap.corp/?saprole=ZCSSINTPROCE
    ?saprole=ZCSSINTPROCE

https://support.wdf.sap.corp/sap(bD1lbiZjPTAwMSZkPW1pbg==)/bc/bsp/sap/crm_ui_start/default.htm?saprole=ZCSSINTPROCE

component EP, CPP, CF/NEO

        11.1.1  General

            11.1.1.1  Open internal incident

            11.1.1.2 Ticket lifecycle

incident starts as NEW

priority.
    - Very High, block production. systems down
    - Need to update every few hours
    - For weekend set ORT assistant (will send auto notification to customer every few hours)

- To share the BCP URL click the URL button. don't copy from address bar. It will not work
- don't use browser back button (use dedicated button)

- request to receive notification emails: administration -> notification-subscription 

- search
transaction customer incident
Component EP-CPP-CF-CM

- Japanese, Chinese customer. If the incident is not in english. Never respond in english. They find it offensive 
Set primary responder to PS VGSC APJ
Write internal memo that explains to the primary supported (Japanese/Chinese colleague)

- IRT, initial response time
- MP, total open time. Red is not good 
- WP, calculated priority measure, sort descending

        11.1.2  Customer BCPs

            11.1.2.1    Incident 701620 / 2020 / A Subscribed Business application is not displayed on the content manager contents / SAP Delivered Support
Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents
                11.1.2.1.1    general


In this BCP https://support.wdf.sap.corp/sap/support/message/002075129400007016202020 –
Enel say they do not see in DT, new Apollo Providers they subscribe to.
 
Looking in kibana only thing I could find was subscription related calls.
Didn’t find any DTS nor semantic-service calls / logs.
(tried to look for 'IPEIDEAS006’, which should’ve been the provider ID). 
https://logs.cf.eu10.hana.ondemand.com/goto/0060db797159314943edba7a74554102
https://logs.cf.eu10.hana.ondemand.com/app/kibana#/dashboard/Requests-and-Logs?_g=(filters:!((%27$state%27:(store:globalState),meta:(alias:!n,disabled:!f,index:%27logstash-*%27,key:space_name,negate:!f,params:(query:Portal),type:phrase,value:Portal),query:(match:(space_name:(query:Portal,type:phrase))))),refreshInterval:(pause:!t,value:0),time:(from:now%2Fw,to:now%2Fw))&_a=(description:%27%27,filters:!((%27$state%27:(store:appState),meta:(alias:!n,disabled:!f,index:%27logstash-*%27,key:correlation_id,negate:!f,params:(query:ed71fb62-9dcf-4cf1-981a-6094af38904c),type:phrase,value:ed71fb62-9dcf-4cf1-981a-6094af38904c),query:(match:(correlation_id:(query:ed71fb62-9dcf-4cf1-981a-6094af38904c,type:phrase))))),fullScreenMode:!f,options:(darkTheme:!f,useMargins:!t),panels:!((embeddableConfig:(),gridData:(h:4,i:baf515f5-c5a2-41d0-a4b9-a4c1c71aee12,w:48,x:0,y:0),id:Navigation,panelIndex:baf515f5-c5a2-41d0-a4b9-a4c1c71aee12,type:visualization,version:%277.4.2%27),(embeddableConfig:(),gridData:(h:16,i:%275ecb5dc7-1229-46aa-afc6-df4471deec0a%27,w:12,x:0,y:4),id:Correlation-Ids,panelIndex:%275ecb5dc7-1229-46aa-afc6-df4471deec0a%27,type:visualization,version:%277.4.2%27),(embeddableConfig:(columns:!(component_name,correlation_id,level,request,response_status,response_time_ms),sort:!(%27@timestamp%27,desc)),gridData:(h:12,i:%271a3e8544-b534-45ae-8a1d-f0b132e0cc6d%27,w:36,x:12,y:4),id:Requests,panelIndex:%271a3e8544-b534-45ae-8a1d-f0b132e0cc6d%27,type:search,version:%277.4.2%27),(embeddableConfig:(columns:!(component_name,correlation_id,level,logger,msg),sort:!(%27@timestamp%27,desc)),gridData:(h:12,i:%274624c47c-8a08-4630-9858-e97336e0a450%27,w:36,x:12,y:16),id:Application-Logs,panelIndex:%274624c47c-8a08-4630-9858-e97336e0a450%27,type:search,version:%277.4.2%27),(embeddableConfig:(),gridData:(h:8,i:%2776cab91c-3afa-43ca-a16b-473de41b8864%27,w:12,x:0,y:20),id:Levels,panelIndex:%2776cab91c-3afa-43ca-a16b-473de41b8864%27,type:visualization,version:%277.4.2%27),(embeddableConfig:(),gridData:(h:8,i:d85c9240-da27-41fb-8bdd-67754f182056,w:16,x:0,y:28),id:Organizations,panelIndex:d85c9240-da27-41fb-8bdd-67754f182056,type:visualization,version:%277.4.2%27),(embeddableConfig:(),gridData:(h:8,i:a2e70983-6773-46fa-ab5e-6ac3a958b6fd,w:16,x:16,y:28),id:Components,panelIndex:a2e70983-6773-46fa-ab5e-6ac3a958b6fd,type:visualization,version:%277.4.2%27),(embeddableConfig:(),gridData:(h:8,i:%276d7a3d9b-ba39-4fd7-85c9-b199d6a189c2%27,w:16,x:32,y:28),id:Spaces,panelIndex:%276d7a3d9b-ba39-4fd7-85c9-b199d6a189c2%27,type:visualization,version:%277.4.2%27)),query:(language:lucene,query:%27%27),timeRestore:!f,title:%27Requests+and+Logs%27,viewMode:view)

possible rc: local provider not created. 
either provisioning-service or workzone-provisioning-service call semantic-service to create the local provider


POST "/provisioning_service/provisioning/tenant/subscription", parameters={}
org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor
msg: Read "application/json;charset=utf-8" to ["{"subscriptionAppName":"IPEIDEAS006D","subscriptionAppId":"ipeideas006-dashboard-qlik-ba!t18149","s (truncated)...]
org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor	No match for [application/json, text/plain, */*], supported: []
Oct 19, 2020 @ 15:35:21.207	portal-cf-provisioning-service-1602175075	ed71fb62-9dcf-4cf1-981a-6094af38904c	DEBUG	org.springframework.web.servlet.DispatcherServlet	Completed 200 OK


requests:
Oct 19, 2020 @ 15:35:21.216	portal-cf-service-broker-1602175107	ed71fb62-9dcf-4cf1-981a-6094af38904c	INFO	/broker/callback/v1.0/tenants/4a795a74-7e74-40d9-85c4-072e4e8620c9	200	813.648
	Oct 19, 2020 @ 15:35:21.214	portal-cf-provisioning-service-1602175075	ed71fb62-9dcf-4cf1-981a-6094af38904c	INFO	/provisioning_service/provisioning/tenant/subscription	200	512.086
	Oct 19, 2020 @ 15:35:17.376	portal-cf-service-broker-1602175107	ed71fb62-9dcf-4cf1-981a-6094af38904c	INFO	/broker/callback/v1.0/dependencies?tenantId=4a795a74-7e74-40d9-85c4-072e4e8620c9	200	3.278

looks like log level is not set to debug.
log level config:
a. src/main/resources/logback.xml
    <logger name="com.sap.portal.tenant.provisioning" level="${CF_APP_LOG_LEVEL:-INFO}"/>
b.  manifest-concourse.yml
  CF_APP_LOG_LEVEL: (( valid(.context.config.cf.log_level) ? .context.config.cf.log_level :"ERROR" ))
c. check env

$ cf env portal-cf-provisioning-service | grep LOG_L
CF_APP_LOG_LEVEL: debug


                11.1.2.1.2 msgs 2 Customer
Hi,

I would like to verify that the mta.yml has valid FLP module configuration. Can you please double check the tenant host pattern is available as an environment variable in the FLP module?
Can you also provide the mta.yml?

- 2nd msg:
  Dear Customer,
 
In the mta I could see that this is the tenant host pattern:
      TENANT_HOST_PATTERN: tenant_host_pattern_flp    

It is not a valid pattern so I maybe it is a placeholder that is changed?- Can you please confirm whether indeed it is changed?- If so, what is the final value?

Also, can you kindly confirm?- The Subscription to AP22511 eideas dev dashboard is successful - and the app in question was checked for usage in the content explorer?
And yet, even after these steps the app does not show up in the content explorer?

I would like to try to go through these steps myself so that I could look for the reason it does not work as expected. Would it be possible to provide me with a link to the design time editor and to the kibana so I could monitor the logs?


- 
  Good evening, i can confirm that the provider "IPEIDEAS006" is not present in the list of providers in the "CONTENT EXPLORER" tab.

Not finding it in this list it is not possible for me to add it to my contents.

I have attached the screen capture "IPEIDEAS006 IS NOT FOUND IN THE CONTENT EXPLORER.JPG" to show the "content explorer" tab in which I can't find "IPEIDEAS006".

I confirm that this last one has already been subscribed in the cockpit.

Thanks.


                11.1.2.1.3 login to PaaS
cf login -a https://api.cf.eu10.hana.ondemand.com
[i500695@C02X632CJGH6:2020-10-29 12:34:22:~/work/SAP/BCP/Incident_701620__2020__A_Subscribed_Business_application_is_not_displayed_on_the_content_manager_contents:]2065$ cf t
API endpoint:   https://api.cf.eu10.hana.ondemand.com
API version:    3.88.0
user:           yosi.izaq@sap.com
org:            SAP_PORTAL_SERVICES
space:          Portal

content manager: https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/sites#Content-Manage
Username: ENELINT\AF11065
Password: EhiMan1!
(didn't work, I've used my SSO instead)

Requests examples: 
curl 'https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/semantic/entity?contextId=SUB_ACCOUNT&contextType=SUB_ACCOUNT' \
  -H 'Connection: keep-alive' \
  -H 'Accept: application/json, text/javascript, */*; q=0.01' \
  -H 'X-XHR-Logon: accept="iframe,strict-window,window"' \
  -H 'X-Requested-With: XMLHttpRequest' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36' \
  -H 'Content-Type: application/json; charset=UTF-8' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Referer: https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/sites' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Cookie: JTENANTSESSIONID_services=7J5T2vZy4o%2Bv1TiKk6I0%2Fmkn8ZFYFfd4ABzhQYhnpOs%3D; JSESSIONID=s%3APY3HPHkumtKqITH8ULZ8vQwOW92dQqiu.6BTQYj%2BJaolvWcHrXcIvrlfNe389gtHQng5BlKkVzCk; __VCAP_ID__=1200ee70-7931-439a-6f51-6a3e' \
  --compressed

request:
curl 'https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/semantic/entity/provider/explore' \
  -H 'Connection: keep-alive' \
  -H 'Accept: application/json, text/javascript, */*; q=0.01' \
  -H 'X-XHR-Logon: accept="iframe,strict-window,window"' \
  -H 'X-Requested-With: XMLHttpRequest' \
  -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36' \
  -H 'Content-Type: application/json; charset=UTF-8' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Referer: https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/sites' \
  -H 'Accept-Language: en-US,en;q=0.9' \
  -H 'Cookie: JTENANTSESSIONID_services=7J5T2vZy4o%2Bv1TiKk6I0%2Fmkn8ZFYFfd4ABzhQYhnpOs%3D; JSESSIONID=s%3APY3HPHkumtKqITH8ULZ8vQwOW92dQqiu.6BTQYj%2BJaolvWcHrXcIvrlfNe389gtHQng5BlKkVzCk; __VCAP_ID__=1200ee70-7931-439a-6f51-6a3e' \
  --compressed


provider response:
[
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN022D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "298ee97c-a30b-41b5-b1e9-e3795d28aa45",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "298ee97c-a30b-41b5-b1e9-e3795d28aa45": {
                        "host": "sd-indh-dev-ita-ipscan-rie-safety-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5"
                    },
                    "e63f9475-78a1-4894-ba04-9c3e596049b1": {
                        "host": "sd-indh-dev-ita-ipscan-rie-safety-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN022D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN022"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - RIEPILOGO_CONTROLLI_SAFETY_ENEL-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5",
                    "tenantId": "2292aee59166b8ff0330e8d2eff51118"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591873340000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603799807000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN005D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "ae868f7b-1cc2-4c16-89a9-889f603ed6d0",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "664b9e5d-16c9-4ca5-a15d-d66267625ed7": {
                        "host": "sd-indh-dev-ita-ipscan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd"
                    },
                    "ae868f7b-1cc2-4c16-89a9-889f603ed6d0": {
                        "host": "sd-indh-dev-ita-ipscan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN005D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN005"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controlli"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd",
                    "tenantId": "a2987dd054049aaf30c890014e91a8f9"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590412717000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604045890000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO010D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "99fa0b7f-6443-43c0-b679-b77d72d8513b",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "814ecd54-b018-46a3-b497-fd569945b987": {
                        "host": "sd-indh-dev-ita-ipscpco010-fablord-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8"
                    },
                    "99fa0b7f-6443-43c0-b679-b77d72d8513b": {
                        "host": "sd-indh-dev-ita-ipscpco010-fablord-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO010D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO010"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Fabbisogno Lordo"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8",
                    "tenantId": "d03d5275d6b4740b4f63642d915e9798"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592817308000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603450629000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "4a8001ff-8fd9-47b6-8c7b-f0a8f0d09981",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "4a8001ff-8fd9-47b6-8c7b-f0a8f0d09981": {
                        "host": "sd-indh-dev-ita-ipscpco001-anamat-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9997b2be-8fb5-45ac-af9d-55860c184e13"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Anagrafica Materiali"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "9997b2be-8fb5-45ac-af9d-55860c184e13",
                    "tenantId": "d970cc06dbeb4d21c7510fdc402df990"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592402185000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601905604000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSITID001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "cff065f9-c2b9-4da0-b892-ca569b88beee",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "5b412cbe-297a-4147-88e4-3d0196120e2e": {
                        "host": "sd-indh-dev-ita-ipsitid001-indicedirischio-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2"
                    },
                    "cff065f9-c2b9-4da0-b892-ca569b88beee": {
                        "host": "sd-indh-dev-ita-ipsitid001-indicedirischio-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSITID001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - SITEID_IRI"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2",
                    "tenantId": "d86703a4d500a2decd8388950d50203d"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590486613000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603903683000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPGEA001DEV",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "c0a45e22-addd-46f9-a8b5-ae6319e6e5d1",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "c0a45e22-addd-46f9-a8b5-ae6319e6e5d1": {
                        "host": "sd-indh-dev-ita-ipgea001-homepage-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "85c4eea2-cb52-49e8-a90e-70704cfc5842"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPGEA001DEV"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDGEA001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "GEA - Home Page"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "85c4eea2-cb52-49e8-a90e-70704cfc5842",
                    "tenantId": "89ac9bf2d103a4b9272b35b731c3a04f"
                },
                "createdBy": "technicalUser",
                "createdOn": 1588580799000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602498878000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO013D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "45b623c4-6d06-4dfb-bb38-d1c5d6c27e47",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "45b623c4-6d06-4dfb-bb38-d1c5d6c27e47": {
                        "host": "sd-indh-dev-ita-ipscpco013-rda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146"
                    },
                    "8b17f9e6-755a-411f-9d7e-12b8efc51739": {
                        "host": "sd-indh-dev-ita-ipscpco013-rda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO013D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO013"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - RdA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146",
                    "tenantId": "6e5987827cc794ff931eaf12cc128b9a"
                },
                "createdBy": "technicalUser",
                "createdOn": 1593076463000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603731523000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a002324e-bed6-4ca9-8bdd-0dddb09b219b",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "5def968a-f305-4723-b7a2-cd1489426c85": {
                        "host": "sd-indh-dev-ita-ipscan-cantieri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07"
                    },
                    "a002324e-bed6-4ca9-8bdd-0dddb09b219b": {
                        "host": "sd-indh-dev-ita-ipscan-cantieri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Cantieri"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07",
                    "tenantId": "d1f5dfc0cd7b26b98fda56a6e7b6e925"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590759184000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603795582000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM007D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "aa6413bf-b101-4f68-9fcb-cbca2f8c4b4d",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "0d4c9751-f16b-4bbf-8819-0299d15246ad": {
                        "host": "sd-indh-dev-ita-ipadam007-virtualstore-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576"
                    },
                    "aa6413bf-b101-4f68-9fcb-cbca2f8c4b4d": {
                        "host": "sd-indh-dev-ita-ipadam007-virtualstore-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM007D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM007"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Magazzino"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576",
                    "tenantId": "8f2280b19456c025ffd7a374c535a335"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591275257000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603291109000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a1f46bd0-3259-4286-b81a-2bbf332f5ee8",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "1a30a578-794c-4cd2-b969-7600f4727ea7": {
                        "host": "sd-indh-dev-ita-ipadam003-dotazioni-assegnate-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8"
                    },
                    "a1f46bd0-3259-4286-b81a-2bbf332f5ee8": {
                        "host": "sd-indh-dev-ita-ipadam003-dotazioni-assegnate-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Dotazioni Assegnate"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8",
                    "tenantId": "e80ea66afde8c88b2cd4ec98676ac4ed"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591353611000,
                "updatedBy": "technicalUser",
                "updatedOn": 1596540009000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN017D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "bd0f0d52-c64f-4351-8850-5eb94993d4e6",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "bd0f0d52-c64f-4351-8850-5eb94993d4e6": {
                        "host": "sd-indh-dev-ita-ipscan-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230"
                    },
                    "d1267f9a-4d61-4727-9d23-e6a2bed4871f": {
                        "host": "sd-indh-dev-ita-ipscan-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN017D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN017"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Infortuni"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230",
                    "tenantId": "ba911d94d7a437ecb79d94122c1c31cd"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590499398000,
                "updatedBy": "technicalUser",
                "updatedOn": 1599649048000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN031D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "7d878ecc-6e79-4c60-8659-02ab32bc11da",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "7d878ecc-6e79-4c60-8659-02ab32bc11da": {
                        "host": "sd-indh-dev-ita-ipscan-esi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79"
                    },
                    "cc59b3f9-40bf-4fdf-80b5-621d063a340a": {
                        "host": "sd-indh-dev-ita-ipscan-esi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN031D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN031"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Esi"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79",
                    "tenantId": "7fa21424b9a1fcee21f60035d0030cea"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590593814000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603798963000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPPEGASO006D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "15a93cb0-ed63-4de4-9627-9c97d318f853",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "15a93cb0-ed63-4de4-9627-9c97d318f853": {
                        "host": "sd-indh-dev-ita-ippegaso006-gestione-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959"
                    },
                    "51c3947c-237e-466c-b52f-dcaeefee8f42": {
                        "host": "sd-indh-dev-ita-ippegaso006-gestione-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPPEGASO006D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO006"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Gestione"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959",
                    "tenantId": "bd544d4f99948d163987c8a5775ebfa6"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594637354000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604077574000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN030D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "b161cb19-653a-4631-9da9-35aaf24fdba9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "b161cb19-653a-4631-9da9-35aaf24fdba9": {
                        "host": "sd-indh-dev-ita-ipscan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b3027542-c916-4ba8-9f89-d6c2de0183b5"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN030D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN030"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - HOME-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "b3027542-c916-4ba8-9f89-d6c2de0183b5",
                    "tenantId": "49ab34fb83ace386aff5987c2fdceebf"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591182938000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603789864000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "ipdaida001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "86fc1dbf-87f3-4948-895e-1d1f61b6920d",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "57216d77-1946-49ee-84f1-d5752684d3c3": {
                        "host": "sd-indh-dev-ita-ipdaida001-aidadesktop-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9"
                    },
                    "86fc1dbf-87f3-4948-895e-1d1f61b6920d": {
                        "host": "sd-indh-dev-ita-ipdaida001-aidadesktop-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "ipdaida001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Desktop"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9",
                    "tenantId": "e1f88476fddc3b794ac710a8c018b53e"
                },
                "createdBy": "technicalUser",
                "createdOn": 1589362353000,
                "updatedBy": "technicalUser",
                "updatedOn": 1599649868000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN004D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a1ed19f8-f7f6-4968-a321-d6154637aa40",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "8b6e6306-2dc5-46c0-8dd7-f3e04a034c36": {
                        "host": "sd-indh-dev-ita-ipscan-contratti-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c"
                    },
                    "a1ed19f8-f7f6-4968-a321-d6154637aa40": {
                        "host": "sd-indh-dev-ita-ipscan-contratti-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN004D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN004"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Contratti"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c",
                    "tenantId": "31ac263e679515e46108dc178db875b9"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590580631000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603212118000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN010D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "cc352a11-b73b-4ba5-b518-c184f448feec",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "cc352a11-b73b-4ba5-b518-c184f448feec": {
                        "host": "sd-indh-dev-ita-ipqcan-cqi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6b128816-a16c-43c1-86f5-155637350027"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN010D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN010"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CQI"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "6b128816-a16c-43c1-86f5-155637350027",
                    "tenantId": "c8fa340dbb4b6b765d8d6663f65eeb10"
                },
                "createdBy": "technicalUser",
                "createdOn": 1598362620000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602625063000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1599124948000,
            "updatedBy": "sysUser",
            "updatedOn": 1599124948000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "f5b2f16a-736d-44e4-8a61-066b651b1ce3",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "402bcd91-6ac6-4c4e-b395-69bc868b9c01": {
                        "host": "sd-indh-dev-ita-ipscan-anagrafiche-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3"
                    },
                    "f5b2f16a-736d-44e4-8a61-066b651b1ce3": {
                        "host": "sd-indh-dev-ita-ipscan-anagrafiche-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Anagrafiche"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3",
                    "tenantId": "5132b87212858966c64cf81509440687"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591620826000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602151685000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN029D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "f939b7e5-c1e0-4bd0-847f-00691d16282a",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "e833b7f1-7a3a-4435-b53a-122f25dfcc08": {
                        "host": "sd-indh-dev-ita-ipscan-csi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42"
                    },
                    "f939b7e5-c1e0-4bd0-847f-00691d16282a": {
                        "host": "sd-indh-dev-ita-ipscan-csi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN029D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN029"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Csi"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42",
                    "tenantId": "652c3409d9b2811defb5f009346b8e1f"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591363666000,
                "updatedBy": "technicalUser",
                "updatedOn": 1596447578000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "3559f164-1219-4f11-b1b9-f3eeb2764363",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "3559f164-1219-4f11-b1b9-f3eeb2764363": {
                        "host": "sd-indh-dev-ita-ipqcan-strategia-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "328c6725-0c23-4888-b9c5-8f8a5cad15e6"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Strategia"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "328c6725-0c23-4888-b9c5-8f8a5cad15e6",
                    "tenantId": "d144c3d83d2c299d70ade301ae280b26"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591180551000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603993158000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1604079582000,
            "updatedBy": "sysUser",
            "updatedOn": 1604079582000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "ipdaida004D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "f1789095-966a-44c5-9171-b49f14e1f05f",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "15f137ef-8056-4df9-b70d-33fc872a06c4": {
                        "host": "sd-indh-dev-ita-ipdaida004-aidadesk-inf-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28"
                    },
                    "f1789095-966a-44c5-9171-b49f14e1f05f": {
                        "host": "sd-indh-dev-ita-ipdaida004-aidadesk-inf-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "ipdaida004D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA004"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Desktop Inf"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28",
                    "tenantId": "427226ffb0d20d0ea108c7f6dbe1ece4"
                },
                "createdBy": "technicalUser",
                "createdOn": 1589385693000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604075074000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSITID002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "d47c3b08-086b-4ac7-a92a-691d360a76f9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "d47c3b08-086b-4ac7-a92a-691d360a76f9": {
                        "host": "sd-indh-dev-ita-ipsitid002-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "39d7977a-42b3-459d-b9b9-dfa07438c68e"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSITID002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Home"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "39d7977a-42b3-459d-b9b9-dfa07438c68e",
                    "tenantId": "d04f74b517c4660ccd5c31ed855bed30"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590487234000,
                "updatedBy": "technicalUser",
                "updatedOn": 1591708418000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "eab21e19-f631-40d0-8d77-a9afba6373a9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "2fc254a7-9a32-4984-9528-917cbe8e0b61": {
                        "host": "sd-indh-dev-ita-ipqcan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62"
                    },
                    "eab21e19-f631-40d0-8d77-a9afba6373a9": {
                        "host": "sd-indh-dev-ita-ipqcan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Home"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62",
                    "tenantId": "1db2ba777129ac3c8917c2248f3b9f2a"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591370458000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602581349000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "5bca7a4b-0d8d-4310-a62e-e3a91e27ab16",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "5bca7a4b-0d8d-4310-a62e-e3a91e27ab16": {
                        "host": "sd-indh-dev-ita-ipscpco002-listcon-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "90c78854-0365-4036-aebc-934ba2700a54"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Lista Contratti"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "90c78854-0365-4036-aebc-934ba2700a54",
                    "tenantId": "fe5dd167bd58ef8cb414c40e33204111"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592493915000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602087307000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM016D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "283d854a-dfe5-4aeb-990e-23c153c84292",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "283d854a-dfe5-4aeb-990e-23c153c84292": {
                        "host": "sd-indh-dev-ita-ipadam016-controlmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "232fa311-b884-4259-be93-1b768b78f24b"
                    },
                    "ca173f84-bf75-4f27-8067-e9e8bc228d07": {
                        "host": "sd-indh-dev-ita-ipadam016-controlmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "232fa311-b884-4259-be93-1b768b78f24b"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM016D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM016"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Controlli"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "232fa311-b884-4259-be93-1b768b78f24b",
                    "tenantId": "ac3d2241f271dcf912f818fd7d94ccc6"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591349996000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601979370000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPEIDEAS002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "e4853362-0051-4abd-a3ab-f4e3c5cc9f5c",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "e4853362-0051-4abd-a3ab-f4e3c5cc9f5c": {
                        "host": "sd-indh-dev-ita-ipeideas002-gestione-idee-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ce9fd7a1-7423-4884-89a1-2999f508e158"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPEIDEAS002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPEIDEAS002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - e-ideas - dev - Gestione Idee"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "ce9fd7a1-7423-4884-89a1-2999f508e158",
                    "tenantId": "bde59bf9896270c8a9a18354c31f3236"
                },
                "createdBy": "technicalUser",
                "createdOn": 1599142089000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604080586000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1603121956000,
            "updatedBy": "sysUser",
            "updatedOn": 1603121956000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSITID004D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "5c95c68d-5768-4fc7-a3e1-021675cf738d",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "5c95c68d-5768-4fc7-a3e1-021675cf738d": {
                        "host": "sd-indh-dev-ita-ipsitid004-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9ba28c48-6c7c-40f5-9e88-b9e46d1eff33"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSITID004D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID004"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Infortuni"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "9ba28c48-6c7c-40f5-9e88-b9e46d1eff33",
                    "tenantId": "d51d355e1e2db38c3453324d6356ebb7"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590487459000,
                "updatedBy": "technicalUser",
                "updatedOn": 1591711584000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "aadab8ec-f0de-47f9-9c8c-0de6407827f9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "aadab8ec-f0de-47f9-9c8c-0de6407827f9": {
                        "host": "sd-indh-dev-ita-ipscpco003-gestpar-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "184b5e60-08c5-46fe-ad90-1561de6ce074"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Gestione Parametri"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "184b5e60-08c5-46fe-ad90-1561de6ce074",
                    "tenantId": "88fa307087a767bef61e2608b34d218b"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592404804000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601905981000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM017D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a9c601be-f8cf-4d73-81d0-e59c90b06592",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "a2a05327-c486-4e99-ad17-ba3eed4a2b4a": {
                        "host": "sd-indh-dev-ita-ipadam017-verificationmgt-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb"
                    },
                    "a9c601be-f8cf-4d73-81d0-e59c90b06592": {
                        "host": "sd-indh-dev-ita-ipadam017-verificationmgt-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM017D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM017"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Verifiche"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb",
                    "tenantId": "62b86926b60d16809c4fa2c7edd0c8e4"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591354218000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601979740000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN028D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "dd82b79f-cfcd-48c2-8aa0-b277444964c9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "dd82b79f-cfcd-48c2-8aa0-b277444964c9": {
                        "host": "sd-indh-dev-ita-ipscan-file-uploader-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b29f6302-dffb-4592-8326-16d289e408c3"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN028D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN028"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - FILE_UPLOADER-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "b29f6302-dffb-4592-8326-16d289e408c3",
                    "tenantId": "e17457a9358a584ab7b87a9b04179ea2"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590482576000,
                "updatedBy": "technicalUser",
                "updatedOn": 1592295220000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN032D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "bd8054a9-7389-4eac-ba5d-a6545e5c5bfa",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "bd8054a9-7389-4eac-ba5d-a6545e5c5bfa": {
                        "host": "sd-indh-dev-ita-ipscan-report-con-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9aadf6e-1ce0-4b22-87a5-fa361a3e04e3"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN032D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN032"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - REPORT_CONTROLLI-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "d9aadf6e-1ce0-4b22-87a5-fa361a3e04e3",
                    "tenantId": "a4f9f7ecbf56305eb839429c8c2186e1"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592837632000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603985250000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPPEGASO003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "7d18ede2-2408-42a7-a460-4cd4bf9d07ea",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "6dcf7b43-fa34-4df9-a695-70d29fcc58a9": {
                        "host": "sd-indh-dev-ita-ippegaso003-pannello-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4"
                    },
                    "7d18ede2-2408-42a7-a460-4cd4bf9d07ea": {
                        "host": "sd-indh-dev-ita-ippegaso003-pannello-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPPEGASO003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Pannello"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4",
                    "tenantId": "fd347639974d559f3451d27eb0671b72"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594108270000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603894390000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN014D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "401f3f38-ecc9-49ed-96c7-a37957222096",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "401f3f38-ecc9-49ed-96c7-a37957222096": {
                        "host": "sd-indh-dev-ita-ipscan-tar-enel-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "10bc16b1-bf34-4094-ab6b-ebb2a2f4ebf8"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN014D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN014"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CRUSCOTTO_TARGET_ENEL-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "10bc16b1-bf34-4094-ab6b-ebb2a2f4ebf8",
                    "tenantId": "38b06527b36b23852444bc805a07e4e5"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591352739000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603896455000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM022D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "e97b6f45-96b7-4693-9647-71b74ce95c96",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "d4755975-3e88-4785-b9c4-52ac3b738a77": {
                        "host": "sd-indh-dev-ita-ipadam022-notificationsln-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49"
                    },
                    "e97b6f45-96b7-4693-9647-71b74ce95c96": {
                        "host": "sd-indh-dev-ita-ipadam022-notificationsln-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM022D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM022"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Notifiche"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49",
                    "tenantId": "9c9d848942e15f18e2bf53c12e9c6fc2"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594996214000,
                "updatedBy": "technicalUser",
                "updatedOn": 1600852575000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM013D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "00d8eaa9-5e17-4458-9ccb-6b50344a682f",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "00d8eaa9-5e17-4458-9ccb-6b50344a682f": {
                        "host": "sd-indh-dev-ita-ipadam004-spectec-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f1b56250-6dce-4b2e-96fd-971afe24ba24"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM013D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM013"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Specifiche Tecniche"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "f1b56250-6dce-4b2e-96fd-971afe24ba24",
                    "tenantId": "0ce61ff731d1614b2ed8f59224bb10d9"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591350337000,
                "updatedBy": "technicalUser",
                "updatedOn": 1592562855000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO008D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "b616fcdb-e500-4a89-9ef4-9a2f491d5392",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "b616fcdb-e500-4a89-9ef4-9a2f491d5392": {
                        "host": "sd-indh-dev-ita-ipscpco008-piacom-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "2294c59e-2816-4da9-b0d9-9b839625a70e"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO008D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO008"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Piano Committenza"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "2294c59e-2816-4da9-b0d9-9b839625a70e",
                    "tenantId": "16a1b02c1fe4629de7da8eafca90d039"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592412225000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601911060000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPPEGASO001D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "1fa1ea26-9c1f-48aa-9611-fff02866a0b3",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "1fa1ea26-9c1f-48aa-9611-fff02866a0b3": {
                        "host": "sd-indh-dev-ita-ippegaso001-pegasohome-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c0afa7c2-6927-448a-b4d7-91828b5119c3"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPPEGASO001D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO001"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - HomePage"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "c0afa7c2-6927-448a-b4d7-91828b5119c3",
                    "tenantId": "508cf6cf6dc0eb50385d921cafcb39ad"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594056647000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602156418000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "cfb2a96a-c289-4680-8add-1a9282804f8c",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "69fc732a-ce28-4467-a1c6-459c97be8189": {
                        "host": "sd-indh-dev-ita-ipqcan-parametri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376"
                    },
                    "cfb2a96a-c289-4680-8add-1a9282804f8c": {
                        "host": "sd-indh-dev-ita-ipqcan-parametri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Parametri"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376",
                    "tenantId": "5b860513708c473c08a4fe72fc52619d"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592998294000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602591422000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "testportale",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "8278c6bd-efea-4491-823c-1072ae9b7607",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "8278c6bd-efea-4491-823c-1072ae9b7607": {
                        "host": "sd-indh-dev-ita-testportale-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b52fd855-ffea-4ac6-81bb-3707537cf63e"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "testportale"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "Prova MTA Extension info tile"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "Prova Portal Site"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "b52fd855-ffea-4ac6-81bb-3707537cf63e",
                    "tenantId": "82746e7595cf8de5a124f94d6f281b58"
                },
                "createdBy": "technicalUser",
                "createdOn": 1588062000000,
                "updatedBy": "technicalUser",
                "updatedOn": 1588148982000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPGEA002DEV",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "7fe1759c-22b1-4c63-bead-e8e6c3f425bd",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "496d030d-844b-4a32-aea2-8639027f0eeb": {
                        "host": "sd-indh-dev-ita-ipgea002-gescicli-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc"
                    },
                    "7fe1759c-22b1-4c63-bead-e8e6c3f425bd": {
                        "host": "sd-indh-dev-ita-ipgea002-gescicli-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPGEA002DEV"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDGEA002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "GEA - Gestione Cicli"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc",
                    "tenantId": "6604633dd4701d0fd769cd8d9a0cb4d8"
                },
                "createdBy": "technicalUser",
                "createdOn": 1588586207000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604076995000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN024D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "170bb5c2-089d-4cef-ac15-e0f00cb8c6db",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "134819ca-2dab-4828-9b70-71abb8c2213c": {
                        "host": "sd-indh-dev-ita-ipscan-rt-impresa-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a"
                    },
                    "170bb5c2-089d-4cef-ac15-e0f00cb8c6db": {
                        "host": "sd-indh-dev-ita-ipscan-rt-impresa-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN024D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN024"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Riepilogo target impresa"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a",
                    "tenantId": "88fe12182e8fadd22ef371a6a19965ae"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591375737000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602060113000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO011D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "4f07a131-aa52-46ba-9ccf-831c4e083163",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "4f07a131-aa52-46ba-9ccf-831c4e083163": {
                        "host": "sd-indh-dev-ita-ipscpco011-dettmat-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "64525d8d-e624-4103-ac1a-e5d0b911eb0d"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO011D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO011"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Dettaglio Matricola"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "64525d8d-e624-4103-ac1a-e5d0b911eb0d",
                    "tenantId": "a32fd078f808cc3bbe82c26d2c6a2db3"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592824666000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603982911000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPAMPERE002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "25f6e163-2d72-4003-8ef7-05cd363c6c87",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "25f6e163-2d72-4003-8ef7-05cd363c6c87": {
                        "host": "sd-indh-dev-ita-ipampere002-plugins-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ecf05045-fd30-4439-be61-3aeae693977b"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPAMPERE002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPAMPERE002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "Ampere Plugins"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "ecf05045-fd30-4439-be61-3aeae693977b",
                    "tenantId": "79b138bb2f8e955abf01f19392050638"
                },
                "createdBy": "technicalUser",
                "createdOn": 1595843177000,
                "updatedBy": "technicalUser",
                "updatedOn": 1595843177000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPPEGASO002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "0ac330a7-3420-45d7-861d-b2c573d7f2db",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "0ac330a7-3420-45d7-861d-b2c573d7f2db": {
                        "host": "sd-indh-dev-ita-ippegaso002-pegasoparamsba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa"
                    },
                    "665a3ada-c991-43ed-9a8c-a03f350e36b3": {
                        "host": "sd-indh-dev-ita-ippegaso002-pegasoparamsba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPPEGASO002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Parametri"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                    "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa",
                    "tenantId": "221175169fe21313bc1294eef7b9cc2b"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594103690000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603191537000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "ipdaida010D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "4deec730-7463-4016-a0be-1c036977516a",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "4deec730-7463-4016-a0be-1c036977516a": {
                        "host": "sd-indh-dev-ita-ipdaida010-gestionenews-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "7160bdf9-38bf-4bd0-8ce3-90703ab330e9"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "ipdaida010D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA010"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA News"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "7160bdf9-38bf-4bd0-8ce3-90703ab330e9",
                    "tenantId": "1a27b4efa52bffee2c06509d6aa624c0"
                },
                "createdBy": "technicalUser",
                "createdOn": 1589472678000,
                "updatedBy": "technicalUser",
                "updatedOn": 1589902485000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN026D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "b42b1f47-7736-4d91-8ebe-d6ed6c4b9853",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "b42b1f47-7736-4d91-8ebe-d6ed6c4b9853": {
                        "host": "sd-indh-dev-ita-ipscan-cruscotto-team-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3"
                    },
                    "f6b5c7c0-7ef3-4b03-8cfc-26c16c68f96b": {
                        "host": "sd-indh-dev-ita-ipscan-cruscotto-team-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN026D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN026"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CRUSCOTTO_TEAM-BA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3",
                    "tenantId": "bc89774742812f629c6c70d5e0b7d01f"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590498506000,
                "updatedBy": "technicalUser",
                "updatedOn": 1598375124000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN009D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "48153d0c-15f9-4d46-9a1c-4ec58f8b0efd",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "48153d0c-15f9-4d46-9a1c-4ec58f8b0efd": {
                        "host": "sd-indh-dev-ita-ipqcan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515"
                    },
                    "900786ba-7170-4d9c-a1ff-a8dd96f19e7d": {
                        "host": "sd-indh-dev-ita-ipqcan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN009D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN009"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Checklist"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515",
                    "tenantId": "d83c8f802c694cabdaf1e1ac22b52318"
                },
                "createdBy": "technicalUser",
                "createdOn": 1593709751000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604081602000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO006D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "1c448015-093f-4111-8b77-ec785999f1f1",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "1c448015-093f-4111-8b77-ec785999f1f1": {
                        "host": "sd-indh-dev-ita-ipscpco006-listmov-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "51e6e6b7-81af-4a91-b4a9-8d70bdb27eb5"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO006D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO006"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Entrata Merci"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "51e6e6b7-81af-4a91-b4a9-8d70bdb27eb5",
                    "tenantId": "cc3f9be104563ede1a278a44ecf9f69d"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592497431000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601907693000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO009D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "38a135a9-aefc-40d7-ad29-400ef15ca3d9",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "38a135a9-aefc-40d7-ad29-400ef15ca3d9": {
                        "host": "sd-indh-dev-ita-ipscpco009-home-ui-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "efc7ceba-e00d-468a-8ada-b18779eb8f9f"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO009D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO009"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Home"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "efc7ceba-e00d-468a-8ada-b18779eb8f9f",
                    "tenantId": "70777e624d6352177b2c726c559e2712"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592835406000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602844481000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM002D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "cce1149f-cac5-4664-be17-432b799c9ba8",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "cce1149f-cac5-4664-be17-432b799c9ba8": {
                        "host": "sd-indh-dev-ita-ipadam002-scheda-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9994f4e-292b-4a9c-9beb-729424cfe342"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM002D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM002"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Scheda Dotazione"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "d9994f4e-292b-4a9c-9beb-729424cfe342",
                    "tenantId": "9f07db12a2478dead444d3710b99fde1"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591352245000,
                "updatedBy": "technicalUser",
                "updatedOn": 1594136292000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPEIDEAS004D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "6ea1473e-c2fa-4a57-a25a-6d2b0754b5fe",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "6ea1473e-c2fa-4a57-a25a-6d2b0754b5fe": {
                        "host": "sd-indh-dev-ita-ipeideas004-home-page-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a8011780-3c2e-4217-a46f-84c980a3c29e"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPEIDEAS004D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPEIDEAS004"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - e-ideas - dev - Home"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "a8011780-3c2e-4217-a46f-84c980a3c29e",
                    "tenantId": "268fd021c9c87ce1d03a34ef7af17d3a"
                },
                "createdBy": "technicalUser",
                "createdOn": 1594992218000,
                "updatedBy": "technicalUser",
                "updatedOn": 1602519856000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1603121991000,
            "updatedBy": "sysUser",
            "updatedOn": 1603121991000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM014D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "073585c0-f134-4053-88b4-ce82998a6759",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "073585c0-f134-4053-88b4-ce82998a6759": {
                        "host": "sd-indh-dev-ita-ipadam003-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "adc7cde6-a190-4de0-a3bf-04e32f8e36f5"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM014D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM014"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Homepage"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "adc7cde6-a190-4de0-a3bf-04e32f8e36f5",
                    "tenantId": "20acfc6cb4cd3f9c1f6d4c5b8ffa869c"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591350124000,
                "updatedBy": "technicalUser",
                "updatedOn": 1595868351000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN011D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a2bf53c6-572f-4de3-bca8-fd078cd2a6ad",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "a2bf53c6-572f-4de3-bca8-fd078cd2a6ad": {
                        "host": "sd-indh-dev-ita-ipscan-target-i-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1725a93e-d780-405d-b254-2fbea838507d"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN011D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN011"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Target Impresa CFL"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "1725a93e-d780-405d-b254-2fbea838507d",
                    "tenantId": "8f90db759ef05bb22bac3a39ca9e481c"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591370809000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603724474000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO007D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "e9adec60-85b2-474e-8f79-094b28c8484e",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "e9adec60-85b2-474e-8f79-094b28c8484e": {
                        "host": "sd-indh-dev-ita-ipscpco007-oda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "59d40d08-6266-4763-b147-f552ec3bba50"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO007D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO007"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Dettaglio OdA"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "59d40d08-6266-4763-b147-f552ec3bba50",
                    "tenantId": "93750d940f7a2c765eca43b92039c7ee"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592564650000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601909911000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCPCO012D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "69070fcb-90f9-4084-8893-d0849f39ff53",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "69070fcb-90f9-4084-8893-d0849f39ff53": {
                        "host": "sd-indh-dev-ita-ipscpco012-dbform-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "83b871a8-19f8-4506-a916-df16b419777d"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCPCO012D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO012"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 \u2013 cosm - dev - Parametri ICT"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                    "instanceId": "83b871a8-19f8-4506-a916-df16b419777d",
                    "tenantId": "b393e879b87c5dd3519d795387778826"
                },
                "createdBy": "technicalUser",
                "createdOn": 1592823615000,
                "updatedBy": "technicalUser",
                "updatedOn": 1601913378000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM004D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "a2629c1e-dbc1-4f61-8f73-07bf125003f3",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "38f75820-3ab3-423f-b820-1f8cc4e82619": {
                        "host": "sd-indh-dev-ita-ipadam003-nuova-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691"
                    },
                    "a2629c1e-dbc1-4f61-8f73-07bf125003f3": {
                        "host": "sd-indh-dev-ita-ipadam003-nuova-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM004D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM004"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Nuova Dotazione"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691",
                    "tenantId": "d3c196ee78335544b1965924dbc03663"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591352241000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603291172000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPADAM018D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "d000e761-6186-45d6-97e6-8936c5205360",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "d000e761-6186-45d6-97e6-8936c5205360": {
                        "host": "sd-indh-dev-ita-ipadam018-configmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "499459e7-49a9-4a51-a730-3c2e16da14ab"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPADAM018D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM018"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Configurazione"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "499459e7-49a9-4a51-a730-3c2e16da14ab",
                    "tenantId": "d3c1368d6573d281cad9046a972d5ce9"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591367290000,
                "updatedBy": "technicalUser",
                "updatedOn": 1600852226000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSITID003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "c071249a-b263-4b9e-98dd-cc08285ebf23",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "providerType": "cf"
                },
                "systemAliases": {
                    "c071249a-b263-4b9e-98dd-cc08285ebf23": {
                        "host": "sd-indh-dev-ita-ipsitid003-nearmiss-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c26842d2-de03-4501-8520-ce2a4580cc56"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSITID003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Nearmiss"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "c26842d2-de03-4501-8520-ce2a4580cc56",
                    "tenantId": "e03b8cadd71016a5bbf41cfab18039b9"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590487953000,
                "updatedBy": "technicalUser",
                "updatedOn": 1591778116000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN003D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "7bc359d7-a4fb-461e-9ff9-fc3ca1b83bbd",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "7bc359d7-a4fb-461e-9ff9-fc3ca1b83bbd": {
                        "host": "sd-indh-dev-ita-ipscan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581"
                    },
                    "94bc1798-9320-41bb-8eaf-975e459cf520": {
                        "host": "sd-indh-dev-ita-ipscan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN003D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN003"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Checklist"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581",
                    "tenantId": "e20bddc1499811395384a9e5fbaad627"
                },
                "createdBy": "technicalUser",
                "createdOn": 1591196420000,
                "updatedBy": "technicalUser",
                "updatedOn": 1600177813000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "ipdaida007D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "0b412117-ec69-4ec7-82fb-2ac765315938",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "0b412117-ec69-4ec7-82fb-2ac765315938": {
                        "host": "sd-indh-dev-ita-ipdaida007-aidareports-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "01447d11-7b26-4e25-b468-66e8b7757cd4"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "ipdaida007D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA007"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Reports"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                    "instanceId": "01447d11-7b26-4e25-b468-66e8b7757cd4",
                    "tenantId": "870c18f51e3e877e4226ce2861cb4dd1"
                },
                "createdBy": "technicalUser",
                "createdOn": 1589453929000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603795384000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1602231875000,
            "updatedBy": "sysUser",
            "updatedOn": 1602231875000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPSCAN016D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "621fb1f7-1ade-475a-96b8-0b1d4f0fdf61",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "621fb1f7-1ade-475a-96b8-0b1d4f0fdf61": {
                        "host": "sd-indh-dev-ita-ipscan-controllori-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9"
                    },
                    "c4d06a2e-4710-491b-a54d-9bafae780a15": {
                        "host": "sd-indh-dev-ita-ipscan-controllori-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPSCAN016D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN016"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controllori"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9",
                    "tenantId": "935c509bfc86ed287fae897256a2892a"
                },
                "createdBy": "technicalUser",
                "createdOn": 1590589482000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603982243000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "IPQCAN006D",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "endpoints": [
                    {
                        "system": "b05826e1-2d34-41ea-9cce-c87bbeee2e5b",
                        "type": "runtime"
                    }
                ],
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "providerType": "cf"
                },
                "systemAliases": {
                    "18b5b856-159e-4984-8ff6-ee88830fb11f": {
                        "host": "sd-indh-dev-ita-ipqcan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28"
                    },
                    "b05826e1-2d34-41ea-9cce-c87bbeee2e5b": {
                        "host": "sd-indh-dev-ita-ipqcan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28"
                    }
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "IPQCAN006D"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN006"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controlli"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                    "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28",
                    "tenantId": "2515f19a8a0b376a0d129cb57e1133db"
                },
                "createdBy": "technicalUser",
                "createdOn": 1593773685000,
                "updatedBy": "technicalUser",
                "updatedOn": 1603989898000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    },
    {
        "cdm": {
            "_version": "3.0.0",
            "identification": {
                "description": "{{cdm|identification|description}}",
                "entityType": "provider",
                "id": "saas_approuter",
                "title": "{{cdm|identification|title}}"
            },
            "payload": {
                "exposedContent": "SAAS_APPROUTER",
                "providerMetadata": {
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual",
                    "instanceId": "SAAS_APPROUTER_HTML5_APP_REPO",
                    "providerType": "cf",
                    "status": "SUCCEEDED",
                    "subaccountId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                    "subdomain": "sd-indh-dev-ita"
                }
            },
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider",
                            "id": "saas_approuter_sd-indh-dev-ita"
                        }
                    }
                ]
            },
            "texts": {
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "Subdomain: sd-indh-dev-ita"
                    }
                },
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "HTML5 Apps"
                    }
                }
            }
        },
        "metadata": {
            "base": {
                "context": {
                    "contextType": "sub_account",
                    "id": "SUB_ACCOUNT",
                    "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                    "instanceId": "SAAS_APPROUTER_HTML5_APP_REPO",
                    "tenantId": "60d6eb39d4476b1c503b915bcfb87b87"
                },
                "createdBy": "technicalUser",
                "createdOn": 1596361015000,
                "updatedBy": "technicalUser",
                "updatedOn": 1604075973000
            },
            "context": {
                "contextType": "sub_account",
                "id": "SUB_ACCOUNT",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
                "tenantId": "793af3ee51a275e7ef850d5403b61c42"
            },
            "createdBy": "sysUser",
            "createdOn": 1596366033000,
            "updatedBy": "sysUser",
            "updatedOn": 1596366033000
        }
    }
]

                11.1.2.1.4 Search providers
ask for IDs:
Can you plz provide the portal instance guid?- You can get it by running: $ cf service <instance name> --guid
And also the tenant ID and the subaccount ID?



a. create token
    
( for reference: portal gct -a portal-cf-cdm-store-service -p Desktop/ads.json
    
instanceId: ""
tenantId: ""
userName: ""
isProvider: "false"
    postman, search for entityType="provider"
    )

- Example for my account:
 portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "e013e90d-245b-4500-acca-cf34f14ea287","instanceId": "b22dcea4-6c61-4dab-875f-a8fa2d952f3c","userName":"techUser","isProvider":"false"}'
take them from 
cf env portal-cf-cdm-store-service
for PaaS portal/launchpad token:
cf env portal-cf-cdm-store-service | grep launchpadInstanceId && cf env portal-cf-cdm-store-service | grep tenantid
[i500695@C02X632CJGH6:2020-11-03 13:39:08:~/work/SAP/git/portal-cf-cdm-store-service:]2015$ cf env portal-cf-cdm-store-service | grep launchpadInstanceId
    "launchpadInstanceId": "b22dcea4-6c61-4dab-875f-a8fa2d952f3c",
[i500695@C02X632CJGH6:2020-11-03 13:39:42:~/work/SAP/git/portal-cf-cdm-store-service:]2016$ cf env portal-cf-cdm-store-service | grep tenantid
    "tenantid": "65e227fa-3e4d-42e2-84f7-d8e7fb13166e",

For SaaS token. take tenant ID from SaaS cockpit. 
e.g. https://account.int.sap.eu2.hana.ondemand.com/cockpit#/globalaccount/e9d1845d-4ca1-4a6c-b727-9837f55f035f/subaccount/e013e90d-245b-4500-acca-cf34f14ea287/details
"
Subaccount Details
Subdomain: i310019launchpad
ID: e013e90d-245b-4500-acca-cf34f14ea287
"
ID is the tenant ID

- for customer:
-- SaaS URL: https://sd-indh-dev-ita.dt.cpp.cfapps.eu10.hana.ondemand.com/sites#Content-Manage
-- Portal URL: https://portal-service.cfapps.eu10.hana.ondemand.com/ 
$ cf app portal-cf-cdm-store-service | grep routes
routes:            portal-service.cfapps.eu10.hana.ondemand.com/cdm_store_service

-- Portal instance ID
$ cf env portal-cf-cdm-store-service | grep portalIns
    "portalInstanceId": "67b8e37d-6e54-4fb3-94ee-4fcdeea9740a",
-- Launchpad instance ID
$ cf env portal-cf-cdm-store-service | grep launchpadInstanceId
    "launchpadInstanceId": "9d074872-3496-453c-8dde-6249f6a3c059",
-- SaaS tenant ID, 4a795a74-7e74-40d9-85c4-072e4e8620c9  
-- APollo Paas,  7960029c-394b-4068-a3e0-0256a9bbd094 
-- Apollo computed tenantId, 4455405132d09853fc23dea18fb3bb1e
-- Appolo GUID (IPEIDEAS006D), 57e6395f-fbae-461f-ab28-818eb0e2afb3


 customer + launchpad token: $portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "4a795a74-7e74-40d9-85c4-072e4e8620c9","instanceId": "9d074872-3496-453c-8dde-6249f6a3c059","userName":"techUser","isProvider":"false"}'

queries:
a1. cherry-pick providers:
curl --location --request POST 'https://portal-service.cfapps.eu10.hana.ondemand.com/cdm_store_service/cdm/search' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw '{
  "metadata":{
    "context": {
      "id": "SUB_ACCOUNT",
      "contextType": "sub_account"
    },
    "page": {
      "number": 1,
      "size": 100
    }
  },
"match": [{"/cdm/identification/entityType": "provider"} ]

}'
a2.
request:
curl --location --request POST 'https://portal-service.cfapps.eu10.hana.ondemand.com/cdm_store_service/cdm/entities/search?contextId=SUB_ACCOUNT&contextType=sub_account&withRelationTypes=extends' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw '{
  "metadata":{
    
  },
"match": [{"/cdm/identification/entityType": "provider"} ]

}'

response:
[
    {
        "metadata": {
            "updatedOn": 1601909911000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592564650000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "93750d940f7a2c765eca43b92039c7ee",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "59d40d08-6266-4763-b147-f552ec3bba50"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Dettaglio OdA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO007"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "e9adec60-85b2-474e-8f79-094b28c8484e"
                    }
                ],
                "systemAliases": {
                    "e9adec60-85b2-474e-8f79-094b28c8484e": {
                        "host": "{tenantHost}-ipscpco007-oda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "59d40d08-6266-4763-b147-f552ec3bba50"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO007D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "1fa1ea26-9c1f-48aa-9611-fff02866a0b3": {
                        "host": "sd-indh-dev-ita-ippegaso001-pegasohome-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c0afa7c2-6927-448a-b4d7-91828b5119c3"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPPEGASO001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPPEGASO001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "073585c0-f134-4053-88b4-ce82998a6759": {
                        "host": "sd-indh-dev-ita-ipadam003-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "adc7cde6-a190-4de0-a3bf-04e32f8e36f5"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM014D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM014D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a002324e-bed6-4ca9-8bdd-0dddb09b219b": {
                        "host": "sd-indh-dev-ita-ipscan-cantieri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602087307000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592493915000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fe5dd167bd58ef8cb414c40e33204111",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "90c78854-0365-4036-aebc-934ba2700a54"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Lista Contratti"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "5bca7a4b-0d8d-4310-a62e-e3a91e27ab16"
                    }
                ],
                "systemAliases": {
                    "5bca7a4b-0d8d-4310-a62e-e3a91e27ab16": {
                        "host": "{tenantHost}-ipscpco002-listcon-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "90c78854-0365-4036-aebc-934ba2700a54"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a2bf53c6-572f-4de3-bca8-fd078cd2a6ad": {
                        "host": "sd-indh-dev-ita-ipscan-target-i-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1725a93e-d780-405d-b254-2fbea838507d"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN011D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN011D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1600852575000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594996214000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "9c9d848942e15f18e2bf53c12e9c6fc2",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Notifiche"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM022"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "e97b6f45-96b7-4693-9647-71b74ce95c96"
                    }
                ],
                "systemAliases": {
                    "e97b6f45-96b7-4693-9647-71b74ce95c96": {
                        "host": "{tenantHost}-ipadam022-notificationsln-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM022D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1601905604000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592402185000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d970cc06dbeb4d21c7510fdc402df990",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "9997b2be-8fb5-45ac-af9d-55860c184e13"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Anagrafica Materiali"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "4a8001ff-8fd9-47b6-8c7b-f0a8f0d09981"
                    }
                ],
                "systemAliases": {
                    "4a8001ff-8fd9-47b6-8c7b-f0a8f0d09981": {
                        "host": "{tenantHost}-ipscpco001-anamat-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9997b2be-8fb5-45ac-af9d-55860c184e13"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1606211451000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591275257000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "8f2280b19456c025ffd7a374c535a335",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Magazzino"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM007"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "aa6413bf-b101-4f68-9fcb-cbca2f8c4b4d"
                    }
                ],
                "systemAliases": {
                    "aa6413bf-b101-4f68-9fcb-cbca2f8c4b4d": {
                        "host": "{tenantHost}-ipadam007-virtualstore-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM007D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1591778116000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590487953000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "e03b8cadd71016a5bbf41cfab18039b9",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "c26842d2-de03-4501-8520-ce2a4580cc56"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Nearmiss"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "c071249a-b263-4b9e-98dd-cc08285ebf23"
                    }
                ],
                "systemAliases": {
                    "c071249a-b263-4b9e-98dd-cc08285ebf23": {
                        "host": "{tenantHost}-ipsitid003-nearmiss-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c26842d2-de03-4501-8520-ce2a4580cc56"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "IPSITID003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602591422000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592998294000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "5b860513708c473c08a4fe72fc52619d",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Parametri"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "cfb2a96a-c289-4680-8add-1a9282804f8c"
                    }
                ],
                "systemAliases": {
                    "cfb2a96a-c289-4680-8add-1a9282804f8c": {
                        "host": "{tenantHost}-ipqcan-parametri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "7fe1759c-22b1-4c63-bead-e8e6c3f425bd": {
                        "host": "sd-indh-dev-ita-ipgea002-gescicli-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPGEA002DEV",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPGEA002DEV",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a1f46bd0-3259-4286-b81a-2bbf332f5ee8": {
                        "host": "sd-indh-dev-ita-ipadam003-dotazioni-assegnate-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "4a8001ff-8fd9-47b6-8c7b-f0a8f0d09981": {
                        "host": "sd-indh-dev-ita-ipscpco001-anamat-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9997b2be-8fb5-45ac-af9d-55860c184e13"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "48153d0c-15f9-4d46-9a1c-4ec58f8b0efd": {
                        "host": "sd-indh-dev-ita-ipqcan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN009D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN009D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "cfb2a96a-c289-4680-8add-1a9282804f8c": {
                        "host": "sd-indh-dev-ita-ipqcan-parametri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ed42262d-fad8-4a97-ab70-7cc328893376"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "298ee97c-a30b-41b5-b1e9-e3795d28aa45": {
                        "host": "sd-indh-dev-ita-ipscan-rie-safety-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN022D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN022D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602498878000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1588580799000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "89ac9bf2d103a4b9272b35b731c3a04f",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "85c4eea2-cb52-49e8-a90e-70704cfc5842"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "GEA - Home Page"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDGEA001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "c0a45e22-addd-46f9-a8b5-ae6319e6e5d1"
                    }
                ],
                "systemAliases": {
                    "c0a45e22-addd-46f9-a8b5-ae6319e6e5d1": {
                        "host": "{tenantHost}-ipgea001-homepage-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "85c4eea2-cb52-49e8-a90e-70704cfc5842"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPGEA001DEV",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1596447578000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591363666000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "652c3409d9b2811defb5f009346b8e1f",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Csi"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN029"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "f939b7e5-c1e0-4bd0-847f-00691d16282a"
                    }
                ],
                "systemAliases": {
                    "f939b7e5-c1e0-4bd0-847f-00691d16282a": {
                        "host": "{tenantHost}-ipscan-csi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN029D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "aadab8ec-f0de-47f9-9c8c-0de6407827f9": {
                        "host": "sd-indh-dev-ita-ipscpco003-gestpar-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "184b5e60-08c5-46fe-ad90-1561de6ce074"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "45b623c4-6d06-4dfb-bb38-d1c5d6c27e47": {
                        "host": "sd-indh-dev-ita-ipscpco013-rda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO013D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO013D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "69070fcb-90f9-4084-8893-d0849f39ff53": {
                        "host": "sd-indh-dev-ita-ipscpco012-dbform-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "83b871a8-19f8-4506-a916-df16b419777d"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO012D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO012D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "cce1149f-cac5-4664-be17-432b799c9ba8": {
                        "host": "sd-indh-dev-ita-ipadam002-scheda-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9994f4e-292b-4a9c-9beb-729424cfe342"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605806469000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1593709751000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d83c8f802c694cabdaf1e1ac22b52318",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Checklist"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN009"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "48153d0c-15f9-4d46-9a1c-4ec58f8b0efd"
                    }
                ],
                "systemAliases": {
                    "48153d0c-15f9-4d46-9a1c-4ec58f8b0efd": {
                        "host": "{tenantHost}-ipqcan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0bc2f782-0424-4786-aea0-a758b242c515"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN009D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1595868351000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591350124000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "20acfc6cb4cd3f9c1f6d4c5b8ffa869c",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "adc7cde6-a190-4de0-a3bf-04e32f8e36f5"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Homepage"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM014"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "073585c0-f134-4053-88b4-ce82998a6759"
                    }
                ],
                "systemAliases": {
                    "073585c0-f134-4053-88b4-ce82998a6759": {
                        "host": "{tenantHost}-ipadam003-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "adc7cde6-a190-4de0-a3bf-04e32f8e36f5"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM014D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "4deec730-7463-4016-a0be-1c036977516a": {
                        "host": "sd-indh-dev-ita-ipdaida010-gestionenews-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "7160bdf9-38bf-4bd0-8ce3-90703ab330e9"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "ipdaida010D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "ipdaida010D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "dd82b79f-cfcd-48c2-8aa0-b277444964c9": {
                        "host": "sd-indh-dev-ita-ipscan-file-uploader-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b29f6302-dffb-4592-8326-16d289e408c3"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN028D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN028D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604327877000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592824666000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "a32fd078f808cc3bbe82c26d2c6a2db3",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "64525d8d-e624-4103-ac1a-e5d0b911eb0d"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Dettaglio Matricola"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO011"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "4f07a131-aa52-46ba-9ccf-831c4e083163"
                    }
                ],
                "systemAliases": {
                    "4f07a131-aa52-46ba-9ccf-831c4e083163": {
                        "host": "{tenantHost}-ipscpco011-dettmat-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "64525d8d-e624-4103-ac1a-e5d0b911eb0d"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO011D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "7d878ecc-6e79-4c60-8659-02ab32bc11da": {
                        "host": "sd-indh-dev-ita-ipscan-esi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN031D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN031D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "d47c3b08-086b-4ac7-a92a-691d360a76f9": {
                        "host": "sd-indh-dev-ita-ipsitid002-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "39d7977a-42b3-459d-b9b9-dfa07438c68e"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSITID002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSITID002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604320494000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604320494000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "3559f164-1219-4f11-b1b9-f3eeb2764363": {
                        "host": "sd-indh-dev-ita-ipqcan-strategia-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "328c6725-0c23-4888-b9c5-8f8a5cad15e6"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605528274000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591349996000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "ac3d2241f271dcf912f818fd7d94ccc6",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "232fa311-b884-4259-be93-1b768b78f24b"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Controlli"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM016"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "283d854a-dfe5-4aeb-990e-23c153c84292"
                    }
                ],
                "systemAliases": {
                    "283d854a-dfe5-4aeb-990e-23c153c84292": {
                        "host": "{tenantHost}-ipadam016-controlmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "232fa311-b884-4259-be93-1b768b78f24b"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM016D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "99fa0b7f-6443-43c0-b679-b77d72d8513b": {
                        "host": "sd-indh-dev-ita-ipscpco010-fablord-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO010D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO010D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605008162000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590580631000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "31ac263e679515e46108dc178db875b9",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Contratti"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN004"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a1ed19f8-f7f6-4968-a321-d6154637aa40"
                    }
                ],
                "systemAliases": {
                    "a1ed19f8-f7f6-4968-a321-d6154637aa40": {
                        "host": "{tenantHost}-ipscan-contratti-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN004D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "c0a45e22-addd-46f9-a8b5-ae6319e6e5d1": {
                        "host": "sd-indh-dev-ita-ipgea001-homepage-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "85c4eea2-cb52-49e8-a90e-70704cfc5842"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPGEA001DEV",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPGEA001DEV",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "b05826e1-2d34-41ea-9cce-c87bbeee2e5b": {
                        "host": "sd-indh-dev-ita-ipqcan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN006D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN006D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "4f07a131-aa52-46ba-9ccf-831c4e083163": {
                        "host": "sd-indh-dev-ita-ipscpco011-dettmat-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "64525d8d-e624-4103-ac1a-e5d0b911eb0d"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO011D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO011D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "bd0f0d52-c64f-4351-8850-5eb94993d4e6": {
                        "host": "sd-indh-dev-ita-ipscan-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN017D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN017D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "f1789095-966a-44c5-9171-b49f14e1f05f": {
                        "host": "sd-indh-dev-ita-ipdaida004-aidadesk-inf-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "ipdaida004D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "ipdaida004D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "15a93cb0-ed63-4de4-9627-9c97d318f853": {
                        "host": "sd-indh-dev-ita-ippegaso006-gestione-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPPEGASO006D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPPEGASO006D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1601911060000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592412225000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "16a1b02c1fe4629de7da8eafca90d039",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "2294c59e-2816-4da9-b0d9-9b839625a70e"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Piano Committenza"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO008"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "b616fcdb-e500-4a89-9ef4-9a2f491d5392"
                    }
                ],
                "systemAliases": {
                    "b616fcdb-e500-4a89-9ef4-9a2f491d5392": {
                        "host": "{tenantHost}-ipscpco008-piacom-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "2294c59e-2816-4da9-b0d9-9b839625a70e"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO008D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604317217000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1596361015000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "60d6eb39d4476b1c503b915bcfb87b87",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "SAAS_APPROUTER_HTML5_APP_REPO"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "HTML5 Apps"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "Subdomain: sd-indh-dev-ita"
                    }
                }
            },
            "payload": {
                "exposedContent": "SAAS_APPROUTER",
                "providerMetadata": {
                    "status": "SUCCEEDED",
                    "subdomain": "sd-indh-dev-ita",
                    "instanceId": "SAAS_APPROUTER_HTML5_APP_REPO",
                    "providerType": "cf",
                    "subaccountId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "saas_approuter_sd-indh-dev-ita",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1601905981000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592404804000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "88fa307087a767bef61e2608b34d218b",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "184b5e60-08c5-46fe-ad90-1561de6ce074"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Gestione Parametri"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "aadab8ec-f0de-47f9-9c8c-0de6407827f9"
                    }
                ],
                "systemAliases": {
                    "aadab8ec-f0de-47f9-9c8c-0de6407827f9": {
                        "host": "{tenantHost}-ipscpco003-gestpar-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "184b5e60-08c5-46fe-ad90-1561de6ce074"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605787956000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594637354000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "bd544d4f99948d163987c8a5775ebfa6",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Gestione"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO006"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "15a93cb0-ed63-4de4-9627-9c97d318f853"
                    }
                ],
                "systemAliases": {
                    "15a93cb0-ed63-4de4-9627-9c97d318f853": {
                        "host": "{tenantHost}-ippegaso006-gestione-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "761648a2-4cb6-47d5-bdcf-82b03fc06959"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPPEGASO006D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "1c448015-093f-4111-8b77-ec785999f1f1": {
                        "host": "sd-indh-dev-ita-ipscpco006-listmov-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "51e6e6b7-81af-4a91-b4a9-8d70bdb27eb5"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO006D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO006D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "401f3f38-ecc9-49ed-96c7-a37957222096": {
                        "host": "sd-indh-dev-ita-ipscan-tar-enel-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "10bc16b1-bf34-4094-ab6b-ebb2a2f4ebf8"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN014D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN014D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1606211227000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1593076463000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "6e5987827cc794ff931eaf12cc128b9a",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - RdA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO013"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "45b623c4-6d06-4dfb-bb38-d1c5d6c27e47"
                    }
                ],
                "systemAliases": {
                    "45b623c4-6d06-4dfb-bb38-d1c5d6c27e47": {
                        "host": "{tenantHost}-ipscpco013-rda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f9a5eea9-4112-47ae-9e45-9fb25e67b146"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO013D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "621fb1f7-1ade-475a-96b8-0b1d4f0fdf61": {
                        "host": "sd-indh-dev-ita-ipscan-controllori-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN016D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN016D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "f939b7e5-c1e0-4bd0-847f-00691d16282a": {
                        "host": "sd-indh-dev-ita-ipscan-csi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6e84558d-0d48-41a8-905a-ec0c7e2a3b42"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN029D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN029D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "f5b2f16a-736d-44e4-8a61-066b651b1ce3": {
                        "host": "sd-indh-dev-ita-ipscan-anagrafiche-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "7bc359d7-a4fb-461e-9ff9-fc3ca1b83bbd": {
                        "host": "sd-indh-dev-ita-ipscan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "bd8054a9-7389-4eac-ba5d-a6545e5c5bfa": {
                        "host": "sd-indh-dev-ita-ipscan-report-con-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9aadf6e-1ce0-4b22-87a5-fa361a3e04e3"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN032D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN032D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1591708418000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590487234000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d04f74b517c4660ccd5c31ed855bed30",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "39d7977a-42b3-459d-b9b9-dfa07438c68e"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Home"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "d47c3b08-086b-4ac7-a92a-691d360a76f9"
                    }
                ],
                "systemAliases": {
                    "d47c3b08-086b-4ac7-a92a-691d360a76f9": {
                        "host": "{tenantHost}-ipsitid002-homepage-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "39d7977a-42b3-459d-b9b9-dfa07438c68e"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "IPSITID002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605689815000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594103690000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "221175169fe21313bc1294eef7b9cc2b",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Parametri"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "0ac330a7-3420-45d7-861d-b2c573d7f2db"
                    }
                ],
                "systemAliases": {
                    "0ac330a7-3420-45d7-861d-b2c573d7f2db": {
                        "host": "{tenantHost}-ippegaso002-pegasoparamsba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPPEGASO002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605090134000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591196420000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "e20bddc1499811395384a9e5fbaad627",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Checklist"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "7bc359d7-a4fb-461e-9ff9-fc3ca1b83bbd"
                    }
                ],
                "systemAliases": {
                    "7bc359d7-a4fb-461e-9ff9-fc3ca1b83bbd": {
                        "host": "{tenantHost}-ipscan-checklist-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ba3d29c9-591e-4fdd-8a21-16d2ee465581"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603724474000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591370809000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "8f90db759ef05bb22bac3a39ca9e481c",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "1725a93e-d780-405d-b254-2fbea838507d"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Target Impresa CFL"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN011"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a2bf53c6-572f-4de3-bca8-fd078cd2a6ad"
                    }
                ],
                "systemAliases": {
                    "a2bf53c6-572f-4de3-bca8-fd078cd2a6ad": {
                        "host": "{tenantHost}-ipscan-target-i-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1725a93e-d780-405d-b254-2fbea838507d"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN011D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a1ed19f8-f7f6-4968-a321-d6154637aa40": {
                        "host": "sd-indh-dev-ita-ipscan-contratti-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ddb44e68-eee9-4676-a06f-f2ef9479c28c"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN004D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN004D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1589902485000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1589472678000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "1a27b4efa52bffee2c06509d6aa624c0",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "7160bdf9-38bf-4bd0-8ce3-90703ab330e9"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA News"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA010"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "4deec730-7463-4016-a0be-1c036977516a"
                    }
                ],
                "systemAliases": {
                    "4deec730-7463-4016-a0be-1c036977516a": {
                        "host": "{tenantHost}-ipdaida010-gestionenews-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "7160bdf9-38bf-4bd0-8ce3-90703ab330e9"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "ipdaida010D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a9c601be-f8cf-4d73-81d0-e59c90b06592": {
                        "host": "sd-indh-dev-ita-ipadam017-verificationmgt-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM017D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM017D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603291172000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591352241000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d3c196ee78335544b1965924dbc03663",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Nuova Dotazione"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM004"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a2629c1e-dbc1-4f61-8f73-07bf125003f3"
                    }
                ],
                "systemAliases": {
                    "a2629c1e-dbc1-4f61-8f73-07bf125003f3": {
                        "host": "{tenantHost}-ipadam003-nuova-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM004D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604319720000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594108270000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fd347639974d559f3451d27eb0671b72",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - Pannello"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "7d18ede2-2408-42a7-a460-4cd4bf9d07ea"
                    }
                ],
                "systemAliases": {
                    "7d18ede2-2408-42a7-a460-4cd4bf9d07ea": {
                        "host": "{tenantHost}-ippegaso003-pannello-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPPEGASO003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605869462000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590589482000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "935c509bfc86ed287fae897256a2892a",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controllori"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN016"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "621fb1f7-1ade-475a-96b8-0b1d4f0fdf61"
                    }
                ],
                "systemAliases": {
                    "621fb1f7-1ade-475a-96b8-0b1d4f0fdf61": {
                        "host": "{tenantHost}-ipscan-controllori-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "4f483e5a-0baf-4ac9-aecf-aaf68aaba3b9"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN016D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603799807000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591873340000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "2292aee59166b8ff0330e8d2eff51118",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - RIEPILOGO_CONTROLLI_SAFETY_ENEL-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN022"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "298ee97c-a30b-41b5-b1e9-e3795d28aa45"
                    }
                ],
                "systemAliases": {
                    "298ee97c-a30b-41b5-b1e9-e3795d28aa45": {
                        "host": "{tenantHost}-ipscan-rie-safety-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "68d9bb75-b370-43c0-94b0-624828ea5cc5"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN022D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "cc352a11-b73b-4ba5-b518-c184f448feec": {
                        "host": "sd-indh-dev-ita-ipqcan-cqi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6b128816-a16c-43c1-86f5-155637350027"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN010D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN010D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1601913378000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592823615000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "b393e879b87c5dd3519d795387778826",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "83b871a8-19f8-4506-a916-df16b419777d"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Parametri ICT"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO012"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "69070fcb-90f9-4084-8893-d0849f39ff53"
                    }
                ],
                "systemAliases": {
                    "69070fcb-90f9-4084-8893-d0849f39ff53": {
                        "host": "{tenantHost}-ipscpco012-dbform-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "83b871a8-19f8-4506-a916-df16b419777d"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO012D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "c071249a-b263-4b9e-98dd-cc08285ebf23": {
                        "host": "sd-indh-dev-ita-ipsitid003-nearmiss-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c26842d2-de03-4501-8520-ce2a4580cc56"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSITID003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSITID003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "8278c6bd-efea-4491-823c-1072ae9b7607": {
                        "host": "sd-indh-dev-ita-testportale-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b52fd855-ffea-4ac6-81bb-3707537cf63e"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "testportale",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "testportale",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "0b412117-ec69-4ec7-82fb-2ac765315938": {
                        "host": "sd-indh-dev-ita-ipdaida007-aidareports-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "01447d11-7b26-4e25-b468-66e8b7757cd4"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "ipdaida007D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "ipdaida007D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {},
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "saas_approuter_sd-indh-dev-ita",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "saas_approuter",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1591711584000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590487459000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d51d355e1e2db38c3453324d6356ebb7",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "9ba28c48-6c7c-40f5-9e88-b9e46d1eff33"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - Infortuni"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID004"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "5c95c68d-5768-4fc7-a3e1-021675cf738d"
                    }
                ],
                "systemAliases": {
                    "5c95c68d-5768-4fc7-a3e1-021675cf738d": {
                        "host": "{tenantHost}-ipsitid004-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9ba28c48-6c7c-40f5-9e88-b9e46d1eff33"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "IPSITID004D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1592562855000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591350337000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "0ce61ff731d1614b2ed8f59224bb10d9",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "f1b56250-6dce-4b2e-96fd-971afe24ba24"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Specifiche Tecniche"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM013"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "00d8eaa9-5e17-4458-9ccb-6b50344a682f"
                    }
                ],
                "systemAliases": {
                    "00d8eaa9-5e17-4458-9ccb-6b50344a682f": {
                        "host": "{tenantHost}-ipadam004-spectec-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f1b56250-6dce-4b2e-96fd-971afe24ba24"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM013D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "aa6413bf-b101-4f68-9fcb-cbca2f8c4b4d": {
                        "host": "sd-indh-dev-ita-ipadam007-virtualstore-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1f1c4fbb-af45-4b7c-9b67-f273ed0b0576"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM007D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM007D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1599649868000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1589362353000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "e1f88476fddc3b794ac710a8c018b53e",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Desktop"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "86fc1dbf-87f3-4948-895e-1d1f61b6920d"
                    }
                ],
                "systemAliases": {
                    "86fc1dbf-87f3-4948-895e-1d1f61b6920d": {
                        "host": "{tenantHost}-ipdaida001-aidadesktop-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "ipdaida001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "86fc1dbf-87f3-4948-895e-1d1f61b6920d": {
                        "host": "sd-indh-dev-ita-ipdaida001-aidadesktop-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "906f5f2f-35ba-45e5-9ae5-30ab23e6a3b9"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "ipdaida001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "ipdaida001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "b161cb19-653a-4631-9da9-35aaf24fdba9": {
                        "host": "sd-indh-dev-ita-ipscan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b3027542-c916-4ba8-9f89-d6c2de0183b5"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN030D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN030D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "38a135a9-aefc-40d7-ad29-400ef15ca3d9": {
                        "host": "sd-indh-dev-ita-ipscpco009-home-ui-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "efc7ceba-e00d-468a-8ada-b18779eb8f9f"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO009D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO009D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "283d854a-dfe5-4aeb-990e-23c153c84292": {
                        "host": "sd-indh-dev-ita-ipadam016-controlmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "232fa311-b884-4259-be93-1b768b78f24b"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM016D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM016D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1606209262000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1589385693000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "427226ffb0d20d0ea108c7f6dbe1ece4",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Desktop Inf"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA004"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "f1789095-966a-44c5-9171-b49f14e1f05f"
                    }
                ],
                "systemAliases": {
                    "f1789095-966a-44c5-9171-b49f14e1f05f": {
                        "host": "{tenantHost}-ipdaida004-aidadesk-inf-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f3452bed-9eb1-4b9a-9921-c47d04c6ed28"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "ipdaida004D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1606151270000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1599142089000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "bde59bf9896270c8a9a18354c31f3236",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "ce9fd7a1-7423-4884-89a1-2999f508e158"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - e-ideas - dev - Gestione Idee"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPEIDEAS002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "e4853362-0051-4abd-a3ab-f4e3c5cc9f5c"
                    }
                ],
                "systemAliases": {
                    "e4853362-0051-4abd-a3ab-f4e3c5cc9f5c": {
                        "host": "{tenantHost}-ipeideas002-gestione-idee-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ce9fd7a1-7423-4884-89a1-2999f508e158"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPEIDEAS002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602151685000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591620826000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "5132b87212858966c64cf81509440687",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Anagrafiche"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "f5b2f16a-736d-44e4-8a61-066b651b1ce3"
                    }
                ],
                "systemAliases": {
                    "f5b2f16a-736d-44e4-8a61-066b651b1ce3": {
                        "host": "{tenantHost}-ipscan-anagrafiche-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "88adcb2f-28a6-4676-8cec-c140c88b8df3"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "d000e761-6186-45d6-97e6-8936c5205360": {
                        "host": "sd-indh-dev-ita-ipadam018-configmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "499459e7-49a9-4a51-a730-3c2e16da14ab"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM018D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM018D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "0ac330a7-3420-45d7-861d-b2c573d7f2db": {
                        "host": "sd-indh-dev-ita-ippegaso002-pegasoparamsba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81916cba-a28d-45f0-bab2-76015f740dfa"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPPEGASO002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPPEGASO002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605702176000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590759184000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d1f5dfc0cd7b26b98fda56a6e7b6e925",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Cantieri"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a002324e-bed6-4ca9-8bdd-0dddb09b219b"
                    }
                ],
                "systemAliases": {
                    "a002324e-bed6-4ca9-8bdd-0dddb09b219b": {
                        "host": "{tenantHost}-ipscan-cantieri-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f114b40c-5590-4de9-8900-5c1abe089a07"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "b616fcdb-e500-4a89-9ef4-9a2f491d5392": {
                        "host": "sd-indh-dev-ita-ipscpco008-piacom-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "2294c59e-2816-4da9-b0d9-9b839625a70e"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO008D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO008D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605614313000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591352245000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "9f07db12a2478dead444d3710b99fde1",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "d9994f4e-292b-4a9c-9beb-729424cfe342"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Scheda Dotazione"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "cce1149f-cac5-4664-be17-432b799c9ba8"
                    }
                ],
                "systemAliases": {
                    "cce1149f-cac5-4664-be17-432b799c9ba8": {
                        "host": "{tenantHost}-ipadam002-scheda-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9994f4e-292b-4a9c-9beb-729424cfe342"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1606228187000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1593773685000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "2515f19a8a0b376a0d129cb57e1133db",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controlli"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN006"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "b05826e1-2d34-41ea-9cce-c87bbeee2e5b"
                    }
                ],
                "systemAliases": {
                    "b05826e1-2d34-41ea-9cce-c87bbeee2e5b": {
                        "host": "{tenantHost}-ipqcan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "055a411a-3d79-496e-a480-8d16ab71ba28"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN006D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605013538000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591375737000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "88fe12182e8fadd22ef371a6a19965ae",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Riepilogo target impresa"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN024"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "170bb5c2-089d-4cef-ac15-e0f00cb8c6db"
                    }
                ],
                "systemAliases": {
                    "170bb5c2-089d-4cef-ac15-e0f00cb8c6db": {
                        "host": "{tenantHost}-ipscan-rt-impresa-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN024D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603903683000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590486613000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d86703a4d500a2decd8388950d50203d",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - site - dev - SITEID_IRI"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSITID001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "cff065f9-c2b9-4da0-b892-ca569b88beee"
                    }
                ],
                "systemAliases": {
                    "cff065f9-c2b9-4da0-b892-ca569b88beee": {
                        "host": "{tenantHost}-ipsitid001-indicedirischio-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSITID001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603795384000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1589453929000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "870c18f51e3e877e4226ce2861cb4dd1",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "01447d11-7b26-4e25-b468-66e8b7757cd4"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - AIDA - dev - AIDA Reports"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDAIDA007"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "0b412117-ec69-4ec7-82fb-2ac765315938"
                    }
                ],
                "systemAliases": {
                    "0b412117-ec69-4ec7-82fb-2ac765315938": {
                        "host": "{tenantHost}-ipdaida007-aidareports-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "01447d11-7b26-4e25-b468-66e8b7757cd4"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "ipdaida007D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1588148982000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1588062000000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "82746e7595cf8de5a124f94d6f281b58",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "b52fd855-ffea-4ac6-81bb-3707537cf63e"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "Prova Portal Site"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "Prova MTA Extension info tile"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "8278c6bd-efea-4491-823c-1072ae9b7607"
                    }
                ],
                "systemAliases": {
                    "8278c6bd-efea-4491-823c-1072ae9b7607": {
                        "host": "{tenantHost}-testportale-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b52fd855-ffea-4ac6-81bb-3707537cf63e"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "testportale",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1599649048000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590499398000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "ba911d94d7a437ecb79d94122c1c31cd",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Infortuni"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN017"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "bd0f0d52-c64f-4351-8850-5eb94993d4e6"
                    }
                ],
                "systemAliases": {
                    "bd0f0d52-c64f-4351-8850-5eb94993d4e6": {
                        "host": "{tenantHost}-ipscan-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "412e1cbe-67e0-4de4-899b-2c628a1ab230"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN017D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604670949000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1588586207000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "6604633dd4701d0fd769cd8d9a0cb4d8",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "GEA - Gestione Cicli"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPDGEA002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "7fe1759c-22b1-4c63-bead-e8e6c3f425bd"
                    }
                ],
                "systemAliases": {
                    "7fe1759c-22b1-4c63-bead-e8e6c3f425bd": {
                        "host": "{tenantHost}-ipgea002-gescicli-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e27e06d-a408-4ee5-8ac5-2e561960c6cc"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPGEA002DEV",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602156418000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594056647000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "508cf6cf6dc0eb50385d921cafcb39ad",
                "identityZoneId": "e3c723d6-be56-4a19-97e1-83e43d6cc9b2",
                "instanceId": "c0afa7c2-6927-448a-b4d7-91828b5119c3"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP19551 - pega - dev - HomePage"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPPEGASO001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "1fa1ea26-9c1f-48aa-9611-fff02866a0b3"
                    }
                ],
                "systemAliases": {
                    "1fa1ea26-9c1f-48aa-9611-fff02866a0b3": {
                        "host": "{tenantHost}-ippegaso001-pegasohome-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "c0afa7c2-6927-448a-b4d7-91828b5119c3"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPPEGASO001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605870223000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591182938000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "49ab34fb83ace386aff5987c2fdceebf",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "b3027542-c916-4ba8-9f89-d6c2de0183b5"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - HOME-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN030"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "b161cb19-653a-4631-9da9-35aaf24fdba9"
                    }
                ],
                "systemAliases": {
                    "b161cb19-653a-4631-9da9-35aaf24fdba9": {
                        "host": "{tenantHost}-ipscan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b3027542-c916-4ba8-9f89-d6c2de0183b5"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN030D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "e97b6f45-96b7-4693-9647-71b74ce95c96": {
                        "host": "sd-indh-dev-ita-ipadam022-notificationsln-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "223852d3-da8f-4d56-acc6-549247e12c49"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM022D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM022D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "cff065f9-c2b9-4da0-b892-ca569b88beee": {
                        "host": "sd-indh-dev-ita-ipsitid001-indicedirischio-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a488eb86-e751-4e85-8e10-41a12ad047e2"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSITID001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSITID001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "5bca7a4b-0d8d-4310-a62e-e3a91e27ab16": {
                        "host": "sd-indh-dev-ita-ipscpco002-listcon-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "90c78854-0365-4036-aebc-934ba2700a54"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605775389000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591180551000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d144c3d83d2c299d70ade301ae280b26",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "328c6725-0c23-4888-b9c5-8f8a5cad15e6"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Strategia"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "3559f164-1219-4f11-b1b9-f3eeb2764363"
                    }
                ],
                "systemAliases": {
                    "3559f164-1219-4f11-b1b9-f3eeb2764363": {
                        "host": "{tenantHost}-ipqcan-strategia-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "328c6725-0c23-4888-b9c5-8f8a5cad15e6"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "5c95c68d-5768-4fc7-a3e1-021675cf738d": {
                        "host": "sd-indh-dev-ita-ipsitid004-infortuni-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "9ba28c48-6c7c-40f5-9e88-b9e46d1eff33"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSITID004D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSITID004D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "e4853362-0051-4abd-a3ab-f4e3c5cc9f5c": {
                        "host": "sd-indh-dev-ita-ipeideas002-gestione-idee-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ce9fd7a1-7423-4884-89a1-2999f508e158"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPEIDEAS002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPEIDEAS002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "170bb5c2-089d-4cef-ac15-e0f00cb8c6db": {
                        "host": "sd-indh-dev-ita-ipscan-rt-impresa-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "79ae94ad-706c-43ea-81ee-779c401c1d3a"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN024D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN024D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "b42b1f47-7736-4d91-8ebe-d6ed6c4b9853": {
                        "host": "sd-indh-dev-ita-ipscan-cruscotto-team-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN026D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN026D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "ae868f7b-1cc2-4c16-89a9-889f603ed6d0": {
                        "host": "sd-indh-dev-ita-ipscan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCAN005D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCAN005D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605874896000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592837632000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "a4f9f7ecbf56305eb839429c8c2186e1",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "d9aadf6e-1ce0-4b22-87a5-fa361a3e04e3"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - REPORT_CONTROLLI-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN032"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "bd8054a9-7389-4eac-ba5d-a6545e5c5bfa"
                    }
                ],
                "systemAliases": {
                    "bd8054a9-7389-4eac-ba5d-a6545e5c5bfa": {
                        "host": "{tenantHost}-ipscan-report-con-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d9aadf6e-1ce0-4b22-87a5-fa361a3e04e3"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN032D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "6ea1473e-c2fa-4a57-a25a-6d2b0754b5fe": {
                        "host": "sd-indh-dev-ita-ipeideas004-home-page-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a8011780-3c2e-4217-a46f-84c980a3c29e"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPEIDEAS004D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPEIDEAS004D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602625063000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1598362620000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "c8fa340dbb4b6b765d8d6663f65eeb10",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "6b128816-a16c-43c1-86f5-155637350027"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CQI"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN010"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "cc352a11-b73b-4ba5-b518-c184f448feec"
                    }
                ],
                "systemAliases": {
                    "cc352a11-b73b-4ba5-b518-c184f448feec": {
                        "host": "{tenantHost}-ipqcan-cqi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "6b128816-a16c-43c1-86f5-155637350027"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN010D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603896455000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591352739000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "38b06527b36b23852444bc805a07e4e5",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "10bc16b1-bf34-4094-ab6b-ebb2a2f4ebf8"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CRUSCOTTO_TARGET_ENEL-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN014"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "401f3f38-ecc9-49ed-96c7-a37957222096"
                    }
                ],
                "systemAliases": {
                    "401f3f38-ecc9-49ed-96c7-a37957222096": {
                        "host": "{tenantHost}-ipscan-tar-enel-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "10bc16b1-bf34-4094-ab6b-ebb2a2f4ebf8"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN014D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1603798963000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590593814000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "7fa21424b9a1fcee21f60035d0030cea",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Esi"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN031"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "7d878ecc-6e79-4c60-8659-02ab32bc11da"
                    }
                ],
                "systemAliases": {
                    "7d878ecc-6e79-4c60-8659-02ab32bc11da": {
                        "host": "{tenantHost}-ipscan-esi-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "8bfa2bc2-3840-4439-a8ca-ab983ad21b79"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN031D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "7d18ede2-2408-42a7-a460-4cd4bf9d07ea": {
                        "host": "sd-indh-dev-ita-ippegaso003-pannello-sba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "24849ac4-5db4-4c2c-bba4-80ccade148b4"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPPEGASO003D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPPEGASO003D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602581349000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591370458000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "1db2ba777129ac3c8917c2248f3b9f2a",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Home"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPQCAN001"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "eab21e19-f631-40d0-8d77-a9afba6373a9"
                    }
                ],
                "systemAliases": {
                    "eab21e19-f631-40d0-8d77-a9afba6373a9": {
                        "host": "{tenantHost}-ipqcan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPQCAN001D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605539145000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591354218000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "62b86926b60d16809c4fa2c7edd0c8e4",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Verifiche"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM017"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a9c601be-f8cf-4d73-81d0-e59c90b06592"
                    }
                ],
                "systemAliases": {
                    "a9c601be-f8cf-4d73-81d0-e59c90b06592": {
                        "host": "{tenantHost}-ipadam017-verificationmgt-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "0d6e2c38-3d5d-408b-8cc7-d762e9253afb"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM017D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "00d8eaa9-5e17-4458-9ccb-6b50344a682f": {
                        "host": "sd-indh-dev-ita-ipadam004-spectec-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "f1b56250-6dce-4b2e-96fd-971afe24ba24"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM013D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM013D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1592295220000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590482576000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "e17457a9358a584ab7b87a9b04179ea2",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "b29f6302-dffb-4592-8326-16d289e408c3"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - FILE_UPLOADER-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN028"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "dd82b79f-cfcd-48c2-8aa0-b277444964c9"
                    }
                ],
                "systemAliases": {
                    "dd82b79f-cfcd-48c2-8aa0-b277444964c9": {
                        "host": "{tenantHost}-ipscan-file-uploader-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "b29f6302-dffb-4592-8326-16d289e408c3"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ]
                }
            },
            "_version": "3.0",
            "identification": {
                "id": "IPSCAN028D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "eab21e19-f631-40d0-8d77-a9afba6373a9": {
                        "host": "sd-indh-dev-ita-ipqcan-home-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "1d7d31d0-9072-4bec-bcfd-aa72ef442f62"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPQCAN001D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPQCAN001D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1598375124000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590498506000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "bc89774742812f629c6c70d5e0b7d01f",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - CRUSCOTTO_TEAM-BA"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN026"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "b42b1f47-7736-4d91-8ebe-d6ed6c4b9853"
                    }
                ],
                "systemAliases": {
                    "b42b1f47-7736-4d91-8ebe-d6ed6c4b9853": {
                        "host": "{tenantHost}-ipscan-cruscotto-team-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "81fb9ad0-e50e-4f39-bb29-7d0fd4dadff3"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN026D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605004576000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1590412717000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "a2987dd054049aaf30c890014e91a8f9",
                "identityZoneId": "329e67a8-faa3-436c-9b69-bd5a24957ad6",
                "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP21331 - sl - dev - Cruscotto Controlli"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCAN005"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "ae868f7b-1cc2-4c16-89a9-889f603ed6d0"
                    }
                ],
                "systemAliases": {
                    "ae868f7b-1cc2-4c16-89a9-889f603ed6d0": {
                        "host": "{tenantHost}-ipscan-controlli-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "d396e6a2-e5ca-4967-9752-3e4f288cc6bd"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCAN005D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1601907693000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592497431000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "cc3f9be104563ede1a278a44ecf9f69d",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "51e6e6b7-81af-4a91-b4a9-8d70bdb27eb5"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Entrata Merci"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO006"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "1c448015-093f-4111-8b77-ec785999f1f1"
                    }
                ],
                "systemAliases": {
                    "1c448015-093f-4111-8b77-ec785999f1f1": {
                        "host": "{tenantHost}-ipscpco006-listmov-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "51e6e6b7-81af-4a91-b4a9-8d70bdb27eb5"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO006D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "e9adec60-85b2-474e-8f79-094b28c8484e": {
                        "host": "sd-indh-dev-ita-ipscpco007-oda-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "59d40d08-6266-4763-b147-f552ec3bba50"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPSCPCO007D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPSCPCO007D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605611312000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1594992218000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "268fd021c9c87ce1d03a34ef7af17d3a",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "a8011780-3c2e-4217-a46f-84c980a3c29e"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - e-ideas - dev - Home"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPEIDEAS004"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "6ea1473e-c2fa-4a57-a25a-6d2b0754b5fe"
                    }
                ],
                "systemAliases": {
                    "6ea1473e-c2fa-4a57-a25a-6d2b0754b5fe": {
                        "host": "{tenantHost}-ipeideas004-home-page-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "a8011780-3c2e-4217-a46f-84c980a3c29e"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPEIDEAS004D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "25f6e163-2d72-4003-8ef7-05cd363c6c87": {
                        "host": "sd-indh-dev-ita-ipampere002-plugins-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ecf05045-fd30-4439-be61-3aeae693977b"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPAMPERE002D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPAMPERE002D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1595843177000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1595843177000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "79b138bb2f8e955abf01f19392050638",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "ecf05045-fd30-4439-be61-3aeae693977b"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "Ampere Plugins"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPAMPERE002"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "25f6e163-2d72-4003-8ef7-05cd363c6c87"
                    }
                ],
                "systemAliases": {
                    "25f6e163-2d72-4003-8ef7-05cd363c6c87": {
                        "host": "{tenantHost}-ipampere002-plugins-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "ecf05045-fd30-4439-be61-3aeae693977b"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPAMPERE002D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1604074800000,
            "updatedBy": "sysUser",
            "createdBy": "sysUser",
            "createdOn": 1604074800000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "fb0043da388fb6d3fc4e315b37cc1116",
                "identityZoneId": "4a795a74-7e74-40d9-85c4-072e4e8620c9",
                "instanceId": "9d074872-3496-453c-8dde-6249f6a3c059"
            }
        },
        "cdm": {
            "texts": {},
            "payload": {
                "systemAliases": {
                    "a2629c1e-dbc1-4f61-8f73-07bf125003f3": {
                        "host": "sd-indh-dev-ita-ipadam003-nuova-dotazione-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5cc6c324-260b-4f8f-a133-874f95c1f691"
                    }
                }
            },
            "_version": "3.0.0",
            "relations": {
                "base": [
                    {
                        "label": "extends",
                        "target": {
                            "id": "IPADAM004D",
                            "context": {
                                "id": "SUB_ACCOUNT",
                                "type": "SUB_ACCOUNT"
                            },
                            "entityType": "provider"
                        }
                    }
                ]
            },
            "identification": {
                "id": "IPADAM004D",
                "entityType": "provider"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1605880675000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592817308000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d03d5275d6b4740b4f63642d915e9798",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Fabbisogno Lordo"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO010"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "99fa0b7f-6443-43c0-b679-b77d72d8513b"
                    }
                ],
                "systemAliases": {
                    "99fa0b7f-6443-43c0-b679-b77d72d8513b": {
                        "host": "{tenantHost}-ipscpco010-fablord-ba-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "5e358b54-e4c7-4f8c-b204-45825cc987b8"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO010D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1600852226000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591367290000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "d3c1368d6573d281cad9046a972d5ce9",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "499459e7-49a9-4a51-a730-3c2e16da14ab"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Configurazione"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM018"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "d000e761-6186-45d6-97e6-8936c5205360"
                    }
                ],
                "systemAliases": {
                    "d000e761-6186-45d6-97e6-8936c5205360": {
                        "host": "{tenantHost}-ipadam018-configmanagement-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "499459e7-49a9-4a51-a730-3c2e16da14ab"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM018D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1596540009000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1591353611000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "e80ea66afde8c88b2cd4ec98676ac4ed",
                "identityZoneId": "7960029c-394b-4068-a3e0-0256a9bbd094",
                "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP22511 - ADAM - DEV - Dotazioni Assegnate"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPADAM003"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "a1f46bd0-3259-4286-b81a-2bbf332f5ee8"
                    }
                ],
                "systemAliases": {
                    "a1f46bd0-3259-4286-b81a-2bbf332f5ee8": {
                        "host": "{tenantHost}-ipadam003-dotazioni-assegnate-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "813dd47d-0a2c-47e8-b222-afa4415d71b8"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPADAM003D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    },
    {
        "metadata": {
            "updatedOn": 1602844481000,
            "updatedBy": "technicalUser",
            "createdBy": "technicalUser",
            "createdOn": 1592835406000,
            "context": {
                "id": "SUB_ACCOUNT",
                "contextType": "sub_account",
                "tenantId": "70777e624d6352177b2c726c559e2712",
                "identityZoneId": "2411ce50-ed5c-40f9-8f24-b914818ca793",
                "instanceId": "efc7ceba-e00d-468a-8ada-b18779eb8f9f"
            }
        },
        "cdm": {
            "texts": {
                "cdm|identification|title": {
                    "type": "XTIT",
                    "value": {
                        "": "AP10171 – cosm - dev - Home"
                    }
                },
                "cdm|identification|description": {
                    "type": "XTIT",
                    "value": {
                        "": "IPSCPCO009"
                    }
                }
            },
            "payload": {
                "endpoints": [
                    {
                        "type": "runtime",
                        "system": "38a135a9-aefc-40d7-ad29-400ef15ca3d9"
                    }
                ],
                "systemAliases": {
                    "38a135a9-aefc-40d7-ad29-400ef15ca3d9": {
                        "host": "{tenantHost}-ipscpco009-home-ui-approuter.cfapps.eu10.hana.ondemand.com",
                        "instanceId": "efc7ceba-e00d-468a-8ada-b18779eb8f9f"
                    }
                },
                "providerMetadata": {
                    "providerType": "cf",
                    "allowedEntityTypes": [
                        "businessapp"
                    ],
                    "contentAdditionMode": "manual"
                }
            },
            "_version": "3.0.0",
            "identification": {
                "id": "IPSCPCO009D",
                "title": "{{cdm|identification|title}}",
                "entityType": "provider",
                "description": "{{cdm|identification|description}}"
            }
        }
    }
]

a3. Now query to Apollo snapshot
Jawad suggestion. add ?tenant:
add to cdm search ?tenant=hash(CustomerPortalCreatedInstanceId::ConsumerSubaccountId)

hash generation:
public static String constructHashOf(String tenantId, String instanceId) throws NoSuchAlgorithmException {
    String combinedTenantId = String.format("%s::%s", value2, value1);
    MessageDigest md = MessageDigest.getInstance("MD5");
    md.update(combinedTenantId.getBytes());
    byte[] digest = md.digest();
    return DigestUtils.md5Hex(digest);
}

can also use, https://www.freeformatter.com/message-digest.html
57e6395f-fbae-461f-ab28-818eb0e2afb3::4a795a74-7e74-40d9-85c4-072e4e8620c9
?tenant=106434044b42034fd4aada8da1a2654c

search:
curl --location --request POST 'https://portal-service.cfapps.eu10.hana.ondemand.com/cdm_store_service/cdm/search?tenant=4455405132d09853fc23dea18fb3bb1e' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw '{
        "context": {
      "contextType": "SNAPSHOT"
    },
  "metadata":{
    "page": {
      "number": 1,
      "size": 100
    }
  },
"match": [{"/cdm/identification/entityType": "provider"} ]

}'

response: [ ]

curl --location --request POST 'https://portal-service.cfapps.eu10.hana.ondemand.com/cdm_store_service/cdm/search?tenant=4455405132d09853fc23dea18fb3bb1e' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer <token>' \
--data-raw '{
        "context": {
      "contextType": "SNAPSHOT"
    },

  "metadata":{
    "page": {
      "number": 1,
      "size": 100
    }
  },
"match": [{"/cdm/identification/entityType": "businessapp"} ]

}'

response: []
meaning that this provider has no content

Saar's suggestion, req. token for access to apollo tenant + instance
apollo token: portal generate-client-token -a portal-cf-cdm-store-service -c '{"tenantId": "57e6395f-fbae-461f-ab28-818eb0e2afb3","instanceId": "7960029c-394b-4068-a3e0-0256a9bbd094","userName":"techUser","isProvider":"false"}'

returns empty for both businessapp and provider

a4.

b. search provider entity
example:
src/test/java/com/sap/portal/cdm/store/webaccess/GetEntitiesByTargetContextIT.java
        mockMvc.perform(post("/cdm_store_service/cdm/entities/sources?targetContextId=snapshot_context_id_2&targetContextType=SNAPSHOT&entityTypes=sitereferences")
                .contentType(MediaType.APPLICATION_JSON)
                .with(
                        bearerToken(generateClientCredentialJwtWithAdditionalAttributes(
                                additionalAttributes(
                                        "provider_identityZone_2",
                                        "provider_instanceId_2",
                                        "technical_user",
                                        "true")
                                )
                        )
                )
where the payload itself is
[i500695@C02X632CJGH6:2020-11-02 16:09:51:~/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/src/test/resources/com/sap/portal/cdm/store/webaccess:]2031$ cat getEntitiesByTargetContext_noStopCondition.json
{
    "stopCondition": {
      "relations": []
    }
 }

c. postman
<url:#r=__search_cherry-pick_local_providers>
<url:#r=__Search_all_provider_entities_cherry-pick_from_SaaS_and_base_from_Apollo_provider_PaaS>


                11.1.2.1.5 repro logs
hi, we re-deployed the provider "IPEIDEAS006", the problem remained the same, even in this case after the subscription on the cockpit (which goes well), this provider does not appear in the "Content explorer" in the "Content Manager".
 
As requested we have recovered the following information:
 
IPEIDEAS006 Correlation ID: 728ac34b-357e-11eb-9eef-eeee0a95a036

GUID, Subaccount ID, consumer subaccount id, have not changed, they are the same as before and are:

GUID: 57e6395f-fbae-461f-ab28-818eb0e2afb3
"subaccountid": "7960029c-394b-4068-a3e0-0256a9bbd094",
"clientid": "sb-IPEIDEAS006D-clone! b18149 | lps-registry-broker! b14",
"clientsecret": "I2HNGHJZo3WcI3kN3CKQtllL1bg =",
 
We remain available for any clarifications.
Thanks
                11.1.2.1.6 more info  Tue Dec  8 09:29:11 IST 2020

                    11.1.2.1.6.1 Boris duplicate base provider suspicion


https://logs.cf.eu10.hana.ondemand.com/app/kibana#/dashboard/Requests-and-Logs?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'logstash-*',key:space_name,negate:!f,params:(query:Portal),type:phrase,value:Portal),query:(match:(space_name:(query:Portal,type:phrase))))),refreshInterval:(pause:!t,value:0),time:(from:'2020-12-04T00:00:00.000Z',to:'2020-12-05T23:30:00.000Z'))&_a=(description:'',filters:!(),fullScreenMode:!f,options:(darkTheme:!f,useMargins:!t),panels:!((embeddableConfig:(),gridData:(h:4,i:c579594c-e1ca-4244-a059-62f89ebe0cca,w:48,x:0,y:0),id:Navigation,panelIndex:c579594c-e1ca-4244-a059-62f89ebe0cca,type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:16,i:'5d0a1e5e-b326-4719-bf3c-0e4719ae4433',w:12,x:0,y:4),id:Correlation-Ids,panelIndex:'5d0a1e5e-b326-4719-bf3c-0e4719ae4433',type:visualization,version:'7.4.2'),(embeddableConfig:(columns:!(component_name,correlation_id,level,request,response_status,response_time_ms),sort:!('@timestamp',desc)),gridData:(h:12,i:c7051d8c-0791-4708-a3a1-3822081672e3,w:36,x:12,y:4),id:Requests,panelIndex:c7051d8c-0791-4708-a3a1-3822081672e3,type:search,version:'7.4.2'),(embeddableConfig:(columns:!(component_name,correlation_id,level,logger,msg),sort:!('@timestamp',desc)),gridData:(h:12,i:'2f47f613-3f69-4f29-b11b-67ec91c429c9',w:36,x:12,y:16),id:Application-Logs,panelIndex:'2f47f613-3f69-4f29-b11b-67ec91c429c9',type:search,version:'7.4.2'),(embeddableConfig:(),gridData:(h:8,i:ead02107-ca2b-4cda-a2ec-6a416edfdb23,w:12,x:0,y:20),id:Levels,panelIndex:ead02107-ca2b-4cda-a2ec-6a416edfdb23,type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:8,i:d379049e-7bae-4895-a48a-877df84bc7c6,w:16,x:0,y:28),id:Organizations,panelIndex:d379049e-7bae-4895-a48a-877df84bc7c6,type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:8,i:fc1598c4-bbf9-451e-a711-3f36c782d2ce,w:16,x:16,y:28),id:Components,panelIndex:fc1598c4-bbf9-451e-a711-3f36c782d2ce,type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:8,i:'727eb49f-6259-4a33-9002-17c6510a6ea0',w:16,x:32,y:28),id:Spaces,panelIndex:'727eb49f-6259-4a33-9002-17c6510a6ea0',type:visualization,version:'7.4.2')),query:(language:lucene,query:'%22More%20than%20one%20base%20provider%20was%20found%22'),timeRestore:!f,title:'Requests%20and%20Logs',viewMode:view)

Boris:
[6:09 PM] Lipmanovich, Boris
    
portal-cf-site-semantic-service/controllers/provider-controller.js:776 - More than one base provider was found in the tenantId: 845c174ba7723f82a38e7e2b840c30d1
(1 liked)​[6:10 PM] Lipmanovich, Boris
    
base providerId was  'saas_approuter_GPS' changed to 'saas_approuter_gps'
​[6:11 PM] Lipmanovich, Boris
    so semantic see 2 base providers
​[6:11 PM] Lipmanovich, Boris
    Maybe it was a some change in the platform...
​[6:11 PM] Izaq, Yosi
    very helpful! thank you Boris!!
​[6:12 PM] Izaq, Yosi
    what was fix?
​[6:13 PM] Lipmanovich, Boris
    the most simple fix is to unsubscribe from all the SKUs
​[6:13 PM] Izaq, Yosi
    and resubscribe?
​[6:13 PM] Lipmanovich, Boris
    yep

Logs:
Application Logs

1–16 of 16


Time	component_name	correlation_id	level	logger	msg
	Dec 5, 2020 @ 11:59:00.085	portal-cf-site-semantic-service-1605722008	a76e7735-6a35-4eeb-4fb1-638acaa9bbdb	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 5, 2020 @ 00:14:13.472	portal-cf-site-semantic-service-1605722008	570eea49-58c6-4f48-7552-b7b29ec4cb2c	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: c664f22b92d032c1266c2b4ad087e467
	Dec 4, 2020 @ 17:25:33.223	portal-cf-site-semantic-service-1605722008	08cb9be2-ef64-4a45-5055-13923336f5ff	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 595019c6a32f0e4c660b17c24b5f02bd
	Dec 4, 2020 @ 16:11:52.411	portal-cf-site-semantic-service-1605722008	ed9133dd-27aa-4f2e-475f-ff563d59c612	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 16:03:20.474	portal-cf-site-semantic-service-1605722008	aba8ec4c-cfc5-44f8-4afc-ea9313a9a326	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 14:48:10.639	portal-cf-site-semantic-service-1605722008	20687139-ee70-4810-73f0-3666ab220bf8	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 10:58:39.396	portal-cf-site-semantic-service-1605722008	4e706008-2845-48e1-5508-cfc3a8c80b08	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 17c1806d5b958767bcc60853b1ee1a74
	Dec 4, 2020 @ 10:34:46.978	portal-cf-site-semantic-service-1605722008	1de9c47f-3c92-4e86-5f72-84e9f9791515	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 595019c6a32f0e4c660b17c24b5f02bd
	Dec 4, 2020 @ 10:33:19.584	portal-cf-site-semantic-service-1605722008	af8104b0-4138-4834-79ca-a3d806e32a85	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 10:33:19.112	portal-cf-site-semantic-service-1605722008	af8104b0-4138-4834-79ca-a3d806e32a85	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 08:10:18.959	portal-cf-site-semantic-service-1605722008	2780b013-f390-407a-7d80-0c8666734f20	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 08:08:19.772	portal-cf-site-semantic-service-1605722008	cd488a8b-5ed4-4229-5411-03d241ee3fb9	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 595019c6a32f0e4c660b17c24b5f02bd
	Dec 4, 2020 @ 08:08:19.332	portal-cf-site-semantic-service-1605722008	cd488a8b-5ed4-4229-5411-03d241ee3fb9	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 595019c6a32f0e4c660b17c24b5f02bd
	Dec 4, 2020 @ 07:46:05.955	portal-cf-site-semantic-service-1605722008	57e9f25f-b3e8-4011-5015-21214f3e1dc7	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 07:46:05.552	portal-cf-site-semantic-service-1605722008	57e9f25f-b3e8-4011-5015-21214f3e1dc7	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: 906dfe6e87b2b552855114c33e5a6ba4
	Dec 4, 2020 @ 03:41:44.775	portal-cf-site-semantic-service-1605722008	48ebaf8a-d513-45b4-6249-8fc1cba3d044	ERROR	nodejs-logger	portal-cf-site-semantic-service/controllers/provider-controller.js:773 - More than one base provider was found in the tenantId: f945f316abe65f18aa34324e0b79392e

                    11.1.2.1.6.2 access DB with Boaz/Run
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "tenantId" = '4455405132d09853fc23dea18fb3bb1e';
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "instanceId" = '7960029c-394b-4068-a3e0-0256a9bbd094';
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "identityZoneId" = '7960029c-394b-4068-a3e0-0256a9bbd094';
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "identityZoneId" = '7960029c-394b-4068-a3e0-0256a9bbd094' and "entityType" = 'provider';
SELECT "createdOn", "createdBy", "updatedOn", "updatedBy", "entityId", "entityType", "entityTitle", "entityDescription", "tenantId", "instanceId", "identityZoneId", "contextType", id, cdm FROM cdm."CDM_ENTITIES" WHERE "identityZoneId" = '7960029c-394b-4068-a3e0-0256a9bbd094' and "entityType" = 'provider' and "entityDescription" like 'IPEI%';


                    11.1.2.1.6.3

                11.1.2.1.7
            11.1.2.2   placeholder
            11.1.2.3   placeholder
            11.1.2.4   placeholder
            11.1.2.5   placeholder
            11.1.2.6   placeholder
            11.1.2.7   placeholder
            11.1.2.8   placeholder
            11.1.2.9   placeholder
            11.1.2.10  placeholder
            11.1.2.11  placeholder
            11.1.2.12  placeholder
            11.1.2.13  placeholder
            11.1.2.14  placeholder
            11.1.2.15  placeholder
            11.1.2.16  placeholder
            11.1.2.17  placeholder
            11.1.2.18  placeholder
            11.1.2.19  placeholder
            11.1.2.20  placeholder
            11.1.2.21  placeholder


        11.1.3 SNOW, service now , tags: SNOW , service now 

            11.1.3.0 signature template, tags: signature template

current, 12/11/23 10:22:12  , signature template
Thanks,
Yosi Izaq
SAP BTP Build Work Zone
SAP Development support

old signature template
Thanks,
Yosi Izaq
SAP BTP Core AP UE Services
SAP Development support

UI16 - https://sap.service-now.com/nav_to.do?uri=%2Fui_page.do%3Fsys_id%3D503cb1dddb80e4106e02fef1f39619cd
SNOW - https://itsm.services.sap/now/workspace/agent/list/params/list-id/429b6c031b6b2050de8e1f8b8b4bcbba/tiny/d69bac031b6b2050de8e1f8b8b4bcba5
Configuration Wiki - https://wiki.wdf.sap.corp/wiki/display/CPPortals/ServiceNow@SAP+-+First+Steps#ServiceNow@SAPFirstSteps-UI16-SetupMailNotification

We are looking message:
Dear Customer,
we understand this issue is impacting you and we want to get it resolved as quickly as possible. 
Our dev team is currently looking into it and will reach out with an update once they have identified the cause.

Thank you for your cooperation.
[my name]
SAP BTP Build Work Zone
SAP Development support


Example message:
Dear Customer,

I'm very happy to see that the issue has been fixed and validated by you. We sincerely apologize for any inconvenience this may have caused.

Regarding the root cause analysis you requested, the development team that provided the fix is currently on weekend vacation. They will be back in the office on Sunday, July 14th. We will promptly contact you with the analysis results as soon as they are available.

Therefore, we would like to inquire about the possibility of lowering the ticket severity from "Very High" to "High" considering the fix is in place. This will allow the support team to prioritize tickets that require more immediate attention, ultimately improving overall support efficiency.

We understand this situation may be frustrating, and we appreciate your understanding.

Thank you for your cooperation.
Yosi Izaq
SAP BTP Build Work Zone
SAP Development support

            11.1.3.1  Team snow wiki, tags: team snow wiki filter
https://wiki.wdf.sap.corp/wiki/display/CPPortals/SNOW%2C+BCP%2C+Dashboard+Dev+Duty+Roster

Filters:
Sergey team: Snow - https://sap.service-now.com/now/workspace/agent/list/params/list-id/d50d73addbd841905d7ea39bd39619ab/tiny/d3010fd7db2b4194064a5a3bd3961922
(it includes ALL Apollo tickets, also those that are handled by your team)
bcp: https://support.wdf.sap.corp/sap(bD1lbiZjPTAwMSZkPW1pbg==)/bc/bsp/sap/crm_ui_start/default.htm?saprole=ZCSSNEXTPROC&crm-object-keyname=_WCF_SSLID&crm-object-type=IC_AUI_INBOX&crm-object-action=A&crm-object-value=0894EF246B6E1EDC8ACC854E20DB010C
            11.1.3.2 Ticket processing 

                11.1.3.2.1 template SNOW, service-now, Ticket basic info template  tags: template SNOW, service-now, customer issue Ticket basic info template 

                    11.1.3.2.1.1 ticket signature template, tags: ticket signature template

For WZ Customer cases:
<First name + Last name>
SAP Build Work Zone
SAP Development Support

For FLP Customer cases:
<First name + Last name>
SAP FLP Development Support 

For all WZ Internal cases:
Subscribe here to DL SAP Cloud Portal and Build Work Zone Stakeholders


Dear Customer,

Thank you for reaching out to us and for bringing the issue to our attention. We understand the importance of identifying the root cause of this matter.

Please be assured that we are prioritizing the investigation for the Root Cause Analysis (RCA) with utmost urgency. Our team is dedicated to thoroughly understanding the factors that contributed to this issue.

As we will be commencing the RCA investigation with top priority and will be providing you with regular updates on our progress- we would appreciate it if you would consider adjusting the severity of the ticket from "Very High" to "High." This will help us align our internal resources appropriately while ensuring your issue remains a top priority for our team.

We are committed to providing you with a comprehensive RCA as soon as our investigation is complete. We will keep you informed of our progress.

Thank you for your understanding and cooperation.

Sincerely,
Yosi Izaq
SAP BTP Core AP UE Services
SAP Development support

                    11.1.3.2.1.2 missing info template, tags: missing info template
wiki: https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=5011898174

my template:
----------------------------------------------------------------------------------------------------
Hi Dear Customer,

I'm sorry to hear you're experiencing this issue, and I understand its impact on you. To expedite our investigation and find a resolution as quickly as possible, could you please provide the following information:

System Details:

Cockpit URL
Site Name/ID
Site DT URL
Site RT URL

User Information: Please provide one of the following:

The user ID (if available in the secure area – I was unable to locate it).
Grant admin access to your system for portaltechuser@sap.com.

Issue Reproduction:

Exact steps to reproduce the issue.

Error Information:

Error Correlation ID
Details of the SAP ID Service (Default Identity Provider) you are using.

Thank you for your cooperation. We appreciate your help in resolving this matter.

Thanks,
Yosi Izaq
SAP BTP Core AP UE Services
SAP Development support

----------------------------------------------------------------------------------------------------
Product
DT and RT URLs
User - one of the options below:
User is provided in the secure area
Neo - technical user P2000037931, teamuser1234@gmail.com as TENANT_ADMIN
CF -  technical user portaltechuser@sap.com
If the other options are not available, please suggest any alternative way to reproduce
Steps to reproduce the issue in the following format: Step – Expected result – Actual result
Attached Screenshots, relevant for the issue
Error correlation ID
Have you reviewed the logs in Kibana and your findings

Thanks,
Yosi Izaq
SAP BTP Core AP UE Services
SAP Development support

Regarding transport (external content provider) issues also see example:
Please kindly provide us with following required information for troubleshooting : 
a. Click on "Report" link for Content Provider 'X11', copy and paste full texts for the results. 
b. Go to Content Explorer,  select x11 and capture screenshot for all of the contents for this Content provider. See if you are able to see those role desired ? 
c. Go to Content Manager, see if you are able to find those roles listed for x11 provider. Capture screenshot. 
d.  For every role that you add (manually or automatically), a corresponding role collection is automatically created in the SAP BTP cockpit, using the following values:
Platform role name - <role ID>
Platform role description - <role title>-<role description, if exists>
=> Please provide screenshot. 
e. For content Provider system x11 ABAP on cloud, have you added and push the roles to Launchpad service : 
You may have to use Maintain Business Roles app.  Select and expose the roles you want to integrate into SAP Build Work Zone, standard edition. 
https://help.sap.com/docs/btp/user-interface-configurations/select-roles-for-exposure?locale=en-US 
Please verify if you have performed this step, if not please do so. 



Dear Costumer,

In order to assist in troubelshooting the issue we need the following:
Please specify the product
Please provide the URL to the content channel manager
Please provide user - one of the options below:
User is provided in the secure area
or technical user portaltechuser@sap.com

If the other options are not available, please suggest any alternative way to reproduce
Steps to reproduce the issue in the following format: Step – Expected result – Actual result
Attached Screenshots, relevant for the issue, and demonstrating the issue

Also, can you kindly follow the steps Herman asked for?- Namely:
Please kindly provide us with following required information for troubleshooting : 
a. Click on "Report" link for Content Provider 'X11', copy and paste full texts for the results. 
b. Go to Content Explorer,  select x11 and capture screenshot for all of the contents for this Content provider. See if you are able to see those role desired ? 
c. Go to Content Manager, see if you are able to find those roles listed for x11 provider. Capture screenshot. 
d.  For every role that you add (manually or automatically), a corresponding role collection is automatically created in the SAP BTP cockpit, using the following values:
Platform role name - <role ID>
Platform role description - <role title>-<role description, if exists>
=> Please provide screenshot. 
e. For content Provider system x11 ABAP on cloud, have you added and push the roles to Launchpad service : 
You may have to use Maintain Business Roles app.  Select and expose the roles you want to integrate into SAP Build Work Zone, standard edition. 
https://help.sap.com/docs/btp/user-interface-configurations/select-roles-for-exposure?locale=en-US 
Please verify if you have performed this step, if not please do so. 




Thanks,
Yosi Izaq
SAP BTP Core AP UE Services
SAP Development support




                11.1.3.2.2 related improvements
The following suggestions were raised to be implemented immediately:

Tickets that bypassed PS
Check if the ticket passed through PS before it reached our queue – it may be that it arrived directly to us bypassing Product Support – in this case send it to PS queue by updating  the organization to PS DCP Global

Feature Requests
If the ticket reached Dev and you need to close it as a Feature Request – check if we can update documentation on this, if not - inform Product Support using PS DS distribution list: DL Cloud Portal DS PS DL_59CCE7C55F99B7E5C700000B@global.corp.sap

PS DS distribution list
Use the PS DS distribution list DL Cloud Portal DS PS DL_59CCE7C55F99B7E5C700000B@global.corp.sap  to communicate important topics to Product Support – new functionality, outage, known bugs etc.

Handover Template
Check if Product Support provided all the details according to the attached Handover Template: If required information is missing, send the ticket back to PS queue

Weak Areas Analysis
All the tickets that you need to send back to Product Support for whatever reason or you closed it but think that PS were supposed to know how to solve it – please send also to @Magarill, Zhenia – I will collect and analyze the tickets till our next meeting to find weak areas/gaps


            11.1.3.3 guidelines for ticket severity, priority especially VH very high, tags: guidelines for ticket severity , especially VH very high, , tags: guidelines for ticket severity priority

                11.1.3.3.1 official documentation
https://me.sap.com/notes/67739
Long Text
Symptom

The definition of priorities in SAP problem cases is not clear.

Solution

SAP has defined the priorities for problem cases as follows:

a. Very high:

           A case should be categorized with the priority "very high" if the problem has very serious consequences for normal business processes or IT processes related to core business processes. Urgent work cannot be performed. 
           This is generally caused by the following circumstances:

                    - A productive system is completely down.
                    - The imminent system go-live of a production system or upgrade of a production system can't be completed.
                    - The customer's core business processes are seriously affected.
                    - And for each circumstance a workaround is not available.

           The case requires immediate processing because the malfunction may cause serious losses.
 
           In case of a go-live or upgrade, the reason to delay the go-live or upgrade must be one that would cause serious losses if not resolved before go-live.

           A case can be classified with priority ‘very high’ in case of severe security vulnerability or cyber attack or in case of an event relevant for a data notification breach event.

b. High:

           A case should be categorized with the priority "high" if normal business processes are seriously affected. Necessary tasks cannot be performed. This is caused by incorrect or inoperable functions in the SAP system that are required immediately. For example; users cannot access the system, a go-live cannot be completed, users complete data is not accessible, etc. 
           The case is to be processed as quickly as possible because a continuing malfunction can seriously disrupt the entire productive business flow.

c. Medium:

           A case should be categorized with the priority "medium" if normal business processes are affected. The problem is caused by incorrect or inoperable functions in the SAP system.

d. Low:

           A case should be categorized with the priority "low" if the problem has little or no effect on normal business processes. The problem is caused by incorrect or inoperable functions in the SAP system that are not required daily, or are rarely used.

 

What the customer must do to ensure prompt processing of cases with the priority "very high":

Remote access to the relevant system must be ensured.
A contact person must be designated for opening the system who must be
- available
- and can provide the required logon data.
A contact person must be available to provide information about the problem.
The contact person should be reachable under the provided phone number.
The problem should be described in as much detail as possible: The case should contain instructions about how to simulate the problem.
To ensure 24/7 processing, the case must be written in English.
                11.1.3.3.2 example messages requesting the customer to reduce the severity of the problem, tags: example messages requesting the customer to reduce the severity of the problem
Hi [Customer Name],

We're working on ticket [Ticket Number] and appreciate the information about the production impact.

To ensure we're following the priority guidelines outlined in SAP Note 67739 (https://me.sap.com/notes/67739), could you confirm if the issue resulted in a complete standstill of all productive business processes? If not, we'd appreciate it if you could adjust the priority to "High" directly within the ticket. This helps us maintain accurate prioritization. We remain committed to resolving this issue promptly.

Yosi Izaq,
SAP Build Work Zone
SAP Development Support

                11.1.3.3.3
            11.1.3.4 SNOW, ServiceNow, Jira customer responses template, tags: SNOW, ServiceNow, Jira customer responses

                11.1.3.4.1  Customer response template , https://wiki.one.int.sap/wiki/display/CPPortals/Customer+Response+Templates
| CF:
| 1. Reproduce issue / Access / Credentials:
| 2. Available for User log on / Not able to access system / Custom IDP:
| 3. Bug / Working on fix:
| 4. HAR File Request:
| 5. Move to PS / PS DCP Global:
| 6. Scheduling Customer Meeting / Call:
| 7. Fixed Released / Issue Resolved:
| 8. RCA when problem does not persist:
| 9. How to generate a HAR file:
| 10. RCA in Progress:
| 11. Feature Request:
| 12. Dynamic Logging:
| 13. Need more information:
| 14. Free Tier IPS:
| 15. Stakeholders IPS:
| 16. IPS with 2 IAS still with error in IPS tab:
| 17. Post Booster Workflow:
| 18. WorkZone Advanced, No access to Admin:
| 19. "About" in Me Area:
| 20. IAS:
| 21. Multiple problems in one ticket:
| 22. Waiting Message:
| 23. Consulting Message:
| 24. Lower Priority Message:
| 25. Too many entities:
| 25. {{}} on Title:
| 26. Maximum number of 150 role collections assigned to a user:
| 27. Restriction / Limitation:
| 28. Not under EP-WZ component / Move to relevant component:
| NEO:
| 1. How to duplicate site on NEO:
| 2. Update UI5 Version NEO:
| 3. "Oops" error NEO extension:
| 4. External Access Point:
| 5. Billing NEO:
| 6. Credentials Pop up NEO:
| 7. ASKHR incidents collecting information:
| List of product KBAs


|  CF:
|  1. Reproduce issue / Access / Credentials:
|  Dear Customer,
|  
|  In order for us to further investigate, we would like to reproduce the issue on our side.
|  
|  Kindly send us access to your system  (URL- link to Work Zone, Username and Password).
|  
|  Also, a step by step document of how to reproduce the issue can be helpful.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  Unfortunately I was unsuccessful to reproduce the issue.
|  
|  In order for us to further investigate, can you kindly send us your credentials (URL- link to Work Zone, Username and Password).
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  In order for us to further investigate, can you grant admin access to your system to portaltechuser@sap.com.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  In order for us to further investigate, we will need access to reproduce the issue on our side.
|  
|  Please provide us a test user (Site URL, User, PW) or grant access to our test user to portaltechuser@sap.com.
|  
|  Please make sure user has relevant roles on user (cockpit) and on site, so we can replicate the issue.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  In order for us to further investigate, please provide us with the following:
|  
|  Please explain the exact flow you are executing. A step by step document can be helpful too. Is this error occurring when signing out?
|  Does this issue reproduce for other users as well? Or only your specific user?
|  Please attach a har file recording traces from sign in until reproducing the issue.
|  Access to reproduce the issue on our side. Please provide us a test user (Site URL, User, PW) or grant access to our test user to portaltechuser@sap.com.
|  Please make sure user has relevant roles on user (cockpit) and on site, so we can replicate the issue.
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  2. Available for User log on / Not able to access system / Custom IDP:
|  Dear Customer,
|  
|  Unfortunately, I was unable to access your WZ site. After looking at you cockpit, it seems like portaltechuser@sap.com was added to the Default Identity Provider and you are using the custom IDP (OGEIAS). I saw this when looking at the Trust Configurations tab, the "Available for user Log on" is only checked for the custom IDP and not the Default IDP.
|  
|  Would it be possible to check the "Available for User Log on" for the Default Identity Provider?
|  
|  If not, can you give us a test user from your custom IDP or add portaltechuser@sap.com to the custom IDP.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  Custom domain works with IAS, so it doesn't work with default IDP.
|  
|  It is very important for us to have access to your system as we're in mid investigation with multiple SAP dev teams.
|  
|  Would it be possible to give us a test user from your IAS, so we can reproduce the issue on our end for further investigation?
|  
|  If we have a call this will be very time consuming for both ends as we need to debug the code.
|  
|  We are looking into your incident with our outmost priority and appreciate your cooperation.
|  
|  Please let me know if this is possible.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  I believe you added portaltechuser@sap.com to the default identity provider.
|  
|  Currently, the direct link to Workzone routes me to your custom IDP, which is preventing access to the system.
|  
|  We have two options to resolve this issue:
|  
|  Provide me with a test user that does not have 2FA enabled and is part of your custom IDP.
|  Enable the 'Available for Login' option for the Default Identity Provider in the Trust Configurations tab (cockpit).
|  Thank you for your assistance.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  3. Bug / Working on fix:
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  After investigating your incident, we've found the root cause of the issue and are currently taking care of this.
|  
|  It’s planned to be released in the next WorkZone release.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  We are currently taking care of this problem and will update you as we progress.
|  
|  In case of questions, feel free to reach out to us.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  After investigating your incident, we've found the root cause of the issue and are currently taking care of this problem.
|  
|  Meanwhile, we will continue to update you as we progress with the fix and validating there are no regressions.
|  
|  Thank you for your cooperation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  After looking into your incident, we found the root cause of the issue and are currently taking care of this problem.
|  
|  We will update you as we progress with the fix.
|  
|  Thank you for your cooperation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  After investigating your incident, we've found the root cause of the issue and are currently taking care of this. 
|  
|  If all goes as planned, the fix is planned to be released in the next Work Zone release on <DAY>, <RELEASE DATE>. 
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  4. HAR File Request:
|  Dear Customer,
|  
|  The incident has reached the Work Zone Development Support Team.
|  
|  To further investigate your incident, can you please attach a new HAR file starting from log in until reproducing the issue.
|  
|  In addition, please send us credentials (URL, Username, Password), OR grant access to user portaltechuser@sap.com so we can reproduce the issue.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  To further investigate your incident, please attach a new HAR file starting from log in until reproducing the issue. 
|  
|  In addition, Please provide us a test user (Site URL, User, PW) or grant access to our test user to portaltechuser@sap.com.
|  Please make sure user has relevant roles on user (cockpit) and on site, so we can replicate the issue.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  
|  
|  5. Move to PS / PS DCP Global:
|  Dear Colleagues,
|  
|  After reviewing this ticket, we were unsuccessful reproducing the issue of the customer.
|  
|  Can you please contact customer to help us further investigate this incident, and provide us with the following:
|  
|  Recording of customer reproducing the issue step by step
|  Log in credentials to reproduce issue on our side
|  In addition, two tickets were opened for the same issue by the same customer. Please explain to customer the issue by doing this. Please choose one ticket to move forward with, as this can only be more confusing and we can lose knowledge with two tickets.
|  
|  Please gather all information needed to further investigate this case, as we need clarification of the issue.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  —————————————————————————————————
|  
|  In case of an error during application rendering (after clicking on tile in launchpad) please ask from customer provide:
|  
|  Har file
|  Steps to reproduce the issue in the following format: Step – Expected result – Actual result
|  Attached Screenshots, relevant for the issue.
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Colleagues,
|  
|  After looking into this incident, the issue is not from our side. Also, as you can see screenshot attached is not our field.
|  
|  We recommend looking for the correct and relevant component for further investigation. 
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear PS colleagues ,
|  
|  Please return the ticket to the customer with the following answer:
|  
|  According to our Dev team there are two ways to create a custom domain:
|  
|  Recommended way – enable IAS authentication and follow the guidelines in the documentation. Limitations are documented as well.
|  The previous way – still use xsuaa authentication. Limitations are documented as well. https://help.sap.com/docs/build-work-zone-standard-edition/sap-build-work-zone-standard-edition/option-1-sap-authentication-and-trust-management-service-xsuaa?q=custom+domain
|  Best Regards,
|  
|  
|  
|  
|  
|  6. Scheduling Customer Meeting / Call:
|  Dear Customer,
|  
|  I would like to set up a meeting with you in which you can show us this issue. 
|  Please let me know the most suitable time for you to meet. (My time zone is GMT +02:00.) 
|  Also, please provide us with an email address to which we can send the meeting invitation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  I have set up a meeting for us via teams.
|  
|  Attaching a link to our meeting which will take place <DAY>, <DATE>, <TIME>.
|  
|  See link below:
|  
|  https://teams.microsoft.com/l/meetup-join/....
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  
|  
|  7. Fixed Released / Issue Resolved:
|  Dear Customer,
|  
|  We are delighted to announce that our latest fix has been successfully released, resolving the issue you encountered.
|  
|  To ensure everything is working perfectly on your end, we kindly request you to validate that the problem no longer persists.
|  
|  If you happen to encounter the issue again, please do not hesitate to reach out to us. 
|  
|  Simply reopen the incident, and we will promptly investigate and address your issue.
|  
|  Thank you for your understanding and cooperation throughout this process.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  Our latest fix has been successfully released, resolving the issue you encountered.
|  
|  To ensure everything is working perfectly on your end, we kindly request you to validate that the problem no longer persists.
|  
|  Thank you for your understanding and cooperation throughout this process.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  I wanted to let you know that we've released the fix for the issue you encountered.
|  
|  Our team is actively monitoring the situation to ensure everything runs smoothly.
|  
|  To ensure everything is working perfectly on your end, we kindly request you to validate.
|  
|  Please continue to update us with any findings on your end.
|  
|  We appreciate your patience and understanding.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  
|  
|  8. RCA when problem does not persist:
|  Dear Customer,
|  
|  We are very sorry but unfortunately as no other customer reported such an issue and the ticket was assigned to our component only after that the issue was already resolved - we only have the server logs to analyze the issue.
|  The logs are saved for 1 week so they are not available anymore.
|  
|  We can suggest that in case it happens again to open a ticket directly to our component
|  <COMPONENT> so we will be able to search in the logs while they still exist.
|  We will work on this with priority in order to find the root cause while it is reproduced.
|  
|  I hope this won't happen again but if it is I will recommend extracting also a HAR file while the issue is reproduced so more information will be attached to the ticket. 
|  
|  Enter to the login page
|  Enter the Portal site
|  Press F12 (Dev Tools) and go to the ‘Network’ tab.
|  Try to import the site.
|  While the issue is reproduced --> right click on the network trace --> press “Save all as HAR with content”
|  You can also refer to the following KBA for instructions on how to extract HAR file: https://launchpad.support.sap.com/#/notes/1990706
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  —————————————————————————————————
|  
|  Dear Customer,
|  
|  We are still investigating the matter thoroughly. Please know we are taking this incident with the outmost priority, even with the problem not persisting which is making it more difficult.
|  
|  Considering that the problem is no longer occurring, we kindly request you to consider lowering the priority of the ticket. This will allow us to allocate our resources effectively to address other urgent matters and provide timely support to customers facing active issues.
|  
|  Thank you for your understanding and cooperation.
|  
|  If you have any questions or require further assistance, please don't hesitate to reach out to us.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  9. How to generate a HAR file:
|  Dear Customer,
|  
|  You can try this or google for "how to generate har file":
|  
|  It is recommended to use Chrome to generate HAR files because it natively provides the Developer Tools to facilitate this. Network Issues
|  
|  To diagnose support problems, the network tab can be used:
|  
|  
|  
|  Bring up the developer tools using one of these methods:
|  Using Keyboard Shortcut (⌘⌥I on OS X, Ctrl + Shift + i on Linux, F12 on Windows)
|  From Chrome Menu at the top-right of your browser window, then select Tools > Developer Tools.
|  Navigate to the Network tab on the Development Tool
|  Check Disable Cache option to prevent caching of resources for this specific page.
|  Enable preserve log
|  Start recording
|  Load the page with the problem.
|  Wait until it has finished loading
|  Complete the steps that trigger or demonstrate your issue.
|  Click on Export followed by Save As... to save the HAR file
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  10. RCA in Progress:
|  Dear Customer,
|  
|  Thank you for your patience.
|  
|  We are currently in the process of preparing a comprehensive Root Cause Analysis (RCA), which will be shared with you as soon as it is finalized and contains all necessary details.
|  
|  We appreciate your continued cooperation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  11. Feature Request:
|  Dear Customer,
|  
|  After investigating your incident, we realized that your reported issue is a new feature request.
|  
|  The official process for submitting new feature requests is via Influence tool:
|  
|  https://influence.sap.com/sap/ino/#/campaign/2279
|  
|  Set the category to Digital Experience -> Fiori Launchpad.
|  
|  Kindly elaborate clearly with detail your request, so we will fully understand your request.
|  
|  Thank you for your cooperation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  
|  
|  12. Dynamic Logging:
|  Dear Customer,
|  
|  Please follow these guidelines:
|  
|  Create a basic authentication header.
|  Encode your username and password to base64 string with a ':' seperator, for example - username:password
|  The user should be subaccount administrator and have the Launchpad_Admin role collection
|  He should be a user under the Default Identity Provider
|  Preferably the user should not have 2FA enabled. If user does have a 2FA, concatenate the OTP to the password 
|  Execute a POST API call to <runtime-approuter-url>/dynamicLogLevel/:level, where level is either info or debug. The call should contain a header "x-approuter-authorization" with value "Basic <your base64 string from step 1>".
|  Example with cURL: curl --location --request POST 'https://tenanta.cfapps.eu10.hana.ondemand.com/dynamicLogLevel/debug' --header x-approuter-authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ='
|  Wait 5 minutes
|  Reproduce the error
|  From your BTP cockpit where your HTML5 applications are deployed, download the logs of your desired application.
|  We are asking you to do these procedures because only subaccount administrators are privileged to this access. This is for raising the log level to debug.
|  
|  Please attach the logs document from the cockpit so we can further investigate.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  By default, application logs are limited to error level logs, to prevent logs from being dropped in case of huge amount of logs.
|  
|  However, in case of a business requirement, dynamic logging is supported.
|  
|  This capability enables the following: dynamically raise the log level, without having to modify your source code, run through a whole development cycle or even restart the application. Once the investigation has completed, the log level will be returned to error level.
|  
|  13. Need more information:
|  Dear Customer,
|  
|  In order for us to further investigate your incident, we need you to provide the following:
|  
|  Har file from log in until reproducing the issue
|  Kindly send us access to your system with Launchpad admin role. (URL- link to Launchpad, Username and Password).
|  Please send us the documentation used to implement the application to the Launchpad.
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  Thank you for submitting your incident.
|  
|  In order to process your incident, we need some more details.
|  
|  Please add the following information to the ticket:
|  
|  Account Organization
|  Account ID
|  Cloud Platform Region
|  System URL
|  Login user and password to reproduce the incident
|  The actions you have performed
|  The response of the system
|  What you expected to happen
|  Whether you can reproduce the issue (including a complete example in your message)
|  Whether the issue occurred after you performed a specific action (and what this action was)
|  Does the issue occur on a system different than the productive one (Development, QA)?
|  Whether the issue affects all users
|  Whether the issue must be solved urgently and why?
|  All available logs and traces
|  Any relevant screenshots
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  14. Free Tier IPS:
|  The integration with other services like identity provisioning service require creation of service instance and service key which is supported only for the standard plan.
|  
|  https://help.sap.com/docs/Launchpad_Service/8c8e1958338140699bd4811b37b82ece/fd79b232967545569d1ae4d8f691016b.html
|  
|  You may update your plan to standard plan and try again.
|  
|  15. Stakeholders IPS:
|  Currently the solution is only supported for customer landscapes that are assigned to CRM customer ID.
|  
|  Since you are using a DEV\TEST landscape without a customer ID the process has failed.
|  
|  Please create a support ticket for component BC-IAM-IPS for enabling IPS tenant with connectors on your subaccount. Note that site manager may still show an error on identity provisioning tab but it can be ignored.
|  
|  Once the IPS tenant is created, you can proceed with the guidelines described in SAP Help: Configure Integration with the Identity Provisioning Service | SAP Help Portal (Skip to step 4).
|  
|  
|  
|  IPS 2 IAS and still has error:
|  
|  16. IPS with 2 IAS still with error in IPS tab:
|  
|  
|  Dear Customer,
|  
|  It seems that the configuration of your IAS in not according to the guidelines.
|  
|  Please provide a screenshot of the "Trust Configuration" pane in the relevant cockpit subaccount menu.
|  
|  Thanks & Best regards.
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  It seems that you have tried to provision 2 different IAS tenants on the same account and same product of workzone standard (Launchpad), we support only single IAS tenant, and the provisioning was successful for IAS ajumzpvok.accounts.ondemand.com, the IPS that was created for this IAS is: https://ajumzpvok.accounts.ondemand.com/ips
|  
|  The error itself will remain until you will deactivate or delete the second IAS, a4zb23u3w.accounts.ondemand.com.
|  
|  You can start working with the already created IPS that was created for ajumzpvok.accounts.ondemand.com and ignore the error in the UI.
|  
|  ———————————————————————————————————————
|  
|  Please disable the azure IDP and press again the connect button, currently we support only single IAS defined under trust configuration, this is also mention in the configuration. Once the process is completed you can activate again the azure IDP.
|  
|  Important note: In case your IAS already has an IPS and the relevant SAP Workzone connectors (in target systems), you can skip this step and ignore the error.
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  It seems that you have tried to provision 2 different IAS tenants on the same account and same product of workzone standard (Launchpad), we support only single IAS tenant. 
|  
|  In case your second IAS already has an IPS and the relevant SAP Workzone connectors (in target systems), you can skip this step and ignore the error on IAS tenant http://aesaihs6w.accounts.ondemand.com/admin.
|  
|  The error itself will remain until you will deactivate or delete the second IAS.
|  
|  If your second IAS does not have an IPS, hence, please deactivate and the second IAS and retrigger the IPS with the first IAS tenant: http://aesaihs6w.accounts.ondemand.com/admin.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  17. Post Booster Workflow:
|  The Workflow roles are created when you run the booster.
|  
|  This is part of the onboarding to Work Zone, Advanced Edition and the integration with the Workflow service.
|  
|  The roles with the (1) suffix are roles created for backward compatibility and you can ignore them.
|  
|  If re-running the booster solved your issue, please close the incident.
|  
|  If you encounter any more issues, please open a different ticket and we would be happy to help.
|  
|  18. WorkZone Advanced, No access to Admin:
|  WorkZone Advanced, No access to SAP Build WZ:
|  
|  Hi,
|  
|  Please make sure the user has the appropriate role (and mapping):
|  
|  https://help.sap.com/docs/SAP_Cloud_Platform_Master_Data_for_Business_Partners/246fb358c1c7413289c03b8c72734209/3fd36c16f4dd4deaa28033fd690d8deb.html?q=Creating%20Role%20Collection%20Mappings
|  
|  
|  
|  The user must be assigned to Workzone_Admin or Workzone_EndUser role collection. 
|  
|  So you can create role mapping with one of these roles to respective user group in idp.
|  
|  
|  
|  19. "About" in Me Area:
|  Can you please follow the following steps and send us a screenshot:
|  
|  1. Navigate to the application
|  
|  2. Go to "Me Area" (top right corner)
|  
|  3. Select "About"
|  
|  4. Send us a screenshot of the "About"
|  
|  20. IAS:
|  Dear Customer,
|  
|  After further investigating your incident, we found that you don't have an active IAS.
|  
|  You need to create a trust between SAP Cloud Identity Services - Identity Authentication and SAP BTP.
|  
|  Please see our documentation's prerequisite (4th bullet point):
|  
|  https://help.sap.com/docs/build-work-zone-standard-edition/sap-build-work-zone-standard-edition/switching-to-sap-cloud-identity-services-identity-authentication#how-to-switch-to-sap-cloud-identity-services---identity-authentication
|  
|  Please make sure you have completed all steps correctly.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  We already identified the issue. Please refer to the document my colleague Raz has sent.
|  In order to enable the Identity Authentication you need to have an active IAS trust in the BTP Cockpit based on OIDC protocol.
|  As I see from the har file you sent, your trust is based on SAML.
|  
|  Please note this prerequisite from the official documentation:
|  
|  If you're using OIDC protocol, then you don't need to do anything.
|  If you're using Security Assertion Markup Language (SAML) protocol, you need to switch to OIDC, as described in the following migration process in SAP Note: 3311563
|  You must complete these prerequisites before you can enable the Identity Authentication.
|  
|  Please complete the steps and then try again. If after that you're still witnessing issues, let us know.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  IAS for PS (How to handle IAS tickets):
|  
|  Hi PS Colleagues,
|  
|  I'm reverting this back to your team just to share how to handle error when trying to connect to IAS.
|  
|  Below are points for IAS errors:
|  
|  1. Until further notice, IAS connection errors should be opened on component EP-WZ-ASH.
|  
|  2. Please differentiate between IPS and IAS tab and dispatch accordingly.
|  
|  3. A HAR file up to 7 days old, is mandatory when navigating to site settings and selecting IAS tab.
|  
|  4. In HAR file, look at moveFromSaasProvisioning request in dev tools and see response to see the error.
|  
|  5. According to error, we will need to see if checking Kibana logs will give us more information.
|  
|  In this incident, HAR file is older than 7 days, please request a new HAR file and record from log in until reproducing the error.
|  
|  If further help is needed please send incident back with new HAR file.
|  
|  
|  
|  21. Multiple problems in one ticket:
|  Dear Customer,
|  
|  Your new reported issue seems like a new issue and we would need you to open a new ticket for this to reach relevant team.
|  
|  It is very important for us to keep tickets with a single issue, so teams don't need to read non relevant information.
|  
|  Please open a new ticket so we can gather relevant information in order to fix the issue.
|  
|  Also, if this is in very high priority, please mention this in the ticket so they can dispatch to relevant team as soon as possible.
|  
|  Thank you for your understanding and cooperation.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  You have reported different queries under a single incident, which is not encouraged by SAP Product Support.
|  
|  While we do our best efforts to help with consulting questions if we can do it within reasonable effort, this is at our discretion.
|  
|  Hence, to be able to handle each of your queries to the respective area experts, we ask you to report one incident for each issue.
|  
|  This procedure is detailed in SAP note: 50048 - Several queries in an incident
|  
|   
|  
|  Therefore, you are kindly asked to close this incident (as the initially reported issue is now solved),
|  and create new incidents for any additional questions.
|  
|  Thank you for your understanding.
|  
|  
|  
|  22. Waiting Message:
|  Dear Customer,
|  
|  We sincerely empathize with the issue you are facing, and we want to assure you that resolving this issue is our topmost priority.
|  
|  Rest assured, our dedicated team is actively working on rectifying the problem and we are committed to keeping you updated on our progress every step of the way.
|  
|  Thank you for your understanding and patience.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  We understand the problem you're facing and want to let you know that we're working hard to fix it.
|  
|  Our team is actively working on a solution and will keep you updated.
|  
|  Thank you for your patience.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  Thank you for confirming the details. Our team of experts is currently investigating the issue, and I assure you that we're diligently working on it. Expect an update from us by tomorrow.
|  
|  We genuinely appreciate your cooperation and patience throughout this process.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  23. Consulting Message:
|  Dear <Customer>,
|  
|  The behavior that you described relates to a consulting issue rather than evidence of a possible error and/or bug, and therefore falls outside of the scope of SAP Support under the SAP maintenance agreement (See SAP Note 83020).
|  
|  SAP support does not provide services to custom development implementation.
|  
|  nevertheless we usually guide customers that require assistance in such tasks, to contact SAP services team. SAP consulting / CoE experts (either paid by customer or funded via IO) can support with such development instructions.
|  
|  We recommend first to follow our development guide: https://help.sap.com/docs/build-work-zone-standard-edition/sap-build-work-zone-standard-edition/development
|  
|  And also the following Localization documentation provided by UI5: https://sapui5.hana.ondemand.com/#/topic/91f217c46f4d1014b6dd926db0e91070
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  24. Lower Priority Message:
|  Dear Customer,
|  
|  Please note that the Very High priority is reserved for production down or showstopper for Go-Live [and no workaround is available] (see SAP Note 67739).  As the issue that you reported in this OSS message does not meet these criteria, I would like to ask you to lower the priority of this message to High. 
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  25. Too many entities:
|  Dear Customer, 
|  
|  Thank you for bringing your concerns regarding Maximum number of content items per site restrictions to our attention. We understand the significance of this issue, particularly for our larger customers who operate across multiple languages.
|  
|  I wanted to assure you that we are actively working on this matter with high priority in 2025 and beyond. However, I must acknowledge the complexity of this task, as it requires significant architectural changes to overcome the current restrictions.
|  
|  In the meantime, we encourage you to consider the following alternatives:
|  
|  Different Sites for Different Languages: Operating with distinct sites for each language can serve as a viable workaround. This ensures there is a centralized entry point for users in each language.
|  Gradual Expansion: Some customers have opted to commence their operations with a limited set of languages initially, with plans to incorporate additional languages at a later stage. While not an ideal solution, it may be a practical approach under the current circumstances.
|  We understand that neither of these options is perfect and that they may pose challenges for your operations. Unfortunately, we are unable to offer alternative solutions at this time.
|  
|  We appreciate your understanding and patience as we continue to work towards resolving this matter. 
|  
|  Should you have any further questions or require additional assistance, please do not hesitate to reach out to us.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  It was a pleasure meeting with you today, and I appreciate the productive discussion. Below is a summary of the key points we covered during the call:
|  
|  Issue Overview
|  The issue you're facing is related to exceeding the maximum number of content items per site in SAP Build Workzone. You can find more details on this restriction in the SAP documentation here: Maximum number of content items per site.
|  Recent Locale Additions
|  You mentioned that additional locales were added on Monday, which subsequently led to the site activation failure.
|  How to Check Site Status
|  For future reference, you can check the activation status of your site using the following URL format:
|  <Site URL>/cp.portal/bff_service/activation/site_state/<site_id>.
|  Please replace <Site URL> and <site_id> with the specific parameters for your subaccount and site.
|  Further details are available in this SAP Note: SAP Note 3433059.
|  Error Analysis
|  We ran the APIs for both your dev and test systems, and here are the key errors identified:
|  Test System:
|  TooManyEntities: The site contains 10,596 entities across 3 locales, totaling 31,788 entities, which exceeds the 30,000-entity limit.
|  Suggestion: Remove roles or role entities to reduce the total number of entities.
|  Dev System:
|  TooManyEntities: The site contains 10,138 entities across 5 locales, totaling 50,690 entities, which again exceeds the 30,000-entity limit.
|  Suggestion: Similarly, reduce the number of entities to bring it below the maximum.
|  After removing the German language in the test system, we observed that the site became accessible again, although a 'warning' state related to missing system aliases appeared:
|  missingAliases: Ensure that all aliases have been mapped correctly in the Channel Manager.
|  Next Steps
|  During the call, we discussed potential workarounds while addressing this issue:
|  Separate Sites for Different Languages: Consider setting up different sites for each language to manage content more effectively.
|  Gradual Language Expansion: Some customers start with a limited number of languages and expand gradually over time. While not ideal, this could help manage content within current system limitations.
|  We understand that these workarounds are not ideal and may present operational challenges. Unfortunately, we do not have other solutions available at this time.
|  We truly appreciate your patience and cooperation as we work towards resolving this. If you have any further questions or need assistance, please don’t hesitate to reach out.
|  
|  
|  
|  
|  
|  25. {{}} on Title:
|  Dear Customer,
|  
|  Please provide us with the following:
|  
|  1. Access to your Content Manager with an admin test user or SAP test user portaltechuser@sap.com
|  
|  2. What SAP documentation did you use to configure this?
|  
|  3. Please send us your content as there seems to be a misconfiguration on your content. It seems like you didn't add the translations for {{flpTitle}}.
|  
|  In general, when opening Page Builder > Add Widget > Add Tile the title of the applications are taken from the "sap.app" in the "vizConfig", unlike in the Content Manager where titles are taken from the "appTitle".
|  
|  To fix the issue on your end, please conduct the following:
|  
|  1. Add translation for "{{flpTitle}}" or switch to {{appTitle}}.
|  
|  2. Align translation "sap.app" in the "vizConfig".  
|  
|  Please update in the applications titles in the "sap.app" in the "vizConfig".
|  
|  Hence, please redeploy your applications, sync provider, and see relevant changes.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  26. Maximum number of 150 role collections assigned to a user:
|  Dear Customer,
|  
|  We have identified the root cause of the issue you encountered. It appears that the affected users have exceeded the "Maximum Number of Role Collections Assigned to a User." Specifically, these users have been assigned over 250 role collections, which has caused the JWT token to exceed its size limit, resulting in the 431 error due to the oversized header.
|  
|  To resolve this, users should not be assigned more than 150 role collections, we saw in the call when reducing the amount of role collections the issue was resolved.
|  
|  For more details, you can refer to our "Restrictions" document, section "Maximum number of role collections assigned to a user" here:
|  Restrictions Document
|  
|  To avoid this limitation in the future, we recommend integrating your subaccount with the Identity Provisioning Service (IPS). More information on the IPS integration can be found here:
|  IPS Integration Documentation
|  
|  Thank you for your patience and cooperation, it was a pleasure supporting you.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  
|  
|  27. Restriction / Limitation:
|  Dear Customer,
|  
|  Thanks for submitting your ticket.
|  
|  The reported issue is a product limitation.
|  
|  Please view the Restrictions and known issues to take into consideration when using SAP Build Work Zone, standard edition:
|  
|  https://help.sap.com/docs/build-work-zone-standard-edition/sap-build-work-zone-standard-edition/restrictions-general
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  28. Not under EP-WZ component / Move to relevant component:
|  Dear Customer,
|  
|  The issue you reported is not directly related to SAP Cloud Platform, Portal service.
|  As a result, we have changed the incident component to the relevant one.
|  
|  Our colleagues will get back to you soon.
|  
|  We will follow up on the ticket resolution.
|  
|  Best Regards,
|  
|  <Your Name>
|  
|  SAP Work Zone Service
|  
|  SAP Development Support
|  
|  
|  
|  NEO:
|  1. How to duplicate site on NEO:
|  In order to duplicate site please follow the following steps:
|  
|  Navigate to the "Site Directory" (in the admin site).
|  Find the tile of the site you want to duplicate.
|  Press the down arrow button (next to the "edit" button) on the tile.
|  Press 'Duplicate'
|  A copy of the site will be created (you will see a new site with the same name only with "_Copy" at the end).
|  Press "edit" on the tile.
|  Publish the site (the button with the earth icon at the top of the page)
|  Press "Publish and Open"
|  • • Then enter with the user that is not working and check if you can access the duplicated site with this user.
|  
|  
|  
|  2. Update UI5 Version NEO:
|  To update the site UI5 Version:
|  
|  Access SAP Cloud Portal Cockpit
|  Go to Site Directory and edit the affected side
|  On Site Settings, click on edit and change the SAPUI5 Version to a supported version
|  Save the changes
|  • • Publish the sites so that the changes take effect
|  
|  ———————————————————————————————————————
|  
|  Dear Customer,
|  
|  In general, the best practice for managing portal's themes is to use Innovation version as the site's SAPUI5 version and to enable the Theme Update feature for all your themes.
|  
|  This feature will automatically adjust your theme to the current UI5 innovation version. For more information, please refer to: https://help.hana.ondemand.com/cloud_portal/frameset.htm?8b4b801695564ad4b9601a2878162636.html
|  
|  However, you may choose to use a specific UI5 version for your site. In this case, the offered solution is to have one test site with the Innovation version and another productive site with a specific version.
|  This way you could ensure that your theme does not break and decide when is the best time to upgrade your site to a newer version. 
|  
|  Please find below the relevant SAPUI5 documentation - we would like to ask you to make sure you develop all your code with full compliance to the UI5 compatibility rules: 
|  
|  UI5 compatibility rules
|  
|  https://sapui5.hana.ondemand.com/#docs/guide/91f087396f4d1014b6dd926db0e91070.html
|  
|  Static code checks
|  
|  https://help.hana.ondemand.com/webide/frameset.htm?914e983814c940ad9b642578af8c23e2.html
|  
|  
|  
|  
|  
|  
|  
|  3. "Oops" error NEO extension:
|  NEO extension, customer receiving 'Oops' error.
|  
|  Seems like a configuration issue, ASK OPS / Boaz to please check if 'tenantType' parameter is not missing in our database.
|  
|  —————————————————————————————————————————
|  
|  Glad to hear the issue is now resolved. Let me explain:
|  
|  We had a call with our Operations Team to review the parameters saved under your tenant. Upon investigation, we identified the following configuration:
|  {  
|    "status": "OK",  
|    "tenant_configurations": {  
|      "alias": "w6v1wzjk5v",  
|      "tenantID": "923117dc-f780-4a1e-b50a-d7bbc233541e"  
|    }  
|  }  
|  We noticed that the TenantType parameter was missing from your tenant configuration. This was added on Sunday, and I reached out to confirm whether this resolved the issue. However, you mentioned this morning that you were still encountering the "Oops Site Not Found" error.
|  
|  After further escalation to our SF colleagues for additional review, they confirmed that the issue was resolved due to the change made by the Operations Team, specifically the addition of the "tenantType": "SFSF" parameter.
|  
|  It seems that the missing parameter was the root cause of the issue, as it had not been saved to your tenant earlier.
|  
|  I hope this clarifies why the error occurred and how it was resolved.
|  
|  It was a pleasure supporting you!
|  
|  
|  
|  
|  
|  4. External Access Point:
|  When Setting up External Access Point Landscape (https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-for-neo-environment/set-up-external-access-point-landscape) in a site, an HTML5 application is automatically generated behind the scenes for each destination. These HTML5 applications act as proxy applications to the backend, and they are created within your subaccount with the prefix "System..".
|  
|  To modify the configuration and enable direct navigation to WDA/GUI applications without passing through the proxy application, you need to disable the External Access Point on your site. This can be done by setting the "Access Classic UIs" option to "No, but show in launchpad," followed by publishing the site.
|  
|  
|  
|  5. Billing NEO:
|  Dear Customer,
|  
|  Your ticket reached the Portal service development team.
|  
|  In subscription base account Fiori Cloud is enabled inside the Portal Service and there is no dedicated Fiori Cloud tile in the cockpit as in CPEA accounts.
|  
|  It seems that Fiori Cloud was enabled once you were in subscription base.
|  
|  Once moving to CPEA account a Fiori Cloud tile is added automatically as false by default.
|  
|  As the Fiori Cloud was already enabled when you were still in subscription base - the flag that indicates whether Fiori Cloud is enabled for your account was already set to true in our Database.
|  
|  This is why you keep seeing charges even that the Fiori Cloud service tile is disabled in the Cockpit.
|  
|  Please subscribe to "SAP Fiori Cloud" service in your CPEA subaccount and then unsubscribe the service.
|  
|  This should change the configuration for your account and stop the billing.
|  
|  For a refund please contact your Customer Success Expert or Account Executive.
|  
|  
|  
|  
|  
|  6. Credentials Pop up NEO:
|  When choosing the "Content package (site content and configuration)" export option a credentials popup is displayed as this export option includes extracting information from the BTP subaccount such HTML5 applications.
|  
|  There are two options to receive the 500 error: 
|  
|  Option 1
|  The user is not a member in the subaccount. a 500 error is thrown as the user doesn't have the relevant permissions to extract the data from the BTP subaccount.
|  
|  I noticed that the P000181 user is not a member of the DAIKIN INDUSTRIES,LTD DEV IGOM subaccount so this user doesn't have the necessary permissions in order to export the site.
|  
|  S0020161629 is not a member in the subaccount too so I expect the same error when trying to export the site too.
|  
|  S0024862314 is a member in the subaccount but in the "IGOM SCP site export error" file I saw you couldn't export the site either - am I right? If this is the case indeed it leads me to the second option.
|  
|  Option 2
|  
|  Two-factor authentication was enabled in this account. In this case, only technical users will be able to export the site and pass the credentials popup step.
|  If I understand it correctly P000181 is a technical user while the S users are not technical users - please try to add the technical user P000181 to the subaccount and validate that the export pass successfully.
|  In such case, I won't expect any S user (if it is not a technical one) to be able to export the site. Please use only technical users for exporting the site.
|  
|  Is two-factor authentication enabled for this account? Can you please check both options and let me know if one of them is indeed your issue?
|  
|  
|  
|  7. ASKHR incidents collecting information:
|  Dear Customer,
|  
|  Thanks for submitting your ticket.
|  
|  In order to resolve this ASK HR issue, please provide us the following details:
|  
|  1. The SuccessFactors (SFSF) hostname, including your company ID (e.g. https://salesdemo4.successfactors.com)
|  
|  2. A user and password to login to SFSF (for item#1 above)
|  
|  3. The account's name in HCP and on which data center it is located (e.g. https://account.hana.ondemand.com/cockpit#/acc/aab4aef77/accountdashboard )
|  
|  4. Please add i309025 as an account administrator via the HCP cockpit -> members -> add members (click the administrator in the assigned roles section)
|  
|  5. The C4C backend (CRM) system URL and admin user credentials
|  
|  6. A user and password to login to SFSF provisioning system (e.g. https://salesdemo4.successfactors.com/provisioning_login)
|  
|  This will allow us to review the configuration on all relevant systems.
|  
|  
|  
|  
|  
|  List of product KBAs
|  2390413 - Mobile docs 403 error on cloud portal
|  
|  2390453 - Userid is showing instead of username on Cloud portal
|  
|  2390988 - HCP Cloud portal service missing 
|  
|  2363135 - Portal Service Authorization error
|  
|  2363067 - Refresh widgets and apps
|  
|  2418533 - ‘Guest/Anonymous user cannot access custom apps’  
|  
|  2419671 - ‘Cannot edit standard SAP apps’
|  
|  2421949 - Error 'a technical error occurred!' loading PDF
|  
|  2441549 - Old version of app opening on HCP FLP
|  
|  2478561 - Delete Role for cloud Portal
|  
|  2491422 - Clear app cache on SAP Cloud Platform Portal
|  
|  2475023 - Unable to remove SAP role/group/catalog


                11.1.3.4.2

            11.1.3.5
        11.1.4 Components for assigning BCP and SNOW bugs, tags: Components BCP SNOW bugs tickets external internal, tags: Components, BCP, SNOW, tickets, bugs, customers
unified list: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=1990737255
03/03/22 15:32:07  BCP/Jira Components of Portal and contributors

CTMS component: BC-CTS-TMS
full name Basis Components >Change and Transport System >Transport Management System

ABAP CA-FLP-ABA
S4 backend, BC-ILM-FIO-S4

WorkZone Components The team responsible for the problem Bugs management tool/s SNow / BCP Component Project in JIRA (if relevant) & Component Additional guidance
CF Cloud Portal
CF FLP DEV (Sergey / Yosi) JIRA /BCP EP-CPP-CF-DEV DWPBUGS Portal Developer Scenario (Apollo) Portal on CF - V1 App Studio Extension
CF FLP Site Service(Shany) JIRA /BCP EP-CPP-CF-SSR Site Service
CF FLP Personalization, Theme manager (Shany) JIRA /BCP EP-CPP-CF-PER DWPBUGS Personalization
CF Free Style Content - Pages, Widgets, Sites (Nili Adoram ) JIRA / BCP EP-CPP-CF-FS DWPBUGS Freestyle Content
CF Portal/Launchpad Approuter, Activation, HTMLBootstrap (Nili Adoram) JIRA / BCP EP-CPP-CF-ASH Approuter, Activation, HTMLBootstrap
CF Portal/Launchpad Design Time Service (Yosi) EP-CPP-CF-DTS Design Time Service
CF Portal/Launchpad Site Management (Nili Adoram) JIRA / BCP EP-CPP-CF-SM DWPBUGS Site Directory, Site settings
CF Portal/Launchpad Business Content Integration (Sergey Alhazov) JIRA / BCP EP-CPP-CF-BCI DWPBUGS App Editor, Assignment Tab, Catalog Editor, Content Manager, Group Editor, Role Editor
CF Portal/Launchpad URL template (Sergey Alhazov) JIRA / BCP EP-CPP-CF-URL DWPBUGS URL Template
CF Portal /Launchpad Semantic Service (Sergey Alhazov) JIRA / BCP EP-CPP-CF-SEM DWPBUGS Semantic Service
CF Portal/Launchpad CDM Store (Yosi Izaq) JIRA / BCP EP-CPP-CF-CDM DWPBUGS CDM Store, CDM Schema, CDM Store Client, CDM Transformer
CF Launchpad Portal /Launchpad Transport Site, Content (Yosi Izaq) JIRA / BCP EP-CPP-CF-TR DWPBUGS Transport Service
CF Launchpad Portal /Launchpad Managing Remote Content Providers (Yosi Izaq) JIRA / BCP EP-CPP-CF-RCP DWPBUGS s/4 content provider
CF Portal/Launchpad Service Broker (Shany Shefer) JIRA / BCP EP-CPP-CF-SRB DWPBUGS Service Broker
CF HTML5 Applications View in BTP Cockpit (Shany Shefer) JIRA / BCP EP-CPP-CF-HAV DWPBUGS Launchpad Utilities
CF Neo Conversion Tool (Shany Shefer) BCP EP-CPP-CF-NCT
CF Portal/Launchpad /Workzone ODATA APIs (Shany Shefer) JIRA / BCP EP-CPP-CF-ODT DWPBUGS OData Service
CF Portal/Launchpad Provisioning(Yosi Izaq) JIRA / BCP EP-CPP-CF-PRV DWPBUGS Provisioning Service
CF Operations - DL CP Extensions Portals DevOps - Operations JIRA / BCP EP-CPP-CF-LND DWPBUGS DevOps, Operations CF
CF Portal/Launchpad Custom Domain (CF Operations - DL CP Extensions Portals DevOps - Operations) BCP EP-CPP-CF-DMN
CF Navigation service for Central Entry Point Core Services (Carlos) JIRA / BCP EP-CPP-CF-NAV DWPBUGS Navigation Service CF Central Entry Point Shell Toolkit (Carlos)
BCP EP-CPP-CF-SHT

SAP Workzone
Workzone bar: Notifications, Search, Admin Console, etc (Nili Adoram) BCP EP-WZ-BAR Workzone
Workzone Provisioning BCP/JIRA EP-WZ-PRV DWPBUGS 
Workzone Content Repository for Cards and Widgets BCP EP-WZ-REP

NEO Cloud Portal
NEO Free Style (Nili) JIRA / BCP EP-CPP-NEO-FS EUX-BUGS NEO Cloud Portal Freestyle Site
BCP EP-CPP-NEO-EXT NEO Cloud Portal Extension solutions
NEO FLP / FCC (Shany) JIRA / BCP EP-CPP-NEO-FCC-THM EUX-BUGS Cloud Portal Theme Service
EP-CPP-NEO-SFC Cloud Portal Launchpad site
EP-CPP-CF Cloud Portal on Cloud Foundry
EP-CPP-NEO-FCC Cloud Portal Fiori Configuration Cockpit
EP-CPP-NEO-FCC-LCM Cloud Portal Transport and Translation
services
EP-CPP-NEO-FCC-CDM Cloud Portal Content Management
EP-CPP-NEO-FCC-SST Cloud Portal site setting
Neo Operations EP-CPP-NEO-LS
Other teams - Contributors
Flexibility BCP CA-UI5-FL
FDC: CA-UI5-FL-CLS
HTML5 Rep JTrack CF-HTML5 Apps Repo
BCP component:
BC-CP-CF-HTML5
NGP Issue Tracking
Application Router /
Approuter
JTrack
BCP
Application Router
BC-XS-APR
NGP Issue Tracking - Application
Router
Destination Service JTRACK BC-CP-DEST NGP Issue Tracking
Component - CF-Destination
Service
PostGres JTRACK CP-BSB-POSTGRESQL NGP Issue Tracking
Web IDE on Cloud BCP / JIRA CA-WDE-DPL-HCP JIRA - DEVXBUGS
SFSF JIRA/BCP LOD-SF-PLT https://jira.successfactors.com
/secure/Dashboard.jspa
Project: Web Experience
Component: Global Header
FLP RT BCP CA-FLP-FE-UI FLP Homepage and native Extensions
FLP search team BCP HAN-AS-INA-UI
FLP Application integration BCP CA-FLP-FE-AI
Application Discovery BCP CA-FLP-FE-AD including App Finder
FLP Core BCP CA-FLP-FE-COR former CA-UI2-INT-FE
ABAP services
FCC@ABAP Server
BCP CA-FLP-ABA former CA-UI2-INT-BE
Web Dynpro ABAP BCP BC-WD-ABA
UI5 BCP CA-UI5-COR,
CA-UI5-CTR
additional UI5 and FLP RT components:
CSS Message Dispatching - Component CAFLP-FE-COR/UI
SAP ID service BCP BC-IAM-IDS IAS
CP Plugins BCP CA-WDE-PI-CP
OVP BCP Overview page: CA-FEOCP
HCP component BCP BC-NEO
Helium BCP BC-NEO-RT-HTML5 Runtime HTML5 Application
HCP SDK BCP Provisioning & Orchestration
App Index BCP CA-UI5-ABA-AIDX
LREP BCP CA-UI5-FL-LRP
Mdocs BCP BC-SRV-MCM
ECC BCP LOD-SF-EC
SMB BCP CA-GTF-SB-HCP-RT
Support Site BCP LOD-CRM-PRT-SRV
HCP CIS BCP BC-NEO-CIS
XRay BCP MOB-UIA-TUT
Unlocking backend users BCP DEV-S4HANA-USER
DLM BCP DEV-IW-GEN
LCM BCP BC-CP-LCM-SRV
Gateway Framework BCP OPU-GW-COR
FIORI Cloud Edition
Operations
BCP XX-FIO-OPR S4 on cloud ops
FLP on XSA BCP BC-XS-SRV-PTL
FLP on EP BCP EP-PIN-NAV-FFP Tuvia's team
Theme designer BCP CA-UI2-THD
Metering Service for
reporting on usage data
( fromcockpit)
BCP BC-NEO-MET-REP Venezia - overview page, usage analytic
MTA lifecycle management
operations
BCP BC-XS-SL-DS
FASE BCP BC-UPG-MP
cloud Foundry BCP BC-CP-CF
BE enablement BCP CA-FLP-ABA exposure tool from abap to CF
Mobile Services on Cloud
Foundry
BCP MOB-CLD-CF
SAP Work Zone Mobile Client BCP EP-WZ-MOB
SAP Mobile Start BCP MOB-APP-SMS
Jam Work Zone BCP/ JIRA LOD-SF-JAM-SWZ DIGITALWORKPLACE BCP should be used only in customer issues
Internally use JIRA!
SAP Work Zone Default
Content
BCP EP-WZ-DEF maintained by JAM team (Roger)
SAP Work Zone Microsoft
Teams Integration
BCP EP-WZ-MST
UI Integration Card Editor for
SAP BAS
BCP EP-WZ-BAS-UIC
Workflow Service Runtime
/Editor
BCP LOD-BPM-WFS
EP as content provider
solution
BCP EP-PIN-CNT-PRO
Notification BCP BC-CP-XF-SRT-NOT
Portal as a Content Provider
for cFLP
BCP EP-PIN-CNT-PRO
Booster JTRACK BC-CP-CF-BSTR NGPBUG
Cloud Cockpit - BlueStone
Cloud Connector
/Connectivity
JTRACK/BCP Cloud connector: BC-MIDSCC
Connectivity: BC-CPCON-CF, BC-NEO-CON
Identity and access
management- BC-NEOSEC-IAM
jtrack - cf-connectivity service
Web Assistant (help panel) BCP MOB-UIA-TUT
User Defaults BCP FI-FIO-GL
XSUAA BCP BC-CP-CF-SEC-IAM, BCXS-SEC
BTP / Cockpit BCP BC-CP-CF-CPT
Hana Enterprise Cloud BCP XX-AMS-HEC
SPC BCP AP-LM-PRV-RE
JIRA components in Project EUX-BUGS
App Index Shany Preview Mode Shany
App Resources Shany Preview UI Shany
Apps Editor Shany Publish/Draft mode Shany
Browse Apps Shany Release Management Shany
Catalogs Editor Shany Reports Oren
CDN Shany Roles Editor Shany
CPEA (PPU) Oren Site alias Shany
CPV1 client Adoram, Nili Site Setting Shany
CPv1 SF extensions Adoram, Nili Theme Manager Shany
CPv2 - ECM Adoram, Nili Translation Shany
CPv2 Admin Space Adoram, Nili Transport Shany
CPv2 APIs Adoram, Nili UI5 Settings Shany
CPv2 Content Unit Adoram, Nili Usage analitics Shany
CPv2 OOTB widgets Adoram, Nili WCE Adoram, Nili
CPv2 RT Adoram, Nili Web IDE integration Shany
CPv2 samples Adoram, Nili X-ray Shany
CPv2 SF extensions Adoram, Nili Legacy apps Shany
CPv2 Site Designer Editors Adoram, Nili Lrep Shany
CPV2 Site Settings Adoram, Nili Multi Version Shany
CPv2 site templates Adoram, Nili Navigation RT Shany
CPv2 support site Adoram, Nili Notification Shany
CPv2 Web IDE plugin Adoram, Nili oneFLP Shany
Default Site Shany Operations API's Shany
FASE Shany Publish/Draft mode Shany
FLP RT services Shany Semantic APIs Shany
Groups Editor Shany
Home Page Shany
Interceptor Moskovich, Guy

            11.1.4.1 internal Components
            https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?spaceKey=CPPortals&title=BCP+Components+-+Oct+2021

            11.1.4.2 Components (SNOW, BCP)
https://wiki.wdf.sap.corp/wiki/display/CPPortals/BCP+Components+-+Feb+2022

external components: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Contacts+and+Components
more external components: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=1990737255

        11.1.5 interesting tickets 

            11.1.5.1 session timeout and logout issues

                11.1.5.1.1 VH at 25/06/22 16:18:39  from TfNSW 
https://sap.service-now.com/now/workspace/agent/record/sn_customerservice_case/f573d9d41b5c9d14424a98a98b4bcb1b

Nili's explanation:
customer wants to extend the session to several hours due to the type of their business processes. however, sessions cannot be extended to more than 30 minutes due to commercialization decision (billing is done when the user logs out. if there is no logout, there is no billing..) . this is the standard answer to all customers. in some very rare cases, PMs are asking for exception such as in this particular case. in this case we offer the customer to develop a shell plugin that calls an FLP RT API to extend the session. in this case the session can be extended as much as needed.
 heart 1

the customer implemented this plugin but came across an error from backend. Alon found out that there is a missing patch in the ABAP backend

Alon Barnes:
Hi All, based on the test I run on my local laptop, using debug tools to simulate the fix that is needed in the ECC system, I can say that after 90 minutes no session was closed and FLP continued to work fine (as written above, I tested in https://selfservicedev.launchpad.cfapps.ap10.hana.ondemand.com).
This verifies that if the ECC system gets the patch I referred to, I am confident it will solve your issues.
At the moment, as the ABAP relevant team in Germany is on weekend, I can not say exactly what is the SAP Note number you need to apply (our team handles FLP Client code) , and I will be able to get it early tomorrow morning DE time. Once I have it I will send via email to this team.
repro guide: ~/work/SAP/documents/support:]2102$ ls CheckSessionLiveWithResourceOverride.docx 
                11.1.5.1.2
            11.1.5.2

        11.1.6
    11.2 DWP bugs, jiraa, open jira bug, tags: DWP bugs

        11.2.0  jira bugs templates , tags: jira bugs templates 

            11.2.0.1  Nili Bug template, tags: Nili Bug template

                11.2.0.1.1  


JIRA tickets are sometimes created without sufficient information for the developer to start analyzing.  
This could be improved by using templates.
 
I created a template for Jira bugs creation.
Going forward, please use the following URL to create a new Jira bug in DWPBUGS Jira project:
https://sapjira.wdf.sap.corp/secure/CreateIssueDetails!init.jspa?pid=66536&issuetype=1&description=*Bug+Description%3A*%0D%0A*Product+(Apollo\cFLP\BWP)%3A*%0D%0A*Landscape+Details+%3COrg,+Space%3E%3A*%0D%0A*Site+URL%3A*%0D%0A*Steps+to+Reproduce%3A*%0D%0A*Error+in+Logs%3A*%0D%0A*Screen+Shots%3A*%0D%0A
 
The bug will be created with the following text in the body of the bug (description field): 
Bug Description:
Product (Apollo\cFLP\BWP):
Landscape Details <Org, Space>:
Site URL:
Steps to Reproduce:
Error in Logs:
Screen Shots:
 
The above information is also available in the following wiki page (please save it as additional templates will be introduced soon):
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Templates+-+JIRA+bugs
 
Please let me know if you have any questions.


                11.2.0.1.2 Description
                11.2.0.2.3 Repro
                11.2.0.3.4 Root cause
                11.2.0.4.5 Fix
                11.2.0.5.6 PRs, diffs

            11.2.0.6 My jira template, tags: Shiri jira template
Bug Description:
Steps to Reproduce:
Expected:
Actual:
Landscape Details (subaccount / test user):
Product (Cloud Portal, Work Zone Standard, Work Zone Advanced, Sap Start):
***Please attach relevant logs or correlation ID and screenshots

            11.2.0.7
        11.2.1 add tests to resolver service, https://sapjira.wdf.sap.corp/browse/DWPBUGS-274

- add spaces, pages, sections input
- add negatives, like invalid input

        11.2.2 freestyle site doesn't work after export/import

https://sapjira.wdf.sap.corp/browse/DWPBUGS-365#view-subtasks

            11.2.2.1 Description
A site that has freestyle page is being exported, then imported
The page doesn't show app in runtime site

            11.2.2.2 Repro
create a site
add a new page to the site. click the + icon, buttom left.
make it a starter page.  name it, "starter"

add widget, title, just so it shows in RT
set the page as home-page.
export site
import site on different sub-account.
run the runtime site, you receive an error.


            11.2.2.3 Root cause
Looks like in the export file the "sap_everyone" role is not included.
It is filtere by
    private isEveryOneRole(entity: any) {
        return entity?.cdm?.identification?.entityType?.toLowerCase() === 'role' &&
            (entity?.cdm?.identification?.id === 'sap_everyone' || entity?.cdm?.identification?.id === 'sap_subaccount_everyone')
    }
It should be included in the export site with a relation to the pageapp


            11.2.2.4 Fix

            test on  LKG
    portaltest@mailinator.com
    abcUser1
    
https://flptest.lkg.dt.cpp.cfapps.sap.hana.ondemand.com/sitedirectory#Site-Directory

tsbug2 site
            
            11.2.2.5 PRs, diffs




            11.2.2.2

        11.2.3 [SMB] Global Content Provider - cannot be deployed if already DWPBUGS-534

            11.2.3.1 jira and description

jira: https://sapjira.wdf.sap.corp/browse/DWPBUGS-534

logs: https://logs.cf.sap.hana.ondemand.com/app/kibana#/dashboard/Requests-and-Logs?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-24h,to:now))&_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'logstash-*',key:correlation_id,negate:!f,params:(query:'0ec9183b-eb8c-11ea-91e2-eeee0a9320f4'),type:phrase,value:'0ec9183b-eb8c-11ea-91e2-eeee0a9320f4'),query:(match:(correlation_id:(query:'0ec9183b-eb8c-11ea-91e2-eeee0a9320f4',type:phrase)))),('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'logstash-*',key:component_name,negate:!t,params:(query:portal-cf-design-time-service-1598861807),type:phrase,value:portal-cf-design-time-service-1598861807),query:(match:(component_name:(query:portal-cf-design-time-service-1598861807,type:phrase)))),('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'logstash-*',key:component_name,negate:!t,params:(query:ui5-flexibility-design-and-configuration-green),type:phrase,value:ui5-flexibility-design-and-configuration-green),query:(match:(component_name:(query:ui5-flexibility-design-and-configuration-green,type:phrase)))),('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'logstash-*',key:component_name,negate:!t,params:(query:portal-cf-cdm-store-service-1597663219),type:phrase,value:portal-cf-cdm-store-service-1597663219),query:(match:(component_name:(query:portal-cf-cdm-store-service-1597663219,type:phrase))))),fullScreenMode:!f,options:(darkTheme:!f),panels:!((embeddableConfig:(),gridData:(h:5,i:'1',w:48,x:0,y:0),id:Navigation,panelIndex:'1',type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:20,i:'2',w:12,x:0,y:5),id:Correlation-Ids,panelIndex:'2',type:visualization,version:'7.4.2'),(embeddableConfig:(columns:!(component_name,correlation_id,level,request,response_status,response_time_ms),sort:!('@timestamp',desc)),gridData:(h:15,i:'3',w:36,x:12,y:5),id:Requests,panelIndex:'3',type:search,version:'7.4.2'),(embeddableConfig:(columns:!(component_name,correlation_id,level,logger,msg,timestamp),sort:!(timestamp,desc,!('@timestamp',asc))),gridData:(h:15,i:'4',w:36,x:12,y:20),id:Application-Logs,panelIndex:'4',type:search,version:'7.4.2'),(embeddableConfig:(),gridData:(h:10,i:'5',w:12,x:0,y:25),id:Levels,panelIndex:'5',type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:10,i:'6',w:16,x:0,y:35),id:Organizations,panelIndex:'6',type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:10,i:'7',w:16,x:16,y:35),id:Components,panelIndex:'7',type:visualization,version:'7.4.2'),(embeddableConfig:(),gridData:(h:10,i:'8',w:16,x:32,y:35),id:Spaces,panelIndex:'8',type:visualization,version:'7.4.2')),query:(language:lucene,query:(query_string:(allow_leading_wildcard:!f,analyze_wildcard:!t,default_field:'*',query:'*',time_zone:UTC))),timeRestore:!f,title:'Requests%20and%20Logs',viewMode:view)


Aug 31, 2020 @ 13:19:24.567	portal-cf-site-semantic-service-1598874429	0ec9183b-eb8c-11ea-91e2-eeee0a9320f4	ERROR	nodejs-logger	portal-cf-site-semantic-service/express/errors.js:16 - CDMStoreError: No message available
    at StoreClient.sendRequest (/home/vcap/app/src/services/store/store-client.js:36:19)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5) {
  response: {
    status: 403,
    statusText: 'Forbidden',
    data: {
      timestamp: '2020-08-31T13:19:24.559+0000',
      status: 403,
      error: 'Forbidden',
      message: 'No message available',
      path: '/cdm_store_service/cdm/search'
    }
  },
  data: {}
}	0
	Aug 31, 2020 @ 13:19:45.158	portal-cf-site-semantic-service-1598874429	0ec9183b-eb8c-11ea-91e2-eeee0a9320f4	INFO	nodejs-logger	portal-cf-shared-lib/utils/technical-token.js:211 - isTechnicalUser - client id sb-portal-cf-service-lkg!b63, tenant id messi 	0
	Aug 31, 2020 @ 13:19:45.158	portal-cf-site-semantic-service-1598874429	0ec9183b-eb8c-11ea-91e2-eeee0a9320f4	INFO	nodejs-logger	portal-cf-site-semantic-service/routes/index.js:36 - POST /semantic/entity/provider

Aug 31, 2020 @ 13:19:45.160	portal-cf-site-semantic-service-1598874429	0ec9183b-eb8c-11ea-91e2-eeee0a9320f4	INFO	nodejs-logger	portal-cf-shared-lib/common/service-request.js:77 - sendRequest - serviceAbsoluteUrl , serviceRelativeUrl /cdm_store_service/cdm/entity/provider/id/SmartBusinessTiles-service-lkg, serviceMethod post, options {
  headers: {},
  body: {
    direction: 'DOWN',
    level: 1,
    search: {
      metadata: { page: { number: 1, size: 10000 } },
      match: [ { '/cdm/identification/entityType': 'provider' } ]
    }
  },
  params: { context: 'SUB_ACCOUNT', contextType: 'SUB_ACCOUNT' },
  timeout: 5000,
  fullResponse: true
}	0

	Aug 31, 2020 @ 13:19:45.194	portal-cf-site-semantic-service-1598874429	0ec9183b-eb8c-11ea-91e2-eeee0a9320f4	INFO	nodejs-logger	portal-cf-shared-lib/common/service-request.js:210 - sendRequest - Request to https://portal-service-lkg.cfapps.sap.hana.ondemand.com/cdm_store_service/cdm/entity/provider/id/SmartBusinessTiles-service-lkg succeeded


code:
Basically, the issue should be resolved in the AuthorizationFilter in cdm where we need to check 
if the token has isProvider=true, we need to check if this tenant is a global provider then we should authorize all tenants passed as query params

-> fix point
src/main/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilter.java, doFilter
            if (CurrentTenantHolder.isCurrentTenantProvider()) {
                // check if it is a global provider. use prov service API for checking (tenant Id )
                // if so tenantContext.setAuthorizedTenants(tenantIdsToCheck);
                // else if ... (rest)
                if (providerTenantAuthorizationService.hasAuthorizations(tenantIdsToCheck)) {
                    tenantContext.setAuthorizedTenants(tenantIdsToCheck);
                    filterChain.doFilter(request, response);
                } else { // not Authorized
                    logger.error("No authorization to access one or more tenants.");
                    servletResponse.sendError(HttpServletResponse.SC_FORBIDDEN);
                }

-> CurrentTenantHolder is a TLS container for tenant data. defined in common lib
/Users/i500695/work/SAP/git/portal-cf-cdm-store-service/cdm.store.service/src/main/java/com/sap/portal/cf/security/service/impl/ProviderTenantAuthorizationService.java
public class CurrentTenantHolder {
    private static final ThreadLocal<String> currentTenant = new ThreadLocal();
    private static final ThreadLocal<String> currentTenantIdentityZoneId = new ThreadLocal();
    private static final ThreadLocal<String> currentTenantInstanceId = new ThreadLocal();
    private static final ThreadLocal<String> currentTenantUsername = new ThreadLocal();
    private static final ThreadLocal<List<String>> currentTenantAuthorizedProviders = new ThreadLocal();
    private static final ThreadLocal<Boolean> currentTenantIsProvider = new ThreadLocal();



-> Use provisioning_service global-provider API
src/main/java/com/sap/portal/tenant/provisioning/webaccess/GlobalProvidersController.java
  @ApiOperation(value = "Get all Global Providers")
    @GetMapping(value = {"/"}, produces = "application/json")
    @PreAuthorize("@securityService.hasGrantTypeClientCredentials()")
    public ResponseEntity<String> getAll() {
        ResponseEntity response = null;
        try {
            List<GlobalProvider> globalProviders = globalProviderService.getAll();
            globalProviders = (globalProviders != null) ? globalProviders : new ArrayList<>();
            response = new ResponseEntity<>(globalProviders, OK);
        } catch (RuntimeException e) {
            logger.error("GlobalProviderController::getAll() failed with error = {}", e.getCause());
            response = ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();
        }

        return response;
    }
Note returns json with array of [{namespace: val, providerId: id}, ..., {}]



UT:
src/test/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilterTest.java

            11.2.3.2 Fix

a. provisioning add GET, providers/isglobal?instancId=xxx&identityZoneId=yyy API

-> src/main/java/com/sap/portal/tenant/provisioning/webaccess/GlobalProvidersController.java
    @ApiOperation(value = "Is Global Provider")
    @GetMapping(value = {"/isglobal"}, produces = "application/json")
    @PreAuthorize("@securityService.hasGrantTypeClientCredentials()")
    public ResponseEntity isGlobalProvider(
            @RequestParam(value = "identityZoneId")
            @SafeHtml String identityZoneId,
            @RequestParam(value = "instanceId")
            @SafeHtml String instanceId) {
        logger.trace("GlobalProviderController::isGlobalProvider() called with identityZoneId = {}, instanceId = {}", identityZoneId, instanceId);
        ResponseEntity response = null;
        try {
            boolean isGlobalProvider = globalProviderService.isGlobalProvider(identityZoneId, instanceId);
            response = new ResponseEntity<>(isGlobalProvider, OK);
        } catch (RuntimeException e) {
            logger.error("GlobalProviderController::isGlobalProvider() failed with error = {}", e.getCause());
            response = ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();
        }
        return response;
    }



-> src/main/java/com/sap/portal/tenant/provisioning/service/GlobalProviderService.java
    @Override
    public boolean isGlobalProvider(String identityZoneId, String instanceId) throws IllegalArgumentException {
        List<GlobalProvider> globalProviders = this.getAll();
        return globalProviders.stream().anyMatch(provider ->
                (provider.getIdentityZoneId().equals(identityZoneId)) && (provider.getInstanceId().equals(instanceId))
        );
    }

-> UT. src/test/java/com/sap/portal/tenant/provisioning/webaccess/GlobalProviderSControllerIT.java
response for get all global providers:
[{"identityZoneId":"consumer1_identityZone","instanceId":"portal1_instanceId","tenantId":"a42d1322b7206410e88b7b4f10addc35","namespace":"ssuite.smartbusiness.tiles","providerId":"providerId1"}]

->
b. use in CrossTenantAuthorizationFilter doFilter when isCurrentTenantProvider 
if GlobalProvider - setAuthorizedTenants for all consumer tenants

-> E2E
Subject: RE: Global Content Provider - cannot be deployed if already used - 403 Authorization
 
Hi Yosi,
 
We tried deploying again in LKG and it completed without any errors.

Thanks,
Saurabh
--- 
From: Izaq, Yosi <yosi.izaq@sap.com> 
 
Hi Saurabh,
 
Re. https://sapjira.wdf.sap.corp/browse/DWPBUGS-534
A possible fix is deployed to LKG.
Can you plz try to redeploy your SMB provider to LKG so we can verify that the fix works?
 
Thank you!
Yosi

-> PR
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/539
From 6a9ea52f65c18768f5430852a5ce9987291c3aed Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Wed, 2 Sep 2020 14:32:43 +0300
Subject: [PATCH 1/2] DWPBUGS-534: set authorization for all providers

---
 .../filters/CrossTenantAuthorizationFilter.java      | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

diff --git a/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilter.java b/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilter.java
index 550ba36f5..c02bbcda8 100644
--- a/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilter.java
+++ b/cdm.store.service/src/main/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilter.java
@@ -95,13 +95,11 @@ public void doFilter(ServletRequest request, ServletResponse response, FilterCha
             }
 
             if (CurrentTenantHolder.isCurrentTenantProvider()) {
-                if (providerTenantAuthorizationService.hasAuthorizations(tenantIdsToCheck)) {
-                    tenantContext.setAuthorizedTenants(tenantIdsToCheck);
-                    filterChain.doFilter(request, response);
-                } else { // not Authorized
-                    logger.error("No authorization to access one or more tenants.");
-                    servletResponse.sendError(HttpServletResponse.SC_FORBIDDEN);
-                }
+                // Fix for DWPBUGS-534. Global provider check returns 403
+                // ATZ all providers. Note that we plan to allow ATZ to all
+                // providers anyway. It will be implemented soon in a more encompassing manner
+                tenantContext.setAuthorizedTenants(tenantIdsToCheck);
+                filterChain.doFilter(request, response);
             } else if (crossTenantAuthorizationService.hasAuthorizations(tenantIdsToCheck)) {
                 tenantContext.setAuthorizedTenants(tenantIdsToCheck);
                 filterChain.doFilter(request, response);

From 453f9770c2f2fd806039580f0fa22a38ad950e3a Mon Sep 17 00:00:00 2001
From: i500695 <yosi.izaq@sap.com>
Date: Wed, 2 Sep 2020 14:43:24 +0300
Subject: [PATCH 2/2] DWPBUGS-534: set authorization for all providers

---
 .../security/filters/CrossTenantAuthorizationFilterTest.java | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/cdm.store.service/src/test/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilterTest.java b/cdm.store.service/src/test/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilterTest.java
index 4df4f5155..1ec9ab422 100644
--- a/cdm.store.service/src/test/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilterTest.java
+++ b/cdm.store.service/src/test/java/com/sap/portal/cf/security/filters/CrossTenantAuthorizationFilterTest.java
@@ -99,11 +99,8 @@ public void EndpointSupportCrossTenantPassingTenants_with_isProvider_true_test()
         };
         // is Provider flow
         Mockito.when(CurrentTenantHolder.isCurrentTenantProvider()).thenReturn(true);
-        Mockito.when(providerTenantAuthorizationService.hasAuthorizations(Mockito.anyListOf(String.class))).thenReturn(true);
         Mockito.doNothing().when(tenantContext).setAuthorizedTenants(Mockito.anyList());
         crossTenantAuthorizationFilter.doFilter(httpServletRequest, httpServletResponse, filterChain);
-        Mockito.verify(providerTenantAuthorizationService, Mockito.times(1)).hasAuthorizations(tenantIds);
-        Mockito.verify(crossTenantAuthorizationService, Mockito.times(0)).hasAuthorizations(Mockito.anyList());
         Mockito.verify(filterChain, Mockito.times(1));
     }
 
@@ -122,8 +119,6 @@ public void EndpointSupportCrossTenantPassingTenants_with_consumerIdentityZoneId
         Mockito.when(providerTenantAuthorizationService.hasAuthorizations(Mockito.anyListOf(String.class))).thenReturn(true);
         Mockito.doNothing().when(tenantContext).setAuthorizedTenants(Mockito.anyList());
         crossTenantAuthorizationFilter.doFilter(httpServletRequest, httpServletResponse, filterChain);
-        Mockito.verify(providerTenantAuthorizationService, Mockito.times(1)).hasAuthorizations(tenantIds);
-        Mockito.verify(crossTenantAuthorizationService, Mockito.times(0)).hasAuthorizations(Mockito.anyList());
         Mockito.verify(filterChain, Mockito.times(1));
     }
 
-> Release-candidate template
From: Dagan, Saar <saar.dagan@sap.com> 
Sent: Thursday, September 3, 2020 9:24 AM
To: DL CP Extensions Portals Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>; Barel, Chen <chen.barel@sap.com>
Cc: Sarfati, Dana <dana.sarfati@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>; Klieger, Assaf <assaf.klieger@sap.com>; Haviv, Tal <tal.haviv@sap.com>
Subject: Patch request - SMB provider can't redeploy solution (REL_CANDI)
 
Hi,
I would like to request an approval for providing a fix via a patch, with the following details: 
Description of the bug: CF Global Provider redeployment fails
Link to Jira bug (labels & versions are set): https://sapjira.wdf.sap.corp/browse/DWPBUGS-534
Root cause of the bug: Since global provider update flow is the same as normal CF update flow it was not taken into account the fact it has no subscribers
Link to BCP:
Explain why it was not found / identified internally earlier: we don't control the deployment of global provider
Submitted to master and tested: [Yes] 
Risk level: low
Automation exist / added for this flow: [Yes]
Explain why the fix should be delivered as a patch (and not via the regular release process): Product requirement @Barel, Chen – if you have anything to add to why this is needed as patch
Debrief: 
What happened: redeployment of CF Global provider failed 
Why did it happen: flow was not taken into account
How I will improve: Prepare a more realistic mock environment in similar tasks. 
Name of the relevant micro service (only for CF): CDM-Store-Service
 
 
Thanks,
Saar

-> RC PR
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/541
            11.2.3.3 export (site and granularity) multiple providers call
            https://sapjira.wdf.sap.corp/browse/DWPBUGS-880

                11.2.3.3.1 Description
  public async isDefaultOotbProvidersContent(entity: any, clientToken: string): Promise<boolean> {
        this.logger.verbose('ExportEntitiesService::execute() started');

        if (!this.providers) {
            this.providers = await this.providerService.getZoneAvailableProviders(clientToken);
        }

        const embeddedBaseProviderIds: string[] = this.providers.filter((provider: ProviderDto) => provider.exposedContent === ExportEntitiesService.EMBEDDED)
            .map(provider => 

{                 return provider.baseProviderId || provider.id;             }
);
        this.logger.debug('ExportEntitiesService:: toContext=subAccount, embeddedBaseProviderIds = {%s}', embeddedBaseProviderIds);

        const entityProviderId: string = this.providerService.extractProviderIdFromEntity(entity);
        return embeddedBaseProviderIds.includes(entityProviderId);
    }
 
The bold text happens in a loop until the request returns.
 
we need to make sure in start of export, call once with await (to get providers)
and only then start the export process

                11.2.3.3.2 Gil fix
public async isDefaultOotbProvidersContent(entity: any, clientToken: string): Promise<boolean> {
        this.logger.verbose('ExportEntitiesService::execute() started');

 

        if (!this.providersPromise) {
            this.providersPromise = this.providerService.getZoneAvailableProviders(clientToken);
        }
        this.providers = await this.providersPromise;
        const embeddedBaseProviderIds: string[] = this.providers.filter((provider: ProviderDto) => provider.exposedContent === ExportEntitiesService.EMBEDDED)
            .map(provider => {
                return provider.baseProviderId || provider.id;
            });
        this.logger.debug('ExportEntitiesService:: toContext=subAccount, embeddedBaseProviderIds = {%s}', embeddedBaseProviderIds);

 

        const entityProviderId: string = this.providerService.extractProviderIdFromEntity(entity);
        return embeddedBaseProviderIds.includes(entityProviderId);
    }
                11.2.3.3.3 root-cause
all the calls to exportEntitiesService.isDefaultOotbProvidersContent() are fired at once with promise.all

-- ootb method
    public async isDefaultOotbProvidersContent(entity: any, clientToken: string): Promise<boolean> {
        this.logger.verbose('ExportEntitiesService::execute() started');

        if (!this.providers) { //all the promise.all promises pass this test since this.providers is null until getZoneAvailableProviders() is resolved
            this.providers = await this.providerService.getZoneAvailableProviders(clientToken);
        }

        const embeddedBaseProviderIds: string[] = this.providers.filter((provider: ProviderDto) => provider.exposedContent === ExportEntitiesService.EMBEDDED)
            .map(provider => {
                return provider.baseProviderId || provider.id;
            });
        this.logger.debug('ExportEntitiesService:: toContext=subAccount, embeddedBaseProviderIds = {%s}', embeddedBaseProviderIds);

        const entityProviderId: string = this.providerService.extractProviderIdFromEntity(entity);
        return embeddedBaseProviderIds.includes(entityProviderId);
    }

-- promise.all flow
src/export/export.job.ts has this method generator func:
    private getExportEntityFunction(zipExporter: ZipExporter, clientToken: string): (entity: any) => Promise<void> {
        const exportEntitiesService: ExportEntitiesService = new ExportEntitiesService(this.providerService, this.loggerFactory);

        return async (entity: any) => {
            if (!(await exportEntitiesService.isDefaultOotbProvidersContent(entity, clientToken))) {
                await zipExporter.writeEntity(entity);
            }
        };
    }

it is used in exportEntities(), When the actual generated method is set in promises array
                    entityFetchedCallback: this.getExportEntityFunction(zipExporter, clientToken)

then all the promises are added to array and fired at same time.
    private async retrieveEntitiesFromStoreAndExport(exportEntityDtoArray: ExportEntityIdDto[],
                                                     clientToken: string,
                                                     exportEntityFunction: (entity: any) => Promise<void>): Promise<void[]> {
        const numberOfEntitiesPerRequest = 30;
        let currentEntitiesNumberAddedToSearch = 0;
        const exportEntityCallbacksPromises: Promise<void>[] = [];
        let search: Search;
        search = this.createNewSearch();
        for (const exportEntityDto of exportEntityDtoArray) {
            ...
                currentEntitiesNumberAddedToSearch++;
                if (currentEntitiesNumberAddedToSearch === numberOfEntitiesPerRequest) {
                 ..
                    exportEntityCallbacksPromises.push(...this.exportEntitiesUsingCallback(entities, exportEntityFunction));
                    ...
                }
            }
        }

        if (currentEntitiesNumberAddedToSearch > 0) {
        ...
            exportEntityCallbacksPromises.push(...this.exportEntitiesUsingCallback(entities, exportEntityFunction));
        }

        return Promise.all(exportEntityCallbacksPromises);
    }
exportEntityCallbacksPromises
                11.2.3.3.4 my fix

Gil's fix won't work b/c each consumer had different token/ID zone/providers.
Either we create a singelton w/ map of promises for getZoneAvailableProviders() and then another map for the resolved promises (actual providers)
or we instantiate a new ExportEntitiesService per request. I chose this option.
PR: https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service/pull/419

                11.2.3.3.5 repro logs

- transport
<url:/Users/i500695/work/SAP/logs/DWPBUGS-880/transport.logs>
- cdm store
<url:/Users/i500695/work/SAP/logs/DWPBUGS-880/cdm-store.logs>

- transport. fix
<url:/Users/i500695/work/SAP/logs/DWPBUGS-880/transport_fix.logs>
note. 1 time call 
[0m2021-02-08T10:41:58.85+0200  [95m2610d8fd-79c7-46f0-4925-e1042cc13479[0m  [1m[37m[4mOotbProvidersUtil:103 OotbProvidersUtil::getOotbProvidersContent() started[0m

N times call:
 6654 2021-02-08T10:42:04.53+0200  ^[[95m2610d8fd-79c7-46f0-4925-e1042cc13479^[[0m  ^[[1m^[[37m^[[4mOotbProvidersUtil:103 OotbProvidersUtil::isDefaultOotbProvidersContent()
started^[[0m
 6659 2021-02-08T10:42:04.53+0200  ^[[95m2610d8fd-79c7-46f0-4925-e1042cc13479^[[0m  ^[[1m^[[37m^[[4mOotbProvidersUtil:103 OotbProvidersUtil::isDefaultOotbProvidersContent()
started^[[0m
 6664 2021-02-08T10:42:04.53+0200  ^[[95m2610d8fd-79c7-46f0-4925-e1042cc13479^[[0m  ^[[1m^[[37m^[[4mOotbProvidersUtil:103 OotbProvidersUtil::isDefaultOotbProvidersContent()
 ...


                11.2.3.3.6
            11.2.3.4

        11.2.4 Template for Handover of Tickets from Product-Support to dev
SKU
DT and RT URLs
User - one of the options below:
User is provided in the secure area
Neo - technical user P2000037931, teamuser1234@gmail.com as TENANT_ADMIN
CF -  technical user portaltechuser@sap.com
If the other options are not available, please suggest any alternative way to reproduce
Steps to reproduce the issue in the following format: Step – Expected result – Actual result
Attached Screenshots, relevant for the issue
Error correlation ID
Have you reviewed the logs in Kibana and your findings

process:
Tickets that bypassed PS
Check if the ticket passed through PS before it reached our queue – it may be that it arrived directly to us bypassing Product Support – in this case send it to PS queue by updating  the organization to PS DCP Global

Feature Requests
If the ticket reached Dev and you need to close it as a Feature Request – check if we can update documentation on this, if not - inform Product Support using PS DS distribution list: DL Cloud Portal DS PS DL_59CCE7C55F99B7E5C700000B@global.corp.sap

PS DS distribution list
Use the PS DS distribution list DL Cloud Portal DS PS DL_59CCE7C55F99B7E5C700000B@global.corp.sap  to communicate important topics to Product Support – new functionality, outage, known bugs etc.

Handover Template
Check if Product Support provided all the details according to the attached Handover Template: If required information is missing, send the ticket back to PS queue

Weak Areas Analysis
All the tickets that you need to send back to Product Support for whatever reason or you closed it but think that PS were supposed to know how to solve it – please send also to @Magarill, Zhenia – I will collect and analyze the tickets till our next meeting to find weak areas/gaps

        11.2.5 JIRA searches and filters, tags: JIRA searches and filters

            11.2.5.1 Team bugs
reported by me: reporter = currentUser() order by created DESC
reported by Alon: reporter = I585770 ORDER BY created DESC
reported by Hadar: reporter = I055502 ORDER BY created DESC
reported by Jawad: reporter = I324180 ORDER BY created DESC
reported by Shirly: reporter = I310019 ORDER BY created DESC
reported by Gil: reporter = I349433 ORDER BY created DESC
reported by Yoav: reporter = I562394 ORDER BY created DESC
reported by Kalman: reporter = I540352 ORDER BY created DESC

            11.2.5.2

        11.2.6 Performance bugs.  tags: Performance bugs 

            11.2.6.1 20/03/23 13:23:24  
[13:15] Hamisha, Ronen
sure, So far we have 3:
DWPBUGS-3499 - Content Channel creation is failed on timeout
DWPBUGS-3474 - Failing to delete Content
DWPBUGS-3485 - Content Channels with big data is stuck with "Creating..." status
we're managing the tickets here as well - https://wiki.one.int.sap/wiki/display/CPPortals/CSR+Related+Jiras

            11.2.6.2

    11.3 feature requests

        11.3.1 tags: SAP feature requests site 
        https://influence.sap.com/sap/
https://influence.sap.com/sap/ino/#/idea/276777/?section=sectionComments
The official process for submitting new feature requests is via Influence tool:https://influence.sap.com/sap/ino/#/campaign/2279
set the category to Digital Experience -> Fiori Launchpad.
        11.3.2
    11.4 hotfix , tags: hotfix, REL_CANDI, RC_CANDI, patch

        11.4.1 patch process , DORA tags: patch process DORA 
        https://wiki.wdf.sap.corp/wiki/display/CPPortals/Patch+process
https://wiki.one.int.sap/wiki/display/CPPortals/DORA+hotfix+process

Patch to RC branch:
When: A fix is required only to RC branch (either when the issue did not yet reach production or when it can wait till the regular timeline of deployment to production) 

Submit your fix to master and ensure successful tests & regression tests on lts
Create a ticket in DWPBUGS Jira project with a RC_CANDI label
Fill in the patch request template (see below)
Send an approval request email to DL BTP Core AP UE Services IL Patch with a link to the Jira ticket (subject of the email should include the patch type + the title of the bug)
The program lead (or one of the other approvers from the list below) will review the request and ask for more details in case needed (in case of approval the label is changed to RC_APPROVED)
Once approved, the code can be merged to RC branch 
PRs should be documented in the Jira ticket
After a green CI (which includes the deployment of the fix to rct system), the fix should be validated on rct system
Document the test system and results in the Jira ticket (as a comment)
In case we are after Q-Gate (week 2): If the fix is validated successfully on rct, Ops will deploy the fix to Canary Internal Production and run post deployment tests
Deployment status and post deployment tests results should be documented in the Jira ticket
Patch to Live branch - Hotfix to production:
When: A fix is required to Live branch and deployment to production out of the regular release timeline is required 

Submit your fix to master and ensure successful tests & regression tests on lts
Create a ticket in DWPBUGS Jira project with a RC_CANDI and HOTFIX_CANDI labels
Create an issue of type Hotfix and link it to the bug, as described here: https://wiki.one.int.sap/wiki/display/CPPortals/DORA+hotfix+process
Fill in the patch request template (see below)
Send an approval request email to DL BTP Core AP UE Services IL Patch with a link to the Jira ticket (subject of the email should include the patch type + the title of the bug)
The program lead (or one of the other approvers from the list below) will review the request and ask for more details in case needed (in case of approval the label is changed to RC_APPROVED and HOTFIX_APPROVED)
Once approved, the code can be merged to RC branch 
PRs should be documented in the Jira ticket
After a green CI (which includes the deployment of the fix to rct system), the fix should be validated on rct system
Document the test system and results in the Jira ticket (as a comment)
If the fix is validated successfully on rct, Ops will deploy the fix to Canary Internal Production and run post deployment tests
Deployment status and post deployment tests results should be documented in the Jira ticket
The code should be merged to Live branch 
PRs should be documented in the Jira ticket
After a green CI (which includes the deployment of the fix to hotfix system), the fix should be validated on hotfix system
Document the test system and results in the Jira ticket (as a comment)
If the fix is validated successfully on hotfix, Ops will deploy the fix to Production and run post deployment tests
Deployment status and post deployment tests results should be documented in the Jira ticket
[Traceability]: List of approved & delivered hotfixes (wiki): https://wiki.wdf.sap.corp/wiki/display/CPPortals/Hotfixes+Cloud+Portal
Patch to Live branch - not a hotfix to production:
When: A fix is required to Live branch but deployment to production will be done together with the regular release timeline (happens only on Wednesdays before regular deployment to production, after copy of RC to Live)

Submit your fix to master and ensure successful tests & regression tests on lts
Create a ticket in DWPBUGS Jira project with a LIVE_CANDI label
Fill in the patch request template (see below)
Send an approval request email to DL BTP Core AP UE Services IL Patch with a link to the Jira ticket (subject of the email should include the patch type + the title of the bug)
The program lead (or one of the other approvers from the list below) will review the request and ask for more details in case needed (in case of approval the label is changed to LIVE_APPROVED)
Once approved, the code can be merged to Live branch 
PRs should be documented in the Jira ticket
After a green CI (which includes the deployment of the fix to hotfix system), the fix should be validated on hotfix system
Document the test system and results in the Jira ticket (as a comment)
If the fix is validated successfully on hotfix, Ops will deploy the fix to Canary Internal Production and run post deployment tests
Deployment status and post deployment tests results should be documented in the Jira ticket


List of approvers:

Shiri Openhaim (Program Lead)
Daniel Yurowitz (COO)
Ilan Schwartz (Head of Development)
Eman Laham (Delivery Manager) - during 29/09/2023 - 007/10/2023
Sascha Kiefer
***Requestor and approver are not the same person



Template for patch approval request:

Fix required for RC branch / Live branch or both:
Link to Jira bug (labels & versions are set):
Link to BCP (in case there is one):
Description of the bug:
Root cause of the bug (why did it occur):
Explain why it was not identified internally earlier:
Proposed preventive measures (what steps should be taken to avoid this or similar issues in the future):
Explain why the fix should be delivered as a patch (and not via the regular release process):
Submitted to master and tested: [Yes / No]
Automation exist / added for this flow: [Yes / No] (if the answer in NO explain why)
Risk level:
Name of the relevant micro service:
NOTE: Risk level refers to the code you are adding in order to fix this issue (i.e. can cause a regression, etc).

Custom Domain changes (service request):
A new request for custom domain configuration is created
Ops create a Jira ticket using the following URL: https://sapjira.wdf.sap.corp/secure/CreateIssueDetails!init.jspa?pid=66536&issuetype=1&priority=2&labels=CUSTOM_DOMAIN&description=*Description%3A*%0D%0A*Link+to+customer+ticket+(BCP)%3A*%0D%0A*Required+on+RC+/+Live+/+both%3A*%0D%0A *PRs%3A*%0D%0A
Send an email to the program lead (or its substitute) with a link to the Jira ticket
The program lead (or its substitute) approves it (via a comment in the Jira ticket / APPROVED label)
Only then ops can go ahead with the configuration
Document the deployment status in the Jira ticket (as a comment)


Configuration changes (service request):
A new request for configuration is created
Ops create a Jira ticket using the following URL: https://jira.tools.sap/secure/CreateIssueDetails!init.jspa?pid=66536&issuetype=1&priority=2&labels=CONFIGURATION&description=*Description%3A*%0D%0A*Link+to+customer+ticket+(BCP)%3A*%0D%0A*Required+on+RC+/+Live+/+both%3A*%0D%0A%20*On+which+DC%3A*%0D%0A%20*PRs%3A*%0D%0A
Send an email to the program lead (or its substitute) with a link to the Jira ticket
The program lead (or its substitute) approves it (via a comment in the Jira ticket / APPROVED label)
Only then ops can go ahead with the configuration
Document the deployment / configuration status in the Jira ticket (as a comment)


Turning on a Feature Flag in RC / Live branch (service request):
Create a ticket in DWPBUGS Jira project with a FEATURE_FLAG label
Add the following details to the ticket:
Description:
Link to customer ticket (BCP):
Required on RC / Live / both:
PRs:
Send an email to the program lead (or its substitute) with a link to the Jira ticket
The program lead (or its substitute) approves it (via a comment in the Jira ticket + FLAG_APPROVED label)
Once approved (via a comment in the Jira ticket / APPROVED label) you can merge to RC / Live
Document the status in the Jira ticket (as a comment)


List of approvers for service requests (applicable only for custom domain / configuration / feature flag requests):

Shiri Openhaim (Program Lead)
Daniel Yurowitz (COO)
Ilan Schwartz (Head of Development)
Eman Laham (Delivery Manager)
Sascha Kiefer
***Requestor and approver are not the same person
        11.4.2 example hotfix
https://jira.tools.sap/browse/DWPBUGS-1789

        11.4.3 hotfix procedure
template for hotfix:
Fix required for RC branch / Live branch or both: Live Branch
Description of the bug: Deployment of workzone-content-provider failed on EU10 live
Root cause of the bug (why did it occur): DTS fails on timeout error
Explain why it was not identified internally earlier: We had no provider with such a large amount of sites**
Proposed preventive measures (what steps should be taken to avoid this or similar issues in the future): We need to improve the statement and write an integration test that validates that even with huge sites affected by a certain provider, we still can return a response in reasonable time**
Explain why the fix should be delivered as a patch (and not via the regular release process): Customers don’t manage to deploy their Apollo solution
Submitted to master and tested (Yes / No): Yes, was already validated in EU10 by Yael
Automation exist / added for this flow (if the answer is No explain why): Yes, but needs to be improved.
Risk level: No Risk.
Name of the relevant micro service: DTS

label bug as HOTFIX_CANDI
for rc (Release-candidate) label as REL_CANDI

approval from Shiri
DL CP Extensions Portals Patch <DL_5E1576ABEAB84C02816FE07D@global.corp.sap>

triple commit for three branches: master, rc, live

template for email:
- ex1:
Fix required for RC branch / Live branch or both: RC
Link to Jira bug (labels & versions are set):https://jira.tools.sap/browse/DWPBUGS-1776
Link to BCP (in case there is one): 
Description of the bug: The services ui5-flexibility-design-and-configuration and portal-ui5-flexibility-personalization were created and updated by the service-broker, and were not moved to the portal-global-services. With the new set of it, and the need to update them with x509 support, they must be moved to the portal-globe-services. Also, they need to be updated with x509 now in a different way than other services. So we need to add support as well.
Root cause of the bug (why did it occur): Developers did not move these services to portal-global-services.
Explain why it was not identified internally earlier: Since these services already exit we did not handle them until we found out that they need to be updated. They had to be updated on ac-canary-validation.
Proposed preventive measures (what steps should be taken to avoid this or similar issues in the future): We must have test environment from scratch and tests that force us to run update of these services.
Explain why the fix should be delivered as a patch (and not via the regular release process): The update of these services is required for supporting x509.
Submitted to master and tested: [Yes / No]: Yes (https://github.wdf.sap.corp/Portal-CF/portal-global-services/pull/281 and https://github.tools.sap/portal/product-cf-portal/pull/469 )
Automation exist / added for this flow: [Yes / No] (if the answer in NO explain why): Not yet. complicated scenario.
Risk level: Medium
Name of the relevant micro service (only for CF): portal-global-services
 Hotfix to live PR: https://github.tools.sap/portal/product-cf-portal/pull/471 and https://github.wdf.sap.corp/Portal-CF/portal-global-services/pull/284

- ex2:
  Hi Shiri,
I would like to request an approval for providing a fix via REL_CANDI/HOTFIX, with the following details:
Description of the bug: HTML5 Helium Provider is not created during customer subscription.
Link to Jira bug (labels, versions, description, risk,… all set in the ticket.):  https://sapjira.wdf.sap.corp/browse/DWPBUGS-842
Fix was already submitted to master and validated.

PR is created for RC branch and is ready to be merged: https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service/pull/263
Thanks,
Jawad

- 

        11.4.4 branches 
rc and live
[i500695@WYLQRXL9LQ:2022-10-31 16:38:03:~/git/portal-cf-transport-service:]2007$ gitlsbrAll  | grep -e "rc\|live"
  remotes/origin/backup-live
  remotes/origin/live
  remotes/origin/lodash-whitesource
  remotes/origin/rc
  remotes/origin/support_full_text_search
  remotes/origin/whitesource-fix

        11.4.5 configuration request, , tags: configuration request

            11.4.5.1  template
conf request template: https://jira.tools.sap/secure/CloneIssueDetails!default.jspa?id=20202768

email template:
Subject: Configuration request - Add the secondary Redis to US10, US21, and JP20
Hi Run,
 
Please approve https://jira.tools.sap/browse/DWPBUGS-7306.
 
See more details in the ticket.
 
Best regards,
Boaz
 

            11.4.5.2

        11.4.6
    11.5 tags: Documentation

        11.5.1 launchpad

            11.5.1.1 destinations
https://help.sap.com/docs/Launchpad_Service/8c8e1958338140699bd4811b37b82ece/f337b802513f437cb4f8cb02efe21990.html?state=DRAFT

            11.5.1.2

        11.5.2

    11.6 Recurring issues 

        11.6.1 tags: can't delete service instance

            11.6.1.1 Not able to  delete copin-portal-service instance in sandboxpm4 space
https://jtrack.wdf.sap.corp/browse/NGPBUG-190212
provisioning service log:
ProvidersController:122 ProvidersController::unbindPaasProvider() error while off-boarding paas. error message = update or delete on table "providers" violates foreign key constraint "subscribers_subscribedToTenantId_fkey" on table "subscribers",
                stack trace = Error: update or delete on table "providers" violates foreign key constraint "subscribers_subscribedToTenantId_fkey" on table "subscribers"
    at ProvidersRepository.<anonymous> (/home/vcap/app/src/providers/providers.repository.ts:89:19)
    at Generator.next (<anonymous>)
    at fulfilled (/home/vcap/app/src/providers/providers.repository.ts:17:58)
    at dynatraceOnServiceExecutionIndicator (/home/vcap/app/dynatrace/oneagent/agent/bin/1.235.200.20220314-114145/any/nodejs/nodejsagent.js:2916:20)
    at Object.a.safeInvoke (/home/vcap/app/dynatrace/oneagent/agent/bin/1.235.200.20220314-114145/any/nodejs/nodejsagent.js:2970:41) 

Fix:
the log from provisioning means that there are still active subscriptions to this provider service. In order to delete first the active subscriptions must be removed (unsubscribe).
There's a CIS API that can be used in order to list active subscriptions: ${saasRegistryCredentials.saas_registry_url}/saas-manager/v1/application/subscriptions
Please use the API to get the active subscriptions list and to delete the subscriptions  using 
<URL>/saas-manager/v1/application/tenants/<tenantId>/subscriptions
As described here - https://help.sap.com/docs/BTP/65de2977205c403bbc107264b8eccf4b/ed08c7dcb35d4082936c045e7d7b3ecd.html?q=saas-manager%2Fv1%2Fapplication%2Fsubscriptions
Please update us if there are active subscriptions or not

            11.6.1.2 related documentation

                11.6.1.2.1 Getting an Application Access Token
https://help.sap.com/docs/BTP/65de2977205c403bbc107264b8eccf4b/6391b5dfe4704c6c8b71a32126828e9c.html
a. cf env <APP_NAME>
b. "saas-registry": [
{
"credentials": {
"apiurl": "https://api.authenticat********avlab.ondemand.com",
"appName": "sample-saas-ap********-45",
"appUrls": "{\"getDependencies\":\"http**********.cf.stag**":0}",
"clientid": "sb-sample-saas-*********************-broker!b4",
"clientsecret": "riH*************0=",
"description": "Sample multitenant application",
"display_name": "Sample multitenant application",
"identityzone": "cfs******44",
"saas_registry_url": "https://saa********ab.ondemand.com",
"sburl": "https://internal-xsu********ndemand.com",
"subaccountid": "3358efc9-*********10b456",
"tenantid": "34584*******711",
"url": "https://cfs-3035-7**********avlab.ondemand.com",
"xsappname": "sample-saa******istry-broker!b4",
"zoneid": "34584*******f499711"
},
"instance_name": "saas-app-saas-registry",
"label": "saas-registry",
"name": "saas-app-saas-registry",
"plan": "application",
}
]

c.  Request
URI: <THE URL OBTAINED FROM THE BINDING OBJECT "URL" FIELD>/oauth/token

HTTP Method: POST

Request Headers

Header	Required	Values
Content-Type	Yes	<application/x-www-form-urlencoded>
Authorization	Yes	Basic <encodedString> where <encodedString> is the result of base64 encoding the OAuth client's values as clientId:clientSecret that you obtained from the binding object as described in the previous section.
For more information about the base64 encoding, see Base64Information published on non-SAP site

Request Parameters

Parameter	Required	Data Type	Description	Parameter Type
grant_type	Yes	String	The type of the authorization that is supported by the authorization server.
Set it to client_credentials.

Authorization protocol
client_id	Yes	String	The ID of the client associated with the SaaS Provisioning service instance.
Obtained from the service binding object. See the section Obtaining API Request Parameters of this document for details.

Relative URL path or JavaScript source code
Request Example (curl for Mac OS)

Sample Code
curl --location --request POST '<url>/oauth/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--header 'Authorization: Basic <base64.encoded(client_id:client_secret)>' \
--data-urlencode 'client_id=<client_id>' \
--data-urlencode 'grant_type=client_credentials'
Request Example (curl for Windows OS)

Sample Code
curl --location --request POST "<url>/oauth/token" ^
--header "Content-Type: application/x-www-form-urlencoded" ^
--header "Authorization: Basic <base64.encoded(client_id:client_secret)>" ^
--data-urlencode "client_id=<client_id>" ^
--data-urlencode "grant_type=client_credentials"
Response
Generates the access token for a multitenant application.

Content Type: JSON

Response Headers

Header	Values
Content-Type	<application/json;charset=UTF-8>
Response Status and Error Codes

Code	Description
200	Access token created successfully.
Response Properties

Property Name	Property Type	Description
access_token	JWT	Access token for the multitenant application.
This is the value for which you call the API

.
token_type	String	The type of access token issued.
expires_in	Number	The number of seconds until the access token expires.
scope	String	A space-delimited list of scopes that you authorized for the client.
jti	String	A globally unique identifier for JWT.

d. response example:
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8

{
    "access_token": "eyJ***mh0d…",
    "token_type": "bearer",
    "expires_in": 43199,
    "scope": "uaa.re***.subscription.read",
    "jti": "df6cb84439a541fab33d5b7c298debe1"
}

                11.6.1.2.2 Using SAP SaaS Provisioning Service APIs to Manage Multitenant Applications
a. Available APIs
Go to SAP API Business HubInformation published on SAP site get information about all the available APIs and their details.
https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fapi.sap.com%2Fapi%2FAPISaasManagerService%2Fresource

b.  Trying Out the APIs in Swagger
To try out the APIs, go to https://saas-manager.<app domain>.<landscape domain>/swagger-ui.html.

Example
If your account is running on the Europe (Frankfurt) region, use this URL:

https://saas-manager.cfapps.eu10.hana.ondemand.com/swagger-ui.html 

c. 
Overview
Base URI: <URL> you obtained from the binding object you created during the registration of your multitenant application to the SAP SaaS Provisioning service.

For more information, see the example of the binding object in the Getting an Application Access Token topic.

Method	URL	Name
GET	<URL>/saas-manager/v1/application	Get application details
POST	<URL>/saas-manager/v1/application/tenants/<tenantId>/subscriptions	Subscribe the tenant to an application
DELETE	<URL>/saas-manager/v1/application/tenants/<tenantId>/subscriptions	Unsubscribe the tenant from an application
GET	<URL>/saas-manager/v1/application/subscriptions	Get application subscriptions
PATCH	<URL>/saas-manager/v1/application/tenants/<tenantId>/subscriptions	Update subscription dependencies
GET	<URL>/api/v2.0/jobs/<jobId>	Get subscription job information
Note This API checks the status of the job created after one of the following APIs has been called: Subscribe the tenant to an application; Unsubscribe the tenant from an application; Update subscription dependencies ;
PATCH	<URL>/saas-manager/v1/applications/<appName>/subscription	Update subscription plan

                11.6.1.2.3
            11.6.1.3
        11.6.2

    11.7 Jira dashboards, tags: Jira dashboards

        11.7.1  team jira dashboard, , tags: team jira dashboard
https://jira.tools.sap/secure/Dashboard.jspa?selectPageId=97890

        11.7.2

    11.8 customer support FAQ, tags: customer support FAQ

        11.8.1   session timeout extension

            11.8.1.1   session timeout extension approval procedure
wiki: https://wiki.one.int.sap/wiki/display/CPPortals/Provided+custom+solutions

Customers with use case of Maintenance teams Dashboard only can request extend of timeout.
Dev Support, should ask the customers if they are using users based or session based, if Sessions based not supported at all and not relevant to ask approval for this. Close the ticket, we can not approve this use case.
Send mail to PM's Sasson, Iris + Zur, Itay .
PM will contact via ticket the customer to clarify on the use cases,
PM should approve only in use cases that customer license is based on users and not on "visits" (visits based licensing is planned).
In case it is approve PM should update the below table
PM set back to dev support with approval. Internal memo.
Dev support share the customer with guidance how to extend it:
Here is a wiki with the solution here: https://wiki.one.int.sap/wiki/x/31bYxg
Ticket completed.

            11.8.1.2

        11.8.2

    11.9 MENA customers, tags: MENA customers
Dev team in Israel must not handle these cases. If one reaches our queue send message to PS DL, DL Cloud Portal DS PS (External) <DL_59CCE7C55F99B7E5C700000B@global.corp.sap> :
"
Hi all, 
 
A MENA incident has reached our queue. Please move the incident back to the primary support.
Case CS20240008297392 / RE: BTP Inbox -  QA and Prod is in loading state / https://itsm.services.sap/now/cwf/agent/record/sn_customerservice_case/aec4f93183d49e90aaae90e0deaad385
Once doing so, please open an internal incident with all relevant information for investigation.
 
Best Regards, 
Yosi Izaq
BTP Core AP UE Portal (IL)
SAP Portals Israel Ltd.
" 
 
    11.10 Jira, SNOW, tickets, customers, issues processes and best practices, tags: Jira, SNOW, tickets, customers, issues processes and best practices

id=__Process_for_SNOW_tickets_that_were_closed_with_a_code_fix_tags__
        11.10.1  Process for SNOW tickets that were closed with a code fix, tags: Process for SNOW tickets that were closed with a code fix
https://wiki.one.int.sap/wiki/display/CPPortals/SNOW+tickets+closed+with+code+fix

            11.10.1.1  
        11.10.2




    11.11

12. Development

snapshot nexus: https://nexus.wdf.sap.corp:8443/nexus/#nexus-search;quick~portal-webide-deploy
release (look here for new artifacts from commit to master) nexus: https://nexusrel.wdf.sap.corp:8443/nexus/#nexus-search;quick~portal.platform.commons.cf
    12.1 Java, maven, maven dependencies

tlv java nexus: http://nexus.tlv.sap.corp:8082/nexus/#welcome
        12.1.1 dependencies
        

guide https://www.baeldung.com/maven-dependency-latest-version
            12.1.1.1 check if updates are required
mvn versions:display-dependency-updates

            12.1.1.2 update versions
usually best done manually.
However there is a CLI.
- Updating every non-SNAPSHOT dependency to its latest release works in the same way, simply changing the goal to versions:use-latest-releases:
mvn versions:use-latest-releases




        12.1.2

    12.2 Node modules repositories nexus, artifactory etc, tags: Node modules repositories nexus

        12.2.1 nexus

            12.2.1.1 dependencies
nexus node/python/docker/npm tlv server: http://nexus.tlv.sap.corp:8083/nexus/

Show latest version in nexus
[i500695@C02X632CJGH6:2020-05-20 10:48:53:~/work/SAP/git/portal-cf-transport-service:]2061$ npmshowLatestVer cdm-store-client
module cdm-store-client version

which basically wraps $npm show <package> version

        12.2.2 artifactory

        12.2.3 github get list of versions, tags: github get list of latest versions
example:
https://github.wdf.sap.corp/Portal-CF/cdm-store-client/releases
candi/7.9.0-20240215124010+ad9e786aa867e69655267f2232f0bd22b2804972
-> 7.9.0-20240215124010 in package.json

        12.2.4
    12.3

13. Load testing 

    13.1 load testing 101 

    You are going to participate in an infective  “load testing - do it yourself” course 😊
    https://github.wdf.sap.corp/pages/Portal-CF/cf-gatling/
    Prerequisites:
    Local environment: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Gatling+Automation+Environment – please do it ASAP, don’t wait till the last moment. Call @Eini, Niv , @Ben Simhon, Shlomi or @Kravchik, Alexander, we’ll assist 
    Optional: Send us a list of APIs that you want to cover with short explanation how can they be reached 
    
    You can use this doc to configure the environment https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/master/docs/prepare_environment.md
    Call us if it doesn’t work out of the box .
    
    verify java 1.8, mvn 3.6
|    [i500695@C02X632CJGH6:2020-05-20 17:01:32:~/work/SAP/code/python/transport:]2051$ echo $JAVA_HOME
|    /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home
|    [i500695@C02X632CJGH6:2020-05-20 17:01:33:~/work/SAP/code/python/transport:]2052$ /usr/libexec/java_home -V
|    Matching Java Virtual Machines (4):
|    13.0.1, x86_64:	"OpenJDK 13.0.1"	/Library/Java/JavaVirtualMachines/openjdk-13.0.1.jdk/Contents/Home
|    10.0.2, x86_64:	"Java SE 10.0.2"	/Library/Java/JavaVirtualMachines/jdk-10.0.2.jdk/Contents/Home
|    1.8.0_241, x86_64:	"Java SE 8"	/Library/Java/JavaVirtualMachines/jdk1.8.0_241.jdk/Contents/Home
|    1.8.0_232, x86_64:	"AdoptOpenJDK 8"	/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home
|
|    /Library/Java/JavaVirtualMachines/openjdk-13.0.1.jdk/Contents/Home
|    [i500695@C02X632CJGH6:2020-05-20 17:06:21:~/work/SAP/code/python/transport:]2053$ mvn -v
|    Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T18:06:16+03:00)
|    Maven home: /usr/local/Cellar/maven/3.6.2/libexec
|    Java version: 1.8.0_232, vendor: AdoptOpenJDK, runtime: /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre
|    Default locale: en_US, platform encoding: UTF-8
|    OS name: "mac os x", version: "10.15.4", arch: "x86_64", family: "mac"

intellij, cmd+, , plugins search & install scala and maven plugins

git clone git@github.wdf.sap.corp:Portal-CF/cf-gatling.git
cd cf-gatling/gatling
load the project to intellij

    13.2 load test basic course
git branch: ~/work/SAP/git/cf-gatling/gatling

        13.2.1 https://wiki.wdf.sap.corp/wiki/display/+/Gatling+Automation+Environment
also in notes

        13.2.2 https://github.wdf.sap.corp/Portal-CF/cf-gatling/blob/exercise1/gatling/README.md
also in notes

        13.2.3
    13.3

14. on call dev duty

    14.1 general

        14.1.1 daily checklist 
            14.1.1.1 dashboard https://dash.cfapps.sap.hana.ondemand.com/micro-services

                14.1.1.1.1 dashboard architecture, tags: Dashboard architecture
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Developers+Dashboard+Documentation

Git: https://github.wdf.sap.corp/FreD 

The application is a client-server application that is written with React on the client-side and Typescript + NestJS on the server-side.
The entire solution is deployed on the CF platform and can be found here. https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/9f030ea9-e233-4bde-b977-ab612bdabf4e/subaccount/651757dd-16a3-48db-a73a-eaee340fb18d/connectivity
The dashboard is also an approuter, which with its capabilities, is able to be a gateway to the different JaaS platforms.
For each JaaS platform, there's an On-Premise type destination to that platform, with a set Cloud Connector.
For example, the JaaS platform for the Runtime CI (https://portalcfruntime.jaas-gcp.cloud.sap.corp) has a destination that looks like this 
And it will have a matching Cloud Connector configured 
Note: This means that if a feature in the dashboard requires calls to a different JaaS than the ones already configured, a new destination and cloud connector should be created, and also a new endpoint in the approuters xs-app.json 

                    14.1.1.1.1.1 Main Backend Features
login-based
Accessing the dashboard requires registration and login.
cookie-based
The backend supports session cookies and will keep you signed in for a week. 
OAuth 2 based
The dashboard is based on the OAuth 2 protocol and is using JWT tokens for authenticating the requests to the server.
role-based
The dashboard is using different roles to authorize the requests. Meaning that not all requests are permitted to all users.
Persistency utilization 
The backend is persisting the users and the relations between the users and their teams and features. The persistency used is PostgreSQL with the TypeORM framework.

                    14.1.1.1.1.2 Main Front Features and Structure of the Dashboard
As an end-user
After you will finish the registration process and confirm your email address, you will be able to log in to the system.
After logging in, you will not see too much as no feature is yet assigned to you.
In order to fix that, you should navigate to the User Settings section via the menu (You will not see all of the entries in the menu as you see in the screenshot below, that is ok).
User Settings


In that section you'll be able to do several important things:
Fill in your details (name and last name)
Auto assign new features - a toggle that is used to indicate that you want new features to be automatically assigned to you, according to the teams you belong to. Checking this off will NOT add features to you and you will need to assign them manually
Roles - a view only checkbox that shows you what roles you hold. You should see only the User role assigned to you.
Teams - a list of checkboxes that allows you to choose what teams you belong to. If you don't see your team, contact an administrator. 
Save Teams button - save the teams that you've checked 
Assign Teams Features - relevant only if you did not check the 'Auto assign new features' checkbox. This will assign any missing features from your teams to the list of your features.
Once you finished configuring your settings, you can move on to the next section.
Features Assignment
In case you did not choose the 'Auto assign new features' check box in the User Settings section, you can choose to assign different features to your dashboard.
From the menu, choose 'Feature Assignment', which should be below to the User Settings entry:


The Tabs at the top of the screen indicate what kind of features you want to add to yourself. As of writing this documentation, there are 6 features available and there might be more in the future, according to the developers needs.
Below the tabs, you can see the list of teams available to assign features. You can assign features to yourself from every team, but you will only be able to see them once you add that team to your teams list in the User Settings.
You can select multiple teams, and all the features of these teams will be available in the 'Available' section.
To assign features to yourself, you can simply drag the features from the Available section to the Assigned to Me section, and vice versa. And that's it! 
Once you've assigned some features to yourself, you should be able to see new entries popping up in your menu, according to what you've assigned to yourself.
List of features
Tests
The tests section will appear after you've assigned yourself the CF Test features. This allows you to view the statuses of the E2E Automation jobs.

Test jobs can be searched via the search options and can also be toggled by team and space via the filter icon on the top right corner.
Note: You should make sure that your job is located in the official E2E JaaS and not in others.
Microservices
The microservices section will appear after you've assigned yourself the CF Micro Service features. This allows you to view the statuses of the CI jobs of the various microservices that your team owns.

CI jobs can be searched via the search options and can also be toggled by team and space via the filter icon on the top right corner.
Note: You should make sure that your CI Job is located in one of the 4 CI JaaS: Runtime, Design time, Static or Common
Security Scans
The security scans will show you the list of security jobs statuses. This is probably more relevant to the Security Angels of your team.

Security jobs can be searched via the search options and can also be toggled by a team via the filter icon on the top right corner.
Note: You should make sure that your security job is located in the security jobs JaaS.
Performance Tests
The performance tests will show you the list of performance jobs statuses. This is probably more relevant to the Performance Engineers of your team.
Performance jobs can be searched via the search options and can also be toggled by a team via the filter icon on the top right corner.
Note: You should make sure that your performance job is located in the Performance JaaS.
Neo Tests
Similar to the CF Tests, this section will present the relevant Neo Test jobs statuses.


Neo test jobs can be searched via the search options and can also be toggled by a team via the filter icon on the top right corner.
Note: You should make sure that your jobs are located in the Neo JaaS.
JAM DC Mapping
This section allows you to see the mapping between the portal and jam data centers and the statuses of the subscription in every data center.

You can watch the statuses in Canary and Production environments and also filter the requests via a time frame.
The default is the statuses of subscriptions in the past week. You can inspect the statuses up to a year back.
As an Administrator
The administrator privileges are given to the teams' Scrum Masters, or, if they choose, to a dedicated developer of the team. To be able to become an administrator, please contact one of the dashboards creators (as of the day this documentation is written, contact Kozel, Reuven )
The administrator has several capabilities
Create a feature
In the menu, you can choose the Create Features entry

This will allow you to create new features in the dashboard, that can be available to everyone.
You can choose the Feature Type (as can be seen in the screenshot below), the jenkins URL (if there are several JaaS available for that feature) and the feature name.

Notice that the feature name must be identical to the job you want to track.
Once you chose the feature you want to create, you need to choose to what teams this feature belongs to. Select as many teams you want and click Send.
This will immediately add the feature to all members of the teams you've chosen if the Auto-assign new features capability is toggled on in the User Settings, or will be available to assignment in the Feature Assignment section.
Delete a Feature
Everything that is created must have a way to also be deleted. Therefore there's an option to delete a certain feature from the dashboard

At the top of the screen, you'll see the tabs that represent the available features. On each tab, you will see the list of features that were created with some metadata for each of them.
If you wish to delete the feature, simply click the delete button. This will remove the feature and will erase it from all the team members that have it.
Dashboard Settings
CAUTION: THIS SECTION SHOULD BE ACCESSED ONLY BY SOMEONE THAT KNOWS WHAT HE'S DOING

Administrators can also change the settings of the dashboard that will affect all the users.
It holds mainly the metadata for the dashboard, such as the URLs to the different JaaS platforms, the names of the destinations in the cockpit, and the list of available teams and features.
If you're sure about changing the settings, you can choose 'Edit' at the bottom of the screen and edit the settings.

                    14.1.1.1.1.3 links 
Dashboard cockpit - https://cockpit.sap.hana.ondemand.com/cockpit/#/globalaccount/9f030ea9-e233-4bde-b977-ab612bdabf4e/subaccount/651757dd-16a3-48db-a73a-eaee340fb18d/connectivity
FreD Github - https://github.wdf.sap.corp/FreD
Dashboard Link - https://dash.cfapps.sap.hana.ondemand.com/
                        
                    14.1.1.1.1.4
                14.1.1.1.2

            14.1.1.2 bcp
https://support.wdf.sap.corp/sap(bD1lbiZjPTAwMSZkPW1pbiZpPTE=)/crm_logon/default.htm?saprole=ZCSSNEXTPROC, filter bcp_yosi_team
components: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?spaceKey=CPPortals&title=BCP+Components+-+Oct+2021

            14.1.1.3 SNOW
https://itsm.services.sap/now/workspace/agent/list/params/list-id/679f49c91b80b0d45b1fdcef9b4bcbac/tiny/b8221335db90c5905d7ea39bd3961912
my-lists:
Yosi team components, just open (new, in-progress) tickets
Yosi team tickets all states, all tickets, even closed
            14.1.1.4
        14.1.2 check note "Weekend CF duty"
Wiki: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=1926596640

Slack: #prtl-cp-weekend-duty


    14.2 KT wikis 
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Transport%2C+Export+and+Import+Troubleshooting+Guide


    14.3

15. Tools

    15.1 Loggy
Its a tool I wrote in python...
[i500695@C02X632CJGH6:2020-11-29 09:56:15:~:]2000$ cdloggy 
[i500695@C02X632CJGH6:2020-11-29 16:28:46:~/work/SAP/CF_LocAL/myDev_Tools/dev-tools/loggy:]2001$ cat ../README.md 
# loggy - parse and pretty print CF logs

##Description
* Makes CF json format logs mure readable.
* highlights correlation IDs
* color code error and warning logs
* contact: yosi.izaq@sap.com

        15.1.1 loggy git repo 
        old: https://github.wdf.sap.corp/i500695/loggy
        new: https://github.wdf.sap.corp/portal-cf-yosi-devs/loggy
created organization for managing team members and permissions. https://github.wdf.sap.corp/orgs/portal-cf-yosi-devs/people

        15.1.2 installation

            15.1.2.1  using venv


[i500695@WYLQRXL9LQ:2024-08-26 12:04:20:~/git/loggy:]2040$ pyvenv_c loggy
Virtual environment 'loggy' created successfully.
[i500695@WYLQRXL9LQ:2024-08-26 12:04:35:~/git/loggy:]2041$ pyvenv_a loggy
Virtual environment 'loggy' activated.
(loggy) [i500695@WYLQRXL9LQ:2024-08-26 12:04:38:~/git/loggy:]2042$ pip install git+https://github.wdf.sap.corp/i500695/loggy.git
Collecting git+https://github.wdf.sap.corp/i500695/loggy.git
  Cloning https://github.wdf.sap.corp/i500695/loggy.git to /private/var/folders/nh/6_j60qg10y99tdxvfwp5y9gh0000gn/T/pip-req-build-4_xqjghd
  Running command git clone --filter=blob:none --quiet https://github.wdf.sap.corp/i500695/loggy.git /private/var/folders/nh/6_j60qg10y99tdxvfwp5y9gh0000gn/T/pip-req-build-4_xqjghd
  Resolved https://github.wdf.sap.corp/i500695/loggy.git to commit 21d661cf860ffe321896b702d26acb27203d0de2
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Collecting colorama (from loggy==1.6)
  Using cached colorama-0.4.6-py2.py3-none-any.whl.metadata (17 kB)
Using cached colorama-0.4.6-py2.py3-none-any.whl (25 kB)
Building wheels for collected packages: loggy
  Building wheel for loggy (pyproject.toml) ... done
  Created wheel for loggy: filename=loggy-1.6-py3-none-any.whl size=17251 sha256=c9d3ff9697c39676299eeae08e94ed96cc37b7de93dcfe0074b269e9c88c1210
  Stored in directory: /private/var/folders/nh/6_j60qg10y99tdxvfwp5y9gh0000gn/T/pip-ephem-wheel-cache-c4sfi2qs/wheels/83/66/b1/1a954d85c7b8ce438383fc8bcf26f60a6373f411b8171333ef
Successfully built loggy
Installing collected packages: colorama, loggy
Successfully installed colorama-0.4.6 loggy-1.6

[notice] A new release of pip is available: 24.0 -> 24.2
[notice] To update, run: pip install --upgrade pip
(loggy) [i500695@WYLQRXL9LQ:2024-08-26 12:04:57:~/git/loggy:]2043$ loggy
Retrieving logs for app portal-cf-site-semantic-service in org SAP_PORTAL_SERVICES / space Portal as yosi.izaq@sap.com...



App 'portal-cf-site-semantic-service' not found.
FAILED



            15.1.2.2 Installation
First install python if you don't have it installed already.
For mac+python3 do:
```bash
$ brew install python3
$ brew postinstall python3
```

For python2 (soon to be depracted):
```bash
$sudo easy\_install pip
```

use pip or pip3 (for python 2 or 3). Ex:
```bash
pip install git+https://github.wdf.sap.corp/i500695/loggy.git
pip3 install git+https://github.wdf.sap.corp/i500695/loggy.git

Can also zip the repo and then install
~/work/SAP/CF_LocAL/myDev_Tools:]2017$ zip -r loggy.zip dev-tools/

     unzip loggy.zip

    cd dev-tools/

    pip3 install .


        15.1.2 Common issues

            15.1.2.1 No module named loggy
$ loggyTransport 
/opt/local/bin/python3: No module named loggy

Check where loggy is installed.
$ pip3 install git+https://github.wdf.sap.corp/i500695/loggy.git
Collecting git+https://github.wdf.sap.corp/i500695/loggy.git
  Cloning https://github.wdf.sap.corp/i500695/loggy.git to /private/var/folders/k4/zgbbn6ms2xv0d_4g85qw60vc0000gn/T/pip-req-build-m1p0p5ve
Requirement already satisfied (use --upgrade to upgrade): loggy==0.90 from git+https://github.wdf.sap.corp/i500695/loggy.git in /usr/local/lib/python3.9/site-packages
Requirement already satisfied: colorama in /usr/local/lib/python3.9/site-packages (from loggy==0.90) (0.4.4)
Building wheels for collected packages: loggy
  Building wheel for loggy (setup.py) ... done
  Created wheel for loggy: filename=loggy-0.90-py3-none-any.whl size=16047 sha256=ef403f1aada48a3afeaa78d280fcdb71121f0c826f82671f4cf0f48a5fe03000
  Stored in directory: /private/var/folders/k4/zgbbn6ms2xv0d_4g85qw60vc0000gn/T/pip-ephem-wheel-cache-jebpnpbv/wheels/c6/fd/c6/0cc828f08ebd890baed0bee8c36a9816f31ee93efacb08f712
Successfully built loggy

So, /usr/local/lib/python3.9/site-packages, 
Which python version is used?-
 ls -l /opt/local/bin/python3
lrwxr-xr-x  1 root  wheel    24B Nov 22 16:15 /opt/local/bin/python3@ -> /opt/local/bin/python3.8

relink to 3.9...
[i500695@C02X632CJGH6:2020-11-29 16:31:59:~/temp/temp1:]2006$ sudo unlink /opt/local/bin/python3
Password:
[i500695@C02X632CJGH6:2020-11-29 16:32:08:~/temp/temp1:]2007$ sudo ln -s /opt/local/bin/python3.9 /opt/local/bin/python3
[i500695@C02X632CJGH6:2020-11-29 16:32:26:~/temp/temp1:]2008$ ls -l /opt/local/bin/python3
lrwxr-xr-x  1 root  wheel    24B Nov 29 16:32 /opt/local/bin/python3@ -> /opt/local/bin/python3.9

            15.1.2.2  structure
main:
loggy/bin/loggy.py

            15.1.2.3
        15.1.3 test
from loggy dir run:
$ pytest .
```bash
$ pytest .
============================================================================ test session starts ============================================================================
platform darwin -- Python 3.7.5, pytest-5.0.1, py-1.8.0, pluggy-0.12.0
rootdir: /Users/i500695/work/SAP/CF_LocAL/myDev_Tools/dev-tools
collected 10 items                                                                                                                                                          

tests/test_CmdLine.py .                                                                                                                                               [ 10%]
tests/test_LogsFilter.py .                                                                                                                                            [ 20%]
tests/test_colors.py ...                                                                                                                                              [ 50%]
tests/test_config.py .                                                                                                                                                [ 60%]
tests/test_logParser.py ....                                                                                                                                          [100%]


        15.1.4 backlog

- print no json lines (like loading errors)

- another feature is to add filter by "level". I miss it a lot.
I want to set "loggy -a portal-cf-site-semantic-service -l error" and to run my flow and check if on some step I have issue

- b'string
convert binary to string 

- I have an idea to highlight the key “msg” with bold or with some color. MSG is the most important message in the log and it’s very difficult to find it in the long string

- In this log I have an exception from CDM Store and after that CDM Store responded status 204
Loggy doesn’t show me this info: no exception and no status 204 in loggy.

input:
~/work/SAP/CF_LocAL/myDev_Tools/dev-tools:]2038$ ls loggy/sample_logs/204_status.log 
loggy/sample_logs/204_status.log

- like you do "loggy -a portal-cf-site-semantic-service -level ERROR" and I will see only errors
    so if y filter WARN level u get warn + error

- bump version up

        15.1.5 

    15.2 https://github.wdf.sap.corp/portal-cf-yosi-devs/cf_cli_automations

        15.2.1 orphand resources cleanups
/Users/i500695/work/SAP/CF/cleanups/orphand_resources
https://github.wdf.sap.corp/portal-cf-yosi-devs/cf_cli_automations.git

    15.2.2 auto shutdown start all apps in space, Shutdown all applications on developers' provider spaces every night, tags: shutdown, start, automatic, applications, apps, space, developer

        15.2.2.1 my script

        15.2.2.2 tigran script
We also prepared a failback bash script to support space startup. https://github.wdf.sap.corp/Portal-CF/ci-tools-jjb/blob/master/resources/failback-scripts/bash/startup_apps.sh 
You can use this script whenever our startup job is not functioning as expected or unexpected errors appear in the JaaS server. https://portalcfdevelopers.jaas-gcp.cloud.sap.corp/view/DEVELOPER-CORNER-JJB/job/jjb-startup-space-apps-dc/

script code:
#!/bin/bash

declare -a stopped_list=()
declare -a exclude_list=("content-repository-deployer-blue" "content-repository-deployer-green"
"definition-deployer-blue" "definition-deployer-green" "portal-cf-static-resources-deployer"
"portal-cf-freestyle-ootb-templates" "portal-cf-freestyle-static-resources")

cf_login() {
  if cf t >/dev/null 2>&1 ; then
    echo "Already logged in"
  else
    echo "Input param API:     {$1}"
    echo "Input param USER:    {$2}"
    echo "Input param ORG:     {$4}"
    echo "Input param SPACE:   {$5}"

    cf api "$1"
    # set a timeout so that if the user\password is incorrect, then the script won't hang forever
    timeout 120s cf auth --origin uaa "$2" "$3" > /dev/null || timeout 120s cf login -a "$1" -u "$2" -p "$3" -o "$4" -s "$5"
    if [ $? -eq 124 ]; then
      echo "Timeout occur for cf login, check user and password"
      exit 1
    fi
    cf t -o "$4" > /dev/null || echo "Cannot find org" "$4"
    cf t -s "$5" > /dev/null || echo "Cannot find space" "$5"
  fi
}

cf_get_stopped_apps(){
  echo "INFO: ---> calculating stopped apps to process..."

  # retrieve only stopped apps
  stopped=("$(cf apps | awk '{if ($2 == "stopped") print $1}')")

  echo "DEBUG: ---> stopped apps in the space:"
  printf '%s\n' "${stopped[@]}"
  echo "DEBUG: ---> apps to skipp (default deployer's and provided custom apps):"
  printf '%s\n' "${exclude_list[@]}"

  # remove exclude apps list from stopped apps list
  stopped_list=("${stopped[@]}")
  for ele in "${exclude_list[@]}"; do stopped_list=(${stopped_list[@]/*${ele}*/}); done

  echo "DEBUG: ---> stopped apps to process:"
  printf '%s\n' "${stopped_list[@]}"
}

cf_start_apps(){
  if [ -z "${stopped_list[*]}" ]; then
    echo "INFO: ---> nothing todo, did not find stopped apps to process."
  else
    echo "INFO: ---> starting apps, this can take some time, please wait..."
    for app in "${stopped_list[@]}"; do
      cf start "$app" || continue
    done
  fi
}

# constants
help_msg="
Usage:	./startup_apps.sh --api <CF target API> --user <CF user> --pass <CF password>  --org <CF organization> --space <CF space> --exclude <optional: apps to exclude App1,App2,App3...>
Options:
      --api        (string)  Mandatory: CF target API.
      --user       (string)  Mandatory: CF user.
      --pass       (string)  Mandatory: CF password.
      --org        (string)  Mandatory: CF organization.
      --space      (string)  Mandatory: CF space.
      --exclude    (string)  Optional:  apps to exclude separated by ',' without space in between (they will remain stopped).
"

if [[ $# -eq 0 ]]
  then
    echo "INFO: ---> no arguments supplied!"
    echo "$help_msg"
    exit 1
fi

while [[ "$#" -gt 0 ]]
do
  case $1 in
    --api)
      api="$2"
      ;;
    --user)
      user="$2"
      ;;
    --pass)
      pass="$2"
      ;;
    --org)
      org="$2"
      ;;
    --space)
      space="$2"
      ;;
    --exclude)
      exclude="$2"
      if [[ -z "$exclude" ]]; then
        echo "INFO: ---> no custom exclude apps provided."
      else
        ORIG_IFS=$IFS
        IFS=',' # set as delimiter
        read -ra ADDR <<< "$exclude" # str is read into an array as tokens separated by IFS (Internal Field Separator)
        for i in "${ADDR[@]}"; do # access each element of array
         exclude_list+=("$i")
        done
        IFS=$ORIG_IFS # restore original IFS
      fi
      ;;
    --help)
      echo "$help_msg"
      exit 1
      ;;
  esac
  shift
done

#input validation
if [[ -z "$api" || -z "$user" || -z "$pass" || -z "$org" || -z "$space" ]]; then
    echo "ERROR: ---> missing CF connection parameters!"
    echo "$help_msg"
    exit 1
fi

cf_login "$api" "$user" "$pass" "$org" "$space"

cf_get_stopped_apps "$exclude"

cf_start_apps


        15.2.2.3 yaniv-peeri update
Update regarding the job to startup apps in your spaces –
We changed the location of the job in the developers JaaS,
Now you can find the job under this view: STARTUP-APPS-JJB
 
Here is a link to the job:
https://portalcfdevelopers.jaas-gcp.cloud.sap.corp/view/STARTUP-APPS-JJB/job/jjb-startup-space-apps-ssa/
 
The job configuration is the same (need to provide API, SPACE and ORG).
        15.2.2.4
    15.3

16. Automation tests

    16.1 Puppeteer
https://github.wdf.sap.corp/Portal-CF/portal-cf-fs-automation/blob/master/ui-tests/README.MD

        16.1.1 readme
E2E Tests Jenkins

The JaaS with all the E2E Automation jobs can be seen here:
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/

Menu

Create a test suit job and add it to the e2e Jenkins
Create a test suit job and add it to the e2e Jenkins

To meet the standards of the group we build & run test suits on e2e Jenkins environment.

To ease the creation of the jobs that run this suits, we made an automatic mechanism we'll introduce below.

These jobs are running a given JenkinsFile that include the test suits, you would like to run, for more details on JenkinsFile. In addition, these jobs are include a build-in parameters, also allow custom parameters.

Step 1: Edit end2endSeed file

Edit this piece of code, and fit to your needs:
// Start create <Job name>-TEST job
//----------------------------------------------------------------------------------------------------------------------
ScmPipelineJob <job-variable-name> = new ScmPipelineJob(
              [
                      wsRootPath      : wsRootPath,               //*No change required, Jenkins workplace
                      jaasInstanceName: jaasInstanceName,         //*No change required, Jenkins name
                      dslFactory      : this as DslFactory,       //*No change required
                      jobFolder       : jobFolder,                //*No change required, job folder on Jenkins
                      jobName         : '<Job name>',             //*Job name, the convention of the job name is uppercase with {test type}-TEST suffix. 
                      jobTestSuffix   : testSuffix,               //*No change required, job suffix. Created automatically by the process branch.
                      jobDescription  : "<Job description>",      //*Job description
                      gitBranch       : "${PROCESS_BRANCH}",      //*No change required, config by the Jenkins environment. 
                      gitRepository   : "<Repository name>",      //*The git repository name where the test suit (meaning the JenkinsFile) is placed.
                      jobScriptPath   : "<Job JenkinsFile path>", //*Full path of the test suit (meaning the JenkinsFile) is placed in git repository.
              ]
)

//* The base E2E schema include a common recommends test suit parameters, therefore you shouldn't determine your job parameters from scratch.
//* We will explain how to add customs parameters in the next chapters. 
//* The base parameter schema is locate in the ci-tools repository.  
<job-variable-name>.setBaseParamsSchema("/resources/parameters/baseE2ETestSchema.yaml")

//* This method will build the job and attach it to the jenkins and the folder we configure above. 
<job-variable-name>.build()
Step 2: Override/add job parameters

As we mention above, we set in advance common parameters using the base parameter schema.

If you want to override the default parameters values.
If you need extra parameters that not include in the base schema.
You can easily do it by the mechanism below:

Create a YAML file, according to the following guidelines:

The name of the file must be the same as the jobName with .yaml suffix.
The file must be located in the following path:
/resources/parameters/end2endTestJobs/<Job Name>.yaml    
YAML file content:

Start the file with:

---
params:
Add parameter element, according to your needs:

- name: "<parameter-name>"
  value: "<default value>"
  description: "<description>"
  className: <className>
parameter-name: This name will display at the build page.

default value: Could be a string or list, depending on the className of the parameter.

description: This description will display at the build page, HTML tags are allowed.

className: Determine the type of the input

supportedParams:
 - string        : Regular string
 - hidden        : The paramter will be unchangeable and hidden from the user.
 - boolean       : Checkbox
 - text          : Regular text, bigger text area comparing to string type
 - choice        : Defines a parameter that dynamically generates a list of value options and that dynamically.
 - choiceReactive: Defines a parameter that dynamically generates a list of value options and that dynamically,
                       updates when the value of other job UI controls change.
 - password      : password string                
type: extend the abilities of className to determine the input. This filed is supported for 'choice' and 'choiceReactive' className only.

The accepted value is one of the following options: "SINGLE_SELECT", "MULTI_SELECT", "CHECKBOX", "RADIO"

Step 3: Add optional features

- Add schedule job triggering:

Should be added after build() method:

<job-variable-name>.addParameterizedCronJobTrigger('<cron schedule expressions>') 
<job-variable-name>.enableTriggers()
Cron schedule expressions:

For example: H */6 * * * expression trigger the job every 6 hours. For more details about cron schedule expressions.

- Add jobs view aggregation:

If you have a several jobs in the same folder on Jenkins. You can create your own view tab and determine which jobs will display there.

Since you can't add jobs that not exist yet, to views. You have to add the view aggregation code block after the creation on the ScmPipelineJob elements, meaning adding the view block to the end of the end2endSeed.groovy file.

Edit this piece of code, and fit to your needs:

 // create view
 ContextListView testView = new ContextListView(
         [
                 viewDslFactory : this as DslFactory,
                 viewName       : "<view-name>",         //*The name of the view tab
                 viewDescription: "<view-description>",  //*The description of the view tab
                 jobFolder      : jobFolder,             //*No change required, job folder on Jenkins
                 jobTestSuffix  : testSuffix             //*No change required, job suffix. Created automatically by the process branch.
         ]
 )
 
 //Option 1: Add jobs to view by explicit name
 testView.setJobsToAdd(["<job-name-1>", "<job-name-2>"] as String[])

 //Option 2: Add jobs to view by regular expression
 testView.setJobsToAddRegex(/<regular-expression>/)
Option 1: Add jobs to view by explicit name

Option 2: Add jobs to view by regular expression

For example: /LTS.+/ expression will include all the jobs that has the prefix 'LTS'. For more details about regular expressions.

Step 4: Create a dev branch in ci-tools repository. https://github.wdf.sap.corp/Portal-CF/ci-tools
add <job name>.yaml file w/ ur specific parameters override base parameter yaml

Step 5: Push your piece of code to end2endSeed.groovy file.

Step 6: Push your parameters file to end2endTestJobs folder.

Step 7: Check your job in e2e Jenkins:

Build end2endReactor with parameters. The PROCESS_BRANCH should be your dev branch you create in the first guideline above.
Jenkins will create a end2endTestJobs-<PROCESS_BRANCH> folder with your test job.**
Step 8: Create PR on ci-tools repository

        16.1.2


    16.2


17. yosi team management tags: yosi team management, syncs, Scrum-of-scrums, PO, manager

    17.0 team
saar - I060224
        17.0.1 tags: team members, iusers, team members emails
Devs:
hadar: I055502
Gil: I349433
Jawad: I324180
Shirly: I310019
Yoav: I562394 
Kalman: I540352
Alon: I585770
Nataliya Stalmakhova: C5382964 

PO: bussi

Scm: Yosi: I500695

I500695, I055502, I324180,I521258, I310019, I349433,I562394, I059143

Manshari, Alon <alon.manshari@sap.com>; Shikva, Gil <gil.shikva@sap.com>; Kobi, Hadar <hadar.kobi@sap.com>; Margieh, Jawad <jawad.margieh@sap.com>; Labinsky, Kalman <kalman.labinsky@sap.com>; Cohen, Shirly <shirly.cohen@sap.com>; Fried, Yoav <yoav.fried@sap.com>; Izaq, Yosi <yosi.izaq@sap.com>

space1: hadar
space2: shirly
space3: alon
space4: gil
space5: jawad
space6: yoav
space7: kalman

architects:
Tsafrir-Sklarski i034326

        17.0.2 New employee
I-User Details
First Name: Alon
Last Name: Manshari
Private Email: alonman17@gmail.com
Worker ID #I585770
Effective Start Date: February 27th, 2023
 
Office Location
Site: SAP Labs Israel Ltd. (0091) (9101)
Address: 14 Eli Hurvitz St., Ra’anana 4366214, Israel
Workplace: Floor #3, Room #334

        17.0.3 Past employees
Sheli Kahan: I059143
Adam: I521258

        17.0.4 Team 1:1 meetings, tags: Team 1:1 meetings

            17.0.4.1  November 23-30 meetings, tags: November 23-30 meetings

                17.0.4.1.1  Hadar-Kobi
Hadar points:
- Since I have returned from maternity leave team atmosphere is not good
- I feel like I need help with "outside" requests
- Dynamics w/ Alon-Manshari is not good
I feel like he is like Tomer
- I feel like I don't get enough credit from things I did (By Alon, in general)

Yosi observations:
- Hadar since return seems to be un-content. Drama seems to follow her.
- She made a big fuss about her space issue
- About not getting a full BLI that she can complete and take credit for
- When I gave her one: subaccount activation I'm observing unprofessional behavior. 
Like her work is conditional on her mood. For example:
On Wednesday Adam discussed with her that he wants to do perf tests
She mentioned in Daily that Adam is getting involved in the BLI
In further discussions with her she commented that she is demotivated and stops working on the BLI
Or when I asked her to provide HLEE on an addition to the BLI she answered NO. I discussed with her but to no avail. She refused to address the requirement and provide EE.
on Sunday, she sent a msg implying she considers not cont. on this BLI. I replied to her. Called her but she didn't answer. Asked her to call me. nothing :(

- I also observe that She is creating a toxic atmosphere in the team and demoralizing other team members. I'm worried that her attitude would be contagious


                17.0.4.1.2 Gil-Shikva
- team atmosphere is not good because of WFH mode. It's harder  to get a sense of team
- You as ScM are approachable and available to the team 
- Maybe team members can help me with meetings load 
- Would like team to come to office two days a week

                17.0.4.1.3 Shirly-Cohen
- Concerned - who will substitute for Shani-Shorer??
- Also perceives Alon as similar to Tomer, but he's not the same


                17.0.4.1.4 Alon-Manshari 
- Work on agents design was frustrating. Lacked ownership. Led to not fully complete design
- Aspired to become an architect

                17.0.4.1.5 Yoav-Fried 
- Team atmosphere is great. I feel free to talk with everyone. I consider this to be the best aspect of working at SAP
- Dev duty switch every week is problematic 

                17.0.4.1.6 jawad-margieh
- Many context switches b/c of support
- Yet again, asking me to do dev support. Substitute when dev duty is sick or unavailable
- Raises attention to the fact that Yoav seems to be getting stuck w/ his missions. Esp. in CDM-store. If this persists, Suggest maybe move team would do him good
- I manage external pressure on my own

Yosi observations: 
Jawad is very self confident and feels more freedom to speak his mind
Jawad dislikes dev duty very much and this is a main source of malcontent for him

                17.0.4.1.7 Kalman-Labinsky 
OOO - reserves
                17.0.4.1.8
            17.0.4.2

        17.0.5
    17.1 team resources

        17.1.1 capacity tags: capacity
Jawad - 60-80% team, 20-40% architecture
Gil - 100% 
Hadar - 100% 
Yoav - student, doesn't count in capacity
Kalman - 100%, starts 09/2022 , start at 0.5 factor
Shirly - 100%, returns 09/2022, start at 0 factor  

Adam -  80%, 20% security lead, leat team on 09/2022
Sheli - left team mid 2022, student, doesn't count in capacity, Doesn't work Sundays.

capacity: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2022+T01
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2021+T11
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2021+T12
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team+2021+T13

        17.1.2 takt timeliness, tags: takt timeliness, CF timeline QPA toolbox
https://qpayrfr8dh9z4.int.sap.eu2.hana.ondemand.com/com.sap.hcp.cf.qpa/timeline/table?year=2022
        2022: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2650054655
        2021: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2310869504

        17.1.3 duty Roster
        https://wiki.wdf.sap.corp/wiki/pages/resumedraft.action?draftId=2656678278&draftShareId=6c75acf4-71f9-453b-9cdb-908b51690dce&

        17.1.4 RCA wikis

            17.1.4.1 RCA examples
check /Users/i500695/work/SAP/documents/templates/RCA
ex:
[NEO] Out of Memory

Incident and Problem Report
Root Cause Analysis (RCA) and Preventive Actions

Outage Action Log
•	On December 16th , 2021 at 16:45 UTC, the 3rd and last instance of Portal RT app on US3 datacenter crashed with “Started (Disabled) and the Portal service become unavailable and AVS alert was sent.
•	At 17:15 UTC Portal operations team restarted all 3 instances
•	At 17:25 UTC Portal service become available again.
Impact
•	Customers of portal service were not able to reach their runtime site environments
•	No customer tickets were opened
Root Cause Analysis
o	The personalization 80 users in specific site reached size of 400MB each.
o	This was caused by combination of 2 issues –
    -Portal - Admin user created an application with a very long title (33000 chars) – there is no limitation on title size
    -FLP Runtime UI - Recent Activities functionality saved this title inside the personalization which is stored inside of Portal database. – There is no option to modify this activity in case of an app name change OR a deletion of an app.
Corrective Measures
•	Operations team restarted the instances.
•	Customer has been contacted to get his approval for delete all corrupted personalizations.

Next Steps / Continuous Improvements
•	Portal- Limit the title size on client
•	FLP Runtime UI- fix bug https://support.wdf.sap.corp/sap/support/message/2180416874
•	Portal- should we limit also in server side?
•	Portal- should we provide the admin the option to delete all users’ personalization

            17.1.4.2 team RCA wiki
https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+team+RCAs

            17.1.4.3

        17.1.5 Team kanban board , tags: Team kanban board 
https://jira.tools.sap/secure/RapidBoard.jspa?rapidView=8499&view=detail&selectedIssue=EUXTEAMSAAR-3201

        17.1.6
    17.2 Recruitment
student position external posting example : https://jobs.sap.com/job/Ra&apos;anana-Software-Developer-%28Student%29-SAP-BTP-Portal-Services-4366202/865191401/
requirements document: https://jobs.sap.com/job/Ra&apos;anana-Software-Developer-%28Student%29-SAP-BTP-Portal-Services-4366202/865191401/


        17.2.1 interviewing candidates
Each Scrum Master will choose if the interview will be remotely or at the office. Most of us agreed that the technical interview can be remotely and that the further interview at the office.
Each Scrum master will choose the technical test that fits him.
A new folder for recruiting will be created in the Scrum masters’ group in Teams. This folder will include:
All the technical exams we have  @Shany Shefer
A table of the students that were invited by each Scrum master - @Avrahami, Olga
Before inviting a student for an interview please check the list, ensure that he is not there, update the list.
If there are good candidates that were interviewed for the same team and can be relevant for the other teams, please update

        17.2.2 New employee resources
new employee wiki: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2736525727



        17.2.3 Support Engineer's onboarding
https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=3005166340
        17.2.4 New team engineer member onboarding process, tags: New team engineer member onboarding process

            17.2.4.1 overall procedure

            17.2.4.2 resources

            17.2.4.3 roadmap

            17.2.4.4

        17.2.5
    17.3 Git

        17.3.1 git teams
    https://github.wdf.sap.corp/orgs/Portal-CF/teams/programmers
    https://github.wdf.sap.corp/orgs/Portal-CF/teams/portals_team_saar/members
    Ask membership via cap profile request ( https://wiki.wdf.sap.corp/wiki/display/CPPortals/CAM+-+Profiles )
    ask for profile BTP Portals Git Team Yosi PROD 
    Old profile: BTP Portals Git Team SaaR PROD 


        17.3.2 CODEOWNERS 
-> by team
[i500695@WYLQRXL9LQ:2022-04-28 12:05:30:~/git/portal-cf-design-time-service:]2169$ cat CODEOWNERS 
# Lines starting with '#' are comments.
# Each line is a file pattern followed by one or more owners,
# the last matching pattern has the most precendence.

# default reviewers on all files
* @Portal-CF/portals_team_saar

# DevOps files
Jenkinsfile* @Portal-CF/Portals_Team_Devops
.pipeline/* @Portal-CF/Portals_Team_Devops
.deployment/* @Portal-CF/Portals_Team_Devops
-> By iuser 
[i500695@WYLQRXL9LQ:2022-04-28 12:04:49:~/git/portal-cf-transport-service:]2013$ cat !$
cat CODEOWNERS
# Lines starting with '#' are comments.
# Each line is a file pattern followed by one or more owners,
# the last matching pattern has the most precendence.

# Transport Service - team members reviewers
* @I310019 @I324180 @I349433 @I055502 @I059143 @I500695 @I521258 @I562394

# DevOps files
.deployment/* @Portal-CF/Portals_Team_Devops
Jenkinsfile* @Portal-CF/Portals_Team_Devops
.pipeline/* @Portal-CF/Portals_Team_Devops 

        17.3.3
    17.4 steering and execution sync

steering teams: https://teams.microsoft.com/l/channel/19%3asXe7YdCQDBX8Ys6yFCs0mCbyNTrLZH0b87DZZcgZFwc1%40thread.tacv2/General?groupId=0bc81231-9ca2-4c43-8635-0ca34a6085c9&tenantId=42f7676c-f455-423c-82f6-dc2d99791af7
Navigate to progress tracker, 

Link to the teams space:
https://teams.microsoft.com/l/team/19%3aef4c4e805f934f87ac11abe3e4a83626%40thread.tacv2/conversations?groupId=61211f24-20c3-4574-8786-8d54ec15b678&tenantId=42f7676c-f455-423c-82f6-dc2d99791af7
    17.5 My Vacation days
- my yearly quota 23. max allowed 2*yearly = 46. 


    17.6 distribution lists

        17.6.1 SAP outlook DLs 

            17.6.1.1 Design review DLs, tags: Design review DLs
team: DL BTP Core AP UE Services IL Team Yosi <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>
DL BTP Core AP UE Services IL Team Yosi Extended <DL_56BC7CDF7BCF84C731000087@global.corp.sap>

            17.6.1.2 Review MoM + Signoffs
DL BTP Core AP UE Services IL CF Core Extended <DL_59FB13B87BCF8431D7000219@global.corp.sap>
DL BTP Core AP UE Services IL Team Yosi Extended <DL_56BC7CDF7BCF84C731000087@global.corp.sap>

            17.6.1.3 Scrum Masters DL, tags: Scrum Masters DL
DL BTP Core AP UE Services IL SCM <DL_59DC9A6FECB2116C53000166@global.corp.sap>

            17.6.1.4 Design reviewers DL , tags: Design reviewers DL 
DR DL: DL BTP Core AP UE Services IL Design Reviewers <DL_5D00A8FEB769BD0274A4791B@global.corp.sap>

Ask SCMs please forward to your teams…

            17.6.1.4  When subbing as SM. Notify this distribution of vacations. tags: substitute, sick, OOO, SM, ScM, Scrum-Master, replacement, DLs, oneliner

                17.6.1.4.1  big audience


 send meeting invite to:
one liner To: 
to: 
DL BTP Core AP UE Services IL Team Yosi <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>; Tito, Meni <meni.tito@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Avrahami, Olga <olga.avrahami@sap.com>; Openhaim, Shiri <shiri.openhaim@sap.com>; DL BTP Core AP UE Services IL SCM <DL_59DC9A6FECB2116C53000166@global.corp.sap>; DL BTP Core AP UE Services IL CF Core <DL_59FB10097BCF848EA90001E7@global.corp.sap>; Bussi, Gilad <gilad.bussi@sap.com>

                17.6.1.4.2 Smaller audience one liner
DL BTP Core AP UE Services IL Team Yosi (External) <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>; Avrahami, Olga <olga.avrahami@sap.com>; Tito, Meni <meni.tito@sap.com>; Openhaim, Shiri <shiri.openhaim@sap.com>; Shefer, Shany <shany.shefer@sap.com>; Adoram, Nili <nili.adoram@sap.com>; Hayat, Liraz <liraz.hayat@sap.com>; Bussi, Gilad <gilad.bussi@sap.com>; Taranto, Matan <matan.taranto@sap.com>; Dayan, Vered <vered.dayan@sap.com>; Guy, Ariel <ariel.guy@sap.com>; Shorer, Shani <shani.shorer@sap.com>;  

My team DL + (DL BTP Core AP UE Services IL Team Yosi <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>)
program: Openhaim, Shiri <shiri.openhaim@sap.com>, Bussi, Gilad <gilad.bussi@sap.com>
QPE: Avrahami, Olga <olga.avrahami@sap.com> (was Ariel Guy)
PO: Guy, Ariel <ariel.guy@sap.com> (was Orit Bezalel)
Manager: Tito, Meni <meni.tito@sap.com>
Scrum-masters DL: DL BTP Core AP UE Services IL SCM <DL_59DC9A6FECB2116C53000166@global.corp.sap>
Core: DL BTP Core AP UE Services IL CF Core <DL_59FB10097BCF848EA90001E7@global.corp.sap>


                17.6.1.4.3 Message examples

                    17.6.1.4.3.1 vacation 
Hi,

I will be on vacation at this time.
@Cohen, Shirly will replace me. Thank you Shirly!

KR!
Yosi

subject: Yosi OOO

Set free and don't request read receipt (attendee options -> request responses, set to off)

                    17.6.1.4.3.2 sick leave
Hi, 

I’m on sick leave so please expect delay in my reply. For any urgent issue please contact Jawad Margieh.

Thanks,
Yosi

                    17.6.1.4.3.3 long vacation 
Hi,

 I am OOO until Sunday  7.7.

Please contact Shirly Cohen for anything team related/
I will be abroad with limited availability, however for anything urgent plz  reach out to me via teams or directly to my phone - +972508464424

Thanks!
Yosi





                17.6.1.4.4 Additional steps

b. send mail to same list 
template:
subject: "Yosi OOO 15/11, 24/11"
body: 
"
Hi,
 
I will be OOO 15/11, 24/11. @Kobi, Hadar will replace me at this time.
Please include her in meetings / design reviews and she will forward to relevant team members.
Also please include @Margieh, Jawad for all technical related issues.
 
Thank you @Kobi, Hadar!
 
Thanks!
Yosi
"

c.  Edit invite from step a change to OOO but don’t send - will block only my calendar 

d.  Set OOO rule w/ auto reply


                17.6.1.4.5 important DLs , tags: important DLs 
----------------------------------------------------------------------------------------------------
cmd+N -> write DL, paste DL name, wait for outlook to complete
SAP email DLs


Copy paste then cmd+ctrl+c (complete names)

Design review DL
DL CP DWP Portals Fiori Cloud and cFLP Design Reviewers <DL_5D00A8FEB769BD0274A4791B@global.corp.sap>
DL_5D00A8FEB769BD0274A4791B@global.corp.sap



Saar - CP DWP Portals Team Saar , 

CP DWP Portals DevOps
DL for Cloud Portals DevOps Team	May 06, 2019
Eman Laham	July 26, 2019	1 / 1 / 1			
CP DWP Portals DevOps - Operations
CP DWP Portals DevOps - Operations	May 06, 2019
Eman Laham	August 27, 2019	7 / 0 / 0			
CP DWP Portals DevOps Cloud
CP Services Portal DevOps Cloud	May 02, 2019
CIP-ADMIN	July 29, 2019	0 / 2 / 2			
CP DWP Portals Data Protection
CP DWP Portals Data Protection						
 
CP DWP Portals DevOps - Cloud CI
DL for the CI development team of cloud portal


Saar Team Extended DL:
 DL CP DWP Portals Fiori Cloud and cFLP Team Saar 


Guy Team Extended DL:




* DL CP DWP Portals CloudPortal and EnterprisePortal Team Nili
* DL CP DWP Portals Team Nadav , DL CP DWP Portals Team Nadav <DL_5CBEB265B4A586027F8B0ACF@global.corp.sap>


 DL CP DWP Portals CloudPortal and EnterprisePortal Team Nili <DL_54A53DB7FD84A05CD20000A0@global.corp.sap>;
 DL CP DWP Portals Team Nadav <DL_5CBEB265B4A586027F8B0ACF@global.corp.sap>


DL CP Extensions Portals Group Meni <DL_54A94DAFDF15DB2425000007@global.corp.sap>

        17.6.2 manage my distribution lists, tags: manage my distribution lists, delegated DLs, Owned DLs

my DLs: https://profiles.wdf.sap.corp/groups?show=owned
Delegated: https://profiles.wdf.sap.corp/groups?show=delegated

my managed DLs:
Saars team I060224 Jira Int - https://profiles.wdf.sap.corp/groups/623d78189414b97bb4225a8d/users 

My owned DLs: https://profiles.wdf.sap.corp/groups?show=owned

        17.6.3 Scrum rituals emails - alignment
Hi,
 
As discussed in the core meeting last week, we will align the email subject of our scrum rituals meetings (Planning, Sign-off, Review).
 
Starting next week with 2201, please use the following convention:
<Team Name> <Takt # / Full Sprint #> <Planning / Sign-off / Review>
 
Takt # / Full Sprint #:
For Planning and Sign-off à Takt #
For Review à Full Sprint # (i.e. 2113B)
 
For example:
Yosi’s Team 2201 Planning
Yosi’s Team 2201 Sign-off
Yosi’s Team 2201A Review
 
 
We will also review the above in today’s core meeting.
Please let me know if you need any clarification.
 
Thanks and regards,
Shiri
        17.6.5 DL CDM Schema Reviewers (External), tags: DL CDM Schema Reviewers (External)
I created it. used for cdm schema reviews.
includes the architects 

one liner: DL CDM Schema Reviewers (External) <DL_67C0494DBC1DD3FF086B697F@global.corp.sap>; DL BTP Core AP UE Services IL Team Yosi (External) <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>; Izaq, Yosi <yosi.izaq@sap.com>

        17.6.6  Ilan's group
DL BTP Core AP UE Services IL All (External) <DL_IMS_NETWEAVER_IL@global.corp.sap>

        17.6.7
    17.7 tags: team repositories, services, code base
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+Repositories

        17.7.1 unified list
send to Oren list of our services:
name, git repo, local path
portal-cf-cdm-store-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service, /Users/i500695/git/portal-cf-cdm-store-service
portal-cf-transport-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service, /Users/i500695/git/portal-cf-transport-service
cdm-import-service, https://github.wdf.sap.corp/Portal-CF/cdm-import-service, /Users/i500695/git/cdm-import-service
cdm-export-service, https://github.wdf.sap.corp/Portal-CF/cdm-export-service, /Users/i500695/git/cdm-export-service
portal-cf-design-time-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service.git, /Users/i500695/git/portal-cf-design-time-service
nestjs-common, https://github.wdf.sap.corp/Portal-CF/nestjs-common.git, /Users/i500695/git/nestjs-common
portal-amqp-client, https://github.wdf.sap.corp/Portal-CF/amqp-client.git, /Users/i500695/git/amqp-client
cdm-store-client, https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service.git , /Users/i500695/git/portal-cf-cdm-store-service
eslint config, https://github.wdf.sap.corp/Portal-CF/backbone-eslint-config, /Users/i500695/backbone-eslint-config
cdm-mock-provider, https://github.wdf.sap.corp/Portal-CF/cdm-mock-provider, , /Users/i500695/cdm-mock-provider
automations, https://github.wdf.sap.corp/Portal-CF/Backbone-Automations, /Users/i500695/git/Backbone-Automations

 


- Past microservices
portal-cf-provisioning-service-new, https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new - moved to vered team on 18/02/24 12:25:29  

- microservice, git url
portal-cf-cdm-store-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service
portal-cf-transport-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service
cdm-import-service, https://github.wdf.sap.corp/Portal-CF/cdm-import-service
cdm-export-service, https://github.wdf.sap.corp/Portal-CF/cdm-export-service
portal-cf-design-time-service, https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service.git

- libraries, git url
nestjs-common, https://github.wdf.sap.corp/Portal-CF/nestjs-common.git
portal-amqp-client, https://github.wdf.sap.corp/Portal-CF/amqp-client.git
cdm-store-client, https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service.git 
eslint config, https://github.wdf.sap.corp/Portal-CF/backbone-eslint-config

- CLIs 
  event replay, https://github.wdf.sap.corp/I585770/replay-events-cli

-  mock provider
cdm-mock-provider, https://github.wdf.sap.corp/Portal-CF/cdm-mock-provider

- automations
automations, https://github.wdf.sap.corp/Portal-CF/Backbone-Automations

clone repos script:
[i500695@C02FV4LCMD6T:2023-01-03 13:45:47:~/work/SAP/code/bash:]2008$ ./clone_team_repos.sh 
Code:
[i500695@C02FV4LCMD6T:2023-01-03 13:46:05:~/work/SAP/code/bash:]2009$ cat !$
cat ./clone_team_repos.sh
#!/bin/bash
#

TEAM_REPOS=( "https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service" "https://github.wdf.sap.corp/Portal-CF/portal-cf-transport-service" "https://github.wdf.sap.corp/Portal-CF/portal-cf-provisioning-service-new" "https://github.wdf.sap.corp/Portal-CF/cdm-import-service" "https://github.wdf.sap.corp/Portal-CF/cdm-export-service" "https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service.git" "https://github.wdf.sap.corp/Portal-CF/nestjs-common.git" "https://github.wdf.sap.corp/Portal-CF/amqp-client.git" "https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service.git " )

GIT_REPO_DIR="${HOME}/git"
if [ ! -d "${GIT_REPO_DIR}" ]
then 
    echo "${GIT_REPO_DIR} does not exist. creating it"
    mkdir "${GIT_REPO_DIR}"
fi 

cd "${GIT_REPO_DIR}"
for repo in ${TEAM_REPOS[@]}; do 
    echo "cloning repository ${repo}"
    git clone "${repo}"
done 

        17.7.1 Shany team repositories
We manage our team’s repos in this wiki - https://wiki.one.int.sap/wiki/display/CPPortals/Team%27s+Repositories
 
https://github.wdf.sap.corp/Portal-CF/portal-cf-service-broker    
https://github.wdf.sap.corp/Portal-CF/portal-cf-odata-service
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-transformer
https://github.wdf.sap.corp/Portal-CF/portal-cf-role-mapping
https://github.wdf.sap.corp/Portal-CF/launchpad-utilities-service
https://github.wdf.sap.corp/Portal-CF/portal-cf-schema-validation-service
https://github.wdf.sap.corp/Portal-CF/portal-cf-cap-odata-service
https://github.wdf.sap.corp/Portal-CF/cdm-schema
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service
https://github.wdf.sap.corp/Portal-CF/portal-cf-site-service-storage
https://github.wdf.sap.corp/Portal-CF/portal-cf-portal-personalization/
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-gateway
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-runtime
https://github.wdf.sap.corp/Portal-CF/portal-cf-graphql-cdm-core
https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-database-client
https://github.wdf.sap.corp/Portal-CF/html5-app-test-content
https://github.wdf.sap.corp/Portal-CF/portal-cf-spc-service
https://github.wdf.sap.corp/Portal-CF/Shany-Automations
https://github.wdf.sap.corp/Portal-CF/Shany-Scripts


        17.7.2 Adoram, Nili <nili.adoram@sap.com> repositories
https://wiki.one.int.sap/wiki/display/CPPortals/CP+projects+Security+Scans

Name, repository, SCA (checkmarx), FOSS (whitesource/mend), product, GA
workzone-cf-provisioning, https://github.wdf.sap.corp/Portal-CF/workzone-cf-provisioning, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/69080/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1757804, workzone workzone-hr, ✅

tenant-configuration,	https://github.wdf.sap.corp/Portal-CF/tenant-configuration 	, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/94315/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=3482969, ✅

workzone-content-provider,https://github.wdf.sap.corp/Portal-CF/workzone-content-provider, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/79629/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1922251, workzone workzone-hr, ✅

workzone-rt-approuter,https://github.wdf.sap.corp/Portal-CF/workzone-rt-approuter	, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/69104/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1759452, workzone,	✅

workzone-dt-approuter,https://github.wdf.sap.corp/Portal-CF/workzone-dt-approuter,https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/79429/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1759480, workzone,	✅

workzonehr-dt-approuter, https://github.wdf.sap.corp/Portal-CF/workzonehr-dt-approuter	, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/81703/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2139519, workzone-hr,✅

workzonehr-rt-approuter,https://github.wdf.sap.corp/Portal-CF/workzonehr-rt-approuter,https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/81661/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2133450, workzone-hr,✅

portal-cf-cards-deployer,https://github.wdf.sap.corp/Portal-CF/portal-cf-cards-deployer, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/81720/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2133238,,✅

common-rt-approuter,https://github.wdf.sap.corp/Portal-CF/common-rt-approuter, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/85008/Summary, https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2510741,,✅

portal-cf-static-workzone-configurator,https://github.wdf.sap.corp/Portal-CF/portal-cf-static-workzone-configurator, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/87410/Summary, not exist for client-side, workzon workzone-hr,✅

portal-cf-asset,, https://github.wdf.sap.corp/Portal-CF/portal-cf-assets, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/32718/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=66570,✅

portal-cf-freestyle-ootb-template,, https://github.wdf.sap.corp/Portal-CF/portal-cf-freestyle-ootb-templates, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/32493/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=66024, freestyle,✅

portal-cf-freestyle-static-resource,, https://github.wdf.sap.corp/Portal-CF/portal-cf-freestyle-static-resources, https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/32492/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=67290, freestyle,✅

portal-cf-freestyle-semantic-service	https://github.wdf.sap.corp/Portal-CF/portal-cf-freestyle-semantic-service	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/35191/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=822956	freestyle	✅
portal-cf-dt-bff	https://github.wdf.sap.corp/Portal-CF/portal-cf-dt-bff	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/59238/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1045937	workzone workzone-hr more?  ✅

feature-flags-client	https://github.wdf.sap.corp/Portal-CF/feature-flags-client	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/63190/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=1190013	✅

portal-cf-static-freestyle-dt https://github.wdf.sap.corp/Portal-CF/portal-cf-static-freestyle-dt	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/86688/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=672960	freestyle	✅

launchpad-rt-approuter https://github.wdf.sap.corp/Portal-CF/launchpad-rt-approuter	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/81399/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2075328 ✅

launchpad-dt-approuter https://github.wdf.sap.corp/Portal-CF/launchpad-dt-approuter	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/81487/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2100801 ✅

dt-static-resources https://github.wdf.sap.corp/Portal-CF/dt-static-resources	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/69112/Summary	not exist for client-side	✅

portal-cf-static-site-settings	https://github.wdf.sap.corp/Portal-CF/portal-cf-static-site-settings	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/83010/Summary	not exist for client-side	✅
portal-cf-static-site-directory	https://github.wdf.sap.corp/Portal-CF/portal-cf-static-site-directory	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/86784/Summary	not exist for client-side	✅
wz-common-object-store https://github.wdf.sap.corp/Portal-CF/wz-common-object-store	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/87916/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2800345 ✅

content-package-store https://github.wdf.sap.corp/Portal-CF/content-package-store	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/87989/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2823210	✅

portal-cf-content-repository https://github.wdf.sap.corp/Portal-CF/portal-cf-content-repository	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/87904/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=2796652	✅

portal-cf-static-subaccount-settings https://github.wdf.sap.corp/Portal-CF/portal-cf-static-subaccount-settings	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/89473/Summary	not exist for client-side ✅

cep-activation	https://github.wdf.sap.corp/Portal-CF/cep-activation	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/129091/Summary	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=5572461	✅

html-bootstrap-static-resources	https://github.wdf.sap.corp/Portal-CF/html-bootstrap-static-resources	https://cx.wdf.sap.corp/cxwebclient/ViewerMain.aspx?scanId=10204855&ProjectID=136882	https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=6331047	

portal-cf-healthcheck	https://github.wdf.sap.corp/Portal-CF/portal-cf-healthcheck	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/149380/Summary	
https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=6481357



Portal Core Under Nili's team(Haviv, Tal )
portal-cf-shared-lib https://github.wdf.sap.corp/Portal-CF/portal-cf-shared-lib https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/29222/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=492153 ✅ 
portal-cf-activation-service https://github.wdf.sap.corp/Portal-CF/portal-cf-activation-service https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/36128/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=828895 ✅ 
portal-cf-html-bootstrap https://github.wdf.sap.corp/Portal-CF/portal-cf-html-bootstrap https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/130183/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=5747883 ✅ 
portal-cf-static-resources-deployer https://github.wdf.sap.corp/Portal-CF/portal-cf-static-resources-deployer https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/29763/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=828895 ✅ 
portal-cf-site-configuration	https://github.wdf.sap.corp/Portal-CF/portal-cf-site-configuration	https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/38831/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=509868 ✅ 
portal-cf-technical-support https://github.wdf.sap.corp/Portal-CF/portal-cf-technical-support https://cx.wdf.sap.corp/CxWebClient/portal#/projectState/32077/Summary https://sap.whitesourcesoftware.com/Wss/WSS.html#!project;id=828897 ✅ 


Content-package-manager(Ruwei Yuan)
cpkg-manager	https://github.wdf.sap.corp/Portal-CF/cpkg-manager	https://cx.wdf.sap.corp/cxwebclient/portal#/projectState/90390/Summary https://fortify.tools.sap/ssc/html/ssc/version/35025/fix/null/?filterSet=a243b195-2010-3f8b-1403-d55b7a7d78e6 ✅
Navigation Service (Kiefer, Sascha, Dumistracel, Haralambie  ) navigation-service	https://github.wdf.sap.corp/Portal-CF/navigation-service	https://fortify.tools.sap/ssc/html/ssc/version/47007/fix/d0/s0?filterSet=a243b195-2030-3f8b-1403-d55b7a7d78e6 https://portalcfruntime.jaas-gcp.cloud.sap.corp/job/ci-navigation-service-voter/job/master/lastSuccessfulBuild/artifact/whitesource/


        17.7.3 Sergey repositories
portal-cf-static-provider-manager, https://github.wdf.sap.corp/Portal-CF/portal-cf-static-provider-manager.git
portal-cf-static-content-manager, https://github.wdf.sap.corp/Portal-CF/portal-cf-static-content-manager.git
dt-static-resources, https://github.wdf.sap.corp/Portal-CF/dt-static-resources.git
semantic-libs, https://github.wdf.sap.corp/Portal-CF/semantic-libs.git
url-templates, https://github.wdf.sap.corp/Portal-CF/url-templates.git
maas-client, https://github.wdf.sap.corp/Portal-CF/maas-client.git
async-context, https://github.wdf.sap.corp/Portal-CF/async-context.git
web-socket, https://github.wdf.sap.corp/Portal-CF/web-socket.git
portal-cf-static-infra, https://github.wdf.sap.corp/Portal-CF/portal-cf-static-infra.git
cdm-schema, https://github.wdf.sap.corp/Portal-CF/cdm-schema.git

        17.7.4

    17.8 wiki pages, tags: team wiki pages automtions designs, knowledge-base

        17.8.1 Design-Documents
https://wiki.wdf.sap.corp/wiki/display/CPPortals/2022+Designs

        17.8.2 technical knowledge-base 


        17.8.3 team automation

            17.8.3.1 DTS Automations
https://wiki.one.int.sap/wiki/display/CPPortals/DTS+Automation+Tests

            17.8.3.2 Import Export Automations
https://wiki.one.int.sap/wiki/display/CPPortals/Import+Export+Automations
        17.8.4
    17.9 Scrum-masters forum

        17.9.1  Teams Scrum-masters forum agenda
https://teams.microsoft.com/l/meetup-join/19%3ameeting_MjRlYzU4NzQtNjlkMi00YzUyLThkNjItZTVhZjFjODg2Y2Jj%40thread.v2/0?context=%7b%22Tid%22%3a%2242f7676c-f455-423c-82f6-dc2d99791af7%22%2c%22Oid%22%3a%226150d293-b3a6-4eda-86ee-c85e9bdef496%22%7d


        17.9.2
    17.10 1:1 Meni, tags: 1:1 Meni

        17.10.1 01/2022
      -> team focus timE
The team would like a dedicated interruption free time to focus on actual technical work. Coding, designing, intra team collaboration etc
The developers in the team deal with many interruptions (meetings, calls, consultations etc) on a daily basis.
The cost of context switch until full return to same cognitive state as before is high. It is the nature of our work, we just want to lessen the negative impact of context switches on our performance
The suggestion is to allocate a weekly 3-4 hours meeting for the team. Urgent meetings/tickets/requests will be addressed but other run of the mill interruptions will need to be scheduled to some other time slot. 


        17.10.2 Thu Feb 17 17:57:38 IST 2022
- Olga, E2E automtions

- What do team want in future? New features (non UI)  global search, my home provisioning (new set of entities) 
Or all in on CDM-Core entities (option 4)
Or option 3 + search 
https://sap.sharepoint.com/:p:/t/portal-architecture/EURd_6tfqn9KsGGbKd1BniABFc6UyOQ2avOdA3amsmSt9w?e=VWzEJK&wdLOR=cE051CD83-6476-1B4C-8F79-348BEE86FD9F

set meeting w/ Gil&Jawad
- Talk 2 Ariel re. event driven architecture and asynchronous flows


        17.10.3 Thu Mar 24 17:33:04 IST 2022
- Tickets support impacting moral severely 
- ipad for Scrum-masters
-  dailies should be totally owned by team. on same time (no exceptions). only devs allowed to speak. ScM facilitates. 
QPE can attend all dailies but if he's not doing tasks he can't participate (doesn't talk)
- Team identifies two problems in DoD. 
  a. scope of automated tests is undefined. team thinks its UT/IT. QPE thinks it's E2E involving multiple teams and microservices 
  b. Performance tests in DoD. team by definition can't do b/c they require production like environment 
- It appears that there’s a consensus on the team that It would be more efficient if automations team also takes ownership on the tests code. bugs in actual services code should be dispatched ofc. Currently tests written by auto. Team owned by us often fail in test code that we don’t know how to operate and it’s not efficient.
- 27 PDs for support. Meni, don't increase support. We want to make it seen that we can't Handle the Tickets b/c of large volume. 
  process according to priority:
ToDo: present to team
  SNOW, VH, H, Medium 
  Jira + BCP should prioritize w/ QPE and PO
  Jira,   
  BCP, VH, H, Medium  (we can change priority)

- 31 security issues in DTS that were skipped until now. We need to check relevance. Todo, add BLI for fixing security issues. add Adam, Ariel, Boris, Meni
- encoding decoding issue 
- DTS + FDC flow is terrible, we are losing money on it
- DEV component Apollo (description LP module), ask Meni, is it Apollo / development LP module, HTML5 is in another component 
Meni: Me and Sergy only own Apollo

Meni: ToDo
- Effective work mode workshop (on site), start email thread with scrum-masters. ready by EoD Monday
    -- Tickets support impacting moral severely. We need to show that we are taking measures to address. Support team??
    -- Scrum best practices: Reduce cross-team dependencies
    -- Scrum best practices: dailies should be totally owned by team. on same time (no exceptions). only devs allowed to speak. ScM facilitates. 
    -- Two many meetings
    -- ipad for Scrum-masters
    -- We think that it would be more efficient if automations team also takes ownership on the tests code. bugs in actual services code should be dispatched ofc. Currently tests written by auto. team owned by dev teams often fail in test code. that dev teams know less how to operate so its less efficient. 
    What is your experience?
    -- In my team we have identified two problems in DoD.  do you experience same?
        a. Scope of automated tests is undefined. team thinks its UT/IT. QPE thinks it's E2E involving multiple teams and microservices 
        b. Performance tests in DoD. team by definition can't do b/c they require production like environment 
- ToDo role id encoding. reconvene all architects from last Thursday Meeting. (Jawad) [Done]

        17.10.4, 1:1 Meni 06/04/22 16:36:43  
- My tuesday availability
- cdm-store refactoring, we want to start but Ariel's re-architecture plan holds us back

        17.10.5, tags topics 1:1
https://wiki.wdf.sap.corp/wiki/display/CPPortals/T03A+2022+Retrospective
interrupts handling. example "[Action Required] Test the new CF extension landscapes". Was not really ready for us to test. Improvement suggestion. Involve PO/Ops as relevant. 
also raised by Kahan, Sheli  , +1 Izaq, Yosi 
We should invest time in improving dev scenario tickets volume. by automatic validations, tests, wizards. Should communicate to product how important this is. Izaq, Yosi  to discuss with Meni and Ariel
Don't add non SRE BLIs (like backend search) as SRE 
TC time consuming, not efficient. used mainly for explain to QPE and PO. PO should not be in TC.
Izaq, Yosi , talk 2 Olga 
QPE should come prepared to TC re. feature details. Talk 2 Dev/Scm/PO before
BLIs are not well defined
next planning dive deeper into BLIS
raise questions/gaps in preplanning
Kobi, Hadar  acceptance criteria should be more specific and cover all required functionality
Kobi, Hadar  technical contact persons in BLI
Shikva, Gil  QPE is spread too thin. Dedicated QPE per team would be more efficient. Adam: Such QPE can write TCs.
Izaq, Yosi , Do the TC + review before impl. Consider doing peer review for TC (like code review)
Izaq, Yosi , do early detailed design review (impl intention). can be non formal. internal only.
bug triage is a waste of time. Feels like its used for explaining to QPE instead of trying to help w/ open tickets. Izaq, Yosi , talk w/ Meni, Olga

Actions
 Margieh, Jawad, check if git bot can push empty commit. need 2 research. Possibly can be done via git actions.  
Cohen, Adam, check if we can use an update version bot
Izaq, Yosi, reduce meetings
Izaq, Yosi, reduce dependencies 

        17.10.6, tags topics 1:1 Meni Wed Apr 20 11:21:50 IDT 2022
- order 27 inch screen  [Done]
- Volunteer RSVPs next Monday. Gil, Yoav OOO; Jawad, not coming. Rest are coming  [Done]
- Olga and QA team responsibility

        17.10.7 06/07/22 13:32:46  
- student capacity doesn't count 

- product component 
- CEP architecture, cdm-store should be all entities source of truth. Current proposal over complex for content aggregation, import and export
    Proposed solution for import of spaces-and-workpages. Import to cdm-store. cdm-store will publish event. Activation service will pick it up and update CDM-RT (spaces-and-workpages)
- Team attrition. A lot of context switches. A lot of work. Frequent changes in direction (CEP). Expectation is that as workload ramps up so should recruitment be increased  
- no eventual consistency in case Solace is down and updates are lost 

- Support
- Recruitment
- Office days
•	Tuesday, Wednesday in office clarification. Currently the ask is to arrive to office every Tuesday and Wednesday. Plz let me know and send WFH invite you don’t plan to come. You raised many points. I’ll summarize here and pass your feedback up. Plz add if I forgot something.
•	Re office days communication:
    - Teem feels that It’s questionable that productivity is increased. Arguably the opposite is true
    - Idle time at office and lack of incentives to come to office (recreation areas etc)
    - Exceptions to the rule. People that drive large distance to office or can’t arrive on one of these days.


        17.10.8 14.7 14.7 
- Architects don't close a lot of technical details re. BLIs (Ariel thinks same)
- Olga and Ariel interaction w/ team is toxic 
- how to handle tickets that require PO involvement (Shany's team assign to Sivan the PO) use Shani (support) 4 it. 
- replacement for security lead 
- Ariel constantly pushes E2E aspects to our BLIs 

        17.10.9 18/08/22 17:40:17  
- Work Ipad for me  :) - no
- CI job history should be vastly increased. we can't investigate when issues happened and establish a timeline. Email to Meni
- Sunday review move to Monday 
- Adam, complete refactoring as much as possible 
- Kalman, 1.9 joins & Shirly, 4.9  
who wants to Kalman buddy - technical only (Jawad) 
onboarding plan for Shirly and buddy (Hadar) 

        17.10.10 13/09/22 11:33:12  
- Task force for role collections tenant issue [Done]
- Replacement for security lead , urgent due to threat modeling. Need for qgate and security measures. SVM alerts handling. 20% deducted capacity
Talked to Shirly, she is starting to take tasks
- CI job history should be vastly increased. we can't investigate when issues happened and establish a timeline. Email to Meni
- Move from eu10 global account to new eu12 global account. I asked a BLI/task
- Eng drivens, will they be back?
- retro 
- Tuesday WFH. Talked to Ariel and Shiri. Both are fine w/ me WFH Tuesday. Team doesn't feel my presence as I'm in meetings all morning.  [Done]

- Shelly is leaving SAP. it is confidential. Student teken. 

        17.10.11 1:1 with Meni 03/11/22 14:56:50  
- Dedicated PO for the team. Currently this is the best we can do. We will revisit in the future.
- Shirly, 
    -- Todo: Talk w/ Shirly, if she wants to lead a complex, large BLI
    -- revisit Shirly, security champion capacity next in T13   
- Yoav, how is he doing? - doing good :)


        17.10.12 29/01/23 13:03:26   
- restructuring - what is the executive message?
- Yoav, really wants to get back to the team. T2 no later than T3
- Alon, Kalman buddy, 28.2, Kalman: talk to Alon re. laptop, 2 screens (not new from pool), keyboard, mouse, headphones, consult w/ Vered/Yael. talk to Eyal.  IT orders  
- We must retire cdm-store Java ASAP!!
- Upgrade dependencies, especially in cdm-store
- https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/27721bc61ba3d51040ee4197ab4bcb8b - Gil customer rude response
- 

        17.10.13 20/02 
- performance setup for team  - time share, talk to Ronen... 
- developers should not handle customer cases directly. They are not trained for this and always most suitable or motivated for this
- Jawad, mentality shift - become a mentor , guide instead of do, delegate work , grow the team contribution to team success
- postpone timeout validation fix. T02 add task for the validation 

Meni:
- entities without relations 
- 
        17.10.14 03/04/23 12:38:39  
- capacity, should be always 20 [Done]
- Kalman frustrated 
    -- no pre-bonus Talk
    -- feels under ranked
    -- mostly work on support, not developing
-
        17.10.15 10/04/23 17:32:24  
- Kalman frustrated 
    -- no pre-bonus Talk
    -- feels under ranked
Meni: got a promotion + salary bump. not eligible to further raise/bonus. 20.9.2022 - impossible to change contract again
his good work doesn't go unnoticed. Next year you'll see benefit 
I'm saving first real dev BLI for you!
buddy for Alon in only 4 months 
    -- mostly work on support, not developing
- Team frustrated

Meni:
- product should add security to BLIs planning
- scrum training

        17.10.16 17/05/23 15:40:21  
- Product is pushing too many BLIs and too many contexts for devs. Esp. for Jawad 
too many focuses shifts
jawad time management
Example: BLI #1 and #5 (start as architect)
BLIs: 
Priority	BLI	Effort Estimation (in PDs)	Planned Sprint (A/B)	Comments
1	Security issues - Whitesource vulnerabilities - phosphor 15	B	
2 	Security: Update dependencies for security compliance 3	B	
3	Preparation  for security validation 2	B	
4	CEP] content package automations 5 	SOFT	leftover
5	Consume HTML5 applications from multiple subaccounts breakdown after meeting w/ Tsafir	SOFT	
6	CEP Content Channels - Create content package with Package id from Central Store breakdown after meeting w/ Tsafir	SOFT	
  
-  suggested to Ilan, SRE hackathon

        17.10.17  25/05/23 15:44:39  
- Gil-Shikva, support him now

- CMK 2 phased approach. separate DB for apple first and RDS proxy later - when PG team has it ready

        17.10.18  05/06/23 15:45:04  

        17.10.19 10/07/23 15:06:11  
- consultation: Shirly
  -- on a few occasions called me. Said she is sick, or bad back etc. She tells she can work intermittently. This puts me in a tough spot. since I need 100% commitment. any suggestion how to handle?
  Ask her to take day off in case she can't. B/c we need everyone full power. Otherwise teammates need to pick up the slack.
  -- Team and Especially Jawad feels that Shirly is slacking on the job and is falling as a burden on the team
Talk with Shirly. Try to be more independent. Avoid taking tasks that she can't handle alone. If she need someone she needs to either take another task or ask if she can ask for help.
In case there's no task she can take the duty. 
Stress that it's ok to say this and it's appreciated and will help the team! We need to be transperent and agile as scrum

- Team wants to come to the office Monday once in a month, instead of Tuesday or Wednesday -> email to Meni!


        17.10.20 18/07/23 11:29:49  
- Shirly & Yoav are drawn for hours to help Asaf. Mostly wasted their time.
- over capacity

        17.10.21 14/08/23 14:47:54  
- when r SRE back? - Meni: Possibly September
- Sunday is sub-optimal to arrive into office because of traffic issues 


        17.10.22 21/08/23 15:35:48  
- got scrum training feedback https://wiki.one.int.sap/wiki/display/CPPortals/T06+2023+Retrospective [Done]
-- We need eng in T10: an urgent task to fix delete space / provider fail issue (b/c of active subscriptions) [Done]
  -- Issue: can't delete space or prvider. [Done]
  -- RC: There are active subscriptions. Sometimes its very hard to find and delete all
  Even using CIS API to get the list of active subscriptions 
  -- Impact: Stakeholders frustrated. Many tickets. bussiness activities and development delays.
  -- Proposed fix:
    provisioning service will allow to delete the provider (remove Foreign-key constraint) and will delete cascade (so that the subscribers who's subscribedTenantId matches the provider instance ID will be deleted)

        17.10.23 

        17.10.24 26/09/23 12:30:47  
- scheduled meeting w/ Eman+Meni CMK readiness on live 
- talk w/ Gil, what is his availability? 
- Liraz: capacity  excel
- UX coverage is not relevant to our tests. It is ineffective w/ many issues. we should switch to API only
- Team is very much opposed to tickets BLI

        17.10.25 26.10.23
- Team engagement and motivation are trending down. Team sentiment is that mgmt doesn't trust team. main drivers for these feelings:
    - Request to make duty work transparent in board
    - excel capacity 
    - Gil is especially de-motivated. he manifests angry and short tempered attitude 
    contradicts 
I think you should talk with the team and back the messages coming from me:
    - There's no trust issue. it's purely management efficiency. we need to know what is dev duty working on in order to make decisions. we can't reverse engineer the data from the various systems
    - for capacity, we need to know, ahead of time re. planed vacations in order to plan efficiently

        17.10.26 22/11/23 12:38:05  
- Some team members asked that I help w/ support
- Meni's statement: only dev on duty needs to do support
- In retro, listen to complaints. Show willingness to help and discuss w/ people individually 
- Do a round of conversations. Pass the sensation that I'm part of the team and contributing to the team
- Show willingness to help. Summarize that I'll try to help and give AIs to the people 

        17.10.27 04/12/23 10:06:02 
- Next Tuesday, Jawad, Shirly, Hadar on vacation
- Gil is facing a lot of issues, maybe we can do something for him?
- Shany, week 38. soon gone. Snir in reserves
- Team complaints issue
  -- There were no complaints for two years and half
  -- complaints began when Hadar returned from maternity leave
  -- It so happens that on same time I led an extremely time consuming topic
  -- There are also complaints expressed to me re. you Meni. I usually block them and defend you.
  -- some people in the team have entitled attitude 
  -- Are people across the organization also complaining about me?
  -- Are you not satisfied w/ my performance?
  -- If you and the organization think that I'm doing a good job - Will you back me up on this?
  -- I can work w/ concrete criticism. General sentiment coming from frustration over other issues is not helpful and in this case can disrupt my work of managing the team (as in the team indirectly decided what I should work on)
  -- underlying issue if frustration from increased dev support. The message to the team needs to be clear and come from both of us: Yosi is ofc part of the team. He performs his responsibilities as ScM and any time he has left he helps hands on with issues according to overall priorities. Support is part of this but Yosi will not do dev duty b/c it's time consuming and will hinder is ability to perform as ScM.

-
        17.10.28 25/12/23 16:11:07  
-  Gil had general reduced availability - I hope it's behind us
--- On sunday drops from a meeting re. her BLI validation (W/ Olga & Nili). No response to me, doesn't join when I call her 
- Hadar, unprofessional attitude and lackluster performance:
    -- subaccount activation BLI - She asked to take a meaningful BLI and I gave her the chance. result is disappointing
        --- dragging for more than a takt. was estimated as 20 PDs. Added Shirly to help so close to 40 PDs and still not complete 
        --- lack of transparency in updates or not replying at all to my DMs re. status (as is evident in teams channel "[Yosi Team] RCT CMK validations")
        --- on more than one occasion expressed refusal to cont. work on BLI
        --- On sunday drops from a meeting re. her BLI validation (W/ Olga & Nili). No response to me, doesn't join when I call her 
    -- dramas in many interactions: With Olga, Adam, Pavel 
    -- averse to anything that seems like criticism or outside involvement 
    -- emotional responses like "I won't work on this/like this" 
    -- this needs to change as it hurts the team performance
    -- doesn't answer my DMs nor phone calls, Thursday 21st, Sunday 24th
- Yoav, under performing
- Private key rotation why is it stuck?- bug in Ruwei team 
- EoY - write for each team member continue and improve. provide 2-3 points with examples
- recognition - Jawad 

        17.10.29 01/01/24 15:40:27  
Eoy reviews

        17.10.30 08/01/24 15:35:15  
- lead sub-account-activation track 
add meni optional
do weekly starting next week
- lead import export agents topic
one weekly meeting for sync
Shany Shefer 
Liraz, Alma
Alon, Jawad
Tsafrir
Olga 
Meni (optional)

Timeline: release by Q2. May
E2E 
Performance 
Automations

- 
        17.10.31 15/01/24 15:31:12  
postponed

        17.10.32 28/01/24 11:31:17  
- sign off BLIs may need to decommit 
    -- SAA 
    -- Audit log 
    -- cards destination 

-  SAP Talk
keep:
    - knowledgeable
    - lead cross topics (CMK)
    - lead when there's a slack 
improve:
   -- improve: communicate to team that I am part of team. Take some shit off the team
   maybe send updates and emails to help someone (and later ask that each individual does the same)
   communicate to team

   -- careful when responding in big forum. keep low profile
   consult w/ Meni before sending


   -- Help avoid communication breakdowns. 
   If we have exceptions, communicate clearly and on time 
    --- GCP patch 

   -- 

        17.10.33 05/02/24 15:05:08  
- New automations comming to team from Nili b/c of X509 issues
- SAA via ETL 
- capacity 
- Raise in management meeting re. BLIs not fully baked (example: cards destinations mapping changing up until DR and after) 


- https://wiki.one.int.sap/wiki/display/CPPortals/Destination+Mapping+for+Cards+-+Product+Plan 
Retrigger activation on all business apps (+provider entity)

Retrigger activation on all business apps (for populating provider ID relation).and for existing providers.
Required subaccount activation for specific entity type.
Concerns \ Issues with current subaccount activation. 
Alternative: ETL (Migration on DB layer) - Develop new framework for migrating content from one DB to another. - Very high effort.

- Team communications
    - too many internal designs
    - sprint reviews


- 
        17.10.35 19/02
- Gil was sick 20-21/02 did he take a sickness day?
  he said he'll try to get work done - didn't see any evidence of that.
  in general the last few months he is sick a lot. 2 qs:
    -- does he report  2 u?
    -- it's hurting the team. more work for everyone. what can we do

- Jawad is very frustrated. he is on duty this week (18.2) with Yoav
He feels like Shirly who was on duty last week hardly got anything done and left too many tickets for him to handle
he is de-moralized 
Shirly as well :( 

- Followup, Team communications, discussed in retro
    - too many internal designs
    - sprint reviews


        17.10.36 04/03/24 
- Duty, definition is to limit capacity to 20. but the boundary is eroding since de facto:
Student added to duty (and not counted)
Qgate defined as very high priority that justifies pulling a dev from his BLI

        17.10.37 11/03/24 
- Meet w/ team more frequently. Communicate feedback and criticism 
- Hadar is acting out. She is frustrated over export agents assignment to Kalman.
  She accuses me of lying to her and the team
  She accuses Meni & me of not being truthful 
  Asked Meni to talk with her an set her straight as her behavior is causing a toxic atmosphere in the team and demoralizes the other team members
  Also makes it very hard for me to manage her because she is constantly offended of things or accuses of things or not content in general 

        17.10.38 21/03/24 12:07:17  
- Next PO, I want him/her 2 b more part of the team. join our dailies/retros etc
- Team expressed frustration that you do not communicate "bad" news to them. e.g.
    -- Team under performing
    -- hard assignments
    -- Not approve vacations not communicated on time
- Hadar, IMO she'll cont. to be a negative impact in the team. Can you move her?- Even temporarily
- Run wants a "perfectly simple" replay CLI, he may escalate his demands  
        
- Jawad is overloaded - he asked me 2 lead agents execution until my vacation

        17.10.39 27/05/24 13:36:04  
- Who will lead audit log leftover? - Shany? [Done]
- T6 - too many commitments 
-  

        17.10.40 18/07/24 16:02:36  

- Hadar.
The meeting we had was good for putting out the fire.
However the underlying causes are still there and a subsequent eruption is only a matter of time.
Hadar never accepted me as her ScM. She has personal issues with me and for some reason she "erupts" every time and again.
I think that it would be best for her, me and the team that she will be assigned to another team.
Maybe we can take exchange for a "trouble maker" from another team

- Bussi overstepping. 
Its subtle many times and not subtle some times. Like this week Hadar approached him and he gave her an assignment from next Takt. 
I wasn't even in the loop.
I think he's used to having been a ScM and he confuses his current PO role w/ ScM role

- GP, Liraz team do leftover validations in T08

- Sub 4 me - maybe no official sub. 
Since many ppl r on vacation.
Jawad will enter core meetings

- retro https://wiki.one.int.sap/wiki/display/CPPortals/T6B+2024+Retrospective 
talk to Meni re GP + agent E2E validations. Olga's co-operation is sub optimal. What exactly this team is doing. how are the managed? Izaq, Yosi  


        17.10.41 26/08/24 14:16:13  

- I plan to take a vacation. 7-10/12
- I'm overburdened. I want to set a limit to myself of leading execution of maximum one topic at a time

        17.10.42 12/11/24 14:38:03  
Meni:
- When there meetings the require Meni's decision add him to the loop 
- export/import should be finalized and reduce scope 
- 

Yosi:
- Team should be the moderator of the daily/retro, suggest in next retro
we can do a roster, I'll be part of it
- 
- Leading Architect should be married to his topic. 
  Be present, proactive and engage w/ dev teams.
    -- Lessons learned from import/export track
    -- resilience should matter to product as well

- Gil attitude and general state of mind 

- state of the org
    -- dev vs support ratio
    -- new real development coming?
    -- how to maintain engagement

        17.10.43 20/01/25 16:08:30  
- Hadar is on a downward spiral again. Starting with your comment in the daily.

- Yoav performance is low
  specifically in duty 
    - Shani has given up on getting support from him
    - on the week (10.11) he did duty (replaced Kalman) I felt like I have to push him to work 
    - and still week after Shirly got a huge load of tickets  

- Team related KPI 
- https://jira.tools.sap/browse/DWPBUGS-6917 - Nili opened for WFL deployment failing infrequently (Erick dick). 
  looks like Adam only one who know what needs to be done but I can't get him to engage or let me know who should 

- Gerald schema PRs process is missing a station and it has caused regressions many times. Architect / RT representative should be included
  last one: https://github.wdf.sap.corp/Portal-CF/cdm-schema/pull/422#issuecomment-12685861
  caused https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/jjb-LTS-CONTENT-PACKAGE-UPDATE-e2e/2627/Result/ to fail
  RC: change broke test content
  Fix: make a non breaking change in pr 426
  Remediation steps: We should ask Ariel T. to assign a leading architect to schema. 
  This architect will be the first contact for Gerald. He will then examine the possible ripple effect of the change and potential for regressions 

        17.10.44 tags topics next 1:1, tags: tags topics next 1:1
- Yoav and Hadar complained in rerto about:
Yoav: versioning team creation
I got a beefy BLI to design & implement. We worked with high motivation on design Why didn't we get to work on the implementation
Izaq, Yosi - Discuss with Tito, Meni aspects of long term effects. motivation, knowledge sharing

-
        17.10.45  topics next 1:1, tags: tags topics next 1:1
        17.10.46  topics next 1:1, tags: tags topics next 1:1
        17.10.47  topics next 1:1, tags: tags topics next 1:1
        17.10.48  topics next 1:1, tags: tags topics next 1:1
        17.10.49  topics next 1:1, tags: tags topics next 1:1
        17.10.50  topics next 1:1, tags: tags topics next 1:1
        17.10.51  topics next 1:1, tags: tags topics next 1:1
        17.10.52  topics next 1:1, tags: tags topics next 1:1
        17.10.53  topics next 1:1, tags: tags topics next 1:1
        17.10.54  topics next 1:1, tags: tags topics next 1:1
        17.10.55  topics next 1:1, tags: tags topics next 1:1
        17.10.56  tags topics next 1:1, tags: tags topics next 1:1
        17.10.57  tags topics next 1:1, tags: tags topics next 1:1
        17.10.58  tags topics next 1:1, tags: tags topics next 1:1
        17.10.59  tags topics next 1:1, tags: tags topics next 1:1
        17.10.60  tags topics next 1:1, tags: tags topics next 1:1
        17.10.61  tags topics next 1:1, tags: tags topics next 1:1
        17.10.62  tags topics next 1:1, tags: tags topics next 1:1
        17.10.63  tags topics next 1:1, tags: tags topics next 1:1
        17.10.64  tags topics next 1:1, tags: tags topics next 1:1
        17.10.65  tags topics next 1:1, tags: tags topics next 1:1
        17.10.66  tags topics next 1:1, tags: tags topics next 1:1
        17.10.67  tags topics next 1:1, tags: tags topics next 1:1
        17.10.68  tags topics next 1:1, tags: tags topics next 1:1
        17.10.69  tags topics next 1:1, tags: tags topics next 1:1
        17.10.70  tags topics next 1:1, tags: tags topics next 1:1
        17.10.71  tags topics next 1:1, tags: tags topics next 1:1
        17.10.72  tags topics next 1:1, tags: tags topics next 1:1
        17.10.73  tags topics next 1:1, tags: tags topics next 1:1
        17.10.74  tags topics next 1:1, tags: tags topics next 1:1
        17.10.75  tags topics next 1:1, tags: tags topics next 1:1
        17.10.76  tags topics next 1:1, tags: tags topics next 1:1
        17.10.77  tags topics next 1:1, tags: tags topics next 1:1
        17.10.78  tags topics next 1:1, tags: tags topics next 1:1
        17.10.79  tags topics next 1:1, tags: tags topics next 1:1
        17.10.80  tags topics next 1:1, tags: tags topics next 1:1
        17.10.81  tags topics next 1:1, tags: tags topics next 1:1
        17.10.82  tags topics next 1:1, tags: tags topics next 1:1
        17.10.83  tags topics next 1:1, tags: tags topics next 1:1
        17.10.84  tags topics next 1:1, tags: tags topics next 1:1
        17.10.85  tags topics next 1:1, tags: tags topics next 1:1
        17.10.86  tags topics next 1:1, tags: tags topics next 1:1
        17.10.87  tags topics next 1:1, tags: tags topics next 1:1
        17.10.88  tags topics next 1:1, tags: tags topics next 1:1
        17.10.89  tags topics next 1:1, tags: tags topics next 1:1
        17.10.90  tags topics next 1:1, tags: tags topics next 1:1
        17.10.91  tags topics next 1:1, tags: tags topics next 1:1
        17.10.92  tags topics next 1:1, tags: tags topics next 1:1
        17.10.93  tags topics next 1:1, tags: tags topics next 1:1
        17.10.94  tags topics next 1:1, tags: tags topics next 1:1
        17.10.95  tags topics next 1:1, tags: tags topics next 1:1
        17.10.96  tags topics next 1:1, tags: tags topics next 1:1
        17.10.97  tags topics next 1:1, tags: tags topics next 1:1
        17.10.98  tags topics next 1:1, tags: tags topics next 1:1
        17.10.99  tags topics next 1:1, tags: tags topics next 1:1
        17.10.100 tags topics next 1:1, tags: tags topics next 1:1
        17.10.101 tags topics next 1:1, tags: tags topics next 1:1
        17.10.102 tags topics next 1:1, tags: tags topics next 1:1
        17.10.103 tags topics next 1:1, tags: tags topics next 1:1
        17.10.104 tags topics next 1:1, tags: tags topics next 1:1
        17.10.105 tags topics next 1:1, tags: tags topics next 1:1
        17.10.106 tags topics next 1:1, tags: tags topics next 1:1
        17.10.107 tags topics next 1:1, tags: tags topics next 1:1
        17.10.108 tags topics next 1:1, tags: tags topics next 1:1
        17.10.109 tags topics next 1:1, tags: tags topics next 1:1
        17.10.110 tags topics next 1:1, tags: tags topics next 1:1
        17.10.111 tags topics next 1:1, tags: tags topics next 1:1
        17.10.112 tags topics next 1:1, tags: tags topics next 1:1
        17.10.113 tags topics next 1:1, tags: tags topics next 1:1
        17.10.114 tags topics next 1:1, tags: tags topics next 1:1
        17.10.115 tags topics next 1:1, tags: tags topics next 1:1
        17.10.116 tags topics next 1:1, tags: tags topics next 1:1
        17.10.117 tags topics next 1:1, tags: tags topics next 1:1
        17.10.118 tags topics next 1:1, tags: tags topics next 1:1
        17.10.119 tags topics next 1:1, tags: tags topics next 1:1
        17.10.120 tags topics next 1:1, tags: tags topics next 1:1
        17.10.121 tags topics next 1:1, tags: tags topics next 1:1
        17.10.122 tags topics next 1:1, tags: tags topics next 1:1
        17.10.123 tags topics next 1:1, tags: tags topics next 1:1
        17.10.124 tags topics next 1:1, tags: tags topics next 1:1
        17.10.125 tags topics next 1:1, tags: tags topics next 1:1
        17.10.126 tags topics next 1:1, tags: tags topics next 1:1
        17.10.127 tags topics next 1:1, tags: tags topics next 1:1
        17.10.128 tags topics next 1:1, tags: tags topics next 1:1
        17.10.129 tags topics next 1:1, tags: tags topics next 1:1
        17.10.130 tags topics next 1:1, tags: tags topics next 1:1
        17.10.131 tags topics next 1:1, tags: tags topics next 1:1
        17.10.132 tags topics next 1:1, tags: tags topics next 1:1
        17.10.133 tags topics next 1:1, tags: tags topics next 1:1
        17.10.134 tags topics next 1:1, tags: tags topics next 1:1
        17.10.135 tags topics next 1:1, tags: tags topics next 1:1
        17.10.136 tags topics next 1:1, tags: tags topics next 1:1
        17.10.137 tags topics next 1:1, tags: tags topics next 1:1
        17.10.138 tags topics next 1:1, tags: tags topics next 1:1
        17.10.139 tags topics next 1:1, tags: tags topics next 1:1
        17.10.140 tags topics next 1:1, tags: tags topics next 1:1
        17.10.141 tags topics next 1:1, tags: tags topics next 1:1
        17.10.142 tags topics next 1:1, tags: tags topics next 1:1
        17.10.143 tags topics next 1:1, tags: tags topics next 1:1
        17.10.144 tags topics next 1:1, tags: tags topics next 1:1
        17.10.145 tags topics next 1:1, tags: tags topics next 1:1
        17.10.146 tags topics next 1:1, tags: tags topics next 1:1
        17.10.147 tags topics next 1:1, tags: tags topics next 1:1
        17.10.148 tags topics next 1:1, tags: tags topics next 1:1
        17.10.149 tags topics next 1:1, tags: tags topics next 1:1
        17.10.150 tags topics next 1:1, tags: tags topics next 1:1
        17.10.151 tags topics next 1:1, tags: tags topics next 1:1
        17.10.152 tags topics next 1:1, tags: tags topics next 1:1
        17.10.153 tags topics next 1:1, tags: tags topics next 1:1
        17.10.154 tags topics next 1:1, tags: tags topics next 1:1
        17.10.155 tags topics next 1:1, tags: tags topics next 1:1
        17.10.156 tags topics next 1:1, tags: tags topics next 1:1

    17.11 Templates

        17.11.1 Meeting invite

background:


pre-meeting:

objective:


        17.11.2

    17.12 important meetings

        17.12.1 scrum best practices
Hi,

Thank you all for joining and participating. 
meeting minutes:
- DoD, for now remains as is. I'll try to clarify automated E2E scope and re. performance tests - attempt for us to have a production like test environment for our team.  
- Dailies should be aligned with Scrum best practices. Should be owned by the developers. Anyone can join, only devs participate and ScM facilitates the discussion
They should be on same time everyday.
I will communicate that this is how our team would like our dailies to be
- sprint reviews. general feeling is that they are ok and to the point 
- Retrospectives  should be aligned with Scrum best practices. I'll schedule them to either Thursday after review or next Monday (to allow Shelly to participate)

Thanks!
Yosi


    17.13 CAM profiles

        17.13.1 git developers profiles
developers profile: GitHub Profiles that you will be its approvers
BTP Portals Git Team SaaR PROD

Scrum Masters CAM profile I had to request (I also requested for jawad)
BTP Portals Git Saar Approvers

Saar and Eman are the approvers for this approver group requests
 
 
        17.13.2

    17.14 appreciation, tags: appreciation, rewards 
search, https://search.int.sap/results#t=appericiation 
https://xs02a6fd67e86.hana.ondemand.com/JobPts/Mobile/DareMat.html#home_screen

        17.14.1  list of appreciated team members
a. 23/05/22 15:58:13  Adam
Adam has an outstanding contribution to the teams task. He also excels as security lead and goes above and beyond his designated tasks to make a very positive impact on the team's results. 
He also bring a sharp mind and positive attitude to every interaction.
  

        17.14.2
    17.15 Team sergey 
team page: https://wiki.wdf.sap.corp/wiki/display/CPPortals/Team+Sergey
dispatch duty: https://wiki.wdf.sap.corp/wiki/pages/viewpage.action?pageId=2215167982
capacity: 


    17.16 tags: developers cost reductions

        17.16.1 06.2022 cost-reduction

            17.16.1.1 email to team
From: Izaq, Yosi <yosi.izaq@sap.com>
Date: Thursday, 23 June 2022 at 17:42
To: DL BTP Core AP UE Services IL Team Yosi <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>, Margieh, Jawad <jawad.margieh@sap.com>
Subject: cost reduction team yosi

Hi,
 
We are going through a cost reduction effort. Cost of our systems (spaces, SA etc) has risen from 5.8k eur on Feb to 8.3k on May.
Jawad has helped me examine where we can save costs via a simple 5-20 minutes procedure everyone should perform on their space. Thank you Jawad!.
The procedure is something like:
Reduce all apps and services to one instance. If more or needed for specific test you can raise ofc. Just plz reduce to one instance after you’re done
Delete unused apps
Delete unused services. Esp. PG and Redis not hyperscaler
Import, export, Mock provider reduce memory to 512MB
Reduce memory of other apps. Most apps don’t really need 2048MB on dev space…
Stop all deployers. Everything xxx-deployer-yyy
Delete app ‘manifest’ if exists on your space
 
Ex:

Only keep the hyperscaler…
 
Jawad and I already performed on our spaces. It took a few minutes.
 
I’d like to ask everyone to please perform this ASAP (within your priorities and tasks ofc). Once done please LMK.
It is important to save us costs.
 
@Margieh, Jawad, Redis is very costly (~ 1.8k euro). Do you have an idea how it’s compared to solace? (since we’re using it for pub-sub not cache IIRC)
 
Thanks!
Yosi
 
            17.16.1.2 Shani delete space script
[15:50] Ben Hefer, Immanuel
Hi Yosi, I understand from Shany your team is planning to delete old spaces.
This is the delete-script you can use: https://github.wdf.sap.corp/Portal-CF/delete-space-script

I'm updating the readme with a link to a recording on how to use the script.
Will probably be merged tomorrow.
Let me know if you need any help.

                17.16.1.2.1 readme

                    17.16.1.2.1.1 intro
The following script intends to cleanup UAA clones, saas-registry subscriptions and deprovision relevant services in order to make space deletion possible.

(!) Before you run any part of the script, please review the following recording.

(!) If you're deleting a space you're an admin of -> skip to 'Deletion of space'

(!) If you encounter errors or failures in the script, check this wiki for more information on the errors.
                    17.16.1.2.1.2 requirements
Node v14.x
This package requires version 14 of Node.js. If you are developing with older version of Node.js and want to use this package you can use nvm to manage your Node.js versions.

Cloud Foundry CLI v7.x
This package requires at least version 7 of the Cloud Foundry CLI. To switch versions: version switching guide

You will need to be logged in with your CF account first.

                    17.16.1.2.1.3 installation
npm install delete-space-script -g

If installation fails, try to install the package using the following command:
npm i -g
npm link

                    17.16.1.2.1.4 Delete space 
You need to be logged in with your CF account first
You need to be an admin of the space you're deleting
Make sure the portal-cf-broker-service is running
Remove all active subscriptions from all consumers

single command:
$ delety space <SPACE>

Delete space - breakdown
|   0. Choose space
|   $ cf t -o <ORG> -s <SPACE>
|   1. Unsubscribe subscriptions from all products
|   $ delety unsubscribeAllTenantsOfAllProducts
|   *1. Unsubscribe subaccount from specific product (skip if previous step was successful)
|   $ delety unsubscribeAllTenantsOfProduct <APPROUTER>
|   
|   EXAMPLE -> $ delety unsubscribeAllTenantsOfProduct launchpad-dt-approuter
|   2. Unsubscribe all PaaS tenants
|   $ delety unsubscribeAllPaasTenants
|   3. Delete saas registry with plan 'application'
|   $ delety deleteSaaSRegistryPlanApplication
|   4. Delete authorization with plan 'application'
|   $ delety deleteAuthorizationPlanApplication
|   5. Deprovision all FDC and Personalization instances (also deletes UAA clones)
|   $ delety deleteFdcAndPersClones
|   6. Delete Portal service
|   $ delety deletePortalService
|   Make sure ALL instances of plan Portal are DELETED!
|   
|   7. Delete saas-registry with plan 'service'
|   $ delety deleteSaasRegistryPlanService
|   8. Delete authorization with plan 'broker'
|   $ delety deleteAuthorizationPlanBroker
|   9. Unbind all services from all applications
|   $ delety unBindAllServices
|   *9. Unbind all services from specific application (skip if previous step was successful)
|   $ delety unBindService <SERVICE>
|   10. Delete all keys from all services
|   $ delety deleteAllServicesKeys
|   *10. Delete all keys from a specific service (skip if previous step was successful)
|   $ delety deleteServiceKeys <SERVICE_NAME> <SERVICE_PLAN>
|   11. Delete all services
|   $ delety deleteAllServices
|   12. Delete all applications
|   $ delety deleteAllApps
|   13. Delete space routes
|   $ delety deleteSpaceRoutes <SPACE>
|   14. Delete space (aka cf delete-space org spaceName)
|   $ delety deleteSpace <SPACE>
|   Make sure you have the right permissions to delete the space.

get subscriptions:
$ delety getSubscriptions <approuter>

                    17.16.1.2.1.5
                17.16.1.2.2 cf cli version swiching
https://github.com/cloudfoundry/cli/wiki/Version-Switching-Guide
Version Switching
The GA'd v7 cf CLI binary is named cf7, and there is a symlink from cf -> cf7.

The GA'd v8 cf CLI binary is named cf8, and there is a symlink from cf -> cf8.

Workflows that require switching between different versions of CLI can be scripted to accommodate utilizing binaries of the same name on a single computer.

Below you'll find instructions for each of the package managers we support.

Note: All the instructions described bellow can be done with any pair of versions. For example:

v6 and v7
v7 and v8
v6 and v8.
Switching CLI versions Using Brew
Assuming you've installed both wanted versions e.g. v6 and v7...
brew install cf-cli@7
brew install cf-cli@6
Switch from v6 to v7:
brew unlink cf-cli@6 && brew unlink cf-cli@7 && brew link cf-cli@7 && cf version
Switch from v7 to v6:
brew unlink cf-cli@7 && brew unlink cf-cli@6 && brew link cf-cli@6 && cf version
Switching CLI versions Using Yum or Apt
We're working on a robust soluiton that will faciliate more seamless switching via these package managers, but for now you must uninstall one version of the CLI and install the other version of the CLI to switch between them.

Currently on v6, want to switch to v7:
yum: sudo yum remove cf-cli && sudo yum install cf7-cli && cf version
apt: sudo apt-get remove cf-cli && sudo apt-get install cf7-cli && cf version
Currently on v7, want to switch to v6:
yum: sudo yum remove cf7-cli && sudo yum install cf-cli && cf version
apt: sudo apt-get remove cf7-cli && sudo apt-get install cf-cli && cf version
Switching CLI Versions Pulled via GitHub or CLAW
The following is a simple approach:

Download the v6 and v7 binaries into separate directories
Write a scipt that updates your PATH so it points to the binary for the version of the CLI you need to run:
export PATH=/path/to/your/v6-or-v7/binary/:$PATH

                17.16.1.2.3
            17.16.1.3

        17.16.2

    17.17 Ariel-Guy synchs, Tags: Ariel-Guy synchs

        17.17.1 19/09/22 11:34:06  
my points:
- remove active subscriptions to allow delete of provider (we have many BCPs in which it blocks delete space or other operations)
ex: https://support.wdf.sap.corp/sap/support/message/2270119262
https://support.wdf.sap.corp/sap/support/message/2270036155
https://support.wdf.sap.corp/sap/support/message/2270027471
currently there's a FK constraint in DB (subscribers table to providers) - consider removing this constraint
Check if new option to hard delete space and documentation can help mitigate the issue
Ask Shany to write this guide (Talk 2 Sergey)
- security, gc, performance, product standard, java 8 end of support very soon. Todo: create BLI and send to Ariel
- Task Center related issue - what is required from my team?
- cdm-store <> cep-activation Events alignment 
We will need to add handling of all of these issues to to the support delta update BLI.
Specifically we need to add:
AI: Validate whether the group in the snapshot which has a cherry-picked application from the snapshot of apollo content provider and also is assigned to a local role is visible in the Launchpad RT site. @Izaq, Yosi
In case the above check we find that groups&catalogs are not visible in RT we need to proceed with: For content providers that doesn’t support delta Update – we should evaluate publishing events only for the cherry picked entities / (affected cherry picked entities). @Izaq, Yosi
If they are visible CDM store need to perform the calculation for generating the events. @Izaq, Yosi
RT Validations. @Adoram, Nili and @Shefer, Shany w/ support from @Izaq, Yosi team
aliasesMapping and ProvidersConfig resolving. Consider resolving in RT per entity. @Adoram, Nili and/or @Shefer, Shany w/ support from @Izaq, Yosi team
Ariel: aliasesMapping is saved by "old" site-service. It was tested ok. we need to understand if there are gaps.

Ariel points:
- KPIs & baseline for API performance. 
- MV performance implementation. Add performance on production like environment. We want joint work w/ performance team 
Remember to add AI on performance team 

        17.17.2 13/12/22 15:32:32  

        17.17.3 sync 28/12/22 15:34:56 
Ariel: 
- search by title,id, description 
according to jawad we return results sorted by modified at 
code: 
    @PostMapping(value = "/entities/search", produces = {"application/json"})
    public ResponseEntity<PagingResultResponseWrapper<JsonNode>> searchEntities(@RequestBody Search search,
                                                                                @RequestParam(value = "pageSize", required = false, defaultValue = "5000")
                                                                                        int pageSize,
                                                                                @RequestParam(value = "sortBy", required = false)
                                                                                        SortByValue sortBy,
                                                                                @RequestParam(value = "orderBy", required = false, defaultValue = "DESC")
                                                                                        OrderByValue orderBy,
                                                                                @RequestParam(value = "next", required = false)
                                                                                        String nextCursor) throws UnsupportedEncodingException, URISyntaxException, JsonProcessingException {
        logger.debug("searchEntities() POST /v2/entities/search called with search = {} pageSize = {} sortBy = {} orderBy = {} next = {}", search, pageSize, sortBy, orderBy, nextCursor);
        try {
            Instant searchStart = Instant.now();
            PageConfiguration pageConfiguration;
            if (nextCursor != null) {
                pageConfiguration = new PageConfiguration.Builder(nextCursor).build();
            } else if (search.getTextSearch() != null && sortBy == null) {
                pageConfiguration = new PageConfiguration.Builder()
                        .withPageSize(pageSize)
                        .orderedBy(orderBy)
                        .sortedBy(SortByValue.RELEVANCY).build();
            } else {
                pageConfiguration = new PageConfiguration.Builder()
                        .withPageSize(pageSize)
                        .orderedBy(orderBy)
                        .sortedBy(sortBy != null ? sortBy : SortByValue.UPDATED_ON).build();
            }
            final PagingResult pagingResult = entityService.searchEntities(search, pageConfiguration);
            PagingResultResponseWrapper pagingResultResponseWrapper = new PagingResultResponseWrapper<>(pagingResult, new PageConfiguration.Builder(pageConfiguration).build());
            pagingResultResponseWrapper.setNextLink("/cdm_store_service/cdm/v2/entities/search", "next");
            Instant searchFinish = Instant.now();
            long totalTime = Duration.between(searchStart, searchFinish).toMillis();
            double totalTimeInSeconds = totalTime / 1000.0;
            logger.debug("searchContext() POST /v2/entities/search Total time: {} seconds", totalTimeInSeconds);
            return new ResponseEntity<PagingResultResponseWrapper<JsonNode>>(pagingResultResponseWrapper, HttpStatus.OK);
        } catch (SearchException e) {
            logger.error("/v2/entities/search failed." + e.getMessage(), e);
            return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
        }
    }



Me:
- component for amqp-client  [Done]
- Cred Store E2E: [Done]
  -- E2E planning should start sooner, test scope for E2E sooner
  -- Feature-flag on all separate components  
  -- Environments for E2E 
  -- Automations 
  we should have a meeting w/ Olga
- semi automate apollo managed app-router tests (create mtar for team test, automate deploy undeploy, subscription etc) -> create task for both
https://jira.tools.sap/browse/EUXTEAMSAAR-3232
- Task for consumer account on EU12 LTS 

        17.17.4 14/03/23 16:48:42   
Ariel: 

- We need security fixes BLIs
https://jira.tools.sap/browse/DWPBUGS-2305
blocked PRs: 
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/910 
https://github.wdf.sap.corp/Portal-CF/portal-cf-cdm-store-service/pull/890 

-  We need a BLI for fix 
during work on    https://jira.tools.sap/browse/DWPBUGS-3267?filter=259181
We found that we  need to add the 'SaaS' and 'xsuaa' labels configurations (from VCAP service binding) loading to DTS deployer configuration (see: https://github.wdf.sap.corp/Portal-CF/portal-cf-design-time-service/blob/49d7f8e399a3d7297f7c0e7c67921b4a665860cf/src/utils/deployer_configuration.ts#L135)

- We need a BLI for adding automation coverage that cdm-store APIs are protected. 
 We need a BLI for adding automation security tests
needed after https://jira.tools.sap/browse/DWPBUGS-3439?filter=259181 


        17.17.5  18/04/23 15:24:25  
- label and close Medium and low bugs we don't plan to fix soon
- tenant-host-pattern change enhancement 
" 23.4 MoM
 
Change of tenant-host-pattern consists of:
Change provider entity (created by DTS)
Change cherry-picked apps system-aliases
Effected sites activation
Feature is too costly. Not worth it to invest in a to-be-deprecated flow
We should answer not supported in the tickets. https://help.sap.com/docs/cloud-portal-service/sap-cloud-portal-service-on-cloud-foundry/expose-your-app-as-content-provider suggest to open feature request or recreate
 
Adding  and  – We think that for now it would be efficient to document the supported procedure for changing tenant-host-pattern: recreate (unsubscribe, subscribe, re-deploy).
"
-

        17.17.6  02/05/23 17:12:45  
- We have another skip (6A). like in timelines 4.6-29.6
I want to align w/ u re. the T6 dates.

        17.17.7 1.6
- binding WZ RT app router https://jira.tools.sap/browse/DWPBUGS-4118, todo: open activity and send to Ariel-Guy
https://jira.tools.sap/browse/EUXTEAMSAAR-3420

- Redis task
Redis cleanup shany’s team - https://jira.tools.sap/plugins/servlet/mobile#issue/EUXTEAMYAEL-2114
    -- verify all writes are with TTL
    -- Verify on orphan data flow no deletes are called.
https://jira.tools.sap/browse/EUXTEAMSAAR-3421

- Odata compliance: Gerald: Re: Issue detected - RE: Question re: delta load: How is a deleted entity detected
HLEE: 1PD
To make the consumption of a deleted entity in a delta payload reliable, the check logic must be like this:
A deleted entity should be determined by the existence of an @odata.context ending in “/$deletedEntity”
This check must not depend on a “reason” property or its value
https://jira.tools.sap/browse/EUXTEAMSAAR-3422

-
        17.17.8 12/07/23 14:39:38  
- SonarQube integration (T8) Support Oren [Done] - email not relevant
- Move to CLS (cloud logging service). See note and email from Hani. Check w/ Oren


        17.17.9 22/08/23 14:49:19  
https://jira.tools.sap/browse/EUXTEAMSAAR-3506
- We need an urgent task to fix delete space / provider fail issue (b/c of active subscriptions)
  -- Issue: can't delete space or prvider.
  -- RC: There are active subscriptions. Sometimes its very hard to find and delete all
  Even using CIS API to get the list of active subscriptions 
  -- Impact: Stakeholders frustrated. Many tickets. bussiness activities and development delays.
  -- Proposed fix:
    provisioning service will allow to delete the provider (remove Foreign-key constraint) and will delete cascade (so that the subscribers who's subscribedTenantId matches the provider instance ID will be deleted)

https://jira.tools.sap/browse/EUXTEAMSAAR-3507
- BLI: Prefix topics solace to avoid race-condition. EE: S [Done]


- Ajv upgrade in cdm-schema [Done]
Hi Shany,

Its influence on SDOL-005 (OSS and 3rd Party Update and Maintenance Strategy).
It’s fine for me to leave this standard as “Fulfilled” only if Yosi’s Team fixes it in a short period of time(~2 months), otherwise POs need to get exception approval for it and we should change it to “Planned”. I agree with you that a temporary solution is not needed here.

-  missing knowledge Agenda: know apollo and html5 more in depth, suggested by Kalman
|Be able to make changes and troubleshoot better
|hands on, understanding the services involved  
| 1. Apollo intro session
| 2. hands on, setup apollo on dev spaces
| 3. advanced setups, should be done, no need in each dev space
|     global content provider
|     embedded content provider
| 4. common cases
|      how to check apps in html5 repo
|      why user can subscribe to module be the provider is not created in launchpad
|      cases when navigation fails, changing tenet host pattern
|5. how provisioning saves data my tenet and how does cdm store know who has access to what tenet
|6. hands on, rewrite html5 logic. write the logic in new service -> keep DTS, add toggle, if on call DTS, if off continue

https://jira.tools.sap/browse/EUXTEAMSAAR-3508
- New BLI 
    --Issues: Currently we use Redis pub sub which doesn't ensure retrieval of message which might lead to a provider being stuck on Updating status. 
There should be a bug open on Sergey 
Impact: Bad User experience / High Support effort
Solution: Move to Solace for publishing messages for a reliable messaging

        17.17.10 19/09/23 15:31:42  
- BLI for CMK FF removal, https://jira.tools.sap/browse/EUXTEAMSAAR-3544  [Done]
- Store CMK resilience  -cron jobs,  https://jira.tools.sap/browse/EUXTEAMSAAR-3535, hopefully in T11.  [Done]
- BLI for CMK resilience:  [Done]
    CDM store database related cron jobs should use an underlying class that will encapsulate data-source routing for CMK and non CMK tenants 
    to the corresponding data-source and PG instance.
    Then the current cron jobs (@Scheduler) should be updated to use it. Namely:
    a. cdm.store.service/src/main/java/com/sap/portal/cdm/store/event/scheduler/EventScheduler.java 
on event scheduler

    b. cdm.store.service/src/main/java/com/sap/portal/cdm/store/tasks/DeleteOldImportRecords.java 
Old imports delete 

    c. cdm.store.service/src/main/java/com/sap/portal/cdm/store/tasks/TemporaryFilesCleanup.java
unused code. remove. 

-
        17.17.12 03/10/23 15:39:19 
Ariel:
    - review not matching sign-off:  we can be flexible, we can add work items not in sign-off if we have idle time
    - export agents  

My topics:
        - https://jira.tools.sap/browse/DWPBUGS-4556, why open a bug for feature in development? [Done]
        - Who tested E2E flow for this?- RT side not covered 
        - [Security] cls-hooked https://jira.tools.sap/browse/EUXTEAMSAAR-3406
        - > 3000 relations
        

        17.17.13 10/10/23 15:43:40  
- https://jira.tools.sap/browse/EUXTEAMSAAR-3599, disk quota close to 100%, discuss w/ Meni
- 
        17.17.14 12/10/23 15:46:59  

        17.17.15 24/10/23 15:52:00 

-  cdm-store-service timeout  [Work In Progress]
I propose following steps. plz lmk if you are ok with that.
Immediate. Increase CDM store TO to something >= 6 mins. Ronen, we are concerned about memory impact of longer TO. will you be able to assist Jawad to check what is safe TO value? 
Jawad made a PR for this: https://github.wdf.sap.corp/Portal-CF/nestjs-common/pull/193/files
If we the TO increase direction is problematic we can move the ticket to Abap colleagues and ask them to check why such a huge sync and how it's possible to reduce it
Ariel, For the long run solution we will need a BLI to make the commit operation more scalable and aim for to handle at least 10k entities

Jawad: 
Logs show that the customer is trying to sync 9.6K entities, this is a quite huge content for syncing.
As a quick resolution I would propose to guide the customer to expose the new roles gradually – maybe forward the ticket to S4/ABAP colleagues?.
If not acceptable, we will need to modify the request timeout in the transport-service to allow syncing the content and unblock the customer.
 
For the long run, @Izaq, Yosi I think we need to handle make this scenario to be async to avoid further issues – maybe we can add this to our engineering backlogs.
Ticket:
https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/b8f9839083c2bd18eeb7a780ceaad3b5
 Logs:
https://logs.cf.us21.hana.ondemand.com/goto/b4a15a03f0c7f045586f575c13e5f4bb

- > 3000 limit, relatedroleassignments 
    -- add error code to section entityFailure

    --
-


-
        17.17.16 31/10/23 15:34:09  
- For the long run, @Izaq, Yosi I think we need to handle make this scenario to be async to avoid further issues – maybe we can add this to our engineering backlogs.
Ticket:
https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/b8f9839083c2bd18eeb7a780ceaad3b5
 Logs:
https://logs.cf.us21.hana.ondemand.com/goto/b4a15a03f0c7f045586f575c13e5f4bb

- 
        17.17.17  14/11/23 14:32:32  
- Transport agents design. Try to complete this sprint (on Thursday), but if not possible by end of next week (12A 1st week)

- https://jira.tools.sap/browse/EUXTEAMSAAR-3641, axios with version prior to 1.5.1 has vulnerability and repositories should upgrade to 1.6.0 and above 
- https://jira.tools.sap/browse/DWPBUGS-4843 ,postgresDT CPU Utilization almost 100% for ap10 and us10 
  team channel: postgresDT CPU Utilization almost 100% for ap10 and us10 
  "
Hi, we've discussed this in teams with Haviv, Tal , Cohen, Adam , Margieh, Jawad  and Adoram, Nili.

conclusions:

subaccount activation impl is actually not relevant for this jira
short term solution: increase TO portal-cf-activation-service get site. owner: activation, PR with 40 sec merged: https://github.wdf.sap.corp/Portal-CF/portal-cf-activation-service/pull/522 
mid-term optimize the query and make it more scalable. owner: cdm-store, https://jira.tools.sap/browse/EUXTEAMSAAR-3642
long-term is to stop activating the full site - an effort that Steffen Huester is leading (sorry, mention doesn't work for me)
Let's start w/ short term solution as first step.

I'll discuss with ariel a BLI for mid term solution.
  "
        17.17.18 21/11/23 15:27:52  
- Subject: Re: ng-router automation HO - Yosi's team

Hi,
As we saw in the meeting, most of changes related to the url :
DT url in ng should contain /sites path. , and so the parameters were aligned.
Can use the NGROUTER_TEST env variable
 
Next steps: consider adding / duplicating these missing tests:
 
jjb-LTS-CTMS-EXPORT-e2e
jjb-LTS-CTMS-IMPORT-e2e
jb-LTS-CUSTOM-DOMAIN-APOLLO-e2e
 
If duplicated, they need to be added here:
 
LTSNG jobs file:
https://github.wdf.sap.corp/Portal-CF/e2e-jjb/blob/master/JJB/definitions/test-includes/tests_ltsng.yml.inc 

- subaccount-activation
    -- Addon BLI for E2E performance + validations
    -- Joint testing on a dedicated subaccount 
    -- Dev space test with dump of LTS DB
    
- https://jira.tools.sap/browse/EUXTEAMSAAR-3639 - NG approuter E2E validation - cross teams followup:
  add three missing automations
DT url in ng should contain /sites path. , and so the parameters were aligned.
Can use the NGROUTER_TEST env variable
 
Next steps: consider adding / duplicating these missing tests:
jjb-LTS-CTMS-EXPORT-e2e
jjb-LTS-CTMS-IMPORT-e2e
jb-LTS-CUSTOM-DOMAIN-APOLLO-e2e
 
If duplicated, they need to be added here:
LTSNG jobs file:
https://github.wdf.sap.corp/Portal-CF/e2e-jjb/blob/master/JJB/definitions/test-includes/tests_ltsng.yml.inc

- https://jira.tools.sap/browse/EUXTEAMSAAR-3641?filter=-2 - [Security] XSSEC and axios vulnerabilities

        17.17.19 27/12/23 16:06:01  
no topics

        17.17.20 07/01/24 11:28:29  
- VH from Sven [Urgent & Important] Broken roles after changes in V2 exposure - Alon M
- 

        17.17.21 10/01/24 16:37:22  

        17.17.22 24/01/24 17:00:37  
- SIT0016928: Please, verify the reported security issue in workzone [Done]
Yosi: We have one direct dependency - cdm-store-client and a few indirect (dts, transport, provisioning). This is a small change but also requires monitor CI and validate the change is applied correctly.
It’s a small effort but not negligible so we will need to add a task for this.
What is the priority and timeline for fixing the issue?
 
Liraz: This PR should be thoroughly validated across all types of apps.
This will take into T2 with priority.
Once validated, we will notify all teams.
Link to task: EUXTEAMGUYM-5349.

Nili: created a task https://jira.tools.sap/browse/EUXTEAMNILI-7168

- Subject: Authentication Tests
Hi ScMs, In the past, we had an authentication issue in one of our service APIs. To proactively avoid such issues, we want to check if authentication tests are in place for all your service APIs. Please verify and reply if all your service APIs have authentication tests.  Thanks, Boris 

Add UT/IT for APIs to cover The most relevant test cases:
If an API gets a user token, the “x-attributes” should be ignored
Requests without JWT should be failed
- 
        17.17.23 28/02/24 16:41:06 

- Boris, audit log types alignment. we need task [Done]
- exposure v2 performance BLI [Done]
Jawad: "V2 Exposure / Content Manager issues followup" email
 Full exposure with delta provider using “ALL”  which was introduced as part of V2 exposure and is enabled for V1 exposure. Mainly, This feature is mainly used in case the provider become out of sync due to some errors in the Work Zone side

- golden path, new Apollo
        -- team responsibility:
a. Content channel LCM
    create content channel. Destination configuration and consume content from HTML5
        --
b. RT side, who owns the code, automation etc (Tal developed something in RT)

c. Trust between SA 

- SAA - Enhance API to support entity type and context  
  check EE for separate topic 

        17.17.24 06/03/24 16:59:54  
- https://wiki.one.int.sap/wiki/display/CPPortals/T02A+2024+Retrospective
BLIs are not well defined 
Should be functionally well defined
Should add to the BLI the "connection" to the actual requirement 
BLIs should be defined from the user story level
Also list dependencies 
Even if it's technical req. we need a template as a minimum
User story
External dependencies 

- 
        17.17.25 27/03/24 16:51:48  
        
- Import: http status code 422 in case of a not valid content package; cTMS / GACD  supports such an error response.
-  Matan team will will implement site export + import , Liraz content granularity + Shany agent (Evya), Shangchai team - cards agent
- preplanning on Tuesday 
- 
        17.17.26 next, , tags: ariel, next
        17.17.27 next, , tags: ariel, next
        17.17.28 next, , tags: ariel, next
        17.17.29 next, , tags: ariel, next
        17.17.30 next, , tags: ariel, next
        17.17.31 next, , tags: ariel, next
        17.17.32 next, , tags: ariel, next
        17.17.33 next, , tags: ariel, next
        17.17.34 next, , tags: ariel, next
        17.17.35 next, , tags: ariel, next
        17.17.36 next, , tags: ariel, next
        17.17.37 next, , tags: ariel, next
        17.17.38 next, , tags: ariel, next
        17.17.39 next, , tags: ariel, next
        17.17.40 next, , tags: ariel, next
        17.17.41 next, , tags: ariel, next
    17.18 Jira , tags: jira, permissions



        17.17.10 06/09/23 15:58:36   
- We need a BLI to stabilize our tests. Esp. those who use puppeter to validate (EMBEDDED-CONTENT-PROVIDER-TEST-e2e, HOSTED-CONTENT-PROVIDER-TEST-e2e)
- UX coverage is not relevant to our tests. It is ineffective w/ many issues. we should switch to API only
Where UX mocks are needed we can discuss with Liraz.
lets start with research BLI
- https://support.wdf.sap.corp/sap/support/message/2380127134 
ping pong between ops and product if CEP flag should be on in CN40, cpkg is not available in CN40 so user get's error when uploading package

- content-package auto sync gap
|1. Liraz: providerService: check provider type. if type is content-package then call /transport/content_package/token
|2. Yosi: Add /token endpoint to content_package controller. HLEE: S
|3. Ruwei: parse new headers:
//when calling to token
'Prefer' : 'odata.track-changes, odata.callback; url=<url_passed_from_provider_service>, maxpagesize=<some_page_size_number>';
'sap-cflp-callback-token' : '<the_token_from_provider_service>'
'sap-cflp-provider-id' : '<the_provider/context_id_from_provider_service>'


        17.18.1 give permissions to jira for developers
a. https://jira.tools.sap/plugins/servlet/project-config/EUXTEAMSAAR/roles
b. click add user to role
c. fill user name (auto complete), add developers role

    17.19 recognition 

        17.19.1 20/09/22 15:21:26  group meeting
Gil-Shikva
Ariel-Guy 
Boris-Lipmanovich
Tom-Schuller

        17.19.2 2023 EoY recognition, tags: 2023 EoY recognition
I think that Jawad should receive the recognition.
The reason is that Jawad is highly professional. He contributes more than BLIs
He developed and add features to portal CLI and also K6 testing
He is one of the main if not the main founders of Solace MQ in our product
He consults to other teams on performance, event messaging and DBs
He was CMK lead architect and did a great job
And although he does so much he finds the time to help his team members and people from other teams

        17.19.3
    17.20 Core meetings 

        17.20.1 Topics for next core meeting
S4 and workflow colleagues not picking up VH tickets even when it's clearly a bug in their component
https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/4b63713ddb6fd51033afb6b1f3961928 - 915067/2022 - workflow issue Escalated VH incident.
RC Deployment in AP10 didn't set app-host-id correctly for service instance

S4 exposure: SNOW Incident: https://itsm.services.sap/now/workspace/agent/record/sn_customerservice_case/adfc4cbf1b07519097d1a6c8bb4bcb1a
RC bug in exposure report


        17.20.2

    17.21 Scrum-of-scrums tags: Scrum-of-scrums topics, scrum masters

        17.21.1 30/01/23 16:08:25  
- WS runs only on master is a major inefficiency 
Example: multiple PRs commited in same day. All CI green. PR1, PR2, PR3.
Now PR1 brings mend high vulnerabilities and impossible to revert 

- Deprecation of cflinuxfs3 

        17.21.2 31/01/23 14:03:08  
- reduce escalating issues to higher management 
- [CEP] Support for custom domain based on IAS - Validation - done (https://jira.tools.sap/browse/EUXTEAMSAAR-3207) 
- Qgate, Nili test failure: 
 failing test is:  ACVAL-NILI-PORTAL-E2E-INTEGRATION #99
https://portalcfe2e.jaas-gcp.cloud.sap.corp/job/end2endTestJobs/job/ACVAL-NILI-PORTAL-E2E-INTEGRATION/99/
- 

        17.21.3 14.2 
- initiative: Cross-team knowledge transfer sessions. Say each team gives one per month
- RT error reports, like in DT 

        17.21.4 14/03/23 12:18:45  
- Load is increasing, dev velocity decreasing, customer satisfaction probably also decreasing 
We need a takt, better two to stabilize, improve performance and Scalable and our ability to troubelshoot 
logs, 
RT report 
schema validations
- security issue fix to live, also html5 automations 
- automations BLIs 
        
        17.21.5 06/06/23 13:47:36   
team started work on:
- Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp 
- [CEP] Performant APIs for CEP-activation 
- CDM-Store breaks eventual consistency  
CMK work in team is lowered in priority
for performance API we work closely w/ Nili's team 
No dependencies in other teams
Please LMK if anything is required from my team

        17.21.6 next Scrum-of-scrums topics, tags: next Scrum-of-scrums topics
- 
- Raise in Scrum-of-scrums: we need periodic joint activity to remove unnecessary feature-flags

        17.21.7
    17.22 EoY, end of year, yearly feedback review team members, tags: EoY, end of year, yearly feedback review assess team members

        17.22.3 EoY feedback template tags: EoY, end of year, yearly feedback review team members Template:

            17.22.3.1 Yosi 
Keep evidence:

Improve evidence:

Keep:
Improve:

            17.22.3.2 Kalman 
Keep evidence:
Improve evidence:

Keep:
Improve:



            17.22.3.3 Yoav 
Keep evidence:
Improve evidence:
Keep:
Improve:



            17.22.3.4 Shirly 
Keep evidence:
Improve evidence:
Keep:
Improve:



            17.22.3.5 Gil 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.3.6 Jawad 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.3.7 Hadar 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.3.8 Alon 
Keep evidence:
Improve evidence:

Keep:
Improve:


        17.22.0  2021 feedback
Sheli
    keep:
        friendly,
        good vibe attitude,
        dedicated, example: handling cases as dev duty
        thorough, example: her contribution to recent BLIs (like MQ lib) in test coverage
    improve: initiative,
        curiosity (want to learn new stuff/try work in new areas),
        pro activeness
 
Hadar
    keep: team spirit,
        willing to do everything (even unpopular tasks), example: accepting to help Sergey's team w/ UX BLI
        hard working and dedicated,
        can lead, examples: talks to me about big picture, subbing for me successfully
        motivated
    improve: initiative, challenge self to be more technical (learn code/concepts/languages etc), pro activeness
 
Gil
    keep: technical,
        curiosity,
        can handle everything you throw at him, example: complex refactor for content packages, cdm-store MQ events IT tests
        thinks outside the box
    improve: communication skills,
        adherence to corporate processes,
        tendency to over engineer
 
Adam
    keep: technical,
        curiosity,
        can handle everything you throw at him,
        think outside the box, examples: found out pg_trgm gin index usage to optimize ilike search
        very motivated,
        proactive,
        at ease with multitasking, example: on some days he will work on his BLIs, help w/ CI and automation issues and more
        helpful
    improve:
        acceptance of corporate processes,
        knowledge sharing (write wikis, document complex things)
 
Jawad
    keep: technical,
        curiosity,
        can handle everything you throw at him,
        knowledgeable, example: Basically everyone asks Jawad re. so many subjects
        very motivated, example: numerous times he takes work into late evenings and weekend
        proactive,
        at ease with multitasking,
        helpful, example: in recent barilla VH he jumped to help Sergey with the analysis
    improve: tendency to over engineer, inclined to write robust, complex solution (it's a plus except when code changes frequently and RoI on infra level code is low)
 
Yosi
    keep: friendly attitude,
        highly motivated,
        curiosity,
        hard working,
        knowledgeable, knowledge keeper (wikis, notes, guides etc). example: check https://wiki.wdf.sap.corp/wiki/display/CPPortals/Yosi%27s+Team. there's a KB section and lot's of resources and guides.
        loves to knowledge transfer, examples: ML session to Guy's team, docker workshop
        proactive, examples: push the envelop on FTS solution, Work on long term fix for HTML5 issues (didn't work - no enthusiasm to fix in another team), CDM store refactor push, push and participate in DB performance improvements
    improve: get all my job as ScM done efficiently
    ability to keep track on multiple moving objectives and parallel multitasking (not concurrent, that I do already)
    encourage team more,
        17.22.1 2022 

            17.22.1.1 self yearly feedback  


- Manage team efficiently. handle prioritization, interrupts etc while keeping a close eye on mood, morale and team spirit
- Help improve SAP brand by participating in student visits (lead the technical challenges)
- Support CEP development effort. help Optimize delivery development timeliness. Orchestrate/Lead cross team efforts on performance and architecture (event driven architecture gaps).
- Improve team knowledge. Expand our wiki and encourage team to document processes and knowledge
- Improve knowledge spread in and outside team. Gave technical sessions on Node 16, VIM and NodeJS conference highlights
- Participate in process to vastly improve customer Support efficiency with the highlight being the successful addition of Shany as support Engineer

            17.22.1.2 team yearly feedback

                17.22.1.2.1 Kalman
Keep: curious, quick learner, brave, forms bridges, helps to retain knowledge
Example: got into a complex BLI and managed to deliver in high quality
Cred store E2E validation - https://jira.tools.sap/browse/EUXTEAMSAAR-3212 

Improve: knowledge & proficiency in CDM-store

                17.22.1.2.2 Yoav
Keep: great team spirit, forms bridges, knows how to get help and is helpful
example: dived into cdm-store and learned a lot from Jawad. 
BLI: [CEP]: CDM Store – add "timestamp" attribute to all events - https://jira.tools.sap/browse/EUXTEAMSAAR-3108

Improve: knowledge & proficiency in all our services. Independence, to take or lead a BLI from A-Z

                17.22.1.2.3 Shirly
Keep: very experienced, methodical, helps retain knowledge, proficiency in security tools and processes
Example: Handle security issues and processes. Qgate, reports etc. 
See: https://jira.tools.sap/browse/DWPBUGS-3074, https://jira.tools.sap/browse/DWPBUGS-2693, 

Improve: ability to lead complex BLIs and bring to finish line fully closed, shorten time to get things done

                17.22.1.2.4 Gil
Keep: very experienced, highly talented programmer, writes high quality designs and code, helpful to others, not afraid of "dirty" work or "other teams" work
Example: led role ID w/ special characters E2E including UI changes. There were several BLIs on this. most recent: https://jira.tools.sap/browse/EUXTEAMSAAR-3055
Improve: take on a role of leader, become more engaged and set example, speak up and be heard more

                17.22.1.2.5 Jawad 
Keep: very experienced, highly talented programmer, writes high quality designs and code, gets things done quickly and in very high quality
Examples: K6 repo and KT https://github.wdf.sap.corp/Portal-CF/k6-load-testing, design and implement improvements to cdm-store, most recent being: [CEP] Implement materialized view for paginated search - Design ( https://jira.tools.sap/browse/EUXTEAMSAAR-3132)
Improve: clone? ;) - seriously: better time management, in face of constant barrage of things requiring attention. Also, delegate and grow the team around him so he's not a bottle-neck. Invest in writing more guides more manuals and do KT sessions to reduce the load on himself

                17.22.1.2.6 Hadar 
Keep: soul of the team, motivator, integrator of people, hard working and dedicated
Examples: Worked very well with other team members (ex: Handle special characters in CDM schema for Role IDs - https://jira.tools.sap/browse/EUXTEAMSAAR-2964)
worked on E2E validations which required a lot of interfaces (example: [CEP] E2E validation activities for beta release - Yosi's team - https://jira.tools.sap/browse/EUXTEAMSAAR-3100 )
Improve: Take and lead work on technically complex BLIs. Deepen technical and architectural knowledge of our technology stack and product


                17.22.1.2.7
            17.22.1.3
            17.22.2.1  Yoav
- Sometimes doesn't close things and leaves loose ends
- somewhat slow to complete tasks relative to other team members
- 
            17.22.2.2

        17.22.2 2023 

            17.22.2.1 Yosi
Continue:
    - lead topic. This year I lead the execution of CMK project. Project was very wide and complex but we made it on time and the project was successful
    - contribute to team success. 
        -- Incorporate feedback from the team on how to improve into our daily practice. Some examples:
            -- modify BLI assignments practice
            -- perform more frequent retrospectives
        -- become more involved in duty from downward side (triage bugs, intercept when no sufficient info, dive into logs/code etc) as opposed to upward side (prioritization, management etc)
        -- actively help devs - like the effort to create the new EU12 spaces w/ Boaz, Oren & Matan, or create CLI for migrations (which at the end I think Jawad will add to his CLI instead)
        -- perform PR CRs, help with designs (like export import agents)
        -- be in constant connection with team members. Understand their real life context and how it affects their job and be flexible and accommodating as possible
            Many examples of members w/ kids that need consideration, the war and its impact, tensions or performance anxiety etc

Improve:
    - Manage outside pressure or criticism on team members. Like that interaction between Nili,Olga,Pavel and Hadar
    - Be more sensitive to the more sensitive members of the team (e.g. Hadar) - come up w/ ways to make sure that sensitive team members feel content at work
    - Impress more firmly upon the team the sense that we are one united team and that I am a part of the team and there for them 

            17.22.2.2 Kalman
Did this year:
- upgrade to Node 18 - https://jira.tools.sap/browse/EUXTEAMSAAR-3201
- joint work on [CEP] Content package update - test automation - https://jira.tools.sap/browse/EUXTEAMSAAR-3167
- joint work on Admin UI - API to fetch snapshot and cherrypick entities for content explorer, https://jira.tools.sap/browse/EUXTEAMSAAR-3239
- CMK object store
- joint work on Setup Automation - Support Automatic Assignment of Provider roles to Sites - Imp - https://jira.tools.sap/browse/EUXTEAMSAAR-3290 
- joint work on [CEP] Support export / import - Enable Transport Agents - design - https://jira.tools.sap/browse/EUXTEAMSAAR-3136

Continue:
    - performs quality work. very attentive to details. Examples: Node upgrade, CEP test automation
    - can take a mission mostly from a-z. Great example: Node 18 upgrade which had challenges that Kalman overcame working with people outside our team  
    - passion for programming. wants to learn, attend conventions and write quality code using newest syntax

Improve:
    - Knoweldge in CDM-Store
    - Be able to lead a big BLI and deliver on time in quality - this year he participated in big BLIs but didn't lead or was able to deliver on time w/o last moment intervention by me and Meni. Example: setup automations BLI

Talk w/ Kalman 05/03/24 12:23:16  

            17.22.2.3 Yoav
Did this year:
- CMK validations CMK E2E validation  - https://jira.tools.sap/browse/EUXTEAMSAAR-3502 - Add deleted role to the report chunk for CDM store - https://jira.tools.sap/browse/EUXTEAMSAAR-3331 (actually still not complete)

Continue:
    - Good vibes in the team. very liked and team player
    - Passionate about working at SAP 

Improve:
    - Professional competence. This year he mostly worked on validations, duty (like the rest) and the deleted role bug (still not finished). For some reason/s his rate of completion is not high
    - overcome obstacles. needs to improve his strategy for dealing with "blockers". be it reach out to experts, investigate on his own when they're not available etc



            17.22.2.4 Shirly
Did this year: 
    - lead security
Jointly:
    - subaccount activation
    - [CEP] Support for custom domain based on IAS - Validation , https://jira.tools.sap/browse/EUXTEAMSAAR-3207
    - [CEP] Enable content package update https://jira.tools.sap/browse/EUXTEAMSAAR-3198 
    - Automate Custom Domain scenario with  federated  Apollo content , https://jira.tools.sap/browse/EUXTEAMSAAR-3284
    - Support Object store CMK in Node JS services - Design, https://jira.tools.sap/browse/EUXTEAMSAAR-3335
- CMK E2E validation  - https://jira.tools.sap/browse/EUXTEAMSAAR-3502
- Subaccount activation from CDM store - Design   - https://jira.tools.sap/browse/EUXTEAMSAAR-3505
- join BLI 	Subaccount activation from CDM store - IMP - https://jira.tools.sap/browse/EUXTEAMSAAR-3512

Continue:
    - leads security topic well. Examples, numerous security issues, tasks and BLIs
    - committed and compliant

Improve:
    - Technical expertise. Currently it doesn't seem like she can take a complex technical BLI from a-z w/o help. Examples: all the challenging technical BLIs she worked on were joint. And usually success was dependant on joining w/ a "strong" technically team member. I believe that this is an area in which Shirly can improve
    - Bring more innovation and imagination in work. Currently she tends to perform the tasks to the letter. Not always challenging the assumptions or the decisions in pursuit of a possibly better way. 

            17.22.2.5 Gil
Did this year: 
    - [CEP] Enable content package update https://jira.tools.sap/browse/EUXTEAMSAAR-3198 
    - Setup Automation - Automatic Assignment of Provider roles to Site - https://jira.tools.sap/browse/EUXTEAMSAAR-3280  
    - Setup Automation - Terminate the provider to site association removes the role assignment  - https://jira.tools.sap/browse/EUXTEAMSAAR-3504

Continue:
    - Gil is very capable technically and can tackle the most complex issue
    - Gil is helpful to other team mebers
    - He has very helpful insights re. code architecture, designs and implementation 
Examples: numerous but just this week, 21-27/12, he helped Yoav, Shirly and Hadar w/ complex technical issues and/or investigations

Improve:
    - Be more compliant with company policies and requirements. Examples: Showed discontent re new capacity format, or the way that dev duty work. A few months ago he was discontent b/c apparently he didn't understand or was content re. my role as SCM. 
    - Communications soft skill. Gil can improve how the things he works on are perceived / understood if he pays more attention to being responsive or reflecting status in the systems. Re. tickets, emails, etc.
Examples: His BLIs many times subtasks not updated. Tickets he fixed still open etc.


            17.22.2.6 Jawad
Did this year: 
Admin UI - API to fetch snapshot and cherrypick entities for content explorer, https://jira.tools.sap/browse/EUXTEAMSAAR-3239
Schema changes   - add keyword as mandatory on the tag section - https://jira.tools.sap/browse/EUXTEAMSAAR-3242
[CEP]Stable and Unique IDs for Elements of Work Pages - https://jira.tools.sap/browse/EUXTEAMSAAR-3238
Consume HTML5 applications from multiple subaccounts - https://jira.tools.sap/browse/EUXTEAMSAAR-3315
Support CMK and PGB in CDM store - Design  - https://jira.tools.sap/browse/EUXTEAMSAAR-3336
[CEP] Performant APIs for CEP-activation - https://jira.tools.sap/browse/EUXTEAMSAAR-3133
[security] Upgrade JAVA version and Spring Boot 3  -https://jira.tools.sap/browse/EUXTEAMSAAR-3360
joint work on [CEP] Implement agent orchestration - import - https://jira.tools.sap/browse/EUXTEAMSAAR-3645

Continue:
    - very high efficiency. he completed a lot this year. Everything he does is done efficiently and professionally
Examples: CMK design, DB perf optimizations, Java upgrade to name a few
    - very helpful to the team and external team members 

Improve:
    - Jawad loves to develop. He is less enthusiastic about other aspects of the product. Specifically duty and this year it has been a cause of friction. 
    Jawad can strive for a more holistic approach to development and invest in the duty with the added value he can bring as an architect 
Example: Jawad manifested his frustration with duty load indirectly in retros and private talks we had
    - It would be good to see Jawad more frequently in the office

            17.22.2.7 Hadar
Did this year: 
- CMK E2E validation  - https://jira.tools.sap/browse/EUXTEAMSAAR-3502
- Subaccount activation from CDM store - Design   - https://jira.tools.sap/browse/EUXTEAMSAAR-3505
- lead BLI 	Subaccount activation from CDM store - IMP - https://jira.tools.sap/browse/EUXTEAMSAAR-3512

Continue:
    - Hadar can be very positive to the team atmosphere and had such a period of time this year 
Example: prior to her maternity leave Hadar had a very positive attitude
    - Hadar is usually very committed to her tasks/BLIs
Examples: CMK validations, SA activation

Improve:
    - The flip side of Hadar as a positive factor is that she is very sensitive and sometimes suspicious of others intentions. This can lead to hear being disengaged, negative attitude, refusal to communicate with me etc.
Example:
During work on SA Activation Hadar became discontent and this manifested in attitude and incidents such as:
 subaccount activation BLI - She asked to take a meaningful BLI and I gave her the chance. 
        - Droped from a meeting re. her BLI validation (W/ Olga & Nili). No response to me, doesn't join when I call her 
        - lack of transparency in updates or not replying at all to my DMs re. status (as is evident in teams channel "[Yosi Team] RCT CMK validations")
        - on more than one occasion expressed refusal to cont. work on BLI
        - complaints/dramas in many interactions: With Olga, Adam, Pavel 
        - emotional responses like "I won't work on this/like this" 
        - for almost two days refused to update me re. status or pick up my calls / respond to my DMs
Hadar needs to find a way to improve her tolerance of other people and be less on the "defensive" and concentrate more on the professional aspects as a basis
It is welcome to express frustration and provide constructive feedback but this can not come on the expense of stop or drop in actual work or not communication with colleagues
    - Bring more innovation and imagination in work. Currently she tends to perform the tasks to the letter. Not always challenging the assumptions or the decisions in pursuit of a possibly better way. 
    She would many times choose the most minimalist solution and when presented with feedback to look "one step ahead" she would object and say it is too disruptive 
Example: In the SA Activation BLI I made some suggestion early on that she rejected. Ariel T and Adam asked for a small change (entity types payload) 
Hadar was strongly against. Claiming it's disruptive, will take a lot of time and so on
At the end all these additions are implemented b/c we learned that we need them

   

            17.22.2.8 Alon
Did this year: 
- CDM schema -  change  "path" as mandatory property in the indicatorDataSource  - https://jira.tools.sap/browse/EUXTEAMSAAR-3289
- jointly: CEP] content package automations - https://jira.tools.sap/browse/EUXTEAMSAAR-3167
- joint work on [CEP] Support export / import - Enable Transport Agents - design - https://jira.tools.sap/browse/EUXTEAMSAAR-3136
- joint work on [CEP] Implement agent orchestration - import - https://jira.tools.sap/browse/EUXTEAMSAAR-3645

Continue:
    - Alon is passionate about his work shows potential for great technical expertise
    - Alon makes up his own mind about things and not afraid to speak his mind 
    - Alon is willing to do what it takes to get the job done. When faced w/ an obstacle he'll try to find a way forward rather than switch to "I'm blocked" mentality

Examples:
    - I gave Alon many small tasks throughout the year. Sometimes outside of his main BLI. Alon always handled these fast and well.
    - In team forum or even in f2f talks Alon will process things, then make up his own mind. I witnessed this in various retros and discussions. He brings opinionated and logical arguments to the discussion

Improve:
    - Alon is somewhat intimidated by large BLIs esp. when a complex design is involved. I do believe that Alon can handle the former and I think he can take increasingly more complex BLIs and solo his first large design in the near future
Example: Alon expressed this sentiment when working on the Transport agents design

    - The flip side to Alon speaking his mind is that he may inadvertently "step" on someones toe. He may be perceived as overly confident or even intimidating to some team members (esp. Hadar). He should cont. to speak his mind but will do well to become more aware of other team members sensitivities and/or reactions so he can integrate more smoothly into the team
Example: Some comments made by Hadar when she expressed that Alon has neglected to credit her enough or came on as not considerate enough for other team members wishes or situation
I have also noticed that Alon is quite self confident, successful at everything he does and can come up as somewhat intimidation. This is mostly a good thing ofc. Just need to be aware that not all team members have same state in life, ambition etc.


        17.22.3 2024  EOY Reviews, tags: 2024  EOY Reviews

            17.22.3.1 Yosi 
Keep evidence:
Improve evidence:
Keep:
- Listen to the team and where appropriate push and implement accordingly
Evidence: Retro meetings improvements:
https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+Retrospective+2024
e.g. 
    - shorten dailies
    - Devs own BLIs E2E
    - Assignments improvements
and many more...

- Handle things in crisis  mode
Evidence: UIID provider ID hotfix internal channel escalation
    - Created channel for orchestration 
    - re-prioritized all my meetings and commitments to be on top of this fix
    - brain storm actual technical solution with Gil
    - Accompany until fix was proven and approved from which point Meni took the steering wheel

- Learn and educate on new technologies
Evidence: 
    - Took leading role in AI representing Ilan's group in local lab IL AI leadership
    - Gave sessions on AI and ML
    - Gave lecture at Reichman University and to students guild
    - Hosted technical sessions with visiting students on various occasions

- Practical, flexible and adaptable
Evidence: During 2024 really the only thing certain was change. We got last minute requests to change priorities from product.
We were forced on many occasions provide HLEEs quickly, sometimes when the details were not clear and adapt on the way 
to make the last moment changes work

- Shield the team from obstructions
  Evidence: in all recent escalation and hotfixes I created a channel for handling and took the role to communicate with Shiri and OPs

Improve:
- Listen more to the team, maybe start a new custom: 1:1 meeting with team members on a quarterly basis
- Consult more closely with Meni re. high visibility, possibly sensitive matters like email from Shiri etc
- 

            17.22.3.2 Kalman 
Worth mentioning:
T5A, Duty on first week. After three intensive days decided he doesn't want to work. 
Load at duty + reserve duty at IDF effected his personal life.

Keep evidence:

Improve evidence:
Keep:
- very technical
Evidence: handled numerous technical issues: upgrades, automation glitches and ofc import-export

- Curiosity and creativity
Likes to learn about new technologies and how to use them. 
Plenty of evidence in this area: Node22, new language features, new ways of doing things

- Dedication and hard work
Evidence: Completed a lot of tasks and BLIs in the past year. Will work late evenings if needed to complete tasks on time

Improve, sensitive:
- Work with other people in coordination. He has a habbit of working late evenings and many times he pushed PRs or did things that surprised the team or the people working with him.
- Lead people. In his work throughout the year he had opportunities to lead people, Natalia and Alon in many BLIs and in import-export. He did a great job technically but 
  he didn't fully take charge 
- Sensitive!! Improve attitude towards organization requirements. e.g. duty 
In T5A, Duty on first week. After three intensive days decided he doesn't want to work. 
Then on many occasions he couldn't do duty for this reason or another.
I actually got questioned about this from team members wanting to know if he is not doing duty

            17.22.3.3 Yoav 
Keep evidence:
Improve evidence:

Keep:
- Friendly attitude
- Not too picky on what he does

Improve, all sensitive! (Feedback should come from you):
- Arrive to dailies in office days. Daily on 11:05 and Yoav always missed due to public transportation. Maybe come up with a solution?
- Improve his delivery. In many BLIs and bugs he took considerably longer than expected. 
Evidence: 
- On the weeks he's on duty a lot of work accumulates to next week. In one specific week Shirly asked me to step in and I also had to add to retro agenda 
  what is expected from the dev on duty.
- His BLIs take longer than expected. 
  recent example:
  https://jira.tools.sap/browse/EUXTEAMSAAR-4275
  Estimate: 4 PDs.
  Took all sprint. Just yesterday (25.12) he was stuck with the validations and I helped him overcome the obstacle. 
- Compliance issues re. quality
  - I get this feedback from both Olga and him. They don't see eye to eye and I need to often intervene 
Evidence: re. bug https://jira.tools.sap/browse/DWPBUGS-7324, he was on duty and handled the bug. On 30.12 he asked Olga to check something on live.
It didnt make sense to Olga. According to her He called her on the evening and was nervous, raised his voice and insisted that as a dev he is wasting time and effort investigating this.
She also got the impression that he was not professional and knowledgable enough in the investigation.


            17.22.3.4 Shirly 
Keep evidence:
- her work on BLIs in T03-T05 has improved in terms of commitment and quality. 
  Her work on the local's schema in 4B
  The lightrun RC escalation
  handled well and professionally 

Improve evidence:
Keep:
- Can do attitude
- Not too picky on what she does
- good team spirit 
- dedicated, responsible and willing to help
- Upped her leadership game with taking an execution lead on topics. Evidence: led the UIID track
- Evidence: her work on BLIs in T03-T05 has improved in terms of commitment and quality. 
  Her work on the locale's schema in 4B
  The lightrun RC escalation handled well and professionally 

Improve:
- Take more responsibility. Lead more topics. More beefy than coordination of a migration.  
- sensitive! (Feedback should come from you): Be more conservative and "protective" of team dev effort. She "approved" two patches/hotfixes to Ruwei and Sascha. When I learned of this and entered 
  the details I was able to either postpone the request or eliminate it altogether. 
  The point that I manged to do so isn't important. The important thing is to push back on the requests and try to find ways to "save" team effort. 
  Only if absolutely necessary do we accept an escalation or last minute change.



            17.22.3.5 Gil 
Keep evidence:
Improve evidence:

Keep:
- Extremely technically gifted
- great problem solving skills
- source of knowledge in team
- Efficient and proactive

Evidence: all over the place and evident to all who work with him.

Improve, sensitive! (Feedback should come from you):
- Compliance to organization requirements. It's ok to provide constructive feedback but there's a way,a time and place to do so appropriately.
Derailing discussion in daily to a critique on product is a prime example. The feedback in essence is fine and helpful, however the way ( a bit aggressive), the time (daily) and the forum are not.
I too get this attitude or what seems to be a bit aggressive comments. I also notice this dynamic with other people as well.

- Seems to either not understand or maybe has problem to accept the execution model. I got time and again direct questions from him and dismissive responses/attitude towards me both in private and public.
The main points of friction seem to be:
a. What is my role as ScM. Either he truly doesn't understand my role or doesn't want to accept it.
b. We are not really a Scrum or work Agile
c. Team is not free to do as they want
- It has improved from past years but still Gil is perceived as a somewhat unexpected person - in the sense that some people are "afraid" he may "lash" at them (answer in an aggressive and dismissive way)I personally endured a few outbreaks over the year but as I'm very familiar with him and highly appreciate him as a colleague and friend I let it slide
Still IMO this attitude is holding him back from realizing his full potential, which I personally think is huge.

            17.22.3.6 Jawad 
Keep evidence:
Improve evidence:

Keep:
- Friendly attitude
- humble and practical 
- extremely technically gifted. 
- extremely knowledgable in everything related to our product, other products and technology in general
- basically he is a one of a kind asset
- his work is in top notch quality
- he doesn't require micro management. Just point at the objective and he'll figure it out

Evidence: where to begin. he's all over the place.
- Technically led GP integration from our side
- brainstormed and analayzed basically most if not all high priority issues related to DB, CDM-store, transport, etc.

Improve:
- He must find the way to offload his work. Really invest in growing team members to be able to replace him in specific areas.
  It's not an easy task but the current model of just ask Jawad is:
  a. not scalable
  b. puts a lot of pressure on him
  c. puts the team in rough spot when he's OOO
  d. takes from his ability to invest his time in more important things

Meni, If you are interested I had a back and forth session with AI tool to help me create an extensive KT plan. This is the final result:

**Phase 1: Assessment and Planning (1-2 Weeks)**

| 1.  **Identify Knowledge Gaps:**
|     *   **Surveys/Interviews:** Conduct anonymous surveys or one-on-one interviews with team members (including the architect/tech lead) to understand:
|         *   What specific areas of expertise does the architect/tech lead possess that others lack?
|         *   What are the most frequent questions or requests they receive?
|         *   Which areas are causing the biggest bottlenecks?
|         *   What skills do team members *want* to develop?
|     *   **Analyze Support Tickets/Communication Logs:** If you have a ticketing system or communication logs (e.g., Slack history), analyze them to identify recurring issues or questions directed at the architect/tech lead.
| 2.  **Prioritize Knowledge Transfer:**
|     *   Based on the assessment, create a prioritized list of knowledge areas to be transferred.
|     *   Focus on areas that:
|         *   Create the most significant bottlenecks.
|         *   Are most critical to the project's success.
|         *   Align with team members' development goals.
| 3.  **Choose Knowledge Transfer Methods:**
|     *   Select appropriate methods based on the type of knowledge, team size, and learning styles. (See methods in Phase 2 below.)
| 4.  **Create a Timeline:**
|     *   Develop a realistic timeline for implementing the knowledge transfer plan.
|     *   Break down the plan into smaller, manageable steps.
|     *   Set milestones to track progress.
| 5.  **Communicate the Plan:**
|     *   Clearly communicate the plan to the entire team, including the architect/tech lead.
|     *   Explain the goals, benefits, and expectations.
|     *   Address any concerns or questions.
| 
| **Phase 2: Knowledge Transfer Implementation (Ongoing)**
| 
| Here are various methods you can combine, starting with quicker wins and progressing to more involved techniques:
| 
| **A. Documentation and Self-Service Resources:**
| 
| 1.  **Internal Wiki/Knowledge Base:**
|     *   **Architect/Tech Lead:** Dedicate time for them to document key concepts, design decisions, common troubleshooting steps, code standards, and architectural diagrams.
|     *   **Team:** Encourage everyone to contribute to the knowledge base as they learn.
|     *   **Tooling:** Confluence, Notion, GitHub Wiki, Read the Docs, or even a shared Google Drive folder.
| 2.  **FAQ Document:**
|     *   **Architect/Tech Lead:** Create a living document of frequently asked questions and their answers.
|     *   **Team:**  Add to the FAQ as new questions arise.
| 3.  **Code Comments and Documentation:**
|     *   **Architect/Tech Lead:** Lead by example, writing clear, concise, and informative code comments and documentation (e.g., Javadoc, docstrings).
|     *   **Team:** Enforce code comment and documentation standards during code reviews.
| 4.  **Runbooks/Playbooks:**
|     *   **Architect/Tech Lead:** Document standard operating procedures (SOPs) for common tasks, such as deployments, troubleshooting, or incident response.
|     *   **Team:**  Use and update these runbooks as needed.
| 
| **B. Active Training and Mentorship:**
| 
| 1.  **Pair Programming/Mob Programming:**
|     *   **Architect/Tech Lead:** Regularly pair with other team members on tasks, especially those involving complex or unfamiliar areas.
|     *   **Team:**  Rotate pairing partners to expose everyone to different skills and perspectives.
| 2.  **Mentorship Program:**
|     *   **Architect/Tech Lead:**  Formally mentor one or two team members, providing guidance and support in specific areas.
|     *   **Team:** Mentees should actively seek guidance and apply what they learn.
| 3.  **Lunch and Learns/Tech Talks:**
|     *   **Architect/Tech Lead:** Prepare and deliver short presentations on specific topics.
|     *   **Team:** Encourage others to present on topics they are learning.
| 4.  **Code Reviews as Learning Opportunities:**
|     *   **Architect/Tech Lead:** Provide detailed and constructive feedback during code reviews, explaining the "why" behind decisions.
|     *   **Team:**  Actively participate in code reviews, asking questions and learning from others' code.
| 5.  **Shadowing:**
|     *   **Team:** Allow team members to shadow the architect/tech lead during important meetings, design sessions, or troubleshooting calls.
| 
| **C. Delegation and Empowerment:**
| 
| 1.  **Gradually Delegate Responsibilities:**
|     *   **Architect/Tech Lead:** Identify tasks or decisions that can be delegated to other team members.
|     *   **Team:** Provide support and guidance to those taking on new responsibilities. Start with smaller tasks and gradually increase complexity.
| 2.  **"Office Hours":**
|     *   **Architect/Tech Lead:**  Set aside specific times for "office hours" when team members can ask questions. This helps to consolidate interruptions and makes their time more predictable.
| 3.  **Create a "Go-To" Person Rotation:**
|     *   Rotate the responsibility of being the first point of contact for specific areas or systems among team members. This helps distribute the load and gives others a chance to become experts.
| 
| **Phase 3: Monitoring, Evaluation, and Iteration (Ongoing)**
| 
| 1.  **Track Progress:**
|     *   Monitor the effectiveness of the knowledge transfer methods.
|     *   Are team members becoming more self-sufficient?
|     *   Is the architect/tech lead's time freeing up?
| 2.  **Gather Feedback:**
|     *   Regularly solicit feedback from the team on the process.
|     *   What's working well? What could be improved?
| 3.  **Adjust the Plan:**
|     *   Be prepared to adjust the plan based on feedback and results.
|     *   Knowledge transfer is an ongoing process, not a one-time event.
| 
| **Important Considerations:**
| 
| *   **Architect/Tech Lead Buy-in:**  It's crucial to have the architect/tech lead's support and active participation. They need to understand the benefits of distributing their knowledge (e.g., reduced workload, more time for strategic tasks, team growth).
| *   **Time Commitment:** Knowledge transfer takes time and effort. Allocate dedicated time for documentation, training, mentoring, etc.
| *   **Team Culture:** Foster a culture of learning, collaboration, and knowledge sharing. Encourage questions and create a safe space for team members to ask for help.
| *   **Incentives:** Consider recognizing and rewarding team members who actively participate in knowledge sharing, both as learners and teachers.
| 
| By implementing this plan, you can effectively distribute the architect/tech lead's knowledge, empower your team, reduce bottlenecks, and improve overall team performance and resilience. Remember that it's an iterative process, so be patient, gather feedback, and adjust as needed.
| 





            17.22.3.7 Hadar 
Keep evidence:
Improve evidence:
In T03 wasn't happy with assignment to Golden path. She took offense and made some unsavory accusations. After that she was sulky and uncommunicative with me.
I had to wait it out and she returned to functional communication
02.07 She had a complete meltdown over something she perceived as not ok by me (there was a high priority issue she was working on and I tried to call her to get her status but she was not answering, later she admitted she didn't answer on purpose). She then sent me extremely inappropriate and offensive whatsapp messages.
After consultation with you Meni and after we had a meeting in which she has apologized to me I've decided not to file an HR ticket and wait to see if there's improvement
Since then we have a cordial and professional working relationship which is good but unfortunately I find it hard to fully trust her not to explode or take offense at what are
basically run-of-the-mill day to day interactions and decisions I have with her.

Keep:
    - She is very committed to the team and when she is content she is a very beneficial member of the team that contributes to the team spirit, help organize integration events etc
    - She is responsible and works professionally on her missions
    - She is quite good at doing developer duty and handling internal and external tickets
    - She is quite friendly and well connected 
Improve:
    - Attitude and compliance. The flip side of the coin is when she is not content or is offended (which may happen frequently because of her sensitive nature) she can become a toxic person
Evidence:
a. In T03 wasn't happy with assignment to Golden path. She took offense and made some unsavory accusations. After that she was sulky and uncommunicative with me.
I had to wait it out and she returned to functional communication
b. on the 02.07 She had a complete meltdown over something she perceived as not ok by me (there was a high priority issue she was working on and I tried to call her to get her status but she was not answering, later she admitted she didn't answer on purpose). She then sent me extremely inappropriate and offensive whatsapp messages.
After consultation with you Meni and after we had a meeting in which she has apologized to me I've decided not to file an HR ticket and wait to see if there's improvement
Since then we have a cordial and professional working relationship which is good but unfortunately I find it hard to fully trust her not to explode or take offense at what are
basically run-of-the-mill day to day interactions and decisions I have with her.
c. around these time frames she created a lot of tension in the team ceremonies, especially during the retrospective meetings. From my PoV it seemed like she was abusing the ceremonies in order
to "settle the score" with me on things she took offense on. That led to a lot of tense and toxic ceremonies and actually to me, as her scrum master, not feeling at ease and 100% safe from toxic rhetoric around her
d. At some occasions it seemed like she would consult with Gil and sort of reach decisions with him without updating me. At times I was informed of this, to my surprise, only in the daily
I want to add that after the mentioned incidents there's an improvement in Hadar's work and attitude and we are able to work professionally together

    - Work with all team members. I've noticed a tendency to work with specific people, most notably Gil. 
Evidence: Our assignment over the year

            17.22.3.8 Alon 
Keep evidence:
Improve evidence:

Keep:
- Friendly attitude and positive can-do responses. Also noticeable in interactions with non team members.
Evidence: I vouch for that and I got this feedback from the team members, Bussi, Olga, Ariel and basically all who worked with him

- Owns his tasks fully. doesn't need much micromanagement. Can be entrusted to achieve his goals in an efficient and responsible way. 
Evidence: his work on the SAA improvements BLI, his help in escalations most recently in AP12
- Proactive, he notices things outside of his immediate task
Evidence: Detected events table issue ahead of time, raised the flag on AP12 poor shape prior to the outage

- Technical, gained a lot of knowledge over this year and good at problem solving.
Evidence: his contribution this year to team acheivements

- Committed and responsible.
Evidence: The pace (fast) and quality of his work as is evident in all the tasks and BLIs he worked on this year

Improve:
Meni, note/ask from me here. We must keep Alon with us. His contribution to the team surpasses our expectations and exceeds even some of the senior devs in the team!
IMO, if he stays w/ us he can reach high. Either technically or as a leader.

- Start to lead. Either drive a major BLI, lead a topic execution,  
- Innovate and push for the things he believes are best. Suggest improvements, maybe PoC and "sell" his ideas/suggestions.
- Learn and Teach new technologies, language features, tips and tricks etc
            
        17.22.4 2025 EoY feedback, tags: 2025 EoY feedback
            17.22.4.1 Yosi 
Keep evidence:

Improve evidence:

Keep:
Improve:

            17.22.4.2 Kalman 
Keep evidence:
Improve evidence:
- 1st week of Jan 2025, was on duty. moved tickets without consulting with Shani. 
  Some moves where unjustified and fired back at us
  Others caused Shani to lose track of tickets she was working on
  he also filtered for a component our team is not responsible for: provisioning
- Same week and week after. He handled a VH jira: https://jira.tools.sap/browse/DWPBUGS-7363
He got "stuck" and wrote "fails due to UI issue" - which were not at all the root cause.
I asked him to seek guidance from Gil but it didn't happen until I stepped in and asked Gil to help.
- GP issue, Omer asked for meeting https://jira.tools.sap/browse/DWPBUGS-6861, https://itsm.services.sap/now/cwf/agent/record/x_sapda_devinc_development_incident/c660728647ad5e9481b187c5536d4383
  Omer asked on 15/12 but didn't happen ( I'm writing this at 14/01/25 18:29:42  )
  I've asked Kalman to finish handling the GP issue as he started to work on it. I've asked him time and again to setup the meeting and continue the investigation.
  on 15/01/25 11:38:34  Kalman told me that he doesn't want to work on this any more.  
  I didn't press as I wanted to consult with Meni first and maybe more importantly have someone who actually wants to solve this work on this. 

Keep:
Improve:



            17.22.4.3 Yoav 
Keep evidence:
Improve evidence:
Keep:
Improve:



            17.22.4.4 Shirly 
Keep evidence:
Improve evidence:
- Compliance, responsibility
  - on 27.2.2025, Kalman was on duty. He complained throughout the week about his family not feeling well. This morning he took sick day.
    Shirly is on duty the week after and working on a BLI (https://jira.tools.sap/browse/EUXTEAMSAAR-4396) that is cross team and other team are in a one Takt delay so no pressure on us.
    I asked her to replace Kalman for one day and get it back next week.
    She told me she can't since she is not feeling well.
    I asked if she will take a sick leave.
    She answered no, I will work on my BLI.
    I found it strange that she picks and chooses what she wants to do. Which is something she just recently complained to me that Kalman is doing.
    I called her and she was very much against doing the duty. She suggested that I will do it, on top of all of my work as ScM (and the fact that I'm anyway supporting the duty effort and that it was comminicated to the team many times that I am not part of the duty roster). I've explained to her that its not a reasonable ask and explained the same that was explained many times to the team.
    She also mentioned that she had a lot of interrupts lately. I asked her which? She told me she had to fix an urgent bug (fix regression: https://jira.tools.sap/browse/DWPBUGS-7665 )
    I was speechles. This interrupt was caused b/c of code merged for her BLI, that could have been caught by a simple test on space. So not only did she merge to master before test-scope ready or validations on space and broke all E2E on LTS. She didn't feel it's her responsibility to fix it as part of her BLI :(
    I let her do as she pleases and asked Alon to replace Kalman for the day. He said yes immediately, as does each team member when I ask him to substitute for one day.
    It feels like Shirly feels entitled to do as she pleases and instead of communicating to me that she simply doesn't want to do duty this one day she makes up excuses and fires in every direction.
    I was left dissapointed by her handling of this and her lack of sense of responsibility for regressions her BLI causes. 
-
Keep:
Improve:



            17.22.4.5 Gil 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.4.6 Jawad 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.4.7 Hadar 
Keep evidence:
Improve evidence:

Keep:
Improve:

            17.22.4.8 Alon 
Keep evidence:
Improve evidence:

Keep:
Improve:


        17.22.5 2026 EoY feedback, tags: 2026 EoY feedback

    17.23 Ilan and the Scrum-masters, tags:Ilan and the Scrum-masters

        17.23.1 09/05/23 14:25:10  
- SRE hackathon

dev ve
- Feature teams 
- reduce dev meetings 
- reduce processes overhead. less estimates and over-planning. more fluid execution
- motivation. support 

We have 15% for SRE since maybe T8

        17.23.2 29/08/23 14:37:57  

        17.23.3 next meeting, tags: Ilan and the Scrum-masters next meeting
Ilan:
    - cost savings measures. Training's etc
    - Pablo, Engineering excellence champion, feedback on us
    - next deliveries, kernel service for sap-start 8B. CMK - 10A

Qs asked:
    Shany: support load increasing 
    AIs: separate 
Qs not asked:
- Sunday office - 
    -- since when?
    -- heavy traffic
- What is Orit "job description"?- Are we not understuffed in PO area
- More support eng. Continuity 

        17.23.4
    17.24 Send dev on duty meetings, tags:Send dev on duty meetings, 

        17.24.1 create a new meeting
Subject: [Yosi's team on duty] Gil + Shani
Set Full day
Set free
set attendee options -> do not request response
send to: DL BTP Core AP UE Services IL Team Yosi <DL_54A4ECBEFD84A039FB00000E@global.corp.sap>; DL BTP Core AP UE Services IL CF Core Extended <DL_59FB13B87BCF8431D7000219@global.corp.sap>; DL BTP Core AP UE Services IL Team Yosi Extended <DL_56BC7CDF7BCF84C731000087@global.corp.sap>; Shorer, Shani <shani.shorer@sap.com>; DL BTP Core AP UE Services IL Group Meni <DL_54A94DAFDF15DB2425000007@global.corp.sap>


    17.25 sap appreciation gifts , tags: sap appreciation gifts 

        17.25.1 app link
https://sapit-hr-prod-jobpts-web-mt-sap-prod.cfapps.eu10.hana.ondemand.com/social_feed


        17.25.2 sap appreciation gifts  log, tags: sap appreciation gifts  log
https://sapit-hr-prod-jobpts-web-mt-sap-prod.cfapps.eu10.hana.ondemand.com/sent_awards

| 23.5.22: Adam-Cohen
| 15.12.22: Shani-Shorer
| 19.12.22: Ariel-Guy, Kalman-Labinsky
| 7.6.23: Yoav-Fried

    17.26 QPE, Olga-Avrahami, sync tags: QPE Olga-Avrahami, sync 

        17.26.1  QPE, Olga-Avrahami,next sync tags: QPE Olga-Avrahami, next sync 
- UX coverage is not relevant to our tests. It is ineffective w/ many issues. we should switch to API only

        17.26.2
    17.27 Support-Engineer, Shani-Shorer  sync tags: Support-Engineer, Shani-Shorer  sync 

        17.27.1 Support-Engineer, Shani-Shorer  next sync tags: Support-Engineer, Shani-Shorer  next sync 

        17.27.2

    17.28 Signoff,  tags: Signoff

        17.28.1 signoff process, tags: signoff process
- request capacity from team. 
  ex: https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2023+T09+Capacity

- planning meeting, led by PO (Ariel-Guy)
ex: https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+team+T2309

- breakdown meetings on first day of Takt. No need for daily.
Can also do assignments meeting

- prepare sign-off preview email to Meni-Tito, Ariel-Guy, Dana-Sarfati 
Copy BLIs table from "public sign-off" section of sign-off wiki (ex: https://wiki.one.int.sap/wiki/display/CPPortals/Yosi%27s+Team+2309+Sign-Off)
to excel template first, /Users/i500695/work/SAP/team/signoffs/Sign-off template.xlsx
update font to Arial-14

can consult with Liraz re. formatting
copy to email

- once approved send Sign-off

        17.28.2

    17.29 Code contribution, tags: Code contribution

        17.29.1 guidelines wiki
https://wiki.one.int.sap/wiki/display/CPPortals/Code+contribution+guidelines
The purpose of this list is to outline what is mandatory in order to be able to contribute code to our product.

Define IL contact person (to cover amongst other things the CI process, release timelines, code split, etc)
Understand the requirements as defined by IL team APO/PO
Review with UX if relevant as defined by IL UX team
Design the new feature and document it under this wiki
Review the design with relevant service(s) architects, service owners, operations and DevOps and get their approval
Raise requirements if needed to other teams for coordination (via product team)
Create/Update Dev space (use this wiki)
Create a CAM request to have permission to the needed GIT repo with the profile "Portals_Team_external"
Prepare a test scope
Review the test scope with IL team, PO & QPE (owner of the repo)
Develop the code
Make sure the code complies to all SAP standards
Protect by feature toggle if there are dependencies / risks / controlled delivery
Test locally via dev space
Develop E2E automation covering the new feature and its dependencies
Extended code review with the receiving team before merge
Merge to master and verify that CI is green. If not, investigate
Execute the test scope on master (prepare content if necessary)
Review with UA in order to document
Run performance tests with IL performance team if relevant
Make sure that automation is green
Make sure that feature passed Q-Gate (work with relevant Jira projects - for both BLIs and bugs)
Dedicated HO process to the receiving team
Support the feature for 3 months since released to customers; be available to the team for questions

    17.30 important emails and messages, tags: important emails and messages

        17.30.1  my Scrum-Master appointment, tags: my Scrum-Master appointment
Hi all,
 
I am happy to announce that Yosi Izaq will assume the Scrum master position replacing Saar Dagan.
Yosi joined IDF academic reserve program and served in 8200 unit as a developer and later as a team-lead.
Continued to specialize in Network/Security at various companies, most notably Cisco.
Yosi joined SAP at 2018 as a Senior developer. BSC/MSC graduate in mathematics and computer science.
He has deep passion for technology and knowledge sharing, has vast technical abilities and experience.
 
I am positive that Yosi’s great capabilities and skillset will assist in successfully working together with the team for delivering great products.
I would also like to thank Saar for years of joint work with great cooperation and contribution to our organization; It makes me proud that Saar was raised in my group and I wish him good luck in his new role as a group manager!
 
Good luck,
Meni

        17.30.2

    17.31 meni team management meetings 06/03/24 14:09:13  
        
        Meni:
- New technical PO for the team. (aim for our team)
position open for a week 
two submitted from outside group . Experienced POs 

- Team has a lot of missions coming soon in external roadmap commitments timeline
  -- UPA, we want Gil to lead the UPA changes, will need to manage 2 consultants. Also 2 devs from Vered team.  Alon + Hezi. architect: Tsafrir-Sklarski. external-commitment timeline: Q3.
  we got budget from UPA 4 four consultants.

  -- HTML5 Marko HO, 3 days, Jawad should work with Marko until last week of T3. Use him to do any last tasks.
  HO recipient: Shirly and Hadar

  -- Export + Import agents . Kalman + Tsafrir lead until GA end of Q2. Jawad: team architect. external-commitment timeline: Q2. Starting with my team in T03.

  -- CDM store reduce load - code removal - Jawad should continue - Mass content track: T3  [Done]

-  Jawad discussed with Meni  re Shirly incident. 
   Encourage small forum meeting 

- Give Shirly BLI not in external roadmap
Me:
Duty load

        17.31.1   06/04
- planning meetings should move to 11:00
some team members come from far and can be stuck in traffic 
-
        17.31.2   10/06/24 17:34:14  
- import export on track 
- Yoav end of contract 1.2.2025, Alon, Nataliya?
    -- Yoav extend to 4.25 (wait for HR)
    -- Alon extend to 28.02.2026 
- GP topic +exec leads, Liraz + Ariel
- Bussi overstepping a bit :) 
really appreciate ur help - re. team management,assignments, EE, technical details plz approach me

        17.31.3   Meni team management meetings next , tags: meni team management meetings next

        17.31.4   meni team management meetings next , tags: meni team management meetings next
        17.31.5   meni team management meetings next , tags: meni team management meetings next
        17.31.6   meni team management meetings next , tags: meni team management meetings next
        17.31.7   meni team management meetings next , tags: meni team management meetings next
        17.31.8   meni team management meetings next , tags: meni team management meetings next
        17.31.9   meni team management meetings next , tags: meni team management meetings next
        17.31.10  meni team management meetings next , tags: meni team management meetings next
        17.31.11  meni team management meetings next , tags: meni team management meetings next
        17.31.12  meni team management meetings next , tags: meni team management meetings next
        17.31.13  meni team management meetings next , tags: meni team management meetings next
        17.31.14  meni team management meetings next , tags: meni team management meetings next
        17.31.15  meni team management meetings next , tags: meni team management meetings next
        17.31.16  meni team management meetings next , tags: meni team management meetings next
        17.31.17  meni team management meetings next , tags: meni team management meetings next
        17.31.18  meni team management meetings next , tags: meni team management meetings next
        17.31.19  meni team management meetings next , tags: meni team management meetings next
        17.31.20  meni team management meetings next , tags: meni team management meetings next
        17.31.21  meni team management meetings next , tags: meni team management meetings next
        17.31.22  meni team management meetings next , tags: meni team management meetings next
        17.31.23  meni team management meetings next , tags: meni team management meetings next
        17.31.24  meni team management meetings next , tags: meni team management meetings next
        17.31.25  meni team management meetings next , tags: meni team management meetings next
        17.31.26  meni team management meetings next , tags: meni team management meetings next
        17.31.27  meni team management meetings next , tags: meni team management meetings next
        17.31.28  meni team management meetings next , tags: meni team management meetings next
        17.31.29  meni team management meetings next , tags: meni team management meetings next
        17.31.30  meni team management meetings next , tags: meni team management meetings next
        17.31.31  meni team management meetings next , tags: meni team management meetings next
        17.31.32  meni team management meetings next , tags: meni team management meetings next
        17.31.33  meni team management meetings next , tags: meni team management meetings next
        17.31.34  meni team management meetings next , tags: meni team management meetings next
        17.31.35  meni team management meetings next , tags: meni team management meetings next
        17.31.36  meni team management meetings next , tags: meni team management meetings next
        17.31.37  meni team management meetings next , tags: meni team management meetings next
        17.31.38  meni team management meetings next , tags: meni team management meetings next
        17.31.39  meni team management meetings next , tags: meni team management meetings next
        17.31.40  meni team management meetings next , tags: meni team management meetings next
        17.31.41  meni team management meetings next , tags: meni team management meetings next
        17.31.42  meni team management meetings next , tags: meni team management meetings next
        17.31.43  meni team management meetings next , tags: meni team management meetings next
        17.31.44  meni team management meetings next , tags: meni team management meetings next
        17.31.45  meni team management meetings next , tags: meni team management meetings next
        17.31.46  meni team management meetings next , tags: meni team management meetings next
        17.31.47  meni team management meetings next , tags: meni team management meetings next
        17.31.48  meni team management meetings next , tags: meni team management meetings next
        17.31.49  meni team management meetings next , tags: meni team management meetings next
        17.31.50  meni team management meetings next , tags: meni team management meetings next
        17.31.51  meni team management meetings next , tags: meni team management meetings next
        17.31.52  meni team management meetings next , tags: meni team management meetings next
        17.31.53  meni team management meetings next , tags: meni team management meetings next
        17.31.54  meni team management meetings next , tags: meni team management meetings next
        17.31.55  meni team management meetings next , tags: meni team management meetings next
        17.31.56  meni team management meetings next , tags: meni team management meetings next
        17.31.57  meni team management meetings next , tags: meni team management meetings next
        17.31.58  meni team management meetings next , tags: meni team management meetings next
        17.31.59  meni team management meetings next , tags: meni team management meetings next
        17.31.60  meni team management meetings next , tags: meni team management meetings next
        17.31.61  meni team management meetings next , tags: meni team management meetings next
        17.31.62  meni team management meetings next , tags: meni team management meetings next
        17.31.63  meni team management meetings next , tags: meni team management meetings next
        17.31.64  meni team management meetings next , tags: meni team management meetings next
        17.31.65  meni team management meetings next , tags: meni team management meetings next
        17.31.66  meni team management meetings next , tags: meni team management meetings next
        17.31.67  meni team management meetings next , tags: meni team management meetings next
        17.31.68  meni team management meetings next , tags: meni team management meetings next
        17.31.69  meni team management meetings next , tags: meni team management meetings next
        17.31.70  meni team management meetings next , tags: meni team management meetings next
        17.31.71  meni team management meetings next , tags: meni team management meetings next
        17.31.72  meni team management meetings next , tags: meni team management meetings next
        17.31.73  meni team management meetings next , tags: meni team management meetings next
        17.31.74  meni team management meetings next , tags: meni team management meetings next
        17.31.75  meni team management meetings next , tags: meni team management meetings next
        17.31.76  meni team management meetings next , tags: meni team management meetings next
        17.31.77  meni team management meetings next , tags: meni team management meetings next
        17.31.78  meni team management meetings next , tags: meni team management meetings next
        17.31.79  meni team management meetings next , tags: meni team management meetings next
        17.31.80  meni team management meetings next , tags: meni team management meetings next
        17.31.81  meni team management meetings next , tags: meni team management meetings next
        17.31.82  meni team management meetings next , tags: meni team management meetings next
        17.31.83  meni team management meetings next , tags: meni team management meetings next
        17.31.84  meni team management meetings next , tags: meni team management meetings next
        17.31.85  meni team management meetings next , tags: meni team management meetings next
        17.31.86  meni team management meetings next , tags: meni team management meetings next
        17.31.87  meni team management meetings next , tags: meni team management meetings next
        17.31.88  meni team management meetings next , tags: meni team management meetings next
        17.31.89  meni team management meetings next , tags: meni team management meetings next
        17.31.90  meni team management meetings next , tags: meni team management meetings next
        17.31.91  meni team management meetings next , tags: meni team management meetings next
        17.31.92  meni team management meetings next , tags: meni team management meetings next
        17.31.93  meni team management meetings next , tags: meni team management meetings next
        17.31.94  meni team management meetings next , tags: meni team management meetings next
        17.31.95  meni team management meetings next , tags: meni team management meetings next
        17.31.96  meni team management meetings next , tags: meni team management meetings next
        17.31.97  meni team management meetings next , tags: meni team management meetings next
        17.31.98  meni team management meetings next , tags: meni team management meetings next
        17.31.99  meni team management meetings next , tags: meni team management meetings next
        17.31.100 meni team management meetings next , tags: meni team management meetings next
        17.31.101 meni team management meetings next , tags: meni team management meetings next



    17.32 Sync bussi , tags: Sync bussi 

        17.32.1  Sync bussi , tags: Sync bussi next 
- keep the line. each of us should not overstep the other 
  and backup each other in front of team
  plz don't assign work to me or to team members. this is my job :) 

- retros - team likes to vent. 
  Hadar likes to complain 

        17.32.2    Sync bussi , tags: Sync bussi next 
        17.32.3    Sync bussi , tags: Sync bussi next 
        17.32.4    Sync bussi , tags: Sync bussi next 
        17.32.5    Sync bussi , tags: Sync bussi next 
        17.32.6    Sync bussi , tags: Sync bussi next 
        17.32.7    Sync bussi , tags: Sync bussi next 
        17.32.8    Sync bussi , tags: Sync bussi next 
        17.32.9    Sync bussi , tags: Sync bussi next 
        17.32.10   Sync bussi , tags: Sync bussi next 
        17.32.11   Sync bussi , tags: Sync bussi next 
        17.32.12   Sync bussi , tags: Sync bussi next 
        17.32.13   Sync bussi , tags: Sync bussi next 
        17.32.14   Sync bussi , tags: Sync bussi next 
        17.32.15   Sync bussi , tags: Sync bussi next 
        17.32.16   Sync bussi , tags: Sync bussi next 
        17.32.17   Sync bussi , tags: Sync bussi next 
        17.32.18   Sync bussi , tags: Sync bussi next 
        17.32.19   Sync bussi , tags: Sync bussi next 
        17.32.20   Sync bussi , tags: Sync bussi next 
        17.32.21   Sync bussi , tags: Sync bussi next 
        17.32.22   Sync bussi , tags: Sync bussi next 
        17.32.23   Sync bussi , tags: Sync bussi next 
        17.32.24   Sync bussi , tags: Sync bussi next 
        17.32.25   Sync bussi , tags: Sync bussi next 
        17.32.26   Sync bussi , tags: Sync bussi next 
        17.32.27   Sync bussi , tags: Sync bussi next 
        17.32.28   Sync bussi , tags: Sync bussi next 
        17.32.29   Sync bussi , tags: Sync bussi next 
        17.32.30   Sync bussi , tags: Sync bussi next 
        17.32.31   Sync bussi , tags: Sync bussi next 
        17.32.32   Sync bussi , tags: Sync bussi next 
        17.32.33   Sync bussi , tags: Sync bussi next 
        17.32.34   Sync bussi , tags: Sync bussi next 
        17.32.35   Sync bussi , tags: Sync bussi next 
        17.32.36   Sync bussi , tags: Sync bussi next 
        17.32.37   Sync bussi , tags: Sync bussi next 
        17.32.38   Sync bussi , tags: Sync bussi next 
        17.32.39   Sync bussi , tags: Sync bussi next 
        17.32.40   Sync bussi , tags: Sync bussi next 
        17.32.41   Sync bussi , tags: Sync bussi next 
        17.32.42   Sync bussi , tags: Sync bussi next 
        17.32.43   Sync bussi , tags: Sync bussi next 
        17.32.44   Sync bussi , tags: Sync bussi next 
        17.32.45   Sync bussi , tags: Sync bussi next 
        17.32.46   Sync bussi , tags: Sync bussi next 
        17.32.47   Sync bussi , tags: Sync bussi next 
        17.32.48   Sync bussi , tags: Sync bussi next 
        17.32.49   Sync bussi , tags: Sync bussi next 
        17.32.50   Sync bussi , tags: Sync bussi next 
        17.32.51   Sync bussi , tags: Sync bussi next 
        17.32.52   Sync bussi , tags: Sync bussi next 
        17.32.53   Sync bussi , tags: Sync bussi next 
        17.32.54   Sync bussi , tags: Sync bussi next 
        17.32.55   Sync bussi , tags: Sync bussi next 
        17.32.56   Sync bussi , tags: Sync bussi next 
        17.32.57   Sync bussi , tags: Sync bussi next 
        17.32.58   Sync bussi , tags: Sync bussi next 
        17.32.59   Sync bussi , tags: Sync bussi next 
        17.32.60   Sync bussi , tags: Sync bussi next 
        17.32.61   Sync bussi , tags: Sync bussi next 
        17.32.62   Sync bussi , tags: Sync bussi next 
        17.32.63   Sync bussi , tags: Sync bussi next 
        17.32.64   Sync bussi , tags: Sync bussi next 
        17.32.65   Sync bussi , tags: Sync bussi next 
        17.32.66   Sync bussi , tags: Sync bussi next 
        17.32.67   Sync bussi , tags: Sync bussi next 
        17.32.68   Sync bussi , tags: Sync bussi next 
        17.32.69   Sync bussi , tags: Sync bussi next 
        17.32.70   Sync bussi , tags: Sync bussi next 
        17.32.71   Sync bussi , tags: Sync bussi next 
        17.32.72   Sync bussi , tags: Sync bussi next 
        17.32.73   Sync bussi , tags: Sync bussi next 
        17.32.74   Sync bussi , tags: Sync bussi next 
        17.32.75   Sync bussi , tags: Sync bussi next 
        17.32.76   Sync bussi , tags: Sync bussi next 
        17.32.77   Sync bussi , tags: Sync bussi next 
        17.32.78   Sync bussi , tags: Sync bussi next 
        17.32.79   Sync bussi , tags: Sync bussi next 
        17.32.80   Sync bussi , tags: Sync bussi next 
        17.32.81   Sync bussi , tags: Sync bussi next 
        17.32.82   Sync bussi , tags: Sync bussi next 
        17.32.83   Sync bussi , tags: Sync bussi next 
        17.32.84   Sync bussi , tags: Sync bussi next 
        17.32.85   Sync bussi , tags: Sync bussi next 
        17.32.86   Sync bussi , tags: Sync bussi next 
        17.32.87   Sync bussi , tags: Sync bussi next 
        17.32.88   Sync bussi , tags: Sync bussi next 
        17.32.89   Sync bussi , tags: Sync bussi next 
        17.32.90   Sync bussi , tags: Sync bussi next 
        17.32.91   Sync bussi , tags: Sync bussi next 
        17.32.92   Sync bussi , tags: Sync bussi next 
        17.32.93   Sync bussi , tags: Sync bussi next 
        17.32.94   Sync bussi , tags: Sync bussi next 
        17.32.95   Sync bussi , tags: Sync bussi next 
        17.32.96   Sync bussi , tags: Sync bussi next 
        17.32.97   Sync bussi , tags: Sync bussi next 
        17.32.98   Sync bussi , tags: Sync bussi next 
        17.32.99   Sync bussi , tags: Sync bussi next 
        17.32.100  Sync bussi , tags: Sync bussi next 
        17.32.101  Sync bussi , tags: Sync bussi next 
        17.32.102  Sync bussi , tags: Sync bussi next 
        17.32.103  Sync bussi , tags: Sync bussi next 
        17.32.104  Sync bussi , tags: Sync bussi next 
        17.32.105  Sync bussi , tags: Sync bussi next 
        17.32.106  Sync bussi , tags: Sync bussi next 
        17.32.107  Sync bussi , tags: Sync bussi next 
        17.32.108  Sync bussi , tags: Sync bussi next 
        17.32.109  Sync bussi , tags: Sync bussi next 
        17.32.110  Sync bussi , tags: Sync bussi next 
        17.32.111  Sync bussi , tags: Sync bussi next 
        17.32.112  Sync bussi , tags: Sync bussi next 
        17.32.113  Sync bussi , tags: Sync bussi next 
        17.32.114  Sync bussi , tags: Sync bussi next 
        17.32.115  Sync bussi , tags: Sync bussi next 
        17.32.116  Sync bussi , tags: Sync bussi next 
        17.32.117  Sync bussi , tags: Sync bussi next 
        17.32.118  Sync bussi , tags: Sync bussi next 
        17.32.119  Sync bussi , tags: Sync bussi next 
        17.32.120  Sync bussi , tags: Sync bussi next 
        17.32.121  Sync bussi , tags: Sync bussi next 
        17.32.122  Sync bussi , tags: Sync bussi next 
        17.32.123  Sync bussi , tags: Sync bussi next 
        17.32.124  Sync bussi , tags: Sync bussi next 
        17.32.125  Sync bussi , tags: Sync bussi next 
        17.32.126  Sync bussi , tags: Sync bussi next 
        17.32.127  Sync bussi , tags: Sync bussi next 
        17.32.128  Sync bussi , tags: Sync bussi next 
        17.32.129  Sync bussi , tags: Sync bussi next 
        17.32.130  Sync bussi , tags: Sync bussi next 
        17.32.131  Sync bussi , tags: Sync bussi next 
        17.32.132  Sync bussi , tags: Sync bussi next 
        17.32.133  Sync bussi , tags: Sync bussi next 
        17.32.134  Sync bussi , tags: Sync bussi next 
        17.32.135  Sync bussi , tags: Sync bussi next 
        17.32.136  Sync bussi , tags: Sync bussi next 
        17.32.137  Sync bussi , tags: Sync bussi next 
        17.32.138  Sync bussi , tags: Sync bussi next 
        17.32.139  Sync bussi , tags: Sync bussi next 
        17.32.140  Sync bussi , tags: Sync bussi next 
        17.32.141  Sync bussi , tags: Sync bussi next 
        17.32.142  Sync bussi , tags: Sync bussi next 
        17.32.143  Sync bussi , tags: Sync bussi next 
        17.32.144  Sync bussi , tags: Sync bussi next 
        17.32.145  Sync bussi , tags: Sync bussi next 
        17.32.146  Sync bussi , tags: Sync bussi next 
        17.32.147  Sync bussi , tags: Sync bussi next 
        17.32.148  Sync bussi , tags: Sync bussi next 
        17.32.149  Sync bussi , tags: Sync bussi next 
        17.32.150  Sync bussi , tags: Sync bussi next 
        17.32.151  Sync bussi , tags: Sync bussi next 
        17.32.152  Sync bussi , tags: Sync bussi next 

    17.33
18. Devops 

    18.1 jobs

        18.1.1 INIT-ENVIRONMENT
populate a new space with apps

        18.1.2 update-environment
https://portalcfdevelopers.jaas-gcp.cloud.sap.corp/job/deployOrchestratorJobs/job/UPDATE-ENVIRONMENT/
update versions of apps on an existing space 
space i500695p.
org:            launchpad
cmd+alt+i, console then
for (let elem  of document.querySelectorAll("input[type=checkbox]")){ elem.click()};

        18.1.3
    18.2

19. Cross-team Features

    19.1  data termination, orphan data, tags: data termination, orphan data, 
https://wiki.one.int.sap/wiki/display/CPPortals/CF+Portal+and+Workzone+termination

        19.1.1  
    19.2 CMK, tags: CMK, customer managed key, apple, postgres encryption, pgbouncer, aws rds, kyma, gardener, Kubernetes, k8s

        19.2.1 important links
https://wiki.one.int.sap/wiki/display/CPPortals/15.5+CMK+Tech+Synch
FYI. CMK On/offboarding:  https://wiki.one.int.sap/wiki/pages/viewpage.action?pageId=3496910602

        19.2.2 CMK Feature toggle, tags: CMK Feature toggle
- set in released section:
[i500695@WYLQRXL9LQ:2023-10-03 10:37:52:~/git/portal-global-services:]2069$ gitd
diff --git a/templates/feature-flags-template.yml b/templates/feature-flags-template.yml
index efa510b..b1b8cbd 100644
--- a/templates/feature-flags-template.yml
+++ b/templates/feature-flags-template.yml
@@ -191,7 +191,7 @@ released:
     <<: (( feature_flags_default_descriptor ))
   - id: ff_cmk_enabled
     description: "Enable CMK - Supporting Multiple PG/ObjectStore instances"
-    enabled: (( env("HOST_SUFFIX") == "-ltseu12" ? true :false ))
+    enabled: (( env("HOST_SUFFIX") == "-ltseu12" -or env("HOST_SUFFIX") == "-rcteu12" ? true :false ))

        19.2.3
    19.3

20. group management , tags: group management 

    20.1 23/08/23 13:47:44  
- Orit, APO promoted. We now need to manage the execution 
Dana is APO for all the teams 
- Quarterly planning done by development managers
- product-managers assess value to customers 

    20.2  03/01/24 15:28:25  
- Vered moves FLP-RT to winnie so she can take the following:
- url-templates move from Liraz team to Vered, T2 2024
- Provisioning service - good chance that it will move to Vered team, T2 2024 
- Apollo replacement - Apollo as provider (Tsafrir is leading this)
- Talk to Saar re. Certificate refresh job
- Raise in Scrum-of-scrums: we need periodic joint activity to remove unnecessary feature-flags
- Raise in daily: Qgate, dev on duty help Olga/Zhenia/Inbal to troubleshoot issues

    20.3  10/01/24 15:12:51  
- Raise in management meeting re. BLIs not fully baked (example: cards destinations mapping changing up until DR and after) 

    20.4  13/03/24 15:10:19  
Ariel:
- sap.cards, 
    -- embedded provider issue 
    -- WZ ADV cep-activation instance is missing. cep-new-experience toggle is off.
    -- Replay events for more products. not only launchpad
- import export
  -- Liraz: only site ex/import (granularity will wait)
  --

- Ask people to join preplanning

me:
- [Action Required] SAP Build Work Zone : Execution & Alignment - not clear if/what we need to do.
- shell plugin x509 automation
- fixed assignments 
- HTML 5 HO, only lib in Q1. Full scenario: Q2. Talk to Shirly: small effort now. switch to other task.

    20.5  20/03/24 15:13:41  
- UPA, Unified procurement access 
    Gil will lead dev
    Tsafrir architect
    LiLach, Hezi, devs
    Matan PO
    2 External Consultants , Yael interviewing
    Topic lead, Dana
    Execution lead, Dana

create onboarding plan
squad team - will move to work together 

- Ilan gave Meni one student position (dev support?)

- remove Gil from support until end of Q2 

- Ariel: ask specific people that must join pre-planning, Jawad as architect, Shirly as security (to raise security concerns)
- Kalman, topic lead for import export 

    20.6    08/05/24 15:08:17  

- https://jira.tools.sap/browse/DWPBUGS-5794
smartbusinesstiles, WZ content 

- schema changes as tasks

- lightrun

- export spaces agent delay (Evyatar)

- Golden path, https://wiki.one.int.sap/wiki/display/CPPortals/HTML5+HL+Plan 
  
- Nidhi, New UX 

    20.7    26/06/24 16:29:00  
- Support raised to 30 PDs 
10 PDs for Jira's Qgates issues, etc, 

- Eng driven 15% capacity is back
- 15% of Q3 commitment is soft
- Students capacity
- 

    20.8    next group management , tags: next group management 
    20.9    next group management , tags: next group management 
    20.10   next group management , tags: next group management 
    20.11   next group management , tags: next group management 
    20.12   next group management , tags: next group management 
    20.13   next group management , tags: next group management 
    20.14   next group management , tags: next group management 
    20.15   next group management , tags: next group management 
    20.16   next group management , tags: next group management 
    20.17   next group management , tags: next group management 
    20.18   next group management , tags: next group management 
    20.19   next group management , tags: next group management 
    20.20   next group management , tags: next group management 
    20.21   next group management , tags: next group management 
    20.22   next group management , tags: next group management 
    20.23   next group management , tags: next group management 
    20.24   next group management , tags: next group management 
    20.25   next group management , tags: next group management 
    20.26   next group management , tags: next group management 
    20.27   next group management , tags: next group management 
    20.28   next group management , tags: next group management 
    20.29   next group management , tags: next group management 
    20.30   next group management , tags: next group management 
    20.31   next group management , tags: next group management 
    20.32   next group management , tags: next group management 
    20.33   next group management , tags: next group management 
    20.34   next group management , tags: next group management 
    20.35   next group management , tags: next group management 
    20.36   next group management , tags: next group management 
    20.37   next group management , tags: next group management 
    20.38   next group management , tags: next group management 
    20.39   next group management , tags: next group management 
    20.40   next group management , tags: next group management 
    20.41   next group management , tags: next group management 
    20.42   next group management , tags: next group management 
    20.43   next group management , tags: next group management 
    20.44   next group management , tags: next group management 
    20.45   next group management , tags: next group management 
    20.46   next group management , tags: next group management 
    20.47   next group management , tags: next group management 
    20.48   next group management , tags: next group management 
    20.49   next group management , tags: next group management 
    20.50   next group management , tags: next group management 
    20.51   next group management , tags: next group management 
    20.52   next group management , tags: next group management 
    20.53   next group management , tags: next group management 
    20.54   next group management , tags: next group management 
    20.55   next group management , tags: next group management 
    20.56   next group management , tags: next group management 
    20.57   next group management , tags: next group management 
    20.58   next group management , tags: next group management 
    20.59   next group management , tags: next group management 
    20.60   next group management , tags: next group management 
    20.61   next group management , tags: next group management 
    20.62   next group management , tags: next group management 
    20.63   next group management , tags: next group management 
    20.64   next group management , tags: next group management 
    20.65   next group management , tags: next group management 
    20.66   next group management , tags: next group management 
    20.67   next group management , tags: next group management 
    20.68   next group management , tags: next group management 
    20.69   next group management , tags: next group management 
    20.70   next group management , tags: next group management 
    20.71   next group management , tags: next group management 
    20.72   next group management , tags: next group management 
    20.73   next group management , tags: next group management 
    20.74   next group management , tags: next group management 
    20.75   next group management , tags: next group management 
    20.76   next group management , tags: next group management 
    20.77   next group management , tags: next group management 
    20.78   next group management , tags: next group management 
    20.79   next group management , tags: next group management 
    20.80   next group management , tags: next group management 
    20.81   next group management , tags: next group management 
    20.82   next group management , tags: next group management 
    20.83   next group management , tags: next group management 
    20.84   next group management , tags: next group management 
    20.85   next group management , tags: next group management 
    20.86   next group management , tags: next group management 
    20.87   next group management , tags: next group management 
    20.88   next group management , tags: next group management 
    20.89   next group management , tags: next group management 
    20.90   next group management , tags: next group management 
    20.91   next group management , tags: next group management 
    20.92   next group management , tags: next group management 
    20.93   next group management , tags: next group management 
    20.94   next group management , tags: next group management 
    20.95   next group management , tags: next group management 
    20.96   next group management , tags: next group management 
    20.97   next group management , tags: next group management 
    20.98   next group management , tags: next group management 
    20.99   next group management , tags: next group management 
    20.100  next group management , tags: next group management 
    20.101  next group management , tags: next group management 
    20.102  next group management , tags: next group management 
    20.103  next group management , tags: next group management 
    20.104  next group management , tags: next group management 
    20.105  next group management , tags: next group management 
    20.106  next group management , tags: next group management 


21. New Device, tags: New Device

    21.1 New MAC, tags: New MAC

See note: "New Mac guide"

    21.2 New Iphone, tags: New Iphone
iOS & iPadOS enrollment Guide:
https://workzone.one.int.sap/site#workzone-home&/articles/SMhNvW4IHHU2Ok0Feuru2U

For authenticator need to deregister old authenticator and enroll new.
a. accounts.sap.com on mac
b. TOTP Two-Factor Authentication Deactivate
c. existing Multi-Factor Authentication 
d. Deactivate 
e. Activate 
f. Scan QR code from authenticator on new iphone
g. enter new pass code 
h. Activate


    21.3

22. Purchase, orders, ariba tags: Purchase, orders, ariba 


    22.1 Ilan Cost center tags: Ilan Cost center
[Ilan Schwartz]
BTP Core AP UE Portal (IL)
CC #0191014111
    22.2


23.


