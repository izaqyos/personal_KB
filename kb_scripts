.........................................Table Of Contents...............................................................
1. connect_2_office.sh (sh, cygwin) <URL:#tn=1. connect_2_office.sh (sh, cygwin)>
2. comment_code.pl. can comment or uncomment large sections of code files. <URL:#tn=2. comment_code.pl. can comment or uncomment large sections of code files.>
3. benchmark.pl run thesis tests. <URL:#tn=3. benchmark.pl run thesis tests.>
4. Converters, Translators, Beutifiers. <URL:#tn=4. Converters, Translators, Beutifiers.>
	4.1 tocify.pl    create a table of contents for KB files. <URL:#tn=	4.1 tocify.pl    create a table of contents for KB files.>
	4.2 TranslateKB2HTML.bash translate my proprietery KB files to HTML. <URL:#tn=	4.2 TranslateKB2HTML.bash translate my proprietery KB files to HTML.>
5. save_dom.pl  manages dom II saved games.  <URL:#tn=5. save_dom.pl  manages dom II saved games. >
6. merge_activities.pl (cisco) co files, merge between views and copy result of merge over original files. <URL:#tn=6. merge_activities.pl (cisco) co files, merge between views and copy result of merge over original files.>
7. stree. Plot directory tree.  <URL:#tn=7. stree. Plot directory tree. >
8. filter_paragraphs.pl filter paragraphs that start and end with specific patterns, example: <URL:#tn=8. filter_paragraphs.pl filter paragraphs that start and end with specific patterns, example:>
9. py_eye.py  status of dominions server <URL:#tn=9. py_eye.py  status of dominions server>
	9.1 py_eye_gui same but with GUI, adapted to DOM-III and supports modded nations and cosumizable skin. <URL:#tn=	9.1 py_eye_gui same but with GUI, adapted to DOM-III and supports modded nations and cosumizable skin.>
10. domII_PBEM_utils.py domIII_PBEM_utils.py, dominions PBEM game host utils <URL:#tn=10. domII_PBEM_utils.py domIII_PBEM_utils.py, dominions PBEM game host utils>
11.  ClearCase <URL:#tn=11.  ClearCase>
	11.1 code_review_info, generate all the required info for a peer reviewer to conduct code review <URL:#tn=	11.1 code_review_info, generate all the required info for a peer reviewer to conduct code review>
	11.2 ct, cleartool <URL:#tn=	11.2 ct, cleartool>
	11.3 co, check out w/o comment <URL:#tn=	11.3 co, check out w/o comment>
	11.4 ci, check out w/o comment <URL:#tn=	11.4 ci, check out w/o comment>
	11.5 ci-all, check in my files <URL:#tn=	11.5 ci-all, check in my files>
	11.6 my_post_rebase, rebuild view after rebase <URL:#tn=	11.6 my_post_rebase, rebuild view after rebase>
	11.7 my_rebase, rebase <URL:#tn=	11.7 my_rebase, rebase>
	11.8 ct_diff, diff against predecessor <URL:#tn=	11.8 ct_diff, diff against predecessor>
	11.9 ct_diff_act <URL:#tn=	11.9 ct_diff_act>
	11.10 ct_tree, version tree <URL:#tn=	11.10 ct_tree, version tree>
12. activity_change_set, under clearcase, extract the change set of a given activity, its output can be given to something like ct diff -g -pred `activity_change_set activity` <URL:#tn=12. activity_change_set, under clearcase, extract the change set of a given activity, its output can be given to something like ct diff -g -pred `activity_change_set activity`>
13. query_cisco_dir.bash, a utility for extracting user phone from Cisco directory using CLI <URL:#tn=13. query_cisco_dir.bash, a utility for extracting user phone from Cisco directory using CLI>
14. filesum, a utility to get a pretty print of file listing in dir and a total size of files. <URL:#tn=14. filesum, a utility to get a pretty print of file listing in dir and a total size of files.>
15. ACS related <URL:#tn=15. ACS related>
	14.1 Procedure for after rebase, <URL:#tn=	14.1 Procedure for after rebase,>
	14.2 Create ACS RPM <URL:#tn=	14.2 Create ACS RPM>
	14.3 Validate ACS RT XML Configuration files <URL:#tn=	14.3 Validate ACS RT XML Configuration files>
	14.4 Get extensive information regarding the state of ACS 5.x services, sudo ~/sysinfo.pl  pr_stat all <URL:#tn=	14.4 Get extensive information regarding the state of ACS 5.x services, sudo ~/sysinfo.pl  pr_stat all>
	14.5 /ws/yizaq-csi/work/acs_patch_packager/acs_patch_packager.py <URL:#tn=	14.5 /ws/yizaq-csi/work/acs_patch_packager/acs_patch_packager.py>
		14.5.1  script <URL:#tn=		14.5.1  script>
1. Generate target file list <URL:#tn=1. Generate target file list>
2.  Generate source file list <URL:#tn=2.  Generate source file list>
5.3: mist_bnv B.839 <URL:#tn=5.3: mist_bnv B.839>
5.4: mist_bnv B.221 <URL:#tn=5.4: mist_bnv B.221>
                1. Generate a full listing of ACS files on installed machine  <URL:#tn=                1. Generate a full listing of ACS files on installed machine >
                2. Use #1 to auto Create filesToReplace file <URL:#tn=                2. Use #1 to auto Create filesToReplace file>
                3. ask for patch name <URL:#tn=                3. ask for patch name>
                4. create same name dir <URL:#tn=                4. create same name dir>
                5. apply patch pack script functionality <URL:#tn=                5. apply patch pack script functionality>
                6. add list patch content command <URL:#tn=                6. add list patch content command>
		14.5.2 Usage <URL:#tn=		14.5.2 Usage>
1.       Add your files to list file: acs/patches_5_4/patch_filelist <URL:#tn=1.       Add your files to list file: acs/patches_5_4/patch_filelist>
2.       Build stream w/ FCS build # <URL:#tn=2.       Build stream w/ FCS build #>
3.       Unpack patch packager and cd to that dir <URL:#tn=3.       Unpack patch packager and cd to that dir>
4.       Enter your view to acs_patch_packager.cfg: <URL:#tn=4.       Enter your view to acs_patch_packager.cfg:>
5.       Run: ./acs_patch_packager.py <URL:#tn=5.       Run: ./acs_patch_packager.py>
6.       You can get a list of commands w/ ? but for creating patch do ‘c’ <URL:#tn=6.       You can get a list of commands w/ ? but for creating patch do ‘c’>
7.       [ACS Patch Packager]c <URL:#tn=7.       [ACS Patch Packager]c>
8.       Provide path of files list file (from #1) <URL:#tn=8.       Provide path of files list file (from #1)>
9.       provide the patch name e.g. 5.4.0.46.2 <URL:#tn=9.       provide the patch name e.g. 5.4.0.46.2>
10.   You will get a message where patch is <URL:#tn=10.   You will get a message where patch is>
		14.5.3 <URL:#tn=		14.5.3>
	14.6 /users/yizaq/work/scripts/work_utils/touch_views.sh <URL:#tn=	14.6 /users/yizaq/work/scripts/work_utils/touch_views.sh>
	14.7 <URL:#tn=	14.7>
16. Python <URL:#tn=16. Python>
	16.1 search_text.py <URL:#tn=	16.1 search_text.py>
		16.1.1 examples: <URL:#tn=		16.1.1 examples:>
	16.2  dom3_hof_mgr.py <URL:#tn=	16.2  dom3_hof_mgr.py>
		16.2.1  source code Mon Feb 28 17:41:48 JST 2011 <URL:#tn=		16.2.1  source code Mon Feb 28 17:41:48 JST 2011>
		16.2.2 <URL:#tn=		16.2.2>
	16.3 reportDMClashes.py <URL:#tn=	16.3 reportDMClashes.py>
		16.3.1 Source code Mon Feb 28 17:40:59 JST 2011 <URL:#tn=		16.3.1 Source code Mon Feb 28 17:40:59 JST 2011>
		16.3.2 <URL:#tn=		16.3.2>
	16.4 FTP helper <URL:#tn=	16.4 FTP helper>
		16.4.1 Upload binary file automatically <URL:#tn=		16.4.1 Upload binary file automatically>
		16.4.2 <URL:#tn=		16.4.2>
	16.5 <URL:#tn=	16.5>
17. Display directory and/or files tree <URL:#tn=17. Display directory and/or files tree>
18. Remote file push/pull/copy/move procedures <URL:#tn=18. Remote file push/pull/copy/move procedures>
	18.1 cpr_fast, also note the following alias performs a much faster directory copy than cp -r <URL:#tn=	18.1 cpr_fast, also note the following alias performs a much faster directory copy than cp -r>
19. sed scripts <URL:#tn=19. sed scripts>
	19.1 section commenter <URL:#tn=	19.1 section commenter>
	19.2 <URL:#tn=	19.2>
20. Work scripts <URL:#tn=20. Work scripts>
	20.1 Modify DNS Settings  <URL:#tn=	20.1 Modify DNS Settings >
	20.2 surpress_valgring_acs_errors  <URL:#tn=	20.2 surpress_valgring_acs_errors >
	20.3 zeorize_keys.bash <URL:#tn=	20.3 zeorize_keys.bash>
	20.4 Automation of Centrify integration to ACS <URL:#tn=	20.4 Automation of Centrify integration to ACS>
	20.5 <URL:#tn=	20.5>
21. BASH profile & aliases <URL:#tn=21. BASH profile & aliases>
	21.1 Cisco development environment .bashrc Mon Jan 25 18:26:36 JST 2010 <URL:#tn=	21.1 Cisco development environment .bashrc Mon Jan 25 18:26:36 JST 2010>
	21.2 Cisco development environment .aliasses  <URL:#tn=	21.2 Cisco development environment .aliasses >
		21.2.1 Mon Jan 25 18:26:58 JST 2010 <URL:#tn=		21.2.1 Mon Jan 25 18:26:58 JST 2010>
		21.2.2 Mon Jan 31 16:31:19 JST 2011 <URL:#tn=		21.2.2 Mon Jan 31 16:31:19 JST 2011>
1. Only works in clearcase view  <URL:#tn=1. Only works in clearcase view >
2. Only works after ACS RT service is stopped <URL:#tn=2. Only works after ACS RT service is stopped>
3. Reuires that ACS rt_daemon be linked with purify <URL:#tn=3. Reuires that ACS rt_daemon be linked with purify>
		21.2.3 <URL:#tn=		21.2.3>
	21.3 laptop environment .bashrc Mon Jan 25 18:27:08 JST 2010 <URL:#tn=	21.3 laptop environment .bashrc Mon Jan 25 18:27:08 JST 2010>
	21.4 laptop environment .aliasses Mon Jan 25 18:27:18 JST 2010 <URL:#tn=	21.4 laptop environment .aliasses Mon Jan 25 18:27:18 JST 2010>
	21.5 useful aliases <URL:#tn=	21.5 useful aliases>
		21.5.1  ACS <URL:#tn=		21.5.1  ACS>
			21.5.1.1  logs, __log_selector - view ACS logs <URL:#tn=			21.5.1.1  logs, __log_selector - view ACS logs>
			21.5.1.2 svs, choose ClearCase view  <URL:#tn=			21.5.1.2 svs, choose ClearCase view >
			21.5.1.3 cleartool diffs <URL:#tn=			21.5.1.3 cleartool diffs>
			21.5.1.4  <URL:#tn=			21.5.1.4 >
		21.5.2 Maintenance <URL:#tn=		21.5.2 Maintenance>
			21.5.2.1 quotas <URL:#tn=			21.5.2.1 quotas>
8.0K    maven-repository/ <URL:#tn=8.0K    maven-repository/>
8.0K    maven-repository2/ <URL:#tn=8.0K    maven-repository2/>
9.3M    yizaq__P1.fcs5_1.int.acs5_0.lx/ <URL:#tn=9.3M    yizaq__P1.fcs5_1.int.acs5_0.lx/>
1.3G    acs_builds/ <URL:#tn=1.3G    acs_builds/>
9.3M    yizaq__P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/ <URL:#tn=9.3M    yizaq__P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/>
2.5G    yizaq__PI_Rest.int.acs5_0.lx/ <URL:#tn=2.5G    yizaq__PI_Rest.int.acs5_0.lx/>
		21.5.3 <URL:#tn=		21.5.3>
	21.6 <URL:#tn=	21.6>
22. multiple_slowFS_file_fetchers.bash <URL:#tn=22. multiple_slowFS_file_fetchers.bash>
23. Perl <URL:#tn=23. Perl>
	23.1 nameservers_tests.pl  <URL:#tn=	23.1 nameservers_tests.pl >
	23.2 <URL:#tn=	23.2>
24. pki_generator_new.sh <URL:#tn=24. pki_generator_new.sh>
25. ISE related <URL:#tn=25. ISE related>
	25.1 deploy_diag2machine.sh <URL:#tn=	25.1 deploy_diag2machine.sh>
		25.1.1 [yizaq@pmbu-dev-vm58:Wed Apr 09:625:50:/vob/nm_acs/pbis]$ cat !$/deploy_diag2machine.sh <URL:#tn=		25.1.1 [yizaq@pmbu-dev-vm58:Wed Apr 09:625:50:/vob/nm_acs/pbis]$ cat !$/deploy_diag2machine.sh>
		25.1.2 <URL:#tn=		25.1.2>
	25.2 Collect memory details periodically <URL:#tn=	25.2 Collect memory details periodically>
		25.2.1 Collect_Mem_Info.sh <URL:#tn=		25.2.1 Collect_Mem_Info.sh>
		25.2.2 RunMemCollectorPeriodically.sh <URL:#tn=		25.2.2 RunMemCollectorPeriodically.sh>
		25.2.3 Runtime Example <URL:#tn=		25.2.3 Runtime Example>
		25.2.4 <URL:#tn=		25.2.4>
26. <URL:#tn=26.>
.................................................END TOC..............................................

























Description: 	From time to time I update this list of usefull scripts I have wrote in the past.
Author:		Yosi Izaq.




Usefull scripts:

1. connect_2_office.sh (sh, cygwin)
2. comment_code.pl. can comment or uncomment large sections of code files.
3. benchmark.pl run thesis tests.
4. Converters, Translators, Beutifiers.

	4.1 tocify.pl    create a table of contents for KB files.
	usage: 
	$cdKB
	$tocify.pl kb* */kb* KB* */KB* *kb */*kb *KB */*KB
	Not that there's also an identical functionality sed script, tocify.bash


	4.2 TranslateKB2HTML.bash translate my proprietery KB files to HTML.
	TBD, add support for list by embeding hints in the KB document (like [list] and [end list] for example).

5. save_dom.pl  manages dom II saved games. 
6. merge_activities.pl (cisco) co files, merge between views and copy result of merge over original files.
7. stree. Plot directory tree. 
8. filter_paragraphs.pl filter paragraphs that start and end with specific patterns, example:
$ filter_paragraphs.pl NoClientHello.log "Incoming EAP Message"  PST_  > Client_messages
$ filter_paragraphs.pl NoClientHello.log "Tunneled Incoming Packet"  PST_  >> Client_messages
Will filter from ACS log files all packets that incoming from EAP-FAST client.

9. py_eye.py  status of dominions server
	9.1 py_eye_gui same but with GUI, adapted to DOM-III and supports modded nations and cosumizable skin.
	Source code contains lots of tkinter lore so can also serve as good reference for a basic tkinter application.

10. domII_PBEM_utils.py domIII_PBEM_utils.py, dominions PBEM game host utils

11.  ClearCase
	11.1 code_review_info, generate all the required info for a peer reviewer to conduct code review
_generate_code_review_info()
{
        echo "Generating code review information"
        echo "Make sure you're in corresponding stream and view and set to the activity you'd like reviewed"

        stream=`ct lsstream | awk '{print $2}'`
        view=`ct pwv |  awk '/Set view/  {print $3}'`
        activity=`ct lsact -cact | awk '{print $2}'`
        Files=`ct lsact -long AAC_Is_Failure@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__'`

        echo "================================================================================"
        echo "||            Code Review Information             "
        echo "================================================================================"
        echo "|| Stream:    $stream                   "
        echo "================================================================================"
        echo "|| Activity:  $activity                 "
        echo "================================================================================"
        echo "|| Files:     $Files                 "
        echo "================================================================================"
}

	11.2 ct, cleartool
	11.3 co, check out w/o comment
	11.4 ci, check out w/o comment
	11.5 ci-all, check in my files
	11.6 my_post_rebase, rebuild view after rebase
	11.7 my_rebase, rebase
	11.8 ct_diff, diff against predecessor
	11.9 ct_diff_act
	_ct_diff_act(){
#Description: Run diff on an activity change set
#Usage: $ ct_diff_act Phase2Bugs2@/vob/nmtgre_proj

        TMP_FILE="__ct_diff_act_temp"
        echo "Running diff on change set of activity: $1..."
         for file in `activity_change_set $1 `;  do echo "ct diff -graph -pred  $file" >> $TMP_FILE; done
        . $TMP_FILE
        \rm -f $TMP_FILE

}

	11.10 ct_tree, version tree

ci_all.sh	under clearcase, checkin all checked out files for user.

12. activity_change_set, under clearcase, extract the change set of a given activity, its output can be given to something like ct diff -g -pred `activity_change_set activity`

A nice aliase that is using this script is ct_diff_act which automatically opens clearcase diff window for each of the files in
the activity change set against its predecessor.
Usage example: $ ct_diff_act Phase2Bugs2@/vob/nmtgre_proj

13. query_cisco_dir.bash, a utility for extracting user phone from Cisco directory using CLI
It uses an awk script that parses wget result of URL query to Cisco dir.

14. filesum, a utility to get a pretty print of file listing in dir and a total size of files.
usage:
	$filesum		To get pretty print of ls -l
	$filesum -R		To get recursive listing and total size of files under .
	$filesum -R *.cpp	To get recursive listing of specific files, like suffix cpp

15. ACS related
	
	14.1 Procedure for after rebase,
	refresh_deps.sh (obsolete)
	my_post_rebase (alias)

	14.2 Create ACS RPM
	generate_acs_rpm.sh

	14.3 Validate ACS RT XML Configuration files
	validate_acs_xml.bash

	14.4 Get extensive information regarding the state of ACS 5.x services, sudo ~/sysinfo.pl  pr_stat all
	

	14.5 /ws/yizaq-csi/work/acs_patch_packager/acs_patch_packager.py

		14.5.1  script


#!/ws/gkosoi-csi/opt/bin/python
##!/usr/bin/python


"""
 Author Yosi Izaq
 Description: Currently ACS patch creation process involves many manual operations and creation of duplicate Clearcase elements. Goal is to automate the patch creation
 Usage: acs_patch_packager.py , follow options
 Date: Sun Sep 16 12:08:41 IDT 2012
 """

"""
Notes:
1. Generate target file list
a. Run on ACS installed machine of target version mapping of files. ex:
find /opt /etc/ -type f | grep -v 'patches/5-3-0-40-3/backup/' > ACS_5_3_File_Paths
or, if using build w/ same number can do from RPM staging:

[yizaq@yizaq-lnx:Tue Dec 18:1017:50:/view/yizaq__yizaq.P2.P1.FCS_5_4.int.acs5_0.lx/vob/nm_acs/acs]$ cd ./install/target/rpm/buildroot ; find  -type f  | sed -e 's/^.//'  >> /ws/yizaq-csi/work/acs_patch_packager/ACS_5_4_File_Paths; cd ../../../../view/build/installer/target/rpm/buildroot ; find  -type f  | sed -e 's/^.//' >> /ws/yizaq-csi/work/acs_patch_packager/ACS_5_4_File_Paths; cdacs_view 

2.  Generate source file list
- build w/ correct number
5.3: mist_bnv B.839
5.4: mist_bnv B.221
from acs dir:

[yizaq@yizaq-lnx:Tue Dec 18:985:18:/view/yizaq__yizaq.P2.P1.FCS_5_4.int.acs5_0.lx/vob/nm_acs/acs]$ find . -type f | grep -i -v 'obsolete\|old\|\.class\|\.java\|\.h\|\.cpp\|\.o\|\.d\|\.xml'   >> /ws/yizaq-csi/work/acs_patch_packager/ACS_ClearCase_FileList_54

"""
import os,sys,cmd,logging,re,pprint,shutil,commands,ConfigParser

FORMAT = "%(asctime)-15s %(levelname)s %(message)s"
#For normal prints in python 2.3 versions
#logging.basicConfig()
#For debug info
logging.basicConfig(filename="acs_patch_packager.log",level=logging.DEBUG, format=FORMAT)
logger = logging.getLogger("ACS_PATCH_PACKAGER")


class patch_mgr:
        acs_file_listing = ""
        acs_cc_file_listing = ""
        acs_files_dict = {}
        acs_cc_files_dict = {}
        patch_tmp_dir = ""
        source_files_dir = ""
        files_to_rplace_name = ""
        cfg_file_name = ""
        m_config = ConfigParser.ConfigParser()

        def __init__(self):
            #self.acs_file_listing = "ACS_5_4_File_Paths"
            #self.acs_cc_file_listing = "ACS_ClearCase_FileList_54"
            #self.source_files_dir  = "/view/yizaq__P6.P4.P3.P2.P1.FCS_5_3.int.acs5_0.lx/vob/nm_acs/acs/"
            self.acs_files_dict
            self.acs_cc_files_dict
            self.patch_tmp_dir = "/temp/" 
            self.files_to_rplace_name = "filesToReplace"
            self.cfg_file_name = "acs_patch_packager.cfg"
            self.m_config.read(self.cfg_file_name)
            self.source_files_dir  = self.m_config.get('GENERAL','src_files_base_dir')
            self.acs_file_listing = self.m_config.get('GENERAL','acs_trg_file_listing')
            self.acs_cc_file_listing = self.m_config.get('GENERAL','acs_src_file_listing')




        def load_files_list(self):
                logger.debug("patch_mgr:load_files_list")
                print "Loading ACS install path file list..."
                # 1st - code loading from default files, then try to extract from built view and view RPM

                counter = 0
                sys.stdout.write('Please wait')
                with open(self.acs_file_listing) as f:
                        for line in f:
                                #logger.debug("patch_mgr:open, reading line: %s"%line.strip())
                                #logger.debug("patch_mgr:open, matched file : %s"%os.path.basename(line))
                                if (not self.acs_files_dict.has_key(os.path.basename(line).strip())):
                                                self.acs_files_dict[os.path.basename(line).strip()] = line.strip()
                                counter = counter+1
                                if (counter%100 == 0):
                                        sys.stdout.write('.')
        
                logger.debug("patch_mgr:open, ACS files dictionary %s"%pprint.pformat(self.acs_files_dict))
                counter = 0
                with open(self.acs_cc_file_listing) as f:
                        for line in f:
                                #logger.debug("patch_mgr:open, reading line: %s"%line.strip())
                                #logger.debug("patch_mgr:open, matched file : %s"%os.path.basename(line))
                                if (not self.acs_cc_files_dict.has_key(os.path.basename(line).strip())):
                                    self.acs_cc_files_dict[os.path.basename(line).strip()] = line.strip()

                                counter = counter+1
                                if (counter%500 == 0):
                                        sys.stdout.write('.')

                sys.stdout.write('\n')
                logger.debug("patch_mgr:open, ACS Clearcase files dictionary %s"%pprint.pformat(self.acs_cc_files_dict))
        
        def create_patch(self, pname, file_list):
            logger.debug("patch_mgr:create_patch")

            # Clean up
            logger.debug("patch_mgr:create_patch - Performing clean up")
            if os.path.isdir(os.getcwd()+self.patch_tmp_dir):
                    shutil.rmtree(os.getcwd()+self.patch_tmp_dir) 

            #ToDo, copy rpm to temp dir, extract it, find files instead! 
            #or find and handle exceptions 
            #Load ACS files locations in installation
            logger.debug("patch_mgr:create_patch - loading ACS file list")
            self.load_files_list()

            #Prepare patch dir
            patch_path=os.getcwd()+self.patch_tmp_dir
            logger.debug("patch_mgr:create_patch - creating temporary patch directory %s"%pname)
            if not os.path.exists(patch_path+pname):
                    os.makedirs(patch_path+pname)
            shutil.copy("install.sh",patch_path+pname+"/install.sh")
            shutil.copy("uninstall.sh",patch_path+pname+"/uninstall.sh")
            with open("version.txt", 'w') as f:
                    f.write(pname+"\n");
            shutil.copy("version.txt",patch_path+pname+"/version.txt")
            if not os.path.exists(patch_path+pname+"/readme"):
                    os.makedirs(patch_path+pname+"/readme")
            shutil.copy("readme/Acs-5.3.0.40-Readme.txt",patch_path+pname+"/readme/ACS-"+pname+"Readme.txt")
            if not os.path.exists(patch_path+pname+"/files"):
                    os.makedirs(patch_path+pname+"/files")

            #Copy files to staging area
            with open(file_list) as f:
                for line in f:
                    #for s_file in self.acs_cc_files_dict:
                    src_file=line.strip()
                    logger.debug("patch_mgr:create_patch - copy src file %s to staging area from location %s"%(src_file, self.source_files_dir+self.acs_cc_files_dict[src_file]))
                    shutil.copy(self.source_files_dir+self.acs_cc_files_dict[src_file],patch_path+pname+"/files/"+src_file)

            #Create filesToReplace  
            with open(patch_path+pname+"/"+self.files_to_rplace_name , 'w') as f:
                    f.write("# Replace backup with checksum check\n");
                    f.write("#each entry contains : file toCopy(install) whertoCopy (install/uninstall) md5 (install) fileTorevert(uninstall)\n");
                    with open(file_list) as fl:
                        for line in fl:
                            src_file=line.strip()
                            file_to_replace_line = src_file+" "+self.acs_files_dict[src_file]+" nomd5 "+src_file+"\n"
                            logger.debug("patch_mgr:create_patch - Adding line to files to replace: %s "%file_to_replace_line)
                            f.write(file_to_replace_line)


            #Create patch  
            shutil.copy("patch.sh",patch_path+"/patch.sh")
            shutil.copy("patch.pp",patch_path+"/patch.pp")
            cur_path=os.getcwd()
            os.chdir(patch_path)
            pack_cmd_str="./patch.sh pack " + pname +" "+ pname+"/"
            ret=commands.getstatusoutput(pack_cmd_str)
            logger.debug("patch_mgr:create_patch - create patch cmd: %s\nreturns: %s"%(pack_cmd_str,ret))
            os.chdir(cur_path)
            print("Patch is created in location: %s"% patch_path+pname+"/"+pname+".tar.gpg")

            #ToDo
            # a. create readme dir + file  Acs-pname-Readme.txt, for now cp Acs-5.3.0.40-Readme.txt [Done]
            # b. create file dir [Done]
            #  b1. load Clearcase file locations same as self.acs_files_dict   [Done]
            # c. loop copy requested files to file dir according to location in self.acs_files_dict 
            # d. create and write contents of file   filesToReplace
            # e. copy patch.sh to patch dir and call patch.sh pack pname pname/



            #remove patch dir
            #os.rmdir(self.patch_tmp_dir+pname)

        def verify_patch(self, pname, file_list, ip_addr):
            logger.debug("patch_mgr:verify_patch")

            # Verify patch is created
            logger.debug("patch_mgr:verify_patch - Verify patch is created")
            if os.path.isdir(os.getcwd()+self.patch_tmp_dir+pname):
                    logger.debug("patch_mgr:verify_patch - Verified patch %s created"%pname)
            else:
                    logger.warn("patch_mgr:verify_patch - Verified patch %s created failed!"%pname)
                    return 1

            #Load ACS files locations in installation
            logger.debug("patch_mgr:verify_patch - loading Target ACS file list")
            self.load_files_list()

            #Prepare patch dir
            patch_path=os.getcwd()+self.patch_tmp_dir

            #Verify files
            with open(file_list) as f:
                for line in f:
                    src_file=line.strip()
                    logger.debug("patch_mgr:verify_patch "+80*"-"+ "\nVerify src file %s "%(src_file))

                    ret=commands.getstatusoutput("sha1sum "+self.source_files_dir+self.acs_cc_files_dict[src_file])
                    print "sha1sum: %s"%(str(ret[1]))
                    logger.debug("patch_mgr:verify_patch -sha1sum: %s"%(str(ret[1])))
                    sum1=str(ret[1]).split()[0]

                    ret=commands.getstatusoutput("sha1sum "+patch_path+pname+"/files/"+src_file)
                    print "sha1sum: %s"%(str(ret[1]))
                    logger.debug("patch_mgr:verify_patch -sha1sum: %s"%(str(ret[1])))
                    sum2=str(ret[1]).split()[0]

                    ret=commands.getstatusoutput("ssh root@"+ip_addr+" sha1sum "+self.acs_files_dict[src_file])
                    print "sha1sum: %s"%(str(ret[1]))
                    logger.debug("patch_mgr:verify_patch -sha1sum: %s"%(str(ret[1])))
                    sum3=str(ret[1]).split('\n')[2].split()[0]

                    print "sum1 "+sum1+"\nsum2 "+sum2+"\nsum3 "+sum3
                    logger.debug("patch_mgr:verify_patch -sha1sums: "+"\nsum1 "+sum1+"\nsum2 "+sum2+"\nsum3 "+sum3+"\n")
                    if (sum1 == sum2) and (sum1 == sum3):
                        print "File "+src_file+" checksums verified!\n"+80*"-"
                        logger.debug("patch_mgr:verify_patch -File "+src_file+" checksums verified!")
                    else:
                        print "File "+src_file+" checksums verification failed!!!\n"+80*"-"
                        logger.warn("patch_mgr:verify_patch -File "+src_file+" checksums verification failed!!!\n")




class app_menu(cmd.Cmd):

        p_mgr = patch_mgr() 

        def __init__(self):
                logger.debug("app_menu:__init__")
                cmd.Cmd.__init__(self)
                self.prompt = '[ACS Patch Packager]'
                self.intro = "This utility facilitates patch creation and maintanence for SAMPG ACS 5 product\nIt assumes you working in a set Clearcase view, preferably built\nType ? for avaialable commands"

        def do_create_patch(self, arg):
                """
                Create a patch from either a file containing list of files or Clearcase activity (TBD)
                """
                logger.debug("app_menu:do_create_patch")
                fn_ans = raw_input ("Please provide the file name containing the list of files to be included in the patch.\n> ")
                print "You chose input file ", fn_ans 
                """
                ToDo:
                1. Generate a full listing of ACS files on installed machine 
                        - if in built view do something like:
[yizaq@yizaq-lnx:Sun Sep 23:/view/yizaq__yizaq_5_5_dev.int.acs5_0.lx/vob/nm_acs/acs]$ rpm -qpl ./install/target/rpm/RPMS/i386/acs-5.4.0.41-100.i386.rpm
                        - if not, fallback to locak copy - ACS_Files_List 
                2. Use #1 to auto Create filesToReplace file
                3. ask for patch name
                4. create same name dir
                5. apply patch pack script functionality

                6. add list patch content command
                """
                pn_ans = raw_input ("Please provide the patch name.\n> ")
                print "You chose patch name ", pn_ans 
                self.p_mgr.create_patch(pn_ans, fn_ans)


        def help_create_patch(self, arg):
                logger.debug("app_menu:help_create_patch")

        do_c = do_create_patch

        def do_verify_patch(self, arg):
                """
                Verify an already created patch against a machine installed with this patch and against built artifacts
                """
                logger.debug("app_menu:do_verify_patch")
                fn_ans = raw_input ("Please provide the file name containing the list of files to be included in the patch.\n> ")
                print "You chose input file ", fn_ans 
                pn_ans = raw_input ("Please provide the patch name.\n> ")
                print "You chose patch name ", pn_ans 
                ip_ans = raw_input ("Please provide the machine,installed with this patch, IP address.\nPlease make sure to export public key to avoid password prompt.\n> ")
                print "You chose input IP address: ", ip_ans 
                self.p_mgr.verify_patch(pn_ans, fn_ans, ip_ans)


        def help_verify_patch(self, arg):
                logger.debug("app_menu:help_verify_patch")

        do_v = do_verify_patch

        def do_add_file_to_patch(self, arg):
                """
                Add file to an existing patch
                """
                logger.debug("app_menu:do_add_file_to_patch")

        def help_add_file_to_patch(self, arg):
                logger.debug("app_menu:help_add_file_to_patch")

        do_a = do_add_file_to_patch

        def do_delete_file_from_patch(self, arg):
                """
                delete a file from an existing patch
                """
                logger.debug("app_menu:do_delete_file_from_patch")

        def help_delete_file_from_patch(self, arg):
                logger.debug("app_menu:help_delete_file_from_patch")

        do_d = do_delete_file_from_patch

        def do_replace_file_in_patch(self, arg):
                """
                replace a file from an existing patch
                """
                logger.debug("app_menu:do_replace_file_in_patch")

        def help_replace_file_in_patch(self, arg):
                logger.debug("app_menu:help_replace_file_in_patch")

        do_r = do_replace_file_in_patch

        def do_quit(self, arg):
                logger.debug("app_menu:quit")
                print "Thank you for using SAMPG ACS patch packager."
                sys.exit(0)

        do_q = do_quit

if __name__ == '__main__' :
        apm = app_menu()
        apm.cmdloop()
		14.5.2 Usage

Subject: Instructions to create patch using automated script
 
Hi,
 
1.       Add your files to list file: acs/patches_5_4/patch_filelist
2.       Build stream w/ FCS build #
$ mvn install -Dmaven.test.skip=true -Pacs-with-view -DbuildNumber=B.221
3.       Unpack patch packager and cd to that dir
4.       Enter your view to acs_patch_packager.cfg:
src_files_base_dir=/view/<view_tag>/vob/nm_acs/acs/
5.       Run: ./acs_patch_packager.py
6.       You can get a list of commands w/ ? but for creating patch do ‘c’
7.       [ACS Patch Packager]c
Please provide the file name containing the list of files to be included in the patch.
8.       Provide path of files list file (from #1)
9.       provide the patch name e.g. 5.4.0.46.2
10.   You will get a message where patch is

		14.5.3

	14.6 /users/yizaq/work/scripts/work_utils/touch_views.sh
#!/bin/bash - 
#===============================================================================
#
#          FILE:  touch_views.sh
# 
#         USAGE:  ./touch_views.sh 
# 
#   DESCRIPTION:  
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR: Yosi Izaq
#  ORGANIZATION: Cisco SAMPG
#       CREATED: 12/16/2012 10:34:42 AM IST
#      REVISION:  ---
#===============================================================================

set -o nounset                              # Treat unset variables as an error
echo "touching $(whoami) views"
/usr/cisco/bin/access_CCview  yizaq__int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__yizaq.fcs5_1.int.acs5_0.lx   
/usr/cisco/bin/access_CCview  yizaq__yizaq.FCS_5_2.int.acs5_0.lx   
/usr/cisco/bin/access_CCview  yizaq__FCS_5_3.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__P6.P4.P3.P2.P1.FCS_5_3.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__yizaq_5_4_bugs.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__yizaq_5_5_dev.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__onebox.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__P2.P1.FCS_5_4.int.acs5_0.lx
/usr/cisco/bin/access_CCview  yizaq__yizaq.P2.P1.FCS_5_4.int.acs5_0.lx

[yizaq@yizaq-lnx:Sun Dec 16:~/work/scripts/work_utils]$ crontab -e
no crontab for yizaq - using an empty one
crontab: installing new crontab
[yizaq@yizaq-lnx:Sun Dec 16:~/work/scripts/work_utils]$ crontab -l
@monthly /users/yizaq/work/scripts/work_utils/touch_views.sh


	14.7
16. Python

	16.1 search_text.py
 Description: search for patterns in text files.
 Usage: 
        search_text.py [ <-C number > <-I> <-q> -Q "word1<&,|>words<&,|>...> ] files"
        -C, --context, Controls the context breadth, the number of lines before and after the line containing the pattern
        -I, --ignore-case, Set whether to ignore case when searching for pattern. Default is to match case.
        -q, --quiet, Set quiet mode, only matches would be printed
        -H, --highlight, Highlight the matched words with >>>word<<<
        -Q, --query, The pattern to search for, if made of list of words use & for and and | for or.

Example, find all functions that do something with a "new" instance of class "AcsSysLog":
find . -name "*.java" -exec search_text.py  -C 14 -I -q -Q "new&AcsSysLog" '{}' >> search_res \;

 Example:
 search_text.py -C 4 -I -q -Q "vi&register&list" *
 This will search for four line segments in all files in current directory.
 The search will be case insensitive and will match if the segment contains the words vi and register and list.
 Example output is:
 [yizaq@yytzhak-wxp:Mon Oct 01:/cygdrive/c/work/KB/vi:]$ search_text.py -C 4 -I -q -Q "vi&register&list" *

===== FILE: FineVimTips          LINES:     300-303     =====
----------------------------------------
" List your Registers
:reg             : display contents of all registers
:reg a           : display content of individual registers

===== FILE: vi_manual.txt        LINES:    5412-5415    =====
        vim *.cpp               Start Vim, defining the argument list to
                                contain all the C++ files.  You are now in the
                                first file.
        qq                      Start recording into the q register

===== FILE: vi_tips              LINES:     316-319     =====
----------------------------------------
" List your Registers
:reg             : display contents of all registers
:reg a           : display content of individual registers

		16.1.1 examples:
		search in KB for specific subject:
		find . -name "*" -exec search_text.py -C 8 -I  -q -H -Q "record&play" '{}' \;

search for all XML files with both odbc and 11
[yizaq@yizaq-lnx:Wed Dec 15:/view/yizaq__yizaq.PI_Rest.int.acs5_0.lx/vob/nm_acs/acs]$ find . -name '*.xml' | xargs search_text.py  -C 6 -I -
q -Q "odbc&11"

===== FILE: ./runtime/prebuilt/lnx26/include/sqlanywhere11/pom.xml LINES:      12-17      =====
  </parent>
  
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.cisco.nm.acs.runtime.prebuilt.lnx26</groupId>
  <artifactId>libdbodbc11</artifactId>

===== FILE: ./mgmt/migration/src/assembly/migration.xml LINES:      68-73      =====
              <include>dbodbc9.dll</include>
            </includes>
        </fileSet>

        <fileSet>
            <directory>../../../../enm_jdk/jre1.5.0_11/NT</directory>

===== FILE: ./pom.xml            LINES:     691-696     =====
                <type>so</type>
                <version>2.0.0</version>
            </dependency>
            <dependency>
                <groupId>com.cisco.nm.acs.runtime.prebuilt</groupId>
                <artifactId>libdbodbc11</artifactId>

===== FILE: ./pom.xml            LINES:     799-804     =====
            </dependency>

            <!-- runtime libs -->
            <dependency>
                <groupId>com.cisco.nm.acs.runtime.prebuilt</groupId>
                <artifactId>libdbodbc11_r</artifactId>

===== FILE: ./pom.xml            LINES:    1392-1397    =====

            <dependency>
                <groupId>com.sybase</groupId>
                <artifactId>jodbc</artifactId>
                <scope>compile</scope>
                <version>11</version>

===== FILE: ./install/pom.xml    LINES:     412-417     =====
                                    <type>jar</type>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>com.sybase</groupId>
                                    <artifactId>jodbc</artifactId>
                                    <version>11</version>

	16.2  dom3_hof_mgr.py
# Description: CLI for generating HoF statistics of dominions III MP games
# Usage: dom3_hof_mgr [debug level]
# Ex: /cygdrive/c/work/scripts/games/DOM3_HOF:]$ ./dom3_hof_mgr.py  debug > out

		16.2.1  source code Mon Feb 28 17:41:48 JST 2011
#!/usr/bin/python
# File: dom3_hof_mgr.py
# Author: Yosi Izaq
# Description: CLI for generating HoF statistics of dominions III MP games
# Usage: dom3_hof_mgr [debug level]
# Ex: /cygdrive/c/work/scripts/games/DOM3_HOF:]$ ./dom3_hof_mgr.py  debug > out

"""
GPL licensing

(C) Copyright, 2007 Yosi Izaq.

This file, dom3_hof_mgr.py, is part of dom3_hof_mgr programm.

dom3_hof_mgr is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

dom3_hof_mgr is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with dom3_hof_mgr.  If not, see <http://www.gnu.org/licenses/>.
"""

"""
|ToDo:
|	1. Strategic decisions. 
|	- work with a full blown DB or text file. -> text 
|	- use config manager
|	- 
|	2. decide which data containers R required
|Game won entry:
|Winner: Wraithlord (player entity)
|Game:Wrath of Opposing Fates (WOOF)
|Game Link: http://www.shrapnelcommunity.com/thr...t=8#Post531059
|Players: 12
|Nation: Caelum
|Mods: NA
|Era: Early
|
|Player entry:
|Name:
|Wons:
|Nations defeated:
|Nations won with:
|Eras won with:
|Victory Urls:
|
|Nation:
|name:
|era:
|wons:
|winning players: (list of players)
|
|Victory URL:
|url:
|nation:
|winning player:
|
|Era entry:
|era:
|list of winning nations entries
|# games
|
|
|	3. Configuration
|Nations list
|
|	4. won DB file
|	5. report gen logic
|	6. New text db and containers for team games
"""


import shutil, tarfile,ConfigParser, os, re, sys, glob, logging, copy

#Logging configuration:
FORMAT = "%(asctime)-15s %(name)s %(levelname)s %(message)s"

LEVELS = {'debug': logging.DEBUG,
          'info': logging.INFO,
          'warning': logging.WARNING,
          'error': logging.ERROR,
          'critical': logging.CRITICAL}

if len(sys.argv) > 1:
    level_name = sys.argv[1]
    level = LEVELS.get(level_name, logging.NOTSET)
    logging.basicConfig(level=level, format=FORMAT, filename='./dom3_hof_mgr.log', filemode='w')

dom3HOFLogger = logging.getLogger("dom3_hof_mgr")
#dom3HOFLogger.debug("Game name input: %s"%(self.game_name)) 
dom3HOFLogger.info("Initiating DOM3 HOF Manager") 

#class te:
#	m_t=''
#	def __init__(self, t='b'):
#		self.m_t=t
#
#	def __str__(self):
#		return self.m_t
#t = te('c')
#print t
 
# enum type classes
# enum class for Eras
class defs:
	single_db_file='dom3_MP_games_txt_db'
	game_open_entry_pat='^\s*\['
	game_close_entry_pat='^\s*\]'
	game_winner_entry_pat='^\s*winner:'
	game_winner_entry_line='('+game_winner_entry_pat+'\s*)(\w+.*$)'
	game_name_entry_pat='^\s*game:'
	game_name_entry_line='('+game_name_entry_pat+'\s*)(\w+.*$)'
	game_link_entry_pat='^\s*game\s*link:'
	game_link_entry_line='('+game_link_entry_pat+'\s*)(\w+.*$)'
	game_players_entry_pat='^\s*players:'
	game_players_entry_line='('+game_players_entry_pat+'\s*)(\w+)'
	game_winning_nation_entry_pat='^\s*nation:'
	game_winning_nation_entry_line='('+game_winning_nation_entry_pat+'\s*)(\w+.*$)'
	game_mods_entry_pat='^\s*mods:'
	game_mods_entry_line='('+game_mods_entry_pat+'\s*)(\w+.*$)'
	game_era_entry_pat='^\s*era:'
	game_era_entry_line='('+game_era_entry_pat+'\s*)(\w+.*$)'
	team_game_player_separator="&"
	tie_game_player_separator=","
	winning_players_display_list_size=15
	min_num_players_to_qualify_HoF=6

class era:
	m_ea='EA'
	m_ma='MA'
	m_la='LA'
	m_all='all'

#container classes
class game:
	"""
	game entry:
	Name:
	Winner:
	link:
	players:
	Winning nation:
	mods:
	era:
	"""

	m_name = "unknown"
	m_winner = "unknown"
	m_link = "unknown"
	#m_players = [] # ex: ['Wraithlord', 'Calmon'}
	m_players = 0
	m_winning_nation = "unknown"
	m_mods = []
	m_era = era.m_ea 

	def __init__(self, name="unknown" , winner="unknown" , link="unknown" , players=0, winning_nation="unknown", mods=[], era_p=era.m_ea):
	#	pass # so nothing statement
		self.m_name = name 
		self.m_winner = winner 
		self.m_link = link 
		self.m_players = players 
		self.m_winning_nation = winning_nation
		self.m_mods = mods 
		self.m_era = era_p 


	def __str__(self):
		return """
game Info:
Name: %s
Winner: %s
Winning Nation: %s
Era: %s
Link: %s
Players: %d
Mods: %s
"""%(self.m_name, self.m_winner, self.m_winning_nation, self.m_era, self.m_link, self.m_players, self.m_mods )

	def isValid(self):
		"""
		Verify that mandatory game fields are present
		"""
		
		if ( (self.m_name == "unknown") or (self.m_winner == "unknown") or (self.m_winning_nation == "unknown") ):
			dom3HOFLogger.debug("Game %s is not valid"%(self.m_name))	
			return False	
		else:
			return True

class player:
	"""
	Player entry:
	Name:
	Wons:
	Nations defeated:
	Nations won with:
	Eras won with:
	Victory Urls:
	"""

	m_name = "unknown"
	m_wons = 0
	m_nations_defeated = 0

	def __init__(self, name="unknown" , wons=0 , nations_defeated=0 , nations_won={} , eras_won_with={era.m_ea:0, era.m_ma:0, era.m_la:0} , V_URLs={}, if_tie_player_name="" ):
		#parameter for player name in case of tie defaults to empty string
		#dom3HOFLogger.debug("Player::__init__ player initial object %s"%(self))	
	#	pass # do nothing statement
		self.m_eras_won_with = {} #{era.m_ea:0, era.m_ma:0, era.m_la:0}
		self.m_nations_won = {} # ex: {'ma_pythium':2, 'LA_Ermor':1}
		self.m_V_URLs = {} #ex {'AsiaTwist':'http://...'}
		self.m_name = name 
# Handle ties (aaa, bbb)  and team games (aaa && bbb)
# ties should get 1/#winners points each and team games should not be counted as win
		if defs.team_game_player_separator in name:
			dom3HOFLogger.debug("Player::__init__, found a team game. doesn't count as victory - setting victory count to 0 ")	
			self.m_wons=0
		elif defs.tie_game_player_separator in name:
			num_winners = len(name.split( defs.tie_game_player_separator))
			self.m_name=if_tie_player_name
			dom3HOFLogger.debug("Player::__init__, found a tie between %s.victory point is distributed equally between %d players. Updated player %s record"%(name, num_winners, self.m_name)	)
			self.m_wons+=(wons*1.0)/num_winners
		else:
			dom3HOFLogger.debug("Player::__init__, found a single winner.")	
			self.m_wons=wons
		#self.m_wons = wons 

		self.m_nations_defeated = nations_defeated 
		self.m_nations_won = nations_won # ex: {'ma_pythium':2, 'LA_Ermor':1}
		for era,wins in eras_won_with.iteritems():
			#dom3HOFLogger.debug("Player::__init__ era %s, wins %d"%(era,wins))	
			#init all Eras to 0 wins
			#self.m_eras_won_with[era]=0
			#update according to input para
			#if era in self.m_eras_won_with:
			self.m_eras_won_with[era]=wins
		#self.m_eras_won_with = eras_won_with
		self.m_V_URLs = V_URLs #ex {'AsiaTwist':'http://...'}


	def __str__(self):
		#return "Player info:"+"\n"+"Name:"+ self.m_name
		return """
Player Info:
Name: %s
Number of Victories: %f
Number of Defeated Nations: %d
Nations won with: %s
Victories per era: %s
Victories URLs: %s
"""%(self.m_name, self.m_wons, self.m_nations_defeated, self.m_nations_won, self.m_eras_won_with, self.m_V_URLs )

#update object
	def update_with_game_result(self, game_res): # receive game result and update player instance
		dom3HOFLogger.debug("Player::update_with_game_result() called with game %s"%game_res)
		dom3HOFLogger.debug("Player::update_with_game_result player initial object %s"%(self))	

# Handle ties (aaa, bbb)  and team games (aaa && bbb)
# ties should get 1/#winners points each and team games should not be counted as win

		if defs.team_game_player_separator in game_res.m_winner:
			dom3HOFLogger.debug("Player::update_with_game_result, found a team game. doesn't count as victory ")	
		elif defs.tie_game_player_separator in game_res.m_winner:
			num_winners = len(game_res.m_winner.split( defs.tie_game_player_separator))
			self.m_wons+=1.0/num_winners
			dom3HOFLogger.debug("Player::update_with_game_result, found a tie between %s.victory point is distributed equally between %d players=%f."%(game_res.m_winner, num_winners, 1.0/num_winners)	)
		else:
			dom3HOFLogger.debug("Player::update_with_game_result, found a single winner.")	
			if game_res.m_players < defs.min_num_players_to_qualify_HoF:
				dom3HOFLogger.debug("Player::update_with_game_result, # of players %d is less than minimum %d to qualify for HoF."%(game_res.m_players, defs.min_num_players_to_qualify_HoF)	)
			else:
				self.m_wons+=1

		self.m_nations_defeated+=game_res.m_players

		#update winning nation
		if game_res.m_winning_nation in self.m_nations_won:
			dom3HOFLogger.debug("Player::update_with_game_result() player has already won with nation %s. Updating"%game_res.m_winning_nation )
			self.m_nations_won[game_res.m_winning_nation] +=1
		else:
			dom3HOFLogger.debug("Player::update_with_game_result() player has won with nation %s. Updating"%game_res.m_winning_nation )
			self.m_nations_won[game_res.m_winning_nation] =1

		#update victories per era

		dom3HOFLogger.debug("Player::update_with_game_result() Era dictionary %s"%self.m_eras_won_with)
		if (game_res.m_era in self.m_eras_won_with):
			self.m_eras_won_with[game_res.m_era]+=1
		else:
			self.m_eras_won_with[game_res.m_era]=1

		#update victory URL
		self.m_V_URLs[game_res.m_name]=game_res.m_link

		dom3HOFLogger.debug("Player::update_with_game_result() updated player object %s"%self)

#Comparison operators
	def __eq__(self, other):
		if (isinstance(other, player)): # verify we're not comparing apples and oranges :) 
			return (self.m_name == other.m_name )
		else:
			return NotImplemented
class nation:
	"""
	name:
	era:
	wons:
	winning players: (list of players)
	"""

	m_name= "unknown"
	m_era= era.m_ea
	m_wons= 0

	
	def __init__(self, name="unknown" , era=era.m_ea , wons=0 , winners={}, if_tie_nation_name="" ):
	#	pass # so nothing statement
		m_winning_players= {} #ex {'Wraithlord':2,'Micha':1}
		self.m_name = name 
		self.m_era = era 

# Handle ties (aaa, bbb)  and team games (aaa && bbb)
# ties should get 1/#winners points each and team games should not be counted as win
		if defs.team_game_player_separator in name:
			dom3HOFLogger.debug("Nation::__init__, found a team game. doesn't count as victory - setting victory count to 0 ")	
			self.m_wons=0
		elif defs.tie_game_player_separator in name:
			num_winners = len(name.split( defs.tie_game_player_separator))
			self.m_name=if_tie_nation_name
			dom3HOFLogger.debug("Nation::__init__, found a tie between %s.victory point is distributed equally between %d nations. Updated nation %s record"%(name, num_winners, self.m_name)	)
			self.m_wons+=(wons*1.0)/num_winners
		else:
			dom3HOFLogger.debug("Nation::__init__, found a single winning nation.")	
			self.m_wons=wons
		#self.m_wons = wons 

		self.m_winning_players = winners 


	def __str__(self):
		return """
Nation Info:
Name: %s
Era: %s
Number of Victories: %f
Winning Players: %s
"""%(self.m_name, self.m_era, self.m_wons, self.m_winning_players)

#update object
	def update_with_game_result(self, game_res): # receive game result and update nation instance
		dom3HOFLogger.debug("nation::update_with_game_result() called with game %s"%game_res)
		#dom3HOFLogger.debug("nation::update_with_game_result nation initial object %s"%(self))	

# Handle ties (aaa, bbb)  and team games (aaa && bbb)
# ties should get 1/#winners points each and team games should not be counted as win

		if defs.team_game_player_separator in game_res.m_winning_nation:
			dom3HOFLogger.debug("Nation::update_with_game_result, found a team game. doesn't count as victory ")	
		elif defs.tie_game_player_separator in game_res.m_winning_nation:
			num_winners = len(game_res.m_winning_nation.split( defs.tie_game_player_separator))
			self.m_wons+=1.0/num_winners
			dom3HOFLogger.debug("Nation::update_with_game_result, found a tie between %s.victory point is distributed equally between %d nations=%f."%(game_res.m_winner, num_winners, 1.0/num_winners)	)
		else:
			dom3HOFLogger.debug("Nation::update_with_game_result, found a single winning nation.")	

			# for HoF nation victory count must meet minimum players criterie
			if game_res.m_players < defs.min_num_players_to_qualify_HoF:
				dom3HOFLogger.debug("Nation::update_with_game_result, # of players %d is less than minimum %d to qualify for HoF."%(game_res.m_players, defs.min_num_players_to_qualify_HoF)	)
			else:
				self.m_wons+=1

#			# for HoF nation victory count must meet minimum players criterie
#		if game_res.m_players < defs.min_num_players_to_qualify_HoF:

		#update winning players
		if game_res.m_winner in self.m_winning_players:
			dom3HOFLogger.debug("nation::update_with_game_result() player %s has already won with this nation. Updating"%game_res.m_winner )
			self.m_winning_players[game_res.m_winner] +=1
		else:
			dom3HOFLogger.debug("nation::update_with_game_result() player %s has won with this nation. Updating"%game_res.m_winner )
			self.m_winning_players[game_res.m_winner] =1

#Comparison operators
	def __eq__(self, other):
		if (isinstance(other, nation)): # verify we're not comparing apples and oranges :) 
			return (self.m_name == other.m_name )
		else:
			return NotImplemented

class era_wins:
	"""
	name:
	games:
	winning nations: {'MA_Pythium':5}
	"""

	m_era= era.m_ea
	m_games= 0
	m_winning_nations= {} #ex {'MA_Pythium':2,'MA_Pangaea':1}

	
	def __init__(self, era=era.m_ea , games=0 , winners={}):
	#	pass # so nothing statement
		self.m_era = era 
		self.m_games = games 
		self.m_winning_nations = winners 


	def __str__(self):
		return """
Era Info:
Era: %s
Number of Games: %d
Winning Nations: %s
"""%(self.m_era, self.m_games, self.m_winning_nations)

#comarison ops 
def player_comp(p1,p2):
	#dom3HOFLogger.debug("my_comps::player_comp() comparing player %s to player %s"%(p1,p2))
	if (isinstance(p1, player) and isinstance(p2, player) ):
		#compare:
		if p1.m_wons == p2.m_wons:
			return cmp(p1.m_nations_defeated, p2.m_nations_defeated)
		return cmp(p1.m_wons , p2.m_wons)
	else:
		dom3HOFLogger.warn("my_comps::player_comp() at least one of the objects in not a player"%(p1,p2))


def nation_comp(p1,p2):
	#dom3HOFLogger.debug("my_comps::nation_comp() comparing nation %s to nation %s"%(p1,p2))
	if (isinstance(p1, nation) and isinstance(p2, nation) ):
		#compare:
#		if p1.m_wons == p2.m_wons:
#			return cmp(p1.m_nations_defeated, p2.m_nations_defeated)
		return cmp(p1.m_wons , p2.m_wons)
	else:
		dom3HOFLogger.warn("my_comps::nation_comp() at least one of the objects in not a nation"%(p1,p2))


	
class GameDataCollector:
	"""
	responsible 4 gathering data from single (as opposed to team) dom III MP games
	"""

	"""
	states: init- start loading DB, still haven't seen a single game entry
		game- loading game entry
		fin- finished processing the db
	"""
	m_states=['init', 'game', 'fin'] 
	ms_init,ms_game,ms_fin = range(3)
	m_state=m_states[ms_init]
	m_games=[] # list of games

	m_ea_wins = era_wins(era.m_ea,0,{}) 
	m_ma_wins = era_wins(era.m_ma,0,{}) 
	m_la_wins = era_wins(era.m_la,0,{}) 

#Load container instances with data from DB
	def parseDB(self):
		dom3HOFLogger.info("Loading DB %s"%defs.single_db_file)
		db_file=open(defs.single_db_file).readlines()
		self.m_state=self.m_states[self.ms_init] #init
		temp_game=()
		line_counter=0

		for line in db_file:
			line_counter+=1
			dom3HOFLogger.debug("Processing line %d:%s"%(line_counter,line))
############################ INIT State ######################
			if self.m_state == self.m_states[self.ms_init]: #in init state 
				if re.match(defs.game_open_entry_pat, line ):
					self.m_state=self.m_states[self.ms_game] # found [ so init -> game
					dom3HOFLogger.info("Found game report entry. Switch to state %s "%(self.m_state))
					#cleanup game object
					temp_game = game()
############################ INIT State ######################

##Passing from init to finit state directly is illegal (as result of empty game entry)
#			if self.m_state == self.m_states[self.ms_init]: #in init state 
#				if re.match(defs.game_close_entry_pat, line ):
#					dom3HOFLogger.warn("Found empty game paragraph at line %s"%(line_counter))
############################ GAME State ######################
			if self.m_state == self.m_states[self.ms_game]: #in game state 
				#match winner
				if re.match(defs.game_winner_entry_pat, line, re.I ):
					match=re.match(defs.game_winner_entry_line,line,re.I)
					temp_game.m_winner=match.group(2)
					temp_game.m_winner=temp_game.m_winner.strip().lower()

					dom3HOFLogger.debug("Found game winner %s "%(temp_game.m_winner))
				#match name
				if re.match(defs.game_name_entry_pat, line, re.I ):
					match=re.match(defs.game_name_entry_line,line,re.I)
					temp_game.m_name=match.group(2)
					temp_game.m_name=temp_game.m_name.strip()
					dom3HOFLogger.debug("Found game name %s "%(temp_game.m_name))
				#match players
				if re.match(defs.game_players_entry_pat, line, re.I ):
					match=re.match(defs.game_players_entry_line,line,re.I)
					temp_game.m_players=int(match.group(2))
					#temp_game.m_players=temp_game.m_players.strip()
					dom3HOFLogger.debug("Found game players %s "%(temp_game.m_players))
				#match winning_nation
				if re.match(defs.game_winning_nation_entry_pat, line, re.I ):
					match=re.match(defs.game_winning_nation_entry_line,line,re.I)
					temp_game.m_winning_nation=match.group(2)
					temp_game.m_winning_nation=temp_game.m_winning_nation.strip()
					dom3HOFLogger.debug("Found game winning nation %s "%(temp_game.m_winning_nation))
				#match mods
				if re.match(defs.game_mods_entry_pat, line, re.I ):
					match=re.match(defs.game_mods_entry_line,line,re.I)
					temp_game.m_mods=match.group(2)
					temp_game.m_mods=temp_game.m_mods.strip()
					dom3HOFLogger.debug("Found game mods %s "%(temp_game.m_mods))
				#match era
				if re.match(defs.game_era_entry_pat, line, re.I ):
					match=re.match(defs.game_era_entry_line,line,re.I)
					temp_game.m_era=match.group(2)
					temp_game.m_era=temp_game.m_era.strip()
					dom3HOFLogger.debug("Found game era %s "%(temp_game.m_era))
				#match link
				if re.match(defs.game_link_entry_pat, line, re.I ):
					match=re.match(defs.game_link_entry_line,line,re.I)
					temp_game.m_link=match.group(2)
					temp_game.m_link=temp_game.m_link.strip()
					dom3HOFLogger.debug("Found game link %s "%(temp_game.m_link))

				#End game entry
				if re.match(defs.game_close_entry_pat, line ):
					dom3HOFLogger.debug("Gathered game data: %s. Proceeding to verification "%temp_game)
					if temp_game.isValid():
						self.m_games.append(temp_game)
					else:
						dom3HOFLogger.warn("Game %s verification failed at line %d"%(temp_game.m_name, line_counter))
					self.m_state=self.m_states[self.ms_init] # found ] so init -> game
					dom3HOFLogger.info("Found game report entry end. Switch to state %s "%(self.m_state))

############################ GAME State ######################

############################ FINIT State #####################
		self.m_state=self.m_states[self.ms_fin]
		dom3HOFLogger.info("Finished processing DB. State %s"%(self.m_state))
############################ FINIT State #####################
				
		dom3HOFLogger.debug("Game list: %s"%(self.m_games))
		return self.m_games

class GameDataReporter:
	"""
This class generates HoF reports from a list of game win reports
	"""
#	m_players={} # dictionary of 'player name':player 
#	m_nations={} # dictionary of 'nation name':nation 
	m_players=[] #player data
	#m_players_names = [] # list of names of players in m_players list
	m_nations=[] #nation data
	#m_nations_names = [] # list of names of nations in m_nations list
	m_eras= [ era_wins(era.m_ea), era_wins(era.m_ma), era_wins(era.m_la)] 
	m_games=[]

	def generateSingleGameReport(self, games): #generate report from a list of game objects
		dom3HOFLogger.info("Generating single game report. Game Data: %s"%games)
		#self.m_games=copy.copy(games)
		self.m_games=games
		#Todo, process game by game. Fill lists of players, nations and era wins
		# Then proceed to sort the lists

		#Temp objects for player and nation
############################ Start game date loop ######################
		for game in games:
			#temp_nation = nation()
			#temp_player = player()
			temp_players = [] # list is required for ties
			temp_nations = [] # list is required for ties
			dom3HOFLogger.debug("Collecting data of game: %s "%game)
			#temp_nation = nation(game.m_winning_nation, game.m_era, 1, {game.m_winner:1})

			#update list of players who won this game (usually - 1 but could be more in case of tie or team)
			if defs.tie_game_player_separator in game.m_winner: #tie
				for p in (game.m_winner.split(defs.tie_game_player_separator)):
					temp_players.append(player(game.m_winner, 1, game.m_players, {game.m_winning_nation:1}, {game.m_era:1}, {game.m_name:game.m_link}, p.strip()))
					dom3HOFLogger.debug("Found one of tie winners: %s "%p.strip())
			else:
				#temp_player = player(game.m_winner, 1, game.m_players, {game.m_winning_nation:1}, {game.m_era:1}, {game.m_name:game.m_link} )
				temp_player =  player(game.m_winner, 1, game.m_players, {game.m_winning_nation:1}, {game.m_era:1}, {game.m_name:game.m_link} ,"") 
				temp_players.append (temp_player)

			#update list of nations who won this game (usually - 1 but could be more in case of tie or team)
			if defs.tie_game_player_separator in game.m_winning_nation: #tie
				for p in (game.m_winning_nation.split(defs.tie_game_player_separator)):
					temp_nations.append(nation(game.m_winning_nation, game.m_era, 1, {game.m_winner:1}, p.strip()))
					dom3HOFLogger.debug("Found one of tie winners: %s "%p.strip())
			else:
				temp_nations.append(nation(game.m_winning_nation, game.m_era, 1, {game.m_winner:1}))

			dom3HOFLogger.debug("Collecting data. Nation: %s \nPlayer(s): %s "%(temp_nations, temp_players))
						
			#update nation & player names lists (which are used to conveniently test for membership in the data lists
#			if temp_nation.m_name in self.m_nations_names:
#				dom3HOFLogger.debug("Nation %s is already in nations list"%(temp_nation.m_name ))
#				#ToDo find nation in list and update it
#				# Todo overide _eq_ and use the in list operator to find nation/player in list
#			else:
#				dom3HOFLogger.debug("Nation %s is added to nations list"%(temp_nation.m_name ))
#				self.m_nations_names.append(temp_nation.m_name) 

			#update players
			for p in temp_players:
				if p in self.m_players:
					dom3HOFLogger.debug("Player %s is already in players list"%(p.m_name ))
					player_index = self.m_players.index(p)
					self.m_players[player_index].update_with_game_result(game)
					#ToDo, if tie (player name contains defs.tie_game_player_separator == ',') then update each of the tied player's records
				else:
					dom3HOFLogger.debug("Player %s is added to players list"%(p.m_name ))
					self.m_players.append(p) 

# in case of ties update each of the tied nations with the information. who won (the tied players), and another win/num_winners to victory count.
			#update nations
			for p in temp_nations:
				if p in self.m_nations:
					dom3HOFLogger.debug("nation %s is already in nations list"%(p.m_name ))
					nation_index = self.m_nations.index(p)
					self.m_nations[nation_index].update_with_game_result(game)
				else:
					dom3HOFLogger.debug("nation %s is added to nations list"%(p.m_name ))
					self.m_nations.append(p) 

		# end of: for game in games:

		#debug print players
		dom3HOFLogger.debug("Printing current players list")
		self.m_players.sort(player_comp, reverse=True)
		for i,p in enumerate(self.m_players):
			dom3HOFLogger.debug("Player %d in list: %s"%(i+1,p))


		#debug print nations
		dom3HOFLogger.debug("Printing current nations list")
		self.m_nations.sort(nation_comp, reverse=True)
		for i,p in enumerate(self.m_nations):
			dom3HOFLogger.debug("Nation %d in list: %s"%(i+1,p))

		#debug prints nation wins, filter according to the eras
		ea_nations = filter(lambda x: x.m_era == era.m_ea,  self.m_nations)
		ma_nations = filter(lambda x: x.m_era == era.m_ma,  self.m_nations)
		la_nations = filter(lambda x: x.m_era == era.m_la,  self.m_nations)
		for i,p in enumerate(ea_nations):
			dom3HOFLogger.debug("EA Nation %d in list: %s"%(i+1,p))
		for i,p in enumerate(ma_nations):
			dom3HOFLogger.debug("MA Nation %d in list: %s"%(i+1,p))
		for i,p in enumerate(la_nations):
			dom3HOFLogger.debug("LA Nation %d in list: %s"%(i+1,p))
		# ToDo debug prints team wins, filter players according to player name containing defs.team_game_player_separator ('&') 
		winning_teams = filter(lambda x: defs.team_game_player_separator in x.m_name, self.m_players)
		for i,p in enumerate(winning_teams):
			dom3HOFLogger.debug("Team %d in list: %s"%(i+1,p))


			#ToDo: think how to deal with ties, i.e: winner:aaa,bbb
			# and team game, i.e. AAA & BBB
############################ End   game date loop ######################
############################ End   class GameDataReporter ######################

class GameDataFormatter:
	"""
	Handle all the aspects of presenting the information
	"""

	def printHoF_Shrapnel_forums( self, gdr):
		"""
		Prints the information in a manner compatible with Shrapnel forums HoF thread
		Expects to receive a GameDataReporter that contains players and nations information
		"""
		dom3HOFLogger.debug("GameDataFormatter:printHoF_Shrapnel_forums: begin results print")
		s_prefix="""
Victorious Nations

All Age Mega Game
Winners: Zeldor - Game:Kingmaker - Players: 63 - Nation: LA Argatha - Mods: custom
		"""
		print "%s"%s_prefix

		#filter lists of nations per era, remove team games
		ea_nations = filter(lambda x: (x.m_era == era.m_ea) and (not (defs.team_game_player_separator in x.m_name)),  gdr.m_nations)
		ma_nations = filter(lambda x: (x.m_era == era.m_ma) and (not (defs.team_game_player_separator in x.m_name)),  gdr.m_nations)
		la_nations = filter(lambda x: (x.m_era == era.m_la) and (not (defs.team_game_player_separator in x.m_name)),  gdr.m_nations)
		all_age_nations = filter(lambda x: (x.m_era == era.m_all) and (not (defs.team_game_player_separator in x.m_name)),  gdr.m_nations)

		ea_wins=0
		for n in ea_nations:
			ea_wins += n.m_wons
		print "Early(%f)\n"%ea_wins
		for p in ea_nations:
			print("%-16s: %-6.2f "%(p.m_name,p.m_wons))
		#print "Early(%d)"%reduce(lambda x,y: x.m_wons+y.m_wons, ea_nations)
		#print "Early(%d)"%reduce(lambda x,y: x+y, ea_nations)

		ma_wins=0
		for n in ma_nations:
			ma_wins += n.m_wons
		print "\nMid(%f)\n"%ma_wins
		for p in ma_nations:
			print("%-16s: %-6.2f "%(p.m_name,p.m_wons))

		la_wins=0
		for n in la_nations:
			la_wins += n.m_wons
		print "\nLate(%f)\n"%la_wins
		for p in la_nations:
			print("%-16s: %-6.2f "%(p.m_name,p.m_wons))

## reserve for printing all age winning nations
#		all_age_wins=0
#		for n in all_age_nations:
#			all_age_wins += n.m_wons
#		print "\nAll age(%f)\n"%all_age_wins
#		for p in all_age_nations:
#			print("%-16s: %-6.2f "%(p.m_name,p.m_wons))

		print"\nThe Hall of Honor\n"

		#filter lists of games per era, remove team games
		print "Early\n"
		dom3HOFLogger.debug("GameDataFormatter:printHoF_Shrapnel_forums: games %s"%gdr.m_games)
		ea_games = filter(lambda x: (x.m_era == era.m_ea) and (not (defs.team_game_player_separator in x.m_winner)),  gdr.m_games)
		for g in ea_games:
			print("Winner(s): %-16s -game: %-20s - Players: %-3d - Nations(s): %-16s"%(g.m_winner, g.m_name, g.m_players, g.m_winning_nation))

		print "\nMid\n"
		ma_games = filter(lambda x: (x.m_era == era.m_ma) and (not (defs.team_game_player_separator in x.m_winner)),  gdr.m_games)
		for g in ma_games:
			print("Winner(s): %-16s -game: %-20s - Players: %-3d - Nations(s): %-16s"%(g.m_winner, g.m_name, g.m_players, g.m_winning_nation))

		print "\nLate\n"
		la_games = filter(lambda x: (x.m_era == era.m_la) and (not (defs.team_game_player_separator in x.m_winner)),  gdr.m_games)
		for g in la_games:
			print("Winner(s): %-16s -game: %-20s - Players: %-3d - Nations(s): %-16s"%(g.m_winner, g.m_name, g.m_players, g.m_winning_nation))

		print "\nAll age\n"
		all_age_games = filter(lambda x: (x.m_era == era.m_all) and (not (defs.team_game_player_separator in x.m_winner)),  gdr.m_games)
		for g in all_age_games:
			print("Winner(s): %-16s -game: %-20s - Players: %-3d - Nations(s): %-16s"%(g.m_winner, g.m_name, g.m_players, g.m_winning_nation))

		print "\nTeam games\n"
		team_games = filter(lambda x: defs.team_game_player_separator in x.m_winner, gdr.m_games)
		for g in team_games:
			print("Winners: %-16s -game: %-20s - Players: %-3d - Nations(s): %-16s"%(g.m_winner, g.m_name, g.m_players, g.m_winning_nation))

		print "\nHall of Fame\n"
		#print the top 15 (defs.winning_players_display_list_size) winning players excluding team winners
		for i,p in enumerate(filter(lambda x: not (defs.team_game_player_separator in x.m_name), gdr.m_players)[:defs.winning_players_display_list_size]):
			print("%-2d- %-16s %.2f/%2d"%(i+1,p.m_name, p.m_wons, p.m_nations_defeated)) 

		for i,p in enumerate(filter(lambda x: not (defs.team_game_player_separator in x.m_name), gdr.m_players)):
			dom3HOFLogger.debug("%-2d- %-16s %.2f/%2d"%(i+1,p.m_name, p.m_wons, p.m_nations_defeated)) 

############################ End   class GameDataFormatter ######################

def test_enums_n_defs():
	dir(defs)
	dir(era)

def test_game():
	g = game();
	g_wl = game('the Quick and the Dead', 'Calmon', 'link',11,'LA Ermor',['mod_a','mod_b'], era.m_la)
	dom3HOFLogger.info("test_game: %s"%g)  
	dom3HOFLogger.info("test_game: %s"%g_wl)  

def test_player():
	p = player();
	p_wl = player('WraithLord', 6, 78, {'MA_Pythium':2,'MA_Ulm':1,'EA_Caelum':1,'LA_Patala':1,'MA_Jotunheim':1},{'EA':1,'MA':4, 'LA':1},{'Frechdachs Gangbang':'unknown','Wrath of Opposing Fates (WOOF)':'http://www.shrapnelcommunity.com/threads/showflat.php?Cat=&amp;Number=483972&amp;page=0&amp;view=collapsed&amp;sb=5&amp;o=7&amp;fpart=8#Post531059','Dagur':' (http://www.shrapnelcommunity.com/threads/showflat.php?Cat=&amp;Number=543333) ','Hydrant':'unknown','Victoria':'unknown','Asia Twist':'unknown'} )
	dom3HOFLogger.info("test_player: %s"%p)  
	dom3HOFLogger.info("test_player: %s"%p_wl)  
	dom3HOFLogger.info("test_player: %s"%p)  

def test_nation():
	n=nation()
	n_pyth=nation('MA_Pythium', era.m_ma, 20, {'Wraithlord':2,'Micha':1})
	dom3HOFLogger.info("test_nation: %s"%n)  
	dom3HOFLogger.info("test_nation: %s"%n_pyth)  

def test_era_wins():
	e=era_wins()
	e_la=era_wins(era.m_la, 20, {'LA_Pythium':2,'Patala':1})
	dom3HOFLogger.info("test_era: %s"%e)  
	dom3HOFLogger.info("test_era: %s"%e_la)  

def test_single_game_parse():
	gdc = GameDataCollector()
	games = gdc.parseDB()
	for g in games:
		dom3HOFLogger.info("test game parser. game: %s"%g)  
	gdr = GameDataReporter()
	gdr.generateSingleGameReport(games)
	gdf = GameDataFormatter()
	gdf.printHoF_Shrapnel_forums(gdr)

def test():
	test_enums_n_defs()
	test_game()
	test_player()
	test_nation()
	test_era_wins()
	test_single_game_parse()

test()

		16.2.2


	16.3 reportDMClashes.py
# Description: script for reporting conflicts in DOM-III mod files
# Usage: reportDMClashes <list of .dm files>
"""
It works like this
a. go to mods dir
b. run: python [path/to/file]reportDMClashes.py  on list of .dm files to check, ex:
[/cygdrive/c/games/dominions3/mods/mod_not_in_use:]$ python /cygdrive/c/work/scripts/games/reportDMClashes.py  *.dm  
  
Warns go to stdout and logs go to reportDMClashes.log (set to log when >= INFO).

Snippet of very long list of conflicts when running check on a bunch of old mods:

Warning: found conflict! ID 2755 appears 3 times.
At Dominions 3000 v0.75.dm:4829, as type: monster, name Ice Samurai Battle Suit
At Githzerai.dm:426, as type: monster, name Psion
At Shangri La.dm:862, as type: monster, name Dmag Dpon
Warning: found conflict! ID 2525 appears 2 times.
At AI Ogre Kingdoms.dm:1351, as type: monster, name Slavegiant
At Dominions 3000 v0.75.dm:8532, as type: monster, name Primordia Regina
Warning: found conflict! ID 2748 appears 2 times.
At Githzerai.dm:287, as type: monster, name Soryo
At Shangri La.dm:601, as type: monster, name Rta Pa
Warning: found conflict! ID 2749 appears 2 times.
At Githzerai.dm:304, as type: monster, name Zerain
At Shangri La.dm:640, as type: monster, name Guardian of the Hidden Valley
Warning: found conflict! ID 2750 appears 3 times.
At Dominions 3000 v0.75.dm:4729, as type: monster, name Aka-Oni
At Githzerai.dm:323, as type: monster, name Inzen
At Shangri La.dm:679, as type: monster, name Mi G<F6>
Warning: found conflict! ID 2751 appears 3 times.
At Dominions 3000 v0.75.dm:4773, as type: monster, name Ao-Oni
At Githzerai.dm:341, as type: monster, name Ninja
At Shangri La.dm:711, as type: monster, name Mi G<F6> Rngon Pa
Warning: found conflict! ID 705 appears 2 times.
At Dominions 3000 v0.75.dm:617, as type: weapon, name Lightning Cannon
At Githzerai.dm:58, as type: weapon, name Fists of the Grandmaster
Warning: found conflict! ID 2754 appears 2 times.
At Dominions 3000 v0.75.dm:4801, as type: monster, name Fire Samurai Battle Suit
At Githzerai.dm:410, as type: monster, name Majishan
Warning: found conflict! ID 707 appears 4 times.
At Dominions 3000 v0.75.dm:651, as type: weapon, name Needler
At Githzerai.dm:76, as type: weapon, name Stunning Fist
At WH191andCBM16.dm:1234, as type: weapon, name Orna
At WH19andCBM16.dm:1227, as type: weapon, name Orna
Warning: found conflict! ID 2756 appears 3 times.
At Dominions 3000 v0.75.dm:4856, as type: monster, name Lightning Samurai Battle Suit
At Githzerai.dm:444, as type: monster, name Guru
At Shangri La.dm:897, as type: monster, name Rta Dmag Go
Warning: found conflict! ID 2205 appears 2 times.
At MC_NI_ Indy_Pack.dm:605, as type: monster, name item
At Nephilim.dm:249, as type: monster, name Feral
Warning: found conflict! ID 2757 appears 3 times.
At Dominions 3000 v0.75.dm:4884, as type: monster, name Gokenin
At Githzerai.dm:462, as type: monster, name Senin
At Shangri La.dm:936, as type: monster, name Rje
Warning: found conflict! ID 2758 appears 3 times.
At Dominions 3000 v0.75.dm:4914, as type: monster, name Wraith Suit Shinobi
At Githzerai.dm:481, as type: monster, name Dai-Zerain
At Shangri La.dm:976, as type: monster, name Drapa
Warning: found conflict! ID 2759 appears 3 times.
At Dominions 3000 v0.75.dm:4946, as type: monster, name Hatamoto
At Githzerai.dm:513, as type: monster, name Ghost Gith Commoner
At Shangri La.dm:1018, as type: monster, name Ngagspa
Warning: found conflict! ID 2760 appears 3 times.
At Dominions 3000 v0.75.dm:4976, as type: monster, name Daimyo
At Githzerai.dm:536, as type: monster, name Seirei
At Shangri La.dm:1057, as type: monster, name Demon Hunter
Warning: found conflict! ID 2761 appears 3 times.
At Dominions 3000 v0.75.dm:5006, as type: monster, name Dai-Oni
At Githzerai.dm:552, as type: monster, name Tamashi
At Shangri La.dm:1096, as type: monster, name Ragyapa
...

"""

		16.3.1 Source code Mon Feb 28 17:40:59 JST 2011
#!/usr/bin/python
# File: reportDMClashes.py
# Author: Yosi Izaq, aka WraithLord
# Description: script for reporting conflicts in DOM-III mod files
# Usage: reportDMClashes <list of .dm files>
"""
It works like this
a. go to mods dir
b. run: python [path/to/file]reportDMClashes.py  on list of .dm files to check, ex:
[/cygdrive/c/games/dominions3/mods/mod_not_in_use:]$ python /cygdrive/c/work/scripts/games/reportDMClashes.py  *.dm  
  
Warns go to stdout and logs go to reportDMClashes.log (set to log when >= INFO).

Snippet of very long list of conflicts when running check on a bunch of old mods:

Warning: found conflict! ID 2755 appears 3 times.
At Dominions 3000 v0.75.dm:4829, as type: monster, name Ice Samurai Battle Suit
At Githzerai.dm:426, as type: monster, name Psion
At Shangri La.dm:862, as type: monster, name Dmag Dpon
Warning: found conflict! ID 2525 appears 2 times.
At AI Ogre Kingdoms.dm:1351, as type: monster, name Slavegiant
At Dominions 3000 v0.75.dm:8532, as type: monster, name Primordia Regina
Warning: found conflict! ID 2748 appears 2 times.
At Githzerai.dm:287, as type: monster, name Soryo
At Shangri La.dm:601, as type: monster, name Rta Pa
Warning: found conflict! ID 2749 appears 2 times.
At Githzerai.dm:304, as type: monster, name Zerain
At Shangri La.dm:640, as type: monster, name Guardian of the Hidden Valley
Warning: found conflict! ID 2750 appears 3 times.
At Dominions 3000 v0.75.dm:4729, as type: monster, name Aka-Oni
At Githzerai.dm:323, as type: monster, name Inzen
At Shangri La.dm:679, as type: monster, name Mi G<F6>
Warning: found conflict! ID 2751 appears 3 times.
At Dominions 3000 v0.75.dm:4773, as type: monster, name Ao-Oni
At Githzerai.dm:341, as type: monster, name Ninja
At Shangri La.dm:711, as type: monster, name Mi G<F6> Rngon Pa
Warning: found conflict! ID 705 appears 2 times.
At Dominions 3000 v0.75.dm:617, as type: weapon, name Lightning Cannon
At Githzerai.dm:58, as type: weapon, name Fists of the Grandmaster
Warning: found conflict! ID 2754 appears 2 times.
At Dominions 3000 v0.75.dm:4801, as type: monster, name Fire Samurai Battle Suit
At Githzerai.dm:410, as type: monster, name Majishan
Warning: found conflict! ID 707 appears 4 times.
At Dominions 3000 v0.75.dm:651, as type: weapon, name Needler
At Githzerai.dm:76, as type: weapon, name Stunning Fist
At WH191andCBM16.dm:1234, as type: weapon, name Orna
At WH19andCBM16.dm:1227, as type: weapon, name Orna
Warning: found conflict! ID 2756 appears 3 times.
At Dominions 3000 v0.75.dm:4856, as type: monster, name Lightning Samurai Battle Suit
At Githzerai.dm:444, as type: monster, name Guru
At Shangri La.dm:897, as type: monster, name Rta Dmag Go
Warning: found conflict! ID 2205 appears 2 times.
At MC_NI_ Indy_Pack.dm:605, as type: monster, name item
At Nephilim.dm:249, as type: monster, name Feral
Warning: found conflict! ID 2757 appears 3 times.
At Dominions 3000 v0.75.dm:4884, as type: monster, name Gokenin
At Githzerai.dm:462, as type: monster, name Senin
At Shangri La.dm:936, as type: monster, name Rje
Warning: found conflict! ID 2758 appears 3 times.
At Dominions 3000 v0.75.dm:4914, as type: monster, name Wraith Suit Shinobi
At Githzerai.dm:481, as type: monster, name Dai-Zerain
At Shangri La.dm:976, as type: monster, name Drapa
Warning: found conflict! ID 2759 appears 3 times.
At Dominions 3000 v0.75.dm:4946, as type: monster, name Hatamoto
At Githzerai.dm:513, as type: monster, name Ghost Gith Commoner
At Shangri La.dm:1018, as type: monster, name Ngagspa
Warning: found conflict! ID 2760 appears 3 times.
At Dominions 3000 v0.75.dm:4976, as type: monster, name Daimyo
At Githzerai.dm:536, as type: monster, name Seirei
At Shangri La.dm:1057, as type: monster, name Demon Hunter
Warning: found conflict! ID 2761 appears 3 times.
At Dominions 3000 v0.75.dm:5006, as type: monster, name Dai-Oni
At Githzerai.dm:552, as type: monster, name Tamashi
At Shangri La.dm:1096, as type: monster, name Ragyapa
...

"""

"""
GPL licensing

(C) Copyright, 2011 Yosi Izaq.

This file, reportDMClashes.py, is part of reportDMClashes programm.

reportDMClashes is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

reportDMClashes is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with reportDMClashes.  If not, see <http://www.gnu.org/licenses/>.
"""

"""
Top lvl design
|1. Syntax of .dm
Example -

#newarmor 340
#name "Armor of Bugginess"
#def -1
#type 5
#enc 1
#prot 13
#rcost 11
#end

#newarmor 340
#name "Armor of Suckiness"
#def -3
#type 5
#enc 5
#prot 2
#rcost 15
#end

|2. container class for item (contains it's ID and name + file name and line #)
 
a. process argv

b. treat each item as file name and load each item into a [id, item(id, name, file, line)] dictionary

 -- regexp defs for parsing a mod entry

c. data structure that will facilitate the end result. Meaning:

Mod_Items {} (dictionary), keys --------------- Item IDs ------------
						:
			item list [], item1, item2, ...
				item, class: ID, type, name, file, line, attrs		
Conflicts are by definition Mod_Item Keys that have values with more than one item

"""

import shutil, tarfile,ConfigParser, os, re, sys, glob, logging, copy, pickle

#Logging configuration:
FORMAT = "%(asctime)-15s %(name)s %(levelname)s %(message)s"

LEVELS = {'debug': logging.DEBUG,
          'info': logging.INFO,
          'warning': logging.WARNING,
          'error': logging.ERROR,
          'critical': logging.CRITICAL}


#if len(sys.argv) > 1:
#level_name = sys.argv[1]
#level_name = 'debug'
level_name = 'info'
level = LEVELS.get(level_name, logging.NOTSET)
logging.basicConfig(level=level, format=FORMAT, filename='./reportDMClashes.log', filemode='w')

dom3DM_ClashReporterLogger = logging.getLogger("reportDMClashes")
dom3DM_ClashReporterLogger.info("Initiating  reportDMClashes") 


class defs:
	item_open_entry_pat='^#new'
	item_type_line=item_open_entry_pat+'(\w+)\s*(\d+)'
	item_close_entry_pat='^#end'
	item_attribute_prefix='^#'
	item_attribute_value_line=item_attribute_prefix+'(\w+)\s+("?\.?\/?\w+.*)"?$'
	item_attribute_line=item_attribute_prefix+'(\w+)'
	name_line=item_attribute_prefix+'name'+'\s*"(.*)"'

class item:
	"""
		id - identifier
		name - name
		type - type (armor/weapon/unit ... )
		file - mode file
		line - line #
		attrs - additional attributs {attr_name:value,...}
		Ex:
	#newweapon 864
	#name "Warrior Shuriken"
	#dmg 10
	#att 2
	#def 0
	#len 0
	#range 12
	#ammo 2
	#nratt 2
	#nostr
	#sound 19
	#flyspr 111 1
	#rcost 3
	#armorpiercing
	#end

	"""

	m_id = 0
	m_name = ""
	m_type = ""
	m_file = ""
	m_line = 0
	m_attrs = {}

	def __init__(self, id=0 , name="item", type="none", file = "file.dm", line = 0, attrs={}):
		self.m_id = id;
		self.m_name = name;
		self.m_type = type;
		self.m_file = file;
		self.m_line = line;
		self.m_attrs = attrs;

	def __str__(self):
		return """
Mod entry Info:
ID: %d
Name: %s
Type: %s
File: %s
Line: %d
Attrs: %s
"""%(self.m_id, self.m_name, self.m_type, self.m_file, self.m_line, self.m_attrs)

class DomIII_DM_Clash_Reporter:
	"""
	Main worker class
	"""

	m_mod_items_list = {} # a dictionary of {item ID : [item1, item2_id] }

	def parseMod(self, mod_file_name):
		"""
		Parse the mod & return items dictionary
		"""
		dom3DM_ClashReporterLogger.info("Parsing mod file %s"%mod_file_name) 
		mod_file = open(mod_file_name).readlines()


		"""
		states: init- start loading mod file, still haven't seen a single entry
			entry -  loading mod entry
			fin- finished processing the mod file
		"""
		states=['init', 'entry', 'fin'] 
		init,entry,fin = range(3)
		state=states[init]
		entries={} # mod entry/item dictionary
		temp_item=()
		line_counter=0

		for line in mod_file:
			line_counter+=1
			dom3DM_ClashReporterLogger.debug("Processing line %d:%s"%(line_counter,line))
############################ INIT State ######################
			if state == states[init]: #in init state 
				if re.match(defs.item_open_entry_pat, line ):
					state=states[entry] # found [ so parsing a mod entry
					dom3DM_ClashReporterLogger.debug("Found a mod entry. Switching to state %s "%(state))
					#cleanup item object
					temp_item = item()
					match = re.match(defs.item_type_line, line) #Note that #newspell entries don't have IDs and will be set to "fake" ID 0
					if match: #When dealing with a mod entry that has ID
						temp_item.m_type = match.group(1)
						temp_item.m_id = int(match.group(2))
					else: #When dealing with a mod entry that don't have ID - like spell
						temp_item.m_type = "spell"
						temp_item.m_id = 0

					temp_item.m_file = mod_file_name
					temp_item.m_line = line_counter
					dom3DM_ClashReporterLogger.info("Entry. Type: %s, ID: %d, %s:%d "%(temp_item.m_type, temp_item.m_id, temp_item.m_file, temp_item.m_line  ))
############################ INIT State ######################
############################ ENTRY State #####################
			if state == states[entry]: #in entry state 
				
				#match name & attrs
				if re.match(defs.name_line, line):
					match=re.match(defs.name_line, line)
					temp_item.m_name=match.group(1)

					dom3DM_ClashReporterLogger.debug("Found item name %s "%(temp_item.m_name))

				#attr value line
				elif re.match(defs.item_attribute_value_line, line):
					if re.match(defs.item_open_entry_pat, line ):
						dom3DM_ClashReporterLogger.debug("Skipping entry opening line since it was already parsed")
					else: #Real attr 
						match = re.match(defs.item_attribute_value_line, line)
						temp_item.m_attrs[match.group(1)] = match.group(2).strip()

						dom3DM_ClashReporterLogger.debug("Found item attr:value pair %s:%s "%(match.group(1), temp_item.m_attrs[match.group(1)] ))

				#End entry
				elif re.match(defs.item_close_entry_pat, line ):
					dom3DM_ClashReporterLogger.debug("Finished Gathering item data: %s."%temp_item)
	#match attrs and put in dictonary m_mod_items_list , if key exists add to list
					#add item to items dictionary. 
					if self.m_mod_items_list.has_key(temp_item.m_id):
						dom3DM_ClashReporterLogger.debug("Item %s ID already exists in items dictionary, adding to list."%temp_item.m_name)
						self.m_mod_items_list[temp_item.m_id].append(temp_item)
					else: #New item with this ID
						dom3DM_ClashReporterLogger.debug("Item %s added to items dictionary"%temp_item.m_name)
						self.m_mod_items_list[temp_item.m_id]= [temp_item]



					state=states[init] 
					dom3DM_ClashReporterLogger.debug("Found modentry end. Switch to state %s "%(state))
				#attr line
				elif re.match(defs.item_attribute_line, line):
					match = re.match(defs.item_attribute_line, line)
					temp_item.m_attrs[match.group(1)] = ""

					dom3DM_ClashReporterLogger.debug("Found item attr %s "%(match.group(1)) )
#				else:
#
#					dom3DM_ClashReporterLogger.debug("Found blank or comment line  %s"%(line)
############################ ENTRY State #####################


############################ FINIT State #####################
		state=states[fin]
		dom3DM_ClashReporterLogger.info("Finished processing mod file %s. State %s"%(mod_file_name, state))
############################ FINIT State #####################
				
				#raw print item dictionary

		#dom3DM_ClashReporterLogger.debug("Printing full items dictionary: %s"%(pickle.dumps(self.m_mod_items_list)))
		dom3DM_ClashReporterLogger.debug("Printing full items dictionary:")
		for itr_item_key in self.m_mod_items_list.keys() :
			for itr_item in self.m_mod_items_list[itr_item_key] :
				dom3DM_ClashReporterLogger.debug("%s\n"%itr_item)
			
		#dom3DM_ClashReporterLogger.debug("Game list: %s"%(self.m_games))
############################ END OF mod lines parse loop  ####
		dom3DM_ClashReporterLogger.info("Complete mod file parsing")




	def parseMods(self):
		dom3DM_ClashReporterLogger.info("parsing the mod files into working memory. Files %s"%sys.argv)

		for file in sys.argv[1:]:
			self.parseMod(file)

		dom3DM_ClashReporterLogger.info("Complete mod files parsing")


	def reportConflicts(self):
		dom3DM_ClashReporterLogger.info("Reporting ID conflicts in the sepecified mod files")
		self.parseMods()
		#filter all non 0 ID items (i.e non spells) that appear in more than one mod file
		conflict_list = filter (lambda x: (len(self.m_mod_items_list[x]) > 1) and (self.m_mod_items_list[x][0].m_id !=0) , self.m_mod_items_list.keys() )
		for conf in conflict_list:
			#raw print
			#print "Warning found conflict %s"%self.m_mod_items_list[conf]

			#beutify print, item ID, + list of File:line, type name 
			dom3DM_ClashReporterLogger.info("Warning: found conflict! ID %d appears %d times."%(self.m_mod_items_list[conf][0].m_id, len(self.m_mod_items_list[conf])))
			print "Warning: found conflict! ID %d appears %d times."%(self.m_mod_items_list[conf][0].m_id, len(self.m_mod_items_list[conf]))
			for itr in self.m_mod_items_list[conf] :
				dom3DM_ClashReporterLogger.info("At %s:%d, as type: %s, name %s"%(itr.m_file, itr.m_line, itr.m_type, itr.m_name) )
				print "At %s:%d, as type: %s, name %s"%(itr.m_file, itr.m_line, itr.m_type, itr.m_name) 

		dom3DM_ClashReporterLogger.info("Completed reporting conflicts")



if __name__ == '__main__':
	DMCR = DomIII_DM_Clash_Reporter();
	DMCR.reportConflicts()

		16.3.2

	16.4 FTP helper


		16.4.1 Upload binary file automatically
cat /cygdrive/x/work/scripts/python/my_py_ftp
#!/usr/bin/python

#Author yosi izaq
#usage [yizaq@yizaq-lnx:Thu Jun 07:/ws/yizaq-csi/temp]$ ~/work/scripts/python/my_py_ftp cd-acs-ftp upload/yizaq acs.tar.gz
import sys, getopt
from ftplib import FTP

def main():
    try:
        opts, args = getopt.getopt(sys.argv[1:], "h:v", ["help"])
    except getopt.GetoptError, err:
        # print help information and exit:
        print str(err) # will print something like "option -a not recognized"
        usage()
        sys.exit(2)
    output = None
    verbose = False
    for o, a in opts:
        if o == "-v":
            verbose = True
        elif o in ("-h", "--help"):
            usage()
            sys.exit()
        else:
            assert False, "unhandled option"

    print "arguemtns are: ", args
    if len(args) == 3: #FTP, DIR to CWD, FILE to upload
        ftp=FTP(args[0])
        ftp.login()
        ftp.cwd(args[1])
        ftp.storbinary
        
        f=open(args[2],'r')
        print "uploading file %s"%args[2], " to %s"%args[0], " in dir %s"%args[1] 
        ftp.storbinary('STOR '+args[2], f)
        f.close()
        ftp.quit()
    # ...

if __name__ == "__main__":
    main()
		16.4.2


	16.5

17. Display directory and/or files tree
	This one is actually an alias, but quite a useful one so I put it here.
	#Directory display tree
alias tree="ls -R |  sed -e '/:$/s/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"
alias dir_tree="ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"


18. Remote file push/pull/copy/move procedures
	actually, small aliasses that are only needed if rcp/rsh are not allowed on system
_pull_file_ssh(){

        echo "SSH copy file from remote host"


        if  [ $# -ne 3 ]
                then
                        echo "Usage pull_file_ssh <remote file> <remote host> <local file>"
        else
                echo "copying $1 to $3 from machine $2"
                ssh $2  cat $1 > $3
        fi

}
_push_file_ssh(){

        echo "SSH move file to remote host"
        echo "Usage push_file_ssh <local file> <remote host> <remote file>"


        if  [ $# -ne 3 ]
                then
                        echo "Usage push_file_ssh <local file> <remote host> <remote file>"
        else
                echo "copying $1 to $3 on machine $2"
                cat $1 | ssh $2  cat ">" $3
        fi

}

alias push_file_ssh='_push_file_ssh'
alias pull_file_ssh='_pull_file_ssh'

	18.1 cpr_fast, also note the following alias performs a much faster directory copy than cp -r
_cpr_fast(){

#Description: This alias copied directories much faster than cp -r
#Usage: $ cpr_fast source target
#Author Yosi Izaq
        echo "This alias copies directories much faster than cp -r"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpr_fast source target"
        else
                echo "copying $1 to $2"
                ( cd $1  && tar cf - . ) | (cd $2  && tar xvpf - ) 
        fi  

}
#Efficient replacment to cp -r
alias cpr_fast='_cpr_fast'


19. sed scripts

	19.1 section commenter
#!/bin/bash
#===============================================================================
#
#          FILE:  section_commenter.sh
# 
#         USAGE:  ./section_commenter.sh [-c] "#comment this section" <file>
# 
#   DESCRIPTION: If -c flag is used with <comment> then comment the section in file that contains  
#               the given comment (add # prefix to each section line)  otherwise will uncomment the section 
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:   (Yosi Izaq), 
#       COMPANY:  
#       VERSION:  1.0
#       CREATED:  09/03/2009 04:33:43 PM IDT
#      REVISION:  ---
#===============================================================================

if [ "$1" = "-c" ]; then
    COMMENT='yes';
    shift;
else
    COMMENT='no';
fi

if [ "$COMMENT" = "yes" ]; then
    sed -i "/$1/,/^$/s/^[^#]/#&/g" "$2"
else
    sed -i "/$1/,/^$/s/^#\+//g" "$2"
#add an extra # to comment line b/c it should stay commented
    sed -i "s/$1/#$1/" "$2"
fi

	19.2

20. Work scripts

	20.1 Modify DNS Settings 
-------------------------------------------------------------------------------------------------------------
#!/bin/bash
#===============================================================================
#
#          FILE:  dns_resolver.sh
# 
#         USAGE:  ./dns_resolver.sh [AD_LAB/CSCO_IT]
# 
#   DESCRIPTION: uses section_commenter.sh script to modify /etc/resolv.conf file and restart nscd services
#               so that either AD_LAB or Cisco IT DNS settings take effect
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:   (Yosi Izaq), 
#       COMPANY:  
#       VERSION:  1.0
#       CREATED:  09/03/2009 04:33:43 PM IDT
#      REVISION:  ---
#===============================================================================

DNS_FILE="/etc/resolv.conf"
CSCO_IT="Cisco IT" 
AD_LAB="for AD 3.0a setup"

if [ "$1" = "AD_LAB" ]; then
    section_commenter.sh  -c "$CSCO_IT" $DNS_FILE
    section_commenter.sh  "$AD_LAB" $DNS_FILE
elif [ "$1" = "CSCO_IT" ]; then
    section_commenter.sh  -c "$AD_LAB" $DNS_FILE
    section_commenter.sh  "$CSCO_IT" $DNS_FILE
else
    echo "usage: ./dns_resolver.sh [AD_LAB/CSCO_IT]"
    echo "uses section_commenter.sh script to modify /etc/resolv.conf file and restart nscd services so that either AD_LAB or Cisco IT DNS settings take effect" 
    exit -1
fi

/etc/rc.d/init.d/nscd restart

-------------------------------------------------------------------------------------------------------------

And aliasses:
alias set_ad_lab_dns='sudo dns_resolver.sh   AD_LAB'
alias set_cisco_IT_dns='sudo dns_resolver.sh   CSCO_IT'

	20.2 surpress_valgring_acs_errors 
#!/bin/bash

#File surpress_valgring_acs_errors 
#Author Yosi Izaq
#Description surpress a list of unwanted valgrind errors. 
#Usage, Run surpress_valgring_acs_errors <valgrind_report_file>


SURPRESS_LIST=(  'vg_replace_malloc.c:342' )

ARGS=1

function help(){
        echo "Usage surpress_valgring_acs_errors <valgrind_report_file>"
        exit -1
}

#if (( ${#*} != 2 ))
if [ $# -ne "$ARGS" ]
then 
        help
fi



for symbol in ${SURPRESS_LIST[@]}
do
        echo "surpressing symbol: ${symbol} on file $1"
        sed -n '
        /'"$symbol"'/-1,/==  [A-Z]/p
        ' $1
done

	20.3 zeorize_keys.bash
#!/bin/bash
#===============================================================================
#
#          FILE:  zeorize_keys.bash
# 
#         USAGE:  ./zeorize_keys.bash 
# 
#   DESCRIPTION: accepts a file parameter. The file is made of lines containing file names to be shredded 
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:   (Yosi Izaq), 
#       COMPANY:  
#       VERSION:  1.0
#       CREATED:  01/03/10 16:25:31 JST
#      REVISION:  ---
#===============================================================================


help ()
{
	echo "This script shreds all key material files as listed in the file that serves as it's only argument";
	echo "usage:";
	echo "zeorize_keys.bash <keys_file>"
}

ARGS=1

if [ $# -ne "$ARGS" ]
then 
        help
else
	echo "Key file list $1";
fi


Key_Files=$( cat $1 )

for file in ${Key_Files[@]}
do
	echo "Shredding key file $file"
	shred -z --remove $file
done




	20.4 Automation of Centrify integration to ACS


#!/usr/local/bin/bash
#===============================================================================
#
#          FILE:  integrate_Centrify_4_6_x2ACS_5_1.bash
# 
#         USAGE:  ./integrate_Centrify_4_6_x2ACS_5_1.bash 
# 
#   DESCRIPTION:  
# script that automatically performs the integration to ACS.
# Accept one argument, path to RPM location
# Has hard coded parameters:
#  a. path to temporary workspace
#  b. working view
#
#  Pre conditions:
#  a. Clearcase stream + view + activity
#  b. valid Centrify RPMs 
# extract RPM and copy all required files as CC elements
# For SO sum links follow CC procedure (open case if needed)
# For files that require merging (addebug and centrifyDC files) don't copy just emmit a message that they require a merging
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:   Yosi Izaq
#       COMPANY:   Cisco 
#       VERSION:  1.0
#       CREATED:  Mon Apr  9 16:49:33 IDT 2012
#      REVISION:  ---
#===============================================================================


#
# Detailed Description:
####################################################################################################
#ACS Centrify Structure:
#Libs:
#1. For ACS to build:
#[yizaq@yizaq-lnx:Thu Aug
#21:/view/yizaq__yizaq.int.acs5_0.lx/vob/nm_acs/acs/runtime/prebuilt/lnx2
#6/lib]$ ls -l libcapi.so liblrpc.so
#lrwxrwxrwx  1 yizaq eng 22 Apr  8 18:11 libcapi.so ->
#libcapi.so.0.4.1.0-209
#lrwxrwxrwx  1 yizaq eng 22 Apr  8 18:04 liblrpc.so ->
#liblrpc.so.0.4.1.0-209
#
#2. For binaries depends:
#[yizaq@yizaq-lnx:Thu Aug
#21:/view/yizaq__yizaq.int.acs5_0.lx/vob/nm_acs/acs/runtime/prebuilt/lnx2
#6/lib]$ ls -l adagent/ adagent/kerberos/
#adagent/:
#total 1977
#drwxrwxr-x  2 yizaq eng     867 Apr 14 16:19 kerberos/
#-r--r--r--  1 yizaq eng   85563 Apr 14 16:19 libcapi.so
#-r--r--r--  1 yizaq eng   85563 Apr 14 16:19 libcapi.so.0.0.0
#-r--r--r--  1 yizaq eng   31904 Apr 14 16:19
#libgcc_s-3.4.6-20060404.so.1
#-r--r--r--  1 yizaq eng    4171 Apr 14 16:19 libgnugetopt.so.1
#-r--r--r--  1 yizaq eng   45204 Apr 14 16:19 liblber-2.2.so.7.0.19
#-r--r--r--  1 yizaq eng  209535 Apr 14 16:19 libldap-2.2.so.7.0.19
#-r--r--r--  1 yizaq eng  226323 Apr 14 16:19 libldap_r-2.2.so.7.0.19
#-r--r--r--  1 yizaq eng  818484 Apr 14 16:19 liblrpc.so.0.0.0
#-r--r--r--  1 yizaq eng   52147 Apr 14 16:19 libsn2princ.so.0.0.0
#-r--r--r--  1 yizaq eng  804084 Apr 14 16:19 libstdc++.so.6.0.3
#-r--r--r--  1 yizaq eng   11958 Apr 14 16:19 libuuid.so.1.2
#-rw-------  1 yizaq eng 1624747 Apr 21 13:11 nohup.out
#
#adagent/kerberos/:
#total 488
#-r--r--r--  1 yizaq eng  11521 Apr 14 16:19 libcom_err.so
#-r--r--r--  1 yizaq eng  11521 Apr 14 16:19 libcom_err.so.3.0
#-r--r--r--  1 yizaq eng  14375 Apr 14 16:19 libdes425.so.3.0
#-r--r--r--  1 yizaq eng 100801 Apr 14 16:19 libgssapi_krb5.so.2.2
#-r--r--r--  1 yizaq eng 106358 Apr 14 16:19 libgssrpc.so.4.0
#-r--r--r--  1 yizaq eng 148043 Apr 14 16:19 libk5crypto.so.3.0
#-r--r--r--  1 yizaq eng  92651 Apr 14 16:19 libkdb5.so.4.0
#-r--r--r--  1 yizaq eng 470929 Apr 14 16:19 libkrb5.so.3.2
#-r--r--r--  1 yizaq eng   9994 Apr 14 16:19 libkrb5support.so.0.0
#
#We need to know in case SO depend versions change since in ACS install
#procedure we create required symbolic links for Centrify CLI to work,
#like for example:
#ln -s libcapi.so.0.0.0 libcapi.so.0
#ln -s libgcc_s-3.4.6-20060404.so.1 libgcc_s.so
#ln -s libgcc_s-3.4.6-20060404.so.1 libgcc_s.so.1
#ln -s libgnugetopt.so.1 libgnugetopt.so
#ln -s liblber-2.2.so.7.0.19 liblber-2.2.so.7
#ln -s liblber-2.2.so.7.0.19 liblber.so
#ln -s libldap-2.2.so.7.0.19 libldap-2.2.so.7
#ln -s libldap_r-2.2.so.7.0.19 libldap_r-2.2.so.7
#ln -s libldap_r-2.2.so.7.0.19 libldap_r.so
#ln -s libldap-2.2.so.7.0.19 libldap.so
#ln -s liblrpc.so.0.0.0 liblrpc.so
#ln -s liblrpc.so.0.0.0 liblrpc.so.0
#ln -s libsn2princ.so.0.0.0 libsn2princ.so
#ln -s libsn2princ.so.0.0.0 libsn2princ.so.0
#ln -s libstdc++.so.6.0.3 libstdc++.so
#ln -s libstdc++.so.6.0.3 libstdc++.so.6
#ln -s libuuid.so.1.2 libuuid.so.1
#
#Binaries:
#All required binaries and scripts. Including the two versions of
#centrifydc.
#
#Configuration files:
#[yizaq@yizaq-lnx:Thu Aug
#21:/view/yizaq__yizaq.int.acs5_0.lx/vob/nm_acs/acs/runtime/prebuilt/lnx2
#6/etc]$ ls
#centrifydc.conf  centrifydc.conf.contrib  group.ignore  group.ovr.sample
#passwd.ovr.sample  upgradeconf.conf  user.ignore
#
#Headers:
#[yizaq@yizaq-lnx:Thu Aug
#21:/view/yizaq__yizaq.int.acs5_0.lx/vob/nm_acs/acs/runtime/prebuilt/lnx2
#6/include]$ ls adagent/
#adobject.h*    cimsexcept.h*  error_util.h*   hash_map_glue.h*  lber.h*
#ldap_utf8.h*     lrpc.h*          slapi-plugin.h*
#adtime.h*      cims.h*        getaddrinfo.h*  int64.h*
#lber_types.h*     libcharset.h*    osport.h*        strcls.h*
#basetypes.h*   config.h       getopt.h*       ipc_exception.h*
#ldap_cdefs.h*     licensetype.h*   pom.xml          stringarray.h*
#capi_utils.h*  dn.h*          global.h*       ipcmessage.h*
#ldap_features.h*  localcharset.h*  pom.xml.contrib  thread.h*
#cdclber.h*     dsnames.h*     group_type.h*   ipc_opcodes.h*    ldap.h*
#lock.h*          properties.h*    user.h*
#centrifydc.h*  dstype.h*      guid.h*         ipcserver.h*
#ldap_schema.h*    log.h*           sid.h*
#
####################################################################################################
# Extraction procedure:
#It seems to me you'd like to put all the shared objects in a directory called:
#    
#    .../acs/runtime/prebuilt/lnx26/lib/adagent & adagent/Kerberos
#
#And not have to recreate all the symbolic links by hand.    I would do the following:
#
#mkdir work
#cd work
#rpm2cpio centrifydc-4.1.3-501-rhel4-i386.rpm | cpio -ivd
#mv ./usr/share/centrifydc/lib/*.so* .../acs/runtime/prebuilt/lnx26/lib/adagent
#mv ./usr/share/centrifydc/Kerberos/lib/*.so* \
#                        .../acs/runtime/prebuilt/lnx26/lib/adagent/Kerberos
#mv ./etc/centrifydc/* .../acs/runtime/prebuilt/lnx26/etc/centrifydc
#
#Thus, you'll no longer need to recreate all the symlinks by hand.
#
#The cli binaries are located in /usr/share/centrifydc/libexec.   The process I described below should be applied to any other file you are interested in.   Note the cdcexec shell script is only required if you have non-compatible shared objects in the path, or you need to change the location of the shared libraries.   Since it appears you are doing the later, I assume you’ve figured this out.
#
####################################################################################################

#ToDo
# 1. Add extraction of include files,
#Change script to accept three parameters:
#$ [yizaq@yizaq-lnx:Mon Sep 01:~/work/centrify/scripts]$ ./integrate_Centrify_4_1_x2ACS_5_0.bash  /tmp/centrifydc-4.1.3-502-rhel4-i386.rpm centrifydc-sdk-4.1.0-rhel4-i386.rpm centrifydc-oemsdk-4.1.0-rhel4-i386.rpm
#Now the two additional RPMs contain the include files, in paths:
#/usr/share/centrifydc/sdk/capi/include/
#/usr/share/centrifydc/include/
#/usr/share/centrifydc/sdk/oem/include/
#
#So add to extract headers a procedure to gather includes from all those dirs and iterate over them all!
# Do it after script is complete since inclyde files aren't changing in coming releases.
# 2. Add deploy of configuration files, then binaries then libs

#Global parameters:
#ToDo, externalize to configuration file
SRC_VER="0.4.5.0-357"
TRG_VER="0.4.6.0-109"
CENT_4_x_prev_tmp="/ws/yizaq-csi/temp/centrify-4.5.0-357/"
CENT_4_6_tmp="/ws/yizaq-csi/temp/centrify-4.6.0-109/"
View_Path="yizaq__yizaq.P2.P1.FCS_5_4.int.acs5_0.lx"
SRC_ACS_PATH_Prefix="/view/${View_Path}/vob/nm_acs/acs/"
LIBS_PATH="${CENT_4_6_tmp}/usr/share/centrifydc/lib/"
KERB_LIBS_PATH="${CENT_4_6_tmp}/usr/share/centrifydc/kerberos/lib/"
HOME_PATH="$(pwd)"
LOG_FILE="${HOME_PATH}/integrate_Centrify_4_6_x_2ACS_5.log"

function help(){
        echo "Usage `basename $0` path to Centrify 4.1.x RPMs"
        echo "Example:"
        echo "./integrate_Centrify_4_6_x2ACS_5_0.bash  /ws/yizaq-csi/work/Acs/Centrify/4_5/350/"
        cat <<-HELP_MSG
Note, since the script updates ACS files in clearcase you must set view prior to running it.
Note, since the script updates ACS files in clearcase you must set an activity prior to running it.
Note, script will leave files in check out state. This is for user to review results and make manual changes if requird. At the end of the integration run a routine to check in all files.
For issues please contact yizaq@cisco.com

HELP_MSG
        echo "script global parameters (important). Change as needed!"
        echo "Temporary staging folder: ${CENT_4_5_tmp}"
        echo "Clearcase view path: ${View_Path}"
}

#Globals
#ARGS=3 # RPM, OEM and OEM-SDK
ARGS=1
WORK_DIR_PREF="/tmp"
WORK_DIR=""
RPM_NAME=""
#Subdir in which Centrify RPM is extracted
DIR_NAME=""
ACS_RT_DIR=""
ACS_CENTRIFY_INCLUDE_DIR=""

VIEW_NOT_SET_ERROR=64
MISSING_ARGS=65

function calculate_acs_paths(){
echo "calculate_acs_paths() " | tee -a $LOG_FILE
echo "************************************************************************************************************************" | tee -a $LOG_FILE
echo "calculate_acs_paths() calculating ACS paths" | tee -a $LOG_FILE
if   cleartool pwv | grep "Set view" | grep NONE  > /dev/null
then
        echo "calculate_acs_paths() error, view is not set!" | tee -a $LOG_FILE
        help
        exit ${VIEW_NOT_SET_ERROR}
else 
        echo "calculate_acs_paths() view is set" | tee -a $LOG_FILE
fi

view_name=$( cleartool pwv | awk ' /Set view/ {print $3 }' )
vob_path="/view/${view_name}/vob/nm_acs/acs"
ACS_RT_DIR="${vob_path}/runtime"
ACS_CENTRIFY_INCLUDE_DIR="${ACS_RT_DIR}/prebuilt/lnx26/include" #here there are two subdirs adagent and adagent_capi
ACS_CENTRIFY_CONF_DIR="${ACS_RT_DIR}/prebuilt/lnx26/etc" #All configuration files are located here
ACS_CENTRIFY_BIN_DIR="${ACS_RT_DIR}/prebuilt/lnx26/bin" #All CLI files are located here
ACS_CENTRIFY_LIB_DIR="${ACS_RT_DIR}/prebuilt/lnx26/lib" #All library files are located here


echo "calculate_acs_paths() Working view is ${view_name}" | tee -a $LOG_FILE
echo "calculate_acs_paths() ACS RT dir is ${ACS_RT_DIR}" | tee -a $LOG_FILE
echo "calculate_acs_paths() ACS Centrify include dir is ${ACS_CENTRIFY_INCLUDE_DIR}" | tee -a $LOG_FILE
echo "calculate_acs_paths() ACS Centrify configuration dir is ${ACS_CENTRIFY_CONF_DIR}" | tee -a $LOG_FILE
echo "calculate_acs_paths() ACS Centrify binaries dir is ${ACS_CENTRIFY_BIN_DIR}" | tee -a $LOG_FILE
echo "calculate_acs_paths() ACS Centrify library dir is ${ACS_CENTRIFY_LIB_DIR}" | tee -a $LOG_FILE

echo "************************************************************************************************************************" | tee -a $LOG_FILE
echo "" | tee -a $LOG_FILE
}

#===  FUNCTION  ================================================================
#          NAME:  extract_rpms
#   DESCRIPTION:  extract a list of RPMs supplied to it 
#    PARAMETERS:  a list of positional parameters of paths to RPMs that need extraction 
#       RETURNS:  
#===============================================================================
function extract_rpms(){
        echo "extract_rpms()" | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

# All below do the same, loop over arg list. I tried the many forms since an annoying bug I created
# had pasted together some of the arguments :(
#while [ $# -gt 0 ]
#do
#        echo "extract_rpms(), extracting rpm $1 "
#        shift
#done

#for rpm in "$@" 
#do
#        echo "extract_rpms(), extracting rpm ${rpm} "
#done

#args=$ARGS
#while [ $args -gt 0 ]
#do
#        echo "extract_rpms(), extracting rpm ${args} "
#        (( args-- ))
#done

#numargs=$#
#for ((i=1 ; i <= numargs ; i++)); do
#  echo "extract_rpms(), extracting rpm $1"
#  shift
#done

for arg; do

#extract_rpms "$( basename $1 ) $( basename $2 ) $( basename $3 ) "
  echo "extract_rpms(), extracting rpm $arg, basename $(basename $arg)" | tee -a $LOG_FILE
  extract_rpm $(basename $arg)
done


        echo "Generating full diff report from previous version to log file..." | tee -a $LOG_FILE 
        diff -r $CENT_4_x_prev_tmp $CENT_4_6_tmp >> $LOG_FILE 
        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}


function extract_rpm(){
echo "extract_rpm() " | tee -a $LOG_FILE
echo "************************************************************************************************************************" | tee -a $LOG_FILE

        RPM_NAME=$1
##Extract name of work dir, based on first RPM location
#        if [ -z $WORK_DIR ]
#        then
#
#                echo "extract_rpm(), setting working directory"
#                WORK_DIR=${1%%\.rpm}
#                WORK_DIR=${WORK_DIR_PREF}/${WORK_DIR}
#
#                #Verify working dir exists and is in good shape
#                if [ -d $WORK_DIR ]
#                then
#                        echo "extract_rpm() working directory already exists. It will be emptied of content."
#                        #TEMP: For testing temporarily disable deletion (since I'm manually changing headers in order to see they are updated in CC)
#                        #rm -fr "${WORK_DIR}\*" && echo "extract_rpm() removed contents of ${WORK_DIR}"
#                else 
#                        echo "extract_rpm() working directory doesn't exists. It will be created."
#                        mkdir ${WORK_DIR} && echo "extract_rpm() succesfuly created ${WORK_DIR}" || echo "extract_rpm() failed to create dir ${WORK_DIR}"
#                fi
#        fi

        WORK_DIR="${CENT_4_6_tmp}"
        echo "extract_rpm() Extracting centrify RPM $1 into $WORK_DIR" | tee -a $LOG_FILE


        cd ${WORK_DIR} && echo "extract_rpm() cd to ${WORK_DIR}" || echo "extract_rpm() failed to cd to ${WORK_DIR}" | tee -a $LOG_FILE
        #cp ../${RPM_NAME} . && echo "extract_rpm() copied ${RPM_NAME} to `pwd`"  || echo "extract_rpm() failed to copy ${RPM_NAME} to `pwd`"

        #Extract RPM contents
        echo "extract_rpm() Executing: rpm2cpio ${RPM_NAME} | cpio -ivd " | tee -a $LOG_FILE
        if rpm2cpio ${RPM_NAME} | cpio -ivd >& /dev/null #no input to stdio please
        then
                echo "extract_rpm() Succefuly extracted contents of ${RPM_NAME} to `pwd`" | tee -a $LOG_FILE
        else
                echo "extract_rpm() Failed to extract contents of ${RPM_NAME} to `pwd`" | tee -a $LOG_FILE
                exit 1
        fi

        cd -

echo "************************************************************************************************************************" | tee -a $LOG_FILE
echo "" | tee -a $LOG_FILE
}

#===  FUNCTION  ================================================================
#          NAME:  add_file_cc
#   DESCRIPTION:  Copy a different version of a file into CC
#    PARAMETERS: takes two arguments, path to source file can be non CC element 
#               Second argument is file in CC to be created as clearcase element and then copied from 
#               source file.
#       RETURNS:  
#===============================================================================
function add_file_cc(){
        echo "" | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        #ToDo, change from logic of updating to logic of adding a new file
        if [ $# -ne 2 ]
        then
                echo "Error, function add_file_cc() requires 2 arguments, source and destination files" | tee -a $LOG_FILE
        else
                echo "Creating file $1 based on $2" | tee -a $LOG_FILE
                #ToDo, change to CO parent dir of $1, make element and copy $2 
                echo "CO dir `dirname $1`" | tee -a $LOG_FILE
                if cleartool co -nc $( dirname $1) 
                then
                        if cleartool mkelem -nc $1
                        then

                                if cp -f $2 $1 
                                then
                                        echo "Succefuly copied file $2 to $1" | tee -a $LOG_FILE
                                else
                                        echo "Failed to copy file $2 to $1" | tee -a $LOG_FILE
                                fi
                                else
                                        echo "Failed to create CC element $1" | tee -a $LOG_FILE
                                fi
                        cleartool ci -nc $( dirname $1) 
                else
                        echo "failed to CO dir `dirname $1`" | tee -a $LOG_FILE
                fi
#                if cleartool co -nc $1 
#                then
#                        echo "Succefuly COed file $1" | tee -a $LOG_FILE
#
#                        #copy file from RPM location to ACS CC
#                        if cp -f $2 $1 
#                        then
#                                echo "Succefuly copied file $2 to $1" | tee -a $LOG_FILE
#                        else
#                                echo "Failed to copy file $2 to $1" | tee -a $LOG_FILE
#                        fi
#
#                else
#                        echo "Failed to CO file $1. Make sure you have set an activity!" | tee -a $LOG_FILE
#                fi

        fi
        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}
#===  FUNCTION  ================================================================
#          NAME:  update_file_cc
#   DESCRIPTION:  Copy a different version of a file into CC
#    PARAMETERS: takes two arguments, path to source file can be non CC element 
#               Second argument is file in CC to be updated
#       RETURNS:  
#===============================================================================
function update_file_cc(){
        echo "" | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        if [ $# -ne 2 ]
        then
                echo "Error, function update_file_cc() requires 2 arguments, source and destination files" | tee -a $LOG_FILE
        else
                echo "Updating file $1 with $2" | tee -a $LOG_FILE
                #chekout file
                if cleartool co -nc $1 
                then
                        echo "Succefuly COed file $1" | tee -a $LOG_FILE

                        #copy file from RPM location to ACS CC
                        if cp -f $2 $1 
                        then
                                echo "Succefuly copied file $2 to $1" | tee -a $LOG_FILE
                        else
                                echo "Failed to copy file $2 to $1" | tee -a $LOG_FILE
                        fi

                else
                        echo "Failed to CO file $1. Make sure you have set an activity!" | tee -a $LOG_FILE
                fi

        fi
        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

function deploy_configuration()
{
        echo "deploy_configuration() " | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        echo "deploy_configuration() deploying Centrify configuration files to ACS clearcase file system" | tee -a $LOG_FILE

        echo "deploy_configuration() locating configuration files in $ACS_CENTRIFY_CONF_DIR ..." | tee -a $LOG_FILE
        cd "${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/etc"  || echo "failed to cd to ${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/etc" | tee -a $LOG_FILE

        echo "deploy_configs() checkout dir: $(pwd) " | tee -a $LOG_FILE
        cleartool co -nc .

        AD_CFGS=( $(ls ) )

        echo "deploy_configs() Processing config files: ${AD_CFGS[@]}"  | tee -a $LOG_FILE

        for config in ${AD_CFGS[@]} ; do
                trg_config=$(find "$CENT_4_6_tmp/etc/centrifydc/" -name $config | sed -ne '1p') 

                if [ -z $trg_config ] ; then
                        echo "deploy_configs() File $config not found in RPM. It will be removed from Clearcase!"
                        cleartool rm  $config 
                else
                        echo "deploy_configs() Processing config file $config with target $trg_config"  | tee -a $LOG_FILE
                        if  diff $trg_config $config >/dev/null ; then
                                echo "deploy_configs() $config same " | tee -a $LOG_FILE; 
                        else 
                                echo "deploy_configs()  $config differ and will be updated" | tee -a $LOG_FILE; 
                                cleartool co -nc "$config"; 
                                cp $trg_config $config;
                        fi
                fi
        done

        echo "deploy_configs()  Updating Cisco configuration to  centrifydc.conf" | tee -a $LOG_FILE; 
        cat "${HOME_PATH}/centrifydc_cisco.cfg" >> centrifydc.conf
        cd -


        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

function deploy_headers()
{
        echo "deploy_headers() " | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        echo "deploy_headers() deploying Centrify headers to ACS clearcase file system" | tee -a $LOG_FILE

        echo "deploy_headers() locating headers..." | tee -a $LOG_FILE

        cd "${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/include/adagent"  || echo "failed to cd to ${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/include/adagent" | tee -a $LOG_FILE

        echo "deploy_headers() checkout dir: $(pwd) " | tee -a $LOG_FILE
        cleartool co -nc .

        AD_HS=( $(ls *.h) )

        echo "deploy_headers() Processing header files: ${AD_HS[@]}"  | tee -a $LOG_FILE

        for header in ${AD_HS[@]} ; do
                trg_header=$(find $CENT_4_6_tmp -name $header | sed -ne '1p') 

                if [ -z $trg_header ] ; then
                        echo "deploy_headers() File $header not found in RPM. It will be removed from Clearcase!"
                        cleartool rm  $header 
                else
                        echo "deploy_headers() Processing header file $header with target $trg_header"  | tee -a $LOG_FILE
                        if  diff $trg_header $header >/dev/null ; then
                                echo "deploy_headers() $header same " | tee -a $LOG_FILE; 
                        else 
                                echo "deploy_headers()  $header differ and will be updated" | tee -a $LOG_FILE; 
                                cleartool co -nc "$header"; 
                                cp $trg_header $header;
                        fi
                fi
        done

        cd -

        cd "${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/include/adagent_capi"  || echo "failed to cd to ${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/include/adagent_capi" | tee -a $LOG_FILE

        echo "deploy_headers() checkout dir: $(pwd) " | tee -a $LOG_FILE
        cleartool co -nc .

        AD_HS=( $(ls *.h) )

        echo "deploy_headers() Processing header files: ${AD_HS[@]}"  | tee -a $LOG_FILE

        for header in ${AD_HS[@]} ; do
                trg_header=$(find $CENT_4_6_tmp -name $header | sed -ne '1p') 

                if [ -z $trg_header ] ; then
                        echo "deploy_headers() File $header not found in RPM. It will be removed from Clearcase!"
                        cleartool rm  $header 
                else
                        echo "deploy_headers() Processing header file $header with target $trg_header"  | tee -a $LOG_FILE
                        if  diff $trg_header $header >/dev/null ; then
                                echo "deploy_headers() $header same " | tee -a $LOG_FILE; 
                        else 
                                echo "deploy_headers()  $header differ and will be updated" | tee -a $LOG_FILE; 
                                cleartool co -nc "$header"; 
                                cp $trg_header $header;
                        fi
                fi
        done

        cd -
#        rpm_headers_dirs=( $(find -name include | grep -v kerberos) )
#        for rpm_headers_dir in ${rpm_headers_dirs[@]}
#        do
#                #rpm_headers_dir=$(basename $rpm_headers_dir)
#                rpm_headers_dir=${WORK_DIR}/${rpm_headers_dir}
#                echo "deploy_headers() processing headers located at ${rpm_headers_dir}"  | tee -a $LOG_FILE
#
#                rpm_headers=( $(ls ${rpm_headers_dir}/*.h) )
#
#                for file in ${rpm_headers[@]}
#                do
#                        file_name=$( basename $file )
#                        #ToDo, copy also to adagent_capi lib
#                        centrify_file_name="${ACS_CENTRIFY_INCLUDE_DIR}/adagent/${file_name}"
#
#
#                        if [ -e ${centrify_file_name} ] #Check if file exists in ACS CC
#                        then
#                                echo "deploy_headers() cheking differences between file $file and  ${centrify_file_name}" | tee -a $LOG_FILE
#                                if diff $file ${centrify_file_name} > /dev/null 2>&1 
#                                then
#                                        echo "deploy_headers() file $file_name is same between current Centrify RPM and ACS Clearcase" | tee -a $LOG_FILE
#                                else
#                                        echo "deploy_headers() file $file_name is different between current Centrify RPM and ACS Clearcase. Updating file in Clearcase" | tee -a $LOG_FILE
#
#                                        update_file_cc ${centrify_file_name} $file 
#                                fi
#                        else
#                                echo "file $file does not exist in ACS clearcase. It shall now be added." | tee -a $LOG_FILE
#                                add_file_cc ${centrify_file_name} $file 
#
#                        fi #check file exists
#                done
#
#        done #for rpm_headers_dir in ${rpm_headers_dirs[@]}
#
#        #ToDo, 
#        # 0. write function to calculate paths in ACS for following steps
#        # 1. diff files with ones in ACS.
#        # if different copy from RPM.
#        # if file doesn't exist in ACS then mkelem with correspoing name and copy it.


        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

function deploy_libs()
{
        echo "deploy_libs() " | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        echo "deploy_libs() deploying Centrify libs to ACS clearcase file system" | tee -a $LOG_FILE

        echo "deploy_libs() locating libs..." | tee -a $LOG_FILE

        cd "${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/lib"  || echo "failed to cd to ${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/lib" | tee -a $LOG_FILE

        echo "deploy_libs() checkout dir: $(pwd) " | tee -a $LOG_FILE
        cleartool co -nc .


        echo "deploy_libs() Processing lib files"  | tee -a $LOG_FILE


        if [ -e  libcapi.so.$SRC_VER ] ; then
                echo "CO rm libcapi.so.$SRC_VER & create elem libcapi.so.$TRG_VER"  | tee -a $LOG_FILE
                cleartool rm libcapi.so.$SRC_VER
                cleartool mkelem -c "Update libcapi version to libcapi.so.$TRG_VER " libcapi.so.$TRG_VER 
                cleartool rm libcapi.so libcapi.so.0 
                cleartool ln -s libcapi.so.$TRG_VER libcapi.so
                cleartool ln -s libcapi.so.$TRG_VER libcapi.so.0

                cleartool co -nc adagent/libcapi.so.0.0.0 
                cleartool co -nc adagent/libcapi.so
                echo "copying the actual libs" | tee -a $LOG_FILE
                cp  ${LIBS_PATH}libcapi.so.0.0.0 libcapi.so.$TRG_VER
                sha1sum  ${LIBS_PATH}libcapi.so. | tee -a $LOG_FILE0.0.0 libcapi.so.$TRG_VER
                cp ${LIBS_PATH}libcapi.so.0.0.0 adagent/libcapi.so.0.0.0
                cp ${LIBS_PATH}libcapi.so.0.0.0 adagent/libcapi.so
        elif [ -e  libcapi.so.$TRG_VER ] ; then
                if diff  ${LIBS_PATH}libcapi.so.0.0.0 libcapi.so.$TRG_VER; then
                        echo "libcapi.so.$TRG_VER sum matches" | tee -a $LOG_FILE  
                else
                        echo "libcapi.so.$TRG_VER sum don't match!" | tee -a $LOG_FILE  
                        cleartool co -nc adagent/libcapi.so.0.0.0 
                        cleartool co -nc adagent/libcapi.so
                        echo "copying the actual libs" | tee -a $LOG_FILE
                        cp  ${LIBS_PATH}libcapi.so.0.0.0 libcapi.so.$TRG_VER
                        sha1sum  ${LIBS_PATH}libcapi.so. | tee -a $LOG_FILE0.0.0 libcapi.so.$TRG_VER
                        cp ${LIBS_PATH}libcapi.so.0.0.0 adagent/libcapi.so.0.0.0
                        cp ${LIBS_PATH}libcapi.so.0.0.0 adagent/libcapi.so
                fi
        else
                echo "File libcapi.so.$SRC_VER doesn't exist. Nothing to perform!"  | tee -a $LOG_FILE
        fi

        if [ -e  liblrpc.so.$SRC_VER ] ; then
                echo "CO rm liblrpc.so.$SRC_VER & create elem liblrpc.so.$TRG_VER"  | tee -a $LOG_FILE
                cleartool rm liblrpc.so.$SRC_VER
                cleartool mkelem "Update liblrpc version to libcapi.so.$TRG_VER " liblrpc.so.$TRG_VER  
                cleartool rm liblrpc.so liblrpc.so.0 
                cleartool ln -s liblrpc.so.$TRG_VER liblrpc.so
                cleartool ln -s liblrpc.so.$TRG_VER liblrpc.so.0
                echo "File libcapi.so.$SRC_VER doesn't exist. Nothing to perform!"  | tee -a $LOG_FILE

                cleartool co -nc adagent/liblrpc.so.0.0.0 
                cp  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER
                cp ${LIBS_PATH}liblrpc.so.0.0.0 adagent/liblrpc.so.0.0.0
                sha1sum  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER | tee -a $LOG_FILE
        elif [ -e  liblrpc.so.$TRG_VER ] ; then
                if diff  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER; then
                        echo "liblrpc.so.$TRG_VER sum matches" | tee -a $LOG_FILE  
                else
                        echo "liblrpc.so.$TRG_VER sum don't match!" | tee -a $LOG_FILE  
                        cleartool co -nc adagent/liblrpc.so.0.0.0 
                        echo "copying the actual libs" | tee -a $LOG_FILE
                        cp  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER
                        sha1sum  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER | tee -a $LOG_FILE0
                        cp ${LIBS_PATH}liblrpc.so.0.0.0 adagent/liblrpc.so.0.0.0
                fi
        else
                echo "File liblrpc.so.$SRC_VER doesn't exist. Nothing to perform!"  | tee -a $LOG_FILE
        fi

        echo "copying libeda" | tee -a $LOG_FILE
        cleartool co -nc adagent/libeda.so.0
        cp ${LIBS_PATH}libeda.so.0 adagent/libeda.so.0
        sha1sum ${LIBS_PATH}libeda.so.0 adagent/libeda.so.0 | tee -a $LOG_FILE



        echo "Verifying checksums match" | tee -a $LOG_FILE
        
        if diff  ${LIBS_PATH}libcapi.so.0.0.0 libcapi.so.$TRG_VER ; then
                echo "libcapi.so.$TRG_VER sum matches" | tee -a $LOG_FILE  
        else
                echo "libcapi.so.$TRG_VER sum don't match!" | tee -a $LOG_FILE  
        fi
        
        if diff  ${LIBS_PATH}libeda.so.0 adagent/libeda.so.0 ; then
                echo "libeda.so.0 sum matches" | tee -a $LOG_FILE  
        else
                echo "libeda.so.0 sum don't match!" | tee -a $LOG_FILE  
        fi
        
        if diff  ${LIBS_PATH}liblrpc.so.0.0.0 liblrpc.so.$TRG_VER ; then
                echo "liblrpc.so.$TRG_VER sum matches" | tee -a $LOG_FILE  
        else
                echo "liblrpc.so.$TRG_VER sum don't match!" | tee -a $LOG_FILE  
        fi
        
        echo "listing updated centrify libs" | tee -a $LOG_FILE
        cleartool ls -l  liblrpc* adagent/liblrpc* libcapi* adagent/libcapi* adagent/libeda*  | tee -a $LOG_FILE



        AD_SO_LIST=( libgcc_s-3.4.6-20060404.so.1 libgnugetopt.so.1 liblber-2.2.so.7.0.19 libldap-2.2.so.7.0.19 libldap_r-2.2.so.7.0.19 liblrpc.so.0.0.0 libsn2princ.so.0.0.0 libstdc++.so.6.0.3 libuuid.so.1.2 )
        

        for  so in ${AD_SO_LIST[@]}; do
                echo "processing $so " | tee -a $LOG_FILE
                if [ ! -z $(find $LIBS_PATH -name $so -type f 2>  /dev/null) ] ; then
                        so_ad_loc=`find $LIBS_PATH -name $so -type f `
                        echo "found $so, checking against $so_ad_loc if needs update" | tee -a $LOG_FILE
                        echo "for verification, here are the checksums:" | tee -a $LOG_FILE
                        sha1sum  adagent/${so} | tee -a $LOG_FILE $so_ad_loc 
                        if diff adagent/${so} $so_ad_loc > /dev/null ; then
                                echo "lib adagent/${so} doesnt require update" | tee -a $LOG_FILE
                        else
                                echo "lib adagent/${so} requires update" | tee -a $LOG_FILE
                                cleartool co -nc adagent/${so} 
                                cp $so_ad_loc adagent/${so} 
                                echo "update complete. cksum report:" | tee -a $LOG_FILE
                                sha1sum $so_ad_loc adagent/${so}  | tee -a $LOG_FILE
                                cleartool ci -nc adagent/${so} 
                        fi
                else 
                        echo "Not found $so, hence will be removed!" | tee -a $LOG_FILE
                        cleartool rm  $so 
                fi
        done
        
        


        echo "updating kerberos libs" | tee -a $LOG_FILE
        KERB_SO_LIST=(libcom_err.so libcom_err.so.3.0 libdes425.so.3.0 libgssapi_krb5.so.2.2 libgssrpc.so.4.0 libk5crypto.so.3.0 libkdb5.so.4.0 libkrb5.so.3.2 libkrb5support.so.0.0)
        for  so in ${KERB_SO_LIST[@]}; do
                echo "processing $so " | tee -a $LOG_FILE
                if [ ! -z $(find $KERB_LIBS_PATH -name $so -type f 2>  /dev/null ) ]; then
                        so_ad_loc=`find $KERB_LIBS_PATH -name $so `
                        echo "found $so, checking against $so_ad_loc if needs update" | tee -a $LOG_FILE
                        echo "for verification, here are the checksums:" | tee -a $LOG_FILE
                        sha1sum  adagent/kerberos/${so} $so_ad_loc  | tee -a $LOG_FILE
                        if diff adagent/kerberos/${so} $so_ad_loc > /dev/null ; then
                                echo "lib adagent/${so} doesnt require update" | tee -a $LOG_FILE
                        else
                                echo "lib adagent/${so} requires update" | tee -a $LOG_FILE
                                cleartool co -nc adagent/kerberos/${so} 
                                cp $so_ad_loc adagent/kerberos/${so} 
                                echo "update complete. cksum report:" | tee -a $LOG_FILE
                                sha1sum $so_ad_loc adagent/kerberos/${so}  | tee -a $LOG_FILE
                                cleartool ci -nc adagent/kerberos/${so} 
                        fi
                else 
                        echo "Not found $so , hence will be removed!" | tee -a $LOG_FILE
                        cleartool rm  $so 
                fi
        done

        cd -



        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

function deploy_bins()
{
        echo "deploy_bins() " | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE

        echo "deploy_bins() deploying Centrify bins to ACS clearcase file system" | tee -a $LOG_FILE

        echo "deploy_bins() locating bins..." | tee -a $LOG_FILE
        AD_CLI_BINS=(adfinddomain     adkeytab     adsmb              fix_pam_rsh.sh  ldapdelete  adfixid          adleave      adupdate           ldapmodify  adcache           adflush          adobfuscate  ldapmodrdn  adcheck           adgpupdate       adpasswd     ldapsearch  adclient          adid             adquery      cdcexec            adinfo           adreload     cdcwatch           addns             adinfo_extra.sh  adrmlocal    ldapadd         adenv             adjoin           adsetgroups  ldapcompare     adlicense) 

        cd "${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/bin"  || echo "failed to cd to ${SRC_ACS_PATH_Prefix}/runtime/prebuilt/lnx26/bin" | tee -a $LOG_FILE

        echo "deploy_bins() checkout dir: $(pwd) " | tee -a $LOG_FILE
        cleartool co -nc .


        echo "deploy_bins() Processing bin files: ${AD_CLI_BINS[@]}"  | tee -a $LOG_FILE

        for bin in ${AD_CLI_BINS[@]} ; do
                trg_bin=$(find $CENT_4_6_tmp -type f -name $bin ) 

                if [ -z $trg_bin ] ; then
                        echo "deploy_bins() File $bin not found in RPM. It will be removed from Clearcase!" | tee -a $LOG_FILE
                        cleartool rm  $bin 
                else
                        echo "deploy_bins() Processing bin file $bin with target $trg_bin"  | tee -a $LOG_FILE
                        echo "deploy_bins() checksums: $( sha1sum $bin ) $( sha1sum $trg_bin )"  | tee -a $LOG_FILE
                        if  diff -q $trg_bin $bin >/dev/null ; then
                                echo "deploy_bins() $bin same " | tee -a $LOG_FILE; 
                        else 
                                echo "deploy_bins()  $bin differ and will be updated" | tee -a $LOG_FILE; 
                                cleartool co -nc "$bin"; 
                                cp $trg_bin $bin;
                        fi
                fi
        done

        cd -



        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

##===  FUNCTION  ================================================================
##          NAME:  deploy_configurations
##   DESCRIPTION:  Deploy cfg files
##    PARAMETERS: 
##       RETURNS:  
##===============================================================================
#function deploy_configurations()
#{
#        echo "deploy_configurations() "
#        echo "************************************************************************************************************************"
#        echo "deploy_configurations() deploying Centrify configuration files to ACS clearcase file system"
#
#        echo "deploy_configurations() locating headers..."
#        rpm_headers_dirs=( $(find -name include | grep -v kerberos) )
#        for rpm_headers_dir in ${rpm_headers_dirs[@]}
#        do
#                #rpm_headers_dir=$(basename $rpm_headers_dir)
#                rpm_headers_dir=${WORK_DIR}/${rpm_headers_dir}
#                echo "deploy_configurations() processing headers located at ${rpm_headers_dir}" 
#
#                rpm_headers=( $(ls ${rpm_headers_dir}/*.h) )
#
#                for file in ${rpm_headers[@]}
#                do
#                        file_name=$( basename $file )
#                        #ToDo, copy also to adagent_capi lib
#                        centrify_file_name="${ACS_CENTRIFY_INCLUDE_DIR}/adagent/${file_name}"
#
#
#                        if [ -e ${centrify_file_name} ] #Check if file exists in ACS CC
#                        then
#                                echo "deploy_configurations() cheking differences between file $file and  ${centrify_file_name}"
#                                if diff $file ${centrify_file_name} > /dev/null 2>&1 
#                                then
#                                        echo "deploy_configurations() file $file_name is same between current Centrify RPM and ACS Clearcase"
#                                else
#                                        echo "deploy_configurations() file $file_name is different between current Centrify RPM and ACS Clearcase. Updating file in Clearcase"
#
#                                        update_file_cc ${centrify_file_name} $file 
#                                fi
#                        else
#                                echo "file $file does not exist in ACS clearcase. It shall now be added."
#                        fi #check file exists
#                done
#
#        done #for rpm_headers_dir in ${rpm_headers_dirs[@]}
#
#        #ToDo, 
#        # 0. write function to calculate paths in ACS for following steps
#        # 1. diff files with ones in ACS.
#        # if different copy from RPM.
#        # if file doesn't exist in ACS then mkelem with correspoing name and copy it.
#
#
#        echo "************************************************************************************************************************"
#        echo ""
#}

function deploy_files_2_acs()
{
        echo "deploy_files_2_acs()" | tee -a $LOG_FILE
        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "deploy_files_2_acs() deploying Centrify files to ACS clearcase file system" | tee -a $LOG_FILE

        deploy_headers
        deploy_bins
        deploy_libs
        deploy_configuration

        echo "************************************************************************************************************************" | tee -a $LOG_FILE
        echo "" | tee -a $LOG_FILE
}

if [ $# -ne "$ARGS" ]
then
        help
        exit $MISSING_ARGS
fi

echo "Starting Integration of Centrify RPMs to ACS..." | tee $LOG_FILE 
calculate_acs_paths

RPMS_ARR=( $( ls ${CENT_4_6_tmp}*.rpm ) )
extract_rpms ${RPMS_ARR[@]}
## Temp. disable actual file deployment
deploy_files_2_acs

	20.5
21. BASH profile & aliases

	21.1 Cisco development environment .bashrc Mon Jan 25 18:26:36 JST 2010
# global
#if [ -f /etc/bashrc ]; then
#	. /etc/bashrc
#fi

## editor for crontab, cvs
EDITOR=vi
export EDITOR

## pager for man
PAGER=less
export PAGER

alias ls="ls -F --color=auto "
alias la="ls -a --color=auto "
alias l="ls -a "
alias sl="ls"
alias less="less -x4 -r "
alias rm="rm -i "
alias mv="mv -i "
alias cp="cp -i "
alias ct="date +%Y%m%d-%H%M%S"
alias kt="kterm -km euc -sb -sl 2000"
alias c="clear"
#alias emacs="meadow "   # for cygwin
#alias mule="meadow "    # for cygwin


#path variables

#clearcase
PATH=${PATH}:/auto/cwtools/perl/focus/bin/lnx/:/usr/atria/bin/:/sbin/:/vob/enm_jdk/maven-2.0.9/bin:JAVA_HOME/:auto/cwtools/perl/focus/bin/lnx:/usr/atria/bin:
CWTOOLS=/auto/cwtools/;export CWTOOLS


#For maven
MAVEN_HOME=/vob/enm_jdk/maven-2.0.9; export MAVEN_HOME;
PATH=${PATH}:${MAVEN_HOME}/bin/:
JAVA_HOME=/usr/java/jdk1.5.0_10; export JAVA_HOME;
MAVEN_OPTS="-Xms256m -Xmx1024m" 

#ACS related
#for running ACS RT deamon
ODBCINI=/opt/CiscoACS/db/odbc.ini; export ODBCINI;
PATH=${PATH}:/opt/CiscoACS/bin/:
ACS_ROOT_DIR=acs
LD_LIBRARY_PATH=/opt/CiscoACS/runtime/lib:/opt/CiscoACS/db/dbsrv/lib32:/opt/CiscoACS/db/dbsrv/jre150/lib/i386/client:/opt/CiscoACS/db/dbsrv/jre150/lib/i386:/opt/CiscoACS/db/dbsrv/jre150/lib/i386/native_threads:/opt/CiscoACS/lib:; export LD_LIBRARY_PATH;
source /opt/CiscoACS/db/dbsrv/bin32/sa_config.sh
#For quantify and purify
. /sw/licensed/rational/products/purifyplus_setup.sh

#prompt
PS1="[\u@\h:\d:\w]\$ "

#scripts to path
PATH=${PATH}:~/work/scripts/:~/work/scripts/python/util:~/work/scripts/util/:~/work/scripts/sed/:~/work/scripts/perl/util


source ~/.aliases

#set vi prompt mode, for emacs mode (default) use, set -o emacs
set -o vi
bind '"\t":menu-complete'

#For ACS express view
PATH=${PATH}:/usr/cisco/bin/:

#For centrify adjoin
PATH=${PATH}:/usr/sbin:

#for python v 2.5
PATH=${PATH}:/auto/nmtg-acs-img/bin/python2.5.1.1/linux_x86/bin:
alias python='/auto/nmtg-acs-img/bin/python2.5.1.1/linux_x86/bin/python'

	21.2 Cisco development environment .aliasses 

		21.2.1 Mon Jan 25 18:26:58 JST 2010


# Author: Yosi Izaq
#
#FUNCTIONS

#Utility bash mini functions of common tasks
#


# This one will accept a list of files to edit.
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session(){

	if [ -n $1 -a $1 == "-t" ]
	then
		shift #shift the -t out of argument (file) list
		echo "using VIM to open files $@"
        vim $@
	else
		echo "using GVIM to open files $@"
        gvim -font Courier\ Bold\ 13 $@
#gvim -font Sans\ 12 $@
	fi
		
}
#

#Bash functions I usually alias and use commonly
#__find_cpp()
#{
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \) 
#}

_generate_code_review_info()
{
        echo "Generating code review information"
        echo "Make sure you're in corresponding stream and view and set to the activity you'd like reviewed"

        stream=`ct lsstream | awk '{print $2}'`
        view=`ct pwv |  awk '/Set view/  {print $3}'`
        activity=`ct lsact -cact | awk '{print $2}'`

        Files=`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq `

        echo "================================================================================"
        echo "||            Code Review Information, optimized for windows view             "
        echo "================================================================================"
        echo "|| Stream:    $stream                   "
        echo "================================================================================"
        echo "|| View:      $view                   "
        echo "================================================================================"
        echo "|| Activity:  $activity                 "
        echo "================================================================================"
        echo "|| Files:     $Files                 "
        echo "================================================================================"

	
	echo
	echo
	echo
	echo

	RULER="=================================================================================================================================="
        Files_array=(`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq   `)

        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Code Review Information. Optimized for Linux View" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Stream $stream" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Activity $activity" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Files: " "||"
        echo
        
        for file in ${Files_array[@]} 
        do
                printf "%-10s%-110s%10s" "||" "$file" "||"
                echo
        done

        printf "%-130s" $RULER
        echo
}

# Variabls
_VIM_FONT=' -font Sans\ 12 '
#_VIM_FONT=' -font Courier\ Bold\ 13 '
#FUNCTIONS

_cpuz(){

#Description: This alias will copy and uncopmress a given zip file to a given target file
# The result is much faster than running cp first and gzunzip later.
#Usage: $ cpuz source_file target_file
#Author Yosi Izaq
        echo "This alias will copy and uncopmress a given zip file to a given target file"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpuz source_file target_file"
        else
                echo "copying and decompressing $1 to $2"
		zcat $1 > $2
        fi  

}

_cpz(){

#Description: This alias will copy the given file to a compressed file on a given location using pipes
# The result is much faster than running cp first and gzip later.
#Usage: $ cpz source_file target_file.gz
#Author Yosi Izaq
        echo "This alias will copy the given file to a compressed file on a given location using pipes"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpz source_file target_file.gz"
        else
                echo "copying and compressing $1 to $2"
		cat $1 | gzip > $2
        fi  

}

_cpr_fast(){

#Description: This alias copied directories much faster than cp -r
#Usage: $ cpr_fast source target
#Author Yosi Izaq
        echo "This alias copies directories much faster than cp -r"


        if  [ $# -ne 2 ]
                then
                        echo "Usage: $ cpr_fast source target"
        else
                echo "copying $1 to $2"
                ( cd $1  && tar cf - . ) | (cd $2  && tar xvpf - )
        fi

}
_pull_file_ssh(){
#Description: SSH copy file from remote host
#Usage pull_file_ssh <remote file> <remote host> <local file>
#Author Yosi Izaq
        echo "SSH copy file from remote host"


        if  [ $# -lt 3 ]
                then
                        echo "Usage pull_file_ssh <remote file> <remote host> <local file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi
                echo "copying $1 to $3 from machine $2, using remote user $4"
                ssh -l $USR $2  cat $1 > $3
        fi

}
_push_file_ssh(){
#Description: SSH move file to remote host
#Usage: push_file_ssh <local file> <remote host> <remote file> [remote user]
#Author Yosi Izaq
        echo "SSH move file to remote host"
        echo "Usage push_file_ssh <local file> <remote host> <remote file>"


        if  [ $# -lt 3 ]
                then
			echo "Usage push_file_ssh <local file> <remote host> <remote file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi

                echo "copying $1 to $3 on machine $2, using remote user $4"
		echo "Execute: cat $1 | ssh -l $USR $2  cat \">\" $3"
                cat $1 | ssh -l $USR $2  cat ">" $3
        fi

}


#ACS related

# Secific to Cisco ACS 5.x project. Run ACS RT daemon purify executable.
# preconditions:
# a. Only works in clearcase view 
# b. Only works after ACS RT service is stopped
# c. Reuires that ACS rt_daemon be linked with purify
_run_acs_purify(){
#
        if [ -ne $1 ]
        then 
cat <<HELP_MSG
------------------------------------------------
Alias/Script secific to Cisco ACS 5.x project. Run ACS RT daemon purify executable.
preconditions:
a. Only works in clearcase view 
b. Only works after ACS RT service is stopped
c. Reuires that ACS rt_daemon be linked with purify
Make sure to call with ACS configurtation file like:
$ _run_acs_purify [path/to/acs/configuration/file]
or
$ purify_acs /opt/CSCOacs/runtime/config/generated_AcsConfig.xml
------------------------------------------------
HELP_MSG

        fi

       cdacs_view
        cd daemons/rt_daemon/
        PURIFYOPTIONS="--view-file=%v.pv -windows=yes -chain-length=20"; export PURIFYOPTIONS

        if [ -e ../config.bak ]
        then
                rm -fr ../config
        else
                mv ../config ../config.bak
        fi

        dev-run.sh start $1

}

_gdb_acs_lib(){

echo "For this to work make you sure you have cd to ACS RT lib directory!"
#Paths relevant to maven system on RT (ACS 5.0 phase 1 and early phase 2)
#        LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:`pwd`/target/lib; export LD_LIBRARY_PATH; 
#        LIB_NAME=`ls target/test* | sed -e 's/\*//'` 
#        echo "Starting debug session for ACS lib ${LIB_NAME} "
#        echo "Please execute command: LD_LIBRARY_PATH=\$\{LD_LIBRARY_PATH\}:`pwd`/target/lib; export LD_LIBRARY_PATH;   gdb ${LIB_NAME}"

#Paths relevant to make system on RT (ACS 5.0 phase 2 and above)
export LD_LIBRARY_PATH=/vob/nm_acs/acs/runtime/build/lnx26/lib:/vob/nm_acs/acs/runtime/prebuilt/lnx26/lib
#cmd="gdb test/Debug/test-`pwd | awk -F"/" '{print $NF }'`"
#libName=`pwd | awk -F"/" '{print $NF }' | python -c "print raw_input().capitalize()"`
libName=`ls test/Debug/test-* | sed -e 's/*//'`
#awk '# Extract the lib name and capitalize 1st letter 
#    # initialize strings
#    BEGIN { upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
#            lower = "abcdefghijklmnopqrstuvwxyz" 
#        FS = "/"
#    }
#    # for lib name (which is last field in record)
#        $NF
#    {
##print "processing last record ", $NF
#    # get first character of first word
#    	FIRSTCHAR = substr($NF, 1, 1)
#    # get position of FIRSTCHAR in lowercase array; if 0, ignore
#    	if (CHAR = index(lower, FIRSTCHAR)) 
#    		# change $1, using position to retrieve
#    		# uppercase character 
#    		$NF = substr(upper, CHAR, 1) substr($NF, 2)
#    # print record
#    	print $NF
#    }'`
echo "lib name to debug is ${libName}"
#cmd="gdb test/Debug/test-${libName}"
cmd="gdb ${libName}"
echo "set LD_LIBRARY_PATH to ${LD_LIBRARY_PATH}, execute ${cmd} " 
$cmd

}

_clean_acs_5_logs(){
#Description: Clean log files of ACS 5.x from various junk
# and leave only stuff that's interesting to me :)

        echo "Cleaning log file $1..."
        sed '/^CatalogRepository/d; /^LocalStore/d; /^Logging/d; /^LoggerFactory/d; /^ScopeHandler/d; /^XmlManager/d;' $1 > ~/__temp__
#cat ~/__temp__
        mv -f ~/__temp__ $1
}

_cd_acs_view(){
#Description: switch to runtime directory for ACS 5.0 project
# of the current view according to cleartool pwv

        CUR_VIEW=`cleartool pwv | awk '/Set view/ {print $3}' `
        echo "Changing dir to ACS 5.0 runtime for view: ${CUR_VIEW}"

        case "${CUR_VIEW}" in
                'yizaq__int.acs5_0.lx')
                        echo "You are currently working on integration view stream"
                        ;;
                'yizaq2__yizaq.int.acs5_0.lx')
                        echo "You are currently working on AAC related view stream"
                        ;;
                'yizaq3__yizaq.int.acs5_0.lx')
                        echo "You are currently working on utility view stream"
                        ;;
                esac

        cd /view/${CUR_VIEW}/vob/nm_acs/acs/runtime
}
_install_acs_lnx()
{
        #Usage example: install_acs_lnx http://nmtgre-csi.cisco.com/auto/cw/cdimages/acs5_0.mvn/daily/LNX_ACS5_0.MVN_20080928_1020/images/acs-5.0.1-B.2365.i386.rpm
#

        if [ -z "$1" ]
        then
                echo "Please enter URL of ACS RPM. ACS and View will be installed."
                echo "For example, To install ACS 5.0 DST-15 URL execute as follows:"
                echo "install_acs_lnx http://nmtgre-csi.cisco.com/auto/cw/cdimages/acs5_0.mvn/daily/LNX_ACS5_0.MVN_20081024_0129/images/acs-5.0.1-B.2554.i386.rpm"
                echo "terminating."
                return
        fi

        ACS="$1"
        ACS_VIEW=${ACS/acs-/acsview-}
        echo "ACS rpm url is: $ACS"
        echo "ACS view rpm url is: $ACS_VIEW"

        echo "DLing ACS from BOR URL: $ACS"
        cd /tmp/
        if wget ${ACS}
        then
                echo "Successfuly DLed ACS image"
        else
                echo "Failed DLing ACS image"
        fi

        echo "DLing ACS view from BOR URL: $ACS_VIEW"
        cd /tmp/
        if wget ${ACS_VIEW}
        then
                echo "Successfuly DLed ACS view image"
        else
                echo "Failed DLing ACS view image"
        fi

        echo "uninstalling Previous ACS (if any)"

        uninstall_acs_lnx

        echo "Installing ACS"
        sudo rpm -ivh --nomd5 $( basename $ACS )

        echo "Installing ACS view"
        sudo rpm -ivh --nomd5 $( basename $ACS_VIEW )

        echo "Starting ACS"
        sudo /opt/CSCOacs/bin/acs start
}

_uninstall_acs_lnx()
{
        echo "Uninstalling ACS 5.x"
        sudo rpm -e `rpm -qa | grep '^acs-5*'`; 
        echo "Uninstalling ACS 5.x view"
        sudo rpm -e `rpm -qa | grep '^acsview-5*'`; 
}

_translate_acs_error(){
cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/;
csutil.exe -e "$1"
cd -;
#"./cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/csutil.exe" -e "$1"
}

_ls_exe(){
#Description: list executable files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /x/&& $1 !~ /^d/ {print $9}'
}

_ls_dir() {
#Description: list directory files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /^d/ {print $9}'
}

_ls_file() {
#Description: list files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 !~ /^d/ {print $9}'
}
_ct_diff_act(){
#Description: Run diff on an activity change set
#Usage: $ ct_diff_act Phase2Bugs2@/vob/nmtgre_proj

        TMP_FILE="__ct_diff_act_temp"
        echo "Running diff on change set of activity: $1..."
         for file in `activity_change_set $1 `;  do echo "ct diff -graph -pred  $file" >> $TMP_FILE; done
        . $TMP_FILE
        \rm -f $TMP_FILE

}


_my_post_rebase(){
echo "Performing post rebase procedure."
view_path=`ct pwv | awk '/Set view/ {print $3}'`
echo "executing nohup /view/${view_path}/vob/nm_acs/acs/runtime/build/tools/lnx26/rt-build-conf.sh rt-notest"
nohup /view/${view_path}/vob/nm_acs/acs/runtime/build/tools/lnx26/rt-build-conf.sh rt-notest
echo "Check result of build status after rebase in file nohup.out"
echo "This are the last messages of the build"
tail nohup.out
}

_disp(){
echo "setting DISPLAY to $1. Please make sure display is allowed on host (run xhost + [name]"
DISPLAY="$1":0.0; export DISPLAY
echo "DISPLAY is set to: "
echo $DISPLAY
}


_browse_cc_change_set(){
	echo "make sure you change directory to ACS clearcase view"
	for file in `ct lsactivity -long -me | grep ismg_israel_acs | awk -F"@" '{print $1 }' | sed -e 's/\w:\\\ismg_israel_acs\\\Acs/./' |  sed -e 's_\\\_/_g' | sort | uniq `;
		do echo $file;
		ct lsvtree -g $file;
	done
}
_backup(){

	source ~/.aliases
	echo "Starting backup of knwoledge base, scripts and daily context files..."

	back_path="$HOME/temp/backups"
        Archive=$back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`_linux.tar
        echo "Archive: $Archive"
	cdwork
	tar cvf $Archive KB/ context* scripts 
	cd ~
	tar rvf $Archive .aliases .bashrc .vimrc .vim/
	bzip2 -f $Archive

    echo "Backup is ready at ${Archive}.bz2"
}
_kill_proc(){
	echo "freeing process $1"
	proc_pid=`ps -ef | grep "$1" | grep -v grep | awk '{print $2}' `
	echo "freeing  processes $proc_pid. if theres such process please ignore the error message."
	kill -9 $proc_pid
}

_cd () {
	cd /cygdrive/"$1"
   }

_pse(){
	ps -ef  | grep `whoami` | grep "$1" | grep -v grep
}

_history(){
	history | grep "$1"
}

_locate_in_jar (){
#for jar in *.jar;  do echo  searching $jar; jar tvf $jar | grep "$1"; done
for jar in *.jar;  
	do  jar tvf $jar | grep "$1"; 
	if [ $? = 0 ]  ;
	then
		echo "found $1 in $jar."
	fi
done
}

_open_KB_files(){

files=( knowledge_base_unix  clear_case_KB.txt bash/KB_bash  vi/KB_vi kb_scripts javaKB ACS/kb_acs_4_1 ACS/kb_acs_5_0 acs_faqs kb_cisco kb_cygwin kb_tools KB_cpp python/KB_python sed/KB_sed awk/kb_awk  win/KB_win Network/sslKB)
path=" $HOME/work/KB/"
#cmd="vi "
#cmd="gvim -font Courier\ Bold\ 13 "
cmd=" "

for file in ${files[@]};
	do file=${path}${file};
	cmd=${cmd}${file}
#echo $file;
#echo $cmd;
done
#gvim ${_VIM_FONT} ${cmd}

# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${cmd}
#gvim -font Sans\ 12 ${cmd}
}

_list_checkouts() {
	echo "Please wait while generating list of checked out files."
# Caveage, replaced with new cleartool command :)
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)  -exec  cleartool ls '{}' \; | grep CHECKEDOUT | awk -F@ '{print $1}'

# The command below will return list of all checkouts for current user
#ct lsco -r -me;
# While the command below will return list of all checkouts for current user on current working stream+view
#ct lsco -recurse -me | grep `ct lsstream | awk '{print $2}'` | awk '{print $5}' | sed -e 's_"__g'

        echo "Please execute:     $ ct lsco -recurse -me | grep `ct lsstream | awk '{print $2}'` | awk '{print $5}' | sed -e 's_\"__g' "

     echo "end of checkout list"
}

_resume_editing_session(){
	echo "Resuming editing session on file list $1, files: "
	cat $1
	file="$1"
	arg1="$2"
#files=`flatten_file_lines.py $file`
        files=`python /users/yizaq/work/scripts/python/util/flatten_file_lines.py $file`

_fire_vim_edit_session $arg1 ${files}

#	if [ -n $arg1 -a $arg1 == "-t" ]
#	then
#		echo "using vim"
#		vim -- $files
#	else
#		echo "using gvim"
##gvim -font Courier\ Bold\ 13 $files
#		gvim -font Sans\ 12 ${files}
#	fi
		
}

_open_current_context(){
	month=` date | awk '{print $2}'`
	year=` date | awk '{print $6}'`
#echo "year $year, month $month"
	
	ctxt_path="/cygdrive/c/work/"	

	file="${ctxt_path}context_${month}_${year}" 
	if  [ -e $file ] 
		then
			echo "Context file exists"
		else
			echo "Creating new context file $file"
			touch  $file

			echo "This file contains work related notes for Yosi Izaq, yytzhak@cisco.com" >> $file
			echo "File name: $file" >> $file
	
#Enter all days
				LIMIT=31
				for ((i=1; i <= LIMIT ; i++)) 
					do 
						echo  "$i" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
					done
	fi

	echo "Opening $file for edit..."
#gvim -font Courier\ Bold\ 13 $file
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${file}
#gvim -font Sans\ 12 ${file}
}

_mini_start(){
	banner "Welcome"
	banner "`whoami`"	
	echo "date is:"
	banner "`date`"	

	echo "Initializing commonly used apps..."

	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	echo "Firing up some xterms..."
	xterm -sb -bg brown -fg yellow  &
	xterm -sb -bg blue -fg orange  &
	xterm -sb -bg lightyellow -fg purple  &
	xterm -sb -bg grey -fg blue  &

	banner "ENJOY :-)"

	echo "and btw, backuping files..."
	backup
}

_start(){
	banner "Welcome"
	banner "`whoami`"	
	echo "date is:"
	banner "`date`"	

	echo "Initializing commonly used apps..."

	echo "Initializing sametime"
# old sametime
#"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &
	"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &

	echo "Initializing outlook"
	"/cygdrive/c/Program Files/Microsoft Office/OFFICE11/OUTLOOK.EXE"   &

	echo "Initializing crimson editor"
	"/cygdrive/c/Program Files/Crimson Editor/cedt.exe" &

	echo "Initializing firefox"
	"/cygdrive/c/Program Files/Mozilla Firefox/firefox.exe" &

	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	echo "Firing up some xterms..."
	xterm -sb -bg brown -fg yellow  &
	xterm -sb -bg blue -fg orange  &
	xterm -sb -bg lightyellow -fg purple  &
	xterm -sb -bg grey -fg blue  &

	echo "Initializing total commander"
	"/cygdrive/c/totalcmd/TOTALCMD.EXE" &

	banner "ENJOY :-)"

	echo "and btw, backuping files..."
	backup


}

#general
alias dir='ls -lav --color=auto'
alias DIR='ls -F | grep "/"'
alias lst='ls -lrt'
alias cdd='cd /cygdrive/c'
alias CD="_cd "
alias cddesktop='cd  /cygdrive/c/Documents\ and\ Settings/yytzhak/Desktop/'
alias pse="_pse " 
alias hist="_history"

##jrules
#alias cdjrules='cd d:;cd ILOG/JRules51' 
#alias cdjrules_eval='cd d:;cd work/projects/ILOG\ JRules\ Compatability\ Tests/"SFL Demo" '
#alias cdjrules_integ_loc='cd /cygdrive/c/work/projects/first_integration '
#alias cdjrules_integ_stream='cd /cygdrive/h/ismg_israel_acs/Acs/JRules/first_integration '
#alias cdjrules_new_integ_stream='cd /cygdrive/j/nm_use_common/JRules/  '
#alias start_rule_dev='/cygdrive/c/ILOG/JRules503/bin/RuleBuilder/brdev.exe'
#alias jonas_start='/cygdrive/c/ILOG/JRules503/bin/Examples/startserver'
#alias jonas_stop='/cygdrive/c/ILOG/JRules503/bin/Examples/stopserver'
#

#xterm related
#alias xt1='xterm -sb -bg brown -fg yellow '
#alias xt2='xterm -sb -bg blue -fg orange '
#alias xt3='xterm -sb -bg lightyellow -fg purple'
#alias xt4='xterm -sb -bg grey -fg blue' 
alias xt1='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg brown -fg yellow '
alias xt2='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg blue -fg orange '
alias xt3='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg lightyellow -fg purple'
alias xt4='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg grey -fg blue' 
alias xts="xt1& xt4& xt3& xt4&"
alias xt1_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg brown -fg yellow '
alias xt2_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg blue -fg orange '
alias xt3_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg lightyellow -fg purple'
alias xt4_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg grey -fg blue' 
alias xts_small="xt1_small& xt4_small& xt3_small& xt4_small&"
alias set_vi="set -o vi;bind '\"\t\":menu-complete'"
alias set_emacs="set -o emacs;"

#jboss
alias jboss_start='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/run.bat'
alias jboss_stop='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/shutdown.bat -S'
alias cdjboss="cd /cygdrive/c/Program\ Files/jboss-4.0.2/server/default/"

#tomcat
alias cdtomcat="cd /cygdrive/c/Program\ Files/Apache\ Group/Tomcat\ 4.1"
alias tomcat_start="cdtomcat; cd ./bin; ./startup.bat; cd -"
alias tomcat_stop="cdtomcat; cd ./bin; ./shutdown.bat; cd -"
alias tomcat_restart="tomcat_stop; sleep 5; tomcat_start"

#system
alias pse='ps -ef | grep `whoami`'
alias ipconfig='/cygdrive/c/WINNT/system32/ipconfig.exe'
alias refresh_DNS='sudo /etc/rc.d/init.d/nscd restart '

#personal
alias cd_citation='cd /cygdrive/c/backup/acc/citation'
alias dom2='/cygdrive/c/Program\ Files/dominions2/dom2.exe'
alias gods_eye='cd /cygdrive/c/backup/medial/g/domII/tools/gods_eye/;./gods_eye.exe'
alias open_journal='echo open private journal, please type password.; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -d yosi_izaq_journal.cpt; vi yosi_izaq_journal; cd - '
alias close_journal='echo closing private journal, please type password; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -e yosi_izaq_journal; echo terminating journal editing session; cd -'
alias journal="open_journal ; close_journal"

alias open_pass='echo open private passwords file, please type password.; cd /cygdrive/c/work/; ccrypt -d pass.cpt; vi pass; cd - '
alias close_pass='echo closing private passwords file, please type password; cd /cygdrive/c/work/; ccrypt -e pass; echo terminating passwords editing session; cd -'
alias pass="open_pass ; close_pass"

#work
#Put here things that are very commonly used.
alias backup='_backup'
alias browse_cc_change_set='_browse_cc_change_set'
alias start='_start'
alias mini_start='_mini_start'

alias KB='less /cygdrive/c/work/KB/knowledge_base_unix  /cygdrive/c/work/KB/clear_case_KB.txt  /cygdrive/c/work/KB/kb_acs  /cygdrive/c/work/KB/kb_jrules  /cygdrive/c/work/KB/javaKB  /cygdrive/c/work/KB/CPP/KB_cpp /cygdrive/c/work/KB/kb_cygwin /cygdrive/c/work/KB/ant/antKB /cygdrive/c/work/KB/bash/KB_bash /cygdrive/c/work/KB/vi/KB_vi '
alias KBE="_open_KB_files"
alias cd_scripts='cd ~/work/scripts'
alias +='less'
alias cdKB='cd /cygdrive/c/work/KB'
alias cdwork='cd ~/work'
#alias tkdiff='/cygdrive/c/Program\ Files/tkdiff/tkdiff_4_1/tkdiff.tcl'
alias vpn='/cygdrive/c/work/scripts/util/connect_2_office.sh'
alias vi='vim'
alias vig='vim -g -font Courier\ Bold\ 13 -- '

#ACS related aliases
alias uninstall_acs_lnx='_uninstall_acs_lnx'
alias install_acs_lnx='_install_acs_lnx'
alias cdacs_view='_cd_acs_view'
alias cdacs_4_2_1='echo working view lnx__int.acs4_2_1.lxss on stream int.acs4_2_1; cd /ws/yizaq/lnx__int.acs4_2_1.lxss/vob/ismg_israel_acs/Acs/;'
alias cdacs_napnac_main='cd /cygdrive/g/ismg_israel_acs/Acs'
alias cdacs_napnac_fwd_attrs='cd /cygdrive/g/ismg_israel_acs/Acs'
alias cdacs_napnac_merge='cd /cygdrive/h/ismg_israel_acs/Acs'
#alias cdacs_5_0='cleartool setview   yytzhak__yytzhak.int.acs5_0.lx; cd /view/yytzhak__yytzhak.int.acs5_0.lx/vob/nm_acs/acs/runtime'
alias svi='echo setting view on integration stream; cleartool setview   yizaq1__int.acs5_0.lx;'
alias sv_fips='echo setting view on integration stream; cleartool setview   yizaq__yizaq_fips.int.acs5_0.lx;'
alias sv_acs_express='echo setting view on ACS express; cleartool setview   yizaq-xp50; '
alias cdacs_express=' cd /vob/cnsar/thin/destiny;'
alias sv1='echo setting view on bug fix stream; cleartool setview   yizaq__yizaq01.int.acs5_0.lx;'
alias gen_tags='echo generating cpp tags;ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  --languages=c++  -f tags . ; sort -u -o tags tags'
alias update_tags_to_vim='echo updating tags to VIM path, make sure to manually create tags or run alias gen_tags before!;cp tags ~/.vim/tags/acs_5_2/; '
alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > cscope.files; cscope -b -i cscope.files '
alias gen_fscope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > freescope.files'
alias runacs_5_0='/vob/nm_acs/acs/runtime/daemons/rt_daemon/target/rt_daemon.exe &'
alias gdb_acs_lib='_gdb_acs_lib'
alias open_acs_debug_logs='sudo cp /opt/CSCOacs/runtime/config/RuntimeDebugLogEnable.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias close_acs_debug_logs='sudo cp /opt/CSCOacs/runtime/config/RuntimeDebugLogDefault.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias clean_acs_debug_logs=' sudo rm -f /opt/CSCOacs/logs/acsRuntime.log.{1,9} ;  sudo rm -f /opt/CSCOacs/logs/ACSADAgent.log.{1,9} '
alias read_acs_debug_logs=' sudo vi /opt/CSCOacs/logs/acsRuntime.log'
alias set_ad_lab_dns='sudo dns_resolver.sh   AD_LAB'
alias set_cisco_IT_dns='sudo dns_resolver.sh   CSCO_IT'

#ACS pkg control related aliases
alias acs_status='sudo /opt/CSCOacs/bin/acs status'
alias acs_start='sudo /opt/CSCOacs/bin/acs start'
alias acs_stop='sudo /opt/CSCOacs/bin/acs stop'
alias acs_restart='acs_stop; sleep 60; acs_start; acs_stat'
alias cd_acs_bin='cd /opt/CSCOacs/bin/'
alias acs_watch_local_store=' tail -f /opt/CSCOacs/logs/localStore/acsLocalStore.log'
alias acs_watch_RT_logs=' tail -f /opt/CSCOacs/logs/acsRuntime.log'
alias acs_vi_RT_logs=' \vi /opt/CSCOacs/logs/acsRuntime.log'
#Hey, just found a much cleaner way to perform a cmd repeatedly by using watch.
#Sadly, it doesn't seem to work in conjunction with sudo
#alias acs_stat='watch -n 10 sudo /opt/CSCOacs/bin/acs  status'
alias acs_stat='while true; do sudo /opt/CSCOacs/bin/acs  status; sleep 5; done'
alias acs_monit_stat='sudo /opt/CSCOacs/bin/monit status'
alias acs_monit_rt_down='sudo /opt/CSCOacs/bin/monit stop runtime'
alias acs_monit_rt_up='sudo /opt/CSCOacs/bin/monit start runtime'
alias clean_acs_5_logs='_clean_acs_5_logs'
#
# Maven related
#
alias mc='mvn clean -Pacs'
alias mc_strong='echo cleaning private files; ct lsprivate -other | xargs rm -rf; mvn clean -Pacs'
alias mci='mvn clean install -Pacs'
alias mi='mvn install -Pacs'
alias mt='mvn test -Pacs'
alias mco='mvn compile -Pacs'
alias mcist='mvn clean install -Dmaven.test.skip=true -Pacs'
alias mist='mvn install -Dmaven.test.skip=true -Pacs'


#tags generation
#alias gen_tags='echo generating cpp tags;ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  --languages=c++  -f tags . ; sort -u -o tags tags'
#alias gen_fscope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > freescope.files'
# generate cscope symbol DB, start cscope browser with $ cscope -d
#alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > my_cscope.files; cscope -ibkq my_cscope.files -b'
#alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > cscope.files; cscope -b -i cscope.files '
alias start_apache='/cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/Apache.exe'
alias cd_apache='cd /cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/'
alias ctxt='_open_current_context'
#Logs
#alias cd_log='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/'
alias cd_log='cd /opt/CSCOacs/logs/ '
alias tf_log='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/Logs/CSLog.log'
alias tf_admin='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/Logs/ADMN.log'
alias cd_admin='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/'
alias tf_auth='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias vi_auth='vi  /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias cd_auth='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/'
alias tf_radius='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias vi_radius='vi /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias cd_radius='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/'
#hypersrc is a solid source browser
#alias hypersrc="/cygdrive/c/Documents\ and\ Settings/yytzhak/bin/hypersrc.pl"
#Work, Nap-Nac aliases
alias vi_hcap_spec='vi /cygdrive/c/work/acs/Nap-Nac/NAC_HCAP_Specification_External.doc'
alias translate_error='_translate_acs_error'
alias sa-html='sa -Dsa.html=""'
# ClearCase
#
alias code_review_info='_generate_code_review_info'
alias ct='/usr/atria/bin/cleartool'
alias co='ct co -nc'
alias ci='ct ci -nc '
alias ci-all='ci `ct lsco -r -me -short`'
alias my_post_rebase='_my_post_rebase'
alias my_rebase='rebase -graphical -latest -mkbl'
alias ct_diff='ct diff -graph -pred' 
alias ct_diff_act='_ct_diff_act' 
alias ct_tree='ct lsvtree -g' 
#
# Purify, Quantify, Purecoverage, Static Analysis and Insure+
#
alias acs_purify='_run_acs_purify'
alias purecov-test='purify-conf; mvn test -Ppurify-test -Dpurify.cmd=purecov'
alias purify-conf='. /sw/licensed/rational/products/purifyplus_setup.sh'
alias purify-rt='purify-conf; mvn compile -Ppurify'
alias purify-test='purify-conf; mvn test -Ppurify-test'
alias quantify-test='purify-conf; mvn test -Ppurify-test -Dpurify.cmd=quantify'
alias sa='mvn clean compile -Psa '
alias sa-html='mvn clean compile -Psa -Dsa.html=""'
alias sa-html-only='/auto/ses/repository/sa10/static_analysis/sacpp -htmlonly'
alias insur-test='mvn test -Pinsure'
#ACS related

#scripts
alias ruby_i='ruby /cygdrive/c/work/scripts/ruby/eval.rb'

#clearcase
alias ct='cleartool'
alias cdview='cd /cygdrive/m/view/'
alias focus='echo Changing dir to focus bin dir for executing focus CLI; cd /cygdrive/f/bin/pc'
alias list_COs="_list_checkouts"
#java related
alias locate_class_in_jar="_locate_in_jar"

# For cscope
#cscope='mlcscope'
TMPDIR=~/temp
export TMPDIR

#convenience
# for non graphical mode use [file list file name] -t
# else just use [file list file name]
alias resume_edit="_resume_editing_session"

#Cscope vim integration
#alias cscope='freescope'

alias kill_proc="_kill_proc"

#gvim
alias gvim="gvim -font Courier\ Bold\ 13"

#Linux
alias vim="/usr/local/bin/vim"
alias vi="/usr/local/bin/vim"
alias my_vi=" vim -g -font Courier\ Bold\ 10 "
alias disp="_disp"

#Directory display tree
alias tree="ls -R |  sed -e '/:$/s/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"
alias dir_tree="ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"

#ls shortcuts, execs and dirs
alias ls_exe=_ls_exe
alias ls_dir=_ls_dir
alias ls_file=_ls_file

#remote procedures
alias push_file_ssh='_push_file_ssh'
alias pull_file_ssh='_pull_file_ssh'

#Efficient replacment to cp -r
alias cpr_fast='_cpr_fast'
#Copy to compressed file, Copy to uncompressed file
alias cpz='_cpz'
alias cpuz='_cpuz'

#VNC related
alias vnc1024='vncserver :1;echo Opened VNC Server on port 1, yizaq-lnx:1 with default geometry of 1024x864 '
alias vnc1280='vncserver :2 -geometry 1280x1024;echo Opened VNC Server on port 2, yizaq-lnx:1 with default geometry of 1280x1024'

#CPP
# Search in all CPP files, headers and sources.
#
alias find_cpp='find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)'

		21.2.2 Mon Jan 31 16:31:19 JST 2011
# Author: Yosi Izaq
#
#FUNCTIONS

#Utility bash mini functions of common tasks
#

__log_selector()
{

# Set IFS to \n so that array elements containing space would not be considered as multiple elements
        IFS='
'
        LogFiles=( 
                        "/opt/CSCOacs/logs/acsRuntime.log"
                        "/opt/CSCOacs/logs/ACSADAgent.log"
                        "/opt/CSCOacs/logs/ACSManagement.log"   
                        "/opt/CSCOacs/logs/localStore/acsLocalStore.log"   
                        "/opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out"
                        )
        Operation=( 
                        "tail -f" 
                        "vi" 
                        "\\vi" 
                        "tail " 
                        )

        i=0
        j=0
        k=0
        echo "Choose operation+file"
        for file in ${LogFiles[@]} 
        do 
                for op in ${Operation[@]} 
                do
#printf "[%03d] %s%s\n" (($i+$j)) $op $view 
                        (( k = i + j ))
                        printf "[%03d] %s %s\n" $k $op $file 
                        (( j+=1 ))
                done
                (( i+=1 ))
        done
        echo -n "Please select operation and log file:"
        read

        echo $REPLY 
        let "i =  $REPLY / ${#LogFiles[@]} "
        echo $i
        let "j =  $REPLY % ${#LogFiles[@]} "
        echo $j
        printf "Operation: %s %s\n" ${Operation[$j]} ${LogFiles[$i]} 
        eval  "sudo  ${Operation[$j]} ${LogFiles[$i]} "
}

_CC_views_selector()
{

        Views=( 
                        "yizaq1__int.acs5_0.lx"   
                        "yizaq__yizaq_5_3.int.acs5_0.lx"   
                        "yizaq__yizaq_5_3_ad.int.acs5_0.lx"
                        "yizaq2__yizaq.P1.FCS_5_2.int.acs5_0.lx" 
                        "yizaq__P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq1__yizaq.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__yizaq2.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__SAP_Pointed.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__P1.FCS_5_2.int.acs5_0.lx" 
                        "yizaq__PI_Rest.int.acs5_0.lx" 
                        "yizaq__yizaq.PI_Rest.int.acs5_0.lx" 
                        "yizaq__P6.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__yizaq.P6.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__P3.P1.FCS_5_2.int.acs5_0.lx"
                        "yizaq__yizaq.P3.P1.FCS_5_2.int.acs5_0.lx"
                        )
        Descs=( 
                        "View on integration stream" 
                        "private ACS 5.3 stream" 
                        "private ACS 5.3 stream - for Centrify integration in old way" 
                        "private ACS 5.2 P1 patch stream" 
                        "P5 patch stream" 
                        "private P5 patch stream" 
                        "2nd private P5 patch stream" 
                        "P3 SAP pointed patch stream" 
                        "ACS 5.2 P1 patch stream" 
                        "5.3 Rest PI integration stream" 
                        "private 5.3 Rest PI integration stream" 
                        "5.1 P6" "Private 5.1 P6"
                        "5.2 P3 stream"
                        "Private 5.2 P3 stream"
                        )

        i=0
        echo "Available Views:"
        for view in ${Views[@]} 
        do 
                printf "[%03d] %-40s || %-20s\n" $i "${Descs[$i]}" $view 
                (( i+=1 ))
        done
        echo -n "Please select number of view to be set:"
        read

        echo "setting view ${Views[$REPLY]} ${Descs[$REPLY]} "
        cleartool setview ${Views[$REPLY]} 
}
_grepa(){
        grep $1 $HOME/.aliases
}

#utility for getting files from ftp server
#expects 3 args, ftp, dir name, file name, assumes anonymous user
_ftp_get(){
ftp -un $1 <<EOT
user anonymous  foo
bin
cd $2
get $3
quit
EOT
}


#utility for connecting to ftp server and listing a certain dir
#expects 2 args, ftp, and dir name.user name is assumed to be anonymous  
_ftp_listing(){
ftp -un $1 <<EOT
user anonymous  foo
cd $2
dir
quit
EOT
}

#For ACS, automatically install ACS FCS version of 5.1 from my FTP server
_install_acs_from_ftp(){
cd /tmp
_ftp_get cd-acs-ftp /upload/yizaq/ $1.tar.gz
gunzip $1.tar.gz
sudo tar xvf $1.tar

 echo "uninstalling Previous ACS (if any)"

 uninstall_acs_lnx

 echo "Installing ACS"
 sudo rpm -ivh --nomd5 $( basename $ACS )

 echo "Installing ACS view"
 sudo rpm -ivh --nomd5 $( basename $ACS_VIEW )

 echo "Starting ACS"
 sudo /opt/CSCOacs/bin/acs start
}
#Alias to extract rpm
_extract_rpm(){

#Description: 
#Usage: $ extract_rpm source_file [target_dir]
#Author Yosi Izaq
        echo "This alias will extract content of rpm, it can receive an optional parameter for target dir"

rpm=""
dir=""
s_dir=""

        if  [ $# -eq 1 ] 
        then
                echo "Extracting $1 to current dir `pwd`"
		dir=$( pwd )
        elif [ $# -eq 2 ] 
	then
                echo "Extracting $1 to dir $2"
		dir="$2"
		s_dir=$( pwd )
	else
		echo "Usage: extract_rpm <rpm> [target dir]"
		return -1
        fi  
# set RPM param according to relative or absolute path was given
if [[ "$1" = /* ]]
then
#   : # Absolute path
	rpm="$1"
else
# : # Relative path
#rpm="${s_dir}/${1}"
	rpm="${1}"
fi

echo "Extracting rpm $rpm to $dir"
cd $dir || ( echo "can't cd to $dir, bailing out" && return -2 )
echo " rpm2cpio < ${rpm} | cpio -i --make-directories "
rpm2cpio < "${rpm}" | cpio -i --make-directories


}


# This one will accept a list of files to edit.
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session(){

	if [ -n $1 -a $1 == "-t" ]
	then
		shift #shift the -t out of argument (file) list
		echo "using VIM to open files $@"
        vim $@
	else
		echo "using GVIM to open files $@"
        gvim -font Courier\ Bold\ 11 $@
#gvim -font Sans\ 12 $@
	fi
		
}
#

#Bash functions I usually alias and use commonly
#__find_cpp()
#{
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \) 
#}

_backup_change_set()
{
        echo "Backing up change set "
        echo "Make sure you're in corresponding stream and view and set to the activity you'd like reviewed"

        stream=`ct lsstream | awk '{print $2}'`
        view=`ct pwv |  awk '/Set view/  {print $3}'`
        activity=`ct lsact -cact | awk '{print $2}'`
	    back_path="$HOME/temp/backups"
        archive=$back_path/${activity}_srcs.tar

        Files=`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq `

        echo "================================================================================"
        echo "||            Activity  Information                                             "
        echo "================================================================================"
        echo "|| Stream:    $stream                   "
        echo "================================================================================"
        echo "|| View:      $view                   "
        echo "================================================================================"
        echo "|| Activity:  $activity                 "
        echo "================================================================================"
        echo "|| Files:     $Files                 "
        echo "================================================================================"
        echo "|| Archive:     $archive                 "
        echo "================================================================================"


        Files_array=(`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq   `)

        
        first_iter=1
        for file in ${Files_array[@]} 
        do
                if [ -d $file ]
                        then
                        echo "skipping dir $file"
                else
                        echo "archiving $file "
                        if (( first_iter == 1 )) 
                                then 
                                tar cvf $archive $file 
                                first_iter=0
                        else 
                                tar rvf $archive $file 
                        fi
                fi
        done

        bzip2  $archive
}

_generate_code_review_info()
{
        echo "Generating code review information"
        echo "Make sure you're in corresponding stream and view and set to the activity you'd like reviewed"

        stream=`ct lsstream | awk '{print $2}'`
        view=`ct pwv |  awk '/Set view/  {print $3}'`
        activity=`ct lsact -cact | awk '{print $2}'`

        Files=`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq `

        echo "================================================================================"
        echo "||            Code Review Information, optimized for windows view             "
        echo "================================================================================"
        echo "|| Stream:    $stream                   "
        echo "================================================================================"
        echo "|| View:      $view                   "
        echo "================================================================================"
        echo "|| Activity:  $activity                 "
        echo "================================================================================"
        echo "|| Files:     $Files                 "
        echo "================================================================================"

	
	echo
	echo
	echo
	echo

	RULER="=================================================================================================================================="
        Files_array=(`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq   `)

        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Code Review Information. Optimized for Linux View" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Stream $stream" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Activity $activity" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Files: " "||"
        echo
        
        for file in ${Files_array[@]} 
        do
                printf "%-10s%-110s%10s" "||" "$file" "||"
                echo
        done

        printf "%-130s" $RULER
        echo
}

# Variabls
_VIM_FONT=' -font Sans\ 12 '
#_VIM_FONT=' -font Courier\ Bold\ 13 '
#FUNCTIONS

_cpuz(){

#Description: This alias will copy and uncopmress a given zip file to a given target file
# The result is much faster than running cp first and gzunzip later.
#Usage: $ cpuz source_file target_file
#Author Yosi Izaq
        echo "This alias will copy and uncopmress a given zip file to a given target file"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpuz source_file target_file"
        else
                echo "copying and decompressing $1 to $2"
		zcat $1 > $2
        fi  

}

_cpz(){

#Description: This alias will copy the given file to a compressed file on a given location using pipes
# The result is much faster than running cp first and gzip later.
#Usage: $ cpz source_file target_file.gz
#Author Yosi Izaq
        echo "This alias will copy the given file to a compressed file on a given location using pipes"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpz source_file target_file.gz"
        else
                echo "copying and compressing $1 to $2"
		cat $1 | gzip > $2
        fi  

}

_cpr_fast(){

#Description: This alias copied directories much faster than cp -r
#Usage: $ cpr_fast source target
#Author Yosi Izaq
        echo "This alias copies directories much faster than cp -r"


        if  [ $# -ne 2 ]
                then
                        echo "Usage: $ cpr_fast source target"
        else
                echo "copying $1 to $2"
                ( cd $1  && tar cf - . ) | (cd $2  && tar xvpf - )
        fi

}
_pull_file_ssh(){
#Description: SSH copy file from remote host
#Usage pull_file_ssh <remote file> <remote host> <local file>
#Author Yosi Izaq
        echo "SSH copy file from remote host"


        if  [ $# -lt 3 ]
                then
                        echo "Usage pull_file_ssh <remote file> <remote host> <local file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi
                echo "copying $1 to $3 from machine $2, using remote user $4"
                ssh -l $USR $2  cat $1 > $3
        fi

}
_push_file_ssh(){
#Description: SSH move file to remote host
#Usage: push_file_ssh <local file> <remote host> <remote file> [remote user]
#Author Yosi Izaq
        echo "SSH move file to remote host"
        echo "Usage push_file_ssh <local file> <remote host> <remote file>"


        if  [ $# -lt 3 ]
                then
			echo "Usage push_file_ssh <local file> <remote host> <remote file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi

                echo "copying $1 to $3 on machine $2, using remote user $4"
		echo "Execute: cat $1 | ssh -l $USR $2  cat \">\" $3"
                cat $1 | ssh -l $USR $2  cat ">" $3
        fi

}


#ACS related

# Secific to Cisco ACS 5.x project. Run ACS RT daemon purify executable.
# preconditions:
# 1. Only works in clearcase view 
# 2. Only works after ACS RT service is stopped
# 3. Reuires that ACS rt_daemon be linked with purify
_run_acs_purify(){
#
        if [ -ne $1 ]
        then 
cat <<HELP_MSG
------------------------------------------------
Alias/Script secific to Cisco ACS 5.x project. Run ACS RT daemon purify executable.
preconditions:
1. Only works in clearcase view 
2. Only works after ACS RT service is stopped
3. Reuires that ACS rt_daemon be linked with purify
Make sure to call with ACS configurtation file like:
$ _run_acs_purify [path/to/acs/configuration/file]
or
$ purify_acs /opt/CSCOacs/runtime/config/generated_AcsConfig.xml
------------------------------------------------
HELP_MSG

        fi

       cdacs_view
        cd daemons/rt_daemon/
        PURIFYOPTIONS="--view-file=%v.pv -windows=yes -chain-length=20"; export PURIFYOPTIONS

        if [ -e ../config.bak ]
        then
                rm -fr ../config
        else
                mv ../config ../config.bak
        fi

        dev-run.sh start $1

}

_gdb_acs_lib(){

echo "For this to work make you sure you have cd to ACS RT lib directory!"
#Paths relevant to maven system on RT (ACS 5.0 phase 1 and early phase 2)
#        LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:`pwd`/target/lib; export LD_LIBRARY_PATH; 
#        LIB_NAME=`ls target/test* | sed -e 's/\*//'` 
#        echo "Starting debug session for ACS lib ${LIB_NAME} "
#        echo "Please execute command: LD_LIBRARY_PATH=\$\{LD_LIBRARY_PATH\}:`pwd`/target/lib; export LD_LIBRARY_PATH;   gdb ${LIB_NAME}"

#Paths relevant to make system on RT (ACS 5.0 phase 2 and above)
export LD_LIBRARY_PATH=/vob/nm_acs/acs/runtime/build/lnx26/lib:/vob/nm_acs/acs/runtime/prebuilt/lnx26/lib
#cmd="gdb test/Debug/test-`pwd | awk -F"/" '{print $NF }'`"
#libName=`pwd | awk -F"/" '{print $NF }' | python -c "print raw_input().capitalize()"`
libName=`ls test/Debug/test-* | sed -e 's/*//'`
#awk '# Extract the lib name and capitalize 1st letter 
#    # initialize strings
#    BEGIN { upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
#            lower = "abcdefghijklmnopqrstuvwxyz" 
#        FS = "/"
#    }
#    # for lib name (which is last field in record)
#        $NF
#    {
##print "processing last record ", $NF
#    # get first character of first word
#    	FIRSTCHAR = substr($NF, 1, 1)
#    # get position of FIRSTCHAR in lowercase array; if 0, ignore
#    	if (CHAR = index(lower, FIRSTCHAR)) 
#    		# change $1, using position to retrieve
#    		# uppercase character 
#    		$NF = substr(upper, CHAR, 1) substr($NF, 2)
#    # print record
#    	print $NF
#    }'`
echo "lib name to debug is ${libName}"
#cmd="gdb test/Debug/test-${libName}"
cmd="gdb ${libName}"
echo "set LD_LIBRARY_PATH to ${LD_LIBRARY_PATH}, execute ${cmd} " 
$cmd

}

_clean_acs_5_logs(){
#Description: Clean log files of ACS 5.x from various junk
# and leave only stuff that's interesting to me :)

        echo "Cleaning log file $1..."
        sed '/^CatalogRepository/d; /^LocalStore/d; /^Logging/d; /^LoggerFactory/d; /^ScopeHandler/d; /^XmlManager/d;' $1 > ~/__temp__
#cat ~/__temp__
        mv -f ~/__temp__ $1
}

_cd_acs_view(){
#Description: switch to runtime directory for ACS 5.0 project
# of the current view according to cleartool pwv

        CUR_VIEW=`cleartool pwv | awk '/Set view/ {print $3}' `
#echo "Changing dir to ACS 5.0 runtime for view: ${CUR_VIEW}"
        echo "Changing dir to ACS 5.0 for view: ${CUR_VIEW}"

        case "${CUR_VIEW}" in
                'yizaq__int.acs5_0.lx')
                        echo "You are currently working on integration view stream"
                        ;;
                'yizaq2__yizaq.int.acs5_0.lx')
                        echo "You are currently working on AAC related view stream"
                        ;;
                'yizaq3__yizaq.int.acs5_0.lx')
                        echo "You are currently working on utility view stream"
                        ;;
                esac

        cd /view/${CUR_VIEW}/vob/nm_acs/acs/
}
_install_acs_lnx()
{
        #Usage example: install_acs_lnx http://nmtgre-csi.cisco.com/auto/cw/cdimages/acs5_0.mvn/daily/LNX_ACS5_0.MVN_20080928_1020/images/acs-5.0.1-B.2365.i386.rpm
#

        if [ -z "$1" ]
        then
                echo "Please enter URL of ACS RPM. ACS and View will be installed."
                echo "For example, To install ACS 5.0 DST-15 URL execute as follows:"
                echo "install_acs_lnx http://nmtgre-csi.cisco.com/auto/cw/cdimages/acs5_0.mvn/daily/LNX_ACS5_0.MVN_20081024_0129/images/acs-5.0.1-B.2554.i386.rpm"
                echo "terminating."
                return
        fi

        ACS="$1"
        ACS_VIEW=${ACS/acs-/acsview-}
        echo "ACS rpm url is: $ACS"
        echo "ACS view rpm url is: $ACS_VIEW"

        echo "DLing ACS from BOR URL: $ACS"
        cd /tmp/
        if wget ${ACS}
        then
                echo "Successfuly DLed ACS image"
        else
                echo "Failed DLing ACS image"
        fi

        echo "DLing ACS view from BOR URL: $ACS_VIEW"
        cd /tmp/
        if wget ${ACS_VIEW}
        then
                echo "Successfuly DLed ACS view image"
        else
                echo "Failed DLing ACS view image"
        fi

        echo "uninstalling Previous ACS (if any)"

        uninstall_acs_lnx

        echo "Installing ACS"
        sudo rpm -ivh --nomd5 $( basename $ACS )

        echo "Installing ACS view"
        sudo rpm -ivh --nomd5 $( basename $ACS_VIEW )

        echo "Starting ACS"
        sudo /opt/CSCOacs/bin/acs start
}

_uninstall_acs_lnx()
{
        echo "Uninstalling ACS 5.x"
        sudo rpm -e `rpm -qa | grep '^acs-5*'`; 
        echo "Uninstalling ACS 5.x view"
        sudo rpm -e `rpm -qa | grep '^acsview-5*'`; 
}

_translate_acs_error(){
cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/;
csutil.exe -e "$1"
cd -;
#"./cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/csutil.exe" -e "$1"
}

_ls_exe(){
#Description: list executable files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /x/&& $1 !~ /^d/ {print $9}'
}

_ls_dir() {
#Description: list directory files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /^d/ {print $9}'
}

_ls_file() {
#Description: list files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 !~ /^d/ {print $9}'
}
_ct_diff_act(){
#Description: Run diff on an activity change set
#Usage: $ ct_diff_act Phase2Bugs2@/vob/nmtgre_proj

        TMP_FILE="__ct_diff_act_temp"
        echo "Running diff on change set of activity: $1..."
         for file in `activity_change_set $1 `;  do echo "ct diff -graph -pred  $file" >> $TMP_FILE; done
        . $TMP_FILE
        \rm -f $TMP_FILE

}

_ct_diff_act_txt(){
#Description: Run diff on an activity change set
#Usage:[yizaq@yizaq-lnx:Thu Nov 04:/view/yizaq__SAP_Pointed.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/vob/nm_acs/acs/patches_5_1]$ ct_diff_act yizaq_SAP_AD_fix@/vob/nmtgre_proj 

        TMP_FILE="__ct_diff_act_temp"
        echo "Running diff on change set of activity: $1..."
         for file in `activity_change_set $1 `;  do echo "ct diff -diff -pred  $file" >> $TMP_FILE; done
        . $TMP_FILE
        \rm -f $TMP_FILE

}

_my_post_rebase(){
echo "Performing post rebase procedure."
view_path=`ct pwv | awk '/Set view/ {print $3}'`
echo "executing nohup /view/${view_path}/vob/nm_acs/acs/runtime/build/tools/lnx26/rt-build-conf.sh rt-notest"
nohup /view/${view_path}/vob/nm_acs/acs/runtime/build/tools/lnx26/rt-build-conf.sh rt-notest
echo "Check result of build status after rebase in file nohup.out"
echo "This are the last messages of the build"
tail nohup.out
}

_disp(){
echo "setting DISPLAY to $1. Please make sure display is allowed on host (run xhost + [name]"
DISPLAY="$1":0.0; export DISPLAY
echo "DISPLAY is set to: "
echo $DISPLAY
}


_browse_cc_change_set(){
	echo "make sure you change directory to ACS clearcase view"
#for file in `ct lsactivity -long -me | grep ismg_israel_acs | awk -F"@" '{print $1 }' | sed -e 's/\w:\\\ismg_israel_acs\\\Acs/./' |  sed -e 's_\\\_/_g' | sort | uniq `;

        activity=`ct lsact -cact | awk '{print $2}'`
        Files=`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq `
    for file in ${Files[@]} 
		do echo $file;
		ct lsvtree -g $file;
	done
}
_backup(){

	source ~/.aliases
	echo "Starting backup of knwoledge base, scripts and daily context files..."

	back_path="$HOME/temp/backups"
        Archive=$back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`_linux.tar
        echo "Archive: $Archive"
	cdwork
	tar cvf $Archive KB/ context* scripts 
	cd ~
	tar rvf $Archive .aliases .bashrc .vimrc .vim/
	bzip2 -f $Archive

    echo "Backup is ready at ${Archive}.bz2"
}
_kill_proc(){
	echo "freeing process $1"
	proc_pid=`ps -ef | grep "$1" | grep -v grep | awk '{print $2}' `
	echo "freeing  processes $proc_pid. if theres such process please ignore the error message."
	kill -9 $proc_pid
}

_cd () {
	cd /cygdrive/"$1"
   }

_pse(){
	ps -ef  | grep `whoami` | grep "$1" | grep -v grep
}

_pid(){
	ps -ef  | grep `whoami` | grep "$1" | grep -v grep | awk '{print $2}'
}

_history(){
	history | grep "$1"
}

_locate_in_jar (){
#for jar in *.jar;  do echo  searching $jar; jar tvf $jar | grep "$1"; done
for jar in *.jar;  
	do  jar tvf $jar | grep "$1"; 
	if [ $? = 0 ]  ;
	then
		echo "found $1 in $jar."
	fi
done
}

_open_KB_files(){

files=( knowledge_base_unix  clear_case_KB.txt bash/KB_bash  vi/KB_vi kb_scripts javaKB ACS/kb_acs_4_1 ACS/kb_acs_5_0 acs_faqs kb_cisco kb_cygwin kb_tools KB_cpp python/KB_python sed/KB_sed awk/kb_awk  win/KB_win Network/sslKB)
path=" $HOME/work/KB/"
#cmd="vi "
#cmd="gvim -font Courier\ Bold\ 13 "
cmd=" "

for file in ${files[@]};
	do file=${path}${file};
	cmd=${cmd}${file}
#echo $file;
#echo $cmd;
done
#gvim ${_VIM_FONT} ${cmd}

# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${cmd}
#gvim -font Sans\ 12 ${cmd}
}

_list_checkouts() {
	echo "Please wait while generating list of checked out files."
# Caveage, replaced with new cleartool command :)
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)  -exec  cleartool ls '{}' \; | grep CHECKEDOUT | awk -F@ '{print $1}'

# The command below will return list of all checkouts for current user
#ct lsco -r -me;
# While the command below will return list of all checkouts for current user on current working stream+view
#ct lsco -recurse -me | grep `ct lsstream | awk '{print $2}'` | awk '{print $5}' | sed -e 's_"__g'

        echo "Please execute:     $ ct lsco -recurse -me | grep `ct lsstream | awk '{print $2}'` | awk '{print $5}' | sed -e 's_\"__g' "

     echo "end of checkout list"
}

_resume_editing_session(){
	echo "Resuming editing session on file list $1, files: "
	cat $1
	file="$1"
	arg1="$2"
#files=`flatten_file_lines.py $file`
        files=`python /users/yizaq/work/scripts/python/util/flatten_file_lines.py $file`

_fire_vim_edit_session $arg1 ${files}

#	if [ -n $arg1 -a $arg1 == "-t" ]
#	then
#		echo "using vim"
#		vim -- $files
#	else
#		echo "using gvim"
##gvim -font Courier\ Bold\ 13 $files
#		gvim -font Sans\ 12 ${files}
#	fi
		
}

_open_current_context(){
	month=` date | awk '{print $2}'`
	year=` date | awk '{print $6}'`
#echo "year $year, month $month"
	
	ctxt_path="/cygdrive/c/work/"	

	file="${ctxt_path}context_${month}_${year}" 
	if  [ -e $file ] 
		then
			echo "Context file exists"
		else
			echo "Creating new context file $file"
			touch  $file

			echo "This file contains work related notes for Yosi Izaq, yytzhak@cisco.com" >> $file
			echo "File name: $file" >> $file
	
#Enter all days
				LIMIT=31
				for ((i=1; i <= LIMIT ; i++)) 
					do 
						echo  "$i" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
					done
	fi

	echo "Opening $file for edit..."
#gvim -font Courier\ Bold\ 13 $file
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${file}
#gvim -font Sans\ 12 ${file}
}

_mini_start(){
	banner "Welcome"
	banner "`whoami`"	
	echo "date is:"
	banner "`date`"	

	echo "Initializing commonly used apps..."

	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	echo "Firing up some xterms..."
	xterm -sb -bg brown -fg yellow  &
	xterm -sb -bg blue -fg orange  &
	xterm -sb -bg lightyellow -fg purple  &
	xterm -sb -bg grey -fg blue  &

	banner "ENJOY :-)"

	echo "and btw, backuping files..."
	backup
}

_start(){
	banner "Welcome"
	banner "`whoami`"	
	echo "date is:"
	banner "`date`"	

	echo "Initializing commonly used apps..."

	echo "Initializing sametime"
# old sametime
#"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &
	"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &

	echo "Initializing outlook"
	"/cygdrive/c/Program Files/Microsoft Office/OFFICE11/OUTLOOK.EXE"   &

	echo "Initializing crimson editor"
	"/cygdrive/c/Program Files/Crimson Editor/cedt.exe" &

	echo "Initializing firefox"
	"/cygdrive/c/Program Files/Mozilla Firefox/firefox.exe" &

	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	echo "Firing up some xterms..."
	xterm -sb -bg brown -fg yellow  &
	xterm -sb -bg blue -fg orange  &
	xterm -sb -bg lightyellow -fg purple  &
	xterm -sb -bg grey -fg blue  &

	echo "Initializing total commander"
	"/cygdrive/c/totalcmd/TOTALCMD.EXE" &

	banner "ENJOY :-)"

	echo "and btw, backuping files..."
	backup


}

#general
alias dir='ls -lav --color=auto'
alias DIR='ls -F | grep "/"'
alias lst='ls -lrt'
alias cdd='cd /cygdrive/c'
alias CD="_cd "
alias cddesktop='cd  /cygdrive/c/Documents\ and\ Settings/yytzhak/Desktop/'
alias pse="_pse" 
alias pid="_pid" 
alias hist="_history"

##jrules
#alias cdjrules='cd d:;cd ILOG/JRules51' 
#alias cdjrules_eval='cd d:;cd work/projects/ILOG\ JRules\ Compatability\ Tests/"SFL Demo" '
#alias cdjrules_integ_loc='cd /cygdrive/c/work/projects/first_integration '
#alias cdjrules_integ_stream='cd /cygdrive/h/ismg_israel_acs/Acs/JRules/first_integration '
#alias cdjrules_new_integ_stream='cd /cygdrive/j/nm_use_common/JRules/  '
#alias start_rule_dev='/cygdrive/c/ILOG/JRules503/bin/RuleBuilder/brdev.exe'
#alias jonas_start='/cygdrive/c/ILOG/JRules503/bin/Examples/startserver'
#alias jonas_stop='/cygdrive/c/ILOG/JRules503/bin/Examples/stopserver'
#

#xterm related
#alias xt1='xterm -sb -bg brown -fg yellow '
#alias xt2='xterm -sb -bg blue -fg orange '
#alias xt3='xterm -sb -bg lightyellow -fg purple'
#alias xt4='xterm -sb -bg grey -fg blue' 
alias xt1='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg brown -fg yellow '
alias xt2='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg blue -fg orange '
alias xt3='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg lightyellow -fg purple'
alias xt4='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg grey -fg blue' 
alias xts="xt1& xt4& xt3& xt4&"
alias xt1_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg brown -fg yellow '
alias xt2_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg blue -fg orange '
alias xt3_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg lightyellow -fg purple'
alias xt4_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg grey -fg blue' 
alias xts_small="xt1_small& xt4_small& xt3_small& xt4_small&"
alias set_vi="set -o vi;bind '\"\t\":menu-complete'"
alias set_emacs="set -o emacs;"

#jboss
alias jboss_start='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/run.bat'
alias jboss_stop='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/shutdown.bat -S'
alias cdjboss="cd /cygdrive/c/Program\ Files/jboss-4.0.2/server/default/"

#tomcat
alias cdtomcat="cd /cygdrive/c/Program\ Files/Apache\ Group/Tomcat\ 4.1"
alias tomcat_start="cdtomcat; cd ./bin; ./startup.bat; cd -"
alias tomcat_stop="cdtomcat; cd ./bin; ./shutdown.bat; cd -"
alias tomcat_restart="tomcat_stop; sleep 5; tomcat_start"

#system
alias ipconfig='/cygdrive/c/WINNT/system32/ipconfig.exe'
alias refresh_DNS='sudo /etc/rc.d/init.d/nscd restart '

#personal
alias cd_citation='cd /cygdrive/c/backup/acc/citation'
alias dom2='/cygdrive/c/Program\ Files/dominions2/dom2.exe'
alias gods_eye='cd /cygdrive/c/backup/medial/g/domII/tools/gods_eye/;./gods_eye.exe'
alias open_journal='echo open private journal, please type password.; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -d yosi_izaq_journal.cpt; vi yosi_izaq_journal; cd - '
alias close_journal='echo closing private journal, please type password; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -e yosi_izaq_journal; echo terminating journal editing session; cd -'
alias journal="open_journal ; close_journal"

alias open_pass='echo open private passwords file, please type password.; cd /cygdrive/c/work/; ccrypt -d pass.cpt; vi pass; cd - '
alias close_pass='echo closing private passwords file, please type password; cd /cygdrive/c/work/; ccrypt -e pass; echo terminating passwords editing session; cd -'
alias pass="open_pass ; close_pass"

#work
#Put here things that are very commonly used.
alias backup='_backup'
alias browse_cc_change_set='_browse_cc_change_set'
alias start='_start'
alias mini_start='_mini_start'

alias KB='less /cygdrive/c/work/KB/knowledge_base_unix  /cygdrive/c/work/KB/clear_case_KB.txt  /cygdrive/c/work/KB/kb_acs  /cygdrive/c/work/KB/kb_jrules  /cygdrive/c/work/KB/javaKB  /cygdrive/c/work/KB/CPP/KB_cpp /cygdrive/c/work/KB/kb_cygwin /cygdrive/c/work/KB/ant/antKB /cygdrive/c/work/KB/bash/KB_bash /cygdrive/c/work/KB/vi/KB_vi '
alias KBE="_open_KB_files"
alias cd_scripts='cd ~/work/scripts'
alias +='less'
alias cdKB='cd /cygdrive/c/work/KB'
alias cdwork='cd ~/work'
#alias tkdiff='/cygdrive/c/Program\ Files/tkdiff/tkdiff_4_1/tkdiff.tcl'
alias vpn='/cygdrive/c/work/scripts/util/connect_2_office.sh'
alias vi='vim'
alias vig='vim -g -font Courier\ Bold\ 11 -- '

#ACS related aliases
alias uninstall_acs_lnx='_uninstall_acs_lnx'
alias install_acs_lnx='_install_acs_lnx'
alias cdacs_view='_cd_acs_view'
alias cdacs_4_2_1='echo working view lnx__int.acs4_2_1.lxss on stream int.acs4_2_1; cd /ws/yizaq/lnx__int.acs4_2_1.lxss/vob/ismg_israel_acs/Acs/;'
alias cdacs_napnac_main='cd /cygdrive/g/ismg_israel_acs/Acs'
alias cdacs_napnac_fwd_attrs='cd /cygdrive/g/ismg_israel_acs/Acs'
alias cdacs_napnac_merge='cd /cygdrive/h/ismg_israel_acs/Acs'
#alias cdacs_5_0='cleartool setview   yytzhak__yytzhak.int.acs5_0.lx; cd /view/yytzhak__yytzhak.int.acs5_0.lx/vob/nm_acs/acs/runtime'
alias svs="_CC_views_selector"
alias svi='echo setting view on integration stream; cleartool setview   yizaq1__int.acs5_0.lx; cdacs_view'
alias sv_bugs='echo setting view on 5.2 bugs  stream; cleartool setview yizaq__5_2_bugsIII.int.acs5_0.lx   ; cdacs_view'
alias sv_ad='echo setting view on centrify integration 2 ACS5.2 stream; cleartool setview   yizaq__integrate_centrify_430192.int.acs5_0.lx'
alias sv_p4i='echo setting view on P4 patch stream; cleartool setview  yizaq__P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx '
alias sv_p3_sap='echo setting view on P3 SAP pointed patch stream; cleartool setview  yizaq__SAP_Pointed.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx'
alias sv_5_2_p1='echo setting view on private ACS 5.2 P1 patch stream; cleartool setview  yizaq__yizaq.P1.FCS_5_2.int.acs5_0.lx'
alias sv_5_2_p1i='echo setting view on ACS 5.2 P1 patch stream; cleartool setview  yizaq__P1.FCS_5_2.int.acs5_0.lx'
alias sv_p5='echo setting view on private P5 patch stream; cleartool setview  yizaq1__yizaq.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx'
alias sv_p5i='echo setting view on P5 patch stream; cleartool setview  yizaq__P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx'
alias sv_5_1p5='echo setting view on 2nd private P5 patch stream; cleartool setview  yizaq__yizaq2.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx'
alias sv_ad_patch='echo setting view on centrify integration 2 ACS5.2 P2 pointed patch stream; cleartool setview   yizaq__Centrify_4_3_0_192.P2.P1.fcs5_1.int.acs5_0.lx'
alias sv_acs_express='echo setting view on ACS express; cleartool setview   yizaq-xp50; '
alias cdacs_express=' cd /vob/cnsar/thin/destiny;'
alias acs_ftp_ls="_ftp_listing cd-acs-ftp /upload/yizaq/"
alias acs_ftp_get="echo please make sure you specified file to get!; _ftp_get cd-acs-ftp /upload/yizaq/"
alias acs_install_51fcs_from_ftp="_install_acs_from_ftp  ACS_5.1.0.44"
alias acs_fix_jfrog="\cp -fr /auto/pmbu-re/mvn-repo/org/jfrog/ /ws/yizaq/maven-repo/view/`ct pwv -short`/org/"

#cscope and etags + vim related aliases
alias gen_c_tags='echo generating cpp tags;ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  --languages=c++  -f tags . ; sort -u -o tags tags'
alias gen_tags='echo generating all languages tags;rm tags; ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  -f tags . ; sort -u -o tags tags'
alias gen_java_tags='echo generating java tags;ctags -R --fields=+iaS --extra=+q  --languages=java  -f tags . ; sort -u -o tags tags'
alias update_tags_to_vim='echo updating tags to VIM path, make sure to manually create tags or run alias gen_tags before!;mv tags ~/.vim/tags/acs_5/;ln -s ~/.vim/tags/acs_5/tags tags'

alias gen_scope='echo generating cscope symbol DB for C and C++ ; find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > cscope.files; cscope -b -i cscope.files '
alias gen_src_db=' gen_scope ; gen_tags ; update_tags_to_vim '
alias gen_fscope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > freescope.files'
alias runacs_5_0='/vob/nm_acs/acs/runtime/daemons/rt_daemon/target/rt_daemon.exe &'
alias gdb_acs_lib='_gdb_acs_lib'
alias open_acs_rt_debug_logs='sudo cp /opt/CSCOacs/runtime/config/RuntimeDebugLogEnable.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias close_acs_rt_debug_logs='sudo cp /opt/CSCOacs/runtime/config/RuntimeDebugLogDefault.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias open_acs_mgmt_debug_logs='sudo cp /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLogEnable.config  /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLog.config'
alias close_acs_mgmtrt_debug_logs='sudo cp /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/lib/ManagementDebugLogDefault.config  /opt/CSCOacs/runtime/config/RuntimeDebugLog.config'
alias clean_acs_debug_logs=' sudo rm -f /opt/CSCOacs/logs/acsRuntime.log.{1,9} ;  sudo rm -f /opt/CSCOacs/logs/ACSADAgent.log.{1,9} '
alias read_acs_rt_debug_logs=' sudo vi /opt/CSCOacs/logs/acsRuntime.log'
alias read_acs_mgmt_debug_logs=' sudo vi /opt/CSCOacs/logs/ACSManagement.log'
alias set_old_ad_lab_dns='sudo dns_resolver.sh   OLD_AD_LAB'
alias set_new_ad_lab_dns='sudo dns_resolver.sh   NEW_AD_LAB'
alias set_cisco_IT_dns='sudo dns_resolver.sh   CSCO_IT'

#ACS pkg control related aliases
alias acs_status='sudo /opt/CSCOacs/bin/acs status'
alias acs_start='sudo /opt/CSCOacs/bin/acs start'
alias acs_stop='sudo /opt/CSCOacs/bin/acs stop'
alias acs_restart='acs_stop; sleep 60; acs_start; acs_stat'
alias cd_acs_bin='cd /opt/CSCOacs/bin/'
alias acs_watch_local_store=' tail -f /opt/CSCOacs/logs/localStore/acsLocalStore.log'
alias acs_watch_RT_logs=' tail -f /opt/CSCOacs/logs/acsRuntime.log'
alias acs_vi_RT_logs=' \vi /opt/CSCOacs/logs/acsRuntime.log'
#Hey, just found a much cleaner way to perform a cmd repeatedly by using watch.
#Sadly, it doesn't seem to work in conjunction with sudo
#alias acs_stat='watch -n 10 sudo /opt/CSCOacs/bin/acs  status'
alias acs_stat='while true; do sudo /opt/CSCOacs/bin/acs  status; sleep 5; done'
alias acs_monit_start='sudo /opt/CSCOacs/bin/monit '
alias acs_monit_start_all='sudo /opt/CSCOacs/bin/monit start all'
alias acs_monit_stop='sudo /opt/CSCOacs/bin/monit stop all'
alias acs_monit_restart='sudo /opt/CSCOacs/bin/monit stop all; sleep 120; sudo /opt/CSCOacs/bin/monit summary; sudo /opt/CSCOacs/bin/monit start all; sleep 120; sudo /opt/CSCOacs/bin/monit summary'
alias acs_monit_stat='sudo /opt/CSCOacs/bin/monit status'
alias acs_monit_summary='sudo /opt/CSCOacs/bin/monit summary'
alias acs_monit_rt_down='sudo /opt/CSCOacs/bin/monit stop runtime'
alias acs_monit_rt_up='sudo /opt/CSCOacs/bin/monit start runtime'
alias clean_acs_5_logs='_clean_acs_5_logs'
#
# Maven related
#
alias mc='mvn clean -Pacs'
alias mc_strong='echo cleaning private files; ct lsprivate -other | xargs rm -rf; mvn clean -Pacs'
alias mci='mvn clean install -Pacs'
alias mi='mvn install -Pacs'
alias mt='mvn test -Pacs'
alias mco='mvn compile -Pacs'
alias mcist='mvn clean install -Dmaven.test.skip=true -Pacs'
alias mist='mvn install -Dmaven.test.skip=true -Pacs'
alias mvn-insure='mvn clean test -Pinsure -Pacs'



#tags generation
#alias gen_tags='echo generating cpp tags;ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  --languages=c++  -f tags . ; sort -u -o tags tags'
#alias gen_fscope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > freescope.files'
# generate cscope symbol DB, start cscope browser with $ cscope -d
#alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > my_cscope.files; cscope -ibkq my_cscope.files -b'
#alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > cscope.files; cscope -b -i cscope.files '
alias start_apache='/cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/Apache.exe'
alias cd_apache='cd /cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/'
alias ctxt='_open_current_context'
#Logs
#alias cd_log='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/'
alias cd_log='cd /opt/CSCOacs/logs/ '
alias tf_log='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/Logs/CSLog.log'
alias tf_admin='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/Logs/ADMN.log'
alias cd_admin='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/'
alias tf_auth='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias vi_auth='vi  /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias cd_auth='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/'
alias tf_radius='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias vi_radius='vi /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias cd_radius='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/'
#hypersrc is a solid source browser
#alias hypersrc="/cygdrive/c/Documents\ and\ Settings/yytzhak/bin/hypersrc.pl"
#Work, Nap-Nac aliases
alias vi_hcap_spec='vi /cygdrive/c/work/acs/Nap-Nac/NAC_HCAP_Specification_External.doc'
alias translate_error='_translate_acs_error'
alias sa-html='sa -Dsa.html=""'
alias acs_logs='__log_selector'

# ClearCase
#
alias code_review_info='_generate_code_review_info'
alias acs_backup_change_set='_backup_change_set'
alias ct='/usr/atria/bin/cleartool'
alias co='ct co -nc'
alias ci='ct ci -nc '
alias ci-all='ci `ct lsco -r -me -short`'
alias unco-all='ct unco -rm `ct lsco -r -me -short`'
alias my_post_rebase='_my_post_rebase'
alias my_rebase='rebase -graphical -latest -mkbl'
alias ct_diff='ct diff -graph -pred' 
alias ct_diff_t='ct diff -diff -pred' 
alias ct_diff_act='_ct_diff_act' 
alias ct_diff_act_txt='_ct_diff_act_txt' 
alias ct_tree='ct lsvtree -g' 
#
# Purify, Quantify, Purecoverage, Static Analysis and Insure+
#
alias acs_purify='_run_acs_purify'
alias purecov-test='purify-conf; mvn test -Ppurify-test -Dpurify.cmd=purecov'
alias purify-conf='. /sw/licensed/rational/products/purifyplus_setup.sh'
alias purify-rt='purify-conf; mvn compile -Ppurify'
alias purify-test='purify-conf; mvn test -Ppurify-test'
alias quantify-test='purify-conf; mvn test -Ppurify-test -Dpurify.cmd=quantify'
alias sa='mvn clean compile -Psa '
alias sa-html='mvn clean compile -Psa -Dsa.html=""'
alias sa-html-only='/auto/ses/repository/sa10/static_analysis/sacpp -htmlonly'
alias insur-test='mvn test -Pinsure'
#ACS related

#scripts
alias ruby_i='ruby /cygdrive/c/work/scripts/ruby/eval.rb'
alias eclipse=' /ws/yizaq/apps/eclipse/eclipse'

#clearcase
alias ct='cleartool'
alias cdview='cd /cygdrive/m/view/'
alias focus='echo Changing dir to focus bin dir for executing focus CLI; cd /cygdrive/f/bin/pc'
alias list_COs="_list_checkouts"
#java related
alias locate_class_in_jar="_locate_in_jar"

# For cscope
#cscope='mlcscope'
TMPDIR=~/temp
export TMPDIR

#convenience
# for non graphical mode use [file list file name] -t
# else just use [file list file name]
alias resume_edit="_resume_editing_session"

#Cscope vim integration
#alias cscope='freescope'

alias kill_proc="_kill_proc"

#gvim
alias gvim="gvim -font Courier\ Bold\ 13"

#Linux
alias vim="/usr/local/bin/vim"
alias vi="/usr/local/bin/vim"
alias my_vi=" vim -g -font Courier\ Bold\ 10 "
alias disp="_disp"

#Directory display tree
alias tree="ls -R |  sed -e '/:$/s/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"
alias dir_tree="ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"

#ls shortcuts, execs and dirs
alias ls_exe=_ls_exe
alias ls_dir=_ls_dir
alias ls_file=_ls_file

#remote procedures
alias push_file_ssh='_push_file_ssh'
alias pull_file_ssh='_pull_file_ssh'

#Efficient replacment to cp -r
alias cpr_fast='_cpr_fast'
#Copy to compressed file, Copy to uncompressed file
alias cpz='_cpz'
alias cpuz='_cpuz'

#VNC related
alias vnc1024='vncserver :1;echo Opened VNC Server on port 1, yizaq-lnx:1 with default geometry of 1024x864 '
alias vnc1280='vncserver :2 -geometry 1280x1024;echo Opened VNC Server on port 2, yizaq-lnx:1 with default geometry of 1280x1024'

#CPP
# Search in all CPP files, headers and sources.
#
alias find_cpp='find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)'

#Extract rpm
alias extract_rpm='_extract_rpm'

#Maintanence, disp space, quota etc
#alias du_G="du -sh | grep '^[0-9]\+\.[0-9]\+G' | sort -u"
#alias du_M="du -sh | grep '^[0-9]\+\.[0-9]\+M' | sort -u"
alias du_1st_lvl='for dir in `ls_dir`; do du -sh $dir; done'
alias list_young_files='echo list files that are younger than 1 year; find . -mtime -365; '
alias quotas='echo user $USER quotas: ; sudo /usr/cisco/bin/nquota -u yizaq ; echo top size dirs:; echo in ws: ;  cd /ws/yizaq ; du_1st_lvl; echo in home dir: ; cd  /users/yizaq; du_1st_lvl;  '

#search aliases
alias grepa='_grepa'

#tail -f
alias tf='tail -f'
		21.2.3
	21.3 laptop environment .bashrc Mon Jan 25 18:27:08 JST 2010

# base-files version 3.9-3

# To pick up the latest recommended .bashrc content,
# look in /etc/defaults/etc/skel/.bashrc

# Modifying /etc/skel/.bashrc directly will prevent
# setup from updating it.

# The copy in your home directory (~/.bashrc) is yours, please
# feel free to customise it to create a shell
# environment to your liking.  If you feel a change
# would be benificial to all, please feel free to send
# a patch to the cygwin mailing list.

# User dependent .bashrc file

# Environment Variables
# #####################

# TMP and TEMP are defined in the Windows environment.  Leaving
# them set to the default Windows temporary directory can have
# unexpected consequences.
unset TMP
unset TEMP

# Alternatively, set them to the Cygwin temporary directory
# or to any other tmp directory of your choice
# export TMP=/tmp
# export TEMP=/tmp

# Or use TMPDIR instead
# export TMPDIR=/tmp

# Shell Options
# #############

# See man bash for more options...

# Don't wait for job termination notification
 set -o notify

# Don't use ^D to exit
# set -o ignoreeof

# Use case-insensitive filename globbing
# shopt -s nocaseglob

# Make bash append rather than overwrite the history on disk
 shopt -s histappend

# When changing directory small typos can be ignored by bash
# for example, cd /vr/lgo/apaache would find /var/log/apache
 shopt -s cdspell


# Completion options
# ##################

# These completion tuning parameters change the default behavior of bash_completion:

# Define to access remotely checked-out files over passwordless ssh for CVS
# COMP_CVS_REMOTE=1

# Define to avoid stripping description in --option=description of './configure --help'
# COMP_CONFIGURE_HINTS=1

# Define to avoid flattening internal contents of tar files
# COMP_TAR_INTERNAL_PATHS=1

# If this shell is interactive, turn on programmable completion enhancements.
# Any completions you add in ~/.bash_completion are sourced last.
# case $- in
#   *i*) [[ -f /etc/bash_completion ]] && . /etc/bash_completion ;;
# esac


# History Options
# ###############

# Don't put duplicate lines in the history.
 export HISTCONTROL="ignoredups"

# Ignore some controlling instructions
# HISTIGNORE is a colon-delimited list of patterns which should be excluded.
# The '&' is a special pattern which suppresses duplicate entries.
# export HISTIGNORE=$'[ \t]*:&:[fb]g:exit'
# export HISTIGNORE=$'[ \t]*:&:[fb]g:exit:ls' # Ignore the ls command as well

# Whenever displaying the prompt, write the previous line to disk
 export PROMPT_COMMAND="history -a"


# Aliases
# #######

# Some example alias instructions
# If these are enabled they will be used instead of any instructions
# they may mask.  For example, alias rm='rm -i' will mask the rm
# application.  To override the alias instruction use a \ before, ie
# \rm will call the real rm not the alias.

# Interactive operation...
# alias rm='rm -i'
# alias cp='cp -i'
# alias mv='mv -i'

# Default to human readable figures
 alias df='df -h'
 alias du='du -h'

# Misc :)
# alias less='less -r'                          # raw control characters
 alias whence='type -a'                        # where, of a sort
 alias grep='grep --color'                     # show differences in colour

# Some shortcuts for different directory listings
 alias ls='ls -hF --color=tty'                 # classify files in colour
 alias dir='ls --color=auto --format=vertical'
 alias vdir='ls --color=auto --format=long'
 alias ll='ls -l'                              # long list
 alias la='ls -A'                              # all but . and ..
 alias l='ls -CF'                              #


# Functions
# #########

# Some example functions
# function settitle() { echo -ne "\e]2;$@\a\e]1;$@\a"; }

## editor for crontab, cvs
EDITOR=vi
export EDITOR

## pager for man
PAGER=less
export PAGER
#path variables
DESKTOP_P="/cygdrive/c/Documents\ and\ Settings/yytzhak/Desktop"

#clearcase
PATH=${PATH}:/cygdrive/f/perl/focus/bin/pc/:/cygdrive/c/work/scripts/util/:/cygdrive/c/work/scripts/perl/:/cygdrive/c/work/scripts/perl/util/:/cygdrive/c/bin/:/cygdrive/c/work/scripts/games:/cygdrive/c/work/scripts/python/util:/cygdrive/c/work/scripts/sh:/usr/sbin/:/cygdrive/c/Documents\ and\ Settings/yytzhak/bin:
PATH=${PATH}:/cygdrive/c/work/scripts/sed/:
CWTOOLS=/cygdrive/f/;export CWTOOLS

#Python
#Python module path (like java classpath)
PYTHONPATH=.:/cygdrive/c/work/scripts/games:/cygdrive/c/work/scripts/python
#Python interactinve shell startup file.
PYTHONSTARTUP=~/.pythonrc
export PYTHONSTARTUP

#For pypersrc
export TCL_LIBRARY=/cygdrive/c/cygwin/usr/share/tcl8.4/

#prompt
PS1="[\u@\h:\d:\w:]\$ "

#set vi prompt mode, for emacs mode (default) use, set -o emacs
set -o vi
bind '"\t":menu-complete'

#source ~/.aliases
. ~/.aliases

	21.4 laptop environment .aliasses Mon Jan 25 18:27:18 JST 2010

# Author: Yosi Izaq
#

#Utility bash mini functions of common tasks
#
# This one will accept a list of files to edit.
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session(){

	if [ -n $1 -a $1 == "-t" ]
	then
		echo "using VIM"
		shift #shift the -t out of argument (file) list
		vim $@
	else
		echo "using GVIM"
#gvim -font Courier\ Bold\ 13 $files
#gvim -font Sans\ 12 $@
		gvim -font Courier\ Bold\ 13 $@
	fi
		
}
#

#Bash functions I usually alias and use commonly
#__find_cpp()
#{
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \) 
#}

_generate_code_review_info()
{
        echo "Generating code review information"
        echo "Make sure you're in corresponding stream and view and set to the activity you'd like reviewed"

        stream=`ct lsstream | awk '{print $2}'`
        view=`ct pwv |  awk '/Set view/  {print $3}'`
        activity=`ct lsact -cact | awk '{print $2}'`

        Files=`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__'`

        echo "================================================================================"
        echo "||            Code Review Information, optimized for windows view             "
        echo "================================================================================"
        echo "|| Stream:    $stream                   "
        echo "================================================================================"
        echo "|| View:      $view                   "
        echo "================================================================================"
        echo "|| Activity:  $activity                 "
        echo "================================================================================"
        echo "|| Files:     $Files                 "
        echo "================================================================================"

	
	echo
	echo
	echo
	echo

	RULER="=================================================================================================================================="
        Files_array=(`ct lsact -long ${activity}@/vob/nmtgre_proj | awk '/@@/ {print $1 } ' | sed -e 's_@@.*$__' | sort | uniq   `)

        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Code Review Information. Optimized for Linux View" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Stream $stream" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Activity $activity" "||"
        echo 
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "View $view" "||"
        echo
        printf "%-130s" $RULER
        echo
        printf "%-10s%-110s%10s" "||" "Files: " "||"
        echo
        
        for file in ${Files_array[@]} 
        do
                printf "%-10s%-110s%10s" "||" "$file" "||"
                echo
        done

        printf "%-130s" $RULER
        echo
}

# Variabls
_VIM_FONT=' -font Sans\ 12 '
#_VIM_FONT=' -font Courier\ Bold\ 13 '
#FUNCTIONS

_cpuz(){

#Description: This alias will copy and uncopmress a given zip file to a given target file
# The result is much faster than running cp first and gzunzip later.
#Usage: $ cpuz source_file target_file
#Author Yosi Izaq
        echo "This alias will copy and uncopmress a given zip file to a given target file"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpuz source_file target_file"
        else
                echo "copying and decompressing $1 to $2"
		zcat $1 > $2
        fi  

}

_cpz(){

#Description: This alias will copy the given file to a compressed file on a given location using pipes
# The result is much faster than running cp first and gzip later.
#Usage: $ cpz source_file target_file.gz
#Author Yosi Izaq
        echo "This alias will copy the given file to a compressed file on a given location using pipes"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpz source_file target_file.gz"
        else
                echo "copying and compressing $1 to $2"
		cat $1 | gzip > $2
        fi  

}

_cpr_fast(){

#Description: This alias copied directories much faster than cp -r
#Usage: $ cpr_fast source target
#Author Yosi Izaq
        echo "This alias copies directories much faster than cp -r"


        if  [ $# -ne 2 ] 
                then
                        echo "Usage: $ cpr_fast source target"
        else
                echo "copying $1 to $2"
                ( cd $1  && tar cf - . ) | (cd $2  && tar xvpf - ) 
        fi  

}

_pull_file_ssh(){
#Description: SSH copy file from remote host
#Usage pull_file_ssh <remote file> <remote host> <local file>
#Author Yosi Izaq

        echo "SSH copy file from remote host"


        if  [ $# -lt 3 ]
                then
                        echo "Usage pull_file_ssh <remote file> <remote host> <local file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi
                echo "copying $1 to $3 from machine $2, using remote user $4"
                ssh -l $USR $2  cat $1 > $3
        fi

}
_push_file_ssh(){
#Description: SSH move file to remote host
#Usage: push_file_ssh <local file> <remote host> <remote file> [remote user]
#Author Yosi Izaq

        echo "SSH move file to remote host"
        echo "Usage push_file_ssh <local file> <remote host> <remote file> [remote user]"
        echo "Note that [remote user] is optional, use it if local user is different than remote user"

	USR=""

        if  [ $# -lt 3 ]
                then
			echo "Usage push_file_ssh <local file> <remote host> <remote file> [remote user]"
        		echo "Note that [remote user] is optional, use it if local user is different than remote user"
        else
		if [ -n "$4" ]
		then
			USR="$4"
			echo "Remote user is $USR"
		else
			USR=$(whoami)
			echo "Using local user $USR"
		fi

                echo "copying $1 to $3 on machine $2, using remote user $4"
		echo "Execute: cat $1 | ssh -l $USR $2  cat \">\" $3"
                cat $1 | ssh -l $USR $2  cat ">" $3
        fi

}


_ls_exe(){
#Description: list executable files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /x/&& $1 !~ /^d/ {print $9 " " $10}'
}

_ls_dir() {
#Description: list directory files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 ~ /^d/ {print $9 " " $10}'
}

_ls_file() {
#Description: list files only
#Usage: $ ls_exe
#Author Yosi Izaq
ls -lrt | awk ' $1 !~ /^d/ {print $9 " " $10}'
}

_tocifyKB(){
cd /cygdrive/c/work/KB/;

#bash array syntax 
declare -a kb_set 
kb_set=(`find . -iname '*kb*'`)
echo "Adding TOC to all files listed: ${kb_set[@]}"
tocify.pl ${kb_set[@]}
}

_translate_acs_error(){
cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/;
csutil.exe -e "$1"
cd -;
#"./cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/bin/csutil.exe" -e "$1"
}

_browse_cc_change_set(){
	echo "make sure you change directory to ACS clearcase view"
	for file in `ct lsactivity -long -me | grep ismg_israel_acs | awk -F"@" '{print $1 }' | sed -e 's/\w:\\\ismg_israel_acs\\\Acs/./' |  sed -e 's_\\\_/_g' | sort | uniq `;
		do echo $file;
		ct lsvtree -g $file;
	done
}
_backup(){
	source ~/.aliases
	echo "------------------------------------------------"
	echo "Starting backup of knwoledge base, scripts and daily context files..."
	echo "------------------------------------------------"

	back_path="/cygdrive/c/TEMP/backups"

	cdwork
	echo "------------------------------------------------"
	echo "backup KB, context files and scripts"
	echo "------------------------------------------------"
	tar cvf $back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`.tar  KB/ context* scripts 
	echo "------------------------------------------------"
	echo "backup ToDo list, development process notes, drafts and project related KBs"
	echo "------------------------------------------------"
	tar rvf $back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`.tar  acs/5.0/AAC/AAC_DEV_Draft acs/5.0/AD/ADClientPlan acs/5.0/AD/MAR_Plan acs/5.0/Kerberos/KerberosPlan  acs/5.0/PKI/clr_task_plan acs/5.1/CoA/CoA_Plan acs/5.1/FIPS/FIPS_KB 

	echo "------------------------------------------------"
	echo "backup aliases bashrc vimrc and vim"
	echo "------------------------------------------------"
	cd ~
	tar rvf $back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`.tar  .aliases .bashrc .vimrc .journal/yosi_izaq_journal* .vim/

	echo "------------------------------------------------"
	echo "backup files from desktop: bookmars and notes"
	echo "------------------------------------------------"
	cd /cygdrive/c/Documents\ and\ Settings/yytzhak/Desktop/
	tar rvf $back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`.tar  notes bookmarks.html


	echo "------------------------------------------------"
	echo "Compressing..."
	echo "------------------------------------------------"
	bzip2 -f $back_path/` date| awk '{print "backup_"$3"_"$2"_"$6}'`.tar
	echo "------------------------------------------------"
	echo "Backup complete! have a nice day :) "
	echo "------------------------------------------------"
}
_kill_proc(){
	echo "freeing process $1"
	proc_pid=`ps -ef | grep "$1" | grep -v grep | awk '{print $2}' `
	echo "freeing  processes $proc_pid. if theres such process please ignore the error message."
	kill -9 $proc_pid
}

_cd () {
	cd /cygdrive/"$1"
   }

_pse(){
	ps -ef  | grep `whoami` | grep "$1" | grep -v grep
}

_history(){
	history | grep "$1"
}

_locate_in_jar (){
#for jar in *.jar;  do echo  searching $jar; jar tvf $jar | grep "$1"; done
for jar in *.jar;  
	do  jar tvf $jar | grep "$1"; 
	if [ $? = 0 ]  ;
	then
		echo "found $1 in $jar."
	fi
done
}

_open_KB_files(){

files=( knowledge_base_unix  clear_case_KB.txt bash/KB_bash  vi/KB_vi kb_scripts javaKB ACS/kb_acs_4_1 ACS/kb_acs_5_0 ACS/kb_acs_5_1 acs_faqs kb_cisco kb_cygwin kb_tools KB_cpp python/KB_python sed/KB_sed awk/kb_awk  win/KB_win Network/sslKB KB_sql /perl/KB_perl /Algorithms/AlgorithmsKB /ant/antKB C_KB Network/ACE/aceKB Network/NetworkKB Network/sslKB  linux/KB_Linux kb_security dominionsKB )
path=" /cygdrive/c/work/KB/"
#cmd="vi "
#cmd="gvim -font Courier\ Bold\ 13 "
cmd=" "

for file in ${files[@]};
	do file=${path}${file};
	cmd=${cmd}${file}
#echo $file;
#echo $cmd;
done
#gvim ${_VIM_FONT} ${cmd}

# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${cmd}
#gvim -font Sans\ 12 ${cmd}
}

_list_checkouts() {
	echo "Please wait while generating list of checked out files.";
# Caveage, replaced with new cleartool command :)
#find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)  -exec  cleartool ls '{}' \; | grep CHECKEDOUT | awk -F@ '{print $1}'
	ct lsco -r -me;
}

_resume_editing_session(){
	echo "Resuming editing session on files: "
	cat $1
	file="$1"
	arg1="$2"
	files=`flatten_file_lines.py $file`

	_fire_vim_edit_session $arg1 ${files}

#	if [ -n $arg1 -a $arg1 == "-t" ]
#	then
#		echo "using vim"
#		vim -- $files
#	else
#		echo "using gvim"
##gvim -font Courier\ Bold\ 13 $files
#		gvim -font Sans\ 12 ${files}
#	fi
		
}

_open_current_context(){
#month=` date | awk '{print $2}'`
#	year=` date | awk '{print $6}'`
##echo "year $year, month $month"
	
	ctxt_path="/cygdrive/c/work/"	

#file="${ctxt_path}context_${month}_${year}" 

#More elegant than awking for month and year. use () for spawning shell command. Run date with format of month_year
	file="${ctxt_path}context_"$(date +%b_%Y)
	day=$(date +%d)
	if  [ -e $file ] 
		then
			echo "Context file exists"
		else
			echo "Creating new context file $file"
			touch  $file

			echo "This file contains work related notes for Yosi Izaq, yizaq@cisco.com" >> $file
			echo "File name: $file" >> $file
	
#Enter all days
				LIMIT=31
				for ((i=1; i <= LIMIT ; i++)) 
					do 
						echo  "$i" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
						echo  "      ->" >> $file
						echo  "" >> $file
					done
	fi

	echo "Opening $file for edit..."
#gvim -font Courier\ Bold\ 13 $file
# If the first parameter is -t then console VIM will be used. Otherwise GVIM will be launched.
_fire_vim_edit_session $1 ${file} +/"^${day}"
#gvim -font Sans\ 12 ${file}
}

_mini_start(){
	banner "Welcome"
	banner "`whoami`"	
	echo "date is:"
	banner "`date`"	

	echo "Initializing commonly used apps..."

	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	echo "Firing up some xterms..."
	xterm -sb -bg brown -fg yellow  &
	xterm -sb -bg blue -fg orange  &
	xterm -sb -bg lightyellow -fg purple  &
	xterm -sb -bg grey -fg blue  &

	banner "ENJOY :-)"

	echo "and btw, backuping files..."
	backup
}

_start(){
	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	banner "Welcome"
	banner "`whoami | awk '{print toupper($1) }'`"	
	echo "date is:"
	banner "`date`"	
	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

	echo "Initializing commonly used apps..."

#	echo "Initializing sametime"
## old sametime
##"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &
#	"/cygdrive/c/Program Files/Lotus/Sametime Client/Connect.exe" &

#	echo "Initializing Pidgin"
#	"/cygdrive/c/Program Files/Pidgin/pidgin.exe" &

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "Initializing outlook"
	"/cygdrive/c/Program Files/Microsoft Office/OFFICE12/OUTLOOK.EXE"   &

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "Initializing emerald crimson editor"
	"/cygdrive/c/Program Files/Emerald Editor Community/Crimson Editor SVN263/cedt.exe" &

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "Initializing firefox"
	"/cygdrive/c/Program Files/Mozilla Firefox/firefox.exe" &

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "Firing up knowledge base and context files"
	_open_current_context;
	_open_KB_files

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "Firing up some xterms..."
	xts_small
#	xterm -sb -bg brown -fg yellow  &
#	xterm -sb -bg blue -fg orange  &
#	xterm -sb -bg lightyellow -fg purple  &
#	xterm -sb -bg grey -fg blue  &

	echo "Initializing total commander"
	"/cygdrive/c/totalcmd/TOTALCMD.EXE" &

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	banner "ENJOY :-)"

	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
	echo "and btw, backuping files..."
	backup
	banner "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"


}

#general
alias dir='ls -lav --color=auto'
alias DIR='ls -F | grep "/"'
alias lst='ls -lrt'
alias cdd='cd /cygdrive/c'
alias CD="_cd "
alias cddesktop='cd  /cygdrive/c/Documents\ and\ Settings/yytzhak/Desktop/'
alias pse="_pse " 
alias hist="_history"

##jrules
#alias cdjrules='cd d:;cd ILOG/JRules51' 
#alias cdjrules_eval='cd d:;cd work/projects/ILOG\ JRules\ Compatability\ Tests/"SFL Demo" '
#alias cdjrules_integ_loc='cd /cygdrive/c/work/projects/first_integration '
#alias cdjrules_integ_stream='cd /cygdrive/h/ismg_israel_acs/Acs/JRules/first_integration '
#alias cdjrules_new_integ_stream='cd /cygdrive/j/nm_use_common/JRules/  '
#alias start_rule_dev='/cygdrive/c/ILOG/JRules503/bin/RuleBuilder/brdev.exe'
#alias jonas_start='/cygdrive/c/ILOG/JRules503/bin/Examples/startserver'
#alias jonas_stop='/cygdrive/c/ILOG/JRules503/bin/Examples/stopserver'
#

#xt
#alias xt1='xterm -sb -bg brown -fg yellow '
#alias xt2='xterm -sb -bg blue -fg orange '
#alias xt3='xterm -sb -bg lightyellow -fg purple'
#alias xt4='xterm -sb -bg grey -fg blue' 
alias xt1='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg brown -fg yellow '
alias xt2='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg blue -fg orange '
alias xt3='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg lightyellow -fg purple'
alias xt4='xterm -font -*-fixed-medium-r-*-*-20-*-*-*-*-*-iso8859-*  -geometry 70x24 -sb -bg grey -fg blue' 
alias xts="xt1& xt4& xt3& xt4&"
alias xt1_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg brown -fg yellow '
alias xt2_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg blue -fg orange '
alias xt3_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg lightyellow -fg purple'
alias xt4_small='xterm -font -*-fixed-bold-r-*-*-12-*-*-*-*-*-iso8859-*  -geometry 140x48 -sb -bg grey -fg blue' 
alias xts_small="xt1_small& xt4_small& xt3_small& xt4_small&"

#jboss
alias jboss_start='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/run.bat'
alias jboss_stop='/cygdrive/c/Program\ Files/jboss-4.0.2/bin/shutdown.bat -S'
alias cdjboss="cd /cygdrive/c/Program\ Files/jboss-4.0.2/server/default/"

#tomcat
alias cdtomcat="cd /cygdrive/c/Program\ Files/Apache\ Group/Tomcat\ 4.1"
alias tomcat_start="cdtomcat; cd ./bin; ./startup.bat; cd -"
alias tomcat_stop="cdtomcat; cd ./bin; ./shutdown.bat; cd -"
alias tomcat_restart="tomcat_stop; sleep 5; tomcat_start"

#system
alias pse='ps -ef | grep `whoami`'
alias ipconfig='/cygdrive/c/WINNT/system32/ipconfig.exe'
alias refresh_DNS='sudo /etc/rc.d/init.d/nscd restart '

#personal
alias cd_citation='cd /cygdrive/c/backup/acc/citation'
alias dom2='/cygdrive/c/Program\ Files/dominions2/dom2.exe'
alias dom3='/cygdrive/c/Program\ Files/dominions3/dom3.exe'
alias py_eye="cd /cygdrive/c/work/scripts/games/py_eye/py_eye; py_eye_gui.py & "
alias gods_eye='cd /cygdrive/c/backup/medial/g/domII/tools/gods_eye/;./gods_eye.exe'
alias open_journal='echo open private journal, please type password.; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -d yosi_izaq_journal.cpt; vi yosi_izaq_journal; cd - '
alias close_journal='echo closing private journal, please type password; cd /cygdrive/c/Documents\ and\ Settings/yytzhak/.journal ; ccrypt -e yosi_izaq_journal; echo terminating journal editing session; cd -'
alias journal="open_journal ; close_journal"

alias open_pass='echo open private passwords file, please type password.; cd /cygdrive/c/work/; ccrypt -d pass.cpt &&  vi pass; cd - '
alias close_pass='echo closing private passwords file, please type password; cd /cygdrive/c/work/; ccrypt -e pass; echo terminating passwords editing session; cd -'
alias pass="open_pass ; close_pass"

#work
#Put here things that are very commonly used.
alias backup='_backup'
alias browse_cc_change_set='_browse_cc_change_set'
alias start='_start'
alias mini_start='_mini_start'

alias KB='less /cygdrive/c/work/KB/knowledge_base_unix  /cygdrive/c/work/KB/clear_case_KB.txt  /cygdrive/c/work/KB/kb_acs  /cygdrive/c/work/KB/kb_jrules  /cygdrive/c/work/KB/javaKB  /cygdrive/c/work/KB/CPP/KB_cpp /cygdrive/c/work/KB/kb_cygwin /cygdrive/c/work/KB/ant/antKB /cygdrive/c/work/KB/bash/KB_bash /cygdrive/c/work/KB/vi/KB_vi '
alias tocifyKB='_tocifyKB'
alias KBE="_open_KB_files"
alias cd_scripts='cd /cygdrive/c/work/scripts'
alias +='less'
alias cdKB='cd /cygdrive/c/work/KB'
alias cdwork='cd /cygdrive/c/work'
alias tkdiff='/cygdrive/c/Program\ Files/tkdiff/tkdiff_4_1/tkdiff.tcl'
alias vpn='/cygdrive/c/work/scripts/util/connect_2_office.sh'
alias vi='vim'
alias cd_acs_client='cd /cygdrive/c/work/acs/test\ tools/ACS\ Client/1.1.5.0/AcsClient-1.1.5.0/userHomeDir.sample'

#ACS related
alias cdacs_auto_test='cd /cygdrive/h/acs_test_automation/acs5_test_auto'
alias cdacs_napnac='cd /cygdrive/i/ismg_israel_acs/Acs'
alias gen_tags='echo generating cpp tags;ctags -R --c++-kinds=+p --fields=+iaS --extra=+q  --languages=c++  -f tags . ; sort -u -o tags tags'
alias gen_java_tags='echo generating java tags;ctags -R --fields=+iaS --extra=+q  --languages=java  -f tags . ; sort -u -o tags tags'
alias gen_fscope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" -o "*.java" \) > freescope.files'
alias gen_scope='find . \( -name "*.[chCH]" -o -name "*.cpp" -o -name "*.hpp" \) > cscope.files; cscope -b -i cscope.files '
alias start_apache='/cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/Apache.exe'
alias cd_apache='cd /cygdrive/c/Program\ Files/Apache\ Group/Apache2/bin/'
alias ctxt='_open_current_context'
#Logs
alias cd_log='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/'
alias tf_log='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSLog/Logs/CSLog.log'
alias tf_admin='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/Logs/ADMN.log'
alias cd_admin='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAdmin/'
alias tf_auth='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias vi_auth='vi  /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/Logs/AUTH.log'
alias cd_auth='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSAuth/'
alias tf_radius='tail -f /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias vi_radius='vi /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/Logs/RDS.log'
alias cd_radius='cd /cygdrive/c/Program\ Files/CiscoSecure\ ACS\ v4.1/CSRadius/'
alias cd_acs_5_0_view='cd /cygdrive/c/views/snapshot/yizaq__int.acs5_0.ntss/nm_acs/acs/runtime'
alias cd_acs_4_1_view='cd /cygdrive/c/views/snapshot/yizaq__yizaq.int.acs4_1.ntss/ismg_israel_acs/Acs/'
#hypersrc is a solid source browser
#alias hypersrc="/cygdrive/c/Documents\ and\ Settings/yytzhak/bin/hypersrc.pl"
#Work, Nap-Nac aliases
alias vi_hcap_spec='vi /cygdrive/c/work/acs/Nap-Nac/NAC_HCAP_Specification_External.doc'
alias translate_error='_translate_acs_error'
#ACS related

#scripts
alias ruby_i='ruby /cygdrive/c/work/scripts/ruby/eval.rb'

#clearcase
alias code_review_info='_generate_code_review_info'
alias ct='cleartool'
alias cdview='cd /cygdrive/m/view/'
alias focus='echo Changing dir to focus bin dir for executing focus CLI; cd /cygdrive/f/bin/pc'
alias list_COs="_list_checkouts"
#java related
alias locate_class_in_jar="_locate_in_jar"

# For cscope
#cscope='mlcscope'
TMPDIR=/cygdrive/c/temp/
export TMPDIR

#convenience
alias resume_edit="_resume_editing_session"
#alias resume_perl_session="gvim \`\ls -lrt  | awk ' /pl$/ {print $NF} '\`"

#Cscope vim integration
#alias cscope='freescope'

alias kill_proc="_kill_proc"

#gvim
alias gvim="gvim -font Courier\ Bold\ 13"
#alias gvim="gvim -font Sans\ 12 "

#Directory display tree
alias tree="ls -R |  sed -e '/:$/s/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"
alias dir_tree="ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'"

#ls shortcuts, execs and dirs
alias ls_exe=_ls_exe
alias ls_dir=_ls_dir
alias ls_file=_ls_file

#remote procedures
alias push_file_ssh='_push_file_ssh'
alias pull_file_ssh='_pull_file_ssh'

#Efficient replacment to cp -r
alias cpr_fast='_cpr_fast'

#Copy to compressed file, Copy to uncompressed file
alias cpz='_cpz'
alias cpuz='_cpuz'

#File system reports
# Report directory size, sorted from smallest to largest
alias report_dir_sizes='du -sk * | sort +0n'

#CPP
# Search in all CPP files, headers and sources.
#
alias find_cpp='find . \( -name "*.[ch]" -o -name "*.cpp" -o -name "*.hpp" \)'

	21.5 useful aliases

		21.5.1  ACS

			21.5.1.1  logs, __log_selector - view ACS logs
[yizaq@yizaq-lnx:Mon Jan 31:/view/yizaq__yizaq_5_3_ad.int.acs5_0.lx/vob/nm_acs/acs]$ acs_logs
Choose operation+file
[000] tail -f /opt/CSCOacs/logs/acsRuntime.log
[001] vi /opt/CSCOacs/logs/acsRuntime.log
[002] \vi /opt/CSCOacs/logs/acsRuntime.log
[003] tail  /opt/CSCOacs/logs/acsRuntime.log
[005] tail -f /opt/CSCOacs/logs/ACSADAgent.log
[006] vi /opt/CSCOacs/logs/ACSADAgent.log
[007] \vi /opt/CSCOacs/logs/ACSADAgent.log
[008] tail  /opt/CSCOacs/logs/ACSADAgent.log
[010] tail -f /opt/CSCOacs/logs/ACSManagement.log
[011] vi /opt/CSCOacs/logs/ACSManagement.log
[012] \vi /opt/CSCOacs/logs/ACSManagement.log
[013] tail  /opt/CSCOacs/logs/ACSManagement.log
[015] tail -f /opt/CSCOacs/logs/localStore/acsLocalStore.log
[016] vi /opt/CSCOacs/logs/localStore/acsLocalStore.log
[017] \vi /opt/CSCOacs/logs/localStore/acsLocalStore.log
[018] tail  /opt/CSCOacs/logs/localStore/acsLocalStore.log
[020] tail -f /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out
[021] vi /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out
[022] \vi /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out
[023] tail  /opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out

code
__log_selector()
{

# Set IFS to \n so that array elements containing space would not be considered as multiple elements
        IFS='
'
        LogFiles=( 
                        "/opt/CSCOacs/logs/acsRuntime.log"
                        "/opt/CSCOacs/logs/ACSADAgent.log"
                        "/opt/CSCOacs/logs/ACSManagement.log"   
                        "/opt/CSCOacs/logs/localStore/acsLocalStore.log"   
                        "/opt/CSCOacs/mgmt/apache-tomcat-6.0.18/logs/catalina.out"
                        )
        Operation=( 
                        "tail -f" 
                        "vi" 
#"\\vi" 
                        "tail " 
                        )

        i=0
        j=0
        echo "Choose operation+file"
        for file in ${LogFiles[@]} 
        do 
                for op in ${Operation[@]} 
                do
                        printf "[%03d] %s %s\n" $j $op $file 
                        (( j+=1 ))
                done
        done
        echo -n "Please select operation and log file:"
        read

echo $REPLY 
        let "i =  $REPLY / ${#Operation[@]}  "
echo $i
        let "j =  $REPLY % ${#Operation[@]}  "
echo $j
        printf "Operation: %s %s\n" ${Operation[$j]} ${LogFiles[$i]} 
        eval  "sudo  ${Operation[$j]} ${LogFiles[$i]} "
}
			21.5.1.2 svs, choose ClearCase view 

			code
_CC_views_selector()
{

        Views=( 
                        "yizaq1__int.acs5_0.lx"   
                        "yizaq__yizaq.fcs5_1.int.acs5_0.lx"   
                        "yizaq__yizaq.FCS_5_2.int.acs5_0.lx"   
                        "yizaq__yizaq_5_3.int.acs5_0.lx"   
                        "yizaq__yizaq_5_3_ad.int.acs5_0.lx"
                        "yizaq2__yizaq.P1.FCS_5_2.int.acs5_0.lx" 
                        "yizaq__P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq1__yizaq.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__yizaq2.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__SAP_Pointed.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__P1.FCS_5_2.int.acs5_0.lx" 
                        "yizaq__PI_Rest.int.acs5_0.lx" 
                        "yizaq__yizaq.PI_Rest.int.acs5_0.lx" 
                        "yizaq__P6.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__yizaq.P6.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx" 
                        "yizaq__P3.P1.FCS_5_2.int.acs5_0.lx"
                        "yizaq__yizaq.P3.P1.FCS_5_2.int.acs5_0.lx"
                        )
        Descs=( 
                        "View on integration stream" 
                        "View on 5.1 FCS stream" 
                        "View on 5.2 FCS stream" 
                        "private ACS 5.3 stream" 
                        "private ACS 5.3 stream - for Centrify integration in old way" 
                        "private ACS 5.2 P1 patch stream" 
                        "P5 patch stream" 
                        "private P5 patch stream" 
                        "2nd private P5 patch stream" 
                        "P3 SAP pointed patch stream" 
                        "ACS 5.2 P1 patch stream" 
                        "5.3 Rest PI integration stream" 
                        "private 5.3 Rest PI integration stream" 
                        "5.1 P6" "Private 5.1 P6"
                        "5.2 P3 stream"
                        "Private 5.2 P3 stream"
                        )

        i=0
        echo "Available Views:"
        for view in ${Views[@]} 
        do 
                printf "[%03d] %-40s || %-20s\n" $i "${Descs[$i]}" $view 
                (( i+=1 ))
        done
        echo -n "Please select number of view to be set:"
        read

        echo "setting view ${Views[$REPLY]} ${Descs[$REPLY]} "
        cleartool setview ${Views[$REPLY]} 
}

			21.5.1.3 cleartool diffs
__ct_diff_base_t()
{
cleartool diff -diff ` ct ls $1  | awk '{print $1}'` `ct ls $1  | awk '{print $1}' | sed -e 's_[0-9]\+$_0_'`
}

alias ct_diff='ct diff -graph -pred' 
alias ct_diff_t='ct diff -diff -pred' 
alias ct_diff_base_t='__ct_diff_base_t' 
alias ct_diff_act='_ct_diff_act' 
alias ct_diff_act_txt='_ct_diff_act_txt' 
alias ct_tree='ct lsvtree -g' 

-> Get the full source code changes of an activity
[yizaq@yizaq-lnx:Thu Feb 17:/ws/yizaq-csi/acs_builds/5_1_fcs]$ ct_diff_act_txt yizaq_CSCtk31968@/vob/nmtgre_proj >& ~/work/code/acs/activities/yizaq_CSCtk31968_act
[yizaq@yizaq-lnx:Thu Feb 17:/view/yizaq__yizaq_5_3.int.acs5_0.lx/vob/nm_acs/acs]$ ct_diff_act_txt yizaq_centrify_4_5_new_integration_scheme@/vob/nmtgre_proj >& ~/work/code/acs/activities/yizaq_centrify_4_5_new_integration_scheme_act

code
_ct_diff_act_txt(){
#Description: Run diff on an activity change set
#Usage:[yizaq@yizaq-lnx:Thu Nov 04:/view/yizaq__SAP_Pointed.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/vob/nm_acs/acs/patches_5_1]$ ct_diff_act yizaq_SAP_AD_fix@/vob/nmtgre_proj 

#        TMP_FILE="__ct_diff_act_temp"
#        echo "Running diff on change set of activity: $1..."
#         for file in `activity_change_set $1 `;  do echo "ct diff -diff -pred  $file" >> $TMP_FILE; done
#        . $TMP_FILE
#        \rm -f $TMP_FILE

         for file in `activity_change_set $1 `;  do echo "Diff of file $file"; __ct_diff_base_t  $file ; done
}
			21.5.1.4 
		21.5.2 Maintenance

			21.5.2.1 quotas
[yizaq@yizaq-lnx:Mon Jan 31:/ws/yizaq/temp/centrify]$ quotas 
user yizaq quotas:
Disk quotas for user yizaq (uid 153067): 
Filesystem          blocks  quota  limit    grace  files  quota  limit    grace
/users/yizaq          405M   500M   500M            9714   200K   200K         
/ws/yizaq            24.8G  32.0G  32.0G            153K  4095M  4095M         
/auto/cwtools         679M  16.0T  16.0T            8979  4095M  4095M         
/auto/nmtg-acs-img    537M  16.0T  16.0T               2  4095M  4095M         
top size dirs:
in ws:
8.0K    maven-repository/
8.0K    maven-repository2/
891M    maven-repo/
378M    apps/
9.3M    yizaq__P1.fcs5_1.int.acs5_0.lx/
157M    yizaq2__yizaq.P1.FCS_5_2.int.acs5_0.lx/
1.3G    acs_builds/
9.3M    yizaq__P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/
312K    yizaq__yizaq2.P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/
42M     yizaq__5_2_bugsII.int.acs5_0.lx/
32M     workspace/
312K    yizaq__avsriniv.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/
226M    yizaq__P1.FCS_5_2.int.acs5_0.lx/
351M    yizaq__P5.P4.P3.fix.P2.P1.fcs5_1.int.acs5_0.lx/
384K    vpltest__yizaq.PI_Rest.int.acs5_0.lx/
2.5G    yizaq__PI_Rest.int.acs5_0.lx/


		21.5.3

	21.6
22. multiple_slowFS_file_fetchers.bash
#!/bin/bash
#===============================================================================
#
#          FILE:  multiple_slowFS_file_fetchers.bash
#       
#         USAGE:  multiple_slowFS_file_fetchers.bash
# 
#   DESCRIPTION:  Go to IPCentral and extract all ACS 5.1 libs
#   Must be done MT since the archive is extremely slow
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:   Yosi Izaq 
#       COMPANY:  
#       VERSION:  1.0
#       CREATED:  06/06/2007 11:38:08 AM IDT
#      REVISION:  ---
#===============================================================================

ARCHIVE_LOC="/auto/ipcentral-vault-1/ipcentral-prod/unpacked/projects/ACS 5.1"
TRG_LOC="/users/yizaq/temp"
ARCHIVE_NAME="acs_5_1_src_publication_"

cd "$ARCHIVE_LOC"

ArchiveLibs(){


        echo "archiving libs starting with letter $1"
        echo "exec: tar cvhz ${TRG_LOC}/${ARCHIVE_NAME}$1.tarz $1*"
        #touch ${TRG_LOC}/${ARCHIVE_NAME}$1.tarz
        tar -zcvhf ${TRG_LOC}/${ARCHIVE_NAME}$1.tarz $1*
}

for let in {a..z} ; do
        ArchiveLibs "$let" &
        sleep 1
done

wait $!
echo "Terminated all archive threads"

23. Perl

	23.1 nameservers_tests.pl 
c:\work\scripts\perl\cisco\nameservers_tests.pl 

----------------------------------------------------------------------------------------------------
#!/usr/bin/perl 
#===============================================================================
#
#         FILE:  nameservers_tests.pl
#
#        USAGE:  ./nameservers_tests.pl  
#
#  DESCRIPTION: find best nameservers from list, set resolv.conf the top 3 
#
#      OPTIONS:  ---
# REQUIREMENTS:  ---
#         BUGS:  ---
#        NOTES:  ---
#       AUTHOR:  Yosi Izaq
#      COMPANY:  
#      VERSION:  1.0
#      CREATED:  10/17/2010 02:47:41 PM
#     REVISION:  ---
#===============================================================================

use Getopt::Std; 

# resolv.conf example:
# [yizaq@yizaq-lnx:Thu Oct 14:/view/yizaq1__int.acs5_0.lx/vob/nm_acs/acs/runtime/idstores/activeDirectoryIDStore/src]$ cat /etc/resolv.conf 
# search cisco.com
# domain cisco.com
# 
# #nameserver for ACS Performance setup
# #nameserver 10.56.62.208
# 
# #nameserver for BXB AD setup
# #nameserver 10.86.81.7
# 
# #for AD Certificate setup of Alex Atlas
# #nameserver 10.56.60.208
# 
# #for AD 3.0a setup
# nameserver 10.56.60.150
# 
# #for new AD setup - US.COM
# #nameserver 10.56.62.165
# 
# #nameserver for ACS Natanya setup
# #nameserver 10.56.63.38
# 
# #Cisco IT DNS
# #nameserver 144.254.71.184
# #nameserver 64.103.101.184
# #nameserver 144.254.10.123
# #nameserver 64.102.6.247

use strict;
use warnings;

#foreach my $arg (@ARGV){
#    if $arg eq '-f'
#}

my %Options;
getopt('f', \%Options);

#my @opts = %Options; 
#print " @opts ";

my $src_file = "/etc/resolv.conf" ;
if ( $Options{'f'} ){
    print "nameservers source file $Options{'f'} \n";
    $src_file =  $Options{'f'} ;
}

my @nameservers ;
my $ns ="";
my $line ="";

open SRC_FILE, "< ${src_file}" or die "cant open $src_file " ;

while (<SRC_FILE>){
 chomp;
 if ( /nameserver/ ) {
    $line = "$_";
    print "$line \n";
    #$line  =~ /(\d+)(\.\d+){3}/ ;
    if ( $line  =~ /(\d+\.)(\d+\.)(\d+\.?)(\d+)/ ){

        #print " nameserver ip: $1$2$3$4 \n";
        unshift @nameservers ,"$1$2$3$4" ;
    }
    
 }
}

sub find_fastest_dig_responders ()
{
    my @nameservers = @_ ;
    
    my @dig_res ;
    my $dig_time = 999999999;
    my %nameserver_dig_times;
    foreach $ns (@nameservers) {
        print $ns, "\n";
        #system ("dig  -c 1 $ns ");
        @dig_res = `dig -c 1 $ns`;
        $dig_time = 999999999; #infinite value
        foreach my $line (@dig_res){
            #print $line ;
            #if (/(time=)(\d+\.\d\+)/){
            if ($line =~ /(time=)(\d+\.?\d+)/){
                #print "found time line: $line \n";
                $dig_time = "$2";
            }
        }
        print "nameserver $ns dig time: @dig_res \n";
        print "nameserver time: $dig_time \n";
        $nameserver_dig_times{"$ns"} = "$dig_time" ;
    }
    
    my @fastet_dig_responders = sort by_time keys %nameserver_dig_times;
    sub by_time { $nameserver_dig_times{$a} <=> $nameserver_dig_times{$b}  }
    
    foreach $ns (@fastet_dig_responders ){
        print "nameserver: $ns, dig time: $nameserver_dig_times{$ns} ms \n"
    }
} # sub find_fastest_dig_responders ( @nameservers)

sub find_fastest_ping_responders ()
{
    my @nameservers = @_ ;
    
    my @ping_res ;
    my $ping_time = 999999999;
    my %nameserver_ping_times;
    foreach $ns (@nameservers) {
        print $ns, "\n";
        #system ("ping  -c 1 $ns ");
        @ping_res = `ping -c 1 $ns`;
        $ping_time = 999999999; #infinite value
        foreach my $line (@ping_res){
            #print $line ;
            #if (/(time=)(\d+\.\d\+)/){
            if ($line =~ /(time=)(\d+\.?\d+)/){
                #print "found time line: $line \n";
                $ping_time = "$2";
            }
        }
        print "nameserver $ns ping time: @ping_res \n";
        print "nameserver time: $ping_time \n";
        $nameserver_ping_times{"$ns"} = "$ping_time" ;
    }
    
    my @fastet_ping_responders = sort by_time keys %nameserver_ping_times;
    sub by_time { $nameserver_ping_times{$a} <=> $nameserver_ping_times{$b}  }
    
    foreach $ns (@fastet_ping_responders ){
        print "nameserver: $ns, ping time: $nameserver_ping_times{$ns} ms \n"
    }
} # sub find_fastest_ping_responders ( @nameservers)

&find_fastest_ping_responders ( @nameservers) ;

close SRC_FILE; 


----------------------------------------------------------------------------------------------------

"
	23.2
24. pki_generator_new.sh
By Alex Atlas,
generate whole PKI set of certs, including CA, Client certs, Machine Certs

usage: [yizaq@yizaq-WS:Mon May 02:/cygdrive/c/work/scripts/bash:]$ ./pki_generator_new.sh -Cm CA -Noc 10 -Norc 5 -up user -mp machine -dp cisco.com  -CAexp 365 -policyCaexp 365 -issuingCaexp 365 -SERexp 365 -CLTexp 365 -hash sha2 -keysz 1024 -RndSn

25. ISE related

	25.1 deploy_diag2machine.sh

		25.1.1 [yizaq@pmbu-dev-vm58:Wed Apr 09:625:50:/vob/nm_acs/pbis]$ cat !$/deploy_diag2machine.sh
cat ~/work/scripts/pbis//deploy_diag2machine.sh
#!/bin/bash - 
#===============================================================================
#
#          FILE:  deploy_diag2machine.sh
# 
#         USAGE:  ./deploy_diag2machine.sh 
# 
#   DESCRIPTION:  
# 
#       OPTIONS:  ---
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR: YOSI IZAQ
#  ORGANIZATION: 
#       CREATED: 02/09/2014 03:19:12 PM IST
#      REVISION:  ---
#===============================================================================

set -o nounset                              # Treat unset variables as an error

echo "Deploying PBIS AD Diagnostics files to ISE machine $1. Run from vob/nm_acs/pbis/cisco/CAD_Diag/"



echo "Backing up original files to .orig"
ssh root@$1 cp /opt/CSCOcpm/prrt/diag/lib/libDiag.so  /opt/CSCOcpm/prrt/diag/lib/libDiag.so.orig  
ssh root@$1 cp /opt/CSCOcpm/prrt/diag/lib/libldapdiag.so  /opt/CSCOcpm/prrt/diag/lib/libldapdiag.so.orig  
ssh root@$1 cp /opt/CSCOcpm/prrt/diag/lib/libPbisWrapperService.so  /opt/CSCOcpm/prrt/diag/lib/libPbisWrapperService.so.orig  
ssh root@$1 cp /opt/CSCOcpm/prrt/diag/bin/sysHealthTools.sh  /opt/CSCOcpm/prrt/diag/bin/sysHealthTools.sh.orig  
ssh root@$1 cp /opt/CSCOcpm/prrt/diag/bin/diagRunner         /opt/CSCOcpm/prrt/diag/bin/diagRunner.orig  

echo "Deploying new files "
scp libDiag.so  root@$1:/opt/CSCOcpm/prrt/diag/lib/libDiag.so  
scp libldapdiag.so  root@$1:/opt/CSCOcpm/prrt/diag/lib/libldapdiag.so  
scp libPbisWrapperService.so  root@$1:/opt/CSCOcpm/prrt/diag/lib/libPbisWrapperService.so  
scp sysHealthTools.sh  root@$1:/opt/CSCOcpm/prrt/diag/bin/sysHealthTools.sh  
scp diagRunner         root@$1:/opt/CSCOcpm/prrt/diag/bin/diagRunner         

echo "Checksums of original and  new files "
ssh root@$1 sha1sum /opt/CSCOcpm/prrt/diag/lib/libDiag.so  /opt/CSCOcpm/prrt/diag/lib/libDiag.so.orig  
ssh root@$1 sha1sum /opt/CSCOcpm/prrt/diag/lib/libldapdiag.so  /opt/CSCOcpm/prrt/diag/lib/libldapdiag.so.orig  
ssh root@$1 sha1sum /opt/CSCOcpm/prrt/diag/lib/libPbisWrapperService.so  /opt/CSCOcpm/prrt/diag/lib/libPbisWrapperService.so.orig  
ssh root@$1 sha1sum /opt/CSCOcpm/prrt/diag/bin/sysHealthTools.sh  /opt/CSCOcpm/prrt/diag/bin/sysHealthTools.sh.orig  
ssh root@$1 sha1sum /opt/CSCOcpm/prrt/diag/bin/diagRunner         /opt/CSCOcpm/prrt/diag/bin/diagRunner.orig  

		25.1.2
	25.2 Collect memory details periodically
location: /Users/yizaq/Desktop/Work/tools/cisco/ISE_related
https://techzone.cisco.com/t5/Identity-Services-Engine-ISE/How-to-gather-memory-stats-to-the-finite-level-in-ISE/ta-p/826925
	
		25.2.1 Collect_Mem_Info.sh
#!/bin/bash
setEnv()
{
FNAME=/tmp/memdetails
export TERM=vt100
rm -f $FNAME
}

perProgramMem()
{
echo "##################################"
echo "*** per program memory start"
echo "##################################"
if [ "$(id -u)" != "0" ]; then
echo "This script must be run as root" 1>&2
exit 1
fi

### Functions
#This function will count memory statistic for passed PID
get_process_mem ()
{
PID=$1
#we need to check if 2 files exist
if [ -f /proc/$PID/status ];
then
if [ -f /proc/$PID/smaps ];
then
#here we count memory usage, Pss, Private and Shared = Pss-Private
Pss=`cat /proc/$PID/smaps | grep -e "^Pss:" | awk '{print $2}'| paste -sd+ | bc `
Private=`cat /proc/$PID/smaps | grep -e "^Private" | awk '{print $2}'| paste -sd+ | bc `
#we need to be sure that we count Pss and Private memory, to avoid errors
if [ x"$Rss" != "x" -o x"$Private" != "x" ];
then

let Shared=${Pss}-${Private}
Name=`cat /proc/$PID/status | grep -e "^Name:" |cut -d':' -f2`
#we keep all results in bytes
let Shared=${Shared}*1024
let Private=${Private}*1024
let Sum=${Shared}+${Private}

echo -e "$Private + $Shared = $Sum \t $Name"
fi
fi
fi
}

#this function make conversion from bytes to Kb or Mb or Gb
convert()
{
value=$1
power=0
#if value 0, we make it like 0.00
if [ "$value" = "0" ];
then
value="0.00"
fi

#We make conversion till value bigger than 1024, and if yes we divide by 1024
while [ $(echo "${value} > 1024"|bc) -eq 1 ]
do
value=$(echo "scale=2;${value}/1024" |bc)
let power=$power+1
done

#this part get b,kb,mb or gb according to number of divisions
case $power in
0) reg=b;;
1) reg=kb;;
2) reg=mb;;
3) reg=gb;;
esac

echo -n "${value} ${reg} "
}

#to ensure that temp files not exist
[[ -f /tmp/res ]] && rm -f /tmp/res
[[ -f /tmp/res2 ]] && rm -f /tmp/res2
[[ -f /tmp/res3 ]] && rm -f /tmp/res3

#if argument passed script will show statistic only for that pid, of not – we list all processes in /proc/ #and get statistic for all of them, all result we store in file /tmp/res
if [ $# -eq 0 ]
then
pids=`ls /proc | grep -e [0-9] | grep -v [A-Za-z] `
for i in $pids
do
get_process_mem $i >> /tmp/res
done
else
get_process_mem $1>> /tmp/res
fi

#This will sort result by memory usage
cat /tmp/res | sort -gr -k 5 > /tmp/res2

#this part will get uniq names from process list, and we will add all lines with same process list
#we will count nomber of processes with same name, so if more that 1 process where will be
# process(2) in output
for Name in `cat /tmp/res2 | awk '{print $6}' | sort | uniq`
do
count=`cat /tmp/res2 | awk -v src=$Name '{if ($6==src) {print $6}}'|wc -l| awk '{print $1}'`
if [ $count = "1" ];
then
count=""
else
count="(${count})"
fi

VmSizeKB=`cat /tmp/res2 | awk -v src=$Name '{if ($6==src) {print $1}}' | paste -sd+ | bc`
VmRssKB=`cat /tmp/res2 | awk -v src=$Name '{if ($6==src) {print $3}}' | paste -sd+ | bc`
total=`cat /tmp/res2 | awk '{print $5}' | paste -sd+ | bc`
Sum=`echo "${VmRssKB}+${VmSizeKB}"|bc`
#all result stored in /tmp/res3 file
echo -e "$VmSizeKB + $VmRssKB = $Sum \t ${Name}${count}" >>/tmp/res3
done

#this make sort once more.
cat /tmp/res3 | sort -gr -k 5 | uniq > /tmp/res

#now we print result , first header
echo -e "Private \t + \t Shared \t = \t RAM used \t Program"
#after we read line by line of temp file
while read line
do
echo $line | while read a b c d e f
do
#we print all processes if Ram used if not 0
if [ $e != "0" ]; then
#here we use function that make conversion
echo -en "`convert $a` \t $b \t `convert $c` \t $d \t `convert $e` \t $f"
echo ""
fi
done
done < /tmp/res

#this part print footer, with counted Ram usage
echo "--------------------------------------------------------"
echo -e "\t\t\t\t\t\t `convert $total`"
echo "========================================================"

# we clean temporary file
[[ -f /tmp/res ]] && rm -f /tmp/res
[[ -f /tmp/res2 ]] && rm -f /tmp/res2
[[ -f /tmp/res3 ]] && rm -f /tmp/res3

echo "##################################"
echo "*** per program memory stop"
echo "##################################"

}

memInfo()
{
echo "##################################"
echo "*** meminfo start"
echo "##################################"
cat /proc/meminfo
echo "##################################"
echo "*** meminfo stop"
echo "##################################"
}

perProcessRss()
{
echo "##################################"
echo "*** per process(kb) vsz,rsz,pid,program,user start"
echo "##################################"
UNIX95=1 ps -eo vsz,rsz,pid,args,user | sort -rnk 1
echo "##################################"
echo "*** per process(kb) vsz,rsz,pid,program,user stop"
echo "##################################"
}

freeOutput()
{
echo "##################################"
echo "*** free(mb) output start"
echo "##################################"
free -m
echo "##################################"
echo "*** free(mb) output stop"
echo "##################################"
}

slabtopOutput()
{
echo "##################################"
echo "*** slabtop output start"
echo "##################################"
slabtop -o -s c
echo "##################################"
echo "*** slabtop output stop"
echo "##################################"
}

collectForJsvcProcess()
{
if [ `/opt/CSCOcpm/bin/appservercontrol.sh status | grep -c "^ISE"` -eq 1 ]
then
	RUNSTATUS=`/opt/CSCOcpm/bin/appservercontrol.sh status | awk ' { print $5 } ' | tr -d ','`
else
	RUNSTATUS=`/opt/CSCOcpm/bin/appservercontrol.sh status | awk ' { print $3 } '`
fi
if [ "$RUNSTATUS " != "running " ]
then
	echo "Not collecting any information for Jsvc process as application server is down"
else
	PROCID=`/opt/CSCOcpm/bin/appservercontrol.sh status | awk ' { print $NF } '`
	echo "##################################"
	echo "*** ps thread start for pid:$PROCID"
	echo "##################################"
  	ps -mp $PROCID -o THREAD
        echo "##################################"
        echo "*** ps thread stop for pid:$PROCID"
        echo "##################################"

        echo "##################################"
        echo "*** proc/maps start for pid:$PROCID"
        echo "##################################"
  	cat /proc/$PROCID/maps
        echo "##################################"
        echo "*** proc/maps stop for pid:$PROCID"
        echo "##################################"

        echo "##################################"
        echo "*** proc/smaps start for pid:$PROCID"
        echo "##################################"
	cat /proc/$PROCID/smaps
        echo "##################################"
        echo "*** proc/smaps stop for pid:$PROCID"
        echo "##################################"
        
	echo "##################################"
        echo "*** lsof output start for pid:$PROCID"
        echo "##################################"
	lsof -p $PROCID
        echo "##################################"
        echo "*** lsof output stop for pid:$PROCID"
        echo "##################################"

	echo "##################################"
        echo "*** thread dump start for pid:$PROCID"
        echo "##################################"
	START=`cat /opt/CSCOcpm/appsrv/apache-tomcat/logs/catalina.out | wc -l`
	kill -3 $PROCID
	sleep 5
	END=`cat /opt/CSCOcpm/appsrv/apache-tomcat/logs/catalina.out | wc -l`
	DIFF=`expr $END - $START `
	DIFF=`expr $DIFF + 200`
	tail -n $DIFF /opt/CSCOcpm/appsrv/apache-tomcat/logs/catalina.out
	echo "##################################"
        echo "*** thread dump stop for pid:$PROCID"
        echo "##################################"
fi
}

topOutput()
{
echo "##################################"
echo "*** top output start"
echo "##################################"
top -b -n1 -H -c
echo "##################################"
echo "*** top output stop"
echo "##################################"
}

sarOutput()
{
echo "##################################"
echo "*** sar -B output start"
echo "##################################"
sar -B
echo "##################################"
echo "*** sar -B output stop"
echo "##################################"

echo "##################################"
echo "*** sar -S output start"
echo "##################################"
sar -S
echo "##################################"
echo "*** sar -S output stop"
echo "##################################"
}

########
# MAIN #
########
DISPTYPE=$1
setEnv
if [ "$DISPTYPE " != "SCREEN " ]
then
	freeOutput 1>>$FNAME 2>>$FNAME
        memInfo  1>>$FNAME 2>>$FNAME 
        perProgramMem 1>>$FNAME 2>>$FNAME
        perProcessRss 1>>$FNAME 2>>$FNAME
        slabtopOutput 1>>$FNAME 2>>$FNAME
        topOutput 1>>$FNAME 2>>$FNAME
        sarOutput 1>>$FNAME 2>>$FNAME
        collectForJsvcProcess 1>>$FNAME 2>>$FNAME
	echo "Output is in $FNAME"
else
	freeOutput
	memInfo	
	perProgramMem
	perProcessRss
	slabtopOutput
	topOutput
	sarOutput
	collectForJsvcProcess
fi
		25.2.2 RunMemCollectorPeriodically.sh
#!/bin/bash
 
if [ -z "$1" ]
    then
      echo "Usage: `basename $0` #minutes"
      exit $E_NOARGS
fi
 
echo "RunMemCollectorPeriodically.sh started. Will run Collect_Mem_Info every $1 minutes";
 
RFNAME=/tmp/memdetailsreport
SCNDS=$(($1*60))
echo "secs = $SCNDS"
 
echo "********************************************************************************" > $RFNAME
while true ; do
       echo "Creating dump at /opt/CSCOcpm/temp/ "
        touch /tmp/dumpsessions
       echo "Running Collect_Mem_Info at $( date ) "
        echo "Date: $( date ) " >> $RFNAME
        . /tmp/Collect_Mem_Info.sh > /dev/null
        cat /tmp/memdetails >> $RFNAME
        echo "********************************************************************************" >> $RFNAME
 
 
       sleep $SCNDS;
 
done


		25.2.3 Runtime Example
[root@cd-pos-13-142 ~]# ./RunMemCollectorPeriodically.sh  1
RunMemCollectorPeriodically.sh started. Will run Collect_Mem_Info every 1 minutes
secs = 60
Creating dump at /opt/CSCOcpm/temp/ 
Running Collect_Mem_Info at Thu Apr 13 08:02:37 UTC 2017 
Creating dump at /opt/CSCOcpm/temp/ 
Running Collect_Mem_Info at Thu Apr 13 08:03:51 UTC 2017 
Creating dump at /opt/CSCOcpm/temp/ 
Running Collect_Mem_Info at Thu Apr 13 08:05:04 UTC 2017 
Creating dump at /opt/CSCOcpm/temp/ 
Running Collect_Mem_Info at Thu Apr 13 08:06:19 UTC 2017 
Creating dump at /opt/CSCOcpm/temp/ 
Running Collect_Mem_Info at Thu Apr 13 08:07:33 UTC 2017 

[root@cd-pos-13-142 ~]# grep Date /tmp/memdetailsreport 
Date: Thu Apr 13 08:02:37 UTC 2017 
Date: Thu Apr 13 08:03:51 UTC 2017 
Date: Thu Apr 13 08:05:04 UTC 2017 
Date: Thu Apr 13 08:06:19 UTC 2017 
Date: Thu Apr 13 08:07:33 UTC 2017 

[root@cd-pos-13-142 ~]# su admin
% Warning: This ssh session cannot be resumed if disconnected. Therefore, it is not recommended to run backup or restore CLI commands as these would cause unrecoverable errors if this session gets terminated prematurely.
sh ver
Failed to log in 1 time(s)
Last failed login on Wed Apr 12 10:45:06 2017 from tty1
cd-pos-13-142/admin# sh ver

Cisco Application Deployment Engine OS Release: 3.0
ADE-OS Build Version: 3.0.0.202
ADE-OS System Architecture: x86_64

Copyright (c) 2005-2014 by Cisco Systems, Inc.
All rights reserved.
Hostname: cd-pos-13-142


Version information of installed applications
---------------------------------------------

Root Patch VERSION INFORMATION
-----------------------------------
Version     : 1.4.0                             Vendor: Cisco Systems, Inc.
Build Date  : August 28 2015  16:11PDT

Cisco Identity Services Engine
---------------------------------------------
Version      : 2.1.0.474
Build Date   : Wed May 25 04:34:43 2016
Install Date : Sun Jan  8 10:45:20 2017

Cisco Identity Services Engine Patch 
---------------------------------------------
Version      : 3
Install Date : Sun Jan 08 14:35:29 2017



->	start
[root@cd-pos-13-142 ~]# nohup ./RunMemCollectorPeriodically.sh 2 &
[root@cd-pos-13-142 ~]# nohup: ignoring input and appending output to ‘nohup.out’

->verify
[root@cd-pos-13-142 ~]# ps -aux | grep RunM
root     21521  3.6  0.0 113252  1704 pts/0    S    08:19   0:00 /bin/bash ./RunMemCollectorPeriodically.sh 2
root     30893  0.0  0.0 113252   792 pts/0    S    08:19   0:00 /bin/bash ./RunMemCollectorPeriodically.sh 2

⎝-> verify exit doesn’t stop…
[root@cd-pos-13-142 ~]# exit
logout
Connection to 10.56.13.142 closed.
YIZAQ-M-W1ZV:ISE_related yizaq$ ssh root@10.56.13.142
root@10.56.13.142's password: 
Last login: Thu Apr 13 08:02:30 2017 from 10.229.136.56
[root@cd-pos-13-142 ~]# ps -aux | grep RunM
root      1732  0.0  0.0 112640   956 pts/0    S+   08:20   0:00 grep --color=auto RunM
root     21521  0.4  0.0 113252  1704 ?        S    08:19   0:00 /bin/bash ./RunMemCollectorPeriodically.sh 2

->	stop
[root@cd-pos-13-142 ~]# kill 21521
[root@cd-pos-13-142 ~]# ps -aux | grep RunM
root      2493  0.0  0.0 112640   960 pts/0    S+   08:21   0:00 grep --color=auto RunM
		25.2.4
26.
